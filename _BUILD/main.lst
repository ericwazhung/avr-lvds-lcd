GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 1


   1               		.file	"main.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.stabs	"/Users/meh/_avrProjects/LCDdirectLVDS/98-bump/",100,0,2,.Ltext0
   8               		.stabs	"main.c",100,0,2,.Ltext0
   9               		.text
  10               	.Ltext0:
  11               		.stabs	"gcc2_compiled.",60,0,0,0
  12               		.stabs	"int:t(0,1)=r(0,1);-32768;32767;",128,0,0,0
  13               		.stabs	"char:t(0,2)=@s8;r(0,2);0;255;",128,0,0,0
  14               		.stabs	"long int:t(0,3)=@s32;r(0,3);020000000000;017777777777;",128,0,0,0
  15               		.stabs	"unsigned int:t(0,4)=r(0,4);0;0177777;",128,0,0,0
  16               		.stabs	"long unsigned int:t(0,5)=@s32;r(0,5);0;037777777777;",128,0,0,0
  17               		.stabs	"long long int:t(0,6)=@s64;r(0,6);01000000000000000000000;0777777777777777777777;",128,0,0,
  18               		.stabs	"long long unsigned int:t(0,7)=@s64;r(0,7);0;01777777777777777777777;",128,0,0,0
  19               		.stabs	"short int:t(0,8)=r(0,8);-32768;32767;",128,0,0,0
  20               		.stabs	"short unsigned int:t(0,9)=r(0,9);0;0177777;",128,0,0,0
  21               		.stabs	"signed char:t(0,10)=@s8;r(0,10);-128;127;",128,0,0,0
  22               		.stabs	"unsigned char:t(0,11)=@s8;r(0,11);0;255;",128,0,0,0
  23               		.stabs	"float:t(0,12)=r(0,1);4;0;",128,0,0,0
  24               		.stabs	"double:t(0,13)=r(0,1);4;0;",128,0,0,0
  25               		.stabs	"long double:t(0,14)=r(0,1);4;0;",128,0,0,0
  26               		.stabs	"short _Fract:t(0,15)=r(0,1);1;0;",128,0,0,0
  27               		.stabs	"_Fract:t(0,16)=r(0,1);2;0;",128,0,0,0
  28               		.stabs	"long _Fract:t(0,17)=r(0,1);4;0;",128,0,0,0
  29               		.stabs	"long long _Fract:t(0,18)=r(0,1);8;0;",128,0,0,0
  30               		.stabs	"unsigned short _Fract:t(0,19)=r(0,1);1;0;",128,0,0,0
  31               		.stabs	"unsigned _Fract:t(0,20)=r(0,1);2;0;",128,0,0,0
  32               		.stabs	"unsigned long _Fract:t(0,21)=r(0,1);4;0;",128,0,0,0
  33               		.stabs	"unsigned long long _Fract:t(0,22)=r(0,1);8;0;",128,0,0,0
  34               		.stabs	"_Sat short _Fract:t(0,23)=r(0,1);1;0;",128,0,0,0
  35               		.stabs	"_Sat _Fract:t(0,24)=r(0,1);2;0;",128,0,0,0
  36               		.stabs	"_Sat long _Fract:t(0,25)=r(0,1);4;0;",128,0,0,0
  37               		.stabs	"_Sat long long _Fract:t(0,26)=r(0,1);8;0;",128,0,0,0
  38               		.stabs	"_Sat unsigned short _Fract:t(0,27)=r(0,1);1;0;",128,0,0,0
  39               		.stabs	"_Sat unsigned _Fract:t(0,28)=r(0,1);2;0;",128,0,0,0
  40               		.stabs	"_Sat unsigned long _Fract:t(0,29)=r(0,1);4;0;",128,0,0,0
  41               		.stabs	"_Sat unsigned long long _Fract:t(0,30)=r(0,1);8;0;",128,0,0,0
  42               		.stabs	"short _Accum:t(0,31)=r(0,1);2;0;",128,0,0,0
  43               		.stabs	"_Accum:t(0,32)=r(0,1);4;0;",128,0,0,0
  44               		.stabs	"long _Accum:t(0,33)=r(0,1);8;0;",128,0,0,0
  45               		.stabs	"long long _Accum:t(0,34)=r(0,1);8;0;",128,0,0,0
  46               		.stabs	"unsigned short _Accum:t(0,35)=r(0,1);2;0;",128,0,0,0
  47               		.stabs	"unsigned _Accum:t(0,36)=r(0,1);4;0;",128,0,0,0
  48               		.stabs	"unsigned long _Accum:t(0,37)=r(0,1);8;0;",128,0,0,0
  49               		.stabs	"unsigned long long _Accum:t(0,38)=r(0,1);8;0;",128,0,0,0
  50               		.stabs	"_Sat short _Accum:t(0,39)=r(0,1);2;0;",128,0,0,0
  51               		.stabs	"_Sat _Accum:t(0,40)=r(0,1);4;0;",128,0,0,0
  52               		.stabs	"_Sat long _Accum:t(0,41)=r(0,1);8;0;",128,0,0,0
  53               		.stabs	"_Sat long long _Accum:t(0,42)=r(0,1);8;0;",128,0,0,0
  54               		.stabs	"_Sat unsigned short _Accum:t(0,43)=r(0,1);2;0;",128,0,0,0
  55               		.stabs	"_Sat unsigned _Accum:t(0,44)=r(0,1);4;0;",128,0,0,0
  56               		.stabs	"_Sat unsigned long _Accum:t(0,45)=r(0,1);8;0;",128,0,0,0
  57               		.stabs	"_Sat unsigned long long _Accum:t(0,46)=r(0,1);8;0;",128,0,0,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 2


  58               		.stabs	"void:t(0,47)=(0,47)",128,0,0,0
  59               		.stabs	"projInfo.h",130,0,0,0
  60               		.stabs	"/opt/local/avr/include/inttypes.h",130,0,0,0
  61               		.stabs	"/opt/local/lib/gcc/avr/4.8.2/include/stdint.h",130,0,0,0
  62               		.stabs	"/opt/local/avr/include/stdint.h",130,0,0,0
  63               		.stabs	"int8_t:t(4,1)=(0,10)",128,0,121,0
  64               		.stabs	"uint8_t:t(4,2)=(0,11)",128,0,122,0
  65               		.stabs	"int16_t:t(4,3)=(0,1)",128,0,123,0
  66               		.stabs	"uint16_t:t(4,4)=(0,4)",128,0,124,0
  67               		.stabs	"int32_t:t(4,5)=(0,3)",128,0,125,0
  68               		.stabs	"uint32_t:t(4,6)=(0,5)",128,0,126,0
  69               		.stabs	"int64_t:t(4,7)=(0,6)",128,0,128,0
  70               		.stabs	"uint64_t:t(4,8)=(0,7)",128,0,129,0
  71               		.stabs	"intptr_t:t(4,9)=(4,3)",128,0,142,0
  72               		.stabs	"uintptr_t:t(4,10)=(4,4)",128,0,147,0
  73               		.stabs	"int_least8_t:t(4,11)=(4,1)",128,0,159,0
  74               		.stabs	"uint_least8_t:t(4,12)=(4,2)",128,0,164,0
  75               		.stabs	"int_least16_t:t(4,13)=(4,3)",128,0,169,0
  76               		.stabs	"uint_least16_t:t(4,14)=(4,4)",128,0,174,0
  77               		.stabs	"int_least32_t:t(4,15)=(4,5)",128,0,179,0
  78               		.stabs	"uint_least32_t:t(4,16)=(4,6)",128,0,184,0
  79               		.stabs	"int_least64_t:t(4,17)=(4,7)",128,0,192,0
  80               		.stabs	"uint_least64_t:t(4,18)=(4,8)",128,0,199,0
  81               		.stabs	"int_fast8_t:t(4,19)=(4,1)",128,0,213,0
  82               		.stabs	"uint_fast8_t:t(4,20)=(4,2)",128,0,218,0
  83               		.stabs	"int_fast16_t:t(4,21)=(4,3)",128,0,223,0
  84               		.stabs	"uint_fast16_t:t(4,22)=(4,4)",128,0,228,0
  85               		.stabs	"int_fast32_t:t(4,23)=(4,5)",128,0,233,0
  86               		.stabs	"uint_fast32_t:t(4,24)=(4,6)",128,0,238,0
  87               		.stabs	"int_fast64_t:t(4,25)=(4,7)",128,0,246,0
  88               		.stabs	"uint_fast64_t:t(4,26)=(4,8)",128,0,253,0
  89               		.stabs	"intmax_t:t(4,27)=(4,7)",128,0,273,0
  90               		.stabs	"uintmax_t:t(4,28)=(4,8)",128,0,278,0
  91               		.stabn	162,0,0,0
  92               		.stabn	162,0,0,0
  93               		.stabs	"int_farptr_t:t(2,1)=(4,5)",128,0,77,0
  94               		.stabs	"uint_farptr_t:t(2,2)=(4,6)",128,0,81,0
  95               		.stabn	162,0,0,0
  96               		.stabn	162,0,0,0
  97               		.stabs	"main.h",130,0,0,0
  98               		.stabs	"/opt/local/avr/include/avr/io.h",130,0,0,0
  99               		.stabs	"/opt/local/avr/include/avr/fuse.h",130,0,0,0
 100               		.stabs	"__fuse_t:t(7,1)=(7,2)=s3low:(0,11),0,8;high:(0,11),8,8;extended:(0,11),16,8;;",128,0,244,0
 101               		.stabn	162,0,0,0
 102               		.stabn	162,0,0,0
 103               		.stabs	"/opt/local/avr/include/stdlib.h",130,0,0,0
 104               		.stabs	"/opt/local/lib/gcc/avr/4.8.2/include/stddef.h",130,0,0,0
 105               		.stabs	"size_t:t(9,1)=(0,4)",128,0,212,0
 106               		.stabs	"wchar_t:t(9,2)=(0,1)",128,0,324,0
 107               		.stabn	162,0,0,0
 108               		.stabs	"div_t:t(8,1)=(8,2)=s4quot:(0,1),0,16;rem:(0,1),16,16;;",128,0,71,0
 109               		.stabs	"ldiv_t:t(8,3)=(8,4)=s8quot:(0,3),0,32;rem:(0,3),32,32;;",128,0,77,0
 110               		.stabs	"__compar_fn_t:t(8,5)=(8,6)=*(8,7)=f(0,1)",128,0,80,0
 111               		.stabn	162,0,0,0
 112               		.stabs	"_commonCode_localized/heartbeat/1.50/heartbeat.h",130,0,0,0
 113               		.stabs	"./_commonCode_localized/hfModulation/1.00/hfModulation.h",130,0,0,0
 114               		.stabs	"hfm_t:t(11,1)=(11,2)=B(11,3)=s4desiredSum:(4,3),0,16;maxPower:(4,2),16,8;power:(4,2),24,8;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 3


 115               		.stabn	162,0,0,0
 116               		.stabn	162,0,0,0
 117               		.stabn	162,0,0,0
 118               		.stabs	"/opt/local/avr/include/avr/pgmspace.h",130,0,0,0
 119               		.stabs	"prog_void:t(12,1)=(12,2)=(12,2)",128,0,349,0
 120               		.stabs	"prog_char:t(12,3)=(12,4)=@s8;r(12,4);0;255;",128,0,350,0
 121               		.stabs	"prog_uchar:t(12,5)=(12,6)=@s8;r(12,6);0;255;",128,0,351,0
 122               		.stabs	"prog_int8_t:t(12,7)=(12,8)=(0,10)",128,0,352,0
 123               		.stabs	"prog_uint8_t:t(12,9)=(12,10)=(0,11)",128,0,353,0
 124               		.stabs	"prog_int16_t:t(12,11)=(12,12)=(0,1)",128,0,354,0
 125               		.stabs	"prog_uint16_t:t(12,13)=(12,14)=(0,4)",128,0,355,0
 126               		.stabs	"prog_int32_t:t(12,15)=(12,16)=(0,3)",128,0,356,0
 127               		.stabs	"prog_uint32_t:t(12,17)=(12,18)=(0,5)",128,0,357,0
 128               		.stabs	"prog_int64_t:t(12,19)=(12,20)=(0,6)",128,0,359,0
 129               		.stabs	"prog_uint64_t:t(12,21)=(12,22)=(0,7)",128,0,360,0
 130               		.stabn	162,0,0,0
 131               		.stabs	"fb_question.c",130,0,0,0
 132               		.stabs	"icons/Question3.h",130,0,0,0
 133               		.stabs	"icons/iconPacking.h",130,0,0,0
 134               		.stabs	"_BLAH_MOTION_:T(15,1)=s3startPosition:(15,2)=k(4,2),0,8;motion:(15,3)=*(15,2),8,16;;",128,
 135               		.stabs	"motion_t:t(15,4)=(15,1)",128,0,42,0
 136               		.stabs	"_BLAH_SPRITE_:T(15,5)=s19p_image:(15,6)=*(15,7)=ar(15,8)=r(15,8);0;0177777;;0;63;(15,2),0,
 137               		.stabs	"sprite_t:t(15,11)=(15,5)",128,0,101,0
 138               		.stabs	"icons/spriteMotion.h",130,0,0,0
 139               		.stabs	"_BLAH_STATUS_:T(16,1)=s14position:(16,2)=ar(15,8);0;1;(4,1),0,16;dir:(16,2),16,16;count:(4
 140               		.stabs	"spriteState_t:t(16,5)=(16,1)",128,0,54,0
 141               		.stabn	162,0,0,0
 142               		.stabn	162,0,0,0
 143               		.stabn	162,0,0,0
 144               		.stabn	162,0,0,0
 145               		.stabs	"hitSensor_init:F(0,47)",36,0,49,hitSensor_init
 146               	.global	hitSensor_init
 147               		.type	hitSensor_init, @function
 148               	hitSensor_init:
 149               		.stabd	46,0,0
 150               		.stabs	"_hitSensors/bumpSwitch.c",132,0,0,.Ltext1
 151               	.Ltext1:
   1:_hitSensors/bumpSwitch.c **** /* mehPL:
   2:_hitSensors/bumpSwitch.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:_hitSensors/bumpSwitch.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:_hitSensors/bumpSwitch.c ****  *    Please see the bottom.
   5:_hitSensors/bumpSwitch.c ****  *    Enjoy!
   6:_hitSensors/bumpSwitch.c ****  */
   7:_hitSensors/bumpSwitch.c **** 
   8:_hitSensors/bumpSwitch.c **** 
   9:_hitSensors/bumpSwitch.c **** 
  10:_hitSensors/bumpSwitch.c **** 
  11:_hitSensors/bumpSwitch.c **** 
  12:_hitSensors/bumpSwitch.c **** 
  13:_hitSensors/bumpSwitch.c **** //a/o v82:
  14:_hitSensors/bumpSwitch.c **** 
  15:_hitSensors/bumpSwitch.c **** //The new idea for a bump-switch/hit-detector is simply a metal ball in a
  16:_hitSensors/bumpSwitch.c **** //cage of pins...
  17:_hitSensors/bumpSwitch.c **** 
  18:_hitSensors/bumpSwitch.c **** // In its resting-state the ball will make contact between two pins
  19:_hitSensors/bumpSwitch.c **** // when bumped sufficiently it will briefly break contact as the ball rolls
  20:_hitSensors/bumpSwitch.c **** // around to find a new resting-position between two contacts.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 4


  21:_hitSensors/bumpSwitch.c **** 
  22:_hitSensors/bumpSwitch.c **** // This has some inherent difficulties:
  23:_hitSensors/bumpSwitch.c **** // *The metal ball may become corroded over time and lose conductiveness...
  24:_hitSensors/bumpSwitch.c **** // * (dirt?)
  25:_hitSensors/bumpSwitch.c **** // *There may be some physical orientations of the "sensor" that make no 
  26:_hitSensors/bumpSwitch.c **** //  contact or require a much harder hit than desired...
  27:_hitSensors/bumpSwitch.c **** // *BOUNCE!!!
  28:_hitSensors/bumpSwitch.c **** 
  29:_hitSensors/bumpSwitch.c **** // so far, this is only used with _interfaces/6bitParallel.c
  30:_hitSensors/bumpSwitch.c **** // Since it's placed on the RGB port, we need to make sure writeColor
  31:_hitSensors/bumpSwitch.c **** // doesn't interfere with the pull-up
  32:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_PORT_ON_RGB_PORT TRUE
  33:_hitSensors/bumpSwitch.c **** 
  34:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_PIN PA7
  35:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_PORT PORTA
  36:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_PCINT	PCINT7
  37:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_PCIE	PCIE1
  38:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_PCMSK	PCMSK0
  39:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_NOTMY_PCMSK	PCMSK1
  40:_hitSensors/bumpSwitch.c **** 
  41:_hitSensors/bumpSwitch.c **** //TODO:
  42:_hitSensors/bumpSwitch.c **** // CHECK: Is interrupt being missed due to most time spent in
  43:_hitSensors/bumpSwitch.c **** // non-interruptable hsync interrupt?
  44:_hitSensors/bumpSwitch.c **** 
  45:_hitSensors/bumpSwitch.c **** 
  46:_hitSensors/bumpSwitch.c **** 
  47:_hitSensors/bumpSwitch.c **** #include "fb_question.h"
  48:_hitSensors/bumpSwitch.c **** 
  49:_hitSensors/bumpSwitch.c **** void hitSensor_init(void)
  50:_hitSensors/bumpSwitch.c **** {
 152               		.stabn	68,0,50,.LM0-.LFBB1
 153               	.LM0:
 154               	.LFBB1:
 155               	/* prologue: function */
 156               	/* frame size = 0 */
 157               	/* stack size = 0 */
 158               	.L__stack_usage = 0
 159               	.LBB73:
  51:_hitSensors/bumpSwitch.c **** 	
  52:_hitSensors/bumpSwitch.c **** 	//Enable the pin as an input, pulled-up
  53:_hitSensors/bumpSwitch.c **** 	setinpuPORT(BUMP_SENSOR_PIN, BUMP_SENSOR_PORT);
 160               		.stabn	68,0,53,.LM1-.LFBB1
 161               	.LM1:
 162 0000 D798      		cbi 0x1a,7
 163 0002 DF9A      		sbi 0x1b,7
 164               	.LBE73:
  54:_hitSensors/bumpSwitch.c **** 
  55:_hitSensors/bumpSwitch.c **** 	//The default PCMSK value is NON-ZERO!
  56:_hitSensors/bumpSwitch.c **** 	//Since the PCINT_vect is (so far) exclusively used for the bump-sensor
  57:_hitSensors/bumpSwitch.c **** 	// disable all the other PCINTs
  58:_hitSensors/bumpSwitch.c **** 	//Enable the corresponding Pin-Change pin...
  59:_hitSensors/bumpSwitch.c **** 	//setbit(BUMP_SENSOR_PCINT, BUMP_SENSOR_PCMSK);
  60:_hitSensors/bumpSwitch.c **** 	BUMP_SENSOR_PCMSK = (1<<BUMP_SENSOR_PCINT);
 165               		.stabn	68,0,60,.LM2-.LFBB1
 166               	.LM2:
 167 0004 80E8      		ldi r24,lo8(-128)
 168 0006 83BD      		out 0x23,r24
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 5


  61:_hitSensors/bumpSwitch.c **** 
  62:_hitSensors/bumpSwitch.c **** 	//The other PCMSK register also has defaults with certain pins enabled
  63:_hitSensors/bumpSwitch.c **** 	// and stupidly (?) the PCMSK# doesn't correspond to the PCIE#
  64:_hitSensors/bumpSwitch.c **** 	BUMP_SENSOR_NOTMY_PCMSK = 0;
 169               		.stabn	68,0,64,.LM3-.LFBB1
 170               	.LM3:
 171 0008 12BC      		out 0x22,__zero_reg__
  65:_hitSensors/bumpSwitch.c **** 
  66:_hitSensors/bumpSwitch.c **** 	//Clear the Pin-Change interrupt (probably not necessary)
  67:_hitSensors/bumpSwitch.c **** 	setbit(PCIF, GIFR);
 172               		.stabn	68,0,67,.LM4-.LFBB1
 173               	.LM4:
 174 000a 8AB7      		in r24,0x3a
 175 000c 8062      		ori r24,lo8(32)
 176 000e 8ABF      		out 0x3a,r24
  68:_hitSensors/bumpSwitch.c **** 
  69:_hitSensors/bumpSwitch.c **** 	//Enable the Pin-Change interrupt
  70:_hitSensors/bumpSwitch.c **** 	// (They are *all* disabled by default)
  71:_hitSensors/bumpSwitch.c **** 	setbit(BUMP_SENSOR_PCIE, GIMSK);
 177               		.stabn	68,0,71,.LM5-.LFBB1
 178               	.LM5:
 179 0010 8BB7      		in r24,0x3b
 180 0012 8062      		ori r24,lo8(32)
 181 0014 8BBF      		out 0x3b,r24
 182 0016 0895      		ret
 183               		.size	hitSensor_init, .-hitSensor_init
 184               	.Lscope1:
 185               		.stabs	"",36,0,0,.Lscope1-.LFBB1
 186               		.stabd	78,0,0
 187               		.stabs	"pll_enable:F(0,47)",36,0,59,pll_enable
 188               	.global	pll_enable
 189               		.type	pll_enable, @function
 190               	pll_enable:
 191               		.stabd	46,0,0
 192               		.stabs	"./pll.c",132,0,0,.Ltext2
 193               	.Ltext2:
   1:./pll.c       **** /* mehPL:
   2:./pll.c       ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:./pll.c       ****  *    I'm not too fond of long licenses at the top of the file.
   4:./pll.c       ****  *    Please see the bottom.
   5:./pll.c       ****  *    Enjoy!
   6:./pll.c       ****  */
   7:./pll.c       **** 
   8:./pll.c       **** 
   9:./pll.c       **** 
  10:./pll.c       **** #ifndef __PLL_C__
  11:./pll.c       **** #define __PLL_C__
  12:./pll.c       **** 
  13:./pll.c       **** #include _BITHANDLING_HEADER_
  14:./pll.c       **** #include <util/delay.h> //For delay_us in pll_enable
  15:./pll.c       **** 
  16:./pll.c       **** 
  17:./pll.c       **** 
  18:./pll.c       **** 
  19:./pll.c       **** #if(defined(__AVR_AT90PWM161__))
  20:./pll.c       **** //PWM161 notes:
  21:./pll.c       **** // The PWM161 has a PLL Multiplication-Factor which can be adjusted
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 6


  22:./pll.c       **** //  4-8x the source-clock, with every step between
  23:./pll.c       **** //  This could be AWESOME for LVDS, with a multiplcation-factor of 7...?
  24:./pll.c       **** // "When Vcc is below 4.5V, maximum PLL-factor is 6"
  25:./pll.c       **** //  we'll see. Best stick with 8 for now, since all the math relies on it.
  26:./pll.c       **** //  But look here if it doesn't seem to be syncing...
  27:./pll.c       **** #warning "PLL_MULT_FACTOR defaults to 8, which is allegedly too fast for 3.3V"
  28:./pll.c       **** #define PLL_MULT_FACTOR	8
  29:./pll.c       **** // "PLLF3 is used for debug purpose", its value is always 0
  30:./pll.c       **** // The PLLF3:0 bits are used to set the multiplication-factor
  31:./pll.c       **** //  They're shifted two bits left
  32:./pll.c       **** //  And 2 is added to the value written to these bits to determine the
  33:./pll.c       **** //  multiplication-factor...
  34:./pll.c       **** #define PLL_MULT_MASK	(0x07<<2)
  35:./pll.c       **** 
  36:./pll.c       **** #define pll_setMult(factor) \
  37:./pll.c       **** 			writeMasked(((factor-2)<<2), PLL_MULT_MASK, PLLCSR)
  38:./pll.c       **** 
  39:./pll.c       **** 
  40:./pll.c       **** // The pll_enable procedure isn't quite so clearly-defined...
  41:./pll.c       **** //   there's no step-by-step procedure I've found so far.
  42:./pll.c       **** //p271 Table 22-4 says the maximum PLL lock-in-time is 64us, so 100 should
  43:./pll.c       **** //be fine.
  44:./pll.c       **** 
  45:./pll.c       **** #endif
  46:./pll.c       **** 
  47:./pll.c       **** 
  48:./pll.c       **** //pll_enable does just what it says, using instructions from the ATtiny861
  49:./pll.c       **** //   manual.
  50:./pll.c       **** //   The PLL is used, in all cases, for the FPD-Link signals (generated by
  51:./pll.c       **** //   Timer1's PWM). But, it may be prescaled back down to CPU-speeds or
  52:./pll.c       **** //   even lower. Also, when PLL_SYSCLK is true, the PLL is actually used to
  53:./pll.c       **** //   drive the CPU... I don't fully comprehend how this works, because the
  54:./pll.c       **** //   pll_enable can't be called *before* the system boots... Anyways, It
  55:./pll.c       **** //   seems to work, regardless, and calling pll_enable() in this mode
  56:./pll.c       **** //   doesn't seem to cause any problems.
  57:./pll.c       **** 
  58:./pll.c       **** 
  59:./pll.c       **** void pll_enable(void)
  60:./pll.c       **** {
 194               		.stabn	68,0,60,.LM6-.LFBB2
 195               	.LM6:
 196               	.LFBB2:
 197               	/* prologue: function */
 198               	/* frame size = 0 */
 199               	/* stack size = 0 */
 200               	.L__stack_usage = 0
  61:./pll.c       **** #if(defined(__AVR_AT90PWM161__))
  62:./pll.c       **** 	pll_setMult(PLL_MULT_FACTOR);
  63:./pll.c       **** #endif
  64:./pll.c       ****    //Stolen from threePinIDer109t:
  65:./pll.c       **** 
  66:./pll.c       ****    //Set Timer1 to use the "asynchronous clock source" (PLL at 64MHz)
  67:./pll.c       ****    // With phase-correct PWM (256 steps up, then back down) and CLKDIV1
  68:./pll.c       ****    // this is 64MHz/512=125kHz
  69:./pll.c       ****    // The benefit of such high PWM frequency is the low RC values necessary
  70:./pll.c       ****    //  for filtering to DC.
  71:./pll.c       **** 	// From the ATtiny861 manual:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 7


  72:./pll.c       **** 	// "To change Timer/Counter1 to the async mode follow this procedure"
  73:./pll.c       ****    // 1: Enable the PLL
  74:./pll.c       ****    setbit(PLLE, PLLCSR);
 201               		.stabn	68,0,74,.LM7-.LFBB2
 202               	.LM7:
 203 0018 89B5      		in r24,0x29
 204 001a 8260      		ori r24,lo8(2)
 205 001c 89BD      		out 0x29,r24
 206               	.LBB74:
 207               	.LBB75:
 208               		.stabs	"/opt/local/avr/include/util/delay.h",132,0,0,.Ltext3
 209               	.Ltext3:
   1:/opt/local/avr/include/util/delay.h **** /* Copyright (c) 2002, Marek Michalkiewicz
   2:/opt/local/avr/include/util/delay.h ****    Copyright (c) 2004,2005,2007 Joerg Wunsch
   3:/opt/local/avr/include/util/delay.h ****    Copyright (c) 2007  Florin-Viorel Petrov
   4:/opt/local/avr/include/util/delay.h ****    All rights reserved.
   5:/opt/local/avr/include/util/delay.h **** 
   6:/opt/local/avr/include/util/delay.h ****    Redistribution and use in source and binary forms, with or without
   7:/opt/local/avr/include/util/delay.h ****    modification, are permitted provided that the following conditions are met:
   8:/opt/local/avr/include/util/delay.h **** 
   9:/opt/local/avr/include/util/delay.h ****    * Redistributions of source code must retain the above copyright
  10:/opt/local/avr/include/util/delay.h ****      notice, this list of conditions and the following disclaimer.
  11:/opt/local/avr/include/util/delay.h **** 
  12:/opt/local/avr/include/util/delay.h ****    * Redistributions in binary form must reproduce the above copyright
  13:/opt/local/avr/include/util/delay.h ****      notice, this list of conditions and the following disclaimer in
  14:/opt/local/avr/include/util/delay.h ****      the documentation and/or other materials provided with the
  15:/opt/local/avr/include/util/delay.h ****      distribution.
  16:/opt/local/avr/include/util/delay.h **** 
  17:/opt/local/avr/include/util/delay.h ****    * Neither the name of the copyright holders nor the names of
  18:/opt/local/avr/include/util/delay.h ****      contributors may be used to endorse or promote products derived
  19:/opt/local/avr/include/util/delay.h ****      from this software without specific prior written permission.
  20:/opt/local/avr/include/util/delay.h **** 
  21:/opt/local/avr/include/util/delay.h ****   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  22:/opt/local/avr/include/util/delay.h ****   AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  23:/opt/local/avr/include/util/delay.h ****   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  24:/opt/local/avr/include/util/delay.h ****   ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
  25:/opt/local/avr/include/util/delay.h ****   LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
  26:/opt/local/avr/include/util/delay.h ****   CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
  27:/opt/local/avr/include/util/delay.h ****   SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
  28:/opt/local/avr/include/util/delay.h ****   INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
  29:/opt/local/avr/include/util/delay.h ****   CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
  30:/opt/local/avr/include/util/delay.h ****   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  31:/opt/local/avr/include/util/delay.h ****   POSSIBILITY OF SUCH DAMAGE. */
  32:/opt/local/avr/include/util/delay.h **** 
  33:/opt/local/avr/include/util/delay.h **** /* $Id: delay.h.in 2385 2013-05-03 13:14:20Z joerg_wunsch $ */
  34:/opt/local/avr/include/util/delay.h **** 
  35:/opt/local/avr/include/util/delay.h **** #ifndef _UTIL_DELAY_H_
  36:/opt/local/avr/include/util/delay.h **** #define _UTIL_DELAY_H_ 1
  37:/opt/local/avr/include/util/delay.h **** 
  38:/opt/local/avr/include/util/delay.h **** #ifndef __HAS_DELAY_CYCLES
  39:/opt/local/avr/include/util/delay.h **** #define __HAS_DELAY_CYCLES 1
  40:/opt/local/avr/include/util/delay.h **** #endif
  41:/opt/local/avr/include/util/delay.h **** 
  42:/opt/local/avr/include/util/delay.h **** #include <inttypes.h>
  43:/opt/local/avr/include/util/delay.h **** #include <util/delay_basic.h>
  44:/opt/local/avr/include/util/delay.h **** #include <math.h>
  45:/opt/local/avr/include/util/delay.h **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 8


  46:/opt/local/avr/include/util/delay.h **** /** \file */
  47:/opt/local/avr/include/util/delay.h **** /** \defgroup util_delay <util/delay.h>: Convenience functions for busy-wait delay loops
  48:/opt/local/avr/include/util/delay.h ****     \code
  49:/opt/local/avr/include/util/delay.h ****     #define F_CPU 1000000UL  // 1 MHz
  50:/opt/local/avr/include/util/delay.h ****     //#define F_CPU 14.7456E6
  51:/opt/local/avr/include/util/delay.h ****     #include <util/delay.h>
  52:/opt/local/avr/include/util/delay.h ****     \endcode
  53:/opt/local/avr/include/util/delay.h **** 
  54:/opt/local/avr/include/util/delay.h ****     \note As an alternative method, it is possible to pass the
  55:/opt/local/avr/include/util/delay.h ****     F_CPU macro down to the compiler from the Makefile.
  56:/opt/local/avr/include/util/delay.h ****     Obviously, in that case, no \c \#define statement should be
  57:/opt/local/avr/include/util/delay.h ****     used.
  58:/opt/local/avr/include/util/delay.h **** 
  59:/opt/local/avr/include/util/delay.h ****     The functions in this header file are wrappers around the basic
  60:/opt/local/avr/include/util/delay.h ****     busy-wait functions from <util/delay_basic.h>.  They are meant as
  61:/opt/local/avr/include/util/delay.h ****     convenience functions where actual time values can be specified
  62:/opt/local/avr/include/util/delay.h ****     rather than a number of cycles to wait for.  The idea behind is
  63:/opt/local/avr/include/util/delay.h ****     that compile-time constant expressions will be eliminated by
  64:/opt/local/avr/include/util/delay.h ****     compiler optimization so floating-point expressions can be used
  65:/opt/local/avr/include/util/delay.h ****     to calculate the number of delay cycles needed based on the CPU
  66:/opt/local/avr/include/util/delay.h ****     frequency passed by the macro F_CPU.
  67:/opt/local/avr/include/util/delay.h **** 
  68:/opt/local/avr/include/util/delay.h ****     \note In order for these functions to work as intended, compiler
  69:/opt/local/avr/include/util/delay.h ****     optimizations <em>must</em> be enabled, and the delay time
  70:/opt/local/avr/include/util/delay.h ****     <em>must</em> be an expression that is a known constant at
  71:/opt/local/avr/include/util/delay.h ****     compile-time.  If these requirements are not met, the resulting
  72:/opt/local/avr/include/util/delay.h ****     delay will be much longer (and basically unpredictable), and
  73:/opt/local/avr/include/util/delay.h ****     applications that otherwise do not use floating-point calculations
  74:/opt/local/avr/include/util/delay.h ****     will experience severe code bloat by the floating-point library
  75:/opt/local/avr/include/util/delay.h ****     routines linked into the application.
  76:/opt/local/avr/include/util/delay.h **** 
  77:/opt/local/avr/include/util/delay.h ****     The functions available allow the specification of microsecond, and
  78:/opt/local/avr/include/util/delay.h ****     millisecond delays directly, using the application-supplied macro
  79:/opt/local/avr/include/util/delay.h ****     F_CPU as the CPU clock frequency (in Hertz).
  80:/opt/local/avr/include/util/delay.h **** 
  81:/opt/local/avr/include/util/delay.h **** */
  82:/opt/local/avr/include/util/delay.h **** 
  83:/opt/local/avr/include/util/delay.h **** #if !defined(__DOXYGEN__)
  84:/opt/local/avr/include/util/delay.h **** static inline void _delay_us(double __us) __attribute__((always_inline));
  85:/opt/local/avr/include/util/delay.h **** static inline void _delay_ms(double __ms) __attribute__((always_inline));
  86:/opt/local/avr/include/util/delay.h **** #endif
  87:/opt/local/avr/include/util/delay.h **** 
  88:/opt/local/avr/include/util/delay.h **** #ifndef F_CPU
  89:/opt/local/avr/include/util/delay.h **** /* prevent compiler error by supplying a default */
  90:/opt/local/avr/include/util/delay.h **** # warning "F_CPU not defined for <util/delay.h>"
  91:/opt/local/avr/include/util/delay.h **** # define F_CPU 1000000UL
  92:/opt/local/avr/include/util/delay.h **** #endif
  93:/opt/local/avr/include/util/delay.h **** 
  94:/opt/local/avr/include/util/delay.h **** #ifndef __OPTIMIZE__
  95:/opt/local/avr/include/util/delay.h **** # warning "Compiler optimizations disabled; functions from <util/delay.h> won't work as designed"
  96:/opt/local/avr/include/util/delay.h **** #endif
  97:/opt/local/avr/include/util/delay.h **** 
  98:/opt/local/avr/include/util/delay.h **** #if __HAS_DELAY_CYCLES && defined(__OPTIMIZE__) && \
  99:/opt/local/avr/include/util/delay.h ****   !defined(__DELAY_BACKWARD_COMPATIBLE__) &&	   \
 100:/opt/local/avr/include/util/delay.h ****   __STDC_HOSTED__
 101:/opt/local/avr/include/util/delay.h **** #  include <math.h>
 102:/opt/local/avr/include/util/delay.h **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 9


 103:/opt/local/avr/include/util/delay.h **** 
 104:/opt/local/avr/include/util/delay.h **** /**
 105:/opt/local/avr/include/util/delay.h ****    \ingroup util_delay
 106:/opt/local/avr/include/util/delay.h **** 
 107:/opt/local/avr/include/util/delay.h ****    Perform a delay of \c __ms milliseconds, using _delay_loop_2().
 108:/opt/local/avr/include/util/delay.h **** 
 109:/opt/local/avr/include/util/delay.h ****    The macro F_CPU is supposed to be defined to a
 110:/opt/local/avr/include/util/delay.h ****    constant defining the CPU clock frequency (in Hertz).
 111:/opt/local/avr/include/util/delay.h **** 
 112:/opt/local/avr/include/util/delay.h ****    The maximal possible delay is 262.14 ms / F_CPU in MHz.
 113:/opt/local/avr/include/util/delay.h **** 
 114:/opt/local/avr/include/util/delay.h ****    When the user request delay which exceed the maximum possible one,
 115:/opt/local/avr/include/util/delay.h ****    _delay_ms() provides a decreased resolution functionality. In this
 116:/opt/local/avr/include/util/delay.h ****    mode _delay_ms() will work with a resolution of 1/10 ms, providing
 117:/opt/local/avr/include/util/delay.h ****    delays up to 6.5535 seconds (independent from CPU frequency).  The
 118:/opt/local/avr/include/util/delay.h ****    user will not be informed about decreased resolution.
 119:/opt/local/avr/include/util/delay.h **** 
 120:/opt/local/avr/include/util/delay.h ****    If the avr-gcc toolchain has __builtin_avr_delay_cycles(unsigned long)
 121:/opt/local/avr/include/util/delay.h ****    support, maximal possible delay is 4294967.295 ms/ F_CPU in MHz. For
 122:/opt/local/avr/include/util/delay.h ****    values greater than the maximal possible delay, overflows results in
 123:/opt/local/avr/include/util/delay.h ****    no delay i.e., 0ms.
 124:/opt/local/avr/include/util/delay.h **** 
 125:/opt/local/avr/include/util/delay.h ****    Conversion of __us into clock cycles may not always result in integer.
 126:/opt/local/avr/include/util/delay.h ****    By default, the clock cycles rounded up to next integer. This ensures that
 127:/opt/local/avr/include/util/delay.h ****    the user gets atleast __us microseconds of delay.
 128:/opt/local/avr/include/util/delay.h **** 
 129:/opt/local/avr/include/util/delay.h ****    Alternatively, user can define __DELAY_ROUND_DOWN__ and __DELAY_ROUND_CLOSEST__
 130:/opt/local/avr/include/util/delay.h ****    to round down and round to closest integer.
 131:/opt/local/avr/include/util/delay.h **** 
 132:/opt/local/avr/include/util/delay.h ****    Note: The new implementation of _delay_ms(double __ms) with 
 133:/opt/local/avr/include/util/delay.h ****     __builtin_avr_delay_cycles(unsigned long) support is not backward compatible. 
 134:/opt/local/avr/include/util/delay.h ****    User can define __DELAY_BACKWARD_COMPATIBLE__ to get a backward compatible delay.
 135:/opt/local/avr/include/util/delay.h ****    Also, the backward compatible
 136:/opt/local/avr/include/util/delay.h ****    algorithm will be chosen if the code is compiled in a <em>freestanding
 137:/opt/local/avr/include/util/delay.h ****    environment</em> (GCC option \c -ffreestanding), as the math functions
 138:/opt/local/avr/include/util/delay.h ****    required for rounding are not available to the compiler then.
 139:/opt/local/avr/include/util/delay.h **** 
 140:/opt/local/avr/include/util/delay.h ****  */
 141:/opt/local/avr/include/util/delay.h **** void
 142:/opt/local/avr/include/util/delay.h **** _delay_ms(double __ms)
 143:/opt/local/avr/include/util/delay.h **** {
 144:/opt/local/avr/include/util/delay.h **** 	double __tmp ; 
 145:/opt/local/avr/include/util/delay.h **** #if __HAS_DELAY_CYCLES && defined(__OPTIMIZE__) && \
 146:/opt/local/avr/include/util/delay.h ****   !defined(__DELAY_BACKWARD_COMPATIBLE__) &&	   \
 147:/opt/local/avr/include/util/delay.h ****   __STDC_HOSTED__
 148:/opt/local/avr/include/util/delay.h **** 	uint32_t __ticks_dc;
 149:/opt/local/avr/include/util/delay.h **** 	extern void __builtin_avr_delay_cycles(unsigned long);
 150:/opt/local/avr/include/util/delay.h **** 	__tmp = ((F_CPU) / 1e3) * __ms;
 151:/opt/local/avr/include/util/delay.h **** 
 152:/opt/local/avr/include/util/delay.h **** 	#if defined(__DELAY_ROUND_DOWN__)
 153:/opt/local/avr/include/util/delay.h **** 		__ticks_dc = (uint32_t)fabs(__tmp);
 154:/opt/local/avr/include/util/delay.h **** 
 155:/opt/local/avr/include/util/delay.h **** 	#elif defined(__DELAY_ROUND_CLOSEST__)
 156:/opt/local/avr/include/util/delay.h **** 		__ticks_dc = (uint32_t)(fabs(__tmp)+0.5);
 157:/opt/local/avr/include/util/delay.h **** 
 158:/opt/local/avr/include/util/delay.h **** 	#else
 159:/opt/local/avr/include/util/delay.h **** 		//round up by default
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 10


 160:/opt/local/avr/include/util/delay.h **** 		__ticks_dc = (uint32_t)(ceil(fabs(__tmp)));
 161:/opt/local/avr/include/util/delay.h **** 	#endif
 162:/opt/local/avr/include/util/delay.h **** 
 163:/opt/local/avr/include/util/delay.h **** 	__builtin_avr_delay_cycles(__ticks_dc);
 164:/opt/local/avr/include/util/delay.h **** 
 165:/opt/local/avr/include/util/delay.h **** #else
 166:/opt/local/avr/include/util/delay.h **** 	uint16_t __ticks;
 167:/opt/local/avr/include/util/delay.h **** 	__tmp = ((F_CPU) / 4e3) * __ms;
 168:/opt/local/avr/include/util/delay.h **** 	if (__tmp < 1.0)
 169:/opt/local/avr/include/util/delay.h **** 		__ticks = 1;
 170:/opt/local/avr/include/util/delay.h **** 	else if (__tmp > 65535)
 171:/opt/local/avr/include/util/delay.h **** 	{
 172:/opt/local/avr/include/util/delay.h **** 		//	__ticks = requested delay in 1/10 ms
 173:/opt/local/avr/include/util/delay.h **** 		__ticks = (uint16_t) (__ms * 10.0);
 174:/opt/local/avr/include/util/delay.h **** 		while(__ticks)
 175:/opt/local/avr/include/util/delay.h **** 		{
 176:/opt/local/avr/include/util/delay.h **** 			// wait 1/10 ms
 177:/opt/local/avr/include/util/delay.h **** 			_delay_loop_2(((F_CPU) / 4e3) / 10);
 178:/opt/local/avr/include/util/delay.h **** 			__ticks --;
 179:/opt/local/avr/include/util/delay.h **** 		}
 180:/opt/local/avr/include/util/delay.h **** 		return;
 181:/opt/local/avr/include/util/delay.h **** 	}
 182:/opt/local/avr/include/util/delay.h **** 	else
 183:/opt/local/avr/include/util/delay.h **** 		__ticks = (uint16_t)__tmp;
 184:/opt/local/avr/include/util/delay.h **** 	_delay_loop_2(__ticks);
 185:/opt/local/avr/include/util/delay.h **** #endif
 186:/opt/local/avr/include/util/delay.h **** }
 187:/opt/local/avr/include/util/delay.h **** 
 188:/opt/local/avr/include/util/delay.h **** /**
 189:/opt/local/avr/include/util/delay.h ****    \ingroup util_delay
 190:/opt/local/avr/include/util/delay.h **** 
 191:/opt/local/avr/include/util/delay.h ****    Perform a delay of \c __us microseconds, using _delay_loop_1().
 192:/opt/local/avr/include/util/delay.h **** 
 193:/opt/local/avr/include/util/delay.h ****    The macro F_CPU is supposed to be defined to a
 194:/opt/local/avr/include/util/delay.h ****    constant defining the CPU clock frequency (in Hertz).
 195:/opt/local/avr/include/util/delay.h **** 
 196:/opt/local/avr/include/util/delay.h ****    The maximal possible delay is 768 us / F_CPU in MHz.
 197:/opt/local/avr/include/util/delay.h **** 
 198:/opt/local/avr/include/util/delay.h ****    If the user requests a delay greater than the maximal possible one,
 199:/opt/local/avr/include/util/delay.h ****    _delay_us() will automatically call _delay_ms() instead.  The user
 200:/opt/local/avr/include/util/delay.h ****    will not be informed about this case.
 201:/opt/local/avr/include/util/delay.h **** 
 202:/opt/local/avr/include/util/delay.h ****    If the avr-gcc toolchain has __builtin_avr_delay_cycles(unsigned long)
 203:/opt/local/avr/include/util/delay.h ****    support, maximal possible delay is 4294967.295 us/ F_CPU in MHz. For
 204:/opt/local/avr/include/util/delay.h ****    values greater than the maximal possible delay, overflow results in
 205:/opt/local/avr/include/util/delay.h ****    no delay i.e., 0us.
 206:/opt/local/avr/include/util/delay.h ****   
 207:/opt/local/avr/include/util/delay.h ****    Conversion of __us into clock cycles may not always result in integer.
 208:/opt/local/avr/include/util/delay.h ****    By default, the clock cycles rounded up to next integer. This ensures that
 209:/opt/local/avr/include/util/delay.h ****    the user gets atleast __us microseconds of delay.
 210:/opt/local/avr/include/util/delay.h **** 
 211:/opt/local/avr/include/util/delay.h ****    Alternatively, user can define __DELAY_ROUND_DOWN__ and __DELAY_ROUND_CLOSEST__
 212:/opt/local/avr/include/util/delay.h ****    to round down and round to closest integer.
 213:/opt/local/avr/include/util/delay.h ****  
 214:/opt/local/avr/include/util/delay.h ****    Note: The new implementation of _delay_us(double __us) with 
 215:/opt/local/avr/include/util/delay.h ****     __builtin_avr_delay_cycles(unsigned long) support is not backward compatible.
 216:/opt/local/avr/include/util/delay.h ****    User can define __DELAY_BACKWARD_COMPATIBLE__ to get a backward compatible delay.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 11


 217:/opt/local/avr/include/util/delay.h ****    Also, the backward compatible
 218:/opt/local/avr/include/util/delay.h ****    algorithm will be chosen if the code is compiled in a <em>freestanding
 219:/opt/local/avr/include/util/delay.h ****    environment</em> (GCC option \c -ffreestanding), as the math functions
 220:/opt/local/avr/include/util/delay.h ****    required for rounding are not available to the compiler then.
 221:/opt/local/avr/include/util/delay.h **** 
 222:/opt/local/avr/include/util/delay.h ****  */
 223:/opt/local/avr/include/util/delay.h **** void
 224:/opt/local/avr/include/util/delay.h **** _delay_us(double __us)
 225:/opt/local/avr/include/util/delay.h **** {
 226:/opt/local/avr/include/util/delay.h **** 	double __tmp ; 
 227:/opt/local/avr/include/util/delay.h **** #if __HAS_DELAY_CYCLES && defined(__OPTIMIZE__) && \
 228:/opt/local/avr/include/util/delay.h ****   !defined(__DELAY_BACKWARD_COMPATIBLE__) &&	   \
 229:/opt/local/avr/include/util/delay.h ****   __STDC_HOSTED__
 230:/opt/local/avr/include/util/delay.h **** 	uint32_t __ticks_dc;
 231:/opt/local/avr/include/util/delay.h **** 	extern void __builtin_avr_delay_cycles(unsigned long);
 232:/opt/local/avr/include/util/delay.h **** 	__tmp = ((F_CPU) / 1e6) * __us;
 233:/opt/local/avr/include/util/delay.h **** 
 234:/opt/local/avr/include/util/delay.h **** 	#if defined(__DELAY_ROUND_DOWN__)
 235:/opt/local/avr/include/util/delay.h **** 		__ticks_dc = (uint32_t)fabs(__tmp);
 236:/opt/local/avr/include/util/delay.h **** 
 237:/opt/local/avr/include/util/delay.h **** 	#elif defined(__DELAY_ROUND_CLOSEST__)
 238:/opt/local/avr/include/util/delay.h **** 		__ticks_dc = (uint32_t)(fabs(__tmp)+0.5);
 239:/opt/local/avr/include/util/delay.h **** 
 240:/opt/local/avr/include/util/delay.h **** 	#else
 241:/opt/local/avr/include/util/delay.h **** 		//round up by default
 242:/opt/local/avr/include/util/delay.h **** 		__ticks_dc = (uint32_t)(ceil(fabs(__tmp)));
 243:/opt/local/avr/include/util/delay.h **** 	#endif
 244:/opt/local/avr/include/util/delay.h **** 
 245:/opt/local/avr/include/util/delay.h **** 	__builtin_avr_delay_cycles(__ticks_dc);
 210               		.stabn	68,0,245,.LM8-.LFBB2
 211               	.LM8:
 212 001e 8FE8      		ldi r24,lo8(399)
 213 0020 91E0      		ldi r25,hi8(399)
 214 0022 0197      		1: sbiw r24,1
 215 0024 01F4      		brne 1b
 216 0026 00C0      		rjmp .
 217 0028 0000      		nop
 218               	.L3:
 219               	.LBE75:
 220               	.LBE74:
 221               		.stabs	"./pll.c",132,0,0,.Ltext4
 222               	.Ltext4:
  75:./pll.c       ****    // 2: Wait 100us for the PLL to stabilize
  76:./pll.c       ****    // (can't use dmsWait since the timer updating the dmsCount hasn't yet been started!)
  77:./pll.c       ****    _delay_us(100);
  78:./pll.c       **** //   dmsWait(1);
  79:./pll.c       ****    // 3: Poll PLOCK until it is set...
  80:./pll.c       ****    while(!getbit(PLOCK, PLLCSR))
 223               		.stabn	68,0,80,.LM9-.LFBB2
 224               	.LM9:
 225 002a 09B4      		in __tmp_reg__,0x29
 226 002c 00FC      		sbrc __tmp_reg__,0
 227 002e 00C0      		rjmp .L6
  81:./pll.c       ****    {
  82:./pll.c       ****       asm("nop");
 228               		.stabn	68,0,82,.LM10-.LFBB2
 229               	.LM10:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 12


 230               	/* #APP */
 231               	 ;  82 "./pll.c" 1
 232 0030 0000      		nop
 233               	 ;  0 "" 2
 234               	/* #NOAPP */
 235 0032 00C0      		rjmp .L3
 236               	.L6:
  83:./pll.c       ****    }
  84:./pll.c       **** 
  85:./pll.c       **** //The PWM161 doesn't have a PCKE bit.
  86:./pll.c       **** #if(!defined(__AVR_AT90PWM161__))
  87:./pll.c       ****    // 4: Set the PCKE bit to enable async mode
  88:./pll.c       ****    setbit(PCKE, PLLCSR);
 237               		.stabn	68,0,88,.LM11-.LFBB2
 238               	.LM11:
 239 0034 89B5      		in r24,0x29
 240 0036 8460      		ori r24,lo8(4)
 241 0038 89BD      		out 0x29,r24
 242 003a 0895      		ret
 243               		.size	pll_enable, .-pll_enable
 244               	.Lscope2:
 245               		.stabs	"",36,0,0,.Lscope2-.LFBB2
 246               		.stabd	78,0,0
 247               		.stabs	"lvds_timerInit:F(0,47)",36,0,18,lvds_timerInit
 248               	.global	lvds_timerInit
 249               		.type	lvds_timerInit, @function
 250               	lvds_timerInit:
 251               		.stabd	46,0,0
 252               		.stabs	"_interfaces/lvds.c",132,0,0,.Ltext5
 253               	.Ltext5:
   1:_interfaces/lvds.c **** /* mehPL:
   2:_interfaces/lvds.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:_interfaces/lvds.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:_interfaces/lvds.c ****  *    Please see the bottom.
   5:_interfaces/lvds.c ****  *    Enjoy!
   6:_interfaces/lvds.c ****  */
   7:_interfaces/lvds.c **** 
   8:_interfaces/lvds.c **** 
   9:_interfaces/lvds.c **** 
  10:_interfaces/lvds.c **** 
  11:_interfaces/lvds.c **** #ifndef __LVDS_C__
  12:_interfaces/lvds.c **** #define __LVDS_C__
  13:_interfaces/lvds.c **** 
  14:_interfaces/lvds.c **** #include "lvds.h"
  15:_interfaces/lvds.c **** #include "pll.c"
  16:_interfaces/lvds.c **** 
  17:_interfaces/lvds.c **** 
  18:_interfaces/lvds.c **** void lvds_timerInit(void)
  19:_interfaces/lvds.c **** {
 254               		.stabn	68,0,19,.LM12-.LFBB3
 255               	.LM12:
 256               	.LFBB3:
 257               	/* prologue: function */
 258               	/* frame size = 0 */
 259               	/* stack size = 0 */
 260               	.L__stack_usage = 0
  20:_interfaces/lvds.c ****    //Timer1 is used for LVDS (in PLL clocking mode)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 13


  21:_interfaces/lvds.c ****   
  22:_interfaces/lvds.c ****      //pll_enable();   
  23:_interfaces/lvds.c ****    
  24:_interfaces/lvds.c ****    //We want it to count 7 bits, 0-6 and reset at 7
  25:_interfaces/lvds.c ****    OCR1C = 6;
 261               		.stabn	68,0,25,.LM13-.LFBB3
 262               	.LM13:
 263 003c 86E0      		ldi r24,lo8(6)
 264 003e 8BBD      		out 0x2b,r24
  26:_interfaces/lvds.c **** 
  27:_interfaces/lvds.c ****    //We want the clock to go low at TCNT=0 and high at TCNT=4
  28:_interfaces/lvds.c ****    CLOCK_OCR = 3; //2; //3;
 265               		.stabn	68,0,28,.LM14-.LFBB3
 266               	.LM14:
 267 0040 83E0      		ldi r24,lo8(3)
 268 0042 8CBD      		out 0x2c,r24
  29:_interfaces/lvds.c ****    
  30:_interfaces/lvds.c **** 
  31:_interfaces/lvds.c **** // My 'scope is only 20MHz, and I'd rather be able to use the digital mode
  32:_interfaces/lvds.c **** // which is even slower...
  33:_interfaces/lvds.c **** 
  34:_interfaces/lvds.c **** 
  35:_interfaces/lvds.c **** //Overridden when SLOW_EVERYTHING_TEST is true...
  36:_interfaces/lvds.c **** //#define TOOFAST_TEST TRUE
  37:_interfaces/lvds.c **** #warning "HERE AND BELOW, doesn't OSCCAL have special write requirements?"
  38:_interfaces/lvds.c **** //OSCCAL = 0x00;
  39:_interfaces/lvds.c **** #if (defined(SLOW_EVERYTHING_TEST) && SLOW_EVERYTHING_TEST)
  40:_interfaces/lvds.c **** //FOR TESTING. This should slow the clock...
  41:_interfaces/lvds.c ****    // Gives roughly 4MHz...
  42:_interfaces/lvds.c ****    OSCCAL = 0x00; //0x80; 
  43:_interfaces/lvds.c **** 
  44:_interfaces/lvds.c ****    // This should divide the system clock by 256
  45:_interfaces/lvds.c ****    // does this affect the PLL? NO.
  46:_interfaces/lvds.c ****    // The PLL is clocked only by the RC Oscillator
  47:_interfaces/lvds.c ****    //   OSCCAL does affect it.
  48:_interfaces/lvds.c ****    // OPTIONS FOR SIMULATING FULL FUNCTIONALITY AT LOW SPEED:
  49:_interfaces/lvds.c ****    // Run PLL as normal
  50:_interfaces/lvds.c ****    //  Prescale Timer1 and DeadTimer equally
  51:_interfaces/lvds.c ****    //  Prescale System clock equally
  52:_interfaces/lvds.c ****    CLKPR = (1<<CLKPCE);
  53:_interfaces/lvds.c ****    CLKPR = (1<<CLKPS1) | (1<<CLKPS0);   //CLKDIV8
  54:_interfaces/lvds.c ****    //4MHz / 8 = .5Mhz...
  55:_interfaces/lvds.c ****    //PLL is 4MHz*8 = 32MHz
  56:_interfaces/lvds.c ****    // then TimerClockDivisor=8 gives 4MHz
  57:_interfaces/lvds.c ****    pll_enable();
  58:_interfaces/lvds.c ****    #define SLOW_LVDS_TEST TRUE
  59:_interfaces/lvds.c **** #elif (defined(OSCCAL_VAL))
  60:_interfaces/lvds.c ****    OSCCAL = OSCCAL_VAL;
 269               		.stabn	68,0,60,.LM15-.LFBB3
 270               	.LM15:
 271 0044 8FEF      		ldi r24,lo8(-1)
 272 0046 81BF      		out 0x31,r24
  61:_interfaces/lvds.c **** #endif
  62:_interfaces/lvds.c **** 
  63:_interfaces/lvds.c **** 
  64:_interfaces/lvds.c **** 
  65:_interfaces/lvds.c **** #if (defined(SLOW_LVDS_TEST) && SLOW_LVDS_TEST)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 14


  66:_interfaces/lvds.c ****    //This case doesn't really make sense without SLOW_EVERYTHING...
  67:_interfaces/lvds.c ****    //8x prescaler for Timer1
  68:_interfaces/lvds.c ****    #define CSBITS (1<<CS12)
  69:_interfaces/lvds.c ****    //8x prescaler for the dead-timer
  70:_interfaces/lvds.c ****    #define DTPSBITS ((1<<DTPS11) | (1<<DTPS10))
  71:_interfaces/lvds.c **** #elif (defined(LVDS_PRESCALER))
  72:_interfaces/lvds.c ****    //Timer1 on the Tiny861 uses a strange CLKDIV scheme...
  73:_interfaces/lvds.c ****    // (but it's nicer!)
  74:_interfaces/lvds.c ****    // The divisor is (1<<(csbits-1))
  75:_interfaces/lvds.c ****    // so a divisor of 1 = (1<<0) = (1<<(1-1)), (csbits = 0x1)
  76:_interfaces/lvds.c ****    // 256 = (1<<8) = (1<<(9-1)), (csbits = 0x9)
  77:_interfaces/lvds.c ****    // 512 = (1<<9) = (1<<(10-1)), (csbits = 0xA)
  78:_interfaces/lvds.c ****    // ...
  79:_interfaces/lvds.c ****    // (0x0 stops the timer)
  80:_interfaces/lvds.c ****    /*
  81:_interfaces/lvds.c ****       uint16_t divisor;
  82:_interfaces/lvds.c ****       uint8_t csbits = 0;
  83:_interfaces/lvds.c ****       for(divisor=CLKDIV; divisor != 0; divisor>>=1)
  84:_interfaces/lvds.c ****          csbits++;
  85:_interfaces/lvds.c ****          writeMasked(csbits, 0x0f, TCCR1B);
  86:_interfaces/lvds.c ****    */
  87:_interfaces/lvds.c **** 
  88:_interfaces/lvds.c **** //#if ((LVDS_PRESCALER != 64) && (LVDS_PRESCALER != 32) && \
  89:_interfaces/lvds.c **** //     (LVDS_PRESCALER != 16) && 
  90:_interfaces/lvds.c **** #if ((LVDS_PRESCALER != 8) && \
  91:_interfaces/lvds.c ****      (LVDS_PRESCALER != 4)  && (LVDS_PRESCALER != 2) && \
  92:_interfaces/lvds.c ****      (LVDS_PRESCALER != 1))
  93:_interfaces/lvds.c **** #error "LVDS_PRESCALER must be a power of 2, from 1 to 8"
  94:_interfaces/lvds.c **** #endif
  95:_interfaces/lvds.c **** 
  96:_interfaces/lvds.c ****    //Figured this out in cTools/dePower.c...
  97:_interfaces/lvds.c ****    //64 is overkill here, since the deadTimer prescaler only goes to 8...
  98:_interfaces/lvds.c **** #define divToCS(div) \
  99:_interfaces/lvds.c ****    ( (div == 64) ? 7 : (div == 32) ? 6 : (div == 16) ? 5 : (div == 8) ? 4 \
 100:_interfaces/lvds.c ****      : (div == 4) ? 3 : (div == 2) ? 2 : (div == 1) ? 1 : 0)
 101:_interfaces/lvds.c **** 
 102:_interfaces/lvds.c **** 
 103:_interfaces/lvds.c ****    //CSBITS (through PLL/8) (CS10 is bit 0)
 104:_interfaces/lvds.c ****    //CS12:10   CS12   CS11   CS10      PLL division
 105:_interfaces/lvds.c ****    //1         0      0      1         1
 106:_interfaces/lvds.c ****    //2         0      1      0         2
 107:_interfaces/lvds.c ****    //3         0      1      1         4
 108:_interfaces/lvds.c ****    //4         1      0      0         8
 109:_interfaces/lvds.c ****    #define CSBITS divToCS(LVDS_PRESCALER) //<<CS10 should be redundant
 110:_interfaces/lvds.c ****    //DTPSBITS (DTPS10 is bit 4)
 111:_interfaces/lvds.c ****    //DTPS11:10   DTPS11 DTPS10   PLL division
 112:_interfaces/lvds.c ****    //0         0      0         1
 113:_interfaces/lvds.c ****    //1         0      1         2
 114:_interfaces/lvds.c ****    //2         1      0         4
 115:_interfaces/lvds.c ****    //3         1      1         8
 116:_interfaces/lvds.c ****    #define DTPSBITS ((CSBITS-1)<<DTPS10)
 117:_interfaces/lvds.c **** 
 118:_interfaces/lvds.c ****    //Whoops! Forgot this (a/o 42-som'n WTF1pix)
 119:_interfaces/lvds.c ****    // so, it's promising to get single-pixel control...
 120:_interfaces/lvds.c ****    //  the result was kinda ugly, though... scroll was quite slow
 121:_interfaces/lvds.c ****    // Further, it was only drawing a certain number of pixels...
 122:_interfaces/lvds.c ****    //  (horizontally... pre LVDS_PRESCALER affecting DOTS_TO_CYC)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 15


 123:_interfaces/lvds.c ****    //  so accessing *all* pixels in a row would make it even slower...
 124:_interfaces/lvds.c ****    // Further, it didn't seem to be paying attention to the fact that
 125:_interfaces/lvds.c ****    // the same pixels are drawn on multiple rows...
 126:_interfaces/lvds.c ****    // WTF? (the image was scaled, proportionately! 1pix x 1pix)
 127:_interfaces/lvds.c ****    pll_enable();
 273               		.stabn	68,0,127,.LM16-.LFBB3
 274               	.LM16:
 275 0048 00D0      		rcall pll_enable
 128:_interfaces/lvds.c **** 
 129:_interfaces/lvds.c **** #else
 130:_interfaces/lvds.c ****    //No clock divisor
 131:_interfaces/lvds.c ****    #define CSBITS (1<<CS10)
 132:_interfaces/lvds.c ****    //No dead-timer divisor
 133:_interfaces/lvds.c ****    #define DTPSBITS 0
 134:_interfaces/lvds.c ****    pll_enable();
 135:_interfaces/lvds.c ****    //#warning "The PLL configuration code is not in here yet!"
 136:_interfaces/lvds.c **** #endif
 137:_interfaces/lvds.c **** 
 138:_interfaces/lvds.c ****    //Set the Timer1 clock prescaler...
 139:_interfaces/lvds.c ****    writeMasked(CSBITS, 
 276               		.stabn	68,0,139,.LM17-.LFBB3
 277               	.LM17:
 278 004a 8FB5      		in r24,0x2f
 279 004c 807F      		andi r24,lo8(-16)
 280 004e 8160      		ori r24,lo8(1)
 281 0050 8FBD      		out 0x2f,r24
 140:_interfaces/lvds.c ****                ((1<<CS13) | (1<<CS12) | (1<<CS11) | (1<<CS10)),
 141:_interfaces/lvds.c ****                TCCR1B);
 142:_interfaces/lvds.c **** 
 143:_interfaces/lvds.c ****    //Set the DeadTime prescaler (no prescaling, same speed as TCNT1)...
 144:_interfaces/lvds.c ****    // Allegedly this is prescaled from the PCK (or CK)
 145:_interfaces/lvds.c ****    //    NOT from the Timer1 prescaler...
 146:_interfaces/lvds.c ****    writeMasked(DTPSBITS,
 282               		.stabn	68,0,146,.LM18-.LFBB3
 283               	.LM18:
 284 0052 8FB5      		in r24,0x2f
 285 0054 8F7C      		andi r24,lo8(-49)
 286 0056 8FBD      		out 0x2f,r24
 147:_interfaces/lvds.c ****                ((1<<DTPS11) | (1<<DTPS10)),
 148:_interfaces/lvds.c ****                TCCR1B);
 149:_interfaces/lvds.c **** 
 150:_interfaces/lvds.c **** 
 151:_interfaces/lvds.c **** 
 152:_interfaces/lvds.c ****    //All LVDS modes (and signals) use FastPWM.. 
 153:_interfaces/lvds.c ****  
 154:_interfaces/lvds.c ****    //FastPWM
 155:_interfaces/lvds.c **** //Now Handled in lvds_xxxOnCompare():
 156:_interfaces/lvds.c **** 
 157:_interfaces/lvds.c ****    //These are also written below (excluding PWM1D)
 158:_interfaces/lvds.c ****    setbit(PWM1A, TCCR1A);  //Enable PWM on OC1A for DVH
 287               		.stabn	68,0,158,.LM19-.LFBB3
 288               	.LM19:
 289 0058 80B7      		in r24,0x30
 290 005a 8260      		ori r24,lo8(2)
 291 005c 80BF      		out 0x30,r24
 159:_interfaces/lvds.c ****                            //Need to do the same for other channels
 160:_interfaces/lvds.c ****   
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 16


 161:_interfaces/lvds.c ****    setbit(PWM1B, TCCR1A);  //Enable PWM on OC1B for CLOCK 
 292               		.stabn	68,0,161,.LM20-.LFBB3
 293               	.LM20:
 294 005e 80B7      		in r24,0x30
 295 0060 8160      		ori r24,lo8(1)
 296 0062 80BF      		out 0x30,r24
 162:_interfaces/lvds.c **** 
 163:_interfaces/lvds.c ****    setbit(PWM1D, TCCR1C);
 297               		.stabn	68,0,163,.LM21-.LFBB3
 298               	.LM21:
 299 0064 87B5      		in r24,0x27
 300 0066 8160      		ori r24,lo8(1)
 301 0068 87BD      		out 0x27,r24
 164:_interfaces/lvds.c **** 
 165:_interfaces/lvds.c ****    //PWM1D is not in TCCR1A...
 166:_interfaces/lvds.c **** 
 167:_interfaces/lvds.c ****    setoutPORT(PB1, PORTB);   //+OC1A, DVH/BLUE, MISO (usually heart)
 302               		.stabn	68,0,167,.LM22-.LFBB3
 303               	.LM22:
 304 006a B99A      		sbi 0x17,1
 168:_interfaces/lvds.c **** //   setoutPORT(PB0, PORTB);   //-OC1A    MOSI unused
 169:_interfaces/lvds.c ****    setoutPORT(PB2, PORTB); //-OC1B, -GREEN    (INVERTED) SCK
 305               		.stabn	68,0,169,.LM23-.LFBB3
 306               	.LM23:
 307 006c BA9A      		sbi 0x17,2
 170:_interfaces/lvds.c ****    setoutPORT(PB3, PORTB); //+OC1B Clock (OC1B, not inverted)
 308               		.stabn	68,0,170,.LM24-.LFBB3
 309               	.LM24:
 310 006e BB9A      		sbi 0x17,3
 171:_interfaces/lvds.c ****    setoutPORT(PB5, PORTB); //+OC1D, RED
 311               		.stabn	68,0,171,.LM25-.LFBB3
 312               	.LM25:
 313 0070 BD9A      		sbi 0x17,5
 172:_interfaces/lvds.c **** 
 173:_interfaces/lvds.c **** 
 174:_interfaces/lvds.c ****    writeMasked(((0<<WGM11) | (0<<WGM10)), //FastPWM (combined with above)
 314               		.stabn	68,0,174,.LM26-.LFBB3
 315               	.LM26:
 316 0072 86B5      		in r24,0x26
 317 0074 8C7F      		andi r24,lo8(-4)
 318 0076 86BD      		out 0x26,r24
 175:_interfaces/lvds.c ****                ((1<<WGM11) | (1<<WGM10)), // (affects all PWM channels)
 176:_interfaces/lvds.c ****                TCCR1D);
 177:_interfaces/lvds.c **** 
 178:_interfaces/lvds.c ****    //OC1A is used, but /OC1A isn't
 179:_interfaces/lvds.c **** // Not Valid (deadTime only functions if in complementary-mode):
 180:_interfaces/lvds.c ****    // OTOH: dead-time is not necessary in the only case we need to switch
 181:_interfaces/lvds.c ****    // Most lvds states use clear on compare-match, set at 0
 182:_interfaces/lvds.c ****    // But there is one that uses the opposite
 183:_interfaces/lvds.c ****    // This can be toggled by a single bit-change
 184:_interfaces/lvds.c ****    //  COM1A1 = 1
 185:_interfaces/lvds.c ****    //  COM1A0 value indicates what happens on Compare-Match
 186:_interfaces/lvds.c ****    //                 or ! at BOTTOM
 187:_interfaces/lvds.c **** //#define lvds_clrOnCompare() clrbit(COM1A0, TCCR1A)
 188:_interfaces/lvds.c **** //#define lvds_setOnCompare() setbit(COM1A0, TCCR1A)
 189:_interfaces/lvds.c ****    //HOWEVER: the alternative is possible:
 190:_interfaces/lvds.c ****    // Use complementary (clear-on-compare)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 17


 191:_interfaces/lvds.c ****    // and single-ended with set-on-compare
 192:_interfaces/lvds.c ****    // COM1A0 = 1
 193:_interfaces/lvds.c ****    // COM1A1 value indicates what happens on Compare-Match
 194:_interfaces/lvds.c **** 
 195:_interfaces/lvds.c **** /* These are three instructions apiece!
 196:_interfaces/lvds.c **** #define lvds_ComplementaryClrOnCompare() clrbit(COM1A1, TCCR1A)
 197:_interfaces/lvds.c **** 
 198:_interfaces/lvds.c **** #define lvds_setOnCompare() setbit(COM1A1, TCCR1A)
 199:_interfaces/lvds.c **** #define lvds_clrOnCompare() lvds_ComplementaryClrOnCompare()
 200:_interfaces/lvds.c **** */
 201:_interfaces/lvds.c **** 
 202:_interfaces/lvds.c **** //Page 99:
 203:_interfaces/lvds.c **** // "In Fast PWM Mode ... when the COM1x1:0 bits are set to 01 ...
 204:_interfaces/lvds.c **** //  an user programmable Dead Time delay is inserted for 
 205:_interfaces/lvds.c **** //  these complementary output pairs (OC1x and OC1x)."
 206:_interfaces/lvds.c **** 
 207:_interfaces/lvds.c **** //Page 98:
 208:_interfaces/lvds.c **** // "The counter is loaded with a 4-bit DT1H or DT1L value from DT1 
 209:_interfaces/lvds.c **** //  I/O register, depending on the edge of the Waveform 
 210:_interfaces/lvds.c **** //  Output (OCW1x) when the dead time insertion is started."
 211:_interfaces/lvds.c **** // In other words, (as it appears from the diagram)
 212:_interfaces/lvds.c **** //  the dead-time value is loaded into the counter when the corresponding
 213:_interfaces/lvds.c **** //  edge in OCW1x is detected
 214:_interfaces/lvds.c **** //  So changing the value of DT1 affects the *next* corresponding edge 
 215:_interfaces/lvds.c **** //   (NOT if the dead timer is already running)
 216:_interfaces/lvds.c **** 
 217:_interfaces/lvds.c **** //Page 96:
 218:_interfaces/lvds.c **** // "The OCR1x Registers are double buffered when using any of the 
 219:_interfaces/lvds.c **** // Pulse Width Modulation (PWM) modes."
 220:_interfaces/lvds.c **** // "The double buffering synchronizes the update of the OCR1x 
 221:_interfaces/lvds.c **** // Compare Registers to either top or bottom of the counting sequence.
 222:_interfaces/lvds.c **** // The synchronization prevents the occurrence of odd-length, non-sym- 
 223:_interfaces/lvds.c **** // metrical PWM pulses, thereby making the output glitch-free."
 224:_interfaces/lvds.c **** 
 225:_interfaces/lvds.c **** //Page 100:
 226:_interfaces/lvds.c **** //"A change of the COM1x1:0 bits state will have effect 
 227:_interfaces/lvds.c **** // at the first Compare Match after the bits are written."
 228:_interfaces/lvds.c **** //Page 97: HAH!
 229:_interfaces/lvds.c **** //"Be aware that the COM1x1:0 bits are not double buffered 
 230:_interfaces/lvds.c **** // together with the compare value. 
 231:_interfaces/lvds.c **** // Changing the COM1x1:0 bits will take effect immediately."
 232:_interfaces/lvds.c **** 
 233:_interfaces/lvds.c **** 
 234:_interfaces/lvds.c **** //#define lvds_setOnCompare()   
 235:_interfaces/lvds.c **** //   TCCR1A = ( (1<<COM1A1) | (1<<COM1A0) 
 236:_interfaces/lvds.c **** //            | (0<<COM1B1) | (1<<COM1B0) 
 237:_interfaces/lvds.c **** //            | (1<<PWM1A) | (1<<PWM1B) )
 238:_interfaces/lvds.c **** //#define lvds_ComplementaryClrOnCompare() \ //
 239:_interfaces/lvds.c ****    //Do TCCR1C first, because it contains shadow-bits of TCCR1A that I
 240:_interfaces/lvds.c ****    // don't want to have to rewrite...
 241:_interfaces/lvds.c ****    TCCR1C = ( (1<<COM1D1) | (0<<COM1D0)
 319               		.stabn	68,0,241,.LM27-.LFBB3
 320               	.LM27:
 321 0078 89E0      		ldi r24,lo8(9)
 322 007a 87BD      		out 0x27,r24
 242:_interfaces/lvds.c ****             | (1<<PWM1D) );
 243:_interfaces/lvds.c **** /* a/o v62-17: The notes are sparse as to why I disabled the Green signal
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 18


 244:_interfaces/lvds.c ****  * at all times, except during DE... As I recall, it was an experiment with
 245:_interfaces/lvds.c ****  * whether it was possible to get greater control over BLUE, by hacking the
 246:_interfaces/lvds.c ****  * clock signal during the DE period... e.g. since none of the V/H timings
 247:_interfaces/lvds.c ****  * are necessary during DE, maybe it was possible to have a clock that
 248:_interfaces/lvds.c ****  * wasn't perfectly as-spec'd... it didn't work. So, why not remove the
 249:_interfaces/lvds.c ****  * necessity for enabling/disabling the green signal...
 250:_interfaces/lvds.c ****  (Yes, it's that tightly-knit that affecting the clock affects green,
 251:_interfaces/lvds.c ****  affects blue... but there's some confusion in my mind as to why green
 252:_interfaces/lvds.c ****  couldn't've remained active anyhow...)
 253:_interfaces/lvds.c ****  Ahh, wait, something about when Complementary mode is enabled, then the
 254:_interfaces/lvds.c ****  clock is affected by Dead-Times... Still a bit vague.
 255:_interfaces/lvds.c **** */
 256:_interfaces/lvds.c **** //	TCCR1A = ( (0<<COM1A1) | (1<<COM1A0) 
 257:_interfaces/lvds.c **** //            | (1<<COM1B1) | (0<<COM1B0) //Don't use complementary for CLK
 258:_interfaces/lvds.c **** //            | (1<<PWM1A) | (1<<PWM1B) );
 259:_interfaces/lvds.c **** 	lvds_disableGreen_MakeClockInsensitiveToDT();
 323               		.stabn	68,0,259,.LM28-.LFBB3
 324               	.LM28:
 325 007c 83E6      		ldi r24,lo8(99)
 326 007e 80BF      		out 0x30,r24
 260:_interfaces/lvds.c **** 	//This was attempted in v66.51 (a/o v91)
 261:_interfaces/lvds.c **** 	// And for some reason didn't work... It should, no? See notes re
 262:_interfaces/lvds.c **** 	// FULL_INIT_TESTS and v66.51 in lvds.h
 263:_interfaces/lvds.c **** // lvds_enableGreen_MakeClockSensitiveToDT();
 264:_interfaces/lvds.c **** 
 265:_interfaces/lvds.c **** 
 266:_interfaces/lvds.c **** 	
 267:_interfaces/lvds.c **** /* ... but this didn't work... nothing's showing up at all.
 268:_interfaces/lvds.c **** 	TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
 269:_interfaces/lvds.c **** 	         | (0<<COM1B1) | (1<<COM1B0)
 270:_interfaces/lvds.c **** 	         | (1<<PWM1A) | (1<<PWM1B) );
 271:_interfaces/lvds.c **** */
 272:_interfaces/lvds.c **** 
 273:_interfaces/lvds.c **** //#define lvds_clrOnCompare() lvds_ComplementaryClrOnCompare()
 274:_interfaces/lvds.c **** 
 275:_interfaces/lvds.c ****    // Enable Complementary-Mode (and thus the dead-timer)
 276:_interfaces/lvds.c ****    // This'll be changed as needed, but we need COM1A0 set prior to that
 277:_interfaces/lvds.c **** 
 278:_interfaces/lvds.c ****    //   lvds_clrOnCompare();
 279:_interfaces/lvds.c **** //   writeMasked(((0<<COM1A1) | (1<<COM1A0)), 
 280:_interfaces/lvds.c **** //               ((1<<COM1A1) | (1<<COM1A0)), 
 281:_interfaces/lvds.c **** //               TCCR1A);
 282:_interfaces/lvds.c **** 
 283:_interfaces/lvds.c **** 
 284:_interfaces/lvds.c **** 
 285:_interfaces/lvds.c ****    //THIS IS NOT THOROUGHLY THOUGHT-OUT...
 286:_interfaces/lvds.c ****    // as I recall, we need to use /OC1B for the clock output
 287:_interfaces/lvds.c ****    //  because it won't be affected by the deadtime...
 288:_interfaces/lvds.c **** //Now Handled in lvds_xxxOnCompare():
 289:_interfaces/lvds.c **** //   writeMasked(((0<<COM1B1) | (1<<COM1B0)),
 290:_interfaces/lvds.c **** //               ((1<<COM1B1) | (1<<COM1B0)),
 291:_interfaces/lvds.c **** //               TCCR1A);
 292:_interfaces/lvds.c **** 
 293:_interfaces/lvds.c ****    //Since PWM inversion affects all channels, great-pains were taken
 294:_interfaces/lvds.c ****    // to assure that it needn't be changed in any lvds state...
 295:_interfaces/lvds.c ****    // PWM inversion must be enabled:
 296:_interfaces/lvds.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 19


 297:_interfaces/lvds.c ****    //inverted with PWM1X
 298:_interfaces/lvds.c **** //   setbit(PWM1X, TCCR1B);
 299:_interfaces/lvds.c **** 
 300:_interfaces/lvds.c **** 
 301:_interfaces/lvds.c **** //Another attempt (in v66.51, a/o v91):
 302:_interfaces/lvds.c **** 	// Irrelevent (?) since Nada_init() overwrites it...
 303:_interfaces/lvds.c **** 	// //Make sure Green is off...
 304:_interfaces/lvds.c **** 	// DT1 = 3;
 305:_interfaces/lvds.c **** 
 306:_interfaces/lvds.c **** 
 307:_interfaces/lvds.c **** 
 308:_interfaces/lvds.c ****     Nada_init();
 327               		.stabn	68,0,308,.LM29-.LFBB3
 328               	.LM29:
 329 0080 80E3      		ldi r24,lo8(48)
 330 0082 84BD      		out 0x24,r24
 331 0084 84E0      		ldi r24,lo8(4)
 332 0086 8DBD      		out 0x2d,r24
 333 0088 0895      		ret
 334               		.size	lvds_timerInit, .-lvds_timerInit
 335               	.Lscope3:
 336               		.stabs	"",36,0,0,.Lscope3-.LFBB3
 337               		.stabd	78,0,0
 338               		.stabs	"setColor:F(0,47)",36,0,81,setColor
 339               		.stabs	"red:P(4,2)",64,0,81,26
 340               		.stabs	"green:P(4,2)",64,0,81,19
 341               		.stabs	"blue:P(4,2)",64,0,81,20
 342               		.stabs	"row:P(4,2)",64,0,82,18
 343               		.stabs	"col:P(4,2)",64,0,82,16
 344               	.global	setColor
 345               		.type	setColor, @function
 346               	setColor:
 347               		.stabd	46,0,0
 348               		.stabs	"./_options/frameBuffer.c",132,0,0,.Ltext6
 349               	.Ltext6:
   1:./_options/frameBuffer.c **** /* mehPL:
   2:./_options/frameBuffer.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:./_options/frameBuffer.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:./_options/frameBuffer.c ****  *    Please see the bottom.
   5:./_options/frameBuffer.c ****  *    Enjoy!
   6:./_options/frameBuffer.c ****  */
   7:./_options/frameBuffer.c **** 
   8:./_options/frameBuffer.c **** 
   9:./_options/frameBuffer.c **** 
  10:./_options/frameBuffer.c **** 
  11:./_options/frameBuffer.c **** 
  12:./_options/frameBuffer.c **** 
  13:./_options/frameBuffer.c **** 
  14:./_options/frameBuffer.c **** // 30 < MAIN_MS < 300
  15:./_options/frameBuffer.c **** #if (MAIN_MS < 30)
  16:./_options/frameBuffer.c **** #error "WTF?"
  17:./_options/frameBuffer.c **** #endif
  18:./_options/frameBuffer.c **** 
  19:./_options/frameBuffer.c **** 
  20:./_options/frameBuffer.c **** 
  21:./_options/frameBuffer.c **** 
  22:./_options/frameBuffer.c **** //Please see writeColor.c
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 20


  23:./_options/frameBuffer.c **** 
  24:./_options/frameBuffer.c **** 
  25:./_options/frameBuffer.c **** #if(defined(FB_REFRESH_ON_CHANGE) && FB_REFRESH_ON_CHANGE)
  26:./_options/frameBuffer.c **** extern volatile uint8_t updateFrame;
  27:./_options/frameBuffer.c **** 
  28:./_options/frameBuffer.c **** void restartFrameUpdate(void);
  29:./_options/frameBuffer.c **** #endif
  30:./_options/frameBuffer.c **** 
  31:./_options/frameBuffer.c **** //drawPix from program memory
  32:./_options/frameBuffer.c **** //a/0 v60: Again, unused for its original purpose, but tightly intertwined
  33:./_options/frameBuffer.c **** // in old code that's still being (mis)used...
  34:./_options/frameBuffer.c **** #ifndef FB_WIDTH
  35:./_options/frameBuffer.c ****  #define FB_WIDTH 16
  36:./_options/frameBuffer.c ****  #error "This error a/o v80, just noting that FB_WIDTH wasn't previously defined elsewhere..."
  37:./_options/frameBuffer.c **** #endif
  38:./_options/frameBuffer.c **** #ifndef FB_HEIGHT
  39:./_options/frameBuffer.c ****  #define FB_HEIGHT 16
  40:./_options/frameBuffer.c **** #endif
  41:./_options/frameBuffer.c **** 
  42:./_options/frameBuffer.c **** //FB_WIDTH+1 is a hack for displaying the last pixel equal-length...
  43:./_options/frameBuffer.c **** // see writeColor() notes in nonRSB_drawPix()
  44:./_options/frameBuffer.c **** uint8_t frameBuffer[FB_HEIGHT][FB_WIDTH+1];
  45:./_options/frameBuffer.c **** /*	This does NOT init just these elements, but ALL elements
  46:./_options/frameBuffer.c **** 	Which takes up a TON of program-space.
  47:./_options/frameBuffer.c **** 	Moved to frameBufferInit();
  48:./_options/frameBuffer.c **** 	= 
  49:./_options/frameBuffer.c **** { 
  50:./_options/frameBuffer.c **** 	[0 ... FB_HEIGHT-1][FB_WIDTH]=_W
  51:./_options/frameBuffer.c **** };
  52:./_options/frameBuffer.c **** */
  53:./_options/frameBuffer.c **** /*
  54:./_options/frameBuffer.c **** { 
  55:./_options/frameBuffer.c **** 	[0][FB_WIDTH]=_W,
  56:./_options/frameBuffer.c **** 	[1][FB_WIDTH]=_W,
  57:./_options/frameBuffer.c **** 	[2][FB_WIDTH]=_W,
  58:./_options/frameBuffer.c **** 	[3][FB_WIDTH]=_W,
  59:./_options/frameBuffer.c **** 	[4][FB_WIDTH]=_W,
  60:./_options/frameBuffer.c **** 	[5][FB_WIDTH]=_W,
  61:./_options/frameBuffer.c **** 	[6][FB_WIDTH]=_W,
  62:./_options/frameBuffer.c **** 	[7][FB_WIDTH]=_W,
  63:./_options/frameBuffer.c **** 	[8][FB_WIDTH]=_W,
  64:./_options/frameBuffer.c **** 	[9][FB_WIDTH]=_W,
  65:./_options/frameBuffer.c **** 	[10][FB_WIDTH]=_W,
  66:./_options/frameBuffer.c **** 	[11][FB_WIDTH]=_W,
  67:./_options/frameBuffer.c **** 	[12][FB_WIDTH]=_W,
  68:./_options/frameBuffer.c **** 	[13][FB_WIDTH]=_W,
  69:./_options/frameBuffer.c **** 	[14][FB_WIDTH]=_W,
  70:./_options/frameBuffer.c **** 	[15][FB_WIDTH]=_W
  71:./_options/frameBuffer.c **** }
  72:./_options/frameBuffer.c **** */
  73:./_options/frameBuffer.c **** 
  74:./_options/frameBuffer.c **** 
  75:./_options/frameBuffer.c **** //AHHH it wasn't IMAGE_BUFFER that's entangled, but IMAGE_CHANGE
  76:./_options/frameBuffer.c **** // which is even weirder.
  77:./_options/frameBuffer.c **** 
  78:./_options/frameBuffer.c **** //This was #if'd into existence with IMAGE_BUFFER, but since it's only been
  79:./_options/frameBuffer.c **** // used with frameBuffer, and since IMAGE_BUFFER is somewhat entangled with
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 21


  80:./_options/frameBuffer.c **** // newer stuff, I'm putting it here and NOT including this file, (yet)
  81:./_options/frameBuffer.c **** void setColor(uint8_t red, uint8_t green, uint8_t blue, 
  82:./_options/frameBuffer.c ****                uint8_t row, uint8_t col)
  83:./_options/frameBuffer.c **** {
 350               		.stabn	68,0,83,.LM30-.LFBB4
 351               	.LM30:
 352               	.LFBB4:
 353 008a 0F93      		push r16
 354               	/* prologue: function */
 355               	/* frame size = 0 */
 356               	/* stack size = 1 */
 357               	.L__stack_usage = 1
 358 008c A82F      		mov r26,r24
 359 008e 362F      		mov r19,r22
  84:./_options/frameBuffer.c ****    red = (red > 3) ? 3 : red;
  85:./_options/frameBuffer.c ****    green = (green > 3) ? 3 : green;
  86:./_options/frameBuffer.c ****    blue = (blue > 3) ? 3 : blue;
  87:./_options/frameBuffer.c **** 
  88:./_options/frameBuffer.c ****    frameBuffer[row][col] = red | ((green)<<2) | ((blue)<<4);
 360               		.stabn	68,0,88,.LM31-.LFBB4
 361               	.LM31:
 362 0090 822F      		mov r24,r18
 363 0092 90E0      		ldi r25,0
 364 0094 61E1      		ldi r22,lo8(17)
 365 0096 70E0      		ldi r23,0
 366 0098 00D0      		rcall __mulhi3
 367 009a FC01      		movw r30,r24
 368 009c E00F      		add r30,r16
 369 009e F11D      		adc r31,__zero_reg__
 370 00a0 E050      		subi r30,lo8(-(frameBuffer))
 371 00a2 F040      		sbci r31,hi8(-(frameBuffer))
  86:./_options/frameBuffer.c **** 
 372               		.stabn	68,0,86,.LM32-.LFBB4
 373               	.LM32:
 374 00a4 4430      		cpi r20,lo8(4)
 375 00a6 00F0      		brlo .L9
 376 00a8 43E0      		ldi r20,lo8(3)
 377               	.L9:
 378               		.stabn	68,0,88,.LM33-.LFBB4
 379               	.LM33:
 380 00aa 50E0      		ldi r21,0
 381 00ac 84E0      		ldi r24,4
 382               		1:
 383 00ae 440F      		lsl r20
 384 00b0 551F      		rol r21
 385 00b2 8A95      		dec r24
 386 00b4 01F4      		brne 1b
  84:./_options/frameBuffer.c ****    red = (red > 3) ? 3 : red;
 387               		.stabn	68,0,84,.LM34-.LFBB4
 388               	.LM34:
 389 00b6 8A2F      		mov r24,r26
 390 00b8 A430      		cpi r26,lo8(4)
 391 00ba 00F0      		brlo .L10
 392 00bc 83E0      		ldi r24,lo8(3)
 393               	.L10:
 394               		.stabn	68,0,88,.LM35-.LFBB4
 395               	.LM35:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 22


 396 00be 482B      		or r20,r24
  85:./_options/frameBuffer.c ****    blue = (blue > 3) ? 3 : blue;
 397               		.stabn	68,0,85,.LM36-.LFBB4
 398               	.LM36:
 399 00c0 632F      		mov r22,r19
 400 00c2 3430      		cpi r19,lo8(4)
 401 00c4 00F0      		brlo .L11
 402 00c6 63E0      		ldi r22,lo8(3)
 403               	.L11:
 404               		.stabn	68,0,88,.LM37-.LFBB4
 405               	.LM37:
 406 00c8 660F      		lsl r22
 407 00ca 660F      		lsl r22
 408 00cc 642B      		or r22,r20
 409 00ce 6083      		st Z,r22
 410               	/* epilogue start */
  89:./_options/frameBuffer.c **** }
 411               		.stabn	68,0,89,.LM38-.LFBB4
 412               	.LM38:
 413 00d0 0F91      		pop r16
 414 00d2 0895      		ret
 415               		.size	setColor, .-setColor
 416               	.Lscope4:
 417               		.stabs	"",36,0,0,.Lscope4-.LFBB4
 418               		.stabd	78,0,0
 419               		.stabs	"frameBufferInit:F(0,47)",36,0,112,frameBufferInit
 420               	.global	frameBufferInit
 421               		.type	frameBufferInit, @function
 422               	frameBufferInit:
 423               		.stabd	46,0,0
  90:./_options/frameBuffer.c **** 
  91:./_options/frameBuffer.c **** 
  92:./_options/frameBuffer.c **** 
  93:./_options/frameBuffer.c **** 
  94:./_options/frameBuffer.c **** //Called as: pgm_readImageByte(pgm_image1, row, col)
  95:./_options/frameBuffer.c **** #define pgm_readImageByte(image, row, col)   \
  96:./_options/frameBuffer.c ****       pgm_read_byte((uint8_t *)(&((image)[(row)*FB_WIDTH+(col)])))
  97:./_options/frameBuffer.c **** 
  98:./_options/frameBuffer.c **** 
  99:./_options/frameBuffer.c **** //a/o v86: I can't recall why I chose white to display at the end of the
 100:./_options/frameBuffer.c **** //row... it may have had to do with the lvds displays and the timing stuff,
 101:./_options/frameBuffer.c **** //so I could actually see where the DE data was ending...(?)
 102:./_options/frameBuffer.c **** // Either way, I'd prefer it to be black in this particular instance, so
 103:./_options/frameBuffer.c **** // FB_END_OF_ROW_COLOR is now predefinable...
 104:./_options/frameBuffer.c **** #ifndef FB_END_OF_ROW_COLOR
 105:./_options/frameBuffer.c **** #define FB_END_OF_ROW_COLOR	_W
 106:./_options/frameBuffer.c **** #endif
 107:./_options/frameBuffer.c **** 
 108:./_options/frameBuffer.c **** // This stuff was located in main() before the while loop...
 109:./_options/frameBuffer.c **** // #if !COLOR_BAR_SCROLL... (which is *nearly every case* including 
 110:./_options/frameBuffer.c **** //  RowSegBuffer, etc)
 111:./_options/frameBuffer.c **** // it's long-since been commented-out...
 112:./_options/frameBuffer.c **** void frameBufferInit(void)
 113:./_options/frameBuffer.c **** {
 424               		.stabn	68,0,113,.LM39-.LFBB5
 425               	.LM39:
 426               	.LFBB5:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 23


 427               	/* prologue: function */
 428               	/* frame size = 0 */
 429               	/* stack size = 0 */
 430               	.L__stack_usage = 0
 431 00d4 E0E0      		ldi r30,lo8(frameBuffer+16)
 432 00d6 F0E0      		ldi r31,hi8(frameBuffer+16)
 114:./_options/frameBuffer.c **** 	//_W in FB_WIDTH is a hack for equal-length pixels, see frameBuffer's
 115:./_options/frameBuffer.c **** 	//definition, above.
 116:./_options/frameBuffer.c **** 	uint8_t i;
 117:./_options/frameBuffer.c **** 	for(i=0; i<FB_HEIGHT; i++)
 118:./_options/frameBuffer.c **** 		frameBuffer[i][FB_WIDTH] = FB_END_OF_ROW_COLOR;
 433               		.stabn	68,0,118,.LM40-.LFBB5
 434               	.LM40:
 435 00d8 8FE3      		ldi r24,lo8(63)
 436               	.L14:
 437               		.stabn	68,0,118,.LM41-.LFBB5
 438               	.LM41:
 439 00da 8083      		st Z,r24
 440 00dc 7196      		adiw r30,17
 117:./_options/frameBuffer.c **** 		frameBuffer[i][FB_WIDTH] = FB_END_OF_ROW_COLOR;
 441               		.stabn	68,0,117,.LM42-.LFBB5
 442               	.LM42:
 443 00de 90E0      		ldi r25,hi8(frameBuffer+288)
 444 00e0 E030      		cpi r30,lo8(frameBuffer+288)
 445 00e2 F907      		cpc r31,r25
 446 00e4 01F4      		brne .L14
 447               	/* epilogue start */
 119:./_options/frameBuffer.c **** 
 120:./_options/frameBuffer.c **** 
 121:./_options/frameBuffer.c **** 
 122:./_options/frameBuffer.c **** 	 //uint8_t frameBuffer[16][16];
 123:./_options/frameBuffer.c **** /*   for(r=0; r<FB_HEIGHT; r++)
 124:./_options/frameBuffer.c ****    {
 125:./_options/frameBuffer.c ****       for(c=0; c<FB_WIDTH; c++)
 126:./_options/frameBuffer.c ****       {
 127:./_options/frameBuffer.c ****          uint8_t imagePixel=pgm_readImageByte(pgm_image1, r, c);
 128:./_options/frameBuffer.c **** 
 129:./_options/frameBuffer.c ****          setColor(
 130:./_options/frameBuffer.c ****             (getbit(RED_IMAGEVAL_BIT, imagePixel) ? 0x03 : 0),
 131:./_options/frameBuffer.c ****             (getbit(GREEN_IMAGEVAL_BIT, imagePixel) ? 0x0C : 0),
 132:./_options/frameBuffer.c ****             (getbit(BLUE_IMAGEVAL_BIT, imagePixel) ? 0x30 : 0),
 133:./_options/frameBuffer.c ****             r, c);
 134:./_options/frameBuffer.c **** //         setBlue(
 135:./_options/frameBuffer.c **** //               (
 136:./_options/frameBuffer.c **** //   (getbit(BLUE_IMAGEVAL_BIT, imagePixel) ? (60<<2) : 0) |
 137:./_options/frameBuffer.c **** //   (getbit(GREEN_IMAGEVAL_BIT, imagePixel) ? (1<<GREEN_BLUEVAL_BIT) : 0) |
 138:./_options/frameBuffer.c **** //   (getbit(RED_IMAGEVAL_BIT, imagePixel) ? (1<<RED_BLUEVAL_BIT) : 0)
 139:./_options/frameBuffer.c **** //               ), r, c);
 140:./_options/frameBuffer.c ****       }
 141:./_options/frameBuffer.c ****    }
 142:./_options/frameBuffer.c **** */
 143:./_options/frameBuffer.c **** 
 144:./_options/frameBuffer.c **** }
 448               		.stabn	68,0,144,.LM43-.LFBB5
 449               	.LM43:
 450 00e6 0895      		ret
 451               		.size	frameBufferInit, .-frameBufferInit
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 24


 452               	.Lscope5:
 453               		.stabs	"",36,0,0,.Lscope5-.LFBB5
 454               		.stabd	78,0,0
 455               		.stabs	"writeColorDelay:F(0,47)",36,0,231,writeColorDelay
 456               	.global	writeColorDelay
 457               		.type	writeColorDelay, @function
 458               	writeColorDelay:
 459               		.stabd	46,0,0
 460               		.stabs	"_options/writeColor.c",132,0,0,.Ltext7
 461               	.Ltext7:
   1:_options/writeColor.c **** /* mehPL:
   2:_options/writeColor.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:_options/writeColor.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:_options/writeColor.c ****  *    Please see the bottom.
   5:_options/writeColor.c ****  *    Enjoy!
   6:_options/writeColor.c ****  */
   7:_options/writeColor.c **** 
   8:_options/writeColor.c **** 
   9:_options/writeColor.c **** 
  10:_options/writeColor.c **** 
  11:_options/writeColor.c **** 
  12:_options/writeColor.c **** 
  13:_options/writeColor.c **** 
  14:_options/writeColor.c **** 
  15:_options/writeColor.c **** 
  16:_options/writeColor.c **** 
  17:_options/writeColor.c **** 
  18:_options/writeColor.c **** 
  19:_options/writeColor.c **** //writeColor() is a hokey method to draw individual pixels from a buffer,
  20:_options/writeColor.c **** //either a row-buffer or a frame-buffer.
  21:_options/writeColor.c **** // I say "hokey" because the associated drawPix() function has individual
  22:_options/writeColor.c **** // calls to writeColor(), rather than putting them in a for-loop... in
  23:_options/writeColor.c **** // order to save instruction-cycles, and increase resolution...
  24:_options/writeColor.c **** 
  25:_options/writeColor.c **** //As-Implemented
  26:_options/writeColor.c **** //Frame-Buffer:
  27:_options/writeColor.c **** // The pixels' color-data are stored in this buffer, two bits each R,G,B.
  28:_options/writeColor.c **** // Thus, it's easy to write a color-value, but all processing to convert
  29:_options/writeColor.c **** // that color-value into register-settings is done *during* the drawing...
  30:_options/writeColor.c **** // So, it's pretty slow to process each "pixel", and thus each pixel in the
  31:_options/writeColor.c **** // buffer is stretched horizontally across *several* physical LCD pixels
  32:_options/writeColor.c **** //Row-Buffer:
  33:_options/writeColor.c **** // This should be called "Row-Settings-Buffer" or something similar...
  34:_options/writeColor.c **** // The pixels' color-data is stored as packed register-values to be written
  35:_options/writeColor.c **** // at the time of drawing. The buffer itself does *not* consist of raw
  36:_options/writeColor.c **** // color-values, so it is a bit more difficult to explain.
  37:_options/writeColor.c **** // It still takes several instructions to load the registers for each
  38:_options/writeColor.c **** // color, so it still stretches each "pixel" across several LCD pixels.
  39:_options/writeColor.c **** // But it's significantly faster, so the horizontal resolution is higher.
  40:_options/writeColor.c **** 
  41:_options/writeColor.c **** 
  42:_options/writeColor.c **** //For Red and Green (NOT Blue) This enables four shades, instead of three
  43:_options/writeColor.c **** // (including black)
  44:_options/writeColor.c **** // Doing so increases pixel-processing time, thus the pixel-widths
  45:_options/writeColor.c **** // (thus decreasing resolution)
  46:_options/writeColor.c **** // each color takes 9 cycles to process in three-shade mode
  47:_options/writeColor.c **** // or 12 cycles for red and green, plus 9 for blue in four-shade mode
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 25


  48:_options/writeColor.c **** // a/o v59: I don't think this does anything in ROW_SEG_BUFFER
  49:_options/writeColor.c **** #define FOUR_SHADES TRUE
  50:_options/writeColor.c **** 
  51:_options/writeColor.c **** #if(defined(FOUR_SHADES) && FOUR_SHADES)
  52:_options/writeColor.c ****  //a/o v60
  53:_options/writeColor.c ****  //I can't find this anywhere else... Might not be looking hard enough
  54:_options/writeColor.c ****  #define	NUM_COLORS	(4*4*3) //48
  55:_options/writeColor.c **** #else
  56:_options/writeColor.c ****  #define NUM_COLORS (3*3*3) //27
  57:_options/writeColor.c **** #endif
  58:_options/writeColor.c **** 
  59:_options/writeColor.c **** 
  60:_options/writeColor.c **** 
  61:_options/writeColor.c **** #if(!defined(ROW_BUFFER) || !ROW_BUFFER)
  62:_options/writeColor.c ****  #include "_options/frameBuffer.c"
  63:_options/writeColor.c **** #else
  64:_options/writeColor.c ****  #include "_options/rowBuffer.c"
  65:_options/writeColor.c **** 
  66:_options/writeColor.c ****  //FB_WIDTH should probably be renamed...
  67:_options/writeColor.c ****  #define FB_WIDTH (RB_WIDTH)
  68:_options/writeColor.c **** #endif
  69:_options/writeColor.c **** 
  70:_options/writeColor.c **** 
  71:_options/writeColor.c **** 
  72:_options/writeColor.c **** 
  73:_options/writeColor.c **** // LVDS/FPD-Link timing:
  74:_options/writeColor.c **** 
  75:_options/writeColor.c **** //            |<--- (LCDdirectLVDS: "pixel") --->|
  76:_options/writeColor.c **** //  Timer1:   |<-- One Timer1 Cycle (OCR1C=6) -->|
  77:_options/writeColor.c **** //  TCNT:     |  0   1    2    3    4    5    6  |  0   1    2    3    
  78:_options/writeColor.c **** //            |____.____.____.____               |____.____.____.____
  79:_options/writeColor.c **** //  RXclk+:   /         |         \    .    .    /         |         \ //
  80:_options/writeColor.c **** //            |         |            |         |
  81:_options/writeColor.c **** // One Pixel: |         |<--- One FPD-Link Pixel Cycle --->|
  82:_options/writeColor.c **** //            |                                  |
  83:_options/writeColor.c **** // "Blue/DVH" |____ ____v____ ____ ____v____ ____|____ ____
  84:_options/writeColor.c **** //  RXin2:    X B3 X B2 X DE X /V X /H X B5 X B4 X B3 X B2 X ...
  85:_options/writeColor.c **** //            | ^  ^ | 
  86:_options/writeColor.c **** //            |         |<--Not Blue-->|         |
  87:_options/writeColor.c **** //            |                                  |
  88:_options/writeColor.c **** // "Green"    |____ ____v____ ____v____ ____ ____|____ ____
  89:_options/writeColor.c **** //  RXin1:    X G2 X G1 X B1 X B0 X G5 X G4 X G3 X G2 X G1 X ...
  90:_options/writeColor.c **** //            | ^ ^  |  
  91:_options/writeColor.c **** //            |         |<------->|-Not Green    |
  92:_options/writeColor.c **** //
  93:_options/writeColor.c **** // "Red"      |____ ____v____v____ ____ ____ ____|____ ____
  94:_options/writeColor.c **** //  RXin0:    X R1 X R0 X G0 X R5 X R4 X R3 X R2 X R1 X R0 X ...
  95:_options/writeColor.c **** //            | ^^     
  96:_options/writeColor.c **** //            |         |<-->|-Not Red
  97:_options/writeColor.c **** //
  98:_options/writeColor.c **** //   Of course: The Not Green/Red bits above are low-bits and
  99:_options/writeColor.c **** //              basically have little/no visible effect
 100:_options/writeColor.c **** //
 101:_options/writeColor.c **** //
 102:_options/writeColor.c **** 
 103:_options/writeColor.c **** 
 104:_options/writeColor.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 26


 105:_options/writeColor.c **** 
 106:_options/writeColor.c **** //#if(!defined(ROW_SEG_BUFFER) || !ROW_SEG_BUFFER)
 107:_options/writeColor.c **** 
 108:_options/writeColor.c **** 
 109:_options/writeColor.c **** //WRITE_COLOR_CYCS is the number of CPU clock-cycles each call to
 110:_options/writeColor.c **** //writeColor() takes (minus the delay)
 111:_options/writeColor.c **** // This value is determined by the code/optimizer, often by looking into
 112:_options/writeColor.c **** // the .lss file, and/or determined by the number of asm instructions.
 113:_options/writeColor.c **** // It's only used in calculations for determining how much delay to add to
 114:_options/writeColor.c **** // stretch pixels to fill the screen...
 115:_options/writeColor.c **** // Changing the value to something inaccurate doesn't really change the
 116:_options/writeColor.c **** // writeColor() code, at all, it merely affects the associated
 117:_options/writeColor.c **** // stretching-delays.
 118:_options/writeColor.c **** // E.G. If somehow the math works out that the image isn't stretched all
 119:_options/writeColor.c **** // the way across the screen, *shrinking* the number of WRITE_COLOR_CYCS
 120:_options/writeColor.c **** // would cause *increased* WRITE_COLOR_DELAYs, but since the actual number
 121:_options/writeColor.c **** // of cycles taken by writeColor() doesn't change, this has the effect of
 122:_options/writeColor.c **** // merely increasing the delay until the next writeColor.
 123:_options/writeColor.c **** // THIS IS NOT GOOD HABIT
 124:_options/writeColor.c **** // But it is the way it's coded.
 125:_options/writeColor.c **** // Ideally, the math would work out properly, and WRITE_COLOR_CYCS would be
 126:_options/writeColor.c **** // best if it was the *actual* number of cycles it takes to complete a call
 127:_options/writeColor.c **** // to writeColor() (again, minus the delay)
 128:_options/writeColor.c **** // ... as it is used in calculations elsewhere, as well.
 129:_options/writeColor.c **** 
 130:_options/writeColor.c **** 
 131:_options/writeColor.c **** //If writeColor is defined elsewhere, then so must be WRITE_COLOR_CYCS
 132:_options/writeColor.c **** // So don't define it here...
 133:_options/writeColor.c **** // (e.g. for _interfaces/6bitParallel.c for the Sony LCD)
 134:_options/writeColor.c **** #ifndef WRITE_COLOR_CYCS
 135:_options/writeColor.c **** #if(defined(__AVR_AT90PWM161__))
 136:_options/writeColor.c ****  #if(defined(ROW_BUFFER) && ROW_BUFFER)
 137:_options/writeColor.c ****   //This is just an estimate:
 138:_options/writeColor.c ****   //Figured (roughly) from the .lss
 139:_options/writeColor.c ****   #define WRITE_COLOR_CYCS 27//18
 140:_options/writeColor.c ****  #else
 141:_options/writeColor.c ****   #define WRITE_COLOR_CYCS 38//56
 142:_options/writeColor.c ****   //This value determined from .lss
 143:_options/writeColor.c ****   // probably not 100% accurate.
 144:_options/writeColor.c ****   //And kinda surprising it's so much more than the others...
 145:_options/writeColor.c ****   // a/o v71: This has been modified to stretch it better across the
 146:_options/writeColor.c ****   // screen... for FB_TESTING (FB_QUESTION) and may no longer work with
 147:_options/writeColor.c ****   // ROW_BUFFER, etc. 
 148:_options/writeColor.c ****  #endif
 149:_options/writeColor.c **** #else	//ATtiny861
 150:_options/writeColor.c ****  #if(defined(ROW_BUFFER) && ROW_BUFFER)
 151:_options/writeColor.c ****  //THIS IS JUST AN ESTIMATE
 152:_options/writeColor.c ****   #define WRITE_COLOR_CYCS   (13)
 153:_options/writeColor.c ****  #elif(defined(FOUR_SHADES) && FOUR_SHADES)
 154:_options/writeColor.c ****   // Roughly...
 155:_options/writeColor.c ****   #define WRITE_COLOR_CYCS   (12*2+9+3)
 156:_options/writeColor.c ****  #else
 157:_options/writeColor.c ****   // Roughly...
 158:_options/writeColor.c ****   #define WRITE_COLOR_CYCS   (9*3+3)
 159:_options/writeColor.c ****  #endif
 160:_options/writeColor.c **** #endif
 161:_options/writeColor.c **** #endif //WRITE_COLOR_CYCS wasn't predefined...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 27


 162:_options/writeColor.c **** 
 163:_options/writeColor.c **** 
 164:_options/writeColor.c **** //If it's already been included elsewhere, then it won't recalculate...
 165:_options/writeColor.c **** // (since everything's #included in such roundabout ways...)
 166:_options/writeColor.c **** #include "writeColorDelay.h"
 167:_options/writeColor.c **** 
 168:_options/writeColor.c **** /*
 169:_options/writeColor.c **** //WRITE_COLOR_DELAY attempts to stretch each pixel such that the total
 170:_options/writeColor.c **** //number of horizontal pixels (e.g. FB_WIDTH) will stretch across the
 171:_options/writeColor.c **** //screen. It takes into account the number of cycles it takes to extract
 172:_options/writeColor.c **** //the color register-values from the buffer, and load them into the
 173:_options/writeColor.c **** //registers. It's entirely plausible it will be negative, if e.g.
 174:_options/writeColor.c **** //FB_WIDTH * WRITE_COLOR_CYCS > DE_CYC
 175:_options/writeColor.c **** //(i.e. you've chosen an FB_WIDTH that's too large for the screen)
 176:_options/writeColor.c **** //The math is loose, e.g.:
 177:_options/writeColor.c **** // WRITE_COLOR_CYCS is, unless done entirely in assembly, usually an
 178:_options/writeColor.c **** //  estimate 
 179:_options/writeColor.c **** // There's no rounding, and integer division...
 180:_options/writeColor.c **** // There's nothing stopping you from setting an FB_WIDTH too large...
 181:_options/writeColor.c **** //So it's likely the resulting image will be skinnier (or wider?) than the
 182:_options/writeColor.c **** // display...
 183:_options/writeColor.c **** //Calcs:
 184:_options/writeColor.c **** // DE_CYC = FB_WIDTH * ( WRITE_COLOR_CYCS + WRITE_COLOR_DELAY )
 185:_options/writeColor.c **** // DE_CYC/FB_WIDTH = WRITE_COLOR_CYCS + WRITE_COLOR_DELAY
 186:_options/writeColor.c **** // WRITE_COLOR_DELAY = DE_CYC/FB_WIDTH - WRITE_COLOR_CYCS
 187:_options/writeColor.c **** // Not sure why -4 is necessary... overhead in delayCyc?
 188:_options/writeColor.c **** #define WRITE_COLOR_DELAY_PRETEST \
 189:_options/writeColor.c **** 	( DOTS_TO_CYC(DE_ACTIVE_DOTS) / FB_WIDTH - WRITE_COLOR_CYCS-4)
 190:_options/writeColor.c **** 
 191:_options/writeColor.c **** #if(WRITE_COLOR_DELAY_PRETEST < 0)
 192:_options/writeColor.c ****  #define WRITE_COLOR_DELAY 0
 193:_options/writeColor.c ****  #warning "WRITE_COLOR_DELAY < 0, your FB_WIDTH is possibly too large for the screen..."
 194:_options/writeColor.c **** // #error "problem here..."
 195:_options/writeColor.c **** #elif(WRITE_COLOR_DELAY_PRETEST >127)
 196:_options/writeColor.c ****  #define WRITE_COLOR_DELAY 127
 197:_options/writeColor.c ****  #warning "WRITE_COLOR_DELAY > 127... Tiny FB_WIDTH? HUGE screen? Have fun!"
 198:_options/writeColor.c **** #else
 199:_options/writeColor.c ****  #define WRITE_COLOR_DELAY (WRITE_COLOR_DELAY_PRETEST)
 200:_options/writeColor.c **** #endif
 201:_options/writeColor.c **** */
 202:_options/writeColor.c **** 
 203:_options/writeColor.c **** 
 204:_options/writeColor.c **** 
 205:_options/writeColor.c **** //load a color-value from the frame/row buffer and write the registers
 206:_options/writeColor.c **** 
 207:_options/writeColor.c **** 
 208:_options/writeColor.c **** 
 209:_options/writeColor.c **** //includeDEinit should be TRUE only *once* at the *beginning* of the
 210:_options/writeColor.c **** //drawPix function...
 211:_options/writeColor.c **** // Setting it FALSE does *not* disable DE
 212:_options/writeColor.c **** 
 213:_options/writeColor.c **** 
 214:_options/writeColor.c **** //Check if there's enough delay-time that we can *not* inline writeColor
 215:_options/writeColor.c **** // In which case, we'll save a *ton* of program-space
 216:_options/writeColor.c **** #define WC_JUMPRET_CYCLES	8
 217:_options/writeColor.c **** #if(WRITE_COLOR_DELAY > WC_JUMPRET_CYCLES)
 218:_options/writeColor.c **** #define WC_INLINEABLE
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 28


 219:_options/writeColor.c ****  #define WC_ALWAYS
 220:_options/writeColor.c ****  #define WCD_DELAY	(WRITE_COLOR_DELAY-8)	//Two Jump/Rets
 221:_options/writeColor.c **** #else
 222:_options/writeColor.c ****  #define WC_INLINEABLE	static __inline__
 223:_options/writeColor.c ****  #define WC_ALWAYS		__attribute__((__always_inline__))
 224:_options/writeColor.c ****  #define WCD_DELAY	(WRITE_COLOR_DELAY-4)	//One JumpRet
 225:_options/writeColor.c **** #endif
 226:_options/writeColor.c **** 
 227:_options/writeColor.c **** //If it's functionized, then there's no reason to functionize this, as
 228:_options/writeColor.c **** //well... but if not, we can squeeze about 72 bytes out this way...
 229:_options/writeColor.c **** // so that's better'n'nothing, I guess...
 230:_options/writeColor.c **** // (and I'm just too lazy to put it back, as this was the first experiment)
 231:_options/writeColor.c **** void writeColorDelay(void)
 232:_options/writeColor.c **** {
 462               		.stabn	68,0,232,.LM44-.LFBB6
 463               	.LM44:
 464               	.LFBB6:
 465               	/* prologue: function */
 466               	/* frame size = 0 */
 467               	/* stack size = 0 */
 468               	.L__stack_usage = 0
 469               	.LBB76:
 470               	.LBB77:
 471               	.LBB78:
 472               	.LBB79:
 473               		.stabs	"/opt/local/avr/include/util/delay_basic.h",132,0,0,.Ltext8
 474               	.Ltext8:
   1:/opt/local/avr/include/util/delay_basic.h **** /* Copyright (c) 2002, Marek Michalkiewicz
   2:/opt/local/avr/include/util/delay_basic.h ****    Copyright (c) 2007 Joerg Wunsch
   3:/opt/local/avr/include/util/delay_basic.h ****    All rights reserved.
   4:/opt/local/avr/include/util/delay_basic.h **** 
   5:/opt/local/avr/include/util/delay_basic.h ****    Redistribution and use in source and binary forms, with or without
   6:/opt/local/avr/include/util/delay_basic.h ****    modification, are permitted provided that the following conditions are met:
   7:/opt/local/avr/include/util/delay_basic.h **** 
   8:/opt/local/avr/include/util/delay_basic.h ****    * Redistributions of source code must retain the above copyright
   9:/opt/local/avr/include/util/delay_basic.h ****      notice, this list of conditions and the following disclaimer.
  10:/opt/local/avr/include/util/delay_basic.h **** 
  11:/opt/local/avr/include/util/delay_basic.h ****    * Redistributions in binary form must reproduce the above copyright
  12:/opt/local/avr/include/util/delay_basic.h ****      notice, this list of conditions and the following disclaimer in
  13:/opt/local/avr/include/util/delay_basic.h ****      the documentation and/or other materials provided with the
  14:/opt/local/avr/include/util/delay_basic.h ****      distribution.
  15:/opt/local/avr/include/util/delay_basic.h **** 
  16:/opt/local/avr/include/util/delay_basic.h ****    * Neither the name of the copyright holders nor the names of
  17:/opt/local/avr/include/util/delay_basic.h ****      contributors may be used to endorse or promote products derived
  18:/opt/local/avr/include/util/delay_basic.h ****      from this software without specific prior written permission.
  19:/opt/local/avr/include/util/delay_basic.h **** 
  20:/opt/local/avr/include/util/delay_basic.h ****   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  21:/opt/local/avr/include/util/delay_basic.h ****   AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  22:/opt/local/avr/include/util/delay_basic.h ****   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  23:/opt/local/avr/include/util/delay_basic.h ****   ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
  24:/opt/local/avr/include/util/delay_basic.h ****   LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
  25:/opt/local/avr/include/util/delay_basic.h ****   CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
  26:/opt/local/avr/include/util/delay_basic.h ****   SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
  27:/opt/local/avr/include/util/delay_basic.h ****   INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
  28:/opt/local/avr/include/util/delay_basic.h ****   CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
  29:/opt/local/avr/include/util/delay_basic.h ****   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  30:/opt/local/avr/include/util/delay_basic.h ****   POSSIBILITY OF SUCH DAMAGE. */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 29


  31:/opt/local/avr/include/util/delay_basic.h **** 
  32:/opt/local/avr/include/util/delay_basic.h **** /* $Id: delay_basic.h 2143 2010-06-08 21:19:51Z joerg_wunsch $ */
  33:/opt/local/avr/include/util/delay_basic.h **** 
  34:/opt/local/avr/include/util/delay_basic.h **** #ifndef _UTIL_DELAY_BASIC_H_
  35:/opt/local/avr/include/util/delay_basic.h **** #define _UTIL_DELAY_BASIC_H_ 1
  36:/opt/local/avr/include/util/delay_basic.h **** 
  37:/opt/local/avr/include/util/delay_basic.h **** #include <inttypes.h>
  38:/opt/local/avr/include/util/delay_basic.h **** 
  39:/opt/local/avr/include/util/delay_basic.h **** #if !defined(__DOXYGEN__)
  40:/opt/local/avr/include/util/delay_basic.h **** static inline void _delay_loop_1(uint8_t __count) __attribute__((always_inline));
  41:/opt/local/avr/include/util/delay_basic.h **** static inline void _delay_loop_2(uint16_t __count) __attribute__((always_inline));
  42:/opt/local/avr/include/util/delay_basic.h **** #endif
  43:/opt/local/avr/include/util/delay_basic.h **** 
  44:/opt/local/avr/include/util/delay_basic.h **** /** \file */
  45:/opt/local/avr/include/util/delay_basic.h **** /** \defgroup util_delay_basic <util/delay_basic.h>: Basic busy-wait delay loops
  46:/opt/local/avr/include/util/delay_basic.h ****     \code
  47:/opt/local/avr/include/util/delay_basic.h ****     #include <util/delay_basic.h>
  48:/opt/local/avr/include/util/delay_basic.h ****     \endcode
  49:/opt/local/avr/include/util/delay_basic.h **** 
  50:/opt/local/avr/include/util/delay_basic.h ****     The functions in this header file implement simple delay loops
  51:/opt/local/avr/include/util/delay_basic.h ****     that perform a busy-waiting.  They are typically used to
  52:/opt/local/avr/include/util/delay_basic.h ****     facilitate short delays in the program execution.  They are
  53:/opt/local/avr/include/util/delay_basic.h ****     implemented as count-down loops with a well-known CPU cycle
  54:/opt/local/avr/include/util/delay_basic.h ****     count per loop iteration.  As such, no other processing can
  55:/opt/local/avr/include/util/delay_basic.h ****     occur simultaneously.  It should be kept in mind that the
  56:/opt/local/avr/include/util/delay_basic.h ****     functions described here do not disable interrupts.
  57:/opt/local/avr/include/util/delay_basic.h **** 
  58:/opt/local/avr/include/util/delay_basic.h ****     In general, for long delays, the use of hardware timers is
  59:/opt/local/avr/include/util/delay_basic.h ****     much preferrable, as they free the CPU, and allow for
  60:/opt/local/avr/include/util/delay_basic.h ****     concurrent processing of other events while the timer is
  61:/opt/local/avr/include/util/delay_basic.h ****     running.  However, in particular for very short delays, the
  62:/opt/local/avr/include/util/delay_basic.h ****     overhead of setting up a hardware timer is too much compared
  63:/opt/local/avr/include/util/delay_basic.h ****     to the overall delay time.
  64:/opt/local/avr/include/util/delay_basic.h **** 
  65:/opt/local/avr/include/util/delay_basic.h ****     Two inline functions are provided for the actual delay algorithms.
  66:/opt/local/avr/include/util/delay_basic.h **** 
  67:/opt/local/avr/include/util/delay_basic.h **** */
  68:/opt/local/avr/include/util/delay_basic.h **** 
  69:/opt/local/avr/include/util/delay_basic.h **** /** \ingroup util_delay_basic
  70:/opt/local/avr/include/util/delay_basic.h **** 
  71:/opt/local/avr/include/util/delay_basic.h ****     Delay loop using an 8-bit counter \c __count, so up to 256
  72:/opt/local/avr/include/util/delay_basic.h ****     iterations are possible.  (The value 256 would have to be passed
  73:/opt/local/avr/include/util/delay_basic.h ****     as 0.)  The loop executes three CPU cycles per iteration, not
  74:/opt/local/avr/include/util/delay_basic.h ****     including the overhead the compiler needs to setup the counter
  75:/opt/local/avr/include/util/delay_basic.h ****     register.
  76:/opt/local/avr/include/util/delay_basic.h **** 
  77:/opt/local/avr/include/util/delay_basic.h ****     Thus, at a CPU speed of 1 MHz, delays of up to 768 microseconds
  78:/opt/local/avr/include/util/delay_basic.h ****     can be achieved.
  79:/opt/local/avr/include/util/delay_basic.h **** */
  80:/opt/local/avr/include/util/delay_basic.h **** void
  81:/opt/local/avr/include/util/delay_basic.h **** _delay_loop_1(uint8_t __count)
  82:/opt/local/avr/include/util/delay_basic.h **** {
  83:/opt/local/avr/include/util/delay_basic.h **** 	__asm__ volatile (
  84:/opt/local/avr/include/util/delay_basic.h **** 		"1: dec %0" "\n\t"
  85:/opt/local/avr/include/util/delay_basic.h **** 		"brne 1b"
  86:/opt/local/avr/include/util/delay_basic.h **** 		: "=r" (__count)
  87:/opt/local/avr/include/util/delay_basic.h **** 		: "0" (__count)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 30


  88:/opt/local/avr/include/util/delay_basic.h **** 	);
  89:/opt/local/avr/include/util/delay_basic.h **** }
  90:/opt/local/avr/include/util/delay_basic.h **** 
  91:/opt/local/avr/include/util/delay_basic.h **** /** \ingroup util_delay_basic
  92:/opt/local/avr/include/util/delay_basic.h **** 
  93:/opt/local/avr/include/util/delay_basic.h ****     Delay loop using a 16-bit counter \c __count, so up to 65536
  94:/opt/local/avr/include/util/delay_basic.h ****     iterations are possible.  (The value 65536 would have to be
  95:/opt/local/avr/include/util/delay_basic.h ****     passed as 0.)  The loop executes four CPU cycles per iteration,
  96:/opt/local/avr/include/util/delay_basic.h ****     not including the overhead the compiler requires to setup the
  97:/opt/local/avr/include/util/delay_basic.h ****     counter register pair.
  98:/opt/local/avr/include/util/delay_basic.h **** 
  99:/opt/local/avr/include/util/delay_basic.h ****     Thus, at a CPU speed of 1 MHz, delays of up to about 262.1
 100:/opt/local/avr/include/util/delay_basic.h ****     milliseconds can be achieved.
 101:/opt/local/avr/include/util/delay_basic.h ****  */
 102:/opt/local/avr/include/util/delay_basic.h **** void
 103:/opt/local/avr/include/util/delay_basic.h **** _delay_loop_2(uint16_t __count)
 104:/opt/local/avr/include/util/delay_basic.h **** {
 105:/opt/local/avr/include/util/delay_basic.h **** 	__asm__ volatile (
 475               		.stabn	68,0,105,.LM45-.LFBB6
 476               	.LM45:
 477 00e8 8FE0      		ldi r24,lo8(15)
 478 00ea 90E0      		ldi r25,0
 479               	/* #APP */
 480               	 ;  105 "/opt/local/avr/include/util/delay_basic.h" 1
 481 00ec 0197      		1: sbiw r24,1
 482 00ee 01F4      		brne 1b
 483               	 ;  0 "" 2
 484               	/* #NOAPP */
 485 00f0 0895      		ret
 486               	.LBE79:
 487               	.LBE78:
 488               	.LBE77:
 489               	.LBE76:
 490               		.size	writeColorDelay, .-writeColorDelay
 491               	.Lscope6:
 492               		.stabs	"",36,0,0,.Lscope6-.LFBB6
 493               		.stabd	78,0,0
 494               		.stabs	"writeColor:F(0,47)",36,0,456,writeColor
 495               		.stabs	"includeDEinit:P(4,2)",64,0,456,24
 496               		.stabs	"includeDelay:P(4,2)",64,0,456,22
 497               		.stabs	"colorVal:P(4,2)",64,0,457,20
 498               	.global	writeColor
 499               		.type	writeColor, @function
 500               	writeColor:
 501               		.stabd	46,0,0
 502               		.stabs	"_options/writeColor.c",132,0,0,.Ltext9
 503               	.Ltext9:
 233:_options/writeColor.c **** #if(WCD_DELAY <= 0)
 234:_options/writeColor.c **** #error "Can't *not* inline delay_cyc in writeColor, due to WCD_DELAY<=0"
 235:_options/writeColor.c **** #endif
 236:_options/writeColor.c **** 	//And now we're jumping twice...
 237:_options/writeColor.c **** 	//Assuming two cycles to jump here and two to return...
 238:_options/writeColor.c **** 	delay_cyc(WCD_DELAY);
 239:_options/writeColor.c **** }
 240:_options/writeColor.c **** 
 241:_options/writeColor.c **** 
 242:_options/writeColor.c **** #ifndef writeColor	
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 31


 243:_options/writeColor.c **** //static __inline__ 
 244:_options/writeColor.c **** WC_INLINEABLE
 245:_options/writeColor.c **** void writeColor(uint8_t includeDEinit, uint8_t includeDelay, 
 246:_options/writeColor.c **** 																		uint8_t colorVal) 
 247:_options/writeColor.c **** 	WC_ALWAYS;
 248:_options/writeColor.c **** 	//	__attribute__((__always_inline__));
 249:_options/writeColor.c **** 
 250:_options/writeColor.c **** #if(defined(__AVR_AT90PWM161__))
 251:_options/writeColor.c **** //This is all the actual/uncommented writeColor() function, below, does...
 252:_options/writeColor.c **** // the actual one uses assembly to align the color-changes' edges
 253:_options/writeColor.c **** // and assures that each pixel is the same width (even though some
 254:_options/writeColor.c **** // branching is necessary)
 255:_options/writeColor.c **** // But you can actually use this one here for fun
 256:_options/writeColor.c **** // (Actually, it's kinda cool, it makes the FB_QUESTION sprites look even
 257:_options/writeColor.c **** //  more 3D)
 258:_options/writeColor.c **** // a/o v70: The above is true if ROW_BUFFER is NOT TRUE.
 259:_options/writeColor.c **** #if 0
 260:_options/writeColor.c ****  void writeColor(uint8_t includeDelay, uint8_t colorVal)
 261:_options/writeColor.c ****  {
 262:_options/writeColor.c **** 	uint8_t redVal = colorVal & 0x03;
 263:_options/writeColor.c **** 	uint8_t greenVal = (colorVal >> 2) & 0x03;
 264:_options/writeColor.c **** 	uint8_t blueVal = (colorVal >> 4) & 0x03;
 265:_options/writeColor.c **** 
 266:_options/writeColor.c **** 	setRed4(redVal);
 267:_options/writeColor.c **** 	setGreen4(greenVal);
 268:_options/writeColor.c **** 	setBlue4(blueVal);
 269:_options/writeColor.c **** 
 270:_options/writeColor.c **** 	if(includeDelay)
 271:_options/writeColor.c **** 		delay_cyc(WRITE_COLOR_DELAY);		
 272:_options/writeColor.c **** 
 273:_options/writeColor.c ****  }
 274:_options/writeColor.c **** #endif
 275:_options/writeColor.c ****  WC_INLINEABLE 
 276:_options/writeColor.c **** 	void writeColor(uint8_t includeDEinit, uint8_t includeDelay, 
 277:_options/writeColor.c **** 		 															uint8_t colorVal)
 278:_options/writeColor.c ****  {
 279:_options/writeColor.c **** 
 280:_options/writeColor.c **** #if(defined(ROW_BUFFER) && ROW_BUFFER)
 281:_options/writeColor.c **** 	//see rowBuffer.c for how this is packed...
 282:_options/writeColor.c **** 	//
 283:_options/writeColor.c ****    // In this case, colorVal is actually settingVal...
 284:_options/writeColor.c ****    // Between LDI, these instructions, and OCR/DT register writes
 285:_options/writeColor.c ****    // this is XX cycles... or XX pixels...
 286:_options/writeColor.c **** 	// a/o v70: XX pixels AT LVDS_PRESCALER=1, right......?
 287:_options/writeColor.c **** 
 288:_options/writeColor.c ****    //                              //ldi (colorVal) (2 cyc)
 289:_options/writeColor.c ****    //Red: (temp)
 290:_options/writeColor.c **** 	uint8_t redAndBlue = (colorVal >> 2);
 291:_options/writeColor.c ****  	//uint8_t ocrd = colorVal >> 2;   //mov, shl, shl
 292:_options/writeColor.c ****    //Green:
 293:_options/writeColor.c **** 	uint8_t greenOCR_val = (colorVal & 0x03) + 3;
 294:_options/writeColor.c ****    //uint8_t dt = colorVal & 0x03; //andi
 295:_options/writeColor.c ****    //Blue:
 296:_options/writeColor.c **** 	uint8_t blueOCR_val = (redAndBlue >> 3) + 4;
 297:_options/writeColor.c ****    //uint8_t ocra = ocrd >> 3;      //mov, shl, shl, shl
 298:_options/writeColor.c ****    //And red...
 299:_options/writeColor.c ****    //ocrd &= 0x07;                  //andi
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 32


 300:_options/writeColor.c **** 	uint8_t redOCR_val = redAndBlue & 0x07;
 301:_options/writeColor.c ****                                  //out OCRD, out DT, out OCRA
 302:_options/writeColor.c **** #else //NOT ROW_BUFFER (FRAMEBUFFER)
 303:_options/writeColor.c **** 
 304:_options/writeColor.c **** 	 //This is pieced-together from the ATTiny861's writeColor()
 305:_options/writeColor.c **** 	 // and memory...
 306:_options/writeColor.c **** 
 307:_options/writeColor.c **** 	 //The basic idea is to set a color in a specific/non-varying number of
 308:_options/writeColor.c **** 	 //instruction-cycles.
 309:_options/writeColor.c **** 	 // Thus, we can't use "if" statements, etc, without paying attention to
 310:_options/writeColor.c **** 	 // the actual assembly output.
 311:_options/writeColor.c **** 	 // Additionally, it would be nice to know exactly how many cycles the
 312:_options/writeColor.c **** 	 // entire function-call takes, so we can determine the number of pixels
 313:_options/writeColor.c **** 	 // that can fit in a DE-active period... 
 314:_options/writeColor.c **** 	 // (How many writeColor() calls can fit horizontally)
 315:_options/writeColor.c **** 	 // Further still, this function is "always inline"
 316:_options/writeColor.c **** 	 // which means that it will be optimized in each usage...
 317:_options/writeColor.c **** 	 // which means that it might compile differently in different calls
 318:_options/writeColor.c **** 	 // (e.g. if one call has a constant-argument and another has a
 319:_options/writeColor.c **** 	 // variable)
 320:_options/writeColor.c **** 	 // which is another reason to use inline-assembly, to assure it's the
 321:_options/writeColor.c **** 	 // exact same number of clock-cycles each time.
 322:_options/writeColor.c **** 	 // That's reserved for later...
 323:_options/writeColor.c **** 
 324:_options/writeColor.c **** 	 // FURTHER STILL:
 325:_options/writeColor.c **** 	 // the optimizer reorganizes things... duh.
 326:_options/writeColor.c **** 	 // Which means that even though these calculations are listed at the
 327:_options/writeColor.c **** 	 // top of the function...
 328:_options/writeColor.c **** 	 // their actual instructions may not occur until later.
 329:_options/writeColor.c **** 	 // The write to OCR-registers would ideally occur simultaneously
 330:_options/writeColor.c **** 	 // such that the red/green/blue edges would align
 331:_options/writeColor.c **** 	 // Without doing this in ASM, we can't guarantee (and I've seen
 332:_options/writeColor.c **** 	 // first-hand) that it can't happen that one OCR is written, the next
 333:_options/writeColor.c **** 	 // is calculated, *then* the next is written.
 334:_options/writeColor.c **** 
 335:_options/writeColor.c **** 	 //First, unpack the colors:
 336:_options/writeColor.c **** 	 uint8_t redVal = colorVal&0x03;
 337:_options/writeColor.c **** 	 //uint8_t greenVal = (colorVal>>2)&0x03;
 338:_options/writeColor.c **** 	 //uint8_t blueVal = (colorVal>>4)&0x03;
 339:_options/writeColor.c **** 	 //The above is optimized below by combining two of the
 340:_options/writeColor.c **** 	 //blue-shifts... It should be smaller
 341:_options/writeColor.c **** 	 uint8_t bgTemp = colorVal>>2;
 342:_options/writeColor.c **** 	 uint8_t greenVal = bgTemp&0x03;
 343:_options/writeColor.c **** 	 uint8_t blueVal = (bgTemp>>2)&0x03;
 344:_options/writeColor.c **** 
 345:_options/writeColor.c **** 	 //Now prep some variables for the register-values
 346:_options/writeColor.c **** 	 // the actual registers will be written all at once at the end
 347:_options/writeColor.c **** 
 348:_options/writeColor.c **** 	 //see setRed4() and setGreen4()...
 349:_options/writeColor.c **** 	 uint8_t redOCR_val   = (redVal + 2);
 350:_options/writeColor.c **** 	 uint8_t greenOCR_val = (greenVal + 3);
 351:_options/writeColor.c **** 
 352:_options/writeColor.c **** 	 //Blue is more difficult, it requires a test
 353:_options/writeColor.c **** 	 // which, when compiled, would likely result in two branches that take
 354:_options/writeColor.c **** 	 // different numbers of clock-cycles
 355:_options/writeColor.c **** 	 uint8_t blueOCR_val = (blueVal + 4);
 356:_options/writeColor.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 33


 357:_options/writeColor.c **** 	 // So far, none of the above code has any branches (right?)
 358:_options/writeColor.c **** 	 // So it should be a constant number of clock-cycles
 359:_options/writeColor.c **** 	 // (unless an inline-call has a constant as an argument!)
 360:_options/writeColor.c **** 
 361:_options/writeColor.c **** 	 //The following is nothing more than 
 362:_options/writeColor.c **** 	 // if (blueVal == 3) 
 363:_options/writeColor.c **** 	 //     blueOCR_val=8;
 364:_options/writeColor.c **** 
 365:_options/writeColor.c **** 
 366:_options/writeColor.c **** 	 // This has been modified... was a struggle to realize that "0" is
 367:_options/writeColor.c **** 	 // necessary to avoid %0's being clobbered regardless of whether it was
 368:_options/writeColor.c **** 	 // written...
 369:_options/writeColor.c **** 	 // See lvds161.c -> setBlue4()
 370:_options/writeColor.c **** 	 // 
 371:_options/writeColor.c **** 	 //This is NOT AT ALL optimized:
 372:_options/writeColor.c **** 	 // But it is guaranteed to be exactly 3 cycles *in each branch*
 373:_options/writeColor.c **** __asm__ __volatile__
 374:_options/writeColor.c **** 	(                                                        // cycles
 375:_options/writeColor.c **** 	 "cpi   %1, 3 ; \n\t"				// (blueVal == 3) ?     //    1
 376:_options/writeColor.c **** 	 "brne  nothingToDo_%= ; \n\t"	// N: skip next line    // N:2  Y:1
 377:_options/writeColor.c **** 	 "ldi   %0, 8 ; \n\t"            //   blueOCR_val=8      //   .    1
 378:_options/writeColor.c ****   "nothingToDo_%=: \n\t"            // just a jump-to label //   0    0
 379:_options/writeColor.c ****     : "=r" (blueOCR_val) //blueOCR_val is an output-value, "%0"
 380:_options/writeColor.c **** 	 : "r" (blueVal),		//blueVal is an input-value, "%1"
 381:_options/writeColor.c **** 	   "0" (blueOCR_val)
 382:_options/writeColor.c **** 	);
 383:_options/writeColor.c **** 
 384:_options/writeColor.c **** #endif //ROW_BUFFER vs NOT
 385:_options/writeColor.c **** 
 386:_options/writeColor.c **** 	//Now all the OCR_val variables are set
 387:_options/writeColor.c **** 	// write them to the registers
 388:_options/writeColor.c **** 	// Locking/unlocking of the PSCs can't occur simultaneously,
 389:_options/writeColor.c **** 	// so it's likely there will be a pixel or two of difference between the
 390:_options/writeColor.c **** 	// transition from one value of blue to the next vs red/green's
 391:_options/writeColor.c **** 	// transition
 392:_options/writeColor.c **** 	lockPSC2();
 393:_options/writeColor.c **** 	lockPSC0();
 394:_options/writeColor.c **** //		OCR2RA = blueOCR_val;
 395:_options/writeColor.c **** //		OCR0SA = redOCR_val;
 396:_options/writeColor.c **** //		OCR0SB = greenOCR_val;
 397:_options/writeColor.c **** //"When addressing the I/O Registers as data space using LD and ST
 398:_options/writeColor.c **** // instructions, 0x20 must be added to these addresses"
 399:_options/writeColor.c **** //"For the Extended I/O space from 0x60-0xFF in SRAM, only the ST... and
 400:_options/writeColor.c **** //LD... instructions can be used"
 401:_options/writeColor.c **** // So, rather than using _SFR_IO_ADDR(), use _SFR_MEM_ADDR()
 402:_options/writeColor.c **** 
 403:_options/writeColor.c **** #warning "lock/unlock should probably occur in asm, as well..."
 404:_options/writeColor.c **** 	if(!includeDEinit)
 405:_options/writeColor.c **** 	{
 406:_options/writeColor.c **** 		__asm__ __volatile__
 407:_options/writeColor.c **** 		(
 408:_options/writeColor.c **** 		 "sts %3, %0; \n\t"
 409:_options/writeColor.c **** 		 "sts %4, %1; \n\t"
 410:_options/writeColor.c **** 		 "sts %5, %2; \n\t"
 411:_options/writeColor.c **** 		 :
 412:_options/writeColor.c **** 		 : "r" (blueOCR_val),	//"%0"
 413:_options/writeColor.c **** 		   "r" (redOCR_val),		//"%1"
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 34


 414:_options/writeColor.c **** 			"r" (greenOCR_val),	//"%2"
 415:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR2RAL)), //"%3" //0x2e (0x4e)
 416:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR0SAL)), //"%4"	//(0x60)
 417:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR0SBL)) //"%5"  //0x22 (0x42)
 418:_options/writeColor.c **** 
 419:_options/writeColor.c **** 		);
 420:_options/writeColor.c **** 	} else {
 421:_options/writeColor.c **** 		uint8_t blueOCR_DE_init = 0;
 422:_options/writeColor.c **** 		__asm__ __volatile__
 423:_options/writeColor.c **** 		(
 424:_options/writeColor.c **** 		 "sts %3, %0; \n\t"
 425:_options/writeColor.c **** 		 "sts %4, %1; \n\t"
 426:_options/writeColor.c **** 		 "sts %5, %2; \n\t"
 427:_options/writeColor.c **** 		 "sts %6, %7; \n\t"
 428:_options/writeColor.c **** 		 :
 429:_options/writeColor.c **** 		 : "r" (blueOCR_val),	//"%0"
 430:_options/writeColor.c **** 		   "r" (redOCR_val),		//"%1"
 431:_options/writeColor.c **** 			"r" (greenOCR_val),	//"%2"
 432:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR2RAL)), //"%3" //0x2e (0x4e)
 433:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR0SAL)), //"%4"	//(0x60)
 434:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR0SBL)), //"%5"  //0x22 (0x42)
 435:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR2SAL)), //"%6"
 436:_options/writeColor.c **** 			"r" (blueOCR_DE_init)         //"%7" 
 437:_options/writeColor.c **** 
 438:_options/writeColor.c **** 		);
 439:_options/writeColor.c **** 	}
 440:_options/writeColor.c **** 	unlockPSC0();
 441:_options/writeColor.c **** 	unlockPSC2();
 442:_options/writeColor.c **** 
 443:_options/writeColor.c **** 
 444:_options/writeColor.c **** 	//"Attempt to stretch across the full screen"
 445:_options/writeColor.c **** 	// Not sure if/where this is used... 
 446:_options/writeColor.c **** 	if(includeDelay)
 447:_options/writeColor.c **** 		writeColorDelay();
 448:_options/writeColor.c **** 	//	delay_cyc(WRITE_COLOR_DELAY);
 449:_options/writeColor.c ****  }
 450:_options/writeColor.c **** 
 451:_options/writeColor.c **** 
 452:_options/writeColor.c **** //This should probably test for the TINY861, specifically
 453:_options/writeColor.c **** #else //if(!defined(__AVR_AT90PWM161__))
 454:_options/writeColor.c **** #warning "includeDEinit in writeColor() has not yet been implemented on the Tiny861"
 455:_options/writeColor.c **** WC_INLINEABLE
 456:_options/writeColor.c **** void writeColor(uint8_t includeDEinit, uint8_t includeDelay, 
 457:_options/writeColor.c **** 																		uint8_t colorVal)
 458:_options/writeColor.c **** {
 504               		.stabn	68,0,458,.LM46-.LFBB7
 505               	.LM46:
 506               	.LFBB7:
 507               	/* prologue: function */
 508               	/* frame size = 0 */
 509               	/* stack size = 0 */
 510               	.L__stack_usage = 0
 459:_options/writeColor.c **** //#warning "I'm absolutely certain this'll need to be revised, probably asm"
 460:_options/writeColor.c ****    //   Red: (+OC1D => RX0+)
 461:_options/writeColor.c ****    //    Off (0/63): OCR1D = 0
 462:_options/writeColor.c ****    //    35/63:      OCR1D = 3
 463:_options/writeColor.c ****    //    63/63:      OCR1D >= 6
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 35


 464:_options/writeColor.c **** 
 465:_options/writeColor.c **** /* No Shit: This compiles to a 16-bit test!
 466:_options/writeColor.c ****    switch((uint8_t)(colorVal & (uint8_t)0x03))
 467:_options/writeColor.c ****    {
 468:_options/writeColor.c ****       case (uint8_t)0:
 469:_options/writeColor.c ****          OCR1D = 0;
 470:_options/writeColor.c ****          break;
 471:_options/writeColor.c ****       case (uint8_t)1:
 472:_options/writeColor.c ****          OCR1D = 3;
 473:_options/writeColor.c ****          break;
 474:_options/writeColor.c ****       case (uint8_t)2:
 475:_options/writeColor.c ****       default:
 476:_options/writeColor.c ****          OCR1D = 6;
 477:_options/writeColor.c ****          break;
 478:_options/writeColor.c ****    }
 479:_options/writeColor.c **** */
 480:_options/writeColor.c **** 
 481:_options/writeColor.c **** #if(defined(ROW_BUFFER) && ROW_BUFFER)
 482:_options/writeColor.c ****    // In this case, colorVal is actually settingVal...
 483:_options/writeColor.c ****    // Between LDI, these instructions, and OCR/DT register writes
 484:_options/writeColor.c ****    // this is 14 cycles... or 16 pixels...
 485:_options/writeColor.c **** 	// a/o v70: 16 pixels AT LVDS_PRESCALER=1, right......?
 486:_options/writeColor.c **** 
 487:_options/writeColor.c ****    //                              //ldi (colorVal) (2 cyc)
 488:_options/writeColor.c ****    //Red: (temp)
 489:_options/writeColor.c ****    uint8_t ocrd = colorVal >> 2;   //mov, shl, shl
 490:_options/writeColor.c ****    //Green:
 491:_options/writeColor.c ****    uint8_t dt = colorVal & 0x03; //andi
 492:_options/writeColor.c ****    //Blue:
 493:_options/writeColor.c ****    uint8_t ocra = ocrd >> 3;      //mov, shl, shl, shl
 494:_options/writeColor.c ****    //And red...
 495:_options/writeColor.c ****    ocrd &= 0x07;                  //andi
 496:_options/writeColor.c ****                                  //out OCRD, out DT, out OCRA
 497:_options/writeColor.c **** #else //NOT ROW_BUFFER (FRAMEBUFFER)
 498:_options/writeColor.c **** //a/o v67: I didn't make very clear notes here, but have been using it for
 499:_options/writeColor.c **** //quite some time. As I recall, the purpose of moving this to asm, instead
 500:_options/writeColor.c **** //of just using switch() statements, is in order to assure that regardless
 501:_options/writeColor.c **** //of the color-value, the same number of instruction-cycles will be
 502:_options/writeColor.c **** //executed... (otherwise, the color-value might affect the width of a
 503:_options/writeColor.c **** //pixel)
 504:_options/writeColor.c **** 
 505:_options/writeColor.c **** //   uint8_t redVal; // = colorVal & 0x03;
 506:_options/writeColor.c ****    uint8_t ocrd;
 507:_options/writeColor.c **** 
 508:_options/writeColor.c **** /*
 509:_options/writeColor.c ****    if(redVal == 0x00)
 510:_options/writeColor.c ****       ocrd = 0;
 511:_options/writeColor.c ****    else if(redVal == 0x01)
 512:_options/writeColor.c ****       ocrd = 3;
 513:_options/writeColor.c ****    else //2, 3
 514:_options/writeColor.c ****       ocrd = 6;
 515:_options/writeColor.c **** */
 516:_options/writeColor.c **** #if(defined(FOUR_SHADES) && FOUR_SHADES)
 517:_options/writeColor.c ****  // "nop; nop; nop;" compiles to just a single nop! 
 518:_options/writeColor.c ****  //"\n\t" or maybe the space is necessary
 519:_options/writeColor.c ****  #define FOUR_SHADES_NOPS "nop ; \n\t nop ; \n\t nop ; \n\t"
 520:_options/writeColor.c **** #else
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 36


 521:_options/writeColor.c ****  #define FOUR_SHADES_NOPS "\n\t"
 522:_options/writeColor.c **** #endif
 523:_options/writeColor.c **** 
 524:_options/writeColor.c ****    //Each branch is 9 cycles... (12 with FOUR_SHADES)
 525:_options/writeColor.c **** __asm__ __volatile__
 511               		.stabn	68,0,525,.LM47-.LFBB7
 512               	.LM47:
 513               	/* #APP */
 514               	 ;  525 "_options/writeColor.c" 1
 515 00f2 842F      		mov    r24, r20    ; 
 516 00f4 8370      		andi   r24, 0x03  ; 
 517 00f6 01F4      		brne   red1tst_197; 
 518 00f8 80E0      		ldi   r24, 0x00   ; 
 519 00fa 0000      		nop            ; 
 520 00fc 0000      		nop            ; 
 521 00fe 0000      		nop            ; 
 522 0100 0000      		nop ; 
 523 0102 0000      		 nop ; 
 524 0104 0000      		 nop ; 
 525 0106 00C0      		rjmp  end_197   ; 
 526 0108 8130      		red1tst_197:cpi   r24, 0x01   ; 
 527 010a 01F4      		brne   red23_197   ; 
 528 010c 0000      		nop ; 
 529 010e 0000      		 nop ; 
 530 0110 0000      		 nop ; 
 531 0112 83E0      		ldi   r24, 0x03   ; 
 532 0114 00C0      		rjmp   end_197   ; 
 533 0116 8230      		red23_197:cpi   r24, 0x02 ; 
 534 0118 01F4      		brne  red3_197   ; 
 535 011a 84E0      		ldi   r24, 0x04 ; 
 536 011c 00C0      		rjmp  end_197   ; 
 537 011e 86E0      		red3_197:ldi   r24, 0x06   ; 
 538 0120 0000      		nop            ; 
 539               		end_197:
 540               	 ;  0 "" 2
 526:_options/writeColor.c ****    ( "mov    %0, %1    ; \n\t"  // ocrd (redVal) = colorVal           //1
 527:_options/writeColor.c ****      "andi   %0, 0x03  ; \n\t"  // ocrd = ocrd & 0x03                 //1
 528:_options/writeColor.c ****      "brne   red1tst_%=; \n\t"  // if(ocrd != 0x00) jump to red1test  //1`2
 529:_options/writeColor.c ****      "ldi   %0, 0x00   ; \n\t"  // (ocrd==0x00) add some delays       //1 .
 530:_options/writeColor.c ****      "nop            ; \n\t"    //                                    //1 .
 531:_options/writeColor.c ****      "nop            ; \n\t"    //                                    //1 .
 532:_options/writeColor.c ****      "nop            ; \n\t"    //                                    //1 .
 533:_options/writeColor.c ****      FOUR_SHADES_NOPS           //                                    //N .
 534:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"    //   jump to the end                  //2 .
 535:_options/writeColor.c ****                                 // (ocrd_reg = redVal_reg = 0)            .
 536:_options/writeColor.c ****    "red1tst_%=:"                //"%=" is a unique identifier for this asm.
 537:_options/writeColor.c ****                                 //  invocation, so the label won't be     .
 538:_options/writeColor.c ****                                 //  mistaken from another invocation      .
 539:_options/writeColor.c ****      "cpi   %0, 0x01   ; \n\t"  // if(ocrd-0x01 != 0)               //  1
 540:_options/writeColor.c ****      "brne   red23_%=   ; \n\t" //   jump to red=2,3                //  1`2
 541:_options/writeColor.c ****      FOUR_SHADES_NOPS           //                                  //  N .
 542:_options/writeColor.c ****      "ldi   %0, 0x03   ; \n\t"  // else ocrd = 0x03                 //  1 .
 543:_options/writeColor.c ****      "rjmp   end_%=   ; \n\t"   //      jump to the end             //  2 .
 544:_options/writeColor.c ****    "red23_%=:"                                                      //    .
 545:_options/writeColor.c **** #if (defined(FOUR_SHADES) && FOUR_SHADES)                           //   /.
 546:_options/writeColor.c ****      "cpi   %0, 0x02 ; \n\t"   // if(ocrd-0x02 !=0)               //( . 1
 547:_options/writeColor.c ****      "brne  red3_%=   ; \n\t"  //      jump to red=3              //( . 1`2
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 37


 548:_options/writeColor.c ****      "ldi   %0, 0x04 ; \n\t"   // else ocrd=4                     //( . 1 .
 549:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"   //      jump to the end            //( . 2 .
 550:_options/writeColor.c ****    "red3_%=:"                                                     //( .   /
 551:_options/writeColor.c **** #endif                                                            //(  \ /
 552:_options/writeColor.c ****      "ldi   %0, 0x06   ; \n\t"   // ocrd = 0x06                   //    1
 553:_options/writeColor.c ****      "nop            ; \n\t"  // one delay...                     //    1
 554:_options/writeColor.c ****   "end_%=:"
 555:_options/writeColor.c **** 
 556:_options/writeColor.c ****      : "=r" (ocrd)      //Output only "%0"
 557:_options/writeColor.c ****      : "r"  (colorVal)  //colorVal is "%1"
 558:_options/writeColor.c ****      //,  "d0"  (ocrd)     //ocrd is also used for andi, and is %2
 559:_options/writeColor.c ****    );
 560:_options/writeColor.c **** 
 561:_options/writeColor.c **** 
 562:_options/writeColor.c **** //   OCR1D = ocrd;
 563:_options/writeColor.c **** 
 564:_options/writeColor.c **** 
 565:_options/writeColor.c ****    //   Green: (/OC1B => RX1-)          (B1,0 Active, as well as G2,1)
 566:_options/writeColor.c ****    //    Off (6/63): DTL1 = 0
 567:_options/writeColor.c ****    //    38-39/63:      DTL1 = 1
 568:_options/writeColor.c ****    //    62-63/63:      DTL1 = 3
 569:_options/writeColor.c **** /*   switch(colorVal & 0x0C)
 570:_options/writeColor.c ****    {
 571:_options/writeColor.c ****       case 0x00:
 572:_options/writeColor.c ****          DT1 = 0;
 573:_options/writeColor.c ****          break;
 574:_options/writeColor.c ****       case 0x04:
 575:_options/writeColor.c ****          DT1 = 1;
 576:_options/writeColor.c ****          break;
 577:_options/writeColor.c ****       case 0x08:
 578:_options/writeColor.c ****       default:
 579:_options/writeColor.c ****          DT1 = 3;
 580:_options/writeColor.c ****          break;
 581:_options/writeColor.c ****    }
 582:_options/writeColor.c **** */
 583:_options/writeColor.c **** //   uint8_t greenVal = colorVal & 0x0C;
 584:_options/writeColor.c ****    uint8_t dt;
 585:_options/writeColor.c **** /*   if(greenVal == 0x00)
 586:_options/writeColor.c ****       dt=0;
 587:_options/writeColor.c ****    else if(greenVal == 0x04)
 588:_options/writeColor.c ****       dt=1;
 589:_options/writeColor.c ****    else //0x06, 0x0C
 590:_options/writeColor.c ****       dt=3;
 591:_options/writeColor.c **** */
 592:_options/writeColor.c ****    //Each branch is 9 cycles... (12 with FOUR_SHADES)
 593:_options/writeColor.c **** __asm__ __volatile__
 541               		.stabn	68,0,593,.LM48-.LFBB7
 542               	.LM48:
 543               	 ;  593 "_options/writeColor.c" 1
 544 0122 942F      		mov   r25, r20   ; 
 545 0124 9C70      		andi  r25, 0x0C ; 
 546 0126 01F4      		brne  grn4tst_198; 
 547 0128 90E0      		ldi   r25, 0x00 ; 
 548 012a 0000      		nop            ; 
 549 012c 0000      		nop            ; 
 550 012e 0000      		nop            ; 
 551 0130 0000      		nop ; 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 38


 552 0132 0000      		 nop ; 
 553 0134 0000      		 nop ; 
 554 0136 00C0      		rjmp  end_198   ; 
 555 0138 9430      		grn4tst_198:cpi   r25, 0x04 ; 
 556 013a 01F4      		brne  grn8C_198 ; 
 557 013c 91E0      		ldi   r25, 0x01 ; 
 558 013e 0000      		nop ; 
 559 0140 0000      		 nop ; 
 560 0142 0000      		 nop ; 
 561 0144 00C0      		rjmp  end_198   ; 
 562 0146 9830      		grn8C_198:cpi   r25, 0x08 ; 
 563 0148 01F4      		brne  grn3_198  ; 
 564 014a 92E0      		ldi   r25, 0x02 ; 
 565 014c 00C0      		rjmp  end_198   ; 
 566 014e 93E0      		grn3_198:ldi   r25, 0x03 ; 
 567 0150 0000      		nop            ; 
 568               		end_198:
 569               	 ;  0 "" 2
 594:_options/writeColor.c ****    ( "mov   %0, %1   ; \n\t"  // dt (greenVal) = colorVal           //1
 595:_options/writeColor.c ****      "andi  %0, 0x0C ; \n\t"  // dt = dt & 0x0C                     //1
 596:_options/writeColor.c ****      "brne  grn4tst_%=; \n\t" // if(dt != 0x00) jump to grn4test    //1`2
 597:_options/writeColor.c ****      "ldi   %0, 0x00 ; \n\t"  // (dt==0x00) add some delays         //1 .
 598:_options/writeColor.c ****      "nop            ; \n\t"  //                                    //1 .
 599:_options/writeColor.c ****      "nop            ; \n\t"  //                                    //1 .
 600:_options/writeColor.c ****      "nop            ; \n\t"  //                                    //1 .
 601:_options/writeColor.c ****      FOUR_SHADES_NOPS         //                                    //N .
 602:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"  //   jump to the end                  //2 .
 603:_options/writeColor.c ****    "grn4tst_%=:"              //"%=" is a unique identifier for this asm.
 604:_options/writeColor.c ****                               //  invocation, so the label won't be     .
 605:_options/writeColor.c ****                               //  mistaken from another invocation      .
 606:_options/writeColor.c ****      "cpi   %0, 0x04 ; \n\t"  // if(dt-0x04 != 0)                   //  1
 607:_options/writeColor.c ****      "brne  grn8C_%= ; \n\t"  //   jump to green=8,C                //  1`2
 608:_options/writeColor.c ****      "ldi   %0, 0x01 ; \n\t"  // else dt = 0x01                     //  1 .
 609:_options/writeColor.c ****      FOUR_SHADES_NOPS         //                                    //  N .
 610:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"  //      jump to the end               //  2 .
 611:_options/writeColor.c ****    "grn8C_%=:"                                                      //    .
 612:_options/writeColor.c **** #if (defined(FOUR_SHADES) && FOUR_SHADES)                           //   /.
 613:_options/writeColor.c ****      "cpi   %0, 0x08 ; \n\t"  // if(dt-0x08 !=0)                  //( . 1
 614:_options/writeColor.c ****      "brne  grn3_%=  ; \n\t"  //    jump to green=3               //( . 1`2
 615:_options/writeColor.c ****      "ldi   %0, 0x02 ; \n\t"  // else dt=2                        //( . 1 .
 616:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"  //      jump to the end             //( . 2 .
 617:_options/writeColor.c ****    "grn3_%=:"                                                     //( .   /
 618:_options/writeColor.c **** #endif                                                            //(  \ /
 619:_options/writeColor.c ****      "ldi   %0, 0x03 ; \n\t"  // dt = 0x03                        //    1
 620:_options/writeColor.c ****      "nop            ; \n\t"  // one delay...                     //    1
 621:_options/writeColor.c ****    "end_%=:"
 622:_options/writeColor.c **** 
 623:_options/writeColor.c ****      : "=r" (dt)      //Output only "%0"
 624:_options/writeColor.c ****      : "r"  (colorVal)  //colorVal is "%1"
 625:_options/writeColor.c ****      //,  "d0"  (ocrd)     //ocrd is also used for andi, and is %2
 626:_options/writeColor.c ****    );
 627:_options/writeColor.c **** 
 628:_options/writeColor.c **** 
 629:_options/writeColor.c **** 
 630:_options/writeColor.c **** //   DT1 = dt;
 631:_options/writeColor.c ****    //   Blue: (+OC1A => RX2+)               (B3,2 Active from here down)
 632:_options/writeColor.c ****    //    Off (15/63):  OCR1A=4
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 39


 633:_options/writeColor.c ****    //    47/63:        OCR1A=5
 634:_options/writeColor.c ****    //    63/63:        OCR1A=6
 635:_options/writeColor.c **** /*   switch(colorVal & 0x30)
 636:_options/writeColor.c ****    {
 637:_options/writeColor.c ****       case 0x00:
 638:_options/writeColor.c ****          OCR1A = 4;
 639:_options/writeColor.c ****          break;
 640:_options/writeColor.c ****       case 0x10:
 641:_options/writeColor.c ****          OCR1A = 5;
 642:_options/writeColor.c ****          break;
 643:_options/writeColor.c ****       case 0x20:
 644:_options/writeColor.c ****       default:
 645:_options/writeColor.c ****          OCR1A = 6;
 646:_options/writeColor.c ****          break;
 647:_options/writeColor.c ****    }
 648:_options/writeColor.c **** */
 649:_options/writeColor.c **** //   uint8_t blueVal = colorVal & 0x30;
 650:_options/writeColor.c ****    uint8_t ocra;
 651:_options/writeColor.c **** /*   if(blueVal == 0x00)
 652:_options/writeColor.c ****       ocra=4;
 653:_options/writeColor.c ****    else if(blueVal == 0x10)
 654:_options/writeColor.c ****       ocra=5;
 655:_options/writeColor.c ****    else //0x20, 0x30
 656:_options/writeColor.c ****       ocra=6;
 657:_options/writeColor.c **** */
 658:_options/writeColor.c ****    //Each branch is 9 cycles...
 659:_options/writeColor.c **** __asm__ __volatile__
 570               		.stabn	68,0,659,.LM49-.LFBB7
 571               	.LM49:
 572               	 ;  659 "_options/writeColor.c" 1
 573 0152 442F      		mov   r20, r20   ; 
 574 0154 4073      		andi  r20, 0x30 ; 
 575 0156 01F4      		brne  blu1tst_199; 
 576 0158 44E0      		ldi   r20, 0x04 ; 
 577 015a 0000      		nop            ; 
 578 015c 0000      		nop            ; 
 579 015e 0000      		nop            ; 
 580 0160 00C0      		rjmp  end_199   ; 
 581 0162 4031      		blu1tst_199:cpi   r20, 0x10 ; 
 582 0164 01F4      		brne  blu23_199 ; 
 583 0166 45E0      		ldi   r20, 0x05 ; 
 584 0168 00C0      		rjmp  end_199   ; 
 585 016a 46E0      		blu23_199:ldi   r20, 0x06 ; 
 586 016c 0000      		nop            ; 
 587               		end_199:
 588               	 ;  0 "" 2
 660:_options/writeColor.c ****    ( "mov   %0, %1   ; \n\t"  // ocra (blueVal) = colorVal          //1
 661:_options/writeColor.c ****      "andi  %0, 0x30 ; \n\t"  // ocra = ocra & 0x30                 //1
 662:_options/writeColor.c ****      "brne  blu1tst_%=; \n\t" // if(ocra != 0x00) jump to blu1test  //1`2
 663:_options/writeColor.c ****      "ldi   %0, 0x04 ; \n\t"  // (ocra==0x04) add some delays       //1 .
 664:_options/writeColor.c ****      "nop            ; \n\t"  //                                    //1 .
 665:_options/writeColor.c ****      "nop            ; \n\t"  //                                    //1 .
 666:_options/writeColor.c ****      "nop            ; \n\t"  //                                    //1 .
 667:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"  //   jump to the end                  //2 .
 668:_options/writeColor.c ****                               // (ocra_reg = blueVal_reg = 0)            .
 669:_options/writeColor.c ****    "blu1tst_%=:"              //"%=" is a unique identifier for this asm.
 670:_options/writeColor.c ****                               //  invocation, so the label won't be     .
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 40


 671:_options/writeColor.c ****                               //  mistaken from another invocation      .
 672:_options/writeColor.c ****      "cpi   %0, 0x10 ; \n\t"  // if(ocra-0x10 != 0)                 //  1
 673:_options/writeColor.c ****      "brne  blu23_%= ; \n\t"  //   jump to blu=2,3                  //  1`2
 674:_options/writeColor.c ****      "ldi   %0, 0x05 ; \n\t"  // else ocra = 0x05                   //  1 .
 675:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"  //      jump to the end               //  2 .
 676:_options/writeColor.c ****    "blu23_%=:"                                                      //    .
 677:_options/writeColor.c ****      "ldi   %0, 0x06 ; \n\t"  // ocra = 0x06                        //    1
 678:_options/writeColor.c ****      "nop            ; \n\t"  // one delay...                       //    1
 679:_options/writeColor.c ****    "end_%=:"
 680:_options/writeColor.c **** 
 681:_options/writeColor.c ****      : "=r" (ocra)      //Output only "%0"
 682:_options/writeColor.c ****      : "r"  (colorVal)  //colorVal is "%1"
 683:_options/writeColor.c ****      //,  "d0"  (ocra)     //ocra is also used for andi, and is %2
 684:_options/writeColor.c ****    );
 685:_options/writeColor.c **** 
 686:_options/writeColor.c **** #endif //SETTING vs. FRAMEBUFFER
 687:_options/writeColor.c **** 
 688:_options/writeColor.c ****    DT1 = dt;
 589               		.stabn	68,0,688,.LM50-.LFBB7
 590               	.LM50:
 591               	/* #NOAPP */
 592 016e 94BD      		out 0x24,r25
 689:_options/writeColor.c ****    OCR1D = ocrd;
 593               		.stabn	68,0,689,.LM51-.LFBB7
 594               	.LM51:
 595 0170 8ABD      		out 0x2a,r24
 690:_options/writeColor.c ****    OCR1A = ocra;
 596               		.stabn	68,0,690,.LM52-.LFBB7
 597               	.LM52:
 598 0172 4DBD      		out 0x2d,r20
 691:_options/writeColor.c **** 
 692:_options/writeColor.c **** 	if(includeDelay)
 599               		.stabn	68,0,692,.LM53-.LFBB7
 600               	.LM53:
 601 0174 6111      		cpse r22,__zero_reg__
 693:_options/writeColor.c **** 		writeColorDelay();
 602               		.stabn	68,0,693,.LM54-.LFBB7
 603               	.LM54:
 604 0176 00C0      		rjmp writeColorDelay
 605               	.L16:
 606 0178 0895      		ret
 607               		.size	writeColor, .-writeColor
 608               	.Lscope7:
 609               		.stabs	"",36,0,0,.Lscope7-.LFBB7
 610               		.stabd	78,0,0
 611               		.stabs	"nonRSB_drawPix:f(0,47)",36,0,767,nonRSB_drawPix
 612               		.stabs	"rowNum:P(4,4)",64,0,767,24
 613               		.type	nonRSB_drawPix, @function
 614               	nonRSB_drawPix:
 615               		.stabd	46,0,0
 694:_options/writeColor.c **** 		//Attempt to stretch across the full screen...
 695:_options/writeColor.c **** 		//delay_cyc(WRITE_COLOR_DELAY);
 696:_options/writeColor.c **** }
 697:_options/writeColor.c **** #endif //AT90PWM161 or not...
 698:_options/writeColor.c **** //#endif //!ROW_SEG_BUFFER
 699:_options/writeColor.c **** #endif //writeColor not defined as a macro...
 700:_options/writeColor.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 41


 701:_options/writeColor.c **** 
 702:_options/writeColor.c **** 
 703:_options/writeColor.c **** 
 704:_options/writeColor.c **** 
 705:_options/writeColor.c **** 
 706:_options/writeColor.c **** 
 707:_options/writeColor.c **** 
 708:_options/writeColor.c **** 
 709:_options/writeColor.c **** /*
 710:_options/writeColor.c **** static __inline__ \
 711:_options/writeColor.c **** void writeColor(uint8_t includeDelay, uint8_t colorVal) \
 712:_options/writeColor.c ****      __attribute__((__always_inline__));
 713:_options/writeColor.c **** */
 714:_options/writeColor.c **** 
 715:_options/writeColor.c **** 
 716:_options/writeColor.c **** 
 717:_options/writeColor.c **** //This drawPix was developed before RowSegBuffer
 718:_options/writeColor.c **** // there are two versions included: RowBuffer and FrameBuffer
 719:_options/writeColor.c **** // which function almost identically as far as this function's concerned
 720:_options/writeColor.c **** 
 721:_options/writeColor.c **** // After writeColor()s are called, the remaining is (a/o v60) identical
 722:_options/writeColor.c **** // to rsb_drawPix, as it was a result of an:
 723:_options/writeColor.c **** //#if(!ROW_SEG_BUFFER)
 724:_options/writeColor.c **** // void drawPix(uint8_t rowNum)
 725:_options/writeColor.c **** // {
 726:_options/writeColor.c **** //  	do writeColorStuff...
 727:_options/writeColor.c **** //#else
 728:_options/writeColor.c **** // void drawPix(uint8_t rowNum)
 729:_options/writeColor.c **** // {
 730:_options/writeColor.c **** //		do rowSegBufferStuff...
 731:_options/writeColor.c **** //#endif
 732:_options/writeColor.c **** //    do remaining Stuff...
 733:_options/writeColor.c **** // }
 734:_options/writeColor.c **** 
 735:_options/writeColor.c **** // But nonRSB stuff hasn't been tested in quite some time...
 736:_options/writeColor.c **** 
 737:_options/writeColor.c **** #if(defined(WC_SETUP) && WC_SETUP)
 738:_options/writeColor.c **** uint8_t *wc_color; 
 739:_options/writeColor.c **** 
 740:_options/writeColor.c **** #define drawPixSetup	writeColor_drawPixSetup
 741:_options/writeColor.c **** #endif
 742:_options/writeColor.c **** 
 743:_options/writeColor.c **** 
 744:_options/writeColor.c **** static __inline__
 745:_options/writeColor.c **** uint8_t * writeColor_drawPixSetup(uint16_t rowNum)
 746:_options/writeColor.c **** 	__attribute__((__always_inline__));
 747:_options/writeColor.c **** 
 748:_options/writeColor.c **** uint8_t * writeColor_drawPixSetup(uint16_t rowNum)
 749:_options/writeColor.c **** {
 750:_options/writeColor.c **** 
 751:_options/writeColor.c **** #if(!defined(WC_SETUP) || !WC_SETUP)
 752:_options/writeColor.c **** 	uint8_t *wc_color;
 753:_options/writeColor.c **** #endif
 754:_options/writeColor.c **** 
 755:_options/writeColor.c **** #if(defined(ROW_BUFFER) && ROW_BUFFER)
 756:_options/writeColor.c ****    wc_color = &(rowBuffer[0]);
 757:_options/writeColor.c **** #else
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 42


 758:_options/writeColor.c **** 	rowNum = rowNum*FB_HEIGHT / V_COUNT;
 759:_options/writeColor.c **** //	rowNum &= 0x0f;
 760:_options/writeColor.c **** 	wc_color = &(frameBuffer[rowNum][0]);
 761:_options/writeColor.c **** #endif
 762:_options/writeColor.c **** 
 763:_options/writeColor.c **** 	return wc_color;
 764:_options/writeColor.c **** }
 765:_options/writeColor.c **** 
 766:_options/writeColor.c **** 
 767:_options/writeColor.c **** static __inline__ void nonRSB_drawPix(uint16_t rowNum)
 768:_options/writeColor.c **** {
 616               		.stabn	68,0,768,.LM55-.LFBB8
 617               	.LM55:
 618               	.LFBB8:
 619 017a CF93      		push r28
 620 017c DF93      		push r29
 621               	/* prologue: function */
 622               	/* frame size = 0 */
 623               	/* stack size = 2 */
 624               	.L__stack_usage = 2
 625               	.LBB80:
 626               	.LBB81:
 758:_options/writeColor.c **** //	rowNum &= 0x0f;
 627               		.stabn	68,0,758,.LM56-.LFBB8
 628               	.LM56:
 629 017e 24E0      		ldi r18,4
 630               		1:
 631 0180 880F      		lsl r24
 632 0182 991F      		rol r25
 633 0184 2A95      		dec r18
 634 0186 01F4      		brne 1b
 635 0188 60E0      		ldi r22,0
 636 018a 73E0      		ldi r23,lo8(3)
 637 018c 00D0      		rcall __udivmodhi4
 638               	.LBE81:
 639               	.LBE80:
 769:_options/writeColor.c ****    //uint8_t *setting = &(settingBuffer[rowNum][0]);
 770:_options/writeColor.c **** 
 771:_options/writeColor.c **** 	//A pointer to the first color (pixel) in the row...
 772:_options/writeColor.c **** 
 773:_options/writeColor.c **** 	//a/o v80
 774:_options/writeColor.c **** 	//Stupid optimizer... just having these assigned at the beginning of the
 775:_options/writeColor.c **** 	//function doesn't make them occur in that order.
 776:_options/writeColor.c **** 	//In fact, the first writeColor... maybe I'm mistaken.
 777:_options/writeColor.c **** #if(defined(WC_SETUP) && WC_SETUP)
 778:_options/writeColor.c **** 	uint8_t * color = wc_color;
 779:_options/writeColor.c **** #else
 780:_options/writeColor.c **** 	uint8_t * color = writeColor_drawPixSetup(rowNum);
 640               		.stabn	68,0,780,.LM57-.LFBB8
 641               	.LM57:
 642 018e CB01      		movw r24,r22
 643 0190 61E1      		ldi r22,lo8(17)
 644 0192 70E0      		ldi r23,0
 645 0194 00D0      		rcall __mulhi3
 646 0196 EC01      		movw r28,r24
 647 0198 C050      		subi r28,lo8(-(frameBuffer))
 648 019a D040      		sbci r29,hi8(-(frameBuffer))
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 43


 781:_options/writeColor.c **** #endif
 782:_options/writeColor.c **** 
 783:_options/writeColor.c **** 	//a/o v67:
 784:_options/writeColor.c **** 	// WTF... this didn't work without DEonly_init();
 785:_options/writeColor.c **** 	// despite the fact that writeColor() on the 161 sets DE?!
 786:_options/writeColor.c **** 	// AND it worked on the Tiny861 without this?!
 787:_options/writeColor.c **** 	// No... writeColor doesn't change one register, which needs to be set
 788:_options/writeColor.c **** 	// for blue...
 789:_options/writeColor.c **** 	//DEonly_init();
 790:_options/writeColor.c **** 	// This should now be handled in writeColor(TRUE...)
 791:_options/writeColor.c **** 	// And since Tiny861 didn't have it anyhow, it shouldn't matter that
 792:_options/writeColor.c **** 	// Tiny861's writeColor ignores the TRUE...
 793:_options/writeColor.c **** //	writeColor(TRUE,FALSE, _W);
 794:_options/writeColor.c **** 	//lockPSC2();
 795:_options/writeColor.c **** 	//OCR2SA=1;	//WTF, 0 doesn't work?!
 796:_options/writeColor.c **** 	//OCR2RA=4;
 797:_options/writeColor.c **** 	//unlockPSC2();
 798:_options/writeColor.c ****    /*
 799:_options/writeColor.c ****       DEonly_fromNada();
 800:_options/writeColor.c ****       //Enable complementary-output for Green (on /OC1B, where CLK is OC1B)
 801:_options/writeColor.c ****       TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
 802:_options/writeColor.c ****                | (0<<COM1B1) | (1<<COM1B0)
 803:_options/writeColor.c ****                | (1<<PWM1A) | (1<<PWM1B) );
 804:_options/writeColor.c ****    */
 805:_options/writeColor.c ****       //The Greenish-bar on the left is due to the time it takes to execute
 806:_options/writeColor.c ****       // the first writeColor (since its value is only written at the END)
 807:_options/writeColor.c ****       // Thus the greenish-bar is about one write-color wide...
 808:_options/writeColor.c **** 
 809:_options/writeColor.c ****    //Judging by some weird experiences re v21/22,
 810:_options/writeColor.c ****    // it's not entirely likely this will be predictable
 811:_options/writeColor.c ****    // it may try to recalculate the Z register between writeBlues...
 812:_options/writeColor.c ****    // hopefully not, for now. I should probably assemblify this
 813:_options/writeColor.c **** //      writeColor(FALSE,FALSE, *(color+0));
 814:_options/writeColor.c **** 	//a/o v71, see a/o v67, plus new notes... TRUE is handy!
 815:_options/writeColor.c ****       writeColor(TRUE,FALSE, *(color+0));
 649               		.stabn	68,0,815,.LM58-.LFBB8
 650               	.LM58:
 651 019c 4881      		ld r20,Y
 652 019e 60E0      		ldi r22,0
 653 01a0 81E0      		ldi r24,lo8(1)
 654 01a2 00D0      		rcall writeColor
 816:_options/writeColor.c **** 
 817:_options/writeColor.c **** 		lvds_enableGreen_MakeClockSensitiveToDT();
 655               		.stabn	68,0,817,.LM59-.LFBB8
 656               	.LM59:
 657 01a4 83E5      		ldi r24,lo8(83)
 658 01a6 80BF      		out 0x30,r24
 659               	.LBB82:
 660               	.LBB83:
 661               	.LBB84:
 662               	.LBB85:
 663               		.stabs	"/opt/local/avr/include/util/delay_basic.h",132,0,0,.Ltext10
 664               	.Ltext10:
 665               		.stabn	68,0,105,.LM60-.LFBB8
 666               	.LM60:
 667 01a8 81E1      		ldi r24,lo8(17)
 668 01aa 90E0      		ldi r25,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 44


 669               	/* #APP */
 670               	 ;  105 "/opt/local/avr/include/util/delay_basic.h" 1
 671 01ac 0197      		1: sbiw r24,1
 672 01ae 01F4      		brne 1b
 673               	 ;  0 "" 2
 674               	/* #NOAPP */
 675               	.LBE85:
 676               	.LBE84:
 677               	.LBE83:
 678               	.LBE82:
 679               		.stabs	"_options/fb_writeColorCalls.c",132,0,0,.Ltext11
 680               	.Ltext11:
   1:_options/fb_writeColorCalls.c **** /* mehPL:
   2:_options/fb_writeColorCalls.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:_options/fb_writeColorCalls.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:_options/fb_writeColorCalls.c ****  *    Please see the bottom.
   5:_options/fb_writeColorCalls.c ****  *    Enjoy!
   6:_options/fb_writeColorCalls.c ****  */
   7:_options/fb_writeColorCalls.c **** 
   8:_options/fb_writeColorCalls.c **** 
   9:_options/fb_writeColorCalls.c **** 
  10:_options/fb_writeColorCalls.c **** 
  11:_options/fb_writeColorCalls.c **** 
  12:_options/fb_writeColorCalls.c **** 
  13:_options/fb_writeColorCalls.c **** //This file contains consecutive writeColor calls
  14:_options/fb_writeColorCalls.c **** // in such a way that they'll be optimized not to use pointer-arithmetic,
  15:_options/fb_writeColorCalls.c **** // nor a for-loop which requires counters, jumps, and tests that take quite
  16:_options/fb_writeColorCalls.c **** // a bit of overhead
  17:_options/fb_writeColorCalls.c **** 
  18:_options/fb_writeColorCalls.c **** //This file was mostly generated by _tools/createUnrolledLoop.sh
  19:_options/fb_writeColorCalls.c **** // But had to be hand-modified (and that script probably won't run on your
  20:_options/fb_writeColorCalls.c **** // system as-is, as it depends on other scripts I have)
  21:_options/fb_writeColorCalls.c **** 
  22:_options/fb_writeColorCalls.c **** 
  23:_options/fb_writeColorCalls.c **** #if(!defined(FB_WIDTH) || (FB_WIDTH > 64) || FB_WIDTH < 2)
  24:_options/fb_writeColorCalls.c ****  #error "FB_WIDTH needs to be a defined value from 2 to 64"
  25:_options/fb_writeColorCalls.c **** #else
  26:_options/fb_writeColorCalls.c **** 
  27:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(2))
  28:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+1));
 681               		.stabn	68,0,28,.LM61-.LFBB8
 682               	.LM61:
 683 01b0 4981      		ldd r20,Y+1
 684 01b2 61E0      		ldi r22,lo8(1)
 685 01b4 80E0      		ldi r24,0
 686 01b6 00D0      		rcall writeColor
  29:_options/fb_writeColorCalls.c **** #endif
  30:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(3))
  31:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+2));
 687               		.stabn	68,0,31,.LM62-.LFBB8
 688               	.LM62:
 689 01b8 4A81      		ldd r20,Y+2
 690 01ba 61E0      		ldi r22,lo8(1)
 691 01bc 80E0      		ldi r24,0
 692 01be 00D0      		rcall writeColor
  32:_options/fb_writeColorCalls.c **** #endif
  33:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(4))
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 45


  34:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+3));
 693               		.stabn	68,0,34,.LM63-.LFBB8
 694               	.LM63:
 695 01c0 4B81      		ldd r20,Y+3
 696 01c2 61E0      		ldi r22,lo8(1)
 697 01c4 80E0      		ldi r24,0
 698 01c6 00D0      		rcall writeColor
  35:_options/fb_writeColorCalls.c **** #endif
  36:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(5))
  37:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+4));
 699               		.stabn	68,0,37,.LM64-.LFBB8
 700               	.LM64:
 701 01c8 4C81      		ldd r20,Y+4
 702 01ca 61E0      		ldi r22,lo8(1)
 703 01cc 80E0      		ldi r24,0
 704 01ce 00D0      		rcall writeColor
  38:_options/fb_writeColorCalls.c **** #endif
  39:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(6))
  40:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+5));
 705               		.stabn	68,0,40,.LM65-.LFBB8
 706               	.LM65:
 707 01d0 4D81      		ldd r20,Y+5
 708 01d2 61E0      		ldi r22,lo8(1)
 709 01d4 80E0      		ldi r24,0
 710 01d6 00D0      		rcall writeColor
  41:_options/fb_writeColorCalls.c **** #endif
  42:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(7))
  43:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+6));
 711               		.stabn	68,0,43,.LM66-.LFBB8
 712               	.LM66:
 713 01d8 4E81      		ldd r20,Y+6
 714 01da 61E0      		ldi r22,lo8(1)
 715 01dc 80E0      		ldi r24,0
 716 01de 00D0      		rcall writeColor
  44:_options/fb_writeColorCalls.c **** #endif
  45:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(8))
  46:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+7));
 717               		.stabn	68,0,46,.LM67-.LFBB8
 718               	.LM67:
 719 01e0 4F81      		ldd r20,Y+7
 720 01e2 61E0      		ldi r22,lo8(1)
 721 01e4 80E0      		ldi r24,0
 722 01e6 00D0      		rcall writeColor
  47:_options/fb_writeColorCalls.c **** #endif
  48:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(9))
  49:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+8));
 723               		.stabn	68,0,49,.LM68-.LFBB8
 724               	.LM68:
 725 01e8 4885      		ldd r20,Y+8
 726 01ea 61E0      		ldi r22,lo8(1)
 727 01ec 80E0      		ldi r24,0
 728 01ee 00D0      		rcall writeColor
  50:_options/fb_writeColorCalls.c **** #endif
  51:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(10))
  52:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+9));
 729               		.stabn	68,0,52,.LM69-.LFBB8
 730               	.LM69:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 46


 731 01f0 4985      		ldd r20,Y+9
 732 01f2 61E0      		ldi r22,lo8(1)
 733 01f4 80E0      		ldi r24,0
 734 01f6 00D0      		rcall writeColor
  53:_options/fb_writeColorCalls.c **** #endif
  54:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(11))
  55:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+10));
 735               		.stabn	68,0,55,.LM70-.LFBB8
 736               	.LM70:
 737 01f8 4A85      		ldd r20,Y+10
 738 01fa 61E0      		ldi r22,lo8(1)
 739 01fc 80E0      		ldi r24,0
 740 01fe 00D0      		rcall writeColor
  56:_options/fb_writeColorCalls.c **** #endif
  57:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(12))
  58:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+11));
 741               		.stabn	68,0,58,.LM71-.LFBB8
 742               	.LM71:
 743 0200 4B85      		ldd r20,Y+11
 744 0202 61E0      		ldi r22,lo8(1)
 745 0204 80E0      		ldi r24,0
 746 0206 00D0      		rcall writeColor
  59:_options/fb_writeColorCalls.c **** #endif
  60:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(13))
  61:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+12));
 747               		.stabn	68,0,61,.LM72-.LFBB8
 748               	.LM72:
 749 0208 4C85      		ldd r20,Y+12
 750 020a 61E0      		ldi r22,lo8(1)
 751 020c 80E0      		ldi r24,0
 752 020e 00D0      		rcall writeColor
  62:_options/fb_writeColorCalls.c **** #endif
  63:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(14))
  64:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+13));
 753               		.stabn	68,0,64,.LM73-.LFBB8
 754               	.LM73:
 755 0210 4D85      		ldd r20,Y+13
 756 0212 61E0      		ldi r22,lo8(1)
 757 0214 80E0      		ldi r24,0
 758 0216 00D0      		rcall writeColor
  65:_options/fb_writeColorCalls.c **** #endif
  66:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(15))
  67:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+14));
 759               		.stabn	68,0,67,.LM74-.LFBB8
 760               	.LM74:
 761 0218 4E85      		ldd r20,Y+14
 762 021a 61E0      		ldi r22,lo8(1)
 763 021c 80E0      		ldi r24,0
 764 021e 00D0      		rcall writeColor
  68:_options/fb_writeColorCalls.c **** #endif
  69:_options/fb_writeColorCalls.c **** #if(FB_WIDTH>=(16))
  70:_options/fb_writeColorCalls.c ****   writeColor(FALSE,TRUE, *(color+15));
 765               		.stabn	68,0,70,.LM75-.LFBB8
 766               	.LM75:
 767 0220 4F85      		ldd r20,Y+15
 768 0222 61E0      		ldi r22,lo8(1)
 769 0224 80E0      		ldi r24,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 47


 770 0226 00D0      		rcall writeColor
 771               		.stabs	"_options/writeColor.c",132,0,0,.Ltext12
 772               	.Ltext12:
 818:_options/writeColor.c **** 
 819:_options/writeColor.c **** 		//Because includeDelay is FALSE, above, do it here...
 820:_options/writeColor.c **** 		// The intention being to get enableGreen as soon after the
 821:_options/writeColor.c **** 		// register-settings as possible.
 822:_options/writeColor.c **** #if (defined(LCDINTERFACE_BITBANGED_DOTCLOCK) && \
 823:_options/writeColor.c **** 		LCDINTERFACE_BITBANGED_DOTCLOCK)
 824:_options/writeColor.c **** 		delay_Dots(WRITE_COLOR_DOT_DELAY);
 825:_options/writeColor.c **** #else
 826:_options/writeColor.c **** 		delay_cyc(WRITE_COLOR_DELAY);
 827:_options/writeColor.c **** #endif
 828:_options/writeColor.c **** 
 829:_options/writeColor.c ****       //Moving this here not only removes (most of) the green bar
 830:_options/writeColor.c ****       // but also seems to make the pixel edges significantly sharper
 831:_options/writeColor.c ****       // (v29 has ~1/8in of noise, v30 has ~1pixel noise at the right edge)
 832:_options/writeColor.c **** //      TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
 833:_options/writeColor.c **** //               | (0<<COM1B1) | (1<<COM1B0)
 834:_options/writeColor.c **** //               | (1<<PWM1A) | (1<<PWM1B) );
 835:_options/writeColor.c **** 
 836:_options/writeColor.c **** 
 837:_options/writeColor.c **** #if ( (defined(FRAMEBUFFER_TESTING) && FRAMEBUFFER_TESTING) || \
 838:_options/writeColor.c ****       (defined(ROWBUFFER_TESTING) && ROWBUFFER_TESTING) )
 839:_options/writeColor.c **** 		//fb_writeColorCalls is pretty much identical to the below cases...
 840:_options/writeColor.c **** 		// but automatically includes the proper number of calls to
 841:_options/writeColor.c **** 		// writeColor based on FB_WIDTH
 842:_options/writeColor.c **** 		//Can't yet create an autoGenerated form via make...
 843:_options/writeColor.c **** 		// since FB_WIDTH is not available to make.
 844:_options/writeColor.c **** 		#include "fb_writeColorCalls.c"
 845:_options/writeColor.c **** 		//again, including fb_writeColorCalls.c, here is the equivalent of:
 846:_options/writeColor.c **** 		//writeColor(FALSE,TRUE, *(color+1));
 847:_options/writeColor.c **** 		//writeColor(FALSE,TRUE, *(color+2));
 848:_options/writeColor.c **** 		// ...
 849:_options/writeColor.c **** 		// the appropriate number of times.
 850:_options/writeColor.c **** #else
 851:_options/writeColor.c **** #error "This is just a reminder that all the ugly still exists and could probably easily be replace
 852:_options/writeColor.c **** 		//Keeping this for the various special cases that have yet to be
 853:_options/writeColor.c **** 		//reimplemented...
 854:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+1));    
 855:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+2));    
 856:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+3)); 
 857:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+4));    
 858:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+5));                
 859:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+6));  
 860:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+7));                         
 861:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+8));                         
 862:_options/writeColor.c **** 		writeColor(FALSE,TRUE, *(color+9));                         
 863:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+10));                         
 864:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+11));                         
 865:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+12));                         
 866:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+13));                         
 867:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+14));                         
 868:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+15));   
 869:_options/writeColor.c **** #define COLORS_WRITTEN   16      
 870:_options/writeColor.c **** #if ( (defined(COLOR_BAR_SCROLL) && COLOR_BAR_SCROLL) \
 871:_options/writeColor.c ****    || (defined(ROW_BUFFER) && (ROW_BUFFER)) )
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 48


 872:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+16));
 873:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+17));
 874:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+18));
 875:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+19));
 876:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+20));
 877:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+21));
 878:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+22));
 879:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+23));
 880:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+24));
 881:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+25));
 882:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+26));
 883:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+27));
 884:_options/writeColor.c **** #define COLORS_WRITTEN   28
 885:_options/writeColor.c **** #if (defined(ROW_BUFFER) && (ROW_BUFFER))
 886:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+28));
 887:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+29));
 888:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+30));
 889:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+31));
 890:_options/writeColor.c **** //Some sort of syncing problem after 32... (?)
 891:_options/writeColor.c **** 
 892:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+32));
 893:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+33));
 894:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+34));
 895:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+35));
 896:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+36));
 897:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+37));
 898:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+38));
 899:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+39));
 900:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+40));
 901:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+41));
 902:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+42));
 903:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+43));
 904:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+44));
 905:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+45));
 906:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+46));
 907:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+47));
 908:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+48));
 909:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+49));
 910:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+50));
 911:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+51));
 912:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+52));
 913:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+53));
 914:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+54));
 915:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+55));
 916:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+56));
 917:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+57));
 918:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+58));
 919:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+59));
 920:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+60));
 921:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+61));
 922:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+62));
 923:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+63));
 924:_options/writeColor.c **** // WriteColor writes the pixel *after* the calculations...
 925:_options/writeColor.c **** // thus the pixel appears basically after writeColor completes
 926:_options/writeColor.c **** // These nops assure the 64th pixel is fully-displayed before exitting
 927:_options/writeColor.c **** // (Not sure how the other following instructions apply to this)
 928:_options/writeColor.c **** // The number of nops was found experimentally...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 49


 929:_options/writeColor.c **** //a/o v71 (in which this isn't even executed, due to #if...)
 930:_options/writeColor.c **** // See below...
 931:_options/writeColor.c **** asm("nop");
 932:_options/writeColor.c **** asm("nop");
 933:_options/writeColor.c **** asm("nop");
 934:_options/writeColor.c **** asm("nop");
 935:_options/writeColor.c **** asm("nop");
 936:_options/writeColor.c **** asm("nop");
 937:_options/writeColor.c **** asm("nop");
 938:_options/writeColor.c **** asm("nop");
 939:_options/writeColor.c **** //count "0" below, as well..
 940:_options/writeColor.c **** #define COLORS_WRITTEN 65
 941:_options/writeColor.c **** #endif //ROW_BUFFER
 942:_options/writeColor.c **** #else
 943:_options/writeColor.c **** //   writeColor(0);
 944:_options/writeColor.c **** #endif //COLOR_BARS || ROW_BUFFER
 945:_options/writeColor.c **** #endif //FRAMEBUFFER_TESTING or not...
 946:_options/writeColor.c **** 
 947:_options/writeColor.c **** /*      reg[17] = colorBuffer[rowNum][17];                         
 948:_options/writeColor.c ****       writeColor(reg[17]);                         
 949:_options/writeColor.c ****       ...
 950:_options/writeColor.c ****       reg[20] = colorBuffer[rowNum][20];                         
 951:_options/writeColor.c ****       writeColor(reg[20]);  
 952:_options/writeColor.c ****       
 953:_options/writeColor.c ****       //REPEATING to fill screen... (delayDots = 342 worked prior to this)
 954:_options/writeColor.c ****       reg[0] = colorBuffer[rowNum][0];
 955:_options/writeColor.c ****       writeColor(reg[0]);
 956:_options/writeColor.c ****       ...
 957:_options/writeColor.c ****       reg[10] = colorBuffer[rowNum][10];
 958:_options/writeColor.c ****       writeColor(reg[10]);
 959:_options/writeColor.c **** */
 960:_options/writeColor.c **** 
 961:_options/writeColor.c **** 		//a/o v71, see note above regarding nops...
 962:_options/writeColor.c **** 		// since writeColor() NOW actually *sets* the registers at the *end*
 963:_options/writeColor.c **** 		// of the calculations, but *before* the WRITE_COLOR_DELAY...
 964:_options/writeColor.c **** 		// The last pixel is cut-short again, even *with* the delay
 965:_options/writeColor.c **** 		// Having a bit of difficulty wrapping my head around *why*
 966:_options/writeColor.c **** 		// since we're using writeColor, here, to set _W = WHITE
 967:_options/writeColor.c **** 		// Probably because _W is a constant, and therefore doesn't require
 968:_options/writeColor.c **** 		// loading from SRAM, extraction, etc...
 969:_options/writeColor.c **** 		//
 970:_options/writeColor.c **** 		// E.G.:
 971:_options/writeColor.c **** 		// calc set delay (csd)
 972:_options/writeColor.c **** 		//
 973:_options/writeColor.c **** 		//  c1  s1 d1  c2  s2 d2  c3  s3 d3 cW sW (dW = FALSE)
 974:_options/writeColor.c **** 		// |---|--#---|---|--#---|---|--#---|-|--#...
 975:_options/writeColor.c **** 		//        \---------/\---------/\-------/\---
 976:_options/writeColor.c **** 		//         Pixel 1    Pixel 2    Pixel 3   WHITE  ... visible "pixel"
 977:_options/writeColor.c **** 		//          11pix      11pix       9pix           ... screen pixels
 978:_options/writeColor.c **** 		//
 979:_options/writeColor.c **** 		// Not sure how to accomodate this... maybe just load _W in a sram
 980:_options/writeColor.c **** 		// location...?
 981:_options/writeColor.c ****       //Display the rest as black... (now white)
 982:_options/writeColor.c ****       //writeColor(FALSE,FALSE, _W);
 983:_options/writeColor.c **** 		//a/o v86: I can't recall why I chose white, maybe just for
 984:_options/writeColor.c **** 		//visibility...
 985:_options/writeColor.c **** 		//Since we're working with VISIBLE_ROW_DOTS in this version, and want
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 50


 986:_options/writeColor.c **** 		//the remaining dots to be black, we'll see where this goes...
 987:_options/writeColor.c **** /*#if(!defined(FRAMEBUFFER_TESTING) || !FRAMEBUFFER_TESTING)
 988:_options/writeColor.c ****  #error "nonRSB_drawPix now requires the row-buffer to be FB_WIDTH+1 long"
 989:_options/writeColor.c **** #endif
 990:_options/writeColor.c **** */		//This could probably be optimized a bit... maybe just using *one*
 991:_options/writeColor.c **** 		//SRAM location, instead of using one at the end of each row...
 992:_options/writeColor.c **** 		// but this should be pretty much guaranteed to be the same length
 993:_options/writeColor.c **** 		// since it uses the same convention.
 994:_options/writeColor.c **** 		// Looks close to right, but it could be an illusion ;)
 995:_options/writeColor.c **** 		writeColor(FALSE,FALSE, *(color+FB_WIDTH));
 773               		.stabn	68,0,995,.LM76-.LFBB8
 774               	.LM76:
 775 0228 4889      		ldd r20,Y+16
 776 022a 60E0      		ldi r22,0
 777 022c 80E0      		ldi r24,0
 778 022e 00D0      		rcall writeColor
 996:_options/writeColor.c **** 
 997:_options/writeColor.c **** 		//Do it as quickly as possible.
 998:_options/writeColor.c **** 		// (No, this cuts off the last pixel...)
 999:_options/writeColor.c **** 		//OCR1D = 0;	//Red Off
1000:_options/writeColor.c **** 		//DT1 = 0;		//Green Off
1001:_options/writeColor.c **** 		//OCR1A = 4;  //Blue Off
1002:_options/writeColor.c **** 
1003:_options/writeColor.c **** 		//writeColor(0xff);
1004:_options/writeColor.c ****         //delay_Dots(500);//142); //Don't want to disable DE too early...   
1005:_options/writeColor.c ****       //900 leaves a buffer for various calculations while also showing
1006:_options/writeColor.c ****       // a blue bar at the right-side...
1007:_options/writeColor.c ****       //LTN Last Used 900
1008:_options/writeColor.c ****       // -68 is from 900's intent, IIRC
1009:_options/writeColor.c ****       //  seems arbitrary, but its value (especially if too small)
1010:_options/writeColor.c ****       // causes blank lines... (?!)
1011:_options/writeColor.c ****       // -60 makes more sense for a delay (was the original post-900)
1012:_options/writeColor.c ****       //  (outside DOTS_TO_CYC because it's for cycles used for calcs...
1013:_options/writeColor.c ****       // -68 worked for LVDS_PRE=2
1014:_options/writeColor.c ****       // -60 for 1
1015:_options/writeColor.c ****       // 4 doesn't work... blue-lines
1016:_options/writeColor.c **** 
1017:_options/writeColor.c **** //a/o v60
1018:_options/writeColor.c **** //From Here Down, everything has only been tested recently with rowSegBuf
1019:_options/writeColor.c **** // I did a nice #if-#else scheme which makes this redundant
1020:_options/writeColor.c **** // with what's in rsb_drawPix()...
1021:_options/writeColor.c **** 
1022:_options/writeColor.c **** // a/o v59-12ish... ROW_COMPLETION_DELAY uses were already commented-out
1023:_options/writeColor.c **** // BUT WHY WAS IT REMOVED?! Seems to help, now.
1024:_options/writeColor.c **** // 
1025:_options/writeColor.c **** //   Some Experimenting has led to the conclusion:
1026:_options/writeColor.c **** //   DE's active-duration needn't be exact. In fact, it can be *way* off
1027:_options/writeColor.c **** //     White is shown between the end of drawSegs, and cyan is shown after
1028:_options/writeColor.c **** //   ROW_COMPLETION_DELAY (which, for now, is constant, regardless of how
1029:_options/writeColor.c **** //    many pixels were drawn)
1030:_options/writeColor.c **** //   Almost immediately after the ROW_COMPLETION_DELAY (when it turns cyan)
1031:_options/writeColor.c **** //    DE is disabled
1032:_options/writeColor.c **** //    Yet the remainder of the screen still fills with cyan.
1033:_options/writeColor.c **** //   THUS: Disabling DE before the end of the screen appears to have the
1034:_options/writeColor.c **** //    effect of either not being acknowledged, or of repeating the last
1035:_options/writeColor.c **** //    color (untested)
1036:_options/writeColor.c **** //   Also, DE durations that are *longer* than the screen, seem to be 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 51


1037:_options/writeColor.c **** //    absorbed by nonexistent pixels to the left...
1038:_options/writeColor.c **** //    (setting ROW_COMPLETION_DELAY==65535 unreasonably high,
1039:_options/writeColor.c **** //         just shows white at the right side, and still syncs)
1040:_options/writeColor.c **** //   Now, the original problem was that there seemed to be some carry-over
1041:_options/writeColor.c **** //   which maybe due to DEs that are EXTRAORDINARILY long?
1042:_options/writeColor.c **** //   NO!
1043:_options/writeColor.c **** //   Actually, it appears to be due to DEs that are TOO SHORT (?)
1044:_options/writeColor.c **** //      (setting ROW_COMPLETION_DELAY to 0 causes the problem again)
1045:_options/writeColor.c **** //   Doesn't appear to be *entirely* scientific, as using SEG_SINE
1046:_options/writeColor.c **** //    would suggest that these (now cyan) bars would appear at the troughs
1047:_options/writeColor.c **** //    in the diagonal-color-stripes at the top...
1048:_options/writeColor.c **** //    they seem, instead to be somewhat random, though maybe more common
1049:_options/writeColor.c **** //      at those locations.
1050:_options/writeColor.c **** //   But Wait! Setting ROW_COMPLETION_DELAY to 1 fixes it again.
1051:_options/writeColor.c **** //    realistically, that should be nothing more than a single nop; no?
1052:_options/writeColor.c **** //    (Maybe not, with a few cycles to entry, and minimum execution times)
1053:_options/writeColor.c **** //    a handful of nops does the trick, as well.
1054:_options/writeColor.c **** //    So is it a problem with too short a DE, or is it a matter of
1055:_options/writeColor.c **** //    e.g. the last segment drawn is setting new values that might only
1056:_options/writeColor.c **** //    be *completely transmitted* after a full PWM cycle...
1057:_options/writeColor.c **** //    So maybe somehow that last transaction is being interrupted
1058:_options/writeColor.c **** //     by the TCCR1A settings, or new values...
1059:_options/writeColor.c **** //    Plausible.
1060:_options/writeColor.c **** //
1061:_options/writeColor.c **** // FURTHER. Lest it be revisited. It was noted elsewhere that I thought
1062:_options/writeColor.c **** // this display was NOT DE-Only. In fact, the datasheet specifically says
1063:_options/writeColor.c **** // "DE-Only Mode"
1064:_options/writeColor.c **** 
1065:_options/writeColor.c **** 
1066:_options/writeColor.c **** 
1067:_options/writeColor.c **** 
1068:_options/writeColor.c **** /*#define ROW_COMPLETION_DELAY \
1069:_options/writeColor.c ****       (DOTS_TO_CYC(DE_ACTIVE_DOTS) -60  \
1070:_options/writeColor.c ****        - WRITE_COLOR_CYCS * COLORS_WRITTEN)
1071:_options/writeColor.c **** */
1072:_options/writeColor.c **** //I think -60 was an arbitrary value just chosen to compensate for
1073:_options/writeColor.c **** //calculations/instructions...
1074:_options/writeColor.c **** // -90 has been found to be right at the edge of the screen, now...
1075:_options/writeColor.c **** // ish. maybe it's not accurate since delay_loop_2 is four instructions per
1076:_options/writeColor.c **** // loop...?
1077:_options/writeColor.c **** #if (!defined(LCDINTERFACE_BITBANGED_DOTCLOCK) || \
1078:_options/writeColor.c **** 		!LCDINTERFACE_BITBANGED_DOTCLOCK)
1079:_options/writeColor.c ****  #define ROW_COMPLETION_DELAY \
1080:_options/writeColor.c ****       (DOTS_TO_CYC(DE_ACTIVE_DOTS) - 90  \
1081:_options/writeColor.c ****        - (WRITE_COLOR_CYCS + WRITE_COLOR_DELAY) * COLORS_WRITTEN)
1082:_options/writeColor.c **** //#define ROW_COMPLETION_DELAY 512 //1 //65535//512
1083:_options/writeColor.c **** 
1084:_options/writeColor.c **** 
1085:_options/writeColor.c **** 
1086:_options/writeColor.c **** 
1087:_options/writeColor.c **** //#error "should add SEG_STRETCH here..."
1088:_options/writeColor.c ****  #if (ROW_COMPLETION_DELAY > 0)
1089:_options/writeColor.c **** //      delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS) -60 // - 68)// - 60
1090:_options/writeColor.c **** //            - WRITE_COLOR_CYCS*COLORS_WRITTEN);
1091:_options/writeColor.c **** 		delay_cyc(ROW_COMPLETION_DELAY);
1092:_options/writeColor.c ****  #else
1093:_options/writeColor.c ****   #warning "ROW_COMPLETION_DELAY <= 0, so not used."
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 52


1094:_options/writeColor.c ****  #endif
1095:_options/writeColor.c **** #else //LCDINTERFACE_BITBANGED_DOTCLOCK (Bitbanged MCK, usually)
1096:_options/writeColor.c ****  #define ROW_COMPLETION_DOTS \
1097:_options/writeColor.c **** 		(DE_ACTIVE_DOTS - ((WRITE_COLOR_DOT_DELAY+1) * COLORS_WRITTEN))
1098:_options/writeColor.c **** 
1099:_options/writeColor.c ****  #if (ROW_COMPLETION_DOTS > 0)
1100:_options/writeColor.c **** 		delay_Dots(ROW_COMPLETION_DOTS);
1101:_options/writeColor.c ****  #elif (ROW_COMPLETION_DOTS < 0)
1102:_options/writeColor.c ****   #warning "ROW_COMPLETION_DOTS < 0, so not used."
1103:_options/writeColor.c ****  #endif
1104:_options/writeColor.c **** #endif
1105:_options/writeColor.c **** 		//a/o v62: (Original notes removed)
1106:_options/writeColor.c **** 		//OCR1D controls RED... >=6 is full-red
1107:_options/writeColor.c **** 		// Setting this here indicates where the drawing has completed
1108:_options/writeColor.c **** 		// This is handy for determining timing, stretching, etc...
1109:_options/writeColor.c **** 		//OCR1D = 6; //0;
1110:_options/writeColor.c **** 		//fullRed();
1111:_options/writeColor.c **** 		// Now that we're using WHITE, use noRed instead
1112:_options/writeColor.c **** 		noRed();
 779               		.stabn	68,0,1112,.LM77-.LFBB8
 780               	.LM77:
 781 0230 1ABC      		out 0x2a,__zero_reg__
1113:_options/writeColor.c **** 
1114:_options/writeColor.c ****       //DE->Nada transition expects fullBlue...
1115:_options/writeColor.c ****       //Also helps to show the edge of the DE timing...
1116:_options/writeColor.c **** 
1117:_options/writeColor.c ****       //!!! Not sure what the state is at this point...
1118:_options/writeColor.c ****       // could be any DE+Blue level, or could be NADA...
1119:_options/writeColor.c ****       // Nada: DT1=3, still leaves one bit for clocking, might be OK
1120:_options/writeColor.c ****          
1121:_options/writeColor.c ****       //Among the things that don't make sense...
1122:_options/writeColor.c ****       // This appears to go into affect BEFORE delay_cyc (?)
1123:_options/writeColor.c ****       // as, without a pull-up resistor on the /OC1B output, 
1124:_options/writeColor.c ****       // green seems to be floating between the last pixel and the
1125:_options/writeColor.c ****       // delay_cyc (!)
1126:_options/writeColor.c ****       //Disable complementary-output for Green 
1127:_options/writeColor.c ****       //  (on /OC1B, where CLK is OC1B)
1128:_options/writeColor.c ****       // Since Nada, V, and H DT's might be bad for clocking.
1129:_options/writeColor.c **** //		TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
1130:_options/writeColor.c **** //         | (1<<COM1B1) | (0<<COM1B0)
1131:_options/writeColor.c **** //         | (1<<PWM1A) | (1<<PWM1B) );
1132:_options/writeColor.c **** 
1133:_options/writeColor.c **** 		lvds_disableGreen_MakeClockInsensitiveToDT();
 782               		.stabn	68,0,1133,.LM78-.LFBB8
 783               	.LM78:
 784 0232 83E6      		ldi r24,lo8(99)
 785 0234 80BF      		out 0x30,r24
1134:_options/writeColor.c **** 
1135:_options/writeColor.c ****       //fullBlue();
1136:_options/writeColor.c ****       //Nada_fromDEonly();
1137:_options/writeColor.c **** 		Nada_init();
 786               		.stabn	68,0,1137,.LM79-.LFBB8
 787               	.LM79:
 788 0236 80E3      		ldi r24,lo8(48)
 789 0238 84BD      		out 0x24,r24
 790 023a 84E0      		ldi r24,lo8(4)
 791 023c 8DBD      		out 0x2d,r24
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 53


 792               	/* epilogue start */
1138:_options/writeColor.c **** }
 793               		.stabn	68,0,1138,.LM80-.LFBB8
 794               	.LM80:
 795 023e DF91      		pop r29
 796 0240 CF91      		pop r28
 797 0242 0895      		ret
 798               		.size	nonRSB_drawPix, .-nonRSB_drawPix
 799               		.stabs	"color:r(0,48)=*(4,2)",64,0,780,28
 800               		.stabn	192,0,0,.LFBB8-.LFBB8
 801               		.stabn	224,0,0,.Lscope8-.LFBB8
 802               	.Lscope8:
 803               		.stabs	"",36,0,0,.Lscope8-.LFBB8
 804               		.stabd	78,0,0
 805               		.stabs	"setSpriteSkyColorOverride:F(0,47)",36,0,122,setSpriteSkyColorOverride
 806               		.stabs	"sprite:P(16,3)",64,0,122,24
 807               	.global	setSpriteSkyColorOverride
 808               		.type	setSpriteSkyColorOverride, @function
 809               	setSpriteSkyColorOverride:
 810               		.stabd	46,0,0
 811               		.stabs	"icons/iconPacking.h",132,0,0,.Ltext13
 812               	.Ltext13:
   1:icons/iconPacking.h **** /* mehPL:
   2:icons/iconPacking.h ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:icons/iconPacking.h ****  *    I'm not too fond of long licenses at the top of the file.
   4:icons/iconPacking.h ****  *    Please see the bottom.
   5:icons/iconPacking.h ****  *    Enjoy!
   6:icons/iconPacking.h ****  */
   7:icons/iconPacking.h **** 
   8:icons/iconPacking.h **** 
   9:icons/iconPacking.h **** 
  10:icons/iconPacking.h **** 
  11:icons/iconPacking.h **** 
  12:icons/iconPacking.h **** 
  13:icons/iconPacking.h **** 
  14:icons/iconPacking.h **** 
  15:icons/iconPacking.h **** 
  16:icons/iconPacking.h **** 
  17:icons/iconPacking.h **** 
  18:icons/iconPacking.h **** // This file contains tools for packing an icon/sprite into the least
  19:icons/iconPacking.h **** // memory possible, while allowing the image-data itself to be somewhat
  20:icons/iconPacking.h **** // viewable in the sprites' header files.
  21:icons/iconPacking.h **** // Each sprite contains four color-indices (two bits per pixel)
  22:icons/iconPacking.h **** // These four color-indices are converted into actual displayable colors
  23:icons/iconPacking.h **** // via the sprite's color palette(s).
  24:icons/iconPacking.h **** // a/o v66: * The sprite's mask is completely unused, as I recall.
  25:icons/iconPacking.h **** //          * The color-indices were arbitrary until recently
  26:icons/iconPacking.h **** //            Now some attempt has been made to use certain indices for
  27:icons/iconPacking.h **** //            certain purposes (e.g. index=0 -> Sky)
  28:icons/iconPacking.h **** 
  29:icons/iconPacking.h **** #ifndef __ICONPACKING_H__
  30:icons/iconPacking.h **** #define __ICONPACKING_H__
  31:icons/iconPacking.h **** 
  32:icons/iconPacking.h **** #include "gPixelVal.h"
  33:icons/iconPacking.h **** //#include "spriteMotion.h" //Needed for motion_t, etc...
  34:icons/iconPacking.h **** 									// Also see below...
  35:icons/iconPacking.h **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 54


  36:icons/iconPacking.h **** 
  37:icons/iconPacking.h **** 
  38:icons/iconPacking.h **** typedef struct _BLAH_MOTION_
  39:icons/iconPacking.h **** {
  40:icons/iconPacking.h **** 	const uint8_t startPosition;
  41:icons/iconPacking.h **** 	const uint8_t *motion;
  42:icons/iconPacking.h **** } motion_t;
  43:icons/iconPacking.h **** 
  44:icons/iconPacking.h **** 
  45:icons/iconPacking.h **** //gPixelVal defines pixels as 0-47, (blue is either 0x00, 0x10, or 0x20,
  46:icons/iconPacking.h **** //NOT 0x30)
  47:icons/iconPacking.h **** //This should be changed somewhere TODO
  48:icons/iconPacking.h **** // Until then, if b==3, -> b==2
  49:icons/iconPacking.h **** #define rgb2(r,g,b) \
  50:icons/iconPacking.h **** 	      (r | (g<<2) | (((b==3)?2:b)<<4))
  51:icons/iconPacking.h **** 
  52:icons/iconPacking.h **** 
  53:icons/iconPacking.h **** //Actually, this probably won't work right...
  54:icons/iconPacking.h **** // because the rgb values aren't exact like that, right?
  55:icons/iconPacking.h **** // e.g. black = 0,0,0 but it shows as 0,0,60 ish...
  56:icons/iconPacking.h **** // then again, going in reverse like this might work fine...
  57:icons/iconPacking.h **** // due to rounding (seems OK with this color-scheme)
  58:icons/iconPacking.h **** // The idea wasn't so much to be able to input an 8-bit RGB value to get
  59:icons/iconPacking.h **** // a close match (would probably want rounding up for that, not that it'd
  60:icons/iconPacking.h **** // be even close)
  61:icons/iconPacking.h **** // but to be able to read color-values from GIMP when using the 
  62:icons/iconPacking.h **** //  LCDdirectLVDS color-palette... which isn't especially necessary since
  63:icons/iconPacking.h **** //  now the colors are named with 3-based colors.
  64:icons/iconPacking.h **** // (Except that it's somewhat difficult to determine which color is used
  65:icons/iconPacking.h **** //  when indexed... it kinda has to be chosen manually... in Gimp)
  66:icons/iconPacking.h **** // E.G. rgb8(141,157,255) is the sky-color, but not right AT ALL.
  67:icons/iconPacking.h **** //      (comes through as dark green?!)
  68:icons/iconPacking.h **** #define rgb8(r,g,b) \
  69:icons/iconPacking.h **** 	      rgb((((r)*3)/255), (((g)*3)/255), (((b)*3)/255))
  70:icons/iconPacking.h **** 
  71:icons/iconPacking.h **** 
  72:icons/iconPacking.h **** 
  73:icons/iconPacking.h **** 
  74:icons/iconPacking.h **** #define ICON_WIDTH	16
  75:icons/iconPacking.h **** #define ICON_HEIGHT	16
  76:icons/iconPacking.h **** #define ICON_PIXELS	((ICON_WIDTH)*(ICON_HEIGHT))
  77:icons/iconPacking.h **** 
  78:icons/iconPacking.h **** #define ICON_PACKED_BYTES	((ICON_PIXELS)/4)
  79:icons/iconPacking.h **** #define ICON_MASK_BYTES		((ICON_PIXELS)/8)
  80:icons/iconPacking.h **** 
  81:icons/iconPacking.h **** #define PACKED_BYTES_PER_ROW	(ICON_WIDTH/4)
  82:icons/iconPacking.h **** 
  83:icons/iconPacking.h **** #define PIXELS_PER_PACKAGE	4
  84:icons/iconPacking.h **** 
  85:icons/iconPacking.h **** #define PACKED_BITS_PER_PIXEL	(8/PIXELS_PER_PACKAGE)
  86:icons/iconPacking.h **** 
  87:icons/iconPacking.h **** typedef struct _BLAH_SPRITE_
  88:icons/iconPacking.h **** {
  89:icons/iconPacking.h **** 	//const uint8_t * p_image[ICON_PACKED_BYTES];
  90:icons/iconPacking.h **** 	const uint8_t (*p_image)[ICON_PACKED_BYTES];
  91:icons/iconPacking.h **** 	const uint8_t * p_mask;
  92:icons/iconPacking.h **** 	const uint8_t * p_palette;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 55


  93:icons/iconPacking.h **** 	const uint8_t numPalettes;
  94:icons/iconPacking.h **** 	const uint8_t totalCount;	//Number of qCounts and/or steps per cycle
  95:icons/iconPacking.h **** 	const uint8_t * p_hFlip;
  96:icons/iconPacking.h **** 	const __flash motion_t * p_motion;
  97:icons/iconPacking.h **** 	const uint8_t * p_layer;
  98:icons/iconPacking.h **** 	const __flash motion_t * p_camMotion;
  99:icons/iconPacking.h **** 	const uint8_t * p_paletteAdvance;
 100:icons/iconPacking.h **** 	const uint8_t numImages;
 101:icons/iconPacking.h **** }	sprite_t;
 102:icons/iconPacking.h **** 
 103:icons/iconPacking.h **** /*
 104:icons/iconPacking.h **** #define getGimpColorVal(sprite, row, col) \
 105:icons/iconPacking.h **** 		(((pgm_read_byte((uint8_t *)(&((sprite).p_image[ \
 106:icons/iconPacking.h **** 					(row)*PACKED_BYTES_PER_ROW + (col)/PIXELS_PER_PACKAGE])))\
 107:icons/iconPacking.h **** 		  )>>((col)%PIXELS_PER_PACKAGE)*(PACKED_BITS_PER_PIXEL))&0x03)
 108:icons/iconPacking.h **** */
 109:icons/iconPacking.h **** 
 110:icons/iconPacking.h **** /*
 111:icons/iconPacking.h **** #define getGimpColorVal(sprite, palette, row, col) \
 112:icons/iconPacking.h **** 	pgm_read_byte((uint8_t *)(&((sprite).p_palette[ (palette)*4 + \
 113:icons/iconPacking.h **** 		(((pgm_read_byte((uint8_t *)(&((sprite).p_image[ \
 114:icons/iconPacking.h **** 					(row)*PACKED_BYTES_PER_ROW + (col)/PIXELS_PER_PACKAGE])))\
 115:icons/iconPacking.h **** 		  )>>((col)%PIXELS_PER_PACKAGE)*(PACKED_BITS_PER_PIXEL))&0x03) ])))
 116:icons/iconPacking.h **** */
 117:icons/iconPacking.h **** 
 118:icons/iconPacking.h **** 
 119:icons/iconPacking.h **** const __flash sprite_t *skyOverrideSprite = NULL;
 120:icons/iconPacking.h **** //uint8_t skyOverridePalette;
 121:icons/iconPacking.h **** 
 122:icons/iconPacking.h **** void setSpriteSkyColorOverride(const __flash sprite_t *sprite) //, uint8_t palette)
 123:icons/iconPacking.h **** {
 813               		.stabn	68,0,123,.LM81-.LFBB9
 814               	.LM81:
 815               	.LFBB9:
 816               	/* prologue: function */
 817               	/* frame size = 0 */
 818               	/* stack size = 0 */
 819               	.L__stack_usage = 0
 124:icons/iconPacking.h **** 	skyOverrideSprite = sprite;
 820               		.stabn	68,0,124,.LM82-.LFBB9
 821               	.LM82:
 822 0244 9093 0000 		sts skyOverrideSprite+1,r25
 823 0248 8093 0000 		sts skyOverrideSprite,r24
 824 024c 0895      		ret
 825               		.size	setSpriteSkyColorOverride, .-setSpriteSkyColorOverride
 826               	.Lscope9:
 827               		.stabs	"",36,0,0,.Lscope9-.LFBB9
 828               		.stabd	78,0,0
 829               		.stabs	"getRawPixelVal:F(4,2)",36,0,129,getRawPixelVal
 830               		.stabs	"sprite:P(16,3)",64,0,129,24
 831               		.stabs	"row:P(4,2)",64,0,129,22
 832               		.stabs	"col:P(4,2)",64,0,130,20
 833               		.stabs	"imageNum:P(4,2)",64,0,130,18
 834               	.global	getRawPixelVal
 835               		.type	getRawPixelVal, @function
 836               	getRawPixelVal:
 837               		.stabd	46,0,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 56


 125:icons/iconPacking.h **** //	skyOverridePalette = palette;
 126:icons/iconPacking.h **** }
 127:icons/iconPacking.h **** 
 128:icons/iconPacking.h **** 
 129:icons/iconPacking.h **** uint8_t getRawPixelVal(const __flash sprite_t *sprite, uint8_t row, 
 130:icons/iconPacking.h **** 														uint8_t col, uint8_t imageNum)
 131:icons/iconPacking.h **** {
 838               		.stabn	68,0,131,.LM83-.LFBB10
 839               	.LM83:
 840               	.LFBB10:
 841               	/* prologue: function */
 842               	/* frame size = 0 */
 843               	/* stack size = 0 */
 844               	.L__stack_usage = 0
 845               	.LBB86:
 132:icons/iconPacking.h **** 
 133:icons/iconPacking.h **** 	return
 134:icons/iconPacking.h **** 		(((pgm_read_byte((uint8_t *)(&(sprite->p_image[imageNum][ \
 846               		.stabn	68,0,134,.LM84-.LFBB10
 847               	.LM84:
 848 024e 30E0      		ldi r19,0
 849 0250 56E0      		ldi r21,6
 850               		1:
 851 0252 220F      		lsl r18
 852 0254 331F      		rol r19
 853 0256 5A95      		dec r21
 854 0258 01F4      		brne 1b
 855 025a FC01      		movw r30,r24
 856 025c A591      		lpm r26,Z+
 857 025e B591      		lpm r27,Z+
 858 0260 A20F      		add r26,r18
 859 0262 B31F      		adc r27,r19
 860 0264 70E0      		ldi r23,0
 861 0266 660F      		lsl r22
 862 0268 771F      		rol r23
 863 026a 660F      		lsl r22
 864 026c 771F      		rol r23
 865 026e 842F      		mov r24,r20
 866 0270 8695      		lsr r24
 867 0272 8695      		lsr r24
 868 0274 680F      		add r22,r24
 869 0276 711D      		adc r23,__zero_reg__
 870 0278 A60F      		add r26,r22
 871 027a B71F      		adc r27,r23
 872 027c FD01      		movw r30,r26
 873               	/* #APP */
 874               	 ;  134 "icons/iconPacking.h" 1
 875 027e 8491      		lpm r24, Z
 876               		
 877               	 ;  0 "" 2
 878               	/* #NOAPP */
 879               	.LBE86:
 135:icons/iconPacking.h **** 					(row)*PACKED_BYTES_PER_ROW + (col)/PIXELS_PER_PACKAGE])))\
 136:icons/iconPacking.h **** 		  )>>((col)%PIXELS_PER_PACKAGE)*(PACKED_BITS_PER_PIXEL))&0x03);
 880               		.stabn	68,0,136,.LM85-.LFBB10
 881               	.LM85:
 882 0280 90E0      		ldi r25,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 57


 883 0282 4370      		andi r20,lo8(3)
 884 0284 440F      		lsl r20
 885 0286 00C0      		rjmp 2f
 886               		1:
 887 0288 9595      		asr r25
 888 028a 8795      		ror r24
 889               		2:
 890 028c 4A95      		dec r20
 891 028e 02F4      		brpl 1b
 137:icons/iconPacking.h **** }
 892               		.stabn	68,0,137,.LM86-.LFBB10
 893               	.LM86:
 894 0290 8370      		andi r24,lo8(3)
 895 0292 0895      		ret
 896               		.size	getRawPixelVal, .-getRawPixelVal
 897               	.Lscope10:
 898               		.stabs	"",36,0,0,.Lscope10-.LFBB10
 899               		.stabd	78,0,0
 900               		.stabs	"rawPixValToGimpColorVal:F(4,2)",36,0,140,rawPixValToGimpColorVal
 901               		.stabs	"rawPixelVal:P(4,2)",64,0,140,24
 902               		.stabs	"sprite:P(16,3)",64,0,140,22
 903               		.stabs	"palette:P(4,2)",64,0,141,20
 904               	.global	rawPixValToGimpColorVal
 905               		.type	rawPixValToGimpColorVal, @function
 906               	rawPixValToGimpColorVal:
 907               		.stabd	46,0,0
 138:icons/iconPacking.h **** 
 139:icons/iconPacking.h **** 
 140:icons/iconPacking.h **** uint8_t rawPixValToGimpColorVal(uint8_t rawPixelVal, const __flash sprite_t *sprite, 
 141:icons/iconPacking.h **** 																			uint8_t palette)
 142:icons/iconPacking.h **** {
 908               		.stabn	68,0,142,.LM87-.LFBB11
 909               	.LM87:
 910               	.LFBB11:
 911               	/* prologue: function */
 912               	/* frame size = 0 */
 913               	/* stack size = 0 */
 914               	.L__stack_usage = 0
 915               	.LBB87:
 143:icons/iconPacking.h **** 	return 
 144:icons/iconPacking.h **** 	pgm_read_byte(
 916               		.stabn	68,0,144,.LM88-.LFBB11
 917               	.LM88:
 918 0294 6C5F      		subi r22,-4
 919 0296 7F4F      		sbci r23,-1
 920 0298 50E0      		ldi r21,0
 921 029a 440F      		lsl r20
 922 029c 551F      		rol r21
 923 029e 440F      		lsl r20
 924 02a0 551F      		rol r21
 925 02a2 480F      		add r20,r24
 926 02a4 511D      		adc r21,__zero_reg__
 927 02a6 FB01      		movw r30,r22
 928 02a8 8591      		lpm r24,Z+
 929 02aa 9591      		lpm r25,Z+
 930 02ac 840F      		add r24,r20
 931 02ae 951F      		adc r25,r21
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 58


 932 02b0 FC01      		movw r30,r24
 933               	/* #APP */
 934               	 ;  144 "icons/iconPacking.h" 1
 935 02b2 8491      		lpm r24, Z
 936               		
 937               	 ;  0 "" 2
 938               	/* #NOAPP */
 939               	.LBE87:
 145:icons/iconPacking.h **** 			(uint8_t *)(&(sprite->p_palette[ (palette)*4 + rawPixelVal ])));
 146:icons/iconPacking.h **** }
 940               		.stabn	68,0,146,.LM89-.LFBB11
 941               	.LM89:
 942 02b4 0895      		ret
 943               		.size	rawPixValToGimpColorVal, .-rawPixValToGimpColorVal
 944               	.Lscope11:
 945               		.stabs	"",36,0,0,.Lscope11-.LFBB11
 946               		.stabd	78,0,0
 947               		.stabs	"fbQ_repositionSprite:F(4,2)",36,0,32,fbQ_repositionSprite
 948               		.stabs	"state:P(0,49)=*(16,5)",64,0,32,26
 949               	.global	fbQ_repositionSprite
 950               		.type	fbQ_repositionSprite, @function
 951               	fbQ_repositionSprite:
 952               		.stabd	46,0,0
 953               		.stabs	"icons/spriteMotion.c",132,0,0,.Ltext14
 954               	.Ltext14:
   1:icons/spriteMotion.c **** /* mehPL:
   2:icons/spriteMotion.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:icons/spriteMotion.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:icons/spriteMotion.c ****  *    Please see the bottom.
   5:icons/spriteMotion.c ****  *    Enjoy!
   6:icons/spriteMotion.c ****  */
   7:icons/spriteMotion.c **** 
   8:icons/spriteMotion.c **** 
   9:icons/spriteMotion.c **** 
  10:icons/spriteMotion.c **** 
  11:icons/spriteMotion.c **** 
  12:icons/spriteMotion.c **** 
  13:icons/spriteMotion.c **** #ifndef __SPRITE_MOTION_C__
  14:icons/spriteMotion.c **** #define __SPRITE_MOTION_C__
  15:icons/spriteMotion.c **** 
  16:icons/spriteMotion.c **** //#include "../fb_question.h"
  17:icons/spriteMotion.c **** #include "spriteMotion.h"
  18:icons/spriteMotion.c **** 
  19:icons/spriteMotion.c **** #include "FlowerPowerV.h"	//Needed for flower-specific handling
  20:icons/spriteMotion.c **** 
  21:icons/spriteMotion.c **** 
  22:icons/spriteMotion.c **** //This is in ../fb_question.c
  23:icons/spriteMotion.c **** //It should probably be moved.
  24:icons/spriteMotion.c **** uint8_t getSpritePalette(const __flash sprite_t *p_thisSprite, uint8_t spritePhase,
  25:icons/spriteMotion.c **** 		                                                 uint8_t spriteRow);
  26:icons/spriteMotion.c **** 
  27:icons/spriteMotion.c **** 
  28:icons/spriteMotion.c **** //This can also be used for repositioning the camera...
  29:icons/spriteMotion.c **** //THIS ASSUMES it's only called ONCE per count...
  30:icons/spriteMotion.c **** //Currently returns TRUE if a change has been detected
  31:icons/spriteMotion.c **** // (FOR REFRESH_ON_CHANGE)
  32:icons/spriteMotion.c **** uint8_t fbQ_repositionSprite(spriteState_t *state)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 59


  33:icons/spriteMotion.c **** {
 955               		.stabn	68,0,33,.LM90-.LFBB12
 956               	.LM90:
 957               	.LFBB12:
 958 02b6 FF92      		push r15
 959 02b8 0F93      		push r16
 960 02ba 1F93      		push r17
 961 02bc CF93      		push r28
 962 02be DF93      		push r29
 963               	/* prologue: function */
 964               	/* frame size = 0 */
 965               	/* stack size = 5 */
 966               	.L__stack_usage = 5
 967 02c0 DC01      		movw r26,r24
 968               	.LBB88:
  34:icons/spriteMotion.c **** 	//This isn't particularly-well-implemented
  35:icons/spriteMotion.c **** 	// (for REFRESH_ON_CHANGE)
  36:icons/spriteMotion.c **** 	// since, e.g., the camera could move along with the sprite...
  37:icons/spriteMotion.c **** 	uint8_t changeDetected = FALSE;
  38:icons/spriteMotion.c ****    uint8_t axis;
  39:icons/spriteMotion.c **** 
  40:icons/spriteMotion.c ****    for(axis=0; axis<=1; axis++)
  41:icons/spriteMotion.c ****    {
  42:icons/spriteMotion.c ****   
  43:icons/spriteMotion.c **** 	  /* Now handled in initSpriteStates (in fb_question.c)	
  44:icons/spriteMotion.c ****    if(state->count == 0)
  45:icons/spriteMotion.c ****    {
  46:icons/spriteMotion.c ****       //Need to have a starting-point...
  47:icons/spriteMotion.c ****       // Note that origin is lower-left, but nextSpritePosition is
  48:icons/spriteMotion.c ****       // upper-left... (change that, instead?)
  49:icons/spriteMotion.c ****       int8_t startPos = state->motion[axis].startPosition;
  50:icons/spriteMotion.c ****       
  51:icons/spriteMotion.c ****       if(axis == 0)
  52:icons/spriteMotion.c ****          startPos *= -1;
  53:icons/spriteMotion.c **** 
  54:icons/spriteMotion.c ****       state->position[axis] = startPos;
  55:icons/spriteMotion.c ****       state->dir[axis] = 1;
  56:icons/spriteMotion.c ****    }
  57:icons/spriteMotion.c **** 	*/
  58:icons/spriteMotion.c **** 
  59:icons/spriteMotion.c ****    int8_t motion = GET_MOTION(state->motion[axis].motion, state->count);
 969               		.stabn	68,0,59,.LM91-.LFBB12
 970               	.LM91:
 971 02c2 1996      		adiw r26,9
 972 02c4 0D91      		ld r16,X+
 973 02c6 1C91      		ld r17,X
 974 02c8 1A97      		sbiw r26,9+1
 975 02ca EC01      		movw r28,r24
 976 02cc 20E0      		ldi r18,0
 977 02ce 30E0      		ldi r19,0
 978               	.LBE88:
  37:icons/spriteMotion.c ****    uint8_t axis;
 979               		.stabn	68,0,37,.LM92-.LFBB12
 980               	.LM92:
 981 02d0 F12C      		mov r15,__zero_reg__
 982               	.L27:
 983 02d2 C901      		movw r24,r18
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 60


 984 02d4 63E0      		ldi r22,lo8(3)
 985 02d6 70E0      		ldi r23,0
 986 02d8 00D0      		rcall __mulhi3
 987 02da F801      		movw r30,r16
 988 02dc E80F      		add r30,r24
 989 02de F91F      		adc r31,r25
 990 02e0 3196      		adiw r30,1
 991               	.LBB90:
 992               		.stabn	68,0,59,.LM93-.LFBB12
 993               	.LM93:
 994 02e2 0590      		lpm r0,Z+
 995 02e4 F491      		lpm r31,Z
 996 02e6 E02D      		mov r30,r0
 997 02e8 AD01      		movw r20,r26
 998 02ea 420F      		add r20,r18
 999 02ec 531F      		adc r21,r19
 1000 02ee 3097      		sbiw r30,0
 1001 02f0 01F0      		breq .L30
 1002               	.LBB89:
 1003               		.stabn	68,0,59,.LM94-.LFBB12
 1004               	.LM94:
 1005 02f2 1496      		adiw r26,4
 1006 02f4 8C91      		ld r24,X
 1007 02f6 1497      		sbiw r26,4
 1008 02f8 982F      		mov r25,r24
 1009 02fa 9695      		lsr r25
 1010 02fc 9695      		lsr r25
 1011 02fe E90F      		add r30,r25
 1012 0300 F11D      		adc r31,__zero_reg__
 1013               	/* #APP */
 1014               	 ;  59 "icons/spriteMotion.c" 1
 1015 0302 E491      		lpm r30, Z
 1016               		
 1017               	 ;  0 "" 2
 1018               	/* #NOAPP */
 1019               	.LBE89:
 1020 0304 F0E0      		ldi r31,0
 1021 0306 8370      		andi r24,lo8(3)
 1022 0308 880F      		lsl r24
 1023 030a 00C0      		rjmp 2f
 1024               		1:
 1025 030c F595      		asr r31
 1026 030e E795      		ror r30
 1027               		2:
 1028 0310 8A95      		dec r24
 1029 0312 02F4      		brpl 1b
 1030 0314 8E2F      		mov r24,r30
 1031 0316 8370      		andi r24,lo8(3)
  60:icons/spriteMotion.c ****    if(motion == DIR_TOGGLE)
 1032               		.stabn	68,0,60,.LM95-.LFBB12
 1033               	.LM95:
 1034 0318 8330      		cpi r24,lo8(3)
 1035 031a 01F4      		brne .L23
  61:icons/spriteMotion.c ****    {
  62:icons/spriteMotion.c ****       state->dir[axis] = -state->dir[axis];
 1036               		.stabn	68,0,62,.LM96-.LFBB12
 1037               	.LM96:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 61


 1038 031c FA01      		movw r30,r20
 1039 031e 8281      		ldd r24,Z+2
 1040 0320 8195      		neg r24
 1041 0322 8283      		std Z+2,r24
 1042               	.L30:
  59:icons/spriteMotion.c ****    if(motion == DIR_TOGGLE)
 1043               		.stabn	68,0,59,.LM97-.LFBB12
 1044               	.LM97:
 1045 0324 80E0      		ldi r24,0
 1046               	.L23:
  63:icons/spriteMotion.c ****       motion = 0;
  64:icons/spriteMotion.c ****    }
  65:icons/spriteMotion.c **** 
  66:icons/spriteMotion.c ****    motion *= state->dir[axis];
 1047               		.stabn	68,0,66,.LM98-.LFBB12
 1048               	.LM98:
 1049 0326 FA01      		movw r30,r20
 1050 0328 6281      		ldd r22,Z+2
 1051 032a 00D0      		rcall __mulqi3
  67:icons/spriteMotion.c **** 
  68:icons/spriteMotion.c ****    //Considering having LeafX be more like acceleration...?
  69:icons/spriteMotion.c ****    // e.g. motion: 1, 0, 0, DIR_TOGGLE -> motionX = 1 1 1 0(-)
  70:icons/spriteMotion.c ****    //(-= because we want +1 to shift right)
  71:icons/spriteMotion.c ****    if(axis == 0)
 1052               		.stabn	68,0,71,.LM99-.LFBB12
 1053               	.LM99:
 1054 032c 2111      		cpse r18,__zero_reg__
 1055 032e 00C0      		rjmp .L24
  72:icons/spriteMotion.c ****       motion *= (-1);
 1056               		.stabn	68,0,72,.LM100-.LFBB12
 1057               	.LM100:
 1058 0330 8195      		neg r24
 1059               	.L24:
  73:icons/spriteMotion.c **** 
  74:icons/spriteMotion.c ****    state->position[axis] += motion;
 1060               		.stabn	68,0,74,.LM101-.LFBB12
 1061               	.LM101:
 1062 0332 9881      		ld r25,Y
 1063 0334 980F      		add r25,r24
 1064 0336 9993      		st Y+,r25
  75:icons/spriteMotion.c **** 
  76:icons/spriteMotion.c **** 	if(motion)
 1065               		.stabn	68,0,76,.LM102-.LFBB12
 1066               	.LM102:
 1067 0338 8823      		tst r24
 1068 033a 01F0      		breq .L25
  77:icons/spriteMotion.c **** 		changeDetected = TRUE;
 1069               		.stabn	68,0,77,.LM103-.LFBB12
 1070               	.LM103:
 1071 033c FF24      		clr r15
 1072 033e F394      		inc r15
 1073               	.L25:
 1074 0340 2F5F      		subi r18,-1
 1075 0342 3F4F      		sbci r19,-1
 1076               	.LBE90:
  40:icons/spriteMotion.c ****    {
 1077               		.stabn	68,0,40,.LM104-.LFBB12
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 62


 1078               	.LM104:
 1079 0344 2230      		cpi r18,2
 1080 0346 3105      		cpc r19,__zero_reg__
 1081 0348 01F4      		brne .L27
  78:icons/spriteMotion.c ****    }
  79:icons/spriteMotion.c **** 
  80:icons/spriteMotion.c **** 	//e.g. the camera...
  81:icons/spriteMotion.c **** 	if(state->sprite != NULL)
 1082               		.stabn	68,0,81,.LM105-.LFBB12
 1083               	.LM105:
 1084 034a 1B96      		adiw r26,11
 1085 034c 2D91      		ld r18,X+
 1086 034e 3C91      		ld r19,X
 1087 0350 1C97      		sbiw r26,11+1
 1088 0352 2115      		cp r18,__zero_reg__
 1089 0354 3105      		cpc r19,__zero_reg__
 1090 0356 01F0      		breq .L28
 1091               	.LBB91:
  82:icons/spriteMotion.c **** 	{
  83:icons/spriteMotion.c **** 		uint8_t oldPaletteNum = state->paletteNum;
 1092               		.stabn	68,0,83,.LM106-.LFBB12
 1093               	.LM106:
 1094 0358 1D96      		adiw r26,13
 1095 035a 4C91      		ld r20,X
 1096 035c 1D97      		sbiw r26,13
  84:icons/spriteMotion.c **** 
  85:icons/spriteMotion.c **** 		uint8_t paletteAdvance = 
  86:icons/spriteMotion.c **** 		  GET_PALETTE_ADVANCE(state->sprite->p_paletteAdvance, state->count);
 1097               		.stabn	68,0,86,.LM107-.LFBB12
 1098               	.LM107:
 1099 035e F901      		movw r30,r18
 1100 0360 7096      		adiw r30,16
 1101 0362 0590      		lpm r0,Z+
 1102 0364 F491      		lpm r31,Z
 1103 0366 E02D      		mov r30,r0
  85:icons/spriteMotion.c **** 		  GET_PALETTE_ADVANCE(state->sprite->p_paletteAdvance, state->count);
 1104               		.stabn	68,0,85,.LM108-.LFBB12
 1105               	.LM108:
 1106 0368 3097      		sbiw r30,0
 1107 036a 01F0      		breq .L32
 1108               	.LBB92:
 1109               		.stabn	68,0,86,.LM109-.LFBB12
 1110               	.LM109:
 1111 036c 1496      		adiw r26,4
 1112 036e 8C91      		ld r24,X
 1113 0370 1497      		sbiw r26,4
 1114 0372 982F      		mov r25,r24
 1115 0374 9695      		lsr r25
 1116 0376 9695      		lsr r25
 1117 0378 9695      		lsr r25
 1118 037a E90F      		add r30,r25
 1119 037c F11D      		adc r31,__zero_reg__
 1120               	/* #APP */
 1121               	 ;  86 "icons/spriteMotion.c" 1
 1122 037e E491      		lpm r30, Z
 1123               		
 1124               	 ;  0 "" 2
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 63


 1125               	/* #NOAPP */
 1126               	.LBE92:
 1127 0380 F0E0      		ldi r31,0
 1128 0382 8770      		andi r24,lo8(7)
 1129 0384 00C0      		rjmp 2f
 1130               		1:
 1131 0386 F595      		asr r31
 1132 0388 E795      		ror r30
 1133               		2:
 1134 038a 8A95      		dec r24
 1135 038c 02F4      		brpl 1b
  85:icons/spriteMotion.c **** 		  GET_PALETTE_ADVANCE(state->sprite->p_paletteAdvance, state->count);
 1136               		.stabn	68,0,85,.LM110-.LFBB12
 1137               	.LM110:
 1138 038e E170      		andi r30,lo8(1)
 1139 0390 00C0      		rjmp .L29
 1140               	.L32:
 1141 0392 E0E0      		ldi r30,0
 1142               	.L29:
  87:icons/spriteMotion.c **** 
  88:icons/spriteMotion.c **** 		state->paletteNum += paletteAdvance;
 1143               		.stabn	68,0,88,.LM111-.LFBB12
 1144               	.LM111:
 1145 0394 8E2F      		mov r24,r30
 1146 0396 840F      		add r24,r20
 1147 0398 1D96      		adiw r26,13
 1148 039a 8C93      		st X,r24
 1149 039c 1D97      		sbiw r26,13
  89:icons/spriteMotion.c **** 		state->paletteNum %= state->sprite->numPalettes;
 1150               		.stabn	68,0,89,.LM112-.LFBB12
 1151               	.LM112:
 1152 039e F901      		movw r30,r18
 1153 03a0 3696      		adiw r30,6
 1154 03a2 6491      		lpm r22,Z
 1155 03a4 00D0      		rcall __udivmodqi4
 1156 03a6 1D96      		adiw r26,13
 1157 03a8 9C93      		st X,r25
  90:icons/spriteMotion.c **** 
  91:icons/spriteMotion.c **** 		if(state->paletteNum != oldPaletteNum)
 1158               		.stabn	68,0,91,.LM113-.LFBB12
 1159               	.LM113:
 1160 03aa 9417      		cp r25,r20
 1161 03ac 01F0      		breq .L28
  92:icons/spriteMotion.c **** 			changeDetected = TRUE;
 1162               		.stabn	68,0,92,.LM114-.LFBB12
 1163               	.LM114:
 1164 03ae FF24      		clr r15
 1165 03b0 F394      		inc r15
 1166               	.L28:
 1167               	.LBE91:
  93:icons/spriteMotion.c **** 	}
  94:icons/spriteMotion.c **** 
  95:icons/spriteMotion.c **** 	return changeDetected;
  96:icons/spriteMotion.c **** }
 1168               		.stabn	68,0,96,.LM115-.LFBB12
 1169               	.LM115:
 1170 03b2 8F2D      		mov r24,r15
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 64


 1171               	/* epilogue start */
 1172 03b4 DF91      		pop r29
 1173 03b6 CF91      		pop r28
 1174 03b8 1F91      		pop r17
 1175 03ba 0F91      		pop r16
 1176 03bc FF90      		pop r15
 1177 03be 0895      		ret
 1178               		.size	fbQ_repositionSprite, .-fbQ_repositionSprite
 1179               		.stabs	"changeDetected:r(4,2)",64,0,37,15
 1180               		.stabn	192,0,0,.LFBB12-.LFBB12
 1181               		.stabs	"oldPaletteNum:r(4,2)",64,0,83,20
 1182               		.stabs	"paletteAdvance:r(4,2)",64,0,85,30
 1183               		.stabn	192,0,0,.LBB91-.LFBB12
 1184               		.stabn	224,0,0,.LBE91-.LFBB12
 1185               		.stabn	224,0,0,.Lscope12-.LFBB12
 1186               	.Lscope12:
 1187               		.stabs	"",36,0,0,.Lscope12-.LFBB12
 1188               		.stabd	78,0,0
 1189               		.stabs	"fbQ_overlaySprite:F(4,2)",36,0,105,fbQ_overlaySprite
 1190               		.stabs	"p_theSprite:p(16,3)",160,0,105,4
 1191               		.stabs	"state:P(0,49)",64,0,105,20
 1192               	.global	fbQ_overlaySprite
 1193               		.type	fbQ_overlaySprite, @function
 1194               	fbQ_overlaySprite:
 1195               		.stabd	46,0,0
  97:icons/spriteMotion.c **** 
  98:icons/spriteMotion.c **** 
  99:icons/spriteMotion.c **** 
 100:icons/spriteMotion.c **** 
 101:icons/spriteMotion.c **** //Draws a sprite on top of whatever's already there, at the position
 102:icons/spriteMotion.c **** //determined by its motionStuff... (repositionSprite() needs to be called
 103:icons/spriteMotion.c **** //prior)
 104:icons/spriteMotion.c **** //Eventually will return the rowNum for REFRESH_ON_CHANGE, etc...
 105:icons/spriteMotion.c **** uint8_t fbQ_overlaySprite(const __flash sprite_t *p_theSprite, spriteState_t *state)     
 106:icons/spriteMotion.c **** 																//int8_t *spritePosition)
 107:icons/spriteMotion.c **** {
 1196               		.stabn	68,0,107,.LM116-.LFBB13
 1197               	.LM116:
 1198               	.LFBB13:
 1199 03c0 2F92      		push r2
 1200 03c2 3F92      		push r3
 1201 03c4 4F92      		push r4
 1202 03c6 5F92      		push r5
 1203 03c8 6F92      		push r6
 1204 03ca 7F92      		push r7
 1205 03cc 8F92      		push r8
 1206 03ce 9F92      		push r9
 1207 03d0 AF92      		push r10
 1208 03d2 BF92      		push r11
 1209 03d4 CF92      		push r12
 1210 03d6 DF92      		push r13
 1211 03d8 EF92      		push r14
 1212 03da FF92      		push r15
 1213 03dc 0F93      		push r16
 1214 03de 1F93      		push r17
 1215 03e0 CF93      		push r28
 1216 03e2 DF93      		push r29
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 65


 1217 03e4 00D0      		rcall .
 1218 03e6 00D0      		rcall .
 1219 03e8 1F92      		push __zero_reg__
 1220 03ea CDB7      		in r28,__SP_L__
 1221 03ec DEB7      		in r29,__SP_H__
 1222               	/* prologue: function */
 1223               	/* frame size = 5 */
 1224               	/* stack size = 23 */
 1225               	.L__stack_usage = 23
 1226 03ee 9D83      		std Y+5,r25
 1227 03f0 8C83      		std Y+4,r24
 1228 03f2 AB01      		movw r20,r22
 1229 03f4 4296      		adiw r24,18
 1230 03f6 7C01      		movw r14,r24
 108:icons/spriteMotion.c ****    //uint8_t imageChangedTillRow=0;
 109:icons/spriteMotion.c **** 	// doesn't really work any longer, since overlays happen multiplely
 110:icons/spriteMotion.c ****    uint8_t changeOccurred = FALSE;
 111:icons/spriteMotion.c **** 
 112:icons/spriteMotion.c ****    //It's too confusing with the camera having its own position, so e.g.
 113:icons/spriteMotion.c ****    //camCol=0, if it were used here, would NOT BE THE SAME as the column in
 114:icons/spriteMotion.c ****    //the "image" in which the camera's first column resides...
 115:icons/spriteMotion.c ****    // frameCol, instead, is the actual frame drawn...
 116:icons/spriteMotion.c ****    //int8_t camRow, camCol;
 117:icons/spriteMotion.c ****    int8_t frameRow, frameCol;
 118:icons/spriteMotion.c **** 
 119:icons/spriteMotion.c ****    //I can't recall how this used to work...
 120:icons/spriteMotion.c **** //   uint8_t paletteForColor = getSpritePalette(p_theSprite, 0, 0);
 121:icons/spriteMotion.c **** 	uint8_t paletteForColor = 0;
 122:icons/spriteMotion.c **** 
 123:icons/spriteMotion.c **** 	int8_t position[2] = {0,0};
 124:icons/spriteMotion.c **** 	uint8_t * p_hFlip = NULL;
 125:icons/spriteMotion.c **** 	uint8_t count = 0;
 126:icons/spriteMotion.c **** 	uint8_t spriteImageNum = 0;
 127:icons/spriteMotion.c **** 
 128:icons/spriteMotion.c **** 	//An unchanging sprite, e.g. SOLID in the background of a Reward...
 129:icons/spriteMotion.c **** 	// (when NULL)
 130:icons/spriteMotion.c **** 	if (state != NULL)
 1231               		.stabn	68,0,130,.LM117-.LFBB13
 1232               	.LM117:
 1233 03f8 6115      		cp r22,__zero_reg__
 1234 03fa 7105      		cpc r23,__zero_reg__
 1235 03fc 01F4      		brne .+2
 1236 03fe 00C0      		rjmp .L56
 131:icons/spriteMotion.c **** 	{
 132:icons/spriteMotion.c **** 		position[0] = state->position[0];
 1237               		.stabn	68,0,132,.LM118-.LFBB13
 1238               	.LM118:
 1239 0400 DB01      		movw r26,r22
 1240 0402 3C90      		ld r3,X
 133:icons/spriteMotion.c **** 		position[1] = state->position[1];
 1241               		.stabn	68,0,133,.LM119-.LFBB13
 1242               	.LM119:
 1243 0404 1196      		adiw r26,1
 1244 0406 BC91      		ld r27,X
 1245 0408 B983      		std Y+1,r27
 134:icons/spriteMotion.c **** 		//hFlip = state->sprite->p_hFlip;	//6404
 135:icons/spriteMotion.c **** 		p_hFlip = state->hFlip;					//6382
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 66


 1246               		.stabn	68,0,135,.LM120-.LFBB13
 1247               	.LM120:
 1248 040a FB01      		movw r30,r22
 1249 040c 0781      		ldd r16,Z+7
 1250 040e 1085      		ldd r17,Z+8
 136:icons/spriteMotion.c **** 		count = state->count;
 1251               		.stabn	68,0,136,.LM121-.LFBB13
 1252               	.LM121:
 1253 0410 A480      		ldd r10,Z+4
 137:icons/spriteMotion.c **** 		paletteForColor = state->paletteNum;
 1254               		.stabn	68,0,137,.LM122-.LFBB13
 1255               	.LM122:
 1256 0412 4584      		ldd r4,Z+13
 138:icons/spriteMotion.c **** 		
 139:icons/spriteMotion.c **** 		//If this sprite is recently-selected... make sure it's drawn
 140:icons/spriteMotion.c **** 		// (a/o QUESTION3 which currently has a totalCount of 1)
 141:icons/spriteMotion.c **** 		if(count == 0)
 1257               		.stabn	68,0,141,.LM123-.LFBB13
 1258               	.LM123:
 1259 0414 31E0      		ldi r19,lo8(1)
 1260 0416 A110      		cpse r10,__zero_reg__
 1261 0418 30E0      		ldi r19,0
 1262               	.L39:
 142:icons/spriteMotion.c **** 			changeOccurred = TRUE;
 143:icons/spriteMotion.c **** 
 144:icons/spriteMotion.c **** 
 145:icons/spriteMotion.c **** 		spriteImageNum = (state->count)%(p_theSprite->numImages);
 1263               		.stabn	68,0,145,.LM124-.LFBB13
 1264               	.LM124:
 1265 041a F701      		movw r30,r14
 1266 041c 6491      		lpm r22,Z
 1267 041e 8A2D      		mov r24,r10
 1268 0420 00D0      		rcall __udivmodqi4
 1269 0422 592E      		mov r5,r25
 146:icons/spriteMotion.c **** //#if FALSE
 147:icons/spriteMotion.c **** #ifdef __QUESTION3_H__
 148:icons/spriteMotion.c **** 		if(p_theSprite == &spriteQUESTION3)
 1270               		.stabn	68,0,148,.LM125-.LFBB13
 1271               	.LM125:
 1272 0424 8C81      		ldd r24,Y+4
 1273 0426 9D81      		ldd r25,Y+5
 1274 0428 8050      		subi r24,lo8(spriteQUESTION3)
 1275 042a 9040      		sbci r25,hi8(spriteQUESTION3)
 1276 042c 01F4      		brne .L40
 149:icons/spriteMotion.c **** 		{
 150:icons/spriteMotion.c **** 			//upon first-call after prepNextSprite, count will be 0
 151:icons/spriteMotion.c **** 			// Draw the '?' first, then overlap it with the frame...
 152:icons/spriteMotion.c **** 			if((state->count)%2 == 0)
 1277               		.stabn	68,0,152,.LM126-.LFBB13
 1278               	.LM126:
 1279 042e A0FC      		sbrc r10,0
 1280 0430 00C0      		rjmp .L57
 153:icons/spriteMotion.c **** 			{
 154:icons/spriteMotion.c **** 				//This gets confusing
 155:icons/spriteMotion.c **** 				//We're using count to indicate which image to draw
 156:icons/spriteMotion.c **** 				// and using recursion (at the beginning) to do-so
 157:icons/spriteMotion.c **** 				// first-call will always be even
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 67


 158:icons/spriteMotion.c **** 				//				  will increment count to odd
 159:icons/spriteMotion.c **** 				//            will call overlaySprite() with odd
 160:icons/spriteMotion.c **** 				//                      ---> will draw bottom-sprite with odd
 161:icons/spriteMotion.c **** 				//            will continue with count odd (but UNTESTED AGAIN)
 162:icons/spriteMotion.c **** 				//	
 163:icons/spriteMotion.c **** 				state->count++;
 1281               		.stabn	68,0,163,.LM127-.LFBB13
 1282               	.LM127:
 1283 0432 81E0      		ldi r24,lo8(1)
 1284 0434 8A0D      		add r24,r10
 1285 0436 FA01      		movw r30,r20
 1286 0438 8483      		std Z+4,r24
 164:icons/spriteMotion.c **** 				if(fbQ_overlaySprite(p_theSprite, state))
 1287               		.stabn	68,0,164,.LM128-.LFBB13
 1288               	.LM128:
 1289 043a BA01      		movw r22,r20
 1290 043c 80E0      		ldi r24,lo8(spriteQUESTION3)
 1291 043e 90E0      		ldi r25,hi8(spriteQUESTION3)
 1292 0440 00D0      		rcall fbQ_overlaySprite
 165:icons/spriteMotion.c **** 					changeOccurred = TRUE;
 166:icons/spriteMotion.c **** 				//NOW (despite count, now, being odd) draw the top-sprite
 167:icons/spriteMotion.c **** 				// (FRAME)
 168:icons/spriteMotion.c **** 				spriteImageNum = 1;
 1293               		.stabn	68,0,168,.LM129-.LFBB13
 1294               	.LM129:
 1295 0442 5524      		clr r5
 1296 0444 5394      		inc r5
 1297 0446 00C0      		rjmp .L81
 1298               	.L57:
 169:icons/spriteMotion.c **** 				changeOccurred = TRUE;
 170:icons/spriteMotion.c **** 			}
 171:icons/spriteMotion.c **** 			else	//odd-count, so draw the bottom-sprite first ('?')
 172:icons/spriteMotion.c **** 			{
 173:icons/spriteMotion.c **** 				//state->count = 0;
 174:icons/spriteMotion.c **** 				//count = 0;
 175:icons/spriteMotion.c **** 				spriteImageNum = 0;
 1299               		.stabn	68,0,175,.LM130-.LFBB13
 1300               	.LM130:
 1301 0448 512C      		mov r5,__zero_reg__
 1302               	.L81:
 176:icons/spriteMotion.c **** 				changeOccurred = TRUE;
 1303               		.stabn	68,0,176,.LM131-.LFBB13
 1304               	.LM131:
 1305 044a 31E0      		ldi r19,lo8(1)
 1306               	.L40:
 177:icons/spriteMotion.c **** 			}
 178:icons/spriteMotion.c **** 
 179:icons/spriteMotion.c **** 		}
 180:icons/spriteMotion.c **** #endif
 181:icons/spriteMotion.c **** 	}
 182:icons/spriteMotion.c **** 
 183:icons/spriteMotion.c **** 	uint8_t thisHFlip = GET_FLIP(p_hFlip, count);
 1307               		.stabn	68,0,183,.LM132-.LFBB13
 1308               	.LM132:
 1309 044c 0115      		cp r16,__zero_reg__
 1310 044e 1105      		cpc r17,__zero_reg__
 1311 0450 01F0      		breq .L41
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 68


 1312               	.LBB93:
 1313               		.stabn	68,0,183,.LM133-.LFBB13
 1314               	.LM133:
 1315 0452 8A2D      		mov r24,r10
 1316 0454 8695      		lsr r24
 1317 0456 8695      		lsr r24
 1318 0458 8695      		lsr r24
 1319 045a F801      		movw r30,r16
 1320 045c E80F      		add r30,r24
 1321 045e F11D      		adc r31,__zero_reg__
 1322               	/* #APP */
 1323               	 ;  183 "icons/spriteMotion.c" 1
 1324 0460 E491      		lpm r30, Z
 1325               		
 1326               	 ;  0 "" 2
 1327               	/* #NOAPP */
 1328               	.LBE93:
 1329 0462 F0E0      		ldi r31,0
 1330 0464 8A2D      		mov r24,r10
 1331 0466 8770      		andi r24,lo8(7)
 1332 0468 00C0      		rjmp 2f
 1333               		1:
 1334 046a F595      		asr r31
 1335 046c E795      		ror r30
 1336               		2:
 1337 046e 8A95      		dec r24
 1338 0470 02F4      		brpl 1b
 1339 0472 2E2F      		mov r18,r30
 1340 0474 2170      		andi r18,lo8(1)
 1341 0476 722E      		mov r7,r18
 184:icons/spriteMotion.c **** 	if(count > 0)
 1342               		.stabn	68,0,184,.LM134-.LFBB13
 1343               	.LM134:
 1344 0478 AA20      		tst r10
 1345 047a 01F0      		breq .L38
 1346               	.LBB94:
 185:icons/spriteMotion.c **** 	{
 186:icons/spriteMotion.c **** 		//Check if the flip-state has changed...
 187:icons/spriteMotion.c **** 		if(GET_FLIP(p_hFlip, count-1) != thisHFlip)
 1347               		.stabn	68,0,187,.LM135-.LFBB13
 1348               	.LM135:
 1349 047c 8A2D      		mov r24,r10
 1350 047e 90E0      		ldi r25,0
 1351 0480 0197      		sbiw r24,1
 1352 0482 FC01      		movw r30,r24
 1353 0484 23E0      		ldi r18,3
 1354               		1:
 1355 0486 F595      		asr r31
 1356 0488 E795      		ror r30
 1357 048a 2A95      		dec r18
 1358 048c 01F4      		brne 1b
 1359 048e E00F      		add r30,r16
 1360 0490 F11F      		adc r31,r17
 1361               	/* #APP */
 1362               	 ;  187 "icons/spriteMotion.c" 1
 1363 0492 E491      		lpm r30, Z
 1364               		
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 69


 1365               	 ;  0 "" 2
 1366               	/* #NOAPP */
 1367               	.LBE94:
 1368 0494 F0E0      		ldi r31,0
 1369 0496 8770      		andi r24,7
 1370 0498 9927      		clr r25
 1371 049a 00C0      		rjmp 2f
 1372               		1:
 1373 049c F595      		asr r31
 1374 049e E795      		ror r30
 1375               		2:
 1376 04a0 8A95      		dec r24
 1377 04a2 02F4      		brpl 1b
 1378 04a4 E170      		andi r30,1
 1379 04a6 FF27      		clr r31
 1380 04a8 00C0      		rjmp .L55
 1381               	.L41:
 183:icons/spriteMotion.c **** 	if(count > 0)
 1382               		.stabn	68,0,183,.LM136-.LFBB13
 1383               	.LM136:
 1384 04aa 712C      		mov r7,__zero_reg__
 184:icons/spriteMotion.c **** 	if(count > 0)
 1385               		.stabn	68,0,184,.LM137-.LFBB13
 1386               	.LM137:
 1387 04ac AA20      		tst r10
 1388 04ae 01F0      		breq .L38
 1389               		.stabn	68,0,187,.LM138-.LFBB13
 1390               	.LM138:
 1391 04b0 E0E0      		ldi r30,0
 1392 04b2 F0E0      		ldi r31,0
 1393               	.L55:
 1394               		.stabn	68,0,187,.LM139-.LFBB13
 1395               	.LM139:
 1396 04b4 872D      		mov r24,r7
 1397 04b6 90E0      		ldi r25,0
 1398 04b8 E817      		cp r30,r24
 1399 04ba F907      		cpc r31,r25
 1400 04bc 01F0      		breq .L38
 188:icons/spriteMotion.c **** 			changeOccurred = TRUE;
 1401               		.stabn	68,0,188,.LM140-.LFBB13
 1402               	.LM140:
 1403 04be 31E0      		ldi r19,lo8(1)
 1404 04c0 00C0      		rjmp .L38
 1405               	.L56:
 123:icons/spriteMotion.c **** 	uint8_t * p_hFlip = NULL;
 1406               		.stabn	68,0,123,.LM141-.LFBB13
 1407               	.LM141:
 1408 04c2 1982      		std Y+1,__zero_reg__
 1409 04c4 312C      		mov r3,__zero_reg__
 126:icons/spriteMotion.c **** 
 1410               		.stabn	68,0,126,.LM142-.LFBB13
 1411               	.LM142:
 1412 04c6 512C      		mov r5,__zero_reg__
 121:icons/spriteMotion.c **** 
 1413               		.stabn	68,0,121,.LM143-.LFBB13
 1414               	.LM143:
 1415 04c8 412C      		mov r4,__zero_reg__
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 70


 125:icons/spriteMotion.c **** 	uint8_t spriteImageNum = 0;
 1416               		.stabn	68,0,125,.LM144-.LFBB13
 1417               	.LM144:
 1418 04ca A12C      		mov r10,__zero_reg__
 183:icons/spriteMotion.c **** 	if(count > 0)
 1419               		.stabn	68,0,183,.LM145-.LFBB13
 1420               	.LM145:
 1421 04cc 712C      		mov r7,__zero_reg__
 110:icons/spriteMotion.c **** 
 1422               		.stabn	68,0,110,.LM146-.LFBB13
 1423               	.LM146:
 1424 04ce 30E0      		ldi r19,0
 1425               	.L38:
 189:icons/spriteMotion.c **** 	}
 190:icons/spriteMotion.c **** 	else	//count 0, what to do...?
 191:icons/spriteMotion.c **** 	{
 192:icons/spriteMotion.c **** 		//Could always assume a change-occurred on count-0
 193:icons/spriteMotion.c **** 		// but what about solid + reward in background?
 194:icons/spriteMotion.c **** 		//Could compare to the last element in the hFlip array
 195:icons/spriteMotion.c **** 		// in case of cycling...
 196:icons/spriteMotion.c **** 		// (currently no sprites cycle hFlips)
 197:icons/spriteMotion.c **** 		//I guess I'll just leave it alone.
 198:icons/spriteMotion.c **** 	}
 199:icons/spriteMotion.c **** 
 200:icons/spriteMotion.c **** 	//Sprite always cycles through the images, one with each redraw...
 201:icons/spriteMotion.c **** 	if(p_theSprite->numImages > 1)
 1426               		.stabn	68,0,201,.LM147-.LFBB13
 1427               	.LM147:
 1428 04d0 F701      		movw r30,r14
 1429 04d2 8491      		lpm r24,Z
 1430 04d4 8230      		cpi r24,lo8(2)
 1431 04d6 00F0      		brlo .L42
 202:icons/spriteMotion.c **** 		changeOccurred = TRUE;
 1432               		.stabn	68,0,202,.LM148-.LFBB13
 1433               	.LM148:
 1434 04d8 31E0      		ldi r19,lo8(1)
 1435               	.L42:
 1436 04da B0E0      		ldi r27,lo8(frameBuffer)
 1437 04dc EB2E      		mov r14,r27
 1438 04de B0E0      		ldi r27,hi8(frameBuffer)
 1439 04e0 FB2E      		mov r15,r27
 203:icons/spriteMotion.c **** 
 204:icons/spriteMotion.c ****    for(frameRow = 0; frameRow<FB_HEIGHT; frameRow++)
 1440               		.stabn	68,0,204,.LM149-.LFBB13
 1441               	.LM149:
 1442 04e2 212C      		mov r2,__zero_reg__
 1443               	.LBB95:
 1444               	.LBB96:
 205:icons/spriteMotion.c ****    {
 206:icons/spriteMotion.c ****       int8_t spriteRow =
 207:icons/spriteMotion.c ****          (position[1] - cameraState.position[1]) + frameRow;
 208:icons/spriteMotion.c ****          
 209:icons/spriteMotion.c ****       //The sky's already been drawn...
 210:icons/spriteMotion.c ****       if((spriteRow >= FB_HEIGHT) || (spriteRow < 0))
 211:icons/spriteMotion.c ****          continue;
 212:icons/spriteMotion.c ****         
 213:icons/spriteMotion.c **** 	  	if(p_theSprite == &spriteFLOWER)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 71


 214:icons/spriteMotion.c **** 		{	
 215:icons/spriteMotion.c **** 			if(spriteRow >= 8)
 216:icons/spriteMotion.c **** 				paletteForColor = NUMPALETTES_FLOWER-1;
 217:icons/spriteMotion.c **** 		}
 218:icons/spriteMotion.c **** 
 219:icons/spriteMotion.c ****       //Don't need to do this if the row is not in the sprite...
 220:icons/spriteMotion.c ****       for(frameCol = 0; frameCol<FB_WIDTH; frameCol++)
 221:icons/spriteMotion.c ****       {
 222:icons/spriteMotion.c ****       
 223:icons/spriteMotion.c ****          int8_t spriteCol;
 224:icons/spriteMotion.c **** 		  
 225:icons/spriteMotion.c **** #ifdef __QUESTION3_H__
 226:icons/spriteMotion.c **** 			//Count is odd, so we're drawing the '?', which needs shifting...
 227:icons/spriteMotion.c **** 			if((p_theSprite == &spriteQUESTION3) && (count%2 == 1))
 1445               		.stabn	68,0,227,.LM150-.LFBB13
 1446               	.LM150:
 1447 04e4 FA2D      		mov r31,r10
 1448 04e6 F170      		andi r31,lo8(1)
 1449 04e8 FA83      		std Y+2,r31
 228:icons/spriteMotion.c **** 			{
 229:icons/spriteMotion.c **** 				//Scroll left-to-right
 230:icons/spriteMotion.c **** 				// ??? Is there any issue with this going negative?
 231:icons/spriteMotion.c **** 				spriteCol =
 232:icons/spriteMotion.c ****            		((position[0] - cameraState.position[0]) + frameCol - count)
 1450               		.stabn	68,0,232,.LM151-.LFBB13
 1451               	.LM151:
 1452 04ea C32C      		mov r12,r3
 1453 04ec DD24      		clr r13
 1454 04ee C7FC      		sbrc r12,7
 1455 04f0 D094      		com r13
 1456 04f2 B12C      		mov r11,__zero_reg__
 233:icons/spriteMotion.c **** 			  			% FB_WIDTH;
 1457               		.stabn	68,0,233,.LM152-.LFBB13
 1458               	.LM152:
 1459 04f4 10E1      		ldi r17,lo8(16)
 1460 04f6 812E      		mov r8,r17
 1461 04f8 912C      		mov r9,__zero_reg__
 1462               	.L54:
 1463               	.LBE96:
 206:icons/spriteMotion.c ****          (position[1] - cameraState.position[1]) + frameRow;
 1464               		.stabn	68,0,206,.LM153-.LFBB13
 1465               	.LM153:
 1466 04fa 8091 0000 		lds r24,cameraState+1
 1467 04fe 6980      		ldd r6,Y+1
 1468 0500 681A      		sub r6,r24
 1469 0502 620C      		add r6,r2
 210:icons/spriteMotion.c ****          continue;
 1470               		.stabn	68,0,210,.LM154-.LFBB13
 1471               	.LM154:
 1472 0504 2FE0      		ldi r18,lo8(15)
 1473 0506 2615      		cp r18,r6
 1474 0508 00F4      		brsh .+2
 1475 050a 00C0      		rjmp .L43
 213:icons/spriteMotion.c **** 		{	
 1476               		.stabn	68,0,213,.LM155-.LFBB13
 1477               	.LM155:
 1478 050c 4C81      		ldd r20,Y+4
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 72


 1479 050e 5D81      		ldd r21,Y+5
 1480 0510 4050      		subi r20,lo8(spriteFLOWER)
 1481 0512 5040      		sbci r21,hi8(spriteFLOWER)
 1482 0514 01F4      		brne .L44
 215:icons/spriteMotion.c **** 				paletteForColor = NUMPALETTES_FLOWER-1;
 1483               		.stabn	68,0,215,.LM156-.LFBB13
 1484               	.LM156:
 1485 0516 97E0      		ldi r25,lo8(7)
 1486 0518 9615      		cp r25,r6
 1487 051a 04F4      		brge .L44
 216:icons/spriteMotion.c **** 		}
 1488               		.stabn	68,0,216,.LM157-.LFBB13
 1489               	.LM157:
 1490 051c A3E0      		ldi r26,lo8(3)
 1491 051e 4A2E      		mov r4,r26
 1492               	.L44:
 1493 0520 00E0      		ldi r16,0
 1494 0522 10E0      		ldi r17,0
 1495               	.L52:
 1496 0524 8091 0000 		lds r24,cameraState
 1497               	.LBB97:
 227:icons/spriteMotion.c **** 			{
 1498               		.stabn	68,0,227,.LM158-.LFBB13
 1499               	.LM158:
 1500 0528 AC81      		ldd r26,Y+4
 1501 052a BD81      		ldd r27,Y+5
 1502 052c A050      		subi r26,lo8(spriteQUESTION3)
 1503 052e B040      		sbci r27,hi8(spriteQUESTION3)
 1504 0530 01F4      		brne .L45
 227:icons/spriteMotion.c **** 			{
 1505               		.stabn	68,0,227,.LM159-.LFBB13
 1506               	.LM159:
 1507 0532 FA81      		ldd r31,Y+2
 1508 0534 FF23      		tst r31
 1509 0536 01F0      		breq .L45
 232:icons/spriteMotion.c **** 			  			% FB_WIDTH;
 1510               		.stabn	68,0,232,.LM160-.LFBB13
 1511               	.LM160:
 1512 0538 A601      		movw r20,r12
 1513 053a 481B      		sub r20,r24
 1514 053c 5109      		sbc r21,__zero_reg__
 1515 053e 87FD      		sbrc r24,7
 1516 0540 5395      		inc r21
 1517 0542 CA01      		movw r24,r20
 1518 0544 800F      		add r24,r16
 1519 0546 911F      		adc r25,r17
 1520 0548 8A19      		sub r24,r10
 1521 054a 9B09      		sbc r25,r11
 1522               		.stabn	68,0,233,.LM161-.LFBB13
 1523               	.LM161:
 1524 054c B401      		movw r22,r8
 1525 054e 00D0      		rcall __divmodhi4
 231:icons/spriteMotion.c ****            		((position[0] - cameraState.position[0]) + frameCol - count)
 1526               		.stabn	68,0,231,.LM162-.LFBB13
 1527               	.LM162:
 1528 0550 482F      		mov r20,r24
 234:icons/spriteMotion.c **** 				//We want it to wrap...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 73


 235:icons/spriteMotion.c **** 				if(spriteCol < 0)
 1529               		.stabn	68,0,235,.LM163-.LFBB13
 1530               	.LM163:
 1531 0552 87FF      		sbrs r24,7
 1532 0554 00C0      		rjmp .L46
 236:icons/spriteMotion.c **** 					spriteCol += FB_WIDTH;
 1533               		.stabn	68,0,236,.LM164-.LFBB13
 1534               	.LM164:
 1535 0556 40E1      		ldi r20,lo8(16)
 1536 0558 480F      		add r20,r24
 1537 055a 00C0      		rjmp .L46
 1538               	.L45:
 237:icons/spriteMotion.c **** 			}
 238:icons/spriteMotion.c **** 			else
 239:icons/spriteMotion.c **** #endif
 240:icons/spriteMotion.c **** 			{
 241:icons/spriteMotion.c **** 				spriteCol =
 1539               		.stabn	68,0,241,.LM165-.LFBB13
 1540               	.LM165:
 1541 055c 432D      		mov r20,r3
 1542 055e 481B      		sub r20,r24
 1543 0560 400F      		add r20,r16
 1544               	.L46:
 242:icons/spriteMotion.c ****             	(position[0] - cameraState.position[0]) + frameCol;
 243:icons/spriteMotion.c **** 			}
 244:icons/spriteMotion.c **** 
 245:icons/spriteMotion.c ****          if(thisHFlip) //GET_FLIP(p_hFlip, count))
 1545               		.stabn	68,0,245,.LM166-.LFBB13
 1546               	.LM166:
 1547 0562 7720      		tst r7
 1548 0564 01F0      		breq .L47
 246:icons/spriteMotion.c ****             spriteCol=(FB_WIDTH-1)-spriteCol;
 1549               		.stabn	68,0,246,.LM167-.LFBB13
 1550               	.LM167:
 1551 0566 5FE0      		ldi r21,lo8(15)
 1552 0568 541B      		sub r21,r20
 1553 056a 452F      		mov r20,r21
 1554               	.L47:
 247:icons/spriteMotion.c ****             
 248:icons/spriteMotion.c ****          //The sky's already been drawn...
 249:icons/spriteMotion.c ****          if((spriteCol >= FB_WIDTH) || (spriteCol < 0))
 1555               		.stabn	68,0,249,.LM168-.LFBB13
 1556               	.LM168:
 1557 056c 4031      		cpi r20,lo8(16)
 1558 056e 00F4      		brsh .L49
 250:icons/spriteMotion.c ****             continue;
 251:icons/spriteMotion.c ****            
 252:icons/spriteMotion.c **** 		  //As it stands, a multi-image sprite is assumed to always
 253:icons/spriteMotion.c **** 		  //cycle-through the images; one with each redraw...
 254:icons/spriteMotion.c ****          uint8_t colorData = getRawPixelVal(p_theSprite, spriteRow,
 1559               		.stabn	68,0,254,.LM169-.LFBB13
 1560               	.LM169:
 1561 0570 252D      		mov r18,r5
 1562 0572 662D      		mov r22,r6
 1563 0574 8C81      		ldd r24,Y+4
 1564 0576 9D81      		ldd r25,Y+5
 1565 0578 3B83      		std Y+3,r19
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 74


 1566 057a 00D0      		rcall getRawPixelVal
 255:icons/spriteMotion.c ****                                             spriteCol, 
 256:icons/spriteMotion.c **** 															spriteImageNum);
 257:icons/spriteMotion.c **** 		  //									(state->count)%(p_theSprite->numImages));
 258:icons/spriteMotion.c ****                                                          
 259:icons/spriteMotion.c ****          //The sky is always, now, as I recall, 0...     
 260:icons/spriteMotion.c ****          // so use it as a mask.
 261:icons/spriteMotion.c ****          if(colorData == 0)
 1567               		.stabn	68,0,261,.LM170-.LFBB13
 1568               	.LM170:
 1569 057c 3B81      		ldd r19,Y+3
 1570 057e 8823      		tst r24
 1571 0580 01F0      		breq .L49
 262:icons/spriteMotion.c ****             continue; 
 263:icons/spriteMotion.c **** 
 264:icons/spriteMotion.c **** 
 265:icons/spriteMotion.c **** 
 266:icons/spriteMotion.c **** 			colorData = rawPixValToGimpColorVal(colorData,
 1572               		.stabn	68,0,266,.LM171-.LFBB13
 1573               	.LM171:
 1574 0582 442D      		mov r20,r4
 1575 0584 6C81      		ldd r22,Y+4
 1576 0586 7D81      		ldd r23,Y+5
 1577 0588 00D0      		rcall rawPixValToGimpColorVal
 267:icons/spriteMotion.c ****                                                 p_theSprite,
 268:icons/spriteMotion.c ****                                                 paletteForColor);
 269:icons/spriteMotion.c ****          colorData = gimpPixelValToLColor(colorData);
 1578               		.stabn	68,0,269,.LM172-.LFBB13
 1579               	.LM172:
 1580 058a 482F      		mov r20,r24
 1581 058c 4073      		andi r20,lo8(48)
 1582 058e 50E0      		ldi r21,0
 1583 0590 3B81      		ldd r19,Y+3
 1584 0592 4032      		cpi r20,32
 1585 0594 5105      		cpc r21,__zero_reg__
 1586 0596 04F0      		brlt .L51
 1587               		.stabn	68,0,269,.LM173-.LFBB13
 1588               	.LM173:
 1589 0598 805F      		subi r24,lo8(-(16))
 1590               	.L51:
 1591 059a F701      		movw r30,r14
 1592 059c E00F      		add r30,r16
 1593 059e F11F      		adc r31,r17
 270:icons/spriteMotion.c ****          
 271:icons/spriteMotion.c ****          frameBuffer[frameRow][frameCol] = colorData;
 1594               		.stabn	68,0,271,.LM174-.LFBB13
 1595               	.LM174:
 1596 05a0 8083      		st Z,r24
 1597               	.L49:
 1598 05a2 0F5F      		subi r16,-1
 1599 05a4 1F4F      		sbci r17,-1
 1600               	.LBE97:
 220:icons/spriteMotion.c ****       {
 1601               		.stabn	68,0,220,.LM175-.LFBB13
 1602               	.LM175:
 1603 05a6 0031      		cpi r16,16
 1604 05a8 1105      		cpc r17,__zero_reg__
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 75


 1605 05aa 01F0      		breq .+2
 1606 05ac 00C0      		rjmp .L52
 1607               	.L43:
 1608 05ae 2394      		inc r2
 1609 05b0 81E1      		ldi r24,17
 1610 05b2 E80E      		add r14,r24
 1611 05b4 F11C      		adc r15,__zero_reg__
 1612               	.LBE95:
 204:icons/spriteMotion.c ****    {
 1613               		.stabn	68,0,204,.LM176-.LFBB13
 1614               	.LM176:
 1615 05b6 90E1      		ldi r25,lo8(16)
 1616 05b8 2912      		cpse r2,r25
 1617 05ba 00C0      		rjmp .L54
 272:icons/spriteMotion.c ****          
 273:icons/spriteMotion.c ****          //NEED TO STOP AT THE END OF THE MOTIONARRAY
 274:icons/spriteMotion.c ****       }  
 275:icons/spriteMotion.c ****       
 276:icons/spriteMotion.c ****       //For now we're just going to presume that the framebuffer 
 277:icons/spriteMotion.c ****       // has changed each time...
 278:icons/spriteMotion.c ****       //imageChangedTillRow = frameRow;
 279:icons/spriteMotion.c ****    }  
 280:icons/spriteMotion.c ****   
 281:icons/spriteMotion.c **** /* MOVED TO TOP
 282:icons/spriteMotion.c **** 	//This for sprites that have two overlapping images
 283:icons/spriteMotion.c **** 	// (e.g. QUESTION3)
 284:icons/spriteMotion.c **** 	// Possibly also Flower, at some point...?
 285:icons/spriteMotion.c **** 	if( (p_theSprite == &spriteQUESTION3) && (state != NULL) )
 286:icons/spriteMotion.c **** 	{
 287:icons/spriteMotion.c **** 		//draw the "top" sprite, next (e.g. the FRAME)
 288:icons/spriteMotion.c **** 		state->count++;
 289:icons/spriteMotion.c **** 	}
 290:icons/spriteMotion.c **** */
 291:icons/spriteMotion.c **** 
 292:icons/spriteMotion.c **** 	//The only thing in here that should affect a graphical change is
 293:icons/spriteMotion.c **** 	//hFlip...
 294:icons/spriteMotion.c ****    return changeOccurred; //imageChangedTillRow;
 295:icons/spriteMotion.c ****    
 296:icons/spriteMotion.c **** }  
 1618               		.stabn	68,0,296,.LM177-.LFBB13
 1619               	.LM177:
 1620 05bc 832F      		mov r24,r19
 1621               	/* epilogue start */
 1622 05be 0F90      		pop __tmp_reg__
 1623 05c0 0F90      		pop __tmp_reg__
 1624 05c2 0F90      		pop __tmp_reg__
 1625 05c4 0F90      		pop __tmp_reg__
 1626 05c6 0F90      		pop __tmp_reg__
 1627 05c8 DF91      		pop r29
 1628 05ca CF91      		pop r28
 1629 05cc 1F91      		pop r17
 1630 05ce 0F91      		pop r16
 1631 05d0 FF90      		pop r15
 1632 05d2 EF90      		pop r14
 1633 05d4 DF90      		pop r13
 1634 05d6 CF90      		pop r12
 1635 05d8 BF90      		pop r11
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 76


 1636 05da AF90      		pop r10
 1637 05dc 9F90      		pop r9
 1638 05de 8F90      		pop r8
 1639 05e0 7F90      		pop r7
 1640 05e2 6F90      		pop r6
 1641 05e4 5F90      		pop r5
 1642 05e6 4F90      		pop r4
 1643 05e8 3F90      		pop r3
 1644 05ea 2F90      		pop r2
 1645 05ec 0895      		ret
 1646               		.size	fbQ_overlaySprite, .-fbQ_overlaySprite
 1647               		.stabs	"changeOccurred:r(4,2)",64,0,110,19
 1648               		.stabs	"frameRow:r(4,1)",64,0,117,2
 1649               		.stabs	"paletteForColor:r(4,2)",64,0,121,4
 1650               		.stabs	"p_hFlip:r(0,48)",64,0,124,16
 1651               		.stabs	"count:r(4,2)",64,0,125,10
 1652               		.stabs	"spriteImageNum:r(4,2)",64,0,126,5
 1653               		.stabs	"thisHFlip:r(4,2)",64,0,183,7
 1654               		.stabn	192,0,0,.LFBB13-.LFBB13
 1655               		.stabs	"spriteCol:r(4,1)",64,0,223,20
 1656               		.stabn	192,0,0,.LBB96-.LFBB13
 1657               		.stabn	224,0,0,.LBE96-.LFBB13
 1658               		.stabs	"spriteCol:r(4,1)",64,0,223,20
 1659               		.stabn	192,0,0,.LBB97-.LFBB13
 1660               		.stabn	224,0,0,.LBE97-.LFBB13
 1661               		.stabn	224,0,0,.Lscope13-.LFBB13
 1662               	.Lscope13:
 1663               		.stabs	"",36,0,0,.Lscope13-.LFBB13
 1664               		.stabd	78,0,0
 1665               		.stabs	"pseudoRandom:F(4,2)",36,0,155,pseudoRandom
 1666               	.global	pseudoRandom
 1667               		.type	pseudoRandom, @function
 1668               	pseudoRandom:
 1669               		.stabd	46,0,0
 1670               		.stabs	"fb_question.c",132,0,0,.Ltext15
 1671               	.Ltext15:
   1:fb_question.c **** /* mehPL:
   2:fb_question.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:fb_question.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:fb_question.c ****  *    Please see the bottom.
   5:fb_question.c ****  *    Enjoy!
   6:fb_question.c ****  */
   7:fb_question.c **** 
   8:fb_question.c **** 
   9:fb_question.c **** 
  10:fb_question.c **** 
  11:fb_question.c **** 
  12:fb_question.c **** 
  13:fb_question.c **** 
  14:fb_question.c **** // DUH! It's called "Power-Ups"
  15:fb_question.c **** 
  16:fb_question.c **** 
  17:fb_question.c **** 
  18:fb_question.c **** 
  19:fb_question.c **** //fb_question is the good-ol' "Mario" Question-box, using a frameBuffer...
  20:fb_question.c **** //  It was created after seg_question, which was created after a
  21:fb_question.c **** //  frameBuffer-based method. Long convoluted story.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 77


  22:fb_question.c **** 
  23:fb_question.c **** // Essentially, fb_question is the latest (a/o v66) version of the
  24:fb_question.c **** // Mario-Question-Box, which has actually been installed at a somewhat
  25:fb_question.c **** // permanent location for public-interaction. (and Seg_question has since
  26:fb_question.c **** // been put on the back-burner).
  27:fb_question.c **** 
  28:fb_question.c **** // When the question-box is "hit" it displays a random sprite:
  29:fb_question.c **** //  A Coin, 1-up, Biggie, Star, Flower, or possibly a Goomba
  30:fb_question.c **** //  If you *hit* the goomba, it dies.
  31:fb_question.c **** 
  32:fb_question.c **** // As-implemented (in main), the ADC is used as the hit-detector. Connected
  33:fb_question.c **** // to it is a piezo-element. Unfortunately, I'm certain, the
  34:fb_question.c **** // threshold-values, etc. for this "hit-sensor" will have to be configured
  35:fb_question.c **** // for your particular hardware... And, in fact, I've found that it's
  36:fb_question.c **** // sensitive to electrical noise (e.g. from the backlight inverter) as well
  37:fb_question.c **** // as things like temperature. It's kinda hokey, but it's also in main()
  38:fb_question.c **** // and could easily be converted to a simple momentary-switch.
  39:fb_question.c **** 
  40:fb_question.c **** 
  41:fb_question.c **** 
  42:fb_question.c **** 
  43:fb_question.c **** 
  44:fb_question.c **** 
  45:fb_question.c **** 	//Start at brown, to match the SOLID color
  46:fb_question.c **** #define Q_QSTART	7 //3
  47:fb_question.c **** 
  48:fb_question.c **** //a/o v62-21:
  49:fb_question.c **** // this is stolen from seg_question.c and modified for the framebuffer...
  50:fb_question.c **** 
  51:fb_question.c **** 
  52:fb_question.c **** 
  53:fb_question.c **** //Include Question3.h to include all mario3 sprites...
  54:fb_question.c **** #if(defined(MARIO3) && MARIO3)
  55:fb_question.c **** //#warning "MARIO3 is TRUE, but its #inclusion is commented-out"
  56:fb_question.c **** #include "icons/Question3.h"
  57:fb_question.c **** #endif
  58:fb_question.c **** 
  59:fb_question.c **** //Currently it's not possible to only include Mario3...
  60:fb_question.c **** // This MUST be included.
  61:fb_question.c **** #include "icons/Question.h"
  62:fb_question.c **** 
  63:fb_question.c **** 
  64:fb_question.c ****    #include "icons/Solid.h"
  65:fb_question.c **** 	#include "icons/SolidBump.h"
  66:fb_question.c ****    #include "icons/Goomba.h"
  67:fb_question.c ****    #include "icons/GoombaDead.h"
  68:fb_question.c ****    #include "icons/1up.h"
  69:fb_question.c ****    #include "icons/Biggie.h"
  70:fb_question.c ****    #include "icons/StarV.h"
  71:fb_question.c ****    #include "icons/FlowerPowerV.h"
  72:fb_question.c ****    #include "icons/Coin.h"
  73:fb_question.c **** 	#include "icons/Cloud.h"
  74:fb_question.c **** 	#include "icons/Mario.h"
  75:fb_question.c **** 	#include "icons/Luigi.h"
  76:fb_question.c **** 	#include "icons/MarioRuns.h"
  77:fb_question.c **** 	#include "icons/LuigiRuns.h"
  78:fb_question.c **** #ifdef __QUESTION3_H__
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 78


  79:fb_question.c **** 	#include "icons/Solid3.h"
  80:fb_question.c **** 	#include "icons/SolidBump3.h"
  81:fb_question.c **** 	#include "icons/Leaf.h"
  82:fb_question.c **** 	#include "icons/TanookiSuit.h"
  83:fb_question.c **** 	#include "icons/Frog.h"
  84:fb_question.c **** 	#include "icons/Boot.h"
  85:fb_question.c **** 	#include "icons/Hammer.h"
  86:fb_question.c **** 	#include "icons/PWing.h"
  87:fb_question.c **** //	#include "icons/Flute.h"	//Too Phallic for my liking...
  88:fb_question.c **** // If it wasn't extending from the box, maybe it'd be different.
  89:fb_question.c **** 	#include "icons/MusicBox.h"
  90:fb_question.c **** #endif
  91:fb_question.c **** 	//This needs to be included AFTER Question3.h if used...
  92:fb_question.c **** 	// (and FlowerPowerV.h)...
  93:fb_question.c **** 	#include "icons/spriteMotion.c"
  94:fb_question.c **** //a/o v77
  95:fb_question.c **** //APPARENTLY NUM_ICONS is no longer used.
  96:fb_question.c **** //Excluding Solid and Question, etc...
  97:fb_question.c **** //#define NUM_ICONS 6
  98:fb_question.c **** 
  99:fb_question.c **** 
 100:fb_question.c **** //Allow the user to choose another winnings when the question-box is
 101:fb_question.c **** //scrolling down to reveal it... for testing
 102:fb_question.c **** //#define IMMEDIATE TRUE
 103:fb_question.c **** 
 104:fb_question.c **** //This is just a hack for testing BIGGIE with the Leaf tester, which was a
 105:fb_question.c **** //hack in the first place.
 106:fb_question.c **** //#define MOTION_BIGGIE TRUE	//RANDOM_OVERRIDE's gotta be 2
 107:fb_question.c **** //These are from hitDetected()
 108:fb_question.c **** //THIS MUST NOW BE considered WITH the mario-version
 109:fb_question.c **** // (e.g. RANDOM_OVERRIDE_Q to &spriteQ or &spriteQUESTION3 as appropriate)
 110:fb_question.c **** //#define RANDOM_OVERRIDE 10//15//Cloud5//8//32//2//Biggie //5//Leaf  //4 //8 //0 //4
 111:fb_question.c **** //#define RANDOM_OVERRIDE_Q	&spriteQ //UESTION3
 112:fb_question.c **** 
 113:fb_question.c **** //Stalls at the first sprite (initilized in p_selectedSprite, below)
 114:fb_question.c **** //#define STAY_ON_IT	TRUE
 115:fb_question.c **** 
 116:fb_question.c **** //Automatically hit after a few loops in the "Q" box
 117:fb_question.c **** //#define AUTO_HIT	TRUE
 118:fb_question.c **** //#define AUTO_KILL_GOOMBA	TRUE
 119:fb_question.c **** 
 120:fb_question.c **** //THESE DON'T BELONG HERE
 121:fb_question.c **** // AND they shouldn't be "Q" specific, at all.
 122:fb_question.c **** #define Q_WIDTH   16
 123:fb_question.c **** #define Q_HEIGHT   16
 124:fb_question.c **** #if((Q_WIDTH != FB_WIDTH) || (Q_HEIGHT != FB_HEIGHT))
 125:fb_question.c **** #error "FB dims do not match Icon dims"
 126:fb_question.c **** #endif
 127:fb_question.c **** 
 128:fb_question.c **** //this is just a counter to help throw in some additional randomness...
 129:fb_question.c **** uint8_t callCount = 0;
 130:fb_question.c **** 
 131:fb_question.c **** //uint8_t qCount = 0;
 132:fb_question.c **** //sprite_t *p_selectedSprite = &spriteLEAF; //COIN; //GOOMBA; //FLOWER; //&spriteQ;
 133:fb_question.c **** 
 134:fb_question.c **** //a/o v84: nextSprite is hokily used as selectedSprite...
 135:fb_question.c **** // This needs to be changed.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 79


 136:fb_question.c **** //sprite_t *p_nextSprite = &spriteLEAF; //NULL;
 137:fb_question.c **** const __flash sprite_t *p_nowSprite = &spriteQ;//UESTION3; 
 138:fb_question.c **** //&spriteLEAF; //NULL;
 139:fb_question.c **** //This indicates whether we're in a "Reward"
 140:fb_question.c **** // e.g. to draw SOLID in the background
 141:fb_question.c **** // 1 = SOLID
 142:fb_question.c **** // 3 = SOLID3
 143:fb_question.c **** uint8_t nowIsReward = FALSE; //TRUE;
 144:fb_question.c **** 
 145:fb_question.c **** 
 146:fb_question.c **** void initSpriteStates(const __flash sprite_t *newSprite);
 147:fb_question.c **** 
 148:fb_question.c **** //#define FB_ENABLE_PAUSE	TRUE
 149:fb_question.c **** 
 150:fb_question.c **** #if(defined(FB_ENABLE_PAUSE)	&& FB_ENABLE_PAUSE)
 151:fb_question.c **** #warning "FB_ENABLE_PAUSE is TRUE... this is for debugging and isn't well-implemented. DO NOT USE i
 152:fb_question.c **** uint8_t fb_paused = FALSE;
 153:fb_question.c **** #endif
 154:fb_question.c **** 
 155:fb_question.c **** uint8_t pseudoRandom(void)
 156:fb_question.c **** {
 1672               		.stabn	68,0,156,.LM178-.LFBB14
 1673               	.LM178:
 1674               	.LFBB14:
 1675               	/* prologue: function */
 1676               	/* frame size = 0 */
 1677               	/* stack size = 0 */
 1678               	.L__stack_usage = 0
 157:fb_question.c **** 	return (HSYNC_TIMER_TCNT + callCount + nowSpriteState.count);
 1679               		.stabn	68,0,157,.LM179-.LFBB14
 1680               	.LM179:
 1681 05ee 82B7      		in r24,0x32
 1682 05f0 9091 0000 		lds r25,callCount
 1683 05f4 890F      		add r24,r25
 1684 05f6 9091 0000 		lds r25,nowSpriteState+4
 158:fb_question.c **** }
 1685               		.stabn	68,0,158,.LM180-.LFBB14
 1686               	.LM180:
 1687 05fa 890F      		add r24,r25
 1688 05fc 0895      		ret
 1689               		.size	pseudoRandom, .-pseudoRandom
 1690               	.Lscope14:
 1691               		.stabs	"",36,0,0,.Lscope14-.LFBB14
 1692               		.stabd	78,0,0
 1693               		.stabs	"initSpriteStates:F(0,47)",36,0,426,initSpriteStates
 1694               		.stabs	"newSprite:P(16,3)",64,0,426,24
 1695               	.global	initSpriteStates
 1696               		.type	initSpriteStates, @function
 1697               	initSpriteStates:
 1698               		.stabd	46,0,0
 159:fb_question.c **** 
 160:fb_question.c **** uint8_t qVersion = 1;
 161:fb_question.c **** 
 162:fb_question.c **** 
 163:fb_question.c **** #warning "qVersion and nowIsReward could probably be merged..."
 164:fb_question.c **** 
 165:fb_question.c **** void fbQuestion_hitDetected(void)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 80


 166:fb_question.c **** {
 167:fb_question.c **** 	uint8_t selectedQ = 0;
 168:fb_question.c **** 
 169:fb_question.c **** 	if( p_nowSprite == &spriteQ)
 170:fb_question.c **** 		selectedQ = 1;
 171:fb_question.c **** #ifdef __QUESTION3_H__
 172:fb_question.c **** 	else if (p_nowSprite == &spriteQUESTION3)
 173:fb_question.c **** 		selectedQ = 3;
 174:fb_question.c **** #endif
 175:fb_question.c **** 
 176:fb_question.c **** #ifdef __QUESTION3_H__
 177:fb_question.c **** 	if(selectedQ == 3)
 178:fb_question.c **** 	{
 179:fb_question.c **** 		qVersion = selectedQ;
 180:fb_question.c **** 		p_nowSprite = &spriteSOLIDBUMP3;
 181:fb_question.c **** 	}
 182:fb_question.c **** 	else
 183:fb_question.c **** #endif	
 184:fb_question.c **** 	if(selectedQ)
 185:fb_question.c **** 	{
 186:fb_question.c **** 		qVersion = selectedQ;
 187:fb_question.c **** 		p_nowSprite = &spriteSOLIDBUMP;
 188:fb_question.c **** 	}
 189:fb_question.c **** 	//As-is, the last frame (in blue, indicating death) is only visible
 190:fb_question.c **** 	//briefly before scroll-back-to-question starts...
 191:fb_question.c **** 	// so there's no reason to test for KILLABLE
 192:fb_question.c **** 	// since it can't be killed when it's scrolling.
 193:fb_question.c **** 	// There's probably a tiny fraction of a second window where it is
 194:fb_question.c **** 	// possible to hit it when it's blue, and kill it... but it's TINY.
 195:fb_question.c **** 	else if((p_nowSprite == &spriteGOOMBA)
 196:fb_question.c **** 			&& ((nowSpriteState.count > 16) && (nowSpriteState.count < 62)))
 197:fb_question.c **** 	{
 198:fb_question.c **** 		p_nowSprite = &spriteDEADGOOMBA;
 199:fb_question.c **** 	}
 200:fb_question.c **** #if(defined(FB_ENABLE_PAUSE)	&& FB_ENABLE_PAUSE)
 201:fb_question.c **** 	else
 202:fb_question.c **** 	{
 203:fb_question.c **** 		fb_paused = !fb_paused;
 204:fb_question.c **** 		return;
 205:fb_question.c **** 	}
 206:fb_question.c **** #endif
 207:fb_question.c **** 
 208:fb_question.c **** 	initSpriteStates(p_nowSprite);
 209:fb_question.c **** }
 210:fb_question.c **** 
 211:fb_question.c **** void prepReward(void)
 212:fb_question.c **** {
 213:fb_question.c **** 	if(qVersion == 1)
 214:fb_question.c **** 	{
 215:fb_question.c **** 		uint8_t hitReward;
 216:fb_question.c **** 		//Just trying to get some randomness up in hea
 217:fb_question.c **** #if (defined(RANDOM_OVERRIDE))
 218:fb_question.c **** 		hitReward = RANDOM_OVERRIDE;
 219:fb_question.c **** #else
 220:fb_question.c **** 		static uint8_t lastReward;
 221:fb_question.c **** 		
 222:fb_question.c **** 		do
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 81


 223:fb_question.c **** 		{
 224:fb_question.c **** 			//hitReward = 
 225:fb_question.c **** 				//(HSYNC_TIMER_TCNT + callCount + nowSpriteState.count)%20;
 226:fb_question.c **** 			hitReward = pseudoRandom()%12;
 227:fb_question.c **** 			//Don't allow double-goombas
 228:fb_question.c **** 		} while ((lastReward == 4) && (hitReward == 4));
 229:fb_question.c **** 
 230:fb_question.c **** 		lastReward = hitReward;
 231:fb_question.c **** #endif
 232:fb_question.c **** 
 233:fb_question.c **** 		switch(hitReward)
 234:fb_question.c **** 		{
 235:fb_question.c **** 			case 0:
 236:fb_question.c **** 				p_nowSprite = &spriteFLOWER;
 237:fb_question.c **** 				break;
 238:fb_question.c **** 			case 1:
 239:fb_question.c **** 				p_nowSprite = &sprite1UP;
 240:fb_question.c **** 				break;
 241:fb_question.c **** 			case 2:
 242:fb_question.c **** 				p_nowSprite = &spriteBIG;
 243:fb_question.c **** 				break;
 244:fb_question.c **** 			case 3:
 245:fb_question.c **** 				p_nowSprite = &spriteSTAR;
 246:fb_question.c **** 				break;
 247:fb_question.c **** 			case 4:
 248:fb_question.c **** 				p_nowSprite = &spriteGOOMBA;
 249:fb_question.c **** 				break;
 250:fb_question.c **** 			case 6:
 251:fb_question.c **** 				p_nowSprite = &spriteCLOUD;
 252:fb_question.c **** 				break;
 253:fb_question.c **** 			case 7:
 254:fb_question.c **** 				p_nowSprite = &spriteMARIO;
 255:fb_question.c **** 				break;
 256:fb_question.c **** 			case 8:
 257:fb_question.c **** 				p_nowSprite = &spriteLUIGI;
 258:fb_question.c **** 				break;
 259:fb_question.c **** 			default:
 260:fb_question.c **** 				p_nowSprite = &spriteCOIN;
 261:fb_question.c **** 				break;
 262:fb_question.c **** 		}
 263:fb_question.c **** 		//qCount = 0;
 264:fb_question.c **** 		nowIsReward = qVersion; //selectedQ; // TRUE;
 265:fb_question.c **** 		initSpriteStates(p_nowSprite);
 266:fb_question.c **** 	}
 267:fb_question.c **** #ifdef __QUESTION3_H__
 268:fb_question.c **** 	else if(qVersion == 3)
 269:fb_question.c **** 	{
 270:fb_question.c **** 		uint8_t hitReward;
 271:fb_question.c **** 		//Just trying to get some randomness up in hea
 272:fb_question.c **** #if (defined(RANDOM_OVERRIDE))
 273:fb_question.c **** 		hitReward = RANDOM_OVERRIDE;
 274:fb_question.c **** #else
 275:fb_question.c **** 		
 276:fb_question.c **** 		hitReward = pseudoRandom()%12;
 277:fb_question.c **** #endif
 278:fb_question.c **** 
 279:fb_question.c **** 		switch(hitReward)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 82


 280:fb_question.c **** 		{
 281:fb_question.c **** 			case 0:
 282:fb_question.c **** 				p_nowSprite = &spriteLEAF;
 283:fb_question.c **** 				break;
 284:fb_question.c **** 			case 1:
 285:fb_question.c **** 				p_nowSprite = &spriteCLOUD;
 286:fb_question.c **** 				break;
 287:fb_question.c **** 			case 2:
 288:fb_question.c **** 				p_nowSprite = &spriteTANOOKI;
 289:fb_question.c **** 				break;
 290:fb_question.c **** 			case 3:
 291:fb_question.c **** 				p_nowSprite = &spriteFROG;
 292:fb_question.c **** 				break;
 293:fb_question.c **** 			case 4:
 294:fb_question.c **** 				p_nowSprite = &spriteBOOT;
 295:fb_question.c **** 				break;
 296:fb_question.c **** 			case 5:
 297:fb_question.c **** 				p_nowSprite = &spriteHAMMER;
 298:fb_question.c **** 				break;
 299:fb_question.c **** 			case 6:
 300:fb_question.c **** 				p_nowSprite = &spritePWING;
 301:fb_question.c **** 				break;
 302:fb_question.c **** //			case 7:
 303:fb_question.c **** //				p_nowSprite = &spriteFLUTE;
 304:fb_question.c **** //				break;
 305:fb_question.c **** 			case 8:
 306:fb_question.c **** 				p_nowSprite = &spriteMUSICBOX;
 307:fb_question.c **** 				break;
 308:fb_question.c **** 			default:
 309:fb_question.c **** 				p_nowSprite = &spriteCOIN;
 310:fb_question.c **** 				break;
 311:fb_question.c **** 		}
 312:fb_question.c **** 		//qCount = 0;
 313:fb_question.c **** 		nowIsReward = qVersion; //selectedQ; // TRUE;
 314:fb_question.c **** 		initSpriteStates(p_nowSprite);
 315:fb_question.c **** 	}
 316:fb_question.c **** #endif //__QUESTION3_H__
 317:fb_question.c **** 
 318:fb_question.c **** 
 319:fb_question.c **** }
 320:fb_question.c **** 
 321:fb_question.c **** //If a spriteRow is outside the icon's dimensions, draws the sky-color
 322:fb_question.c **** //Returns TRUE if a pixel has changed
 323:fb_question.c **** // for redrawing...
 324:fb_question.c **** uint8_t drawSpriteRow(const __flash sprite_t *p_thisSprite, uint8_t spritePhase,
 325:fb_question.c **** 													  int8_t spriteRow, 
 326:fb_question.c **** 													  uint8_t rowToDrawAt);
 327:fb_question.c **** 
 328:fb_question.c **** 
 329:fb_question.c **** 
 330:fb_question.c **** #if(defined(STAY_ON_IT) && STAY_ON_IT)
 331:fb_question.c **** //Check for completion of one sprite, and setup the next...
 332:fb_question.c **** void prepNextSprite(void)
 333:fb_question.c **** {
 334:fb_question.c **** }
 335:fb_question.c **** #else
 336:fb_question.c **** void prepNextSprite(void)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 83


 337:fb_question.c **** {
 338:fb_question.c **** 	//a/o v84:
 339:fb_question.c **** 	// The new plan is to have a defined path...
 340:fb_question.c **** 	// Q -> SolidBump -> "Reward" -> Solid -> Q
 341:fb_question.c **** 		
 342:fb_question.c **** 	// CURRENTLY: "Hit" is NYI so:
 343:fb_question.c **** 	// Q -> "Reward" -> Solid -> Q
 344:fb_question.c **** 
 345:fb_question.c **** 	// Q Loops...
 346:fb_question.c **** 
 347:fb_question.c **** 	uint8_t selectedQ = 0;
 348:fb_question.c **** 
 349:fb_question.c **** 	if(p_nowSprite == &spriteQ)
 350:fb_question.c **** 		selectedQ = 1;
 351:fb_question.c **** #ifdef __QUESTION3_H__
 352:fb_question.c **** 	else if(p_nowSprite == &spriteQUESTION3)
 353:fb_question.c **** 		selectedQ = 3;
 354:fb_question.c **** #endif
 355:fb_question.c **** 
 356:fb_question.c **** 	if(selectedQ)
 357:fb_question.c **** 	{
 358:fb_question.c **** 		//Do nothing for Q... until a hit arrives
 359:fb_question.c **** 		// nowIsReward should already be FALSE
 360:fb_question.c **** 		
 361:fb_question.c **** 		// If AUTO_HIT is true, then "after" Question-box "completes"
 362:fb_question.c **** 		// act like a hit was detected...
 363:fb_question.c **** 	  #if(defined(AUTO_HIT) && AUTO_HIT)
 364:fb_question.c **** 		fbQuestion_hitDetected();
 365:fb_question.c **** 	  #else
 366:fb_question.c **** 		//return;
 367:fb_question.c ****      #endif
 368:fb_question.c **** 	}
 369:fb_question.c **** 	// SolidBump -> "reward"
 370:fb_question.c **** 	else if( (p_nowSprite == &spriteSOLIDBUMP)
 371:fb_question.c **** #ifdef __QUESTION3_H__
 372:fb_question.c **** 			|| (p_nowSprite == &spriteSOLIDBUMP3)
 373:fb_question.c **** #endif
 374:fb_question.c **** 			)
 375:fb_question.c **** 	{
 376:fb_question.c **** 		prepReward();
 377:fb_question.c **** 	}
 378:fb_question.c **** 	// Mario -> MarioRuns
 379:fb_question.c **** 	else if(p_nowSprite == &spriteMARIO)
 380:fb_question.c **** 	{
 381:fb_question.c **** 		//nowIsReward = TRUE;
 382:fb_question.c **** 		p_nowSprite = &spriteMARIORUNS;
 383:fb_question.c **** 	}
 384:fb_question.c **** 	// Luigi -> LuigiRuns
 385:fb_question.c **** 	else if(p_nowSprite == &spriteLUIGI)
 386:fb_question.c **** 	{
 387:fb_question.c **** 		//nowIsReward = TRUE;
 388:fb_question.c **** 		p_nowSprite = &spriteLUIGIRUNS;
 389:fb_question.c **** 	}
 390:fb_question.c **** 	// Solid -> Q
 391:fb_question.c **** 	else if((p_nowSprite == &spriteSOLID)
 392:fb_question.c **** #ifdef __QUESTION3_H__
 393:fb_question.c **** 		|| (p_nowSprite == &spriteSOLID3)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 84


 394:fb_question.c **** #endif
 395:fb_question.c **** 		)
 396:fb_question.c **** 	{
 397:fb_question.c **** 		nowIsReward = FALSE;
 398:fb_question.c **** #if(!defined(RANDOM_OVERRIDE))
 399:fb_question.c ****  #ifdef __QUESTION3_H__
 400:fb_question.c **** 		if(pseudoRandom()&0x01)
 401:fb_question.c **** 			p_nowSprite = &spriteQUESTION3;
 402:fb_question.c **** 		else
 403:fb_question.c ****  #endif//__QUESTION3_H__
 404:fb_question.c **** 			p_nowSprite = &spriteQ;
 405:fb_question.c **** #else	//RANDOM_OVERRIDE
 406:fb_question.c **** 		p_nowSprite = RANDOM_OVERRIDE_Q;
 407:fb_question.c **** #endif
 408:fb_question.c **** 	}
 409:fb_question.c **** 	// "Reward" -> Solid
 410:fb_question.c **** 	else
 411:fb_question.c **** 	{
 412:fb_question.c **** #ifdef __QUESTION3_H__
 413:fb_question.c **** 		if(nowIsReward == 3)
 414:fb_question.c **** 			p_nowSprite = &spriteSOLID3;
 415:fb_question.c **** 		else
 416:fb_question.c **** #endif
 417:fb_question.c **** 			p_nowSprite = &spriteSOLID;
 418:fb_question.c **** 
 419:fb_question.c **** 		nowIsReward = FALSE;
 420:fb_question.c **** //		p_nowSprite = &spriteSOLID;
 421:fb_question.c **** 	}	
 422:fb_question.c **** 
 423:fb_question.c **** 	initSpriteStates(p_nowSprite);
 424:fb_question.c **** }
 425:fb_question.c **** 
 426:fb_question.c **** void initSpriteStates(const __flash sprite_t *newSprite)
 427:fb_question.c **** {
 1699               		.stabn	68,0,427,.LM181-.LFBB15
 1700               	.LM181:
 1701               	.LFBB15:
 1702               	/* prologue: function */
 1703               	/* frame size = 0 */
 1704               	/* stack size = 0 */
 1705               	.L__stack_usage = 0
 428:fb_question.c **** 	//qCount = 0;
 429:fb_question.c **** 	//.count is handled by qCount... but let's init it anyhow.
 430:fb_question.c **** 	
 431:fb_question.c **** 	p_nowSprite = newSprite;
 1706               		.stabn	68,0,431,.LM182-.LFBB15
 1707               	.LM182:
 1708 05fe 9093 0000 		sts p_nowSprite+1,r25
 1709 0602 8093 0000 		sts p_nowSprite,r24
 432:fb_question.c **** 	
 433:fb_question.c **** 	
 434:fb_question.c **** 	
 435:fb_question.c **** 	
 436:fb_question.c **** 	nowSpriteState.sprite = p_nowSprite;
 1710               		.stabn	68,0,436,.LM183-.LFBB15
 1711               	.LM183:
 1712 0606 9093 0000 		sts nowSpriteState+11+1,r25
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 85


 1713 060a 8093 0000 		sts nowSpriteState+11,r24
 437:fb_question.c **** 	nowSpriteState.count = 0;
 1714               		.stabn	68,0,437,.LM184-.LFBB15
 1715               	.LM184:
 1716 060e 1092 0000 		sts nowSpriteState+4,__zero_reg__
 438:fb_question.c **** 	nowSpriteState.hFlip = p_nowSprite->p_hFlip;
 1717               		.stabn	68,0,438,.LM185-.LFBB15
 1718               	.LM185:
 1719 0612 FC01      		movw r30,r24
 1720 0614 3896      		adiw r30,8
 1721 0616 2591      		lpm r18,Z+
 1722 0618 3591      		lpm r19,Z+
 1723 061a 3093 0000 		sts nowSpriteState+7+1,r19
 1724 061e 2093 0000 		sts nowSpriteState+7,r18
 439:fb_question.c **** 	nowSpriteState.motion = p_nowSprite->p_motion;
 1725               		.stabn	68,0,439,.LM186-.LFBB15
 1726               	.LM186:
 1727 0622 FC01      		movw r30,r24
 1728 0624 3A96      		adiw r30,10
 1729 0626 0590      		lpm r0,Z+
 1730 0628 F491      		lpm r31,Z
 1731 062a E02D      		mov r30,r0
 1732 062c F093 0000 		sts nowSpriteState+9+1,r31
 1733 0630 E093 0000 		sts nowSpriteState+9,r30
 440:fb_question.c **** 	//Origin is lower-left, but nextSpritePosition is upper-left...
 441:fb_question.c **** 	nowSpriteState.position[0] = -(nowSpriteState.motion[0].startPosition);
 1734               		.stabn	68,0,441,.LM187-.LFBB15
 1735               	.LM187:
 1736 0634 2491      		lpm r18,Z
 1737 0636 2195      		neg r18
 1738 0638 2093 0000 		sts nowSpriteState,r18
 442:fb_question.c **** 	nowSpriteState.position[1] = nowSpriteState.motion[1].startPosition;
 1739               		.stabn	68,0,442,.LM188-.LFBB15
 1740               	.LM188:
 1741 063c 3396      		adiw r30,3
 1742 063e 2491      		lpm r18,Z
 1743 0640 2093 0000 		sts nowSpriteState+1,r18
 443:fb_question.c **** 	nowSpriteState.dir[0] = 1;
 1744               		.stabn	68,0,443,.LM189-.LFBB15
 1745               	.LM189:
 1746 0644 41E0      		ldi r20,lo8(1)
 1747 0646 4093 0000 		sts nowSpriteState+2,r20
 444:fb_question.c **** 	nowSpriteState.dir[1] = 1;
 1748               		.stabn	68,0,444,.LM190-.LFBB15
 1749               	.LM190:
 1750 064a 4093 0000 		sts nowSpriteState+3,r20
 445:fb_question.c **** 
 446:fb_question.c **** 	nowSpriteState.layer = p_nowSprite->p_layer;
 1751               		.stabn	68,0,446,.LM191-.LFBB15
 1752               	.LM191:
 1753 064e FC01      		movw r30,r24
 1754 0650 3C96      		adiw r30,12
 1755 0652 2591      		lpm r18,Z+
 1756 0654 3591      		lpm r19,Z+
 1757 0656 3093 0000 		sts nowSpriteState+5+1,r19
 1758 065a 2093 0000 		sts nowSpriteState+5,r18
 447:fb_question.c **** 	nowSpriteState.paletteNum = 0;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 86


 1759               		.stabn	68,0,447,.LM192-.LFBB15
 1760               	.LM192:
 1761 065e 1092 0000 		sts nowSpriteState+13,__zero_reg__
 448:fb_question.c **** 
 449:fb_question.c **** 
 450:fb_question.c **** 	//No sprite associated with the camera...
 451:fb_question.c **** 	cameraState.sprite = NULL;
 1762               		.stabn	68,0,451,.LM193-.LFBB15
 1763               	.LM193:
 1764 0662 1092 0000 		sts cameraState+11+1,__zero_reg__
 1765 0666 1092 0000 		sts cameraState+11,__zero_reg__
 452:fb_question.c **** 	cameraState.count = 0;
 1766               		.stabn	68,0,452,.LM194-.LFBB15
 1767               	.LM194:
 1768 066a 1092 0000 		sts cameraState+4,__zero_reg__
 453:fb_question.c **** 	cameraState.hFlip = NadaFlip;
 1769               		.stabn	68,0,453,.LM195-.LFBB15
 1770               	.LM195:
 1771 066e 1092 0000 		sts cameraState+7+1,__zero_reg__
 1772 0672 1092 0000 		sts cameraState+7,__zero_reg__
 454:fb_question.c **** 	cameraState.motion = p_nowSprite->p_camMotion;
 1773               		.stabn	68,0,454,.LM196-.LFBB15
 1774               	.LM196:
 1775 0676 FC01      		movw r30,r24
 1776 0678 3E96      		adiw r30,14
 1777 067a 0590      		lpm r0,Z+
 1778 067c F491      		lpm r31,Z
 1779 067e E02D      		mov r30,r0
 1780 0680 F093 0000 		sts cameraState+9+1,r31
 1781 0684 E093 0000 		sts cameraState+9,r30
 455:fb_question.c **** 	cameraState.position[0] = -(cameraState.motion[0].startPosition);
 1782               		.stabn	68,0,455,.LM197-.LFBB15
 1783               	.LM197:
 1784 0688 8491      		lpm r24,Z
 1785 068a 8195      		neg r24
 1786 068c 8093 0000 		sts cameraState,r24
 456:fb_question.c **** 	cameraState.position[1] = cameraState.motion[1].startPosition;
 1787               		.stabn	68,0,456,.LM198-.LFBB15
 1788               	.LM198:
 1789 0690 3396      		adiw r30,3
 1790 0692 8491      		lpm r24,Z
 1791 0694 8093 0000 		sts cameraState+1,r24
 457:fb_question.c **** 	cameraState.dir[0] = 1;
 1792               		.stabn	68,0,457,.LM199-.LFBB15
 1793               	.LM199:
 1794 0698 4093 0000 		sts cameraState+2,r20
 458:fb_question.c **** 	cameraState.dir[1] = 1;
 1795               		.stabn	68,0,458,.LM200-.LFBB15
 1796               	.LM200:
 1797 069c 4093 0000 		sts cameraState+3,r20
 459:fb_question.c **** 
 460:fb_question.c **** 	cameraState.layer = NadaLayer;
 1798               		.stabn	68,0,460,.LM201-.LFBB15
 1799               	.LM201:
 1800 06a0 1092 0000 		sts cameraState+5+1,__zero_reg__
 1801 06a4 1092 0000 		sts cameraState+5,__zero_reg__
 461:fb_question.c **** 	cameraState.paletteNum = 0;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 87


 1802               		.stabn	68,0,461,.LM202-.LFBB15
 1803               	.LM202:
 1804 06a8 1092 0000 		sts cameraState+13,__zero_reg__
 1805 06ac 0895      		ret
 1806               		.size	initSpriteStates, .-initSpriteStates
 1807               	.Lscope15:
 1808               		.stabs	"",36,0,0,.Lscope15-.LFBB15
 1809               		.stabd	78,0,0
 1810               		.stabs	"fbQuestion_hitDetected:F(0,47)",36,0,165,fbQuestion_hitDetected
 1811               	.global	fbQuestion_hitDetected
 1812               		.type	fbQuestion_hitDetected, @function
 1813               	fbQuestion_hitDetected:
 1814               		.stabd	46,0,0
 166:fb_question.c **** 	uint8_t selectedQ = 0;
 1815               		.stabn	68,0,166,.LM203-.LFBB16
 1816               	.LM203:
 1817               	.LFBB16:
 1818               	/* prologue: function */
 1819               	/* frame size = 0 */
 1820               	/* stack size = 0 */
 1821               	.L__stack_usage = 0
 169:fb_question.c **** 		selectedQ = 1;
 1822               		.stabn	68,0,169,.LM204-.LFBB16
 1823               	.LM204:
 1824 06ae 8091 0000 		lds r24,p_nowSprite
 1825 06b2 9091 0000 		lds r25,p_nowSprite+1
 1826 06b6 20E0      		ldi r18,hi8(spriteQ)
 1827 06b8 8030      		cpi r24,lo8(spriteQ)
 1828 06ba 9207      		cpc r25,r18
 1829 06bc 01F0      		breq .L85
 172:fb_question.c **** 		selectedQ = 3;
 1830               		.stabn	68,0,172,.LM205-.LFBB16
 1831               	.LM205:
 1832 06be 20E0      		ldi r18,hi8(spriteQUESTION3)
 1833 06c0 8030      		cpi r24,lo8(spriteQUESTION3)
 1834 06c2 9207      		cpc r25,r18
 1835 06c4 01F4      		brne .L90
 179:fb_question.c **** 		p_nowSprite = &spriteSOLIDBUMP3;
 1836               		.stabn	68,0,179,.LM206-.LFBB16
 1837               	.LM206:
 1838 06c6 83E0      		ldi r24,lo8(3)
 1839 06c8 8093 0000 		sts qVersion,r24
 180:fb_question.c **** 	}
 1840               		.stabn	68,0,180,.LM207-.LFBB16
 1841               	.LM207:
 1842 06cc 80E0      		ldi r24,lo8(spriteSOLIDBUMP3)
 1843 06ce 90E0      		ldi r25,hi8(spriteSOLIDBUMP3)
 1844               	.L91:
 198:fb_question.c **** 	}
 1845               		.stabn	68,0,198,.LM208-.LFBB16
 1846               	.LM208:
 1847 06d0 9093 0000 		sts p_nowSprite+1,r25
 1848 06d4 8093 0000 		sts p_nowSprite,r24
 1849               	.L88:
 208:fb_question.c **** }
 1850               		.stabn	68,0,208,.LM209-.LFBB16
 1851               	.LM209:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 88


 1852 06d8 8091 0000 		lds r24,p_nowSprite
 1853 06dc 9091 0000 		lds r25,p_nowSprite+1
 1854 06e0 00C0      		rjmp initSpriteStates
 1855               	.L85:
 186:fb_question.c **** 		p_nowSprite = &spriteSOLIDBUMP;
 1856               		.stabn	68,0,186,.LM210-.LFBB16
 1857               	.LM210:
 1858 06e2 81E0      		ldi r24,lo8(1)
 1859 06e4 8093 0000 		sts qVersion,r24
 187:fb_question.c **** 	}
 1860               		.stabn	68,0,187,.LM211-.LFBB16
 1861               	.LM211:
 1862 06e8 80E0      		ldi r24,lo8(spriteSOLIDBUMP)
 1863 06ea 90E0      		ldi r25,hi8(spriteSOLIDBUMP)
 1864 06ec 00C0      		rjmp .L91
 1865               	.L90:
 195:fb_question.c **** 			&& ((nowSpriteState.count > 16) && (nowSpriteState.count < 62)))
 1866               		.stabn	68,0,195,.LM212-.LFBB16
 1867               	.LM212:
 1868 06ee 8050      		subi r24,lo8(spriteGOOMBA)
 1869 06f0 9040      		sbci r25,hi8(spriteGOOMBA)
 1870 06f2 01F4      		brne .L88
 196:fb_question.c **** 	{
 1871               		.stabn	68,0,196,.LM213-.LFBB16
 1872               	.LM213:
 1873 06f4 8091 0000 		lds r24,nowSpriteState+4
 1874 06f8 8151      		subi r24,lo8(-(-17))
 1875 06fa 8D32      		cpi r24,lo8(45)
 1876 06fc 00F4      		brsh .L88
 198:fb_question.c **** 	}
 1877               		.stabn	68,0,198,.LM214-.LFBB16
 1878               	.LM214:
 1879 06fe 80E0      		ldi r24,lo8(spriteDEADGOOMBA)
 1880 0700 90E0      		ldi r25,hi8(spriteDEADGOOMBA)
 1881 0702 00C0      		rjmp .L91
 1882               		.size	fbQuestion_hitDetected, .-fbQuestion_hitDetected
 1883               	.Lscope16:
 1884               		.stabs	"",36,0,0,.Lscope16-.LFBB16
 1885               		.stabd	78,0,0
 1886               		.stabs	"__vector_2:F(0,47)",36,0,76,__vector_2
 1887               	.global	__vector_2
 1888               		.type	__vector_2, @function
 1889               	__vector_2:
 1890               		.stabd	46,0,0
 1891               		.stabs	"_hitSensors/bumpSwitch.c",132,0,0,.Ltext16
 1892               	.Ltext16:
  72:_hitSensors/bumpSwitch.c **** 
  73:_hitSensors/bumpSwitch.c **** }
  74:_hitSensors/bumpSwitch.c **** 
  75:_hitSensors/bumpSwitch.c **** 
  76:_hitSensors/bumpSwitch.c **** SIGNAL(PCINT_vect)
  77:_hitSensors/bumpSwitch.c **** {
 1893               		.stabn	68,0,77,.LM215-.LFBB17
 1894               	.LM215:
 1895               	.LFBB17:
 1896 0704 1F92      		push r1
 1897 0706 0F92      		push r0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 89


 1898 0708 0FB6      		in r0,__SREG__
 1899 070a 0F92      		push r0
 1900 070c 1124      		clr __zero_reg__
 1901 070e 2F93      		push r18
 1902 0710 3F93      		push r19
 1903 0712 4F93      		push r20
 1904 0714 5F93      		push r21
 1905 0716 6F93      		push r22
 1906 0718 7F93      		push r23
 1907 071a 8F93      		push r24
 1908 071c 9F93      		push r25
 1909 071e AF93      		push r26
 1910 0720 BF93      		push r27
 1911 0722 EF93      		push r30
 1912 0724 FF93      		push r31
 1913               	/* prologue: Signal */
 1914               	/* frame size = 0 */
 1915               	/* stack size = 15 */
 1916               	.L__stack_usage = 15
  78:_hitSensors/bumpSwitch.c **** 	fbQuestion_hitDetected();	
 1917               		.stabn	68,0,78,.LM216-.LFBB17
 1918               	.LM216:
 1919 0726 00D0      		rcall fbQuestion_hitDetected
  79:_hitSensors/bumpSwitch.c **** 
  80:_hitSensors/bumpSwitch.c **** 	//Not certain this is the best way to handle this...
  81:_hitSensors/bumpSwitch.c **** 	//BOUNCE is INHERENT
  82:_hitSensors/bumpSwitch.c **** 	//So clear the interrupt again, even though it was cleared upon entry of
  83:_hitSensors/bumpSwitch.c **** 	//the interrupt-vector
  84:_hitSensors/bumpSwitch.c **** 	// (Will this prevent reentry to this interrupt if the bounce occurred
  85:_hitSensors/bumpSwitch.c **** 	// before it exitted and sei()ed at the end?
  86:_hitSensors/bumpSwitch.c **** 	setbit(PCIF, GIFR);
 1920               		.stabn	68,0,86,.LM217-.LFBB17
 1921               	.LM217:
 1922 0728 8AB7      		in r24,0x3a
 1923 072a 8062      		ori r24,lo8(32)
 1924 072c 8ABF      		out 0x3a,r24
 1925               	/* epilogue start */
  87:_hitSensors/bumpSwitch.c **** }
 1926               		.stabn	68,0,87,.LM218-.LFBB17
 1927               	.LM218:
 1928 072e FF91      		pop r31
 1929 0730 EF91      		pop r30
 1930 0732 BF91      		pop r27
 1931 0734 AF91      		pop r26
 1932 0736 9F91      		pop r25
 1933 0738 8F91      		pop r24
 1934 073a 7F91      		pop r23
 1935 073c 6F91      		pop r22
 1936 073e 5F91      		pop r21
 1937 0740 4F91      		pop r20
 1938 0742 3F91      		pop r19
 1939 0744 2F91      		pop r18
 1940 0746 0F90      		pop r0
 1941 0748 0FBE      		out __SREG__,r0
 1942 074a 0F90      		pop r0
 1943 074c 1F90      		pop r1
 1944 074e 1895      		reti
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 90


 1945               		.size	__vector_2, .-__vector_2
 1946               	.Lscope17:
 1947               		.stabs	"",36,0,0,.Lscope17-.LFBB17
 1948               		.stabd	78,0,0
 1949               		.stabs	"prepReward:F(0,47)",36,0,211,prepReward
 1950               	.global	prepReward
 1951               		.type	prepReward, @function
 1952               	prepReward:
 1953               		.stabd	46,0,0
 1954               		.stabs	"fb_question.c",132,0,0,.Ltext17
 1955               	.Ltext17:
 212:fb_question.c **** 	if(qVersion == 1)
 1956               		.stabn	68,0,212,.LM219-.LFBB18
 1957               	.LM219:
 1958               	.LFBB18:
 1959 0750 CF93      		push r28
 1960               	/* prologue: function */
 1961               	/* frame size = 0 */
 1962               	/* stack size = 1 */
 1963               	.L__stack_usage = 1
 213:fb_question.c **** 	{
 1964               		.stabn	68,0,213,.LM220-.LFBB18
 1965               	.LM220:
 1966 0752 8091 0000 		lds r24,qVersion
 1967 0756 8130      		cpi r24,lo8(1)
 1968 0758 01F4      		brne .L94
 1969               	.LBB98:
 226:fb_question.c **** 			//Don't allow double-goombas
 1970               		.stabn	68,0,226,.LM221-.LFBB18
 1971               	.LM221:
 1972 075a CCE0      		ldi r28,lo8(12)
 1973               	.L107:
 1974 075c 00D0      		rcall pseudoRandom
 1975 075e 6C2F      		mov r22,r28
 1976 0760 00D0      		rcall __udivmodqi4
 1977 0762 892F      		mov r24,r25
 228:fb_question.c **** 
 1978               		.stabn	68,0,228,.LM222-.LFBB18
 1979               	.LM222:
 1980 0764 9091 0000 		lds r25,lastReward.2322
 1981 0768 9430      		cpi r25,lo8(4)
 1982 076a 01F0      		breq .L95
 1983               	.L106:
 230:fb_question.c **** #endif
 1984               		.stabn	68,0,230,.LM223-.LFBB18
 1985               	.LM223:
 1986 076c 8093 0000 		sts lastReward.2322,r24
 233:fb_question.c **** 		{
 1987               		.stabn	68,0,233,.LM224-.LFBB18
 1988               	.LM224:
 1989 0770 90E0      		ldi r25,0
 1990 0772 8930      		cpi r24,9
 1991 0774 9105      		cpc r25,__zero_reg__
 1992 0776 00F0      		brlo .+2
 1993 0778 00C0      		rjmp .L110
 1994 077a FC01      		movw r30,r24
 1995 077c E050      		subi r30,lo8(-(gs(.L98)))
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 91


 1996 077e F040      		sbci r31,hi8(-(gs(.L98)))
 1997 0780 0994      		ijmp
 1998               		.section	.progmem.gcc_sw_table,"ax",@progbits
 1999               		.p2align	1
 2000               	.L98:
 2001 0000 00C0      		rjmp .L97
 2002 0002 00C0      		rjmp .L99
 2003 0004 00C0      		rjmp .L100
 2004 0006 00C0      		rjmp .L101
 2005 0008 00C0      		rjmp .L102
 2006 000a 00C0      		rjmp .L110
 2007 000c 00C0      		rjmp .L113
 2008 000e 00C0      		rjmp .L104
 2009 0010 00C0      		rjmp .L105
 2010               		.text
 2011               	.L95:
 228:fb_question.c **** 
 2012               		.stabn	68,0,228,.LM225-.LFBB18
 2013               	.LM225:
 2014 0782 8430      		cpi r24,lo8(4)
 2015 0784 01F0      		breq .L107
 2016 0786 00C0      		rjmp .L106
 2017               	.L97:
 236:fb_question.c **** 				break;
 2018               		.stabn	68,0,236,.LM226-.LFBB18
 2019               	.LM226:
 2020 0788 80E0      		ldi r24,lo8(spriteFLOWER)
 2021 078a 90E0      		ldi r25,hi8(spriteFLOWER)
 2022 078c 00C0      		rjmp .L122
 2023               	.L99:
 239:fb_question.c **** 				break;
 2024               		.stabn	68,0,239,.LM227-.LFBB18
 2025               	.LM227:
 2026 078e 80E0      		ldi r24,lo8(sprite1UP)
 2027 0790 90E0      		ldi r25,hi8(sprite1UP)
 2028 0792 00C0      		rjmp .L122
 2029               	.L100:
 242:fb_question.c **** 				break;
 2030               		.stabn	68,0,242,.LM228-.LFBB18
 2031               	.LM228:
 2032 0794 80E0      		ldi r24,lo8(spriteBIG)
 2033 0796 90E0      		ldi r25,hi8(spriteBIG)
 2034 0798 00C0      		rjmp .L122
 2035               	.L101:
 245:fb_question.c **** 				break;
 2036               		.stabn	68,0,245,.LM229-.LFBB18
 2037               	.LM229:
 2038 079a 80E0      		ldi r24,lo8(spriteSTAR)
 2039 079c 90E0      		ldi r25,hi8(spriteSTAR)
 2040 079e 00C0      		rjmp .L122
 2041               	.L102:
 248:fb_question.c **** 				break;
 2042               		.stabn	68,0,248,.LM230-.LFBB18
 2043               	.LM230:
 2044 07a0 80E0      		ldi r24,lo8(spriteGOOMBA)
 2045 07a2 90E0      		ldi r25,hi8(spriteGOOMBA)
 2046 07a4 00C0      		rjmp .L122
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 92


 2047               	.L104:
 254:fb_question.c **** 				break;
 2048               		.stabn	68,0,254,.LM231-.LFBB18
 2049               	.LM231:
 2050 07a6 80E0      		ldi r24,lo8(spriteMARIO)
 2051 07a8 90E0      		ldi r25,hi8(spriteMARIO)
 2052 07aa 00C0      		rjmp .L122
 2053               	.L105:
 257:fb_question.c **** 				break;
 2054               		.stabn	68,0,257,.LM232-.LFBB18
 2055               	.LM232:
 2056 07ac 80E0      		ldi r24,lo8(spriteLUIGI)
 2057 07ae 90E0      		ldi r25,hi8(spriteLUIGI)
 2058 07b0 00C0      		rjmp .L122
 2059               	.L94:
 2060               	.LBE98:
 268:fb_question.c **** 	{
 2061               		.stabn	68,0,268,.LM233-.LFBB18
 2062               	.LM233:
 2063 07b2 8330      		cpi r24,lo8(3)
 2064 07b4 01F4      		brne .L93
 2065               	.LBB99:
 276:fb_question.c **** #endif
 2066               		.stabn	68,0,276,.LM234-.LFBB18
 2067               	.LM234:
 2068 07b6 00D0      		rcall pseudoRandom
 2069 07b8 6CE0      		ldi r22,lo8(12)
 2070 07ba 00D0      		rcall __udivmodqi4
 279:fb_question.c **** 		{
 2071               		.stabn	68,0,279,.LM235-.LFBB18
 2072               	.LM235:
 2073 07bc 892F      		mov r24,r25
 2074 07be 90E0      		ldi r25,0
 2075 07c0 8930      		cpi r24,9
 2076 07c2 9105      		cpc r25,__zero_reg__
 2077 07c4 00F4      		brsh .L110
 2078 07c6 FC01      		movw r30,r24
 2079 07c8 E050      		subi r30,lo8(-(gs(.L112)))
 2080 07ca F040      		sbci r31,hi8(-(gs(.L112)))
 2081 07cc 0994      		ijmp
 2082               		.section	.progmem.gcc_sw_table,"ax",@progbits
 2083               		.p2align	1
 2084               	.L112:
 2085 0012 00C0      		rjmp .L111
 2086 0014 00C0      		rjmp .L113
 2087 0016 00C0      		rjmp .L114
 2088 0018 00C0      		rjmp .L115
 2089 001a 00C0      		rjmp .L116
 2090 001c 00C0      		rjmp .L117
 2091 001e 00C0      		rjmp .L118
 2092 0020 00C0      		rjmp .L110
 2093 0022 00C0      		rjmp .L119
 2094               		.text
 2095               	.L111:
 282:fb_question.c **** 				break;
 2096               		.stabn	68,0,282,.LM236-.LFBB18
 2097               	.LM236:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 93


 2098 07ce 80E0      		ldi r24,lo8(spriteLEAF)
 2099 07d0 90E0      		ldi r25,hi8(spriteLEAF)
 2100 07d2 00C0      		rjmp .L122
 2101               	.L113:
 285:fb_question.c **** 				break;
 2102               		.stabn	68,0,285,.LM237-.LFBB18
 2103               	.LM237:
 2104 07d4 80E0      		ldi r24,lo8(spriteCLOUD)
 2105 07d6 90E0      		ldi r25,hi8(spriteCLOUD)
 2106 07d8 00C0      		rjmp .L122
 2107               	.L114:
 288:fb_question.c **** 				break;
 2108               		.stabn	68,0,288,.LM238-.LFBB18
 2109               	.LM238:
 2110 07da 80E0      		ldi r24,lo8(spriteTANOOKI)
 2111 07dc 90E0      		ldi r25,hi8(spriteTANOOKI)
 2112 07de 00C0      		rjmp .L122
 2113               	.L115:
 291:fb_question.c **** 				break;
 2114               		.stabn	68,0,291,.LM239-.LFBB18
 2115               	.LM239:
 2116 07e0 80E0      		ldi r24,lo8(spriteFROG)
 2117 07e2 90E0      		ldi r25,hi8(spriteFROG)
 2118 07e4 00C0      		rjmp .L122
 2119               	.L116:
 294:fb_question.c **** 				break;
 2120               		.stabn	68,0,294,.LM240-.LFBB18
 2121               	.LM240:
 2122 07e6 80E0      		ldi r24,lo8(spriteBOOT)
 2123 07e8 90E0      		ldi r25,hi8(spriteBOOT)
 2124 07ea 00C0      		rjmp .L122
 2125               	.L117:
 297:fb_question.c **** 				break;
 2126               		.stabn	68,0,297,.LM241-.LFBB18
 2127               	.LM241:
 2128 07ec 80E0      		ldi r24,lo8(spriteHAMMER)
 2129 07ee 90E0      		ldi r25,hi8(spriteHAMMER)
 2130 07f0 00C0      		rjmp .L122
 2131               	.L118:
 300:fb_question.c **** 				break;
 2132               		.stabn	68,0,300,.LM242-.LFBB18
 2133               	.LM242:
 2134 07f2 80E0      		ldi r24,lo8(spritePWING)
 2135 07f4 90E0      		ldi r25,hi8(spritePWING)
 2136 07f6 00C0      		rjmp .L122
 2137               	.L119:
 306:fb_question.c **** 				break;
 2138               		.stabn	68,0,306,.LM243-.LFBB18
 2139               	.LM243:
 2140 07f8 80E0      		ldi r24,lo8(spriteMUSICBOX)
 2141 07fa 90E0      		ldi r25,hi8(spriteMUSICBOX)
 2142 07fc 00C0      		rjmp .L122
 2143               	.L110:
 309:fb_question.c **** 				break;
 2144               		.stabn	68,0,309,.LM244-.LFBB18
 2145               	.LM244:
 2146 07fe 80E0      		ldi r24,lo8(spriteCOIN)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 94


 2147 0800 90E0      		ldi r25,hi8(spriteCOIN)
 2148               	.L122:
 2149 0802 9093 0000 		sts p_nowSprite+1,r25
 2150 0806 8093 0000 		sts p_nowSprite,r24
 313:fb_question.c **** 		initSpriteStates(p_nowSprite);
 2151               		.stabn	68,0,313,.LM245-.LFBB18
 2152               	.LM245:
 2153 080a 8091 0000 		lds r24,qVersion
 2154 080e 8093 0000 		sts nowIsReward,r24
 314:fb_question.c **** 	}
 2155               		.stabn	68,0,314,.LM246-.LFBB18
 2156               	.LM246:
 2157 0812 8091 0000 		lds r24,p_nowSprite
 2158 0816 9091 0000 		lds r25,p_nowSprite+1
 2159               	/* epilogue start */
 2160               	.LBE99:
 319:fb_question.c **** 
 2161               		.stabn	68,0,319,.LM247-.LFBB18
 2162               	.LM247:
 2163 081a CF91      		pop r28
 2164               	.LBB100:
 314:fb_question.c **** 	}
 2165               		.stabn	68,0,314,.LM248-.LFBB18
 2166               	.LM248:
 2167 081c 00C0      		rjmp initSpriteStates
 2168               	.L93:
 2169               	/* epilogue start */
 2170               	.LBE100:
 319:fb_question.c **** 
 2171               		.stabn	68,0,319,.LM249-.LFBB18
 2172               	.LM249:
 2173 081e CF91      		pop r28
 2174 0820 0895      		ret
 2175               		.size	prepReward, .-prepReward
 2176               		.stabs	"lastReward:V(4,2)",40,0,220,lastReward.2322
 2177               		.stabn	192,0,0,.LBB98-.LFBB18
 2178               		.stabn	224,0,0,.LBE98-.LFBB18
 2179               	.Lscope18:
 2180               		.stabs	"",36,0,0,.Lscope18-.LFBB18
 2181               		.stabd	78,0,0
 2182               		.stabs	"prepNextSprite:F(0,47)",36,0,336,prepNextSprite
 2183               	.global	prepNextSprite
 2184               		.type	prepNextSprite, @function
 2185               	prepNextSprite:
 2186               		.stabd	46,0,0
 337:fb_question.c **** 	//a/o v84:
 2187               		.stabn	68,0,337,.LM250-.LFBB19
 2188               	.LM250:
 2189               	.LFBB19:
 2190               	/* prologue: function */
 2191               	/* frame size = 0 */
 2192               	/* stack size = 0 */
 2193               	.L__stack_usage = 0
 349:fb_question.c **** 		selectedQ = 1;
 2194               		.stabn	68,0,349,.LM251-.LFBB19
 2195               	.LM251:
 2196 0822 8091 0000 		lds r24,p_nowSprite
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 95


 2197 0826 9091 0000 		lds r25,p_nowSprite+1
 2198 082a 20E0      		ldi r18,hi8(spriteQ)
 2199 082c 8030      		cpi r24,lo8(spriteQ)
 2200 082e 9207      		cpc r25,r18
 2201 0830 01F0      		breq .L125
 352:fb_question.c **** 		selectedQ = 3;
 2202               		.stabn	68,0,352,.LM252-.LFBB19
 2203               	.LM252:
 2204 0832 20E0      		ldi r18,hi8(spriteQUESTION3)
 2205 0834 8030      		cpi r24,lo8(spriteQUESTION3)
 2206 0836 9207      		cpc r25,r18
 2207 0838 01F0      		breq .L125
 370:fb_question.c **** #ifdef __QUESTION3_H__
 2208               		.stabn	68,0,370,.LM253-.LFBB19
 2209               	.LM253:
 2210 083a 20E0      		ldi r18,hi8(spriteSOLIDBUMP)
 2211 083c 8030      		cpi r24,lo8(spriteSOLIDBUMP)
 2212 083e 9207      		cpc r25,r18
 2213 0840 01F0      		breq .L135
 372:fb_question.c **** #endif
 2214               		.stabn	68,0,372,.LM254-.LFBB19
 2215               	.LM254:
 2216 0842 20E0      		ldi r18,hi8(spriteSOLIDBUMP3)
 2217 0844 8030      		cpi r24,lo8(spriteSOLIDBUMP3)
 2218 0846 9207      		cpc r25,r18
 2219 0848 01F4      		brne .L127
 2220               	.L135:
 376:fb_question.c **** 	}
 2221               		.stabn	68,0,376,.LM255-.LFBB19
 2222               	.LM255:
 2223 084a 00D0      		rcall prepReward
 2224               	.L125:
 423:fb_question.c **** }
 2225               		.stabn	68,0,423,.LM256-.LFBB19
 2226               	.LM256:
 2227 084c 8091 0000 		lds r24,p_nowSprite
 2228 0850 9091 0000 		lds r25,p_nowSprite+1
 2229 0854 00C0      		rjmp initSpriteStates
 2230               	.L127:
 379:fb_question.c **** 	{
 2231               		.stabn	68,0,379,.LM257-.LFBB19
 2232               	.LM257:
 2233 0856 20E0      		ldi r18,hi8(spriteMARIO)
 2234 0858 8030      		cpi r24,lo8(spriteMARIO)
 2235 085a 9207      		cpc r25,r18
 2236 085c 01F4      		brne .L128
 382:fb_question.c **** 	}
 2237               		.stabn	68,0,382,.LM258-.LFBB19
 2238               	.LM258:
 2239 085e 80E0      		ldi r24,lo8(spriteMARIORUNS)
 2240 0860 90E0      		ldi r25,hi8(spriteMARIORUNS)
 2241 0862 00C0      		rjmp .L152
 2242               	.L128:
 385:fb_question.c **** 	{
 2243               		.stabn	68,0,385,.LM259-.LFBB19
 2244               	.LM259:
 2245 0864 20E0      		ldi r18,hi8(spriteLUIGI)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 96


 2246 0866 8030      		cpi r24,lo8(spriteLUIGI)
 2247 0868 9207      		cpc r25,r18
 2248 086a 01F4      		brne .L129
 388:fb_question.c **** 	}
 2249               		.stabn	68,0,388,.LM260-.LFBB19
 2250               	.LM260:
 2251 086c 80E0      		ldi r24,lo8(spriteLUIGIRUNS)
 2252 086e 90E0      		ldi r25,hi8(spriteLUIGIRUNS)
 2253 0870 00C0      		rjmp .L152
 2254               	.L129:
 391:fb_question.c **** #ifdef __QUESTION3_H__
 2255               		.stabn	68,0,391,.LM261-.LFBB19
 2256               	.LM261:
 2257 0872 20E0      		ldi r18,hi8(spriteSOLID)
 2258 0874 8030      		cpi r24,lo8(spriteSOLID)
 2259 0876 9207      		cpc r25,r18
 2260 0878 01F0      		breq .L130
 393:fb_question.c **** #endif
 2261               		.stabn	68,0,393,.LM262-.LFBB19
 2262               	.LM262:
 2263 087a 8050      		subi r24,lo8(spriteSOLID3)
 2264 087c 9040      		sbci r25,hi8(spriteSOLID3)
 2265 087e 01F4      		brne .L131
 2266               	.L130:
 397:fb_question.c **** #if(!defined(RANDOM_OVERRIDE))
 2267               		.stabn	68,0,397,.LM263-.LFBB19
 2268               	.LM263:
 2269 0880 1092 0000 		sts nowIsReward,__zero_reg__
 400:fb_question.c **** 			p_nowSprite = &spriteQUESTION3;
 2270               		.stabn	68,0,400,.LM264-.LFBB19
 2271               	.LM264:
 2272 0884 00D0      		rcall pseudoRandom
 2273 0886 80FF      		sbrs r24,0
 2274 0888 00C0      		rjmp .L132
 401:fb_question.c **** 		else
 2275               		.stabn	68,0,401,.LM265-.LFBB19
 2276               	.LM265:
 2277 088a 80E0      		ldi r24,lo8(spriteQUESTION3)
 2278 088c 90E0      		ldi r25,hi8(spriteQUESTION3)
 2279               	.L152:
 2280 088e 9093 0000 		sts p_nowSprite+1,r25
 2281 0892 8093 0000 		sts p_nowSprite,r24
 2282 0896 00C0      		rjmp .L125
 2283               	.L132:
 404:fb_question.c **** #else	//RANDOM_OVERRIDE
 2284               		.stabn	68,0,404,.LM266-.LFBB19
 2285               	.LM266:
 2286 0898 80E0      		ldi r24,lo8(spriteQ)
 2287 089a 90E0      		ldi r25,hi8(spriteQ)
 2288 089c 00C0      		rjmp .L152
 2289               	.L131:
 413:fb_question.c **** 			p_nowSprite = &spriteSOLID3;
 2290               		.stabn	68,0,413,.LM267-.LFBB19
 2291               	.LM267:
 2292 089e 8091 0000 		lds r24,nowIsReward
 2293 08a2 8330      		cpi r24,lo8(3)
 2294 08a4 01F4      		brne .L133
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 97


 414:fb_question.c **** 		else
 2295               		.stabn	68,0,414,.LM268-.LFBB19
 2296               	.LM268:
 2297 08a6 80E0      		ldi r24,lo8(spriteSOLID3)
 2298 08a8 90E0      		ldi r25,hi8(spriteSOLID3)
 2299 08aa 00C0      		rjmp .L151
 2300               	.L133:
 417:fb_question.c **** 
 2301               		.stabn	68,0,417,.LM269-.LFBB19
 2302               	.LM269:
 2303 08ac 80E0      		ldi r24,lo8(spriteSOLID)
 2304 08ae 90E0      		ldi r25,hi8(spriteSOLID)
 2305               	.L151:
 2306 08b0 9093 0000 		sts p_nowSprite+1,r25
 2307 08b4 8093 0000 		sts p_nowSprite,r24
 419:fb_question.c **** //		p_nowSprite = &spriteSOLID;
 2308               		.stabn	68,0,419,.LM270-.LFBB19
 2309               	.LM270:
 2310 08b8 1092 0000 		sts nowIsReward,__zero_reg__
 2311 08bc 00C0      		rjmp .L125
 2312               		.size	prepNextSprite, .-prepNextSprite
 2313               	.Lscope19:
 2314               		.stabs	"",36,0,0,.Lscope19-.LFBB19
 2315               		.stabd	78,0,0
 2316               		.stabs	"fbQ_drawBackground:F(0,47)",36,0,533,fbQ_drawBackground
 2317               		.stabs	"state:P(0,49)",64,0,533,24
 2318               	.global	fbQ_drawBackground
 2319               		.type	fbQ_drawBackground, @function
 2320               	fbQ_drawBackground:
 2321               		.stabd	46,0,0
 462:fb_question.c **** 
 463:fb_question.c **** 
 464:fb_question.c **** 	//This is only used by the SOLID in the background for Reward...
 465:fb_question.c **** 	// So probably never changes...
 466:fb_question.c **** 	//otherSpriteState.hFlip = NadaFlip;
 467:fb_question.c **** 	//otherSpriteState.motion = NadaMotion;
 468:fb_question.c **** 
 469:fb_question.c **** #if 0
 470:fb_question.c **** 		//DEADGOOMBA -> Question-Box (directly)
 471:fb_question.c **** 		if(p_selectedSprite == &spriteDEADGOOMBA)
 472:fb_question.c **** 		{
 473:fb_question.c **** 			if(qCount >= 16)
 474:fb_question.c **** 			{
 475:fb_question.c **** 				qCount = Q_QSTART; //0;
 476:fb_question.c **** 				p_nextSprite = &spriteQ;
 477:fb_question.c **** 			}
 478:fb_question.c **** 		}
 479:fb_question.c **** 		//GOOMBA -> SOLID
 480:fb_question.c **** 		else if(p_selectedSprite == &spriteGOOMBA)
 481:fb_question.c **** 		{
 482:fb_question.c **** 			if(qCount >= GOOMBA_QCOUNT)
 483:fb_question.c **** 			{
 484:fb_question.c **** 				qCount = 0;
 485:fb_question.c **** 				p_nextSprite = &spriteSOLID;
 486:fb_question.c **** 			}
 487:fb_question.c **** 		}
 488:fb_question.c **** 		//COIN -> SOLID
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 98


 489:fb_question.c **** 		else if(p_selectedSprite == &spriteCOIN)
 490:fb_question.c **** 		{
 491:fb_question.c **** 			if(qCount >= 8)
 492:fb_question.c **** 			{
 493:fb_question.c **** 				qCount = 0;
 494:fb_question.c **** 				p_nextSprite = &spriteSOLID;
 495:fb_question.c **** 			}
 496:fb_question.c **** 		}
 497:fb_question.c **** 		//SOLID -> Question-Box
 498:fb_question.c **** 		else if(p_selectedSprite == &spriteSOLID)
 499:fb_question.c **** 		{
 500:fb_question.c **** 			if(qCount >= 8)
 501:fb_question.c **** 			{
 502:fb_question.c **** 				qCount = Q_QSTART; //0;
 503:fb_question.c **** 				p_selectedSprite = &spriteQ;
 504:fb_question.c **** 			}
 505:fb_question.c **** 		}
 506:fb_question.c **** 		//**OTHERS** (NOT Question-Box) -> SOLID
 507:fb_question.c **** 		else if(p_selectedSprite != &spriteQ)
 508:fb_question.c **** 		{
 509:fb_question.c **** 			if(qCount >= 16)
 510:fb_question.c **** 			{
 511:fb_question.c **** 				qCount = 0;
 512:fb_question.c **** 				//if(p_selectedSprite != &spriteSOLID)
 513:fb_question.c **** 				p_nextSprite = &spriteSOLID;
 514:fb_question.c **** 				//else
 515:fb_question.c **** 				//   p_selectedSprite = &spriteQ;
 516:fb_question.c **** 			}
 517:fb_question.c **** 		}
 518:fb_question.c **** #endif //0
 519:fb_question.c **** }
 520:fb_question.c **** #endif //!STAY_ON_IT
 521:fb_question.c **** 
 522:fb_question.c **** 
 523:fb_question.c **** 
 524:fb_question.c **** // NEW MOTION-HANDLING...
 525:fb_question.c **** 
 526:fb_question.c **** 
 527:fb_question.c **** 
 528:fb_question.c **** 
 529:fb_question.c **** 
 530:fb_question.c **** 
 531:fb_question.c **** //This is sort-of Motion-Handling, as well...
 532:fb_question.c **** //Usually the sky...
 533:fb_question.c **** void fbQ_drawBackground(spriteState_t *state)
 534:fb_question.c **** {
 2322               		.stabn	68,0,534,.LM271-.LFBB20
 2323               	.LM271:
 2324               	.LFBB20:
 2325               	/* prologue: function */
 2326               	/* frame size = 0 */
 2327               	/* stack size = 0 */
 2328               	.L__stack_usage = 0
 535:fb_question.c **** 	//I can't recall how this used to work...
 536:fb_question.c **** 	//uint8_t paletteForColor = getSpritePalette(&spriteLEAF, 0, 0);
 537:fb_question.c **** 	uint8_t paletteForColor = state->paletteNum;
 538:fb_question.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 99


 539:fb_question.c **** 
 540:fb_question.c **** 
 541:fb_question.c **** 	//probably should look into skyOverride
 542:fb_question.c **** 	// for now, use the sky-color of the leaf, which is at (0,0)
 543:fb_question.c **** 	//Fill the background with the sky-color...
 544:fb_question.c **** //#define FBQ_SKYCOLOR_OVERRIDE _R
 545:fb_question.c **** #if(defined(FBQ_SKYCOLOR_OVERRIDE))
 546:fb_question.c **** 	uint8_t skyColorData = FBQ_SKYCOLOR_OVERRIDE;
 547:fb_question.c **** #else
 548:fb_question.c **** 	//uint8_t skyColorData = getRawPixelVal(, 0, 0);
 549:fb_question.c **** 
 550:fb_question.c **** 	uint8_t skyColorData = rawPixValToGimpColorVal(0, 
 2329               		.stabn	68,0,550,.LM272-.LFBB20
 2330               	.LM272:
 2331 08be FC01      		movw r30,r24
 2332 08c0 6385      		ldd r22,Z+11
 2333 08c2 7485      		ldd r23,Z+12
 2334 08c4 4585      		ldd r20,Z+13
 2335 08c6 80E0      		ldi r24,0
 2336 08c8 00D0      		rcall rawPixValToGimpColorVal
 551:fb_question.c **** 														state->sprite,
 552:fb_question.c **** 														paletteForColor);
 553:fb_question.c **** 	skyColorData = gimpPixelValToLColor(skyColorData);
 2337               		.stabn	68,0,553,.LM273-.LFBB20
 2338               	.LM273:
 2339 08ca 282F      		mov r18,r24
 2340 08cc 2073      		andi r18,lo8(48)
 2341 08ce 30E0      		ldi r19,0
 2342 08d0 2032      		cpi r18,32
 2343 08d2 3105      		cpc r19,__zero_reg__
 2344 08d4 04F0      		brlt .L154
 2345               		.stabn	68,0,553,.LM274-.LFBB20
 2346               	.LM274:
 2347 08d6 805F      		subi r24,lo8(-(16))
 2348               	.L154:
 2349 08d8 40E0      		ldi r20,lo8(frameBuffer)
 2350 08da 50E0      		ldi r21,hi8(frameBuffer)
 2351               	.L155:
 534:fb_question.c **** 	//I can't recall how this used to work...
 2352               		.stabn	68,0,534,.LM275-.LFBB20
 2353               	.LM275:
 2354 08dc 20E0      		ldi r18,0
 2355 08de 30E0      		ldi r19,0
 2356               	.L158:
 2357 08e0 FA01      		movw r30,r20
 2358 08e2 E20F      		add r30,r18
 2359 08e4 F31F      		adc r31,r19
 554:fb_question.c **** #endif
 555:fb_question.c **** 
 556:fb_question.c **** 
 557:fb_question.c **** 	int8_t camRow, camCol;
 558:fb_question.c **** 
 559:fb_question.c **** 	for(camRow = 0; camRow<FB_HEIGHT; camRow++)
 560:fb_question.c **** 	{
 561:fb_question.c **** 		for(camCol = 0; camCol<FB_WIDTH; camCol++)
 562:fb_question.c **** 		{
 563:fb_question.c **** #if(defined(FBQ_RAINBOW_SKY) && FBQ_RAINBOW_SKY)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 100


 564:fb_question.c **** 			frameBuffer[camRow][camCol] = (camRow+camCol)&0x3f;//skyColorData;
 565:fb_question.c **** #else
 566:fb_question.c **** 			frameBuffer[camRow][camCol] = skyColorData;
 2360               		.stabn	68,0,566,.LM276-.LFBB20
 2361               	.LM276:
 2362 08e6 8083      		st Z,r24
 2363 08e8 2F5F      		subi r18,-1
 2364 08ea 3F4F      		sbci r19,-1
 561:fb_question.c **** 		{
 2365               		.stabn	68,0,561,.LM277-.LFBB20
 2366               	.LM277:
 2367 08ec 2031      		cpi r18,16
 2368 08ee 3105      		cpc r19,__zero_reg__
 2369 08f0 01F4      		brne .L158
 2370 08f2 4F5E      		subi r20,-17
 2371 08f4 5F4F      		sbci r21,-1
 559:fb_question.c **** 	{
 2372               		.stabn	68,0,559,.LM278-.LFBB20
 2373               	.LM278:
 2374 08f6 F0E0      		ldi r31,hi8(frameBuffer+272)
 2375 08f8 4030      		cpi r20,lo8(frameBuffer+272)
 2376 08fa 5F07      		cpc r21,r31
 2377 08fc 01F4      		brne .L155
 2378 08fe 0895      		ret
 2379               		.size	fbQ_drawBackground, .-fbQ_drawBackground
 2380               		.stabs	"skyColorData:r(4,2)",64,0,550,24
 2381               		.stabn	192,0,0,.LFBB20-.LFBB20
 2382               		.stabn	224,0,0,.Lscope20-.LFBB20
 2383               	.Lscope20:
 2384               		.stabs	"",36,0,0,.Lscope20-.LFBB20
 2385               		.stabd	78,0,0
 2386               		.stabs	"fbQuestion_update:F(4,1)",36,0,579,fbQuestion_update
 2387               	.global	fbQuestion_update
 2388               		.type	fbQuestion_update, @function
 2389               	fbQuestion_update:
 2390               		.stabd	46,0,0
 567:fb_question.c **** #endif
 568:fb_question.c **** 
 569:fb_question.c **** 			//Should look into framebuffer-changed stuff, here...
 570:fb_question.c **** 		}
 571:fb_question.c **** 	}
 572:fb_question.c **** }
 573:fb_question.c **** 
 574:fb_question.c **** 
 575:fb_question.c **** 
 576:fb_question.c **** //Returns the last image-row that has changed...
 577:fb_question.c **** // (for refresh-on-change and/or partial-refresh)
 578:fb_question.c **** // otherwise -1 if no change.
 579:fb_question.c **** int8_t fbQuestion_update(void) //uint8_t triggerDetected)
 580:fb_question.c **** {
 2391               		.stabn	68,0,580,.LM279-.LFBB21
 2392               	.LM279:
 2393               	.LFBB21:
 2394 0900 1F93      		push r17
 2395 0902 CF93      		push r28
 2396 0904 DF93      		push r29
 2397               	/* prologue: function */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 101


 2398               	/* frame size = 0 */
 2399               	/* stack size = 3 */
 2400               	.L__stack_usage = 3
 581:fb_question.c **** 	//last row that was changed...
 582:fb_question.c **** 	int8_t imageChangedTillRow = -1;
 583:fb_question.c **** 
 584:fb_question.c **** 
 585:fb_question.c **** #if(defined(FB_ENABLE_PAUSE)	&& FB_ENABLE_PAUSE)
 586:fb_question.c **** 	if(fb_paused)
 587:fb_question.c **** 		return -1;
 588:fb_question.c **** #endif	
 589:fb_question.c **** 
 590:fb_question.c **** 
 591:fb_question.c **** 
 592:fb_question.c **** 	//This is just used for helping to throw in some randomness for the next
 593:fb_question.c **** 	//sprite after a hit...
 594:fb_question.c **** 	callCount++;
 2401               		.stabn	68,0,594,.LM280-.LFBB21
 2402               	.LM280:
 2403 0906 8091 0000 		lds r24,callCount
 2404 090a 8F5F      		subi r24,lo8(-(1))
 2405 090c 8093 0000 		sts callCount,r24
 2406               	.LBB101:
 2407               	.LBB102:
 2408               		.stabs	"icons/iconPacking.h",132,0,0,.Ltext18
 2409               	.Ltext18:
 124:icons/iconPacking.h **** //	skyOverridePalette = palette;
 2410               		.stabn	68,0,124,.LM281-.LFBB21
 2411               	.LM281:
 2412 0910 8091 0000 		lds r24,p_nowSprite
 2413 0914 9091 0000 		lds r25,p_nowSprite+1
 2414 0918 9093 0000 		sts skyOverrideSprite+1,r25
 2415 091c 8093 0000 		sts skyOverrideSprite,r24
 2416               	.LBE102:
 2417               	.LBE101:
 2418               		.stabs	"fb_question.c",132,0,0,.Ltext19
 2419               	.Ltext19:
 595:fb_question.c **** 
 596:fb_question.c **** //   uint8_t qRow;
 597:fb_question.c **** 	
 598:fb_question.c **** 	//Check if it's time to select the next sprite, and do-so according to
 599:fb_question.c **** 	//which sprite we're on and which should follow it.
 600:fb_question.c **** 	//Most of the time, a sprite is followed by SOLID, but there are
 601:fb_question.c **** 	//exceptions...
 602:fb_question.c **** /*
 603:fb_question.c **** 	if(p_nextSprite == NULL)
 604:fb_question.c **** 	{
 605:fb_question.c **** 		prepNextSprite();
 606:fb_question.c **** 	}
 607:fb_question.c **** */
 608:fb_question.c **** 
 609:fb_question.c **** /*
 610:fb_question.c **** 	if(p_nextSprite != NULL)
 611:fb_question.c **** 	{
 612:fb_question.c **** */
 613:fb_question.c **** 		//a/o v84:
 614:fb_question.c **** 		//Is this necessary with motion handling, since the sky is drawn
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 102


 615:fb_question.c **** 		//separately???
 616:fb_question.c **** 		setSpriteSkyColorOverride(p_nowSprite);
 617:fb_question.c **** 
 618:fb_question.c **** 		//This isn't right, doesn't transition at all
 619:fb_question.c **** 		// it's just for testing the motion-scheme
 620:fb_question.c **** 		//Testing the new transition-scheme...
 621:fb_question.c **** /*
 622:fb_question.c **** #if(defined(MOTION_BIGGIE) && MOTION_BIGGIE)
 623:fb_question.c **** 		if(p_nextSprite == &spriteBIG)
 624:fb_question.c **** #else
 625:fb_question.c **** 		if(p_nextSprite == &spriteLEAF)
 626:fb_question.c **** #endif
 627:fb_question.c **** */
 628:fb_question.c **** 		//if(p_selectedSprite == &spriteLEAF) //NoGo
 629:fb_question.c **** 		{
 630:fb_question.c **** #if(defined(AUTO_KILL_GOOMBA) && AUTO_KILL_GOOMBA)
 631:fb_question.c **** 			if( (p_nowSprite == &spriteGOOMBA)
 632:fb_question.c **** 				 && (nowSpriteState.count >= 60) )
 633:fb_question.c **** 				fbQuestion_hitDetected();
 634:fb_question.c **** #endif
 635:fb_question.c **** 
 636:fb_question.c **** 
 637:fb_question.c **** 
 638:fb_question.c **** 			//Override for now...
 639:fb_question.c **** 			//otherSpriteState.count=0;
 640:fb_question.c **** 
 641:fb_question.c **** 			fbQ_drawBackground(&nowSpriteState);
 2420               		.stabn	68,0,641,.LM282-.LFBB21
 2421               	.LM282:
 2422 0920 80E0      		ldi r24,lo8(nowSpriteState)
 2423 0922 90E0      		ldi r25,hi8(nowSpriteState)
 2424 0924 00D0      		rcall fbQ_drawBackground
 642:fb_question.c **** 
 643:fb_question.c **** 			if(fbQ_repositionSprite(&nowSpriteState))
 2425               		.stabn	68,0,643,.LM283-.LFBB21
 2426               	.LM283:
 2427 0926 80E0      		ldi r24,lo8(nowSpriteState)
 2428 0928 90E0      		ldi r25,hi8(nowSpriteState)
 2429 092a 00D0      		rcall fbQ_repositionSprite
 2430 092c 8111      		cpse r24,__zero_reg__
 2431 092e 00C0      		rjmp .L172
 582:fb_question.c **** 
 2432               		.stabn	68,0,582,.LM284-.LFBB21
 2433               	.LM284:
 2434 0930 1FEF      		ldi r17,lo8(-1)
 2435 0932 00C0      		rjmp .L160
 2436               	.L172:
 644:fb_question.c **** 				imageChangedTillRow = FB_HEIGHT;
 2437               		.stabn	68,0,644,.LM285-.LFBB21
 2438               	.LM285:
 2439 0934 10E1      		ldi r17,lo8(16)
 2440               	.L160:
 645:fb_question.c **** 
 646:fb_question.c **** 			if(fbQ_repositionSprite(&cameraState))
 2441               		.stabn	68,0,646,.LM286-.LFBB21
 2442               	.LM286:
 2443 0936 80E0      		ldi r24,lo8(cameraState)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 103


 2444 0938 90E0      		ldi r25,hi8(cameraState)
 2445 093a 00D0      		rcall fbQ_repositionSprite
 2446 093c 8111      		cpse r24,__zero_reg__
 647:fb_question.c **** 				imageChangedTillRow = FB_HEIGHT;
 2447               		.stabn	68,0,647,.LM287-.LFBB21
 2448               	.LM287:
 2449 093e 10E1      		ldi r17,lo8(16)
 2450               	.L161:
 648:fb_question.c **** 			// "otherSpriteState" needn't be repositioned, it's always
 649:fb_question.c **** 			// SOLID (if used, only during a Reward)
 650:fb_question.c **** /*
 651:fb_question.c **** 			if(p_nowSprite == &spriteQUESTION3)
 652:fb_question.c **** 			{
 653:fb_question.c **** 				fbQ_overlaySprite(&spriteQUESTION3, NULL);
 654:fb_question.c **** 
 655:fb_question.c **** 				fbQ_overlaySprite(&(spriteQUESTION3[1]), NULL);
 656:fb_question.c **** 
 657:fb_question.c **** 				imageChangedTillRow = FB_HEIGHT;
 658:fb_question.c **** 			}
 659:fb_question.c **** */			if(nowIsReward)
 2451               		.stabn	68,0,659,.LM288-.LFBB21
 2452               	.LM288:
 2453 0940 8091 0000 		lds r24,nowIsReward
 2454 0944 8823      		tst r24
 2455 0946 01F0      		breq .L167
 2456               	.LBB103:
 660:fb_question.c **** 			{
 661:fb_question.c **** 				sprite_t * nextSolid;
 662:fb_question.c **** 
 663:fb_question.c **** #ifdef __QUESTION3_H__
 664:fb_question.c **** 				if(nowIsReward == 3)
 2457               		.stabn	68,0,664,.LM289-.LFBB21
 2458               	.LM289:
 2459 0948 8330      		cpi r24,lo8(3)
 2460 094a 01F4      		brne .L163
 665:fb_question.c **** 					nextSolid = &spriteSOLID3;
 2461               		.stabn	68,0,665,.LM290-.LFBB21
 2462               	.LM290:
 2463 094c C0E0      		ldi r28,lo8(spriteSOLID3)
 2464 094e D0E0      		ldi r29,hi8(spriteSOLID3)
 2465 0950 00C0      		rjmp .L164
 2466               	.L163:
 666:fb_question.c **** 				else
 667:fb_question.c **** #endif
 668:fb_question.c **** 					nextSolid = &spriteSOLID;
 2467               		.stabn	68,0,668,.LM291-.LFBB21
 2468               	.LM291:
 2469 0952 C0E0      		ldi r28,lo8(spriteSOLID)
 2470 0954 D0E0      		ldi r29,hi8(spriteSOLID)
 2471               	.L164:
 669:fb_question.c **** 
 670:fb_question.c **** 				//0 is foreground, so it should be drawn last
 671:fb_question.c **** 				if(!GET_LAYER(nowSpriteState.layer, nowSpriteState.count))
 2472               		.stabn	68,0,671,.LM292-.LFBB21
 2473               	.LM292:
 2474 0956 E091 0000 		lds r30,nowSpriteState+5
 2475 095a F091 0000 		lds r31,nowSpriteState+5+1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 104


 2476 095e 3097      		sbiw r30,0
 2477 0960 01F0      		breq .L165
 2478               	.LBB104:
 2479               		.stabn	68,0,671,.LM293-.LFBB21
 2480               	.LM293:
 2481 0962 8091 0000 		lds r24,nowSpriteState+4
 2482 0966 982F      		mov r25,r24
 2483 0968 9695      		lsr r25
 2484 096a 9695      		lsr r25
 2485 096c 9695      		lsr r25
 2486 096e E90F      		add r30,r25
 2487 0970 F11D      		adc r31,__zero_reg__
 2488               	/* #APP */
 2489               	 ;  671 "fb_question.c" 1
 2490 0972 E491      		lpm r30, Z
 2491               		
 2492               	 ;  0 "" 2
 2493               	/* #NOAPP */
 2494               	.LBE104:
 2495 0974 F0E0      		ldi r31,0
 2496 0976 8770      		andi r24,lo8(7)
 2497 0978 00C0      		rjmp 2f
 2498               		1:
 2499 097a F595      		asr r31
 2500 097c E795      		ror r30
 2501               		2:
 2502 097e 8A95      		dec r24
 2503 0980 02F4      		brpl 1b
 2504 0982 E0FD      		sbrc r30,0
 2505 0984 00C0      		rjmp .L166
 2506               	.L165:
 672:fb_question.c **** 				{
 673:fb_question.c **** 					//imageChangedTillRow =
 674:fb_question.c **** 					//fbQ_overlaySprite(p_selectedSprite, selectedSpritePosition);
 675:fb_question.c **** 					if(fbQ_overlaySprite(nextSolid, NULL))
 2507               		.stabn	68,0,675,.LM294-.LFBB21
 2508               	.LM294:
 2509 0986 60E0      		ldi r22,0
 2510 0988 70E0      		ldi r23,0
 2511 098a CE01      		movw r24,r28
 2512 098c 00D0      		rcall fbQ_overlaySprite
 2513 098e 8111      		cpse r24,__zero_reg__
 676:fb_question.c **** 						imageChangedTillRow = FB_HEIGHT;
 2514               		.stabn	68,0,676,.LM295-.LFBB21
 2515               	.LM295:
 2516 0990 10E1      		ldi r17,lo8(16)
 2517               	.L167:
 677:fb_question.c **** 
 678:fb_question.c **** 					//imageChangedTillRow =
 679:fb_question.c **** 					if(fbQ_overlaySprite(p_nowSprite, &nowSpriteState))
 2518               		.stabn	68,0,679,.LM296-.LFBB21
 2519               	.LM296:
 2520 0992 60E0      		ldi r22,lo8(nowSpriteState)
 2521 0994 70E0      		ldi r23,hi8(nowSpriteState)
 2522 0996 8091 0000 		lds r24,p_nowSprite
 2523 099a 9091 0000 		lds r25,p_nowSprite+1
 2524               	.L182:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 105


 2525 099e 00D0      		rcall fbQ_overlaySprite
 2526 09a0 8823      		tst r24
 2527 09a2 01F0      		breq .L168
 680:fb_question.c **** 						imageChangedTillRow = FB_HEIGHT;
 2528               		.stabn	68,0,680,.LM297-.LFBB21
 2529               	.LM297:
 2530 09a4 10E1      		ldi r17,lo8(16)
 2531 09a6 00C0      		rjmp .L168
 2532               	.L166:
 681:fb_question.c **** 				}
 682:fb_question.c **** 				else
 683:fb_question.c **** 				{
 684:fb_question.c **** 					//imageChangedTillRow =
 685:fb_question.c **** 					if(fbQ_overlaySprite(p_nowSprite, &nowSpriteState))
 2533               		.stabn	68,0,685,.LM298-.LFBB21
 2534               	.LM298:
 2535 09a8 60E0      		ldi r22,lo8(nowSpriteState)
 2536 09aa 70E0      		ldi r23,hi8(nowSpriteState)
 2537 09ac 8091 0000 		lds r24,p_nowSprite
 2538 09b0 9091 0000 		lds r25,p_nowSprite+1
 2539 09b4 00D0      		rcall fbQ_overlaySprite
 2540 09b6 8111      		cpse r24,__zero_reg__
 686:fb_question.c **** 						imageChangedTillRow = FB_HEIGHT;
 2541               		.stabn	68,0,686,.LM299-.LFBB21
 2542               	.LM299:
 2543 09b8 10E1      		ldi r17,lo8(16)
 2544               	.L169:
 687:fb_question.c **** 				
 688:fb_question.c **** 					//imageChangedTillRow =
 689:fb_question.c **** 					//fbQ_overlaySprite(p_selectedSprite, selectedSpritePosition);
 690:fb_question.c **** 					if(fbQ_overlaySprite(nextSolid, NULL))
 2545               		.stabn	68,0,690,.LM300-.LFBB21
 2546               	.LM300:
 2547 09ba 60E0      		ldi r22,0
 2548 09bc 70E0      		ldi r23,0
 2549 09be CE01      		movw r24,r28
 2550 09c0 00C0      		rjmp .L182
 2551               	.L168:
 2552               	.LBE103:
 691:fb_question.c **** 						imageChangedTillRow = FB_HEIGHT;
 692:fb_question.c **** 				}
 693:fb_question.c **** 			}
 694:fb_question.c **** 			else //Not a reward, so only one sprite is drawn...
 695:fb_question.c **** 					//E.G. SOLID, 'Q' or QUESTION3... right?
 696:fb_question.c **** 			{
 697:fb_question.c **** 				//imageChangedTillRow =
 698:fb_question.c **** 					if(fbQ_overlaySprite(p_nowSprite, &nowSpriteState))
 699:fb_question.c **** 						imageChangedTillRow = FB_HEIGHT;
 700:fb_question.c **** 			}
 701:fb_question.c **** 
 702:fb_question.c **** 			//qCount++;
 703:fb_question.c **** 			nowSpriteState.count++;// = qCount;
 2553               		.stabn	68,0,703,.LM301-.LFBB21
 2554               	.LM301:
 2555 09c2 8091 0000 		lds r24,nowSpriteState+4
 2556 09c6 8F5F      		subi r24,lo8(-(1))
 2557 09c8 8093 0000 		sts nowSpriteState+4,r24
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 106


 704:fb_question.c **** 			cameraState.count = nowSpriteState.count;
 2558               		.stabn	68,0,704,.LM302-.LFBB21
 2559               	.LM302:
 2560 09cc 8093 0000 		sts cameraState+4,r24
 705:fb_question.c **** 			//Could, e.g., test for a hard-coded value...
 706:fb_question.c **** /*#if(defined(MOTION_BIGGIE) && MOTION_BIGGIE)
 707:fb_question.c **** 			if(qCount >= (sizeof(DefaultY)*4))
 708:fb_question.c **** #else
 709:fb_question.c **** 			if(qCount >= (sizeof(LeafX)*4))
 710:fb_question.c **** #endif
 711:fb_question.c **** */
 712:fb_question.c **** 			if(nowSpriteState.count >= p_nowSprite->totalCount)
 2561               		.stabn	68,0,712,.LM303-.LFBB21
 2562               	.LM303:
 2563 09d0 E091 0000 		lds r30,p_nowSprite
 2564 09d4 F091 0000 		lds r31,p_nowSprite+1
 2565 09d8 3796      		adiw r30,7
 2566 09da 9491      		lpm r25,Z
 2567 09dc 8917      		cp r24,r25
 2568 09de 00F0      		brlo .L171
 713:fb_question.c **** 			{
 714:fb_question.c **** 				//qCount = 0;
 715:fb_question.c **** 				prepNextSprite();
 2569               		.stabn	68,0,715,.LM304-.LFBB21
 2570               	.LM304:
 2571 09e0 00D0      		rcall prepNextSprite
 2572               	.L171:
 716:fb_question.c **** /*
 717:fb_question.c **** #define LEAF_REPEAT	TRUE
 718:fb_question.c **** #if(!defined(LEAF_REPEAT) || !LEAF_REPEAT)
 719:fb_question.c **** 				p_selectedSprite = p_nextSprite;
 720:fb_question.c **** 				p_nextSprite = NULL;
 721:fb_question.c **** #endif
 722:fb_question.c **** */
 723:fb_question.c **** 			}
 724:fb_question.c **** 			return imageChangedTillRow; 
 725:fb_question.c **** 		}
 726:fb_question.c **** /*
 727:fb_question.c **** 		//Transitioning from the Question-box to the next sprite
 728:fb_question.c **** 		else if(p_selectedSprite == &spriteQ) 
 729:fb_question.c **** 		{
 730:fb_question.c **** 			uint8_t spriteRow;
 731:fb_question.c **** 
 732:fb_question.c **** 			//Draw the top of the next sprite...
 733:fb_question.c **** 			for(qRow=0; qRow<qCount; qRow++)
 734:fb_question.c **** 			{
 735:fb_question.c **** 				spriteRow = qRow - (16 - qCount);
 736:fb_question.c **** 				if(drawSpriteRow(p_nextSprite, qCount, spriteRow, qRow))
 737:fb_question.c **** 					imageChangedTillRow = qRow;
 738:fb_question.c **** 			}
 739:fb_question.c **** 		
 740:fb_question.c **** 			//This is kinda hokey, but should work...
 741:fb_question.c **** 			// rather than displaying the "?" after it's been hit, it should
 742:fb_question.c **** 			// become solid... but in most cases using p_selectedSprite==SOLID
 743:fb_question.c **** 			// results in a transition straight to Q...
 744:fb_question.c **** 			// so rather than changing p_selectedSprite, let's just override
 745:fb_question.c **** 			// it here
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 107


 746:fb_question.c **** 			spriteRow = 0;
 747:fb_question.c **** 			for( ; qRow<Q_HEIGHT; qRow++)
 748:fb_question.c **** 			{
 749:fb_question.c **** 				if(drawSpriteRow(&spriteSOLID, qCount, spriteRow, qRow))
 750:fb_question.c **** 					imageChangedTillRow = qRow;
 751:fb_question.c **** 
 752:fb_question.c **** 				spriteRow++;
 753:fb_question.c **** 			}
 754:fb_question.c **** 			
 755:fb_question.c **** 		}
 756:fb_question.c **** 		//Transitioning back from a sprite to the question-box/solid
 757:fb_question.c **** 		else
 758:fb_question.c **** 		{
 759:fb_question.c **** 			uint8_t displayRow;
 760:fb_question.c **** 			uint8_t spriteRow = qCount; 
 761:fb_question.c **** 
 762:fb_question.c **** 			for(displayRow = 0; displayRow < (Q_HEIGHT-qCount); displayRow++)
 763:fb_question.c **** 			{
 764:fb_question.c **** 				if(drawSpriteRow(p_selectedSprite,qCount,spriteRow,displayRow))
 765:fb_question.c **** 					imageChangedTillRow = displayRow;
 766:fb_question.c **** 
 767:fb_question.c **** 									//				displayRow+qCount, displayRow);
 768:fb_question.c **** 				spriteRow++;
 769:fb_question.c **** 			}
 770:fb_question.c **** 	
 771:fb_question.c **** 			spriteRow = 0;
 772:fb_question.c **** 			for( ; displayRow<Q_HEIGHT; displayRow++)
 773:fb_question.c **** 			{
 774:fb_question.c **** 				if(drawSpriteRow(p_nextSprite, qCount, spriteRow, displayRow))
 775:fb_question.c **** 					imageChangedTillRow = displayRow;
 776:fb_question.c **** 
 777:fb_question.c **** 					//				displayRow-(Q_HEIGHT-1-qCount), displayRow);
 778:fb_question.c **** 
 779:fb_question.c **** 				spriteRow++;
 780:fb_question.c **** 			}
 781:fb_question.c **** 		}
 782:fb_question.c **** 
 783:fb_question.c **** 		//a/o v84: This bit's avoided with motionHandling due to return...
 784:fb_question.c **** 		qCount++;
 785:fb_question.c **** 		if(qCount >= Q_HEIGHT)
 786:fb_question.c **** 		{
 787:fb_question.c **** 			qCount = 0;
 788:fb_question.c **** 			p_selectedSprite = p_nextSprite;
 789:fb_question.c **** 			p_nextSprite = NULL;
 790:fb_question.c **** 		}
 791:fb_question.c **** 
 792:fb_question.c **** 	} //end of nextSprite Handling...
 793:fb_question.c **** 	else //we only have a selectedSprite (nextSprite is NULL)
 794:fb_question.c **** 	{
 795:fb_question.c **** 		setSpriteSkyColorOverride(NULL);
 796:fb_question.c **** 
 797:fb_question.c **** 		for(qRow=0; qRow<Q_HEIGHT; qRow++)
 798:fb_question.c **** 		{
 799:fb_question.c **** 			if(drawSpriteRow(p_selectedSprite, qCount, qRow, qRow))
 800:fb_question.c **** 				imageChangedTillRow = qRow; //TRUE;
 801:fb_question.c **** 		}
 802:fb_question.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 108


 803:fb_question.c **** 		qCount++;
 804:fb_question.c **** 		//the only case where qCount should cycle is spriteQ...
 805:fb_question.c **** 		// its value is %12, so could either reset it at 12, or this.. whatev
 806:fb_question.c **** 		// To avoid a glitch every 21 cycles.
 807:fb_question.c **** 		if(qCount >= ((255 / 12) * 12))
 808:fb_question.c **** 			qCount = 0;
 809:fb_question.c **** 	}
 810:fb_question.c **** */
 811:fb_question.c **** 	return imageChangedTillRow;
 812:fb_question.c **** }
 2573               		.stabn	68,0,812,.LM305-.LFBB21
 2574               	.LM305:
 2575 09e2 812F      		mov r24,r17
 2576               	/* epilogue start */
 2577 09e4 DF91      		pop r29
 2578 09e6 CF91      		pop r28
 2579 09e8 1F91      		pop r17
 2580 09ea 0895      		ret
 2581               		.size	fbQuestion_update, .-fbQuestion_update
 2582               		.stabs	"imageChangedTillRow:r(4,1)",64,0,582,17
 2583               		.stabn	192,0,0,.LFBB21-.LFBB21
 2584               		.stabs	"nextSolid:r(0,50)=*(15,11)",64,0,661,28
 2585               		.stabn	192,0,0,.LBB103-.LFBB21
 2586               		.stabn	224,0,0,.LBE103-.LFBB21
 2587               		.stabn	224,0,0,.Lscope21-.LFBB21
 2588               	.Lscope21:
 2589               		.stabs	"",36,0,0,.Lscope21-.LFBB21
 2590               		.stabd	78,0,0
 2591               		.stabs	"frameBufferUpdate:F(0,47)",36,0,225,frameBufferUpdate
 2592               	.global	frameBufferUpdate
 2593               		.type	frameBufferUpdate, @function
 2594               	frameBufferUpdate:
 2595               		.stabd	46,0,0
 2596               		.stabs	"./_options/frameBuffer.c",132,0,0,.Ltext20
 2597               	.Ltext20:
 145:./_options/frameBuffer.c **** 
 146:./_options/frameBuffer.c **** 
 147:./_options/frameBuffer.c **** //#include "_options/smiley.c"
 148:./_options/frameBuffer.c **** 
 149:./_options/frameBuffer.c **** 
 150:./_options/frameBuffer.c **** static __inline__
 151:./_options/frameBuffer.c **** void frameBufferChange(uint8_t *bufferChanged, 
 152:./_options/frameBuffer.c **** 							uint8_t row, uint8_t col, uint8_t color)
 153:./_options/frameBuffer.c **** 	__attribute__((__always_inline__));
 154:./_options/frameBuffer.c **** 
 155:./_options/frameBuffer.c **** 
 156:./_options/frameBuffer.c **** //This isn't especially necessary to write to the frameBuffer
 157:./_options/frameBuffer.c **** // ...since it's global, it could be done directly
 158:./_options/frameBuffer.c **** // but this allows for testing whether a change occurs
 159:./_options/frameBuffer.c **** // in case it's desired to only refresh when that happens.
 160:./_options/frameBuffer.c **** //Since it's always-inline, it should optimize-out a few things, e.g. the
 161:./_options/frameBuffer.c **** //NULL-test, and even the write to bufferChanged, if it is null.
 162:./_options/frameBuffer.c **** // so it should be pretty quick.
 163:./_options/frameBuffer.c **** // It does NOT have a return-value, instead it only modifies bufferChanged
 164:./_options/frameBuffer.c **** // IF there is a change, so e.g. it could be run in a for-loop
 165:./_options/frameBuffer.c **** // and the end-value of bufferChanged will either be FALSE if no change, or
 166:./_options/frameBuffer.c **** // TRUE if there was a change in any of the loops.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 109


 167:./_options/frameBuffer.c **** void frameBufferChange(uint8_t *bufferChanged, 
 168:./_options/frameBuffer.c **** 							uint8_t row, uint8_t col, uint8_t color)
 169:./_options/frameBuffer.c **** {
 170:./_options/frameBuffer.c **** 	if(frameBuffer[(row)][(col)] != (color))
 171:./_options/frameBuffer.c **** 	{
 172:./_options/frameBuffer.c **** 		frameBuffer[(row)][(col)] = (color);
 173:./_options/frameBuffer.c **** 		
 174:./_options/frameBuffer.c **** 		if(bufferChanged != NULL)
 175:./_options/frameBuffer.c **** 			*bufferChanged = TRUE;
 176:./_options/frameBuffer.c **** 	}
 177:./_options/frameBuffer.c **** }
 178:./_options/frameBuffer.c **** 
 179:./_options/frameBuffer.c **** #define frameBufferSet(row, col, color) \
 180:./_options/frameBuffer.c **** 				frameBufferChange(NULL, (row), (col), (color))
 181:./_options/frameBuffer.c **** 
 182:./_options/frameBuffer.c **** 
 183:./_options/frameBuffer.c **** #if(defined(FB_SMILEY) && FB_SMILEY)
 184:./_options/frameBuffer.c **** #include "_options/smiley.c"
 185:./_options/frameBuffer.c **** #endif
 186:./_options/frameBuffer.c **** 
 187:./_options/frameBuffer.c **** 
 188:./_options/frameBuffer.c **** 
 189:./_options/frameBuffer.c ****  #if(defined(FB_REFRESH_ON_CHANGE) && FB_REFRESH_ON_CHANGE)
 190:./_options/frameBuffer.c **** //This is sorta handled in heartbeat... and maybe it'd make sense to use
 191:./_options/frameBuffer.c **** //its timer-stuff instead, in a general sense... something to consider
 192:./_options/frameBuffer.c **** #if(defined(_HEART_DMS_) && _HEART_DMS_)
 193:./_options/frameBuffer.c ****  #define fb_timer_t			dms4day_t
 194:./_options/frameBuffer.c ****  #define fb_getTime()		dmsGetTime()
 195:./_options/frameBuffer.c ****  #define fb_isItTime(a,b)	dmsIsItTimeV2((a),(b),FALSE)
 196:./_options/frameBuffer.c **** #elif(defined(_HEART_TCNTER_) && _HEART_TCNTER_)
 197:./_options/frameBuffer.c ****  #define fb_timer_t			myTcnter_t
 198:./_options/frameBuffer.c ****  #define fb_getTime()		tcnter_get()
 199:./_options/frameBuffer.c ****  #define fb_isItTime(a,b)	tcnter_isItTimeV2((a),(b),FALSE)
 200:./_options/frameBuffer.c **** #else
 201:./_options/frameBuffer.c **** #error "Need timer-functions for REFRESH_ON_CHANGE"
 202:./_options/frameBuffer.c **** #endif
 203:./_options/frameBuffer.c **** #endif
 204:./_options/frameBuffer.c **** 
 205:./_options/frameBuffer.c **** 
 206:./_options/frameBuffer.c **** 
 207:./_options/frameBuffer.c **** // This code was in main...
 208:./_options/frameBuffer.c **** // This isn't generalized enough to justify this function-name
 209:./_options/frameBuffer.c **** // just not ready to delete it completely
 210:./_options/frameBuffer.c **** // Returns TRUE if there's a change to the frameBuffer image
 211:./_options/frameBuffer.c **** // (so a refresh can be scheduled, if so desired)
 212:./_options/frameBuffer.c **** // a/o v71: This is called in the main loop
 213:./_options/frameBuffer.c **** // 	w/ REFRESH_ON_CHANGE:
 214:./_options/frameBuffer.c **** //        * The fb_updater() function (e.g. tet_update) is only called
 215:./_options/frameBuffer.c **** //          after the frame-refresh is complete
 216:./_options/frameBuffer.c **** //          (if there are several refreshes, it waits until they're all
 217:./_options/frameBuffer.c **** //          done)
 218:./_options/frameBuffer.c **** //          It *also* waits for a delay *after the refreshes* before
 219:./_options/frameBuffer.c **** //          fb_updater() is called... (this may be a little redundant?)
 220:./_options/frameBuffer.c **** //    w/o:
 221:./_options/frameBuffer.c **** //        * The fb_updater() function is called at the beginning of a new
 222:./_options/frameBuffer.c **** //          frame (once) to attempt to only update the framebuffer at a
 223:./_options/frameBuffer.c **** //          time when it won't refresh the screen with only half of the
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 110


 224:./_options/frameBuffer.c **** //          framebuffer itself updated.
 225:./_options/frameBuffer.c **** void frameBufferUpdate(void)
 226:./_options/frameBuffer.c **** {
 2598               		.stabn	68,0,226,.LM306-.LFBB22
 2599               	.LM306:
 2600               	.LFBB22:
 2601               	/* prologue: function */
 2602               	/* frame size = 0 */
 2603               	/* stack size = 0 */
 2604               	.L__stack_usage = 0
 227:./_options/frameBuffer.c ****  #if(defined(FB_REFRESH_ON_CHANGE) && FB_REFRESH_ON_CHANGE)
 228:./_options/frameBuffer.c **** //      static uint8_t lastUpdated = FALSE;
 229:./_options/frameBuffer.c ****       static fb_timer_t fbLastUpdateTime = 0;
 230:./_options/frameBuffer.c **** 
 231:./_options/frameBuffer.c ****       //Because the dmsTimer is running somewhat arbitarily, this "200ms"
 232:./_options/frameBuffer.c ****       // isn't particularly accurate...
 233:./_options/frameBuffer.c ****       if(updateFrame)
 2605               		.stabn	68,0,233,.LM307-.LFBB22
 2606               	.LM307:
 2607 09ec 8091 0000 		lds r24,updateFrame
 2608 09f0 8823      		tst r24
 2609 09f2 01F0      		breq .L184
 234:./_options/frameBuffer.c **** 		{
 235:./_options/frameBuffer.c ****          fbLastUpdateTime = fb_getTime();
 2610               		.stabn	68,0,235,.LM308-.LFBB22
 2611               	.LM308:
 2612 09f4 00D0      		rcall tcnter_get
 2613 09f6 6093 0000 		sts fbLastUpdateTime.2072,r22
 2614 09fa 7093 0000 		sts fbLastUpdateTime.2072+1,r23
 2615 09fe 8093 0000 		sts fbLastUpdateTime.2072+2,r24
 2616 0a02 9093 0000 		sts fbLastUpdateTime.2072+3,r25
 236:./_options/frameBuffer.c **** 			return;
 2617               		.stabn	68,0,236,.LM309-.LFBB22
 2618               	.LM309:
 2619 0a06 0895      		ret
 2620               	.L184:
 2621               	.LBB110:
 2622               	.LBB111:
 2623               		.stabs	"./_commonCode_localized/tcnter/0.30/tcnter.h",132,0,0,.Ltext21
 2624               	.Ltext21:
   1:./_commonCode_localized/tcnter/0.30/tcnter.h **** /* mehPL:
   2:./_commonCode_localized/tcnter/0.30/tcnter.h ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:./_commonCode_localized/tcnter/0.30/tcnter.h ****  *    I'm not too fond of long licenses at the top of the file.
   4:./_commonCode_localized/tcnter/0.30/tcnter.h ****  *    Please see the bottom.
   5:./_commonCode_localized/tcnter/0.30/tcnter.h ****  *    Enjoy!
   6:./_commonCode_localized/tcnter/0.30/tcnter.h ****  */
   7:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
   8:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
   9:./_commonCode_localized/tcnter/0.30/tcnter.h **** //tcnter 0.30-6
  10:./_commonCode_localized/tcnter/0.30/tcnter.h **** // Similar functionality to dmsTimer
  11:./_commonCode_localized/tcnter/0.30/tcnter.h **** //   Doesn't require interrupts
  12:./_commonCode_localized/tcnter/0.30/tcnter.h **** //   MUCH higher resolution-potential (e.g. for bit-rate generation)
  13:./_commonCode_localized/tcnter/0.30/tcnter.h **** //      limited only by the tcnter_update() call rate(?)
  14:./_commonCode_localized/tcnter/0.30/tcnter.h **** // TODO: Make some, if not all, functions inline.
  15:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       CONSIDER: if timing is highly critical, it may make sense
  16:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                 to call update() with every get()
  17:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                 THOUGH: this would add a lot of calculations...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 111


  18:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       CONSIDER2: could myTcnter_t be smaller, and use wraparound math?
  19:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                 e.g.  if(get() >= next) NOGO ? next=3, get=254
  20:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                 e.g.2 if(get() - next >= 0) ... same
  21:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                  wasn't there a way to do this?
  22:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                       if(get() - last >= next - last) ?
  23:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                             next=3, get=254, last=253
  24:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                          get()-last = 254-253 = 1
  25:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                          next-last = 3-253 = 6
  26:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                  Promotion issues may occur, watch casts.
  27:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                  See cTools/unsignedSubtraction.c
  28:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                             next=5, get=7, last=6
  29:./_commonCode_localized/tcnter/0.30/tcnter.h **** //					Create "wrappableTimeCompare()" macro?
  30:./_commonCode_localized/tcnter/0.30/tcnter.h **** //             Also usable in dms, etc...
  31:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30-6 adding TCNT_UPDATE_ONCE_PER_OVERFLOW:
  32:./_commonCode_localized/tcnter/0.30/tcnter.h **** //			and tcnter_overflowUpdate()
  33:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       ...
  34:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       LCDdirectLVDS77 attempts to call tcnter_update() only once per
  35:./_commonCode_localized/tcnter/0.30/tcnter.h **** //			timer-overflow (in the interrupt)
  36:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       So it's quite likely that each tcnter_update() occurs at or around
  37:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       the same TCNT value. (which might explain why the heart isn't
  38:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       fading).
  39:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30-5 Checking if TCNTER_MS is <= 0
  40:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30-4 TCNTER_INITS_TIMER is configured by default IF timerCommon is not
  41:./_commonCode_localized/tcnter/0.30/tcnter.h **** //			included in the makefile before tcnter is...
  42:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       This is a bit hokey... (what if timerCommon is included *after*?)
  43:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       TODO: Figure this out.
  44:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30-3 PWM161 wasn't handled...
  45:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30-2 8V2, not V28
  46:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       Adding tcnter_wait(tcnts)
  47:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30-1 moving TCNTER_AVRTIMER_CLKDIV to tcnter.h so it can be used by
  48:./_commonCode_localized/tcnter/0.30/tcnter.h **** //			e.g. heartbeat to calculate timings...
  49:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30  tcnter on an AVR will most-likely use a timer, e.g. timer0
  50:./_commonCode_localized/tcnter/0.30/tcnter.h **** //      so should set some defaults, not have to explicitly include
  51:./_commonCode_localized/tcnter/0.30/tcnter.h **** //      timerCommon in the project's makefile, etc.
  52:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.21  per dmsTimer1.14, a/o heartbeat1.50...
  53:./_commonCode_localized/tcnter/0.30/tcnter.h **** //      isItTime functions have an option to NOT worry about
  54:./_commonCode_localized/tcnter/0.30/tcnter.h **** //      cumulative-error...
  55:./_commonCode_localized/tcnter/0.30/tcnter.h **** //      Also, they've been made inline, so now included in the header-file
  56:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-10 Replacing tests' makefiles with those that refer to tcnter
  57:./_commonCode_localized/tcnter/0.30/tcnter.h **** //        properly... a/o/ala anaButtons 0.50
  58:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-9 adding this TODO: Apparently math doesn't work with
  59:./_commonCode_localized/tcnter/0.30/tcnter.h **** //			tcnter_source_t = uint16_t???
  60:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       And looking into it...
  61:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-8 a/o polled_uar/0.40/avrTest...
  62:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       adding some Usage notes...
  63:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-7 adding isItTime (non 8-bit)
  64:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-6 adding to COM_HEADERS when INLINED
  65:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-5 Renaming Globals to tcnter_*... nastiness
  66:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       see puar notes...
  67:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-4 tcnter8_t -> tcnter_isItTime8(startTime, delta)
  68:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       HANDY: When inlined, if(tcnter_isItTime()) results in
  69:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       an if statement from inside tcnter_isItTime, which is used
  70:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       *in place of* the if surrounding tcnter_isItTime()
  71:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       Inlining optimization is great!
  72:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-3 myTcnter_t is stupid -> tcnter_t
  73:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-2 adding _SPECIALHEADER_FOR_TCNTER_
  74:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       e.g. TCNTER OVERFLOW VAL = _DMS_OCR_VAL_ requires dmsTimer.h
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 112


  75:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       so CFLAGS+=-D'_SPECIALHEADER_FOR_TCNTER_=_DMSTIMER_HEADER_'
  76:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-1 inlining...
  77:./_commonCode_localized/tcnter/0.30/tcnter.h **** //				SEE NOTES in .c before using inlining
  78:./_commonCode_localized/tcnter/0.30/tcnter.h **** //          and experiment and stuff
  79:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20 TCNTER_SOURCE_MAX renamed to TCNTER_SOURCE_OVERFLOW_VAL
  80:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10-3 fixing names in test (to match 0.10-1 changes)
  81:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       experimenting with test
  82:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10-2 Need <avr/io.h> when TCNT, etc. is used...
  83:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10-1 (forgot to backup first version?)
  84:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       renaming all tcnt and whatnot to tcnter
  85:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10 First version, stolen and modified from polled_uar 0.10-6
  86:./_commonCode_localized/tcnter/0.30/tcnter.h **** //
  87:./_commonCode_localized/tcnter/0.30/tcnter.h **** //---------
  88:./_commonCode_localized/tcnter/0.30/tcnter.h **** //polled_uar 0.10-6:
  89:./_commonCode_localized/tcnter/0.30/tcnter.h **** //   Doesn't use interrupts (no lag-times, etc.)
  90:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10-4 
  91:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       Looking into running-tcnt
  92:./_commonCode_localized/tcnter/0.30/tcnter.h **** //				myTcnter and nextTcnter now implemented
  93:./_commonCode_localized/tcnter/0.30/tcnter.h **** //          Fixes potential issues with multi-TCNTs per update
  94:./_commonCode_localized/tcnter/0.30/tcnter.h **** //            Aiding cumulative-error fixing
  95:./_commonCode_localized/tcnter/0.30/tcnter.h **** //            (Next time was dependent on the time of the current update)
  96:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10-3 test app using makefile...
  97:./_commonCode_localized/tcnter/0.30/tcnter.h **** //			cleanup
  98:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10-1 More mods, test app
  99:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10 First Version stolen and modified heavily from usi_uart 0.22-3
 100:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 101:./_commonCode_localized/tcnter/0.30/tcnter.h **** #ifndef __TCNTER_H__
 102:./_commonCode_localized/tcnter/0.30/tcnter.h **** #define __TCNTER_H__
 103:./_commonCode_localized/tcnter/0.30/tcnter.h **** //This shouldn't be necessary... (or its necessity removed soon)
 104:./_commonCode_localized/tcnter/0.30/tcnter.h **** //#include <avr/io.h>
 105:./_commonCode_localized/tcnter/0.30/tcnter.h **** #include <stdint.h>
 106:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 107:./_commonCode_localized/tcnter/0.30/tcnter.h **** #ifdef __AVR_ARCH__
 108:./_commonCode_localized/tcnter/0.30/tcnter.h ****  //This is only necessary if TCNT0 (etc.) is used
 109:./_commonCode_localized/tcnter/0.30/tcnter.h ****  // according to the project makefile
 110:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #include <avr/io.h>
 111:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 112:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 113:./_commonCode_localized/tcnter/0.30/tcnter.h **** //This is for, e.g. where TCNTER_SOURCE_OVERFLOW_VAL = _DMS_OCR_VAL_
 114:./_commonCode_localized/tcnter/0.30/tcnter.h **** // Then tcnter needs to be aware of the definition of _DMS_OCR_VAL_
 115:./_commonCode_localized/tcnter/0.30/tcnter.h **** #ifdef _SPECIALHEADER_FOR_TCNTER_
 116:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #include _SPECIALHEADER_FOR_TCNTER_
 117:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 118:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 119:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 120:./_commonCode_localized/tcnter/0.30/tcnter.h **** #if (defined(TCNTER_INITS_TIMER) && TCNTER_INITS_TIMER)
 121:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #include _TIMERCOMMON_HEADER_
 122:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 123:./_commonCode_localized/tcnter/0.30/tcnter.h ****  //Moved here so it can be referenced elsewhere for determining timings...
 124:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #ifndef TCNTER_AVRTIMER_CLKDIV
 125:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #ifdef __AVR_AT90PWM161__
 126:./_commonCode_localized/tcnter/0.30/tcnter.h **** 	// This is the only option on the PWM161
 127:./_commonCode_localized/tcnter/0.30/tcnter.h ****    #define TCNTER_AVRTIMER_CLKDIV CLKDIV1
 128:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #else
 129:./_commonCode_localized/tcnter/0.30/tcnter.h ****    //This choice is arbitrary...
 130:./_commonCode_localized/tcnter/0.30/tcnter.h ****    // According to timerCommon, it exists in most typical systems
 131:./_commonCode_localized/tcnter/0.30/tcnter.h ****    // The only exception I've run into so far is AT90PWM161, which ONLY has
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 113


 132:./_commonCode_localized/tcnter/0.30/tcnter.h ****    // CLKDIV1, which wouldn't work too well since tcnter_update() would
 133:./_commonCode_localized/tcnter/0.30/tcnter.h ****    // have to run every 255 clock cycles (or 65535?)
 134:./_commonCode_localized/tcnter/0.30/tcnter.h ****    // LCDdirectLVDS69 uses the timer for dms... so it must work, ish.
 135:./_commonCode_localized/tcnter/0.30/tcnter.h ****    #define TCNTER_AVRTIMER_CLKDIV CLKDIV64
 136:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #endif
 137:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #endif
 138:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 139:./_commonCode_localized/tcnter/0.30/tcnter.h ****  //These can be used by other code...
 140:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #define TCNTS_PER_SECOND  (F_CPU/(1<<TCNTER_AVRTIMER_CLKDIV))
 141:./_commonCode_localized/tcnter/0.30/tcnter.h ****  //At FCPU = 16MHz, TCNTER_MS is 250...
 142:./_commonCode_localized/tcnter/0.30/tcnter.h **** #else
 143:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #warning "TCNTER_INITS_TIMER is NOT TRUE. This can happen a number of ways, the weirdest being tha
 144:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #warning "If you get weird errors, did you check that TCNTER_SEC, etc. have been set for your proj
 145:./_commonCode_localized/tcnter/0.30/tcnter.h **** #warning "Check: TCNTER_SOURCE_VAR, TCNTER_SOURCE_OVERFLOW_VAL, and TCNTS_PER_SECOND, also _SPECIAL
 146:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 147:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 148:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 149:./_commonCode_localized/tcnter/0.30/tcnter.h **** #if((TCNTS_PER_SECOND/1000) > 0)
 150:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #define TCNTS_PER_MS		(TCNTS_PER_SECOND/1000)
 151:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #define TCNTER_MS			(TCNTS_PER_MS)
 152:./_commonCode_localized/tcnter/0.30/tcnter.h **** #else
 153:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #warning "TCNTS_PER_MS <= 0, so TCNTER_MS is disabled"
 154:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 155:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 156:./_commonCode_localized/tcnter/0.30/tcnter.h **** #define TCNTER_SEC			(TCNTS_PER_SECOND)
 157:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 158:./_commonCode_localized/tcnter/0.30/tcnter.h **** #if((TCNTS_PER_SECOND/10000) > 0)
 159:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #define TCNTER_DMS			(TCNTS_PER_SECOND/10000)
 160:./_commonCode_localized/tcnter/0.30/tcnter.h **** #else
 161:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #warning "TCNTER_DMS <= 0, so disabled"
 162:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 163:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 164:./_commonCode_localized/tcnter/0.30/tcnter.h **** /*
 165:./_commonCode_localized/tcnter/0.30/tcnter.h **** // This'd be nice to change...
 166:./_commonCode_localized/tcnter/0.30/tcnter.h **** #if (!defined(PU_PC_DEBUG) || !PU_PC_DEBUG)
 167:./_commonCode_localized/tcnter/0.30/tcnter.h **** // #include "../../bithandling/0.94/bithandling.h"
 168:./_commonCode_localized/tcnter/0.30/tcnter.h **** #else
 169:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #include <stdio.h>
 170:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 171:./_commonCode_localized/tcnter/0.30/tcnter.h **** */
 172:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 173:./_commonCode_localized/tcnter/0.30/tcnter.h **** //DON'T CHANGE THIS WITHOUT CHANGING both!
 174:./_commonCode_localized/tcnter/0.30/tcnter.h **** #if ( (!defined(tcnter_source_t) && defined(tcnter_compare_t)) \
 175:./_commonCode_localized/tcnter/0.30/tcnter.h ****     ||(!defined(tcnter_compare_t) && defined(tcnter_source_t)) )
 176:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #error "tcnter_source_t and tcnter_compare_t must *both* be overridden"
 177:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 178:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 179:./_commonCode_localized/tcnter/0.30/tcnter.h **** #ifndef tcnter_source_t
 180:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #ifdef __AVR_AT90PWM161__
 181:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #define tcnter_source_t	uint16_t
 182:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #else
 183:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #define tcnter_source_t   uint8_t
 184:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #endif
 185:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 186:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 187:./_commonCode_localized/tcnter/0.30/tcnter.h **** #ifndef tcnter_compare_t
 188:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #ifdef __AVR_AT90PWM161__
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 114


 189:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #define tcnter_compare_t  int32_t
 190:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #else
 191:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #define tcnter_compare_t  int16_t
 192:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #endif
 193:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 194:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 195:./_commonCode_localized/tcnter/0.30/tcnter.h **** //This is a stupid name...
 196:./_commonCode_localized/tcnter/0.30/tcnter.h **** #define myTcnter_t  uint32_t
 197:./_commonCode_localized/tcnter/0.30/tcnter.h **** //This makes more sense...
 198:./_commonCode_localized/tcnter/0.30/tcnter.h **** // But I think I did it that way because I might later want to make this
 199:./_commonCode_localized/tcnter/0.30/tcnter.h **** // an internal structure, in case I want multiple tcnters...
 200:./_commonCode_localized/tcnter/0.30/tcnter.h **** // (e.g. like xyt, or hfm, etc...)
 201:./_commonCode_localized/tcnter/0.30/tcnter.h **** // seems less likely in this case...
 202:./_commonCode_localized/tcnter/0.30/tcnter.h **** #define tcnter_t uint32_t
 203:./_commonCode_localized/tcnter/0.30/tcnter.h **** #define tcnter8_t uint8_t
 204:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 205:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 206:./_commonCode_localized/tcnter/0.30/tcnter.h **** //********** TCNTER Prototypes **********//
 207:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 208:./_commonCode_localized/tcnter/0.30/tcnter.h **** //These are the functions that are used in main code...
 209:./_commonCode_localized/tcnter/0.30/tcnter.h **** // General initialization...
 210:./_commonCode_localized/tcnter/0.30/tcnter.h **** void tcnter_init(void);
 211:./_commonCode_localized/tcnter/0.30/tcnter.h **** // To be called in the main loop...
 212:./_commonCode_localized/tcnter/0.30/tcnter.h **** // (Handles reading the TCNT deltas and adding to myTcnter, etc)
 213:./_commonCode_localized/tcnter/0.30/tcnter.h **** // this should be called MORE OFTEN than overflows
 214:./_commonCode_localized/tcnter/0.30/tcnter.h **** // If using an overflow-interrupt as the only reliable source of updates
 215:./_commonCode_localized/tcnter/0.30/tcnter.h **** // then use tcnter_overflowUpdate() (other tcnter_updates can also be
 216:./_commonCode_localized/tcnter/0.30/tcnter.h **** // called)
 217:./_commonCode_localized/tcnter/0.30/tcnter.h **** void tcnter_update(void);
 218:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 219:./_commonCode_localized/tcnter/0.30/tcnter.h **** #if(defined(TCNT_UPDATE_ONCE_PER_OVERFLOW) && \
 220:./_commonCode_localized/tcnter/0.30/tcnter.h **** 		      TCNT_UPDATE_ONCE_PER_OVERFLOW)
 221:./_commonCode_localized/tcnter/0.30/tcnter.h **** void tcnter_overflowUpdate(void);
 222:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 223:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 224:./_commonCode_localized/tcnter/0.30/tcnter.h **** // Get the current value of myTcnter
 225:./_commonCode_localized/tcnter/0.30/tcnter.h **** tcnter_t tcnter_get(void);
 226:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 227:./_commonCode_localized/tcnter/0.30/tcnter.h **** void tcnter_wait(myTcnter_t tcnts);
 228:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 229:./_commonCode_localized/tcnter/0.30/tcnter.h **** //Of course, this is only safe if it's called often enough...
 230:./_commonCode_localized/tcnter/0.30/tcnter.h **** // and deltaTime is small enough...
 231:./_commonCode_localized/tcnter/0.30/tcnter.h **** // and tcnterUpdate is called often enough, as well (?)
 232:./_commonCode_localized/tcnter/0.30/tcnter.h **** //uint8_t tcnter_isItTime8(tcnter8_t *startTime, tcnter8_t deltaTime);
 233:./_commonCode_localized/tcnter/0.30/tcnter.h **** //uint8_t tcnter_isItTime(tcnter_t *startTime, tcnter_t deltaTime);
 234:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 235:./_commonCode_localized/tcnter/0.30/tcnter.h **** // dmsTimer has these inlined, and lists them in the header file
 236:./_commonCode_localized/tcnter/0.30/tcnter.h **** // (I guess it makes sense, they're small enough to always inline, and that
 237:./_commonCode_localized/tcnter/0.30/tcnter.h **** // won't happen if they're in the C file...)
 238:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 239:./_commonCode_localized/tcnter/0.30/tcnter.h **** // For now, the notes are still in the C file.
 240:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 241:./_commonCode_localized/tcnter/0.30/tcnter.h **** // a/o V2: dontAllowCumulation should optimize-out into a smaller function
 242:./_commonCode_localized/tcnter/0.30/tcnter.h **** //         (if FALSE)
 243:./_commonCode_localized/tcnter/0.30/tcnter.h **** extern volatile tcnter_t tcnter_myTcnter;
 244:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 245:./_commonCode_localized/tcnter/0.30/tcnter.h **** static __inline__
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 115


 246:./_commonCode_localized/tcnter/0.30/tcnter.h **** uint8_t tcnter_isItTime8V2(tcnter8_t *startTime, tcnter8_t deltaTime,
 247:./_commonCode_localized/tcnter/0.30/tcnter.h **** 										uint8_t dontAllowCumulation)
 248:./_commonCode_localized/tcnter/0.30/tcnter.h **** {
 249:./_commonCode_localized/tcnter/0.30/tcnter.h ****    tcnter8_t thisDelta = (uint8_t)tcnter_myTcnter - (uint8_t)(*startTime);
 250:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 251:./_commonCode_localized/tcnter/0.30/tcnter.h ****    if(thisDelta >= deltaTime)
 252:./_commonCode_localized/tcnter/0.30/tcnter.h ****    {
 253:./_commonCode_localized/tcnter/0.30/tcnter.h **** 		if(dontAllowCumulation)
 254:./_commonCode_localized/tcnter/0.30/tcnter.h ****       	*startTime = (uint8_t)tcnter_myTcnter - (thisDelta - deltaTime);
 255:./_commonCode_localized/tcnter/0.30/tcnter.h ****       else
 256:./_commonCode_localized/tcnter/0.30/tcnter.h **** 			*startTime = (uint8_t)tcnter_myTcnter;
 257:./_commonCode_localized/tcnter/0.30/tcnter.h **** 		return TRUE;
 258:./_commonCode_localized/tcnter/0.30/tcnter.h ****    }
 259:./_commonCode_localized/tcnter/0.30/tcnter.h ****    else
 260:./_commonCode_localized/tcnter/0.30/tcnter.h ****       return FALSE;
 261:./_commonCode_localized/tcnter/0.30/tcnter.h **** }
 262:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 263:./_commonCode_localized/tcnter/0.30/tcnter.h **** static __inline__
 264:./_commonCode_localized/tcnter/0.30/tcnter.h **** uint8_t tcnter_isItTimeV2(tcnter_t *startTime, tcnter_t deltaTime,
 265:./_commonCode_localized/tcnter/0.30/tcnter.h **** 										uint8_t dontAllowCumulation)
 266:./_commonCode_localized/tcnter/0.30/tcnter.h **** {
 267:./_commonCode_localized/tcnter/0.30/tcnter.h ****    tcnter_t thisDelta = tcnter_myTcnter - *startTime;
 2625               		.stabn	68,0,267,.LM310-.LFBB22
 2626               	.LM310:
 2627 0a08 8091 0000 		lds r24,tcnter_myTcnter
 2628 0a0c 9091 0000 		lds r25,tcnter_myTcnter+1
 2629 0a10 A091 0000 		lds r26,tcnter_myTcnter+2
 2630 0a14 B091 0000 		lds r27,tcnter_myTcnter+3
 2631 0a18 4091 0000 		lds r20,fbLastUpdateTime.2072
 2632 0a1c 5091 0000 		lds r21,fbLastUpdateTime.2072+1
 2633 0a20 6091 0000 		lds r22,fbLastUpdateTime.2072+2
 2634 0a24 7091 0000 		lds r23,fbLastUpdateTime.2072+3
 2635 0a28 841B      		sub r24,r20
 2636 0a2a 950B      		sbc r25,r21
 2637 0a2c A60B      		sbc r26,r22
 2638 0a2e B70B      		sbc r27,r23
 268:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 269:./_commonCode_localized/tcnter/0.30/tcnter.h ****    if(thisDelta >= deltaTime)
 2639               		.stabn	68,0,269,.LM311-.LFBB22
 2640               	.LM311:
 2641 0a30 8034      		cpi r24,64
 2642 0a32 9D40      		sbci r25,13
 2643 0a34 A340      		sbci r26,3
 2644 0a36 B105      		cpc r27,__zero_reg__
 2645 0a38 00F0      		brlo .L183
 270:./_commonCode_localized/tcnter/0.30/tcnter.h ****    {
 271:./_commonCode_localized/tcnter/0.30/tcnter.h **** 		if(dontAllowCumulation)
 272:./_commonCode_localized/tcnter/0.30/tcnter.h ****       	*startTime = tcnter_myTcnter - (thisDelta - deltaTime);
 273:./_commonCode_localized/tcnter/0.30/tcnter.h ****       else
 274:./_commonCode_localized/tcnter/0.30/tcnter.h **** 			*startTime = tcnter_myTcnter;
 2646               		.stabn	68,0,274,.LM312-.LFBB22
 2647               	.LM312:
 2648 0a3a 8091 0000 		lds r24,tcnter_myTcnter
 2649 0a3e 9091 0000 		lds r25,tcnter_myTcnter+1
 2650 0a42 A091 0000 		lds r26,tcnter_myTcnter+2
 2651 0a46 B091 0000 		lds r27,tcnter_myTcnter+3
 2652 0a4a 8093 0000 		sts fbLastUpdateTime.2072,r24
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 116


 2653 0a4e 9093 0000 		sts fbLastUpdateTime.2072+1,r25
 2654 0a52 A093 0000 		sts fbLastUpdateTime.2072+2,r26
 2655 0a56 B093 0000 		sts fbLastUpdateTime.2072+3,r27
 2656               	.LBE111:
 2657               	.LBE110:
 2658               	.LBB112:
 2659               		.stabs	"./_options/frameBuffer.c",132,0,0,.Ltext22
 2660               	.Ltext22:
 237:./_options/frameBuffer.c **** 		}
 238:./_options/frameBuffer.c **** 
 239:./_options/frameBuffer.c **** 		// Since lastUpdateTime is updated each time this function is called
 240:./_options/frameBuffer.c **** 		// with updateFrame != 0, this test will fail until 100ms after the
 241:./_options/frameBuffer.c **** 		// last refresh.
 242:./_options/frameBuffer.c **** 		// (a/o v71 this has changed, it was in an else, and this else-case
 243:./_options/frameBuffer.c **** 		// handled multiple-refresh. That should now be handled in
 244:./_options/frameBuffer.c **** 		// endOfFrameHandler())
 245:./_options/frameBuffer.c ****       if(fb_isItTime(&fbLastUpdateTime, FB_REFRESH_ON_CHANGE_DELAY))
 246:./_options/frameBuffer.c ****       {
 247:./_options/frameBuffer.c **** 			int16_t fb_changedTillRow = fb_updater();
 2661               		.stabn	68,0,247,.LM313-.LFBB22
 2662               	.LM313:
 2663 0a5a 00D0      		rcall fbQuestion_update
 248:./_options/frameBuffer.c **** 			//call fb_updater()
 249:./_options/frameBuffer.c **** 			// and ONLY REFRESH if there's been a change to the frameBuffer
 250:./_options/frameBuffer.c ****       	if(fb_changedTillRow != -1)
 2664               		.stabn	68,0,250,.LM314-.LFBB22
 2665               	.LM314:
 2666 0a5c 8F3F      		cpi r24,lo8(-1)
 2667 0a5e 01F0      		breq .L183
 2668               	.LBB113:
 2669               	.LBB114:
 2670               		.stabs	"main.c",132,0,0,.Ltext23
 2671               	.Ltext23:
   1:main.c        **** /* mehPL:
   2:main.c        ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:main.c        ****  *    I'm not too fond of long licenses at the top of the file.
   4:main.c        ****  *    Please see the bottom.
   5:main.c        ****  *    Enjoy!
   6:main.c        ****  */
   7:main.c        **** 
   8:main.c        **** 
   9:main.c        **** 
  10:main.c        **** 
  11:main.c        **** 
  12:main.c        **** 
  13:main.c        **** 
  14:main.c        **** 
  15:main.c        **** // Please see mainConfig.h!
  16:main.c        **** 
  17:main.c        **** 
  18:main.c        **** //The order of these #includes is *very specific*
  19:main.c        **** // please see the associated files (especially lcdStuff, lcdDefines, and
  20:main.c        **** // lvds)
  21:main.c        **** 
  22:main.c        **** 
  23:main.c        **** //This file contains code for *many* options, chosen by mainConfig.h
  24:main.c        **** // (and possibly makefile)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 117


  25:main.c        **** 
  26:main.c        **** 
  27:main.c        **** 
  28:main.c        **** #include "projInfo.h"   //Don't include in main.h 'cause that's included in other .c's?
  29:main.c        **** #include "main.h"
  30:main.c        **** //#include <util/delay.h> //For delay_us in pll_enable
  31:main.c        **** #include <avr/pgmspace.h>
  32:main.c        **** #include _TIMERCOMMON_HEADER_
  33:main.c        **** //#include "../../../_commonCode/charBitmap/0.10/charBitmap.h"
  34:main.c        **** #include "fbColors.h"
  35:main.c        **** 
  36:main.c        **** 
  37:main.c        **** 
  38:main.c        **** 
  39:main.c        **** 
  40:main.c        **** #include "mainConfig.h"
  41:main.c        **** 
  42:main.c        **** 
  43:main.c        **** //This is hokey, just trying to free up space
  44:main.c        **** // Frankly, these should only be included as-needed
  45:main.c        **** #if (!defined(FB_QUESTION) || !FB_QUESTION)
  46:main.c        **** #warning "These should only be included as-needed!"
  47:main.c        **** //These two saved 800Bytes
  48:main.c        **** // But that's probably just charBitmap, because sineTable is compiled via
  49:main.c        **** // the makefile.
  50:main.c        **** // Yeahp.
  51:main.c        **** #include _SINETABLE_HEADER_
  52:main.c        **** #include _CHARBITMAP_HEADER_
  53:main.c        **** #endif
  54:main.c        **** 
  55:main.c        **** 
  56:main.c        **** 
  57:main.c        **** #include "delay_cyc.h"
  58:main.c        **** 
  59:main.c        **** 
  60:main.c        **** //This should be handled in mainConfig, now...
  61:main.c        **** #if (!defined(FB_REFRESH_ON_CHANGE) || !FB_REFRESH_ON_CHANGE)
  62:main.c        ****  #define FB_REFRESH_ON_CHANGE_COUNT	TRUE
  63:main.c        **** #else
  64:main.c        ****  #ifndef FB_REFRESH_ON_CHANGE_COUNT
  65:main.c        ****   #define FB_REFRESH_ON_CHANGE_COUNT	5
  66:main.c        ****  #endif
  67:main.c        **** #endif
  68:main.c        **** 
  69:main.c        **** 
  70:main.c        **** 
  71:main.c        **** #if (defined(ROW_SEG_BUFFER) && ROW_SEG_BUFFER)
  72:main.c        **** 	 #include "rowSegBuffer.h"
  73:main.c        **** #endif
  74:main.c        **** 
  75:main.c        **** //a/o v70: this should be handled by writeColor.c now
  76:main.c        **** //Nope, can't be removed yet...
  77:main.c        **** //#define ROW_BUFFER FALSE
  78:main.c        **** //#define LOADROW TRUE
  79:main.c        **** //#if (defined(ROW_BUFFER) && ROW_BUFFER)
  80:main.c        **** //#error
  81:main.c        **** //#include "rowBuffer.c"
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 118


  82:main.c        **** //#endif
  83:main.c        **** 
  84:main.c        **** #if (defined(SEG_TET) && SEG_TET)
  85:main.c        ****  #include "_options/tetStuff.c"
  86:main.c        **** #endif
  87:main.c        **** 
  88:main.c        **** 
  89:main.c        **** #if (defined(BLUE_ADC) && BLUE_ADC)
  90:main.c        ****  #include _ADC_HEADER_
  91:main.c        **** #endif
  92:main.c        **** 
  93:main.c        **** #if (defined(PIEZO_HIT_DETECTION) && PIEZO_HIT_DETECTION)
  94:main.c        **** //#if (defined(FB_QUESTION) && FB_QUESTION)
  95:main.c        ****  #include _PIEZOHITDETECTOR_CFILE_
  96:main.c        **** #endif
  97:main.c        **** 
  98:main.c        **** #define OSCCAL_VAL	0xff//0xDB//0xDC//0xE0//0//0xff//0x20//0xff //0x00
  99:main.c        **** #include "delay_cyc.c"
 100:main.c        **** #include "lcdDefines.h"
 101:main.c        **** 
 102:main.c        **** //Now included in lvds[161].c:
 103:main.c        **** //#include "pll.c"
 104:main.c        **** 
 105:main.c        **** 
 106:main.c        **** 
 107:main.c        **** 
 108:main.c        **** 
 109:main.c        **** #if(defined(FB_SMILEY) && FB_SMILEY)
 110:main.c        ****  #define FB_WIDTH 16
 111:main.c        ****  #define FB_HEIGHT 16
 112:main.c        **** #elif (defined(FB_QUESTION) && FB_QUESTION)
 113:main.c        ****  #define FB_WIDTH 16
 114:main.c        ****  #define FB_HEIGHT 16
 115:main.c        **** #elif (defined(FB_TETRIS) && FB_TETRIS)
 116:main.c        ****  #define FB_WIDTH	24
 117:main.c        ****  #define FB_HEIGHT 24
 118:main.c        **** #elif (defined(FB_HEXCOLOR) && FB_HEXCOLOR)
 119:main.c        ****  #define FB_WIDTH 16
 120:main.c        ****  #define FB_HEIGHT 16
 121:main.c        **** #endif
 122:main.c        **** 
 123:main.c        **** #if (defined(FB_QUESTION) && FB_QUESTION)
 124:main.c        ****  #if (defined(BUMP_SWITCH) && BUMP_SWITCH)
 125:main.c        ****   //#error "OK1"
 126:main.c        ****   #include "_hitSensors/bumpSwitch.c"
 127:main.c        ****  #endif
 128:main.c        **** #endif
 129:main.c        **** 
 130:main.c        **** #include _LCD_INTERFACE_CFILE_
 131:main.c        **** /*
 132:main.c        **** #if (defined(__AVR_AT90PWM161__))
 133:main.c        ****  #include "_interfaces/lvds161.c"
 134:main.c        **** #else
 135:main.c        ****  #include "_interfaces/lvds.c"
 136:main.c        **** #endif
 137:main.c        **** */
 138:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 119


 139:main.c        **** 
 140:main.c        **** #if(defined(FB_SMILEY) && FB_SMILEY)
 141:main.c        ****  #define fb_updater()	smileyUpdate()
 142:main.c        **** #elif (defined(FB_QUESTION) && FB_QUESTION)
 143:main.c        ****  #include "fb_question.h"
 144:main.c        ****  #define fb_updater()	fbQuestion_update()
 145:main.c        **** #elif (defined(FB_TETRIS) && FB_TETRIS)
 146:main.c        **** //These are just rough estimates...
 147:main.c        ****  #include "_options/tetStuff.c"
 148:main.c        ****  #define fb_updater()	tetUpdate()
 149:main.c        **** #elif (defined(FB_HEXCOLOR) && FB_HEXCOLOR)
 150:main.c        ****  #include "_options/hexColor.c"
 151:main.c        ****  #define fb_updater()	hexColor_update()
 152:main.c        **** #endif
 153:main.c        **** 
 154:main.c        **** uint8_t isNewFrame(void);
 155:main.c        **** 
 156:main.c        **** #if ( (defined(FRAMEBUFFER_TESTING) && FRAMEBUFFER_TESTING) || \
 157:main.c        **** 		(defined(ROWBUFFER_TESTING) && ROWBUFFER_TESTING) )
 158:main.c        ****  #include "_options/writeColor.c"
 159:main.c        **** #endif
 160:main.c        **** 
 161:main.c        **** 
 162:main.c        **** 
 163:main.c        **** 
 164:main.c        **** #if (defined(FB_QUESTION) && FB_QUESTION)
 165:main.c        ****  #include "fb_question.c"
 166:main.c        **** #endif
 167:main.c        **** 
 168:main.c        **** // a/o v59:
 169:main.c        **** //PSEGS are the "pixel segments" addressable in RowSegmentBuffer
 170:main.c        **** // e.g. one could load a single row-segment NUM_PSEGS long, and it would 
 171:main.c        **** // reach from one edge of the screen to the other
 172:main.c        **** // or any number <=NUM_SEGMENTS of row segments whose lengths all add up to
 173:main.c        **** // <=NUM_PSEGS. (It's possible to extend beyond NUM_PSEGS, which would draw
 174:main.c        **** // beyond the edge of the screen, but it may affect the screen's ability 
 175:main.c        **** // to sync properly)
 176:main.c        **** // This value isn't exactly adjustable, it's a characteristic of the
 177:main.c        **** // ratio of the pixel-clock and the system-clock, along with the number of
 178:main.c        **** // system clock cycles used to draw each pixel.
 179:main.c        **** // This value was determined by experimentation with the very specific 
 180:main.c        **** // configuration currently in use, though it could probably be calculated 
 181:main.c        **** // from other #defines elsewhere.
 182:main.c        **** // (and probably *should* be, at some point, especially with 
 183:main.c        **** //  experimentations with PLLSYSCLK, LVDS_PRESCALER, SLOW_LVDS, etc...)
 184:main.c        **** // For now, changing this doesn't really do anything except scale some 
 185:main.c        **** // drawings horizontally (E.G. SEG_RACER)
 186:main.c        **** //These notes were determined long ago when developing SEG_RACER:
 187:main.c        **** // Wasn't sure where 357 came from... and now I'm wondering where the
 188:main.c        **** // notes I wrote regarding it disappeared to...
 189:main.c        **** // Anyhow, from line 72, if ROW_SEG_BUFFER && !LVDS_PRESCALER
 190:main.c        **** // "ROW_SEG_BUFFER uses 20cyc/pixel" (doesn't match the math I've 
 191:main.c        **** // elsewhere) 1024/20*7 = 358.4... so maybe that's something to do with it
 192:main.c        **** // TODO: If it was 21cyc/pixel, wouldn't we have perfect alignment with
 193:main.c        **** //       color-transitions and segment widths?
 194:main.c        **** //#define NUM_PSEGS	(1024/3+16) //357
 195:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 120


 196:main.c        **** #if (LVDS_PRESCALER == 1)
 197:main.c        ****  #warning "LVDS_PRESCALER == 1 is used extensively a/o v62 to indicate that	we're testing v62... th
 198:main.c        ****  //Let's see if this math can be figured out...
 199:main.c        ****  //
 200:main.c        ****  // Hah, right??? I completely forgot about SQUARE_SEGMENTS in all this
 201:main.c        ****  // Assuming they're always square, for now.
 202:main.c        ****  //
 203:main.c        ****  // H_PIXELS (DE_ACTIVE_DOTS)		1024             pixels
 204:main.c        ****  
 205:main.c        ****  // LVDS_PRESCALER					(1,2,4,8...)     pll_cyc/lvds_bit
 206:main.c        ****  //    PLLCYC_PER_LVDSBIT        LVDS_PRESCALER
 207:main.c        **** 
 208:main.c        ****  // LVDS_BITS_PER_PIXEL				7                lvds_bits/pixel
 209:main.c        ****  // PLL_SYSCLK
 210:main.c        ****  //    TRUE:  PLLCYC_PER_CPUCYC  4                pll_cyc/cpu_cyc
 211:main.c        ****  //    FALSE: PLLCYC_PER_CPUCYC  8                pll_cyc/cpu_cyc
 212:main.c        ****  // DRAWSEG_CPU_CYCS_PER_PSEG		20               cpu_cyc/pseg
 213:main.c        ****  //
 214:main.c        ****  // PIXELS_PER_PSEG = 1pseg * CPUCYCS_PER_PSEG   -> cpu_cycs
 215:main.c        ****  //                         * PLLCYC_PER_CPUCYC  -> pll_cycs
 216:main.c        ****  //                         / PLLCYC_PER_LVDSBIT -> lvds_bits
 217:main.c        ****  //                         / LVDSBITS_PER_PIXEL -> pixels
 218:main.c        ****  //   This is where dimensional-analysis always bites me in the ass...
 219:main.c        ****  //   my units are now PIXELS_PER_PSEG = pix/pseg = pix
 220:main.c        ****  //   I THINK (and this is an epiphany after years of recurring troubles
 221:main.c        ****  //   here) it's possible to, instead, note that 1pseg came from *nowhere*
 222:main.c        ****  //   so should be 1pseg/1pseg * <all the dimensional-analysis stuff>
 223:main.c        ****  //   Then:
 224:main.c        ****  //   (Note, in most cases PIXELS_PER_PSEG will be small, and here
 225:main.c        ****  //   fractions are highly important...)
 226:main.c        ****  #define CPUCYC_PER_PSEG	(DRAWSEG_CPU_CYCS_PER_PSEG)
 227:main.c        ****  #if(defined(PLL_SYSCLK) && PLL_SYSCLK)
 228:main.c        ****   #define PLLCYC_PER_CPUCYC	4
 229:main.c        ****  #else
 230:main.c        ****   #define PLLCYC_PER_CPUCYC	8
 231:main.c        ****  #endif
 232:main.c        ****  #define PLLCYC_PER_LVDSBIT	(LVDS_PRESCALER)
 233:main.c        ****  #define LVDSBITS_PER_PIXEL	7
 234:main.c        **** 
 235:main.c        ****  #define PIXELS_PER_PSEG_F ( MAKEFLOAT( CPUCYC_PER_PSEG   ) \
 236:main.c        **** 		 							* MAKEFLOAT( PLLCYC_PER_CPUCYC  ) \
 237:main.c        **** 		 							/ MAKEFLOAT( PLLCYC_PER_LVDSBIT ) \
 238:main.c        **** 		 							/ MAKEFLOAT( LVDSBITS_PER_PIXEL ) )
 239:main.c        ****  // NUM_PSEGS = H_PIXELS / PIXELS_PER_PSEG
 240:main.c        ****  #define NUM_PSEGS_F (MAKEFLOAT(DE_ACTIVE_DOTS) / PIXELS_PER_PSEG_F)
 241:main.c        ****  // And here, we're leaving NUM_PSEGS_F as a float so it can be used in 
 242:main.c        ****  // macro-comparisons, if necessary...
 243:main.c        ****  // (I don't think MAKELONG or any other such macro could handle this
 244:main.c        ****  // casting... it may be redundant since most uses would be assignments in
 245:main.c        ****  // integers, but if math is used, we don't want floating-point math to be
 246:main.c        ****  // run on it in real-time calculations...)
 247:main.c        ****  #define NUM_PSEGS ((uint16_t)(NUM_PSEGS_F))
 248:main.c        ****  // As a hand-job test: Using old values (when 357 was determined)
 249:main.c        ****  // DE_ACTIVE_DOTS = 1024
 250:main.c        ****  // CPUCYCS_PER_PSEG = 20
 251:main.c        ****  // PLLCYC_PER_CPUCYC = 8
 252:main.c        ****  // PLLCYC_PER_LVDSBIT =8
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 121


 253:main.c        ****  // LVDSBITS_PER_PIXEL =7
 254:main.c        ****  // 1024 / (20 * 8 / 8 / 7) = 358.4
 255:main.c        ****  // (The old NUM_PSEGS = 1024/3+16 = 357.333)
 256:main.c        ****  // (As an aside, if CPUCYCS_PER_PSEG = 21: 1024/(21*8/8/7)=341.333 
 257:main.c        ****  //    == exactly three pixels per pseg)
 258:main.c        **** #else
 259:main.c        ****  #warning "NUM_PSEGS is hardcoded, but should be calculated by many factors, such as LVDS_PRESCALER
 260:main.c        ****  #define NUM_PSEGS (1024/3+16)
 261:main.c        **** #endif
 262:main.c        **** 
 263:main.c        **** //Yes, I know #including C files is bad-practice...
 264:main.c        **** // and yes, this has to be here... for now.
 265:main.c        **** #if(defined(SEG_RACER) && SEG_RACER)
 266:main.c        ****  #include "seg_racer.c"
 267:main.c        **** #endif
 268:main.c        **** 
 269:main.c        **** 
 270:main.c        **** 
 271:main.c        **** 
 272:main.c        **** 
 273:main.c        **** // a/o v60, this note is OLD, and actually is the whole point behind
 274:main.c        **** // ROW_SEG_BUFFER's current implementation.
 275:main.c        **** // TODO: Between OSCCAL_VAL and FRAME_UPDATE_DELAY
 276:main.c        **** //  it seems the speed (at least for the LTN) isn't so important after all
 277:main.c        **** //  This could be used to my advantage...
 278:main.c        **** //  Maybe bump OSCCAL_VAL all the way up, but use a slower "bit-rate"
 279:main.c        **** //  Thus, pixels could be skinnier, thus higher-resolution.
 280:main.c        **** //   Or more instructions could be used for the same resolution
 281:main.c        **** //   allowing, e.g. sprites from program-memory, without necessitating a
 282:main.c        **** //   large (or any?) frame-buffer...
 283:main.c        **** 
 284:main.c        **** 
 285:main.c        **** //This used to be handled by TOOFAST_TEST, but now can be configured here
 286:main.c        **** // 0xff sets the processor to run as fast as possible 
 287:main.c        **** //  (~16MHz? ~128MHz bit-rate)
 288:main.c        **** // 0x00 sets it as slow as possible (~4MHz, ~32MHz bit-rate)
 289:main.c        **** //  good for testing whether odd colors
 290:main.c        **** //  or bad syncing is due to bits being shifted, etc. 
 291:main.c        **** //  Maybe due to slow "LVDS" conversion chips, or whatnot.
 292:main.c        **** //   This seems to be the case right now... 0xff: black is appearing green
 293:main.c        **** //   There should be *some* green in it, but not this much.
 294:main.c        **** //   Likely due to different propagation delays between my under-driven
 295:main.c        **** //    74LS86's (running red and green), from 3.3V!
 296:main.c        **** //    and the happier and newer 74AHC XOR and OR currently driving the
 297:main.c        **** //    clock and DVH/Blue signals
 298:main.c        **** //  Highly dependent on the screen itself, some may not run at all with
 299:main.c        **** //  such slow bitrates... heck, some may not run at all even at the fastest
 300:main.c        **** // If SLOW_EVERYTHING_TEST is true, this value is overridden
 301:main.c        **** // LTN last used 0x20
 302:main.c        **** // a/o v59:
 303:main.c        **** // 0xD8 is the lowest value that syncs reliably, a few glitches from time
 304:main.c        **** // to time.
 305:main.c        **** // The effect of lower values isn't *quite* what I was expecting, but
 306:main.c        **** // definitely suggests that using ROW_SEG_BUFFER at this bit/refresh-rate
 307:main.c        **** // is dang-near right at the minimum required for this display.
 308:main.c        **** // This might be why the other (same model) display didn't work, but its
 309:main.c        **** // flakeyness at 0xff appeared different than this one's at lower OSCCALs
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 122


 310:main.c        **** // --Later note... actually retrying the "flakey" display with the same
 311:main.c        **** //   configuration. Actually, yes, the problem looks dang-near identical to
 312:main.c        **** //   the "reliable" display's being run at OSCCAL_VALs lower than 0xD8
 313:main.c        **** //   Both displays are of the same manufacturer/model.
 314:main.c        **** //    "reliable" has the chip: LXD91810 VS252AG
 315:main.c        **** //    "flakey"   has the chip: LXD91810 VS242AC
 316:main.c        **** //   The only bit I don't get is that I'm dang-near certain I had both
 317:main.c        **** //   displays working at one point, and from the same code...
 318:main.c        **** //   but this OSCCAL value is the maximum, and the only other way to speed
 319:main.c        **** //   up the bit-rate changes the resolution; which I haven't done
 320:main.c        **** //   for quite some time.
 321:main.c        **** //   Also different about this test than when I originally determined it
 322:main.c        **** //   "flakey": I've since switched the 74LS00 and LS32 out for LS86's
 323:main.c        **** //   (These are wired such that one chip is responsible for the + side of
 324:main.c        **** //    every LVDS signal, and one chip is responsible for the - side.
 325:main.c        **** //    The best-practice, probably, would be to have the + and - sides of
 326:main.c        **** //    an LVDS signal on the same chip. It's also plausible that my test was
 327:main.c        **** //    so long ago that it was on the old board which had this configuration
 328:main.c        **** //    but I doubt that, since that board was so hokily-implemented (with
 329:main.c        **** //    chip-clips and grabbers all over the place) that I can't imagine it
 330:main.c        **** //    was ever running again after all those months of disuse. Though...
 331:main.c        **** //    if that *was* the case... it could also be that I'm using a different
 332:main.c        **** //    ATtiny861... in which case, maybe the RC oscillator and/or PLL aren't
 333:main.c        **** //    capable of running as fast... 
 334:main.c        **** //    Not that I have a ton of these things lying around (three total, in
 335:main.c        **** //    various projects already)
 336:main.c        **** //    BUT the end-result may be that I just happen to have the one display
 337:main.c        **** //    and ATtiny861 on the planet that will work together. That'd be lame.)
 338:main.c        **** //#define OSCCAL_VAL	0xff//0xDB//0xDC//0xE0//0//0xff//0x20//0xff //0x00
 339:main.c        **** //This has been moved to the top...
 340:main.c        **** 
 341:main.c        **** 
 342:main.c        **** 
 343:main.c        **** 
 344:main.c        **** //a/o v60: These are old experiments...
 345:main.c        **** // they *are useful* for testing new displays...
 346:main.c        **** // but I can't recall off-hand how to use them instead of (or with?)
 347:main.c        **** // rowSegBuffer...
 348:main.c        **** // They're defined and better-described in lcdStuff.c...
 349:main.c        **** //These three are mutually-exclusive (BLUE_VERT_BAR overrides DE_BLUE)
 350:main.c        **** // (BLUE_DIAG_BAR overrides both...)
 351:main.c        **** //#define BLUE_DIAG_BAR TRUE
 352:main.c        **** //A single black bar, followed by a single blue bar... ~1/3 and 2/3's width
 353:main.c        **** //#define BLUE_VERT_BAR TRUE
 354:main.c        **** //#define DE_BLUE TRUE
 355:main.c        **** // OLD NOTE:
 356:main.c        **** // NONE SELECTED DOESN'T SYNC!!! DE not detected???
 357:main.c        **** 
 358:main.c        **** 
 359:main.c        **** 
 360:main.c        **** // Default is drawPix, from program memory...
 361:main.c        **** // a/o v60: drawPix() has since become the de-facto function for drawing
 362:main.c        **** // a row of pixels, regardless of the method.
 363:main.c        **** // It's defined as necessary...
 364:main.c        **** 
 365:main.c        **** 
 366:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 123


 367:main.c        **** //This is where COLOR_BAR_SCROLL and PIXEL_SCROLL were, in part.
 368:main.c        **** 
 369:main.c        **** 
 370:main.c        **** 
 371:main.c        **** 
 372:main.c        **** 
 373:main.c        **** 
 374:main.c        **** //#include "lvds.c"
 375:main.c        **** 
 376:main.c        **** 
 377:main.c        **** 
 378:main.c        **** #if(defined(LOADROW) && LOADROW)
 379:main.c        **** static __inline__ \
 380:main.c        **** void loadRow(uint16_t rowNum) \
 381:main.c        **** 	__attribute__((__always_inline__));
 382:main.c        **** #endif
 383:main.c        **** 
 384:main.c        **** #if(defined(PARTIAL_REFRESH) && PARTIAL_REFRESH)
 385:main.c        **** #define FULL_REFRESH	UINT16_MAX
 386:main.c        **** uint16_t stopRefreshAtRow = FULL_REFRESH;
 387:main.c        **** #endif
 388:main.c        **** 
 389:main.c        **** //The endOfFrameHandler() function might e.g. cause the timer-interrupt to
 390:main.c        **** //be disabled until it's time to redraw a new frame
 391:main.c        **** // Since we're working with TFT displays, there is inherent "memory" of the
 392:main.c        **** // last-written frame, so we needn't refresh at the maximum rate possible
 393:main.c        **** // For some displays (e.g. the LTN) the act of refreshing is visible, so
 394:main.c        **** // unless the image changes (or the pixels have faded) it would be best
 395:main.c        **** // *not* to refresh
 396:main.c        **** static __inline__
 397:main.c        **** void endOfFrameHandler(void)
 398:main.c        **** 	__attribute__((__always_inline__));
 399:main.c        **** 
 400:main.c        **** #if(!defined(PWM_TESTING) || !PWM_TESTING)
 401:main.c        ****  //This must (Now) come *after* the display headers, etc...
 402:main.c        ****  // especially for LCDSTUFF_USE_DOTS_TO_CYC_IN_DELAY_DOTS
 403:main.c        ****  #warning "This implementation is a bit hokey... LCDSTUFF_USE_DOTS_TO_CYC_IN_DELAY_DOTS"
 404:main.c        ****  #if(defined(LCDINTERFACE_BITBANGED_DOTCLOCK) &&\
 405:main.c        **** 		 LCDINTERFACE_BITBANGED_DOTCLOCK)
 406:main.c        **** 	#warning "LCDSTUFF_USE_DOTS_TO_CYC_IN_DELAY_DOTS is FALSE (better be a bit-banged dot-clock, other
 407:main.c        **** 	#define LCDSTUFF_USE_DOTS_TO_CYC_IN_DELAY_DOTS	FALSE
 408:main.c        ****  #else
 409:main.c        **** 	#warning "LCDSTUFF_USE_DOTS_TO_CYC_IN_DELAY_DOTS is TRUE (doesn't work with bitbanged dot-clocks!)
 410:main.c        **** 	#define LCDSTUFF_USE_DOTS_TO_CYC_IN_DELAY_DOTS	TRUE
 411:main.c        ****  #endif
 412:main.c        ****  #include _LCDSTUFF_CFILE_
 413:main.c        ****  //#include "../../../_commonCode/lcdStuff/0.50ncf/lcdStuff.c"
 414:main.c        **** 
 415:main.c        **** 	//If REFRESH_ON_CHANGE != TRUE, then FB_REFRESH_ON_CHANGE_COUNT = TRUE
 416:main.c        **** 	// and goes unchanged...
 417:main.c        **** 
 418:main.c        **** 	//updateFrame is decremented in main.c each time the frame is completed
 419:main.c        **** 	// it's reset to FB_REFRESH_ON_CHANGE in _options/frameBuffer.c
 420:main.c        **** 	// (via restartFrameUpdate())
 421:main.c        ****  volatile uint8_t updateFrame = FB_REFRESH_ON_CHANGE_COUNT; //TRUE;
 422:main.c        ****  volatile uint8_t frameCount = 0;
 423:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 124


 424:main.c        **** 
 425:main.c        ****  void restartFrameUpdate(void)
 426:main.c        ****  {
 427:main.c        **** 	updateFrame = FB_REFRESH_ON_CHANGE_COUNT;
 2672               		.stabn	68,0,427,.LM315-.LFBB22
 2673               	.LM315:
 2674 0a60 82E0      		ldi r24,lo8(2)
 2675 0a62 8093 0000 		sts updateFrame,r24
 2676               	.L183:
 2677 0a66 0895      		ret
 2678               	.LBE114:
 2679               	.LBE113:
 2680               	.LBE112:
 2681               		.size	frameBufferUpdate, .-frameBufferUpdate
 2682               		.stabs	"fbLastUpdateTime:V(4,6)",38,0,229,fbLastUpdateTime.2072
 2683               		.stabn	192,0,0,.LFBB22-.LFBB22
 2684               		.stabn	224,0,0,.Lscope22-.LFBB22
 2685               	.Lscope22:
 2686               		.stabs	"",36,0,0,.Lscope22-.LFBB22
 2687               		.stabd	78,0,0
 2688               		.stabs	"getSpritePalette:F(4,2)",36,0,814,getSpritePalette
 2689               		.stabs	"p_thisSprite:P(16,3)",64,0,814,18
 2690               		.stabs	"spritePhase:P(4,2)",64,0,814,24
 2691               		.stabs	"spriteRow:P(4,2)",64,0,815,20
 2692               	.global	getSpritePalette
 2693               		.type	getSpritePalette, @function
 2694               	getSpritePalette:
 2695               		.stabd	46,0,0
 2696               		.stabs	"fb_question.c",132,0,0,.Ltext24
 2697               	.Ltext24:
 813:fb_question.c **** 
 814:fb_question.c **** uint8_t getSpritePalette(const __flash sprite_t *p_thisSprite, uint8_t spritePhase,
 815:fb_question.c **** 																	uint8_t spriteRow)
 816:fb_question.c **** {
 2698               		.stabn	68,0,816,.LM316-.LFBB23
 2699               	.LM316:
 2700               	.LFBB23:
 2701               	/* prologue: function */
 2702               	/* frame size = 0 */
 2703               	/* stack size = 0 */
 2704               	.L__stack_usage = 0
 2705 0a68 9C01      		movw r18,r24
 2706 0a6a 862F      		mov r24,r22
 817:fb_question.c **** 
 818:fb_question.c **** 	uint8_t thePalette;
 819:fb_question.c **** 	
 820:fb_question.c **** 	
 821:fb_question.c **** 	if(p_thisSprite == &spriteFLOWER)
 2707               		.stabn	68,0,821,.LM317-.LFBB23
 2708               	.LM317:
 2709 0a6c 90E0      		ldi r25,hi8(spriteFLOWER)
 2710 0a6e 2030      		cpi r18,lo8(spriteFLOWER)
 2711 0a70 3907      		cpc r19,r25
 2712 0a72 01F4      		brne .L192
 822:fb_question.c **** 	{
 823:fb_question.c **** 		if(spriteRow<FLOWER_PALETTE1_ROW)
 2713               		.stabn	68,0,823,.LM318-.LFBB23
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 125


 2714               	.LM318:
 2715 0a74 4830      		cpi r20,lo8(8)
 2716 0a76 00F4      		brsh .L201
 824:fb_question.c **** 			//data = getGimpColorVal(&spriteFLOWER,
 825:fb_question.c **** 			  thePalette = spritePhase%(spriteFLOWER.numPalettes-1) + 1; 
 2717               		.stabn	68,0,825,.LM319-.LFBB23
 2718               	.LM319:
 2719 0a78 962F      		mov r25,r22
 2720 0a7a 9170      		andi r25,lo8(1)
 2721 0a7c 9F5F      		subi r25,lo8(-(1))
 2722 0a7e 00C0      		rjmp .L193
 2723               	.L192:
 826:fb_question.c **** 					 //spriteRow, qCol);
 827:fb_question.c **** 		else
 828:fb_question.c **** 			thePalette = 0;
 829:fb_question.c **** 			//data = getGimpColorVal(&spriteFLOWER, 0, spriteRow, qCol);
 830:fb_question.c **** 	}
 831:fb_question.c **** 	else if(p_thisSprite == &spriteGOOMBA)
 2724               		.stabn	68,0,831,.LM320-.LFBB23
 2725               	.LM320:
 2726 0a80 90E0      		ldi r25,hi8(spriteGOOMBA)
 2727 0a82 2030      		cpi r18,lo8(spriteGOOMBA)
 2728 0a84 3907      		cpc r19,r25
 2729 0a86 01F4      		brne .L194
 832:fb_question.c **** 	{
 833:fb_question.c **** 		//uint8_t gCol = qCol;
 834:fb_question.c **** 		//Goomba moves by flipping horizontally...
 835:fb_question.c **** 	//	if((spritePhase < 16) && (spritePhase & 0x01))
 836:fb_question.c **** 	//		theCol = 15-qCol;
 837:fb_question.c **** 
 838:fb_question.c **** 		//uint8_t palette; // = qCount * p_thisSprite->numPalettes / 16;
 839:fb_question.c **** 		//if(palette >= p_thisSprite->numPalettes)
 840:fb_question.c **** 		//	palette = p_thisSprite->numPalettes-1;
 841:fb_question.c **** 
 842:fb_question.c **** 			
 843:fb_question.c **** 		switch(spritePhase)
 2730               		.stabn	68,0,843,.LM321-.LFBB23
 2731               	.LM321:
 2732 0a88 90E0      		ldi r25,0
 2733 0a8a 8031      		cpi r24,16
 2734 0a8c 9105      		cpc r25,__zero_reg__
 2735 0a8e 00F4      		brsh .L195
 2736 0a90 FC01      		movw r30,r24
 2737 0a92 E050      		subi r30,lo8(-(gs(.L197)))
 2738 0a94 F040      		sbci r31,hi8(-(gs(.L197)))
 2739 0a96 0994      		ijmp
 2740               		.section	.progmem.gcc_sw_table,"ax",@progbits
 2741               		.p2align	1
 2742               	.L197:
 2743 0024 00C0      		rjmp .L201
 2744 0026 00C0      		rjmp .L201
 2745 0028 00C0      		rjmp .L201
 2746 002a 00C0      		rjmp .L201
 2747 002c 00C0      		rjmp .L202
 2748 002e 00C0      		rjmp .L202
 2749 0030 00C0      		rjmp .L202
 2750 0032 00C0      		rjmp .L198
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 126


 2751 0034 00C0      		rjmp .L198
 2752 0036 00C0      		rjmp .L198
 2753 0038 00C0      		rjmp .L199
 2754 003a 00C0      		rjmp .L199
 2755 003c 00C0      		rjmp .L199
 2756 003e 00C0      		rjmp .L200
 2757 0040 00C0      		rjmp .L200
 2758 0042 00C0      		rjmp .L200
 2759               		.text
 2760               	.L198:
 844:fb_question.c **** 		{
 845:fb_question.c **** 				case 0:
 846:fb_question.c **** 				case 1:
 847:fb_question.c **** 				case 2:
 848:fb_question.c **** 				case 3:
 849:fb_question.c **** 					thePalette = 0;
 850:fb_question.c **** 					break;
 851:fb_question.c **** 				case 4:
 852:fb_question.c **** 				case 5:
 853:fb_question.c **** 				case 6:
 854:fb_question.c **** 					thePalette = 1;
 855:fb_question.c **** 					break;
 856:fb_question.c **** 				case 7:
 857:fb_question.c **** 				case 8:
 858:fb_question.c **** 				case 9:
 859:fb_question.c **** 					thePalette = 2;
 2761               		.stabn	68,0,859,.LM322-.LFBB23
 2762               	.LM322:
 2763 0a98 92E0      		ldi r25,lo8(2)
 860:fb_question.c **** 					break;
 2764               		.stabn	68,0,860,.LM323-.LFBB23
 2765               	.LM323:
 2766 0a9a 00C0      		rjmp .L193
 2767               	.L199:
 861:fb_question.c **** 				case 10:
 862:fb_question.c **** 				case 11:
 863:fb_question.c **** 				case 12:
 864:fb_question.c **** 					thePalette = 3;
 2768               		.stabn	68,0,864,.LM324-.LFBB23
 2769               	.LM324:
 2770 0a9c 93E0      		ldi r25,lo8(3)
 865:fb_question.c **** 					break;
 2771               		.stabn	68,0,865,.LM325-.LFBB23
 2772               	.LM325:
 2773 0a9e 00C0      		rjmp .L193
 2774               	.L200:
 866:fb_question.c **** 				case 13:
 867:fb_question.c **** 				case 14:
 868:fb_question.c **** 				case 15:
 869:fb_question.c **** 					thePalette = 4;
 2775               		.stabn	68,0,869,.LM326-.LFBB23
 2776               	.LM326:
 2777 0aa0 94E0      		ldi r25,lo8(4)
 870:fb_question.c **** 					break;
 2778               		.stabn	68,0,870,.LM327-.LFBB23
 2779               	.LM327:
 2780 0aa2 00C0      		rjmp .L193
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 127


 2781               	.L195:
 871:fb_question.c **** 				default:
 872:fb_question.c **** 					thePalette = p_thisSprite->numPalettes-1;
 2782               		.stabn	68,0,872,.LM328-.LFBB23
 2783               	.LM328:
 2784 0aa4 95E0      		ldi r25,lo8(5)
 2785 0aa6 00C0      		rjmp .L193
 2786               	.L194:
 873:fb_question.c **** 		}
 874:fb_question.c **** 
 875:fb_question.c **** 
 876:fb_question.c **** 		//data = getGimpColorVal(&spriteGOOMBA, palette, spriteRow, gCol);
 877:fb_question.c **** 	}
 878:fb_question.c **** 	else
 879:fb_question.c **** 	{
 880:fb_question.c **** 		//data = getGimpColorVal(p_thisSprite, 
 881:fb_question.c **** 		  thePalette = spritePhase%p_thisSprite->numPalettes;
 2787               		.stabn	68,0,881,.LM329-.LFBB23
 2788               	.LM329:
 2789 0aa8 F901      		movw r30,r18
 2790 0aaa 3696      		adiw r30,6
 2791 0aac 6491      		lpm r22,Z
 2792 0aae 00D0      		rcall __udivmodqi4
 2793 0ab0 00C0      		rjmp .L193
 2794               	.L201:
 828:fb_question.c **** 			//data = getGimpColorVal(&spriteFLOWER, 0, spriteRow, qCol);
 2795               		.stabn	68,0,828,.LM330-.LFBB23
 2796               	.LM330:
 2797 0ab2 90E0      		ldi r25,0
 2798 0ab4 00C0      		rjmp .L193
 2799               	.L202:
 854:fb_question.c **** 					break;
 2800               		.stabn	68,0,854,.LM331-.LFBB23
 2801               	.LM331:
 2802 0ab6 91E0      		ldi r25,lo8(1)
 2803               	.L193:
 882:fb_question.c **** 						//spriteRow, qCol);
 883:fb_question.c **** 	}
 884:fb_question.c **** 
 885:fb_question.c **** 	return thePalette;
 886:fb_question.c **** }
 2804               		.stabn	68,0,886,.LM332-.LFBB23
 2805               	.LM332:
 2806 0ab8 892F      		mov r24,r25
 2807 0aba 0895      		ret
 2808               		.size	getSpritePalette, .-getSpritePalette
 2809               		.stabs	"thePalette:r(4,2)",64,0,818,25
 2810               		.stabn	192,0,0,.LFBB23-.LFBB23
 2811               		.stabn	224,0,0,.Lscope23-.LFBB23
 2812               	.Lscope23:
 2813               		.stabs	"",36,0,0,.Lscope23-.LFBB23
 2814               		.stabd	78,0,0
 2815               		.stabs	"getSpritePhase:F(4,2)",36,0,892,getSpritePhase
 2816               		.stabs	"p_thisSprite:P(16,3)",64,0,892,18
 2817               		.stabs	"qCount:P(4,2)",64,0,892,24
 2818               		.stabs	"vOffset:P(4,1)",64,0,893,20
 2819               	.global	getSpritePhase
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 128


 2820               		.type	getSpritePhase, @function
 2821               	getSpritePhase:
 2822               		.stabd	46,0,0
 887:fb_question.c **** 
 888:fb_question.c **** //This does NOT handle COIN, see getRowPixelValCOIN()...
 889:fb_question.c **** // vOffset is whether the sprite is above the frame-buffer or below...
 890:fb_question.c **** // centered = 0
 891:fb_question.c **** // so, e.g. vOffset = spriteRow - rowToDrawAt
 892:fb_question.c **** uint8_t getSpritePhase(const __flash sprite_t *p_thisSprite, uint8_t qCount, int8_t
 893:fb_question.c **** 		vOffset)
 894:fb_question.c **** {
 2823               		.stabn	68,0,894,.LM333-.LFBB24
 2824               	.LM333:
 2825               	.LFBB24:
 2826               	/* prologue: function */
 2827               	/* frame size = 0 */
 2828               	/* stack size = 0 */
 2829               	.L__stack_usage = 0
 2830 0abc 9C01      		movw r18,r24
 2831 0abe 862F      		mov r24,r22
 895:fb_question.c **** 	uint8_t spritePhase = qCount;
 896:fb_question.c **** 
 897:fb_question.c **** 	if(p_thisSprite == &spriteQ)
 2832               		.stabn	68,0,897,.LM334-.LFBB24
 2833               	.LM334:
 2834 0ac0 90E0      		ldi r25,hi8(spriteQ)
 2835 0ac2 2030      		cpi r18,lo8(spriteQ)
 2836 0ac4 3907      		cpc r19,r25
 2837 0ac6 01F4      		brne .L204
 898:fb_question.c **** 	{
 899:fb_question.c **** 		switch(spritePhase%12)
 2838               		.stabn	68,0,899,.LM335-.LFBB24
 2839               	.LM335:
 2840 0ac8 6CE0      		ldi r22,lo8(12)
 2841 0aca 00D0      		rcall __udivmodqi4
 2842 0acc 892F      		mov r24,r25
 2843 0ace 90E0      		ldi r25,0
 2844 0ad0 8C30      		cpi r24,12
 2845 0ad2 9105      		cpc r25,__zero_reg__
 2846 0ad4 00F4      		brsh .L205
 2847 0ad6 FC01      		movw r30,r24
 2848 0ad8 E050      		subi r30,lo8(-(gs(.L207)))
 2849 0ada F040      		sbci r31,hi8(-(gs(.L207)))
 2850 0adc 0994      		ijmp
 2851               		.section	.progmem.gcc_sw_table,"ax",@progbits
 2852               		.p2align	1
 2853               	.L207:
 2854 0044 00C0      		rjmp .L206
 2855 0046 00C0      		rjmp .L206
 2856 0048 00C0      		rjmp .L206
 2857 004a 00C0      		rjmp .L210
 2858 004c 00C0      		rjmp .L210
 2859 004e 00C0      		rjmp .L205
 2860 0050 00C0      		rjmp .L205
 2861 0052 00C0      		rjmp .L210
 2862 0054 00C0      		rjmp .L210
 2863 0056 00C0      		rjmp .L206
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 129


 2864 0058 00C0      		rjmp .L206
 2865 005a 00C0      		rjmp .L206
 2866               		.text
 2867               	.L206:
 900:fb_question.c **** 		{
 901:fb_question.c **** 			case 0:
 902:fb_question.c **** 			case 1:
 903:fb_question.c **** 			case 2:
 904:fb_question.c **** 
 905:fb_question.c **** 			case 9:
 906:fb_question.c **** 			case 10:
 907:fb_question.c **** 			case 11:
 908:fb_question.c **** 				spritePhase = 0; //yellow background
 2868               		.stabn	68,0,908,.LM336-.LFBB24
 2869               	.LM336:
 2870 0ade 80E0      		ldi r24,0
 2871 0ae0 0895      		ret
 2872               	.L205:
 909:fb_question.c **** 				break;
 910:fb_question.c **** 			case 3:
 911:fb_question.c **** 			case 4:
 912:fb_question.c **** 
 913:fb_question.c **** 			case 7:
 914:fb_question.c **** 			case 8:
 915:fb_question.c **** 				spritePhase = 1; //red background
 916:fb_question.c **** 				break;
 917:fb_question.c **** 			case 5:
 918:fb_question.c **** 			case 6:
 919:fb_question.c **** 
 920:fb_question.c **** 			default:
 921:fb_question.c **** 				spritePhase = 2; //brown background
 2873               		.stabn	68,0,921,.LM337-.LFBB24
 2874               	.LM337:
 2875 0ae2 82E0      		ldi r24,lo8(2)
 922:fb_question.c **** 				break;
 2876               		.stabn	68,0,922,.LM338-.LFBB24
 2877               	.LM338:
 2878 0ae4 0895      		ret
 2879               	.L204:
 923:fb_question.c **** 		}
 924:fb_question.c **** 
 925:fb_question.c **** 	}
 926:fb_question.c **** 	//else if(p_thisSprite == &spriteCOIN) //handled in getRowPixelValCOIN()
 927:fb_question.c **** 	else if(p_thisSprite == &spriteGOOMBA)
 2880               		.stabn	68,0,927,.LM339-.LFBB24
 2881               	.LM339:
 2882 0ae6 2050      		subi r18,lo8(spriteGOOMBA)
 2883 0ae8 3040      		sbci r19,hi8(spriteGOOMBA)
 2884 0aea 01F4      		brne .L208
 928:fb_question.c **** 	{
 929:fb_question.c **** 		if (vOffset < 0) //(spriteRow < rowToDrawAt)
 2885               		.stabn	68,0,929,.LM340-.LFBB24
 2886               	.LM340:
 2887 0aec 47FD      		sbrc r20,7
 2888 0aee 00C0      		rjmp .L211
 930:fb_question.c **** 			spritePhase = 0;
 931:fb_question.c **** 		if (vOffset > 0) //(spriteRow > rowToDrawAt)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 130


 2889               		.stabn	68,0,931,.LM341-.LFBB24
 2890               	.LM341:
 2891 0af0 4111      		cpse r20,__zero_reg__
 2892 0af2 00C0      		rjmp .L212
 2893 0af4 00C0      		rjmp .L209
 2894               	.L211:
 930:fb_question.c **** 			spritePhase = 0;
 2895               		.stabn	68,0,930,.LM342-.LFBB24
 2896               	.LM342:
 2897 0af6 80E0      		ldi r24,0
 2898               	.L209:
 932:fb_question.c **** 			spritePhase = GOOMBA_QCOUNT;
 933:fb_question.c **** 		else
 934:fb_question.c **** 			spritePhase /=3;
 2899               		.stabn	68,0,934,.LM343-.LFBB24
 2900               	.LM343:
 2901 0af8 63E0      		ldi r22,lo8(3)
 2902 0afa 00D0      		rcall __udivmodqi4
 2903 0afc 0895      		ret
 2904               	.L210:
 915:fb_question.c **** 				break;
 2905               		.stabn	68,0,915,.LM344-.LFBB24
 2906               	.LM344:
 2907 0afe 81E0      		ldi r24,lo8(1)
 2908 0b00 0895      		ret
 2909               	.L212:
 932:fb_question.c **** 			spritePhase = GOOMBA_QCOUNT;
 2910               		.stabn	68,0,932,.LM345-.LFBB24
 2911               	.LM345:
 2912 0b02 80E5      		ldi r24,lo8(80)
 2913               	.L208:
 935:fb_question.c **** 
 936:fb_question.c **** 	}
 937:fb_question.c **** 
 938:fb_question.c **** 	return spritePhase;
 939:fb_question.c **** 
 940:fb_question.c **** }
 2914               		.stabn	68,0,940,.LM346-.LFBB24
 2915               	.LM346:
 2916 0b04 0895      		ret
 2917               		.size	getSpritePhase, .-getSpritePhase
 2918               	.Lscope24:
 2919               		.stabs	"",36,0,0,.Lscope24-.LFBB24
 2920               		.stabd	78,0,0
 2921               		.stabs	"lcd_init:F(0,47)",36,0,1056,lcd_init
 2922               	.global	lcd_init
 2923               		.type	lcd_init, @function
 2924               	lcd_init:
 2925               		.stabd	46,0,0
 2926               		.stabs	"_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c",132,0,0,.Ltext25
 2927               	.Ltext25:
   1:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** /* mehPL:
   2:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  *    Please see the bottom.
   5:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  *    Enjoy!
   6:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 131


   7:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
   8:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
   9:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //lcdStuff 0.80ncfDD6651-3
  10:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
  11:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.80ncfDD6651-3 - BLUE_DIAG_BAR doesn't work with sony bit-banged (duh)
  12:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                  What to do about delay_cyc where delay_Dots should
  13:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                  always be...?
  14:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                  LCDSTUFF_USE_DOTS_TO_CYC_IN_DELAY_DOTS
  15:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.80ncfDD6651-2 - BLUE_BORDER doesn't work with BOE... timings?
  16:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.80ncfDD6651-1 - a/o LCDdirectLVDS93, running through the BLUE tests...
  17:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                  drawPix definitions are now DP_INLINEABLE
  18:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.80ncfDD6651 - Stolen from LCDdirectLVDS66.51-64 (a/o v91):
  19:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                BLUE_DIAG_BAR has been modified substantially
  20:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 Including drawPixSetup
  21:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 Now also combined with BLUE_DIAG_BAR_SCROLL
  22:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                TODO: Uses delay_cyc rather than delay_Dots
  23:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                      But this won't work with all systems (especially
  24:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                      bit-banged!)
  25:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                   
  26:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.80ncfDD - Looking into delayDots as a possible culprit for GCC48's
  27:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //				  destroying BLUE_TESTING (especially BLUE_DIAG_BAR_SCROLL)
  28:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            a/o LCDdirectLVDS91 -> 66.51
  29:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.80ncf-3 - adding BLUE_FRAME since BLUE_DIAG_BAR wasn't working with the
  30:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //				  LTN display (?!) a/o LCDdirectLVDS91
  31:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.80ncf-2 - Fixing vsync-case which went back to Nada...
  32:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            e.g. for bit-banged parallel-LCD and/or SDRAMthing
  33:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            TODO: Remove other case (for SDRAMthing)
  34:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.80ncf-1 - Adding LCDSTUFF_INCLUDE_NON_DE
  35:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            This is the same as LCDSTUFF_NOT_IN_TIMER, except
  36:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            better-named. This calls DE_DotDelay(), etc. even when in a
  37:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            vertical-blanking-period.
  38:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            This, a/o LCDdirectLVDS81 in order to use a dot-clock that
  39:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            *isn't* timer-based (e.g. bit-banged)
  40:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            ALSO replacing delay_cycs with delay_Dots in relevent
  41:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            sections
  42:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.80ncf - drawPixSetup function, for large-calculations to occur *before*
  43:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          Hsync (a/o LCDdirectLVDS-80, for non-DE display)
  44:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.70ncf-1 - swapping halves in BLUE_DIAG_BAR so the sync position can be
  45:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //				  seen...
  46:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            Also in BLUE_DIAG_BAR_SCROLL
  47:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            BUT NOT (TODO?) In others...
  48:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.70ncf - a/o LCDdirectLVDS-80, in which we attempt to run a NON LVDS
  49:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //				display...
  50:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          First step was creating new *separate* files for each display's
  51:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          timing parameters...
  52:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          This *discontinues* the need for #define DISPLAY TESTVALS, etc.
  53:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          So, ultimately, TODO: move _displays/ here
  54:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          Until then, disable DISPLAY default, here...
  55:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          ACTUALLY: Apparently just forgot to disable assignment of
  56:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          DE_ACTIVE_DOTS if it's already defined...
  57:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          So, DISPLAY is still set, but not used anywhere...
  58:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.60ncf - continuation of 0.56ncf-2 (which was untested)
  59:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          standardizing function names... updateLCD() -> lcd_update()
  60:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          lcdInit() -> lcd_init()
  61:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          lcd_update() now returns Row Number
  62:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.56ncf-2 - a/o LCDdirectLVDSv73:
  63:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            fixing lcd_init() to reset hsyncCount and dataEnable
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 132


  64:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            so it can be used to start a new frame prior to finishing the
  65:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            last
  66:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            NOT TESTED, SEE 0.60
  67:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.56ncf-1 - reuninstating loadRow in lcdUpdate()
  68:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            apparently it's handled in LCDdirectLVDS itself
  69:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            And maybe it's better that way...
  70:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            SO NOW: aside from a few notes about loadRow, this is
  71:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            identical to 0.55ncf-2
  72:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.56ncf - reinstating loadRow in lcdUpdate()
  73:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          a/o LCDdirectLVDS70 for working with the rowBuffer
  74:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          TODOne: How is it that it was removed so long ago... wasn't I
  75:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          using rowSegBuffer then, still...? (see above)
  76:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.55ncf-2 - a/o LCDdirectLVDS67:
  77:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            Adding notes to loadData() re: transitions...
  78:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            TODO: it's still a little unclear...
  79:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.55ncf-1 - adding BLUE_DIAG_SCROLL_FLASH
  80:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.55ncf - drawPix had uint8_t rowNum... switching to uint16_t
  81:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          a/o LCDdirectLVDS-62 (attempting to use DE_BLUE with ChiMei
  82:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          display)
  83:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          Also added BLUE_DIAG_BAR_SCROLL
  84:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.52ncf-1 - Adding notes re: old mental hurdles.
  85:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.52ncf - getting rid of git in this directory...
  86:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.51ncf-git-1ish Adding a few notes remaining from LCDdirectLVDS:
  87:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //						"SCOPING has been removed in LVDS, revisit LCDdirect50"
  88:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.51ncf-git first attempt at using git for uploading to googleCode...
  89:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        this version isn't yet used by any projects
  90:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.50ncf cleanup, colorOverride is unused...
  91:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //				SMILEY -> LCD_SMILEY
  92:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.40ncf-1 loadRow unused... removal untested...
  93:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.40ncf drawPix...
  94:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.30ncf-6 HSYNC_INACTIVE, etc. definable elsewhere
  95:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.30ncf-5 Adding BLUE_VERT_BAR_REVERSED
  96:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.30ncf-4 Adding NOTES: DON'T START WITH BLUE_DIAG_BAR
  97:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.30ncf-3 T_DV and T_Vlow overrideable
  98:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.30ncf-2 Not sure if I've modified it between... but here: 
  99:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        FRAME_COUNT_TO_DELAY wasn't defined, giving warnings
 100:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.30ncf-1 updateLCD() has return-values for state-switches
 101:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          (VFP, VSync, VBP, DE)
 102:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        ACTUALLY, that's unnecessary... state-transitions can be
 103:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        determined by vSync and dataEnable...
 104:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.30ncf Haven't been keeping these backed up regularly...
 105:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        More toward realtime adjustable timing values
 106:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        V Front Porch now occurs at the beginning of the frame, instead
 107:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        of at the end...
 108:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 109:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.20ncf More Timing Value experiment preparation... 
 110:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.10ncf-3ish looking into reloading methods for e.g. experimenting with
 111:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          timing values: sdramThing2.0-7
 112:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          How to "move" timing-values around data which needn't be
 113:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          changed...
 114:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.10ncf-andsomemore
 115:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          Added MAKELONG to fix integer overflow warnings
 116:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          Revised it from "... + MAKELONG" to "MAKELONG(...)"
 117:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          (The +MAKELONG version is lost in the ether... if you *really*
 118:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //           want it, there's a localized version in sdramThing2.0-6)
 119:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.10ncf-1ish - Adding HSYNC_COUNT_FRAME_COMPLETE
 120:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //               Removal of LVDS_PRESCALER stuff...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 133


 121:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //0.10ncf - Stolen from LCDdirectLVDS/54-moreColorStuff/main.c
 122:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          Removal of LCDdirectLVDS-specific stuff...
 123:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //				A little bit of rewriting of notes to be more generalized
 124:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          All delay_cyc references replaced with delay_Dots,
 125:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //					math changed accordingly...
 126:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 127:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 128:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0
 129:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DP_INLINEABLE static __inline__
 130:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DP_INLINEABLE_ALWAYS	__attribute__((__always_inline__))
 131:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #else
 132:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DP_INLINEABLE
 133:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DP_INLINEABLE_ALWAYS
 134:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
 135:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //static __inline__ 
 136:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** DP_INLINEABLE void drawPix(uint16_t rowNum) DP_INLINEABLE_ALWAYS;
 137:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //	  __attribute__((__always_inline__));
 138:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 139:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 140:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 141:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 142:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // I hereby declare this FPD-Link simulation technique to forever be called
 143:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  PW-BANGing
 144:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 145:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // a/o 0.10ncf-4: (sdramThing2.0v8-28)
 146:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   DON'T START WITH BLUE_DIAG_BAR
 147:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Unless you want to be depressed
 148:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Good Starting Point DE_BLUE
 149:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 150:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 151:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 152:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // GENERAL TIMING NOTES
 153:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // a/o 0.52ncf-1:
 154:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Upon revisiting an ancient display controller project I did 15 years
 155:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   ago, I'm finding myself falling into similar thought-hurdles I had
 156:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   the first go-round with a graphic LCD display... so here're some
 157:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   concepts:
 158:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 159:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Most graphical displays without onboard memory have basically these 
 160:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // same signals:
 161:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 162:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //	Pixel Clock: Each clock-pulse *generally* corresponds to one pixel...
 163:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Whether these clock-pulses are used for drawing actual pixels, or
 164:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   otherwise...
 165:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 166:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Horizontal Sync: Each time the Hsync pin is active, the display starts a
 167:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // 	new row. It syncs up the pixels horizontally, at the left of the
 168:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // 	screen.
 169:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 170:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   (This was one of my biggest mental-hurdles from those old days...
 171:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    aided by the fact that my display's timing-chips had different names
 172:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    for the Pixexl-Clock, Hsync, and Vsync pins.) 
 173:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Hsync is only pulsed *once* at the *beginning* of each row. 
 174:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   It is *not* pulsed with each pixel. It syncs the edge of the
 175:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   pixel-data with the edge of the screen.
 176:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 177:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Vertical Sync: Each time the Vsync pin is active, the display starts a
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 134


 178:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // new frame. It syncs the pixel-data with the top of the screen.
 179:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 180:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (Data Enable: This tells the (usually LCD) display that actual pixels
 181:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  are now being transmitted. It's a bit redundant, and some displays,
 182:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  especially older non-TFT displays don't even have it. 
 183:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Some newer TFT displays *only* use Data-Enable, determining the
 184:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  horizontal and vertical positions of the pixels based on the delay
 185:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  between Data-Enable pulses).
 186:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 187:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // I can't recall what the names were on my old display... but they were
 188:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // danged confusing. Especially to someone who'd never messed with graphics
 189:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // prior and had to reverse-engineer the whole thing. 
 190:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Oh yes, here they are: CPX, Frame, and Load. 
 191:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 192:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // As far as these three signals (Pixel Clock, Hsync, and Vsync):
 193:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  The actual timing-requirements may vary from display to display.
 194:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  But, it's pretty-well-established that for most displays these signals
 195:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  remain pretty constant. For example, an Hsync pulse may arrive at a
 196:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  specific rate (the duration of a "row"). Vsync, therefore, remains
 197:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  active for a number of "rows", even though no pixel-data is being sent
 198:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  during this time. And, again, even though no pixel-data is being sent,
 199:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  the Hsync pulse still occurs at the same rate it would if pixels were
 200:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  being drawn.
 201:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 202:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  This, I guess, is a remnant of ancient times, probably something to do
 203:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  with analog TV signals... the durations necessary for the electro-
 204:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  magnets to be moved from one side of the screen to the next, and the
 205:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  time necessary to move them again from top-to-bottom.
 206:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 207:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  In this digital era, it doesn't seem these timings would be necessary,
 208:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  and, in fact, most displays I've gotten working are highly tolerant of
 209:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  timing that doesn't match this rigidity.
 210:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 211:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  E.G. my *ancient* LCD project was designed long before I understood
 212:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  these "standard" timing specifications. As I recall, I don't have any
 213:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  delays between the "Frame" signal indicating the beginning of the next
 214:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  frame and the "Load" signal indicating the beginning of the first row
 215:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  of data. Certainly not several "rows" of Frame (aka Vsync)
 216:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  pulse-active.
 217:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 218:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Further, most of these standardized timings involve "porches", both
 219:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  front and back. The "Horizontal Front Porch" is the time between the
 220:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  end of a row and the Hsync signal. The "Horizontal Back Porch" is the
 221:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  time between the Hsync signal and the beginning of the actual 
 222:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  pixel-data. During these "porches", no pixel-data is sent, and the
 223:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Hsync signal is not active. Again, in the digital era these are pretty
 224:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  much unnecessary, but some displays still rely on them, and most
 225:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  specify timing-values for them.
 226:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 227:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 228:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 229:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //new notes a/o 0.10ncf-3ish:
 230:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // The basic idea is that timing is something that needs to be experimented
 231:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // with, often... so, for cases where LCD timing/drawing data is loaded
 232:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // beforehand (e.g. sdramThing2.0-7), it would be nice not to have to
 233:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // reload *all* the data, only to change the necessary timing data
 234:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 135


 235:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Neglecting the SDRAM for a second, we have essentially:
 236:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (The exact placement is not necessarily in order... e.g. DH_DOTS could
 237:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  be at the end of a row, or at the beginning... VSYNC rows could be at
 238:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  the top, or at the bottom.....)
 239:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (See also notes "Here's how it worked pre-lvds:", which actually are a
 240:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   bit off, e.g. I don't think VSYNC L->H was delayed by DE_TIME after
 241:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Hsync)
 242:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 243:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // H_LOW_DOTS + HD_DOTS + DH_DOTS = "Horizontal Blank Time"
 244:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (This "front/back" thing always confused me...
 245:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  DH_DOTS is *in front of* Hsync as far as *time* is concerned...
 246:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  i.e. looking at a 'scope trace... But something about reading left-to-
 247:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  right causes me to feel like "front" is the furthest to the right
 248:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  which would be *later* in time... weird.
 249:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  
 250:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 251:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        |--|<--H_LOW_DOTS                       "Horiz Front Porch"
 252:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        |  |--|<--HD_DOTS="Horiz Back Porch"    |<---->|<--DH_DOTS
 253:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        |  .  .                                 .      |
 254:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        |<............................................./
 255:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        |  .  .                                 .    
 256:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        v  v  .                                 .      
 257:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     /V _______________________________________________  \ VSYNC Rows
 258:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     /H |__|
 259:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     DE _______________________________________________  /  T_Vlow times)
 260:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              .                                 .
 261:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              .                                 .      "Vsync Back Porch"
 262:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     /V 
 263:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     /H |__|
 264:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     DE _______________________________________________  /  T_VD times)
 265:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              .                                 .         "Vbp should be
 266:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              v                                 v          static"
 267:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              ***********************************
 268:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              *                                 *
 269:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     /V 
 270:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     /H |__|
 271:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     DE ______||______   /
 272:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              *                                 *
 273:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              *<------ DE_ACTIVE_DOTS --------->*        (Repeat V_COUNT
 274:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              *      .                          *         =1024 times)
 275:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                     .   Displayed Pixels
 276:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              *      .                          *
 277:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              *                                 *
 278:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              *                                 *
 279:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     /V 
 280:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     /H |__|
 281:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     DE ______||______   /
 282:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              *                                 *
 283:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              ***********************************      
 284:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                                                      "Vsync Front Porch"
 285:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     /V 
 286:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     /H |__|
 287:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     DE _______________________________________________  /  T_DV times)
 288:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 289:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 290:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #warning "TODO Maybe: LCDdirectLVDS (which so far is the only version which synced with such low re
 291:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 136


 292:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Front vs. Back porches....
 293:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   If I were to draw a car driving down a street... 
 294:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   I would draw it with its front to the right, driving to the right...
 295:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 296:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       _____/\________     \O/
 297:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   ...|__   _________   __\     |
 298:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      ...\_/         \_/       / \							//
 299:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 300:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   The person is *in front of* the car... which means the car has not yet
 301:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   arrived at the person, but will soon... 
 302:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   (later in time, not *before* in time)
 303:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  This is my logic...
 304:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   So The "Horizontal Front Porch", to me, should be to the RIGHT of the
 305:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Horizontal Sync Pulse...
 306:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   But that ain't how it is (unless I've confused myself into a circle
 307:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   where my logic is actually right, and I just think it's wrong?)
 308:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   
 309:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  By the logic that the front porch occurs *before* the sync pulse,
 310:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   ... I suppose we could think of a person in front of a house... it
 311:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   makes more sense, anyhow, since it's a porch in front of a house, 
 312:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   not person in front of a car.
 313:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   The person's walking into the house, crosses the *front*-porch 
 314:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   *before* enterring the doorway. If he continues walking all the way
 315:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   through the house and out the back-door, he'll be crossing the *back*
 316:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   porch later in time...
 317:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 318:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Right, so the logic makes sense... but for some reason I have to run 
 319:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  through this whole diatribe every time I see the terms.
 320:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Heh, and even after going through it, the damned thing seems backwards.
 321:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (Probably because I drew it with the front-porch to the right side...)
 322:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (AND THEN there's the issue that it seems to me like the front-porch
 323:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   should be to the left of the drawing-area whereas the back-porch
 324:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   should be to the right of it... rather than to the HSYNC pulse)
 325:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 326:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 327:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Anyways, all that drawing was to figure out where to position this
 328:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // in memory, such that it would be the least processing-effort to modify
 329:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // timing values for testing... (because loading the SDRAM's free-running 
 330:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // data takes ~20minutes!)
 331:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 332:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 333:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 334:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Options LTN, IDT, or TESTVALS
 335:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // IDT display *still* doesn't sync... maybe my H/V signals aren't right
 336:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef DISPLAY
 337:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DISPLAY TESTVALS //LTN //TESTVALS //IDT //LTN
 338:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
 339:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 340:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //oldNote:
 341:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // TODO: Between OSCCAL_VAL and FRAME_UPDATE_DELAY
 342:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  it seems the speed (at least for the LTN) isn't so important after all
 343:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  This could be used to my advantage...
 344:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Maybe bump OSCCAL_VAL all the way up, but use a slower "bit-rate"
 345:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Thus, pixels could be skinnier, thus higher-resolution.
 346:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Or more instructions could be used for the same resolution
 347:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   allowing, e.g. sprites from program-memory, without necessitating a
 348:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   large (or any?) frame-buffer...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 137


 349:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 350:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 351:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //This would normally be 0 for the highest-speed frame-refresh possible
 352:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // However, increasing this value can slow the frame-refresh rate
 353:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   if desired
 354:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // e.g. 50000 causes it to refresh ~ every few seconds
 355:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   (durn-near the limit for how long the LCD will retain an image)
 356:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // The benefit being that it doesn't flicker at annoying rates for
 357:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  stationary images
 358:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  worth exploring...
 359:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // This may be highly dependent on the screen capabilities...
 360:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   of course, this sorta thing is undocumented
 361:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   it just has to be experimented with
 362:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Further, it may be quite hard on the Liquid Crystals, since they'd 
 363:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   likely be driven DC... not sure what the long term effects are.
 364:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // This could be a hell of a lot more sophisticated...
 365:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // e.g. refresh after a frameBuffer change
 366:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      refresh based on a seconds-timer
 367:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      ...
 368:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // AS-IS: Does refreshes completely independent of the frame-buffer
 369:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      if it's too slow, some images may be missed completely.
 370:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      This is not true for FRAME_SYNC TRUE (below)
 371:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      (and it's not really useful anymore with FRAME_SYNC)
 372:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // a/o sdramThing2.0, this is not really relevent...
 373:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // 	if the frame needs updating, just stop free-running, right?
 374:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // 	well, doing-so might cause issues, since the LVDS clock will not be
 375:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    running... this is a TBD
 376:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define FRAME_UPDATE_DELAY 0//5000//50000 //2000 //5000 //20000 //50000
 377:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 378:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 379:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //New Idea:
 380:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Disable the Hsync timer interrupt after the frame completes
 381:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  and reenable elsewhere...
 382:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (It seems pixels changing from one shade to another take an
 383:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   intermediate step halfway between)
 384:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (Thus, two updates then a pause might clear that up)
 385:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (Duh... it doesn't clear that up, because the fastest refresh rate
 386:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   is the same...)
 387:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (but it is an interesting effect)
 388:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (Double-Duh... I was using a slow refresh with FRAME_UPDATE_DELAY)
 389:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Reworded: Having several frame refreshes before a pause helps to
 390:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  "solidify" the color changes... especially the sharp changes 
 391:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (e.g. yellow<->black)
 392:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (Side Note: I saw this effect on a regular (NON-LVDS) TFT display 
 393:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   in LCDdirect that was only connected such that R, G, and B were each
 394:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   either full-off or full-on, i.e. all Red bits were connected to a
 395:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   single output pin (full on when 1, full off when 0).
 396:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   I hadn't attributed it to improper refresh synchronization
 397:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   as the refresh rate was too fast to see... That's a handy way to get
 398:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   intermediate shades/colors without refresh-flicker from pulsing them!)
 399:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  connected with each color 
 400:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  0 means no delay (except FRAME_UPDATE_DELAY) via interrupt disabling
 401:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  If you WANT this effect (for intermediate shades?) 
 402:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   set FRAME_COUNT_TO_DELAY to 1
 403:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Then, each change of color will (apparently) result in a value halfway
 404:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   between the old color and the new color
 405:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Not sure whether it's an electrical problem, but these half-shades 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 138


 406:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   appear dithered, sometimes ugilly, sometimes it's nice. I guess it
 407:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   depends on the goal...
 408:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#define FRAME_COUNT_TO_DELAY 2//7//1//5//2//3
 409:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 410:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 411:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //A/O v13: Using the Samsung LTN display, instead of the IDTech IAXG
 412:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // LTN appears to be content with my pseudo-LVDS scheme.
 413:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // IAXG has never unblanked
 414:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      Even though suitable timings were found with SwitchResX
 415:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      Maybe due to psuedo-LVDS
 416:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            slight timing issues // It probably doesn't work with all cases...
 417:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Definitely with drawPix/Images...(RC oscillator variances?)
 418:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            glitches when switching LVDS states 
 419:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 (thought I had that figured out, originally)
 420:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      The fact the LTN appears to recognize the signalling suggests the
 421:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      IAXG would be worth further exploration...
 422:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //         Unfortunately, the CCFT blew out my inverter
 423:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                        And I must have put it back together incorrectly
 424:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                        (backlight filters out of order or flipped?)
 425:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                        (which actually makes for some very interesting
 426:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                         visuals, but hard to develop with)
 427:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      IAXG: uses DE, V, and H
 428:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //             At low pixel-clock DE is active for fewer pixels...
 429:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              Last Tested: 680 was full-screen
 430:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //             Nice because it increases the frame-rate!
 431:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      LTN:  uses DE only
 432:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 433:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 434:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // The idea is to use FastPWM with the PLL to implement 64-85Mbits/sec
 435:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (the PLL on the Tiny861 supposedly maxes out at 85MHz)
 436:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (Though I am currently running with OSCAL set to the highest frequency
 437:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   and the PLL seems to be syncing at about 128MHz)
 438:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (New Note, a/o sdramThing2.0v5... it's kinda ironic that I was able to
 439:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   run it at 128MHz with nothing more than an AVR and some gates...
 440:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   seeing as how sdramThing has been fidgetty just running at 8MHz
 441:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Anyways, an eventual goal is to run at 133MHz+, using basically
 442:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   nothing more than the SDRAM itself for timing and refreshes...
 443:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   would allow for full resolution and full color-depth)
 444:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 445:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 446:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 447:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 448:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Wiring:
 449:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Many iterations of AVR->Differential "LVDS" circuitry resulted in the
 450:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   simplest of all:
 451:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 452:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Believe it or not, the XOR is a standard TTL LS-series XOR: 74LS86
 453:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     Specifically: TI SN74LS86N from 1980 (the only XOR in my collection)
 454:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   It's spec'd to run from 4.5-5.5V, and its propagation delays and slew
 455:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     rates aren't really spec'd to be good enough for 128MHz pixel clock
 456:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     yet it's working...
 457:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Further, the output voltages are right in the LVDS range,
 458:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     IIRC (last I 'scoped) around 1.5V High and 1.0V Low
 459:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      (Don't forget the LCD has a 100ohm resistor between
 460:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //         RXinN/clk+ and RXinN/clk-)
 461:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 462:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   It's probably best to use two XORs from the same chip for a single
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 139


 463:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    LVDS channel, since different chips may have slightly different
 464:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    characteristics. 
 465:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 466:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   The entire circuit, thus, requires TWO 74LS86's 
 467:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    (four XORs apiece, two per LVDS channel, 8-total)
 468:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 469:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 470:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              VCC3V3   VCC3V3
 471:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                |        |                           ______________
 472:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                +---\ \-_                        |  LCD (1 channel
 473:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                     | |    -                      |       of 4)
 474:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                     | | XOR   >------> RXinN/clk-  | ----.
 475:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   AVR, etc.         | |    _-                      |     |
 476:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   3.3V TTL >---+---/ /___-                        |     \ 100
 477:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   output       |                                   |     /
 478:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                |                                   |     \ ohms
 479:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                |                                   |     /
 480:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                `---\ \-_                        |     |
 481:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                     | |    -                      |     |
 482:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                     | | XOR   >------> RXinN/clk+  | ----'
 483:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                     | |    _-                      |
 484:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                +---/ /___-                        |
 485:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                |        |                          |
 486:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //               GND      GND
 487:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 488:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  
 489:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Also used: The TTL 74AHC series...
 490:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    I found some one-gang 74AHC1G32 and 74AHC1G86's on an old iBook
 491:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     motherboard. (An OR and an XOR, respectively). These are spec'd for
 492:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     3.3V operation, and faster. The output voltages appear OK for LVDS
 493:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     (with a 100ohm load in the LCD)
 494:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 495:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  NOTE: Since I only had enough of these 1-gang devices for two LVDS
 496:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     channels, I had to implement Red and Green with the LS 
 497:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     before switching all channels to the LS... Using different chips
 498:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     (specifically, different TYPES of chips) for different channels
 499:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     caused timing issues: Since the AHC is faster, the clock and Blue
 500:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     signals are synchronized, but the red and green signals were shifted
 501:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     a bit or two (resulting in "Black" appearing green)
 502:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 503:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  For other circuits attempted, see oldNotes.txt
 504:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     (and boy there were many, involving voltage dividers, AC coupling,
 505:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      reference voltages, BJT differential amplifiers... I doubt I 
 506:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      documented them all, or even most. Whoda thunk the simplest, 
 507:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      especially under- AND over-spec'd--timing, supply voltage, and
 508:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      output voltage--would be the one...?)
 509:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 510:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // LVDS/FPD-Link timing:
 511:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 512:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            |<--- (LCDdirectLVDS: "pixel") --->|
 513:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Timer1:   |<-- One Timer1 Cycle (OCR1C=6) -->|
 514:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  TCNT:     |  0   1    2    3    4    5    6  |  0   1    2    3    
 515:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            |____.____.____.____               |____.____.____.____
 516:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  RXclk+:   /         |         \    .    .    /         |         \ //
 517:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            |         |            |         |
 518:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // One Pixel: |         |<--- One FPD-Link Pixel Cycle --->|
 519:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            |                                  |
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 140


 520:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // "Blue/DVH" |____ ____v____ ____ ____v____ ____|____ ____
 521:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  RXin2:    X B3 X B2 X DE X /V X /H X B5 X B4 X B3 X B2 X ...
 522:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            | ^  ^ | 
 523:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            |         |<--Not Blue-->|         |
 524:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            |                                  |
 525:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // "Green"    |____ ____v____ ____v____ ____ ____|____ ____
 526:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  RXin1:    X G2 X G1 X B1 X B0 X G5 X G4 X G3 X G2 X G1 X ...
 527:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            | ^ ^  |  
 528:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            |         |<------->|-Not Green    |
 529:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 530:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // "Red"      |____ ____v____v____ ____ ____ ____|____ ____
 531:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  RXin0:    X R1 X R0 X G0 X R5 X R4 X R3 X R2 X R1 X R0 X ...
 532:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            | ^^     
 533:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            |         |<-->|-Not Red
 534:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 535:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Of course: The "Not Green/Red" bits above are least-significant-bits
 536:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              and basically have little/no visible effect
 537:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 538:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 539:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Implementations/prospects:
 540:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  * rowBuffer.c (more like row-settings-buffer)
 541:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     calculate a row's worth of pixels before drawing that row
 542:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     (uses packed color settings in a single byte per drawable pixel)
 543:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     64 drawable pixels across, regardless of LVDS speed
 544:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  * For faster pixels: these settings values could be stored 
 545:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     in individual bytes. Gives about 1/3 more pixels at 3x the memory
 546:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     (not implemented)
 547:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  * rowSegBuffer.c
 548:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     also calculates an entire row before drawing it
 549:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     instead of storing pixels, store "segments"
 550:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     i.e. each segment is defined by a color value and a length
 551:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     Number of segments is limited only by memory...
 552:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      e.g. 64 segments per row (max) is 64*3Bytes
 553:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       Three bytes for color, and *really simple* packing for seg-length
 554:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      BUT: at slow LVDS speeds, the resolution of these segments could be
 555:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       as high as one LCD pixel.
 556:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      possibly: at *really* low LVDS speeds we could be 64*2Bytes
 557:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      (with packing)
 558:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      Actually: Using GB_COMBINED gives 2Bytes per segment
 559:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      only adds two clock cycles to each "pixel", so probably worth it
 560:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 561:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   In Any Case: There's not enough RAM for a full frame
 562:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          64 pixels across * 64 pixels down is 4096 bytes
 563:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          So whatever method, we need to precalculate each row before
 564:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          displaying it
 565:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          Could be as simple as loading direct from program memory
 566:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 567:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 568:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Since low-bits are barely visible, their effect is neglected.
 569:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 570:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 571:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE/V/H Timing (LCDdirectLVDS):
 572:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  
 573:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 574:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            |  0   1    2    3    4    5    6       All: set @ 0
 575:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            |____.____.____.____                         OCR1C = 6 
 576:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Clock:    /                   \    .    .    /         Complementary-
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 141


 577:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                                             Output Mode
 578:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                                                          required for DT
 579:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Signal:    B3   B2   DE   /V   /H   B5   B4 | B3
 580:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //             ____ ____ ____ ____ ____ ____ ____|____    
 581:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   DE:      X B3 X B2 /    .    .    \ B5 X B4 X B3 X    
 582:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   state2                      |    
 583:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   DE_BLUE: >|    DT=X, OCR=0
 584:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                         Watch the transition!! -------^
 585:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   DE_NORM: >_________/\_________|    DT=2, OCR=4
 586:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   DC_DISABLED:
 587:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   maxBlue: >\____|		DT=0, OCR=5
 588:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //             See below for more blue settings...
 589:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 590:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //             ____ ____      ____      ____ ____|____ 
 591:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H (only): X xx X xx \    /    \    / xx X xx X xx X    
 592:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   state1              | 
 593:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            >______________/\______________|    DT=3, OCR=3
 594:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  DC_DISABLED:
 595:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Not much can be done...
 596:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 597:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //             ____ ____           ____ ____ ____|____ 
 598:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V w/o H:  X xx X xx \    .    /    \ xx X xx X xx X
 599:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   state3              |
 600:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            >___________________/\_________|    DT=4, OCR=4 (+?)
 601:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DC_DISABLED:
 602:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            >___________________/\____|		DT=4, OCR=5
 603:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 604:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //             ____ ____                ____ ____|____ 
 605:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V w/ H:   X xx X xx \    .    .    / xx X xx X xx X
 606:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   state4          | 
 607:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            >__________________________________|    DT=X, OCR=0
 608:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                             TransitionWatch!!! -------^
 609:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                             Shouldn't matter... DT from no-edge
 610:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DC_DISABLED:
 611:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            >\________________________|		DT=0, OCR=1
 612:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 613:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //             ____ ____      ____ ____ ____ ____|____ 
 614:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Nada:     X xx X xx \    /    .    \ xx X xx X xx X    
 615:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   state0                  |     
 616:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            >______________/\_________|    DT=3, OCR=4 (+?)
 617:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DC_DISABLED:
 618:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //            >______________/\____|		DT=3, OCR=5
 619:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 620:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //So far this is the only case I've seen:
 621:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // /Vsync
 622:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef VSYNC_ACTIVE
 623:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define VSYNC_ACTIVE		0
 624:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
 625:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef VSYNC_INACTIVE
 626:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define VSYNC_INACTIVE	1
 627:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
 628:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // /Hsync
 629:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef HSYNC_ACTIVE
 630:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define HSYNC_ACTIVE		0
 631:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
 632:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef HSYNC_INACTIVE
 633:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define HSYNC_INACTIVE	1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 142


 634:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
 635:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE (active high)
 636:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef DE_ACTIVE
 637:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DE_ACTIVE			1
 638:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
 639:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef DE_INACTIVE
 640:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DE_INACTIVE		0
 641:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
 642:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 643:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // HERE!
 644:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 645:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 646:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 647:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 648:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Transitions: OLD!!!!! WRONG!!!!
 649:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   (are they? There're several additional transitions, now, for one.)
 650:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  The idea is to reduce the number of instructions between each
 651:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  LVDS "state."
 652:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  These are implemented below in the case:
 653:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    "#else //NOT FULL_INIT_TESTS"
 654:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Since each instruction takes *longer than* a single pixel
 655:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    two instructions would *at best* occur on two consecutive pixels
 656:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    Thus, there's likely to be a transition-glitch
 657:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    (e.g. old OCR value with new DT value)
 658:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Note that the new DT values are implemented at the next corresponding
 659:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    edge after the DT-write instruction completes
 660:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    (for +OC1A/DT1H, when TCNT is reset to 0)
 661:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    (for -OC1A/DT1L, when TCNT passes OCR1A)
 662:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    New OCR values are delayed until the next TCNT reset to 0
 663:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 664:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Initial:
 665:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Nada					DT=2  NADA_OCR = (3<=OCR<(=?)6)
 666:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 667:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Nada	->	H			OCR=2
 668:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H		->	Nada		OCR=NADA_OCR
 669:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  
 670:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Nada	->	V			DT=3
 671:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V		->	V+H		OCR=0
 672:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V+H	->	V			OCR=NADA_OCR
 673:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V		->	Nada		DT=2
 674:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 675:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Nada	->	DE			DT=1
 676:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  DE	->	Nada		DT=2
 677:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 678:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0
 679:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (defined(REMOVE_DC) && REMOVE_DC)
 680:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define Nada_init()         { DT1=(3<<4); OCR1A=5; }
 681:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 682:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  //Unused, normally...
 683:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define Vsync_init()       { DT1=(4<<4);  OCR1A=5; }
 684:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define VplusH_init()      { DT1=0;       OCR1A=1; }
 685:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define Hsync_init()       { DT1=(3<<4);  OCR1A=3; }
 686:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define DEonly_init()      { DT1=(2<<4);  OCR1A=4; }
 687:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define DEblue_init()		 { DT1=0;       OCR1A=5; }
 688:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 689:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #else //!REMOVE_DC
 690:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Nada init
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 143


 691:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define Nada_init()         { DT1=(3<<4); OCR1A=4; }
 692:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 693:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Unused, normally...
 694:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define Vsync_init()			{ DT1=(4<<4);	OCR1A=4; }
 695:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define VplusH_init()		{ DT1=0;			OCR1A=0; }
 696:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define Hsync_init()			{ DT1=(3<<4);	OCR1A=3; }
 697:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // #define DE_init()				{ DT1=(2<<4);	OCR1A=4; } //...SHOULD BE
 698:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define DEonly_init()			{ DT1=(2<<4);  OCR1A=4; }
 699:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define DEblue_init()			{ DT1=0;       OCR1A=6; }
 700:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#define DE_init()				{ DT1=(1<<4);	OCR1A=2; } //Works with DE_ONLY
 701:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  //#define DE_init()				{ DT1=0;			OCR1A=0xff; }	//DE_BLUE
 702:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif //REMOVE_DC
 703:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
 704:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 705:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#define FULL_INIT_TESTS TRUE
 706:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 707:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Display is DE-Only (doesn't use H/Vsync)
 708:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Shouldn't be necessary to select this if it is,
 709:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // since DE timing is the same either way
 710:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // but I want to test whether a single-bit is being detected
 711:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (e.g. maybe the rise/fall-times of the output aren't fast enough for a
 712:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  single bit, which might explain why the other display didn't work)
 713:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //These are just examples... the project should define them:
 714:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0
 715:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (defined(DE_ONLY_DISPLAY) && DE_ONLY_DISPLAY)
 716:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Vsync_fromNada()      Nada_init()
 717:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define VplusH_fromVsync()    Nada_init()
 718:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Vsync_fromVplusH()    Nada_init()
 719:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Nada_fromVsync()      Nada_init()
 720:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Hsync_fromNada()      Nada_init()
 721:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Nada_fromHsync()      Nada_init()
 722:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DEonly_fromNada()     DE_init()
 723:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DEblue_fromDEonly()	DE_init()
 724:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Nada_fromDEblue()		Nada_init()
 725:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #if(DE_BLUE)
 726:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "DE_BLUE is true, but not implemented with DE_ONLY_DISPLAY"
 727:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "...The display should be blank"
 728:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #endif
 729:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Use full initialization of each LVDS state
 730:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (might not be good during transitions, but should guarantee
 731:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  steady-state, in case my transitions aren't correct...)
 732:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (defined(FULL_INIT_TESTS) && FULL_INIT_TESTS)
 733:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Vsync_fromNada()		Vsync_init()
 734:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define VplusH_fromVsync()		VplusH_init()
 735:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Vsync_fromVplusH()		Vsync_init()
 736:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Nada_fromVsync()		Nada_init()
 737:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Hsync_fromNada()		Hsync_init()
 738:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Nada_fromHsync()		Nada_init()
 739:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DEonly_fromNada()		DEonly_init()
 740:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DEblue_fromDEonly()	DEblue_init()
 741:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Nada_fromDEonly()		Nada_init()
 742:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Nada_fromDEblue()		Nada_init()
 743:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 744:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 745:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #else	//NOT FULL_INIT_TESTS
 746:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#define Vsync_fromNada()   { DT1=(4<<4); }
 747:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Vsync_fromNada()   { DT1=(4<<4); OCR1A=5; } //Leave two bits high
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 144


 748:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 																	 //for easy-scoping
 749:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 						//Three would be nicer, but I'm pretty sure OCR=TOP=ON
 750:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define VplusH_fromVsync() { OCR1A=0; }
 751:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#define Vsync_fromVplusH() { OCR1A=4; }
 752:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Vsync_fromVplusH() { OCR1A=5; }				//Extra bits for scoping
 753:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#define Nada_fromVsync()   { DT1=(3<<4); }
 754:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Nada_fromVsync()   { DT1=(3<<4); OCR1A=4; } //scoping...
 755:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Hsync_fromNada()   { OCR1A=3; }
 756:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Nada_fromHsync()   { OCR1A=4; }
 757:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 758:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Nada_fromDEblue()	{ DT1=(3<<4); OCR1A=4; }
 759:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define Nada_fromDEonly()	{ DT1=(3<<4); }
 760:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DEonly_fromNada()	{ DT1=(2<<4); }
 761:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DEblue_fromNada()	{ OCR1A=0xff; }
 762:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DEblue_fromDEonly() { OCR1A=0xff; }
 763:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 764:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif //End Of FULL_INIT_TESTS
 765:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
 766:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 767:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 768:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 769:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // The typical patterns look like this (not at all to scale):
 770:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   ----______------------------------------------------______-- V
 771:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //             ....
 772:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      --_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_ H
 773:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //             ....
 774:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      __________-__-__-__-__-__-__-__-__-__-__________________  DE
 775:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 
 776:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //             ^^^^\														//blah
 777:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //             1234 5?
 778:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Pixels are sent during DE High (basically all the CPU will be used here)
 779:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Ideally, 
 780:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  there won't be any glitches when changing from one state to another
 781:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 782:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Init (pre 1):
 783:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    DeadTimerRising=1
 784:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 785:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  The states are:
 786:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   (Not necessarily accurate, just looking into necessary changes)
 787:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   (from Vsync L->H)
 788:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 789:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   1  NothingActive (long, No DE, VporchFrontTimes)
 790:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 791:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   2  Hsync
 792:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 793:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   3  NothingActive (short)
 794:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 795:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   4  DE
 796:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 797:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   5  NothingActive(?)
 798:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 799:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   7  Repeat 2-5 for each row
 800:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 801:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   8  NothingActive (long, No DE, VporchBackTimes)
 802:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 803:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   9  V w/o H
 804:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 145


 805:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   10 V w/  H
 806:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 807:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   11 Repeat 9-10 for Vsync time...
 808:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 809:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 810:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Here's how it worked pre-lvds:
 811:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // HSYNC, VSYNC, and DE refer to the actual pins
 812:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // In the LVDS setup, there're modes corresponding to each pin-combination
 813:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 814:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Timer Interrupt:
 815:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  loadData:
 816:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   HSYNC active
 817:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   HSYNC Low delay
 818:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   HSYNC inactive
 819:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   if(dataEnable)
 820:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    DE active
 821:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     Send row data
 822:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    DE inactive
 823:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  //Prep for next interrupt
 824:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  switch(hsyncCount++)
 825:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    //Vsync H->L (active)
 826:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    1:
 827:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          dataEnable=FALSE
 828:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          VSYNC active
 829:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    //Vsync L->H (inactive)
 830:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    T_Vlow:
 831:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          VSYNC inactive
 832:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    //Start of frame
 833:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    T_VD +(T_Vlow):
 834:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          dataEnable=TRUE
 835:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    //All rows have been displayed
 836:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    V_COUNT +(T_VD+T_Vlow):
 837:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          dataEnable=FALSE
 838:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    //Frame Complete
 839:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    T_DV +(V_COUNT+T_VD+T_Vlow): 
 840:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          hsyncCount=0
 841:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  if(dataEnable)
 842:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    Use the remaining time to load the next row to memory
 843:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 844:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  So:
 845:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Interrupt0       End
 846:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    |             |  Interrupt1
 847:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    v             v  v
 848:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H |_||_||_|
 849:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE ___________________________________________________ ...
 850:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V |_____________________________________ ...
 851:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       |        ||
 852:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DETIME^--------^|
 853:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 |
 854:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 VSYNC active
 855:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 dataEnable=FALSE (not necessary?)
 856:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 857:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //InterruptT_Vlow   End
 858:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    |             |
 859:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    v             v
 860:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H |_||_||_|
 861:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE ___________________________________________________ ...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 146


 862:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V _____________| ...
 863:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       |        ||
 864:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DETIME^--------^|
 865:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 |
 866:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 VSYNC inactive
 867:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 868:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 869:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //InterruptT_VD   End  InterruptT_VD+1
 870:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    |             |  |            End
 871:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    v             v  v            v
 872:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H |_||_||_|
 873:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE ____________________||_______||____ ...
 874:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V 
 875:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       |        ||      |        |
 876:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DETIME^--------^|      ^--------^
 877:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 |
 878:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 dataEnable=TRUE
 879:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 880:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //InterruptV_COUNT  End
 881:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    |             |
 882:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    v             v
 883:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H |_||_||_|
 884:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE ___||______________________________________ ...
 885:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V 
 886:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       |        ||      |        |
 887:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DETIME^--------^|      ^--------^
 888:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 |
 889:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 dataEnable=FALSE
 890:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 891:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 892:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // This isn't really a state, it's basically just:
 893:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // if(hsyncCount == NUM_HYSYNCS_PER_FRAME)
 894:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    hsyncCount = 0;
 895:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                    .....................................
 896:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                    .                                   .
 897:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //InterruptT_DV   End .Interrupt0                         .
 898:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    |             | .|                                  .
 899:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    v             v .v                                  .
 900:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H |_||_||_|
 901:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE ___________________________________________________ .
 902:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V |____________________ .
 903:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       |        ||  .   |        |                      .
 904:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DETIME^--------^|  .   ^--------^                      .
 905:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 |  .                                   .
 906:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                 hsyncCount=0 (repeat from Interrupt0)  .
 907:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                    .                                   .
 908:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                    .....................................
 909:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 910:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 911:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 912:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // THESE STATES ARE NO LONGER ACCURATE
 913:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // ESPECIALLY THIS FIRST STATE.
 914:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // V Front Porch originally (and in these drawings) occurred at the end
 915:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // of the frame...
 916:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // More logically, it now starts at the beginning of the frame
 917:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (Also removing this initial "glitch" of a single interrupt with
 918:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  NothingActive)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 147


 919:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 920:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // THESE STATES ARE NO LONGER ACCURATE (a/o 0.30, for certain)
 921:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // NOW to compare with LVDS states:
 922:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
 923:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Interrupt0       End
 924:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    |             |  Interrupt1
 925:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    v             v  v
 926:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H |_||_||_|
 927:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE ___________________________________________________ ...
 928:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V |_____________________________________ ...
 929:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    ^ ^          ^   ^ ^
 930:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |          |   | |
 931:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |          |   | +--- V w/o H  \ These two toggle until
 932:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |          |   +----- V w/ H   / next LCD state...
 933:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |          |
 934:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |          +--------- V w/o H > Intermediate change of state
 935:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |
 936:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | +----- NothingActive  \ From Previous State (?)
 937:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    +------- H_Only         /
 938:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 939:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 940:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //InterruptT_Vlow   End
 941:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    |             |
 942:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    v             v
 943:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H |_||_||_|
 944:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE ___________________________________________________ ...
 945:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V _____________| ...
 946:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    ^ ^          ^   ^ ^
 947:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |          |   | |
 948:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |          |   | +--- NothingActive  \ These two toggle until
 949:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |          |   +----- H_Only         / next LCD state...
 950:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |          |
 951:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |          +--------- NothingActive > Intermediate change of state
 952:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |
 953:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | +----- V w/o H   \ From previous state
 954:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    +------- V w/ H    /
 955:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 956:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 957:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //InterruptT_VD   End  InterruptT_VD+1
 958:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    |             |  |            End
 959:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    v             v  v            v
 960:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H |_||_||_|
 961:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE ____________________||_______||____ ...
 962:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V 
 963:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    ^ ^              ^ ^^        ^ 
 964:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |              | ||        |
 965:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |              | ||        +--- NothingActive  \  These four
 966:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |              | |+------------ DE              | cycle until
 967:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |              | +------------- NothingActive   | next LCD state...
 968:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |              +--------------- H_Only  ^      /
 969:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |                                       |
 970:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | +----- NothingActive  \ From previous   |
 971:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    +------- H_Only         / state           +-This intermediate state
 972:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                                                may not be necessary
 973:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                                                (IAXG01 shows 160 dots!)
 974:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 975:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 148


 976:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 977:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //InterruptV_COUNT  End
 978:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    |             |
 979:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    v             v
 980:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H |_||_||_|
 981:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE ___||______________________________________ ...
 982:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V 
 983:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    ^ ^^        ^    ^ ^
 984:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | ||        |    | |
 985:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | ||        |    | +--- NothingActive \  These two toggle
 986:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | ||        |    +----- H_Only        /  until next LCD state
 987:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | ||        |
 988:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | ||        +---- NothingActive \ 								//blah
 989:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |+------------- DE             |  From previous state
 990:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | +-------------- NothingActive  |
 991:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    +---------------- H_Only        /
 992:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 993:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // This isn't really a state, it's essentially just:
 994:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  if(hsyncCount == NUM_HSYNCS_PER_FRAME)
 995:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    hsyncCount = 0;
 996:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                    .....................................
 997:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                    .                                   .
 998:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //InterruptT_DV   End .Interrupt0                         .
 999:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    |             | .|                                  .
1000:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    v             v .v                                  .
1001:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H |_||_||_|
1002:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE ___________________________________________________ .
1003:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V |____________________ .
1004:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    ^ ^             .                                   .
1005:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | |             .....................................
1006:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    | +--- NothingActive \											//blah
1007:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    +----- H_Only        / From previous state...
1008:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1009:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1010:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1011:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  LVDS State transitions:
1012:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   1 H_Only
1013:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   2 NothingActive
1014:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1015:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   3 V w/o H
1016:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   4 V w/ H
1017:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    
1018:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   (repeat 3,4)
1019:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1020:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   5 V w/o H
1021:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1022:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   6 NothingActive
1023:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   7 H_Only
1024:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1025:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   (repeat 6,7)
1026:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1027:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   8 NothingActive
1028:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1029:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   9 H_Only
1030:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  10 NothingActive
1031:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  11 DE
1032:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  12 NothingActive
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 149


1033:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1034:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (repeat 9-12)
1035:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1036:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  13 H_Only
1037:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  14 NothingActive
1038:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1039:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (repeat 13-14)
1040:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1041:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   These should be reviewed to determine which changes are necessary
1042:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   between each state...
1043:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   (the fewer changes, the less likely we'll glitch...?)
1044:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1045:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** volatile uint8_t dataEnable = 0;
1046:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** volatile uint8_t vSync = 0;
1047:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** volatile uint16_t hsyncCount = 0;
1048:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1049:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //frameCount=0 can be used in main to detect whether we've completed a 
1050:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  a frame AND its FRAME_UPDATE_DELAY
1051:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (defined(FRAME_COUNT_TO_DELAY) && (FRAME_COUNT_TO_DELAY != 0))
1052:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #error "FRAME_COUNT_TO_DELAY isn't really an lcdStuff thing anymore, is it?"
1053:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** volatile uint8_t frameCount = 0;
1054:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1055:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1056:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** void lcd_init(void)
1057:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
 2928               		.stabn	68,0,1057,.LM347-.LFBB25
 2929               	.LM347:
 2930               	.LFBB25:
 2931               	/* prologue: function */
 2932               	/* frame size = 0 */
 2933               	/* stack size = 0 */
 2934               	.L__stack_usage = 0
1058:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//Not sure modifying vSync randomly is safe...
1059:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	vSync = 0;
 2935               		.stabn	68,0,1059,.LM348-.LFBB25
 2936               	.LM348:
 2937 0b06 1092 0000 		sts vSync,__zero_reg__
1060:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//the rest should be...? assuming it occurs after lcd_update() completes
1061:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// (thus leaving it in NADA-state)
1062:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	hsyncCount = 0;
 2938               		.stabn	68,0,1062,.LM349-.LFBB25
 2939               	.LM349:
 2940 0b0a 1092 0000 		sts hsyncCount+1,__zero_reg__
 2941 0b0e 1092 0000 		sts hsyncCount,__zero_reg__
1063:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	dataEnable = FALSE;
 2942               		.stabn	68,0,1063,.LM350-.LFBB25
 2943               	.LM350:
 2944 0b12 1092 0000 		sts dataEnable,__zero_reg__
1064:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  	Nada_init();
 2945               		.stabn	68,0,1064,.LM351-.LFBB25
 2946               	.LM351:
 2947 0b16 80E3      		ldi r24,lo8(48)
 2948 0b18 84BD      		out 0x24,r24
 2949 0b1a 84E0      		ldi r24,lo8(4)
 2950 0b1c 8DBD      		out 0x2d,r24
 2951 0b1e 0895      		ret
 2952               		.size	lcd_init, .-lcd_init
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 150


 2953               	.Lscope25:
 2954               		.stabs	"",36,0,0,.Lscope25-.LFBB25
 2955               		.stabd	78,0,0
 2956               		.stabs	"lcd_update:F(4,3)",36,0,1354,lcd_update
 2957               	.global	lcd_update
 2958               		.type	lcd_update, @function
 2959               	lcd_update:
 2960               		.stabd	46,0,0
1065:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
1066:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1067:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1068:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define TESTVALS	0
1069:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define LTN 1
1070:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define IDT 2
1071:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1072:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1073:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //TIMING:
1074:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Measurements below (in microseconds) are referring to preLVDS
1075:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  There may be other such old-notes...
1076:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1077:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1078:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        |<--T_Hhigh-->| |<-T_Hlow
1079:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    __   _____________   ____________  3.6V
1080:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // H    |_|             |_|           _  0V
1081:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1082:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    Data Enable
1083:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       Only active when there's valid pixel data
1084:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       (For a dual-pixel 1024x768 display:
1085:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //         for 512 of the 717 clocks in HSYNC-active)
1086:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       Low during Vsync... (~720us)
1087:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1088:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1089:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //IDTech display: 136 dots
1090:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //2-136+
1091:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //IDTech, last used: 40
1092:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //LTN Last used 8
1093:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // LTN: 1072<=1344<=1500 clocks per line, 1024DE... Hsync unused
1094:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // SEE Hlow_Delay() notes if this value is large!
1095:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1096:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef H_LOW_DOTS
1097:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (DISPLAY == LTN)
1098:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define H_LOW_DOTS	8
1099:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == IDT)
1100:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define H_LOW_DOTS   40//8//1//40 //30 //2//136
1101:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1102:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define H_LOW_DOTS	100//0 //LTN doesn't use H_LOW (DE-only)
1103:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 							  // And having a value here increases codesize
1104:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1105:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1106:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1107:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //H is set low immediately upon entry of the timer interrupt
1108:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // its low-time is controlled via nops
1109:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (so if HLow is long for a particular display, this might need revising)
1110:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1111:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if((!defined(HLOW_DELAY_OVERRIDE) || !HLOW_DELAY_OVERRIDE) \
1112:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		                                         && !defined(Hlow_Delay))
1113:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define Hlow_Delay() \
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 151


1114:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	delay_Dots(H_LOW_DOTS)
1115:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1116:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1117:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1118:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1119:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1120:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //This was found expermentally with SwitchResX
1121:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //IDTech Last Used: 680
1122:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (IDTech had some oddities regarding slow pixel-clocks, where pixels
1123:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  would be repeated, regardless of the pixel-clock, thus, for slow clocks
1124:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  it has the effect of *stretching* the image, thus 680 "pixels" across
1125:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  instead of its 1024 *physical* pixels)
1126:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //LTN last used 1024
1127:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Oddly: For the LTN, this doesn't seem to affect the horizontal
1128:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //        it does, however, affect the vertical(!)
1129:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // If I recall Correctly, this is used only for setting the timer interrupt
1130:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  rate...
1131:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef DE_ACTIVE_DOTS
1132:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (DISPLAY == LTN)
1133:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define DE_ACTIVE_DOTS	1024
1134:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == IDT)
1135:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define DE_ACTIVE_DOTS	680 //1024 //800 //920 //943 //812 //472 //1024
1136:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1137:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define DE_ACTIVE_DOTS	1024
1138:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1139:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1140:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1141:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Horizontal Blank Time: HD_DOTS + H_LOW + DH_DOTS
1142:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  90-320+
1143:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Horizontal Total Time: 1206<=1344<=2047
1144:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // ... but Total = Blank + Pixels, so 90+1024 != 1206
1145:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Excess waits should be thrown in DH (since that's between interrupts)
1146:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //T_HD is the time from H inactivated to DE activated
1147:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //aka H back-porch: 1-160+
1148:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //IDTech Last Used: 50
1149:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //LTN last used 5
1150:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1151:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef HD_DOTS
1152:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (DISPLAY == LTN)
1153:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define HD_DOTS 5
1154:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == IDT)
1155:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define HD_DOTS	50 //5 //0//20//5 //50 //30 //1 //160
1156:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1157:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define HD_DOTS 50//5
1158:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1159:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1160:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1161:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef HD_Delay
1162:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define HD_Delay()	delay_Dots(HD_DOTS)
1163:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1164:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1165:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // I think this was just a mistake. This change to delay_Dots a/o 0.10ncf
1166:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (untested in LCDdirectLVDS)
1167:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //delay_cyc(HD_DOTS)
1168:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1169:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1170:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // This is the number of CPU cycles between DE->L and Horiz->L
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 152


1171:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // This is just used in calculating the OCR value...
1172:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // aka H Front Porch: 0-24+
1173:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // IDTech Last Used: 24
1174:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // LTN last used 46
1175:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // 1072-1024-1-1 = 46
1176:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef DH_DOTS
1177:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (DISPLAY == LTN)
1178:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define DH_DOTS	46
1179:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == IDT)
1180:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define DH_DOTS	24 //46 //480//6//12//24 //46 //24 //122//30 //0 //24
1181:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1182:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define DH_DOTS	0//1000//100//46
1183:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1184:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1185:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1186:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       |
1187:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       v
1188:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      T_DH
1189:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      ||    |<-T_DE->|  |  |<--T_HD (Hsync->DE)
1190:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // H   __.  ____________  .___________
1191:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      .|_|  .        .|_|  .
1192:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     _.     .________.     .___________
1193:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE   |_____| 512clk |_____|
1194:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //      ^              ^
1195:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //       \___________   \                        (just avoiding \ warning)
1196:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                   \  |     768 Hsyncs
1197:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                    v v
1198:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     _             _ _ _ _ _ _ _ _ _ _ 
1199:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE   |___________| | | | | | | | | | |______
1200:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1201:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // one Hsync = T_HD+T_DH+T_Hlow+T_DE = 19.865us
1202:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1203:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //aka V-sync back porch: 7-29-63 "Vbp should be static"
1204:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // IDTech Last Used: 29
1205:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // LTN last used 3
1206:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //LTN Frame: 772<=806<=1000 lines...
1207:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1208:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef T_VD
1209:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (DISPLAY == LTN)
1210:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define T_VD 3
1211:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == IDT)
1212:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define  T_VD 29 //3//29 //7 //29
1213:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1214:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define T_VD 3
1215:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1216:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1217:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1218:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //aka V-sync front porch: 1-3+
1219:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // IDTech Last Used: 3
1220:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // LTN last used 3
1221:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef T_DV
1222:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (DISPLAY == LTN)
1223:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define T_DV 3
1224:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == IDT)
1225:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define T_DV 3//3 //1 //3
1226:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1227:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define T_DV 3
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 153


1228:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1229:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1230:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1231:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //1-6+ (1 is used by the first switch-case...)
1232:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // IDTech Last Used: 6
1233:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // LTN Last used 16
1234:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // 772 - 768 - 1 - 1 = 2
1235:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef T_Vlow
1236:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (DISPLAY == LTN)
1237:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define T_Vlow 16
1238:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == IDT)
1239:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define T_Vlow	6 //16//6 //2 //6
1240:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1241:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define T_Vlow 32
1242:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1243:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1244:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1245:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // IDTech Last Used: 768
1246:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef V_COUNT
1247:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (DISPLAY == LTN)
1248:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define V_COUNT	768
1249:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == IDT)
1250:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define V_COUNT	768
1251:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1252:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // #if (LVDS_PRESCALER == 8)
1253:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #define V_COUNT 768
1254:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // #else
1255:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  #define V_COUNT	(768*2/3)
1256:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // #endif
1257:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1258:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1259:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1260:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                       
1261:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                      |           
1262:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                      V           
1263:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              |<-T_DV>|           |<-T_VD-->|
1264:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              .       .           .         .
1265:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     _____________||__.   124us   .____||___________________
1266:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V           .   ||  |___________|    ||   .
1267:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     _ _ _ _ _ _ _|| _ _ _ _ _ _ _ _ _ ||_ _ _ _ _ _ _ _ _ _ _
1268:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H   | | | | | | ||| | | | | | | | | ||| | | | | | | | | | |
1269:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //              .   ||                   ||   .
1270:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     _ _ _ _ _.   ||       720us       ||   ._ _ _ _ _ _ _ _ _
1271:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE   | | | | |___||___________________||___| | | | | | | | |
1272:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                  ||                   ||
1273:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1274:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                        1
1275:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                        |
1276:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                        v               
1277:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     _________________   ___________________   _____________
1278:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  V                   |_|                   |_|
1279:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  H  |||||||||||||||||||||||||||||||||||||||||||||||||||||||
1280:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE  ||||||||||||||||_____|||||||||||||||||_____||||||||||||
1281:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                          ^
1282:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                          |
1283:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //                          2
1284:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 154


1285:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1286:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1287:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define HSYNC_COUNT_FRAME_COMPLETE  \
1288:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	(T_DV +(V_COUNT+T_VD+T_Vlow) + FRAME_UPDATE_DELAY)
1289:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // T_DV = 3
1290:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // V_COUNT = 768 
1291:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // T_VD = 3
1292:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // T_Vlow = 32
1293:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // FRAME_UPDATE_DELAY = 0
1294:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // TOTAL = 806
1295:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1296:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if(FRAME_UPDATE_DELAY != 0)
1297:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #error "FRAME_UPDATE_DELAY is no longer implemented..."
1298:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1299:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1300:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1301:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#if(HSYNC_COUNT_FRAME_COMPLETE & 0x01)
1302:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // #warning "Total vertical lines might need to be even!"
1303:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  //This should be fixed...
1304:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#endif
1305:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1306:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1307:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DOT_COUNT_PER_HSYNC \
1308:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	(H_LOW_DOTS + HD_DOTS + DE_ACTIVE_DOTS + DH_DOTS)
1309:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // H_LOW_DOTS = 100
1310:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // HD_DOTS = 50 
1311:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DE_ACTIVE_DOTS = 1024
1312:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DH_DOTS = 0
1313:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // TOTAL = 1174
1314:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1315:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1316:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#define MAKELONG (0L)
1317:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1318:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DOT_COUNT_PER_FRAME \
1319:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  ((MAKELONG(HSYNC_COUNT_FRAME_COMPLETE)) * (MAKELONG(DOT_COUNT_PER_HSYNC)))
1320:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // TOTAL = 946,244
1321:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1322:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Hlow_Delay 		H_LOW_DOTS
1323:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //HD_Delay			HD_DOTS	
1324:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //DE_ACTIVE_DOTS
1325:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //DH_DOTS
1326:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1327:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1328:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1329:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** static __inline__ \
1330:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** void loadData(uint16_t rowNum, uint8_t dataEnable) \
1331:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	  __attribute__((__always_inline__));
1332:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1333:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1334:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1335:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** /*
1336:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** static __inline__ \
1337:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** void loadRow(uint16_t rowNum) \
1338:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	__attribute__((__always_inline__));
1339:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** */
1340:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1341:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Returns TRUE when the frame is complete
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 155


1342:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Should send nada (and maybe hsyncs?) thereafter(?)
1343:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // In sdramThing2.0, when this returns TRUE, the SDRAM loading is complete
1344:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // EXCEPT: the final HD_Dots' FR_READ/ACTIVATE commands will point to a
1345:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  non-existent "next" Hsync... these commands need to be rewritten to
1346:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  point to the "first" Hsync. This is handled in sdramThing2.0's code
1347:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Used to be:
1348:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //SIGNAL(TIMER0_COMPA_vect)
1349:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //a/o v0.60: lcd_update() now returns the row-number (0 to V_COUNT-1)
1350:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //           Not *entirely* accurate, as it may be negative during VBLANK
1351:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //           OR returns LCD_FRAMECOMPLETE when that's the case.
1352:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DOES THIS RETURN THE ROW THAT WAS DRAWN OR THE NEXT...?
1353:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define LCD_FRAMECOMPLETE	INT16_MAX
1354:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** int16_t lcd_update(void)
1355:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
 2961               		.stabn	68,0,1355,.LM352-.LFBB26
 2962               	.LM352:
 2963               	.LFBB26:
 2964 0b20 CF93      		push r28
 2965 0b22 DF93      		push r29
 2966               	/* prologue: function */
 2967               	/* frame size = 0 */
 2968               	/* stack size = 2 */
 2969               	.L__stack_usage = 2
1356:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //	uint8_t frameComplete = FALSE;
1357:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1358:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #warning "this might be off by one, which would explain the weird first row"
1359:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	int16_t rowNum = hsyncCount - T_DV-T_VD-T_Vlow;
 2970               		.stabn	68,0,1359,.LM353-.LFBB26
 2971               	.LM353:
 2972 0b24 8091 0000 		lds r24,hsyncCount
 2973 0b28 9091 0000 		lds r25,hsyncCount+1
 2974 0b2c 8697      		sbiw r24,38
 2975 0b2e D82F      		mov r29,r24
 2976 0b30 C92F      		mov r28,r25
1360:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//static uint8_t frameCount = 0;
1361:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1362:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0 // (defined(SLOW_EVERYTHING_TEST) && SLOW_EVERYTHING_TEST)
1363:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	while(TCNT0L != 7){};
1364:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//This won't work... who knows how many cycles interrupt-entry will be
1365:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//Above should fix that...
1366:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//I think this was just an indicator for scope triggering...
1367:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// not relevent for 
1368:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	setpinPORT(PB2, PORTB);
1369:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	clrpinPORT(PB2, PORTB);
1370:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1371:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1372:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//Hsync and Actually draw the pixels... (when DE is active)
1373:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// This takes a LONG time and will occupy most of the CPU...
1374:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//  ... IN THIS INTERRUPT
1375:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//loadData(((hsyncCount-T_VD-T_Vlow)>>3)&31, dataEnable,colorOverride);
1376:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //	loadData(hsyncCount-T_DV-T_VD-T_Vlow, dataEnable);
1377:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1378:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1379:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	loadData(rowNum, dataEnable);
 2977               		.stabn	68,0,1379,.LM354-.LFBB26
 2978               	.LM354:
 2979 0b32 2091 0000 		lds r18,dataEnable
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 156


 2980               	.LBB135:
 2981               	.LBB136:
1380:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1381:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1382:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	hsyncCount++;
1383:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1384:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	switch(hsyncCount)
1385:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	{
1386:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//V Front Porch, begins with initLCD
1387:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1388:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Vsync H->L (Begin V-Sync)
1389:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		case T_DV:
1390:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			dataEnable = FALSE;
1391:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			//clrpinPORT(VSYNC_PIN, VSYNC_PORT);
1392:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			vSync = TRUE;
1393:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			Vsync_fromNada();
1394:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			break;
1395:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Vsync L->H (Begin V Back Porch)
1396:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		case T_Vlow + T_DV:
1397:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//	if(hfm_nextOutput(&modulator))
1398:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//		colorOverride = 0xff;
1399:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//	else
1400:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//		colorOverride = 7;
1401:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			//setpinPORT(VSYNC_PIN, VSYNC_PORT);
1402:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			vSync = FALSE;
1403:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			Nada_fromVsync();
1404:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			break;
1405:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Start of frame (DE active)
1406:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		case T_VD +(T_Vlow + T_DV):
1407:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			dataEnable = TRUE;
1408:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			break;
1409:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// All rows have been displayed
1410:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// Return to V Front Porch
1411:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		case V_COUNT +(T_VD + T_Vlow + T_DV):
1412:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			dataEnable = FALSE;
1413:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//	break;
1414:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Frame complete
1415:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//case HSYNC_COUNT_FRAME_COMPLETE:
1416:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			//T_DV +(V_COUNT+T_VD+T_Vlow) + FRAME_UPDATE_DELAY:
1417:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			hsyncCount = 0;
1418:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0 //(FRAME_COUNT_TO_DELAY != 0)
1419:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			//static uint8_t frameCount = 0;
1420:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			frameCount++;
1421:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			if(frameCount == FRAME_COUNT_TO_DELAY)
1422:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			{
1423:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 				frameCount = 0;
1424:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 				timer_compareMatchIntSetup(0, OUT_CHANNELA, FALSE);
1425:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 				//timer_compareMatchIntDisable(0, OUT_CHANNELA);
1426:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			}
1427:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1428:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			
1429:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#warning "NewNote: WTF, are we relying on loadData to have properly set the mode?"
1430:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Yeah, guess that makes sense... Must be Nada...
1431:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			//frameComplete = TRUE;
1432:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			rowNum = LCD_FRAMECOMPLETE;
1433:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			break;
1434:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		default:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 157


1435:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			break;
1436:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	}
1437:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1438:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1439:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //a/o 0.56ncf-1 (LCDdirectLVDS70)
1440:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // the call to loadRow is handled in the main project... and maybe it's
1441:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // best that way.
1442:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1443:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0 //(defined(LOADROW) && LOADROW)
1444:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//Load the next row into the row(seg)buffer
1445:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//data is enabled after T_VD+T_Vlow...
1446:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	if((hsyncCount >= T_VD+T_Vlow) && (hsyncCount < T_VD+T_Vlow+V_COUNT))
1447:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		loadRow(hsyncCount - (T_VD+T_Vlow));
1448:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1449:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1450:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//This note was written long before the above was commented-out...
1451:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//So...?
1452:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// Here is where loadRow used to be called
1453:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// it has been moved to oldNotes.txt, but it would make more sense
1454:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// to look at LCDdirectLVDS <25 or LCDdirect
1455:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// loadRow used the time between DE inactive and the next Hsync
1456:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// to load a row to a row-buffer (as opposed to a frame-buffer)
1457:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// thus, DE could gain more pixels because there would be fewer
1458:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// calculations to determine the memory location to write from
1459:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// This effect has since been minimized
1460:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// BUT loadRow might be necessary for program-memory-based images...
1461:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1462:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	return rowNum; //frameComplete;
1463:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
1464:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1465:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1466:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //See LCDdirectLVDS for an example...
1467:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // basically it loads a single row into a buffer for the next dateEnable
1468:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  (either the row-buffer or the row-segment-buffer) 
1469:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // This has been *greatly* reduced, is not at all functional, just
1470:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // to give an idea of loadRow's purpose.
1471:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0 //(defined(LOADROW) && LOADROW)
1472:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** void loadRow(uint16_t rowNum)
1473:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
1474:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//e.g....
1475:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	tet_drawRow(rbRowNum, rowBuffer);
1476:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	
1477:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//and...	
1478:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	rowBuffer[i] = fb_to_rb(colorVal);
1479:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	
1480:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//and...
1481:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	if((rbRowNum >= SMILE_TOP_ROW) &&
1482:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			(rbRowNum < (SMILE_HEIGHT+SMILE_TOP_ROW)))
1483:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	{
1484:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			for(i=0; i<FB_WIDTH; i++)
1485:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			{
1486:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****          	temp=pgm_readImageByte(pimage, rbRowNum-SMILE_TOP_ROW, i);
1487:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 				if(!(temp & 0xC0))
1488:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 					rowBuffer[i+SMILE_SHIFT] = fb_to_rb(temp);
1489:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			}
1490:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	}
1491:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 158


1492:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	life_drawRow(rbRowNum, &(rowBuffer[RB_WIDTH-LIFE_WIDTH]));
1493:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1494:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//HORIZONTAL_COLOR_BARS
1495:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	for(i=0; i<RB_WIDTH; i++)
1496:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		rowBuffer[i] = fb_to_rb(rowNum);
1497:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1498:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//Good for syncing to have white on both borders...
1499:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	newSeg(1, 0x06, (6<<4) | 3);
1500:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	
1501:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
1502:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif //LOAD_ROW
1503:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1504:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1505:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Including inactive pixel-clocks (timing)
1506:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // DotCount per row...
1507:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  TOTAL_CYC_COUNT was used for the timer-interrupt in LCDdirectLVDS
1508:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  This was DOTS_TO_CYC(DISPLAY_DOT_COUNT) + ROW_CALCULATION_CYCS
1509:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  ROW_CALCULATION_CYCS was 50,000 (!!!)
1510:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   DOTS_TO_CYC(dots), last-used, was dots*7 (LVDS_PRESCALER nullified /8)
1511:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   So, the overall dot-count per row was... 
1512:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     DISPLAY_DOT_COUNT + ROW_CALCULATION_DOTS
1513:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     where ROW_CALCULATION_DOTS = 50,000cyc/7 = 7142 dots
1514:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //     So... the overall dot-count per row was *MUCH* longer than usual
1515:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  Pretty certain there's not nearly enough memory to simulate that
1516:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   (in sdramThing2.0)
1517:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   But It does suggest that it would be worthwhile to try to stretch
1518:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   the rows as much as possible...
1519:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   During this time, NADA is sent normally, (V=H, H=H, DE=L)
1520:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    Or Vsync (V=L, H=H, DE=L)
1521:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   Maybe something could be simulated with PWM again, if necessary...
1522:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //   (Certainly not at full-speed)
1523:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DISPLAY_DOT_COUNT \
1524:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	(H_LOW_DOTS + HD_DOTS + DE_ACTIVE_DOTS + DH_DOTS)
1525:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1526:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0
1527:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1528:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#define T_Hlow_CYC 1//8 //(T_Halow_REAL*3)
1529:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define T_Hlow_CYC DOTS_TO_CYC(H_LOW_DOTS)
1530:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1531:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define T_DE_CYC	DOTS_TO_CYC(DE_ACTIVE_DOTS)
1532:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1533:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#define T_HD_CYC 1//3//(T_HD_REAL*3)
1534:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define T_HD_CYC	DOTS_TO_CYC(HD_DOTS)
1535:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1536:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define T_DH_CYC	DOTS_TO_CYC(DH_DOTS)
1537:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1538:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1539:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1540:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1541:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1542:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** void init_timer0Hsync(void)
1543:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
1544:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//T_HD + T_DH + T_low + T_DE
1545:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// For the original system, 19.865us = 695 dot-clocks
1546:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// We'd need to take advantage of the 16-bit timer
1547:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//  OCR1A may not be written properly (with a temporary high-byte)
1548:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//  ... not sure.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 159


1549:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// TIMER0 DOES NOT HAVE CTC MODE in 16-bit mode
1550:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1551:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // This is a hack, for testing syncability with long row-calculations
1552:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // before actually drawing it... e.g. loading from program memory
1553:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // This value needs to be larger than the calculation time
1554:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // otherwise, it seems, syncing isn't stable
1555:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // BUT THIS IS A HACK, has nothing to do with actual calculation time
1556:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // And for slow LVDS or whatnot, this may be unnecessarily HUGE
1557:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1558:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define DISPLAY_CYC_COUNT	(DOTS_TO_CYC(DISPLAY_DOT_COUNT))
1559:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //	(T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC)
1560:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1561:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //NOTE that with longer ROW_CALCULATION_CYCS, lines can be repeated...
1562:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // apparently an effect of the display, definitely not a code-thing
1563:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // in which case the vertical resolution decreases
1564:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // though, this could be used to advantage... 
1565:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (e.g. more processing time outside the drawing interrupts?)
1566:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // NOTE that if the value is too small and calculations take longer in some
1567:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // lines than others (?), those lines may repeat, or syncing could be off
1568:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (LVDS_PRESCALER == 8)
1569:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  //#define ROW_CALCULATION_DELAY 1//20
1570:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define ROW_CALCULATION_CYCS (50000) //0 //(70000) //(100000)
1571:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #else
1572:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  //#define ROW_CALCULATION_DELAY 9//7//5//2//1//10
1573:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define ROW_CALCULATION_CYCS	(8*DISPLAY_CYC_COUNT)
1574:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1575:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1576:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define TOTAL_CYC_COUNT \
1577:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	(ROW_CALCULATION_CYCS + DISPLAY_CYC_COUNT)
1578:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //	(ROW_CALCULATION_DELAY * (T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC))
1579:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //#define TOTAL_CYC_COUNT 2000
1580:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (TOTAL_CYC_COUNT > 255)
1581:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  //Adding +7 causes it to round up (hopefully)
1582:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define TIMER0_TCNTS ((TOTAL_CYC_COUNT+7)/8)
1583:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define TIMER0_CLKDIV	CLKDIV8
1584:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+7)/8: Timer0 CLKDIV8"
1585:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #if (TIMER0_TCNTS > 255)
1586:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+63)/64: Timer0 CLKDIV64"
1587:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #define TIMER0_TCNTS ((TOTAL_CYC_COUNT+63)/64)
1588:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #define TIMER0_CLKDIV CLKDIV64
1589:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #if (TIMER0_TCNTS > 255)
1590:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	 #warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+255)/256: Timer0 CLKDIV256"
1591:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	 #define TIMER0_TCNTS ((TOTAL_CYC_COUNT+255)/256)
1592:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	 #define TIMER0_CLKDIV CLKDIV256
1593:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	 #if (TIMER0_TCNTS > 255)
1594:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		#warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+1023)/1024: Timer0 CLKDIV1024"
1595:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		#define TIMER0_TCNTS ((TOTAL_CYC_COUNT+1023)/1024)
1596:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		#define TIMER0_CLKDIV	CLKDIV1024
1597:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	 #endif
1598:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #endif
1599:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #endif
1600:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #if (TIMER0_TCNTS == 0)
1601:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #error "TIMER0_OCRVAL == 0"
1602:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #endif
1603:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #else
1604:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define TIMER0_TCNTS TOTAL_CYC_COUNT
1605:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define TIMER0_CLKDIV CLKDIV1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 160


1606:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1607:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1608:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (defined(SLOW_EVERYTHING_TEST) && SLOW_EVERYTHING_TEST)
1609:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  //For testing, I want to see the pulses with the 'scope
1610:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  // Unless the timer is divisible by 7 the pulses will not align with the
1611:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  // timer overflow...
1612:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  //but shit... it's running at clkdiv8 so each TCNT is 64 bits!
1613:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  // but this shouldn't matter for visualizing, that's only ~10 pixel clocks
1614:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  // and we'll only start visualizing *after* the extra TCNTs...
1615:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  //Since the timer counts from 0 to (and including) OCR1A
1616:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  // Add one to this test...
1617:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #if (((TIMER0_TCNTS + 1) % 7) == 0)
1618:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 1) % 7 == 0"
1619:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS"
1620:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS)
1621:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1622:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 2) % 7) == 0)
1623:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 2) % 7 == 0"
1624:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 1"
1625:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 1)
1626:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1627:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 3) % 7) == 0)
1628:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 3) % 7 == 0"
1629:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 2"
1630:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 2)
1631:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1632:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 4) % 7) == 0)
1633:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 4) % 7 == 0"
1634:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 3"
1635:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 3)
1636:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1637:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 5) % 7) == 0)
1638:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 5) % 7 == 0"
1639:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 4"
1640:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 4)
1641:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1642:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 6) % 7) == 0)
1643:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 6) % 7 == 0"
1644:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 5"
1645:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 5)
1646:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1647:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #elif (((TIMER0_TCNTS) % 7) == 0)
1648:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "(TIMER0_TCNTS) % 7 == 0"
1649:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS - 1"
1650:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS - 1)
1651:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1652:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #else
1653:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****   #error "WTF?"
1654:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #endif
1655:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #else
1656:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define TIMER0_OCRVAL (TIMER0_TCNTS-1)
1657:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1658:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1659:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (TIMER0_OCRVAL > 255)
1660:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #error "Despite all my efforts, TIMER0_OCRVAL is *still* > 255!"
1661:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1662:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 161


1663:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    OCR0A = TIMER0_OCRVAL; //T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC;
1664:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	timer_setWGM(0, WGM_CLR_ON_COMPARE);
1665:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    timer_selectDivisor(0, TIMER0_CLKDIV); //CLKDIV1);
1666:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    timer_compareMatchIntEnable(0, OUT_CHANNELA);
1667:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
1668:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1669:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define fullBlue()	DEblue_init()
1670:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1671:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1672:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1673:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //Either use one of the ones here, or define your own...
1674:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // rowNum is the drawable row number on the LCD...
1675:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //static __inline__ void drawPix(uint16_t rowNum);
1676:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1677:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // This should have a uint16 rowNum!
1678:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // But, so far, the only cases which use all 768 rows are LCDdirectLVDS
1679:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // with RowSegBuffer, and sdramThing (how did this uint8_t thing not cause
1680:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // trouble there?!)
1681:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // RowSegBuffer doesn't pay attention to rowNum in drawPix...
1682:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1683:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1684:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1685:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0
1686:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if (!defined(ROW_SEG_BUFFER) || !ROW_SEG_BUFFER)
1687:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //drawPix loads each pixel individually... It doesn't use a for-loop
1688:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // since that would take away from actual pixel-drawing time...
1689:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // I think it's been removed... but here's a (non-functional) example...
1690:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** void drawPix(uint8_t rowNum)
1691:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
1692:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	writeColor(*(color+1));	 
1693:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	writeColor(*(color+2));	 
1694:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	writeColor(*(color+3)); 
1695:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	...
1696:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	writeColor(*(color+61));
1697:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	writeColor(*(color+62));
1698:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	writeColor(*(color+63));
1699:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// WriteColor writes the pixel *after* the calculations...
1700:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// thus the pixel appears basically after writeColor completes
1701:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	// These nops assure the 64th pixel is fully-displayed before exitting
1702:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	asm("nop");
1703:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	...
1704:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	asm("nop");
1705:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1706:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** /*		reg[17] = colorBuffer[rowNum][17];                         
1707:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		writeColor(reg[17]);                         
1708:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		...
1709:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		reg[20] = colorBuffer[rowNum][20];                         
1710:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		writeColor(reg[20]);  
1711:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		
1712:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//REPEATING to fill screen... (delayDots = 342 worked prior to this)
1713:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		reg[0] = colorBuffer[rowNum][0];
1714:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		writeColor(reg[0]);
1715:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		...
1716:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		reg[10] = colorBuffer[rowNum][10];
1717:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		writeColor(reg[10]);
1718:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** */
1719:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Display the rest as black...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 162


1720:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		writeColor(0);
1721:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
1722:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #else		//ROW_SEG_BUFFER
1723:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** void drawPix(uint8_t rowNum)
1724:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
1725:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
1726:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	         | (0<<COM1B1) | (1<<COM1B0)
1727:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	         | (1<<PWM1A) | (1<<PWM1B) );
1728:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1729:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** /* This bit was in loadData, just some notes, now...
1730:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1731:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  WTF, how did this work?! Am I not using drawPix?!
1732:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    Yes, but drawPix calls drawSegs, which doesn't have an argument
1733:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    because loadRow takes the row argument elsewhere, drawSegs just
1734:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    draws 'em
1735:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       //#warning "see 'shouldBe' here..."
1736:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       //Should be:
1737:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       rowNum = rowNum*FB_HEIGHT/V_COUNT;
1738:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       //rowNum = rowNum / (768/FB_HEIGHT);
1739:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1740:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	So, rowNum change left-over from the ol' FrameBuffer days had no effect
1741:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	on drawSegs.
1742:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** */
1743:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1744:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1745:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1746:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		drawSegs();
1747:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1748:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1749:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//DE->Nada transition expects fullBlue...
1750:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Also helps to show the edge of the DE timing...
1751:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1752:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//!!! Not sure what the state is at this point...
1753:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// could be any DE+Blue level, or could be NADA...
1754:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// Nada: DT1=3, still leaves one bit for clocking, might be OK
1755:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****          
1756:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Among the things that don't make sense...
1757:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// This appears to go into affect BEFORE delay_cyc (?)
1758:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// as, without a pull-up resistor on the /OC1B output, 
1759:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// green seems to be floating between the last pixel and the
1760:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// delay_cyc (!)
1761:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Disable complementary-output for Green 
1762:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//  (on /OC1B, where CLK is OC1B)
1763:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// Since Nada, V, and H DT's might be bad for clocking.
1764:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
1765:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****          | (1<<COM1B1) | (0<<COM1B0)
1766:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****          | (1<<PWM1A) | (1<<PWM1B) );
1767:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1768:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		fullBlue();
1769:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
1770:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif //0
1771:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1772:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1773:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1774:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //          G) groovy little spiral...
1775:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1776:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 163


1777:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0 //(defined(CLOCK_INSENSITIVITY_TESTING) && CLOCK_INSENSITIVITY_TESTING)
1778:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEonly_fromNada();
1779:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Enable complementary-output for Green (on /OC1B, where CLK is OC1B)
1780:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
1781:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 				   | (0<<COM1B1) | (1<<COM1B0)
1782:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 					| (1<<PWM1A) | (1<<PWM1B) );
1783:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1784:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1785:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1786:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1787:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1788:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1789:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1790:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1791:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1792:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1793:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** /* These are old tests from above, under if(dataEnable)
1794:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    They should all be implemented in lcdStuff.c, but have not been
1795:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    retested since...
1796:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if(defined(BLUE_DIAG_BAR) && BLUE_DIAG_BAR)
1797:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       uint16_t blueCyc = DOTS_TO_CYC(rowNum);
1798:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       uint16_t notBlueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS)-blueCyc;
1799:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       
1800:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       DEonly_fromNada();
1801:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       delay_cyc(notBlueCyc);
1802:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       DEblue_fromDEonly();
1803:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       delay_cyc(blueCyc);
1804:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1805:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       Nada_fromDEblue();
1806:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif(defined(BLUE_VERT_BAR) && BLUE_VERT_BAR)
1807:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       DEonly_fromNada();
1808:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)/3);
1809:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       DEblue_fromDEonly();
1810:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)*2/3);
1811:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       Nada_fromDEblue();
1812:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif(defined(DE_BLUE) && DE_BLUE)
1813:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       DEblue_fromNada();
1814:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS));
1815:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       Nada_fromDEblue();
1816:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #else  //NOT BLUE_DIAG_BAR, BLUE_VERT_BAR, NOR DE_BLUE
1817:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #if ( defined(COLOR_BAR_SCROLL) && COLOR_BAR_SCROLL)
1818:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       if(rowNum <= 256)
1819:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****          rowNum=0;
1820:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       else
1821:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****          rowNum=1;
1822:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #else //NOT COLOR_BAR_SCROLL... drawPix...
1823:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** */
1824:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1825:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1826:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1827:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //a/o LCDdirectLVDS62:
1828:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // These BLUE_... tests are being reimplemented.
1829:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // They're *quite* handy for initial-testing of an untested display.
1830:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //
1831:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // Realistically, they should probably be less LVDS-specific
1832:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (non-LVDS displays needn't be coded with these transition-specific
1833:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // functions like DEonly_fromNada() or DEblue_fromDEonly(), and certainly
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 164


1834:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // needn't be limited to blue/black testing. LVDS displays contain their
1835:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // syncing signals on the same wire as the blue pixel-data, thus these
1836:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // tests...)
1837:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // In the long-run, maybe they should be moved to an lvdsLCD commonCode
1838:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // and the transition-specific code removed from here, but I've yet to
1839:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // explore this.
1840:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // For non-LVDS displays, these should still be pretty good tests, and
1841:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // implementing transition-specific functions shouldn't be too difficult...
1842:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // e.g. "#define DEonly_fromNada()    setpinPORT(DE_PIN, DE_PORT)"
1843:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // or   "#define DEblue_fromDEonly()  BLUE_PORT = 0xff"
1844:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (Actually, transition-specific functions make it faster regardless of
1845:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // the LVDS/non-LVDS nature of the display, as some things are redundant...
1846:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // e.g. if calls to DEonly_fromNada() were replaced with calls to DEonly(),
1847:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // it would require disabling H-sync and V-sync, in addition to enabling DE
1848:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // in every call. When we start getting into worrying about aligning pixels
1849:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // with the edge of the display and making them as skinny as possible, each
1850:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // cpu instruction counts.
1851:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // So, I guess, the only LVDS-specific stuff here is the blue-related
1852:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // transitions (and, more specifically, the fact that there are *only*
1853:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // blue-related transitions, as opposed to red and green)
1854:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1855:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //a/o sdramThing2.0v8 early... appears to be syncing on Blue signal
1856:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // thus we get diagonal data including Hsync (colored in red) along the
1857:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // as a diagonal stripe at the right
1858:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if((defined(BLUE_DIAG_BAR) && BLUE_DIAG_BAR) || \
1859:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	 (defined(BLUE_DIAG_BAR_SCROLL) && BLUE_DIAG_BAR_SCROLL) )
1860:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //BORDER is somewhat risky...
1861:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // It doesn't actually add a border to the right-side
1862:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // The green shown there is due to DE deactivating.
1863:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define BORDER ((DE_ACTIVE_DOTS - V_COUNT)/2)
1864:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define drawPixSetup dpSetup
1865:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //uint16_t blueDots;
1866:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //uint16_t blackDots;
1867:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //int16_t notBlueCyc;
1868:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //int16_t blueCyc;
1869:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** int32_t blueCount;
1870:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** int32_t blackCount;
1871:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1872:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1873:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** static __inline__ void dpSetup(uint16_t rowNum)
1874:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
1875:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	uint32_t blueDots = rowNum;
1876:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if(defined(BLUE_DIAG_BAR_SCROLL) && BLUE_DIAG_BAR_SCROLL)
1877:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	static uint16_t rowOffset = 0;
1878:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	if(rowNum == 0)
1879:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	{
1880:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		rowOffset++;
1881:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		if(rowOffset >= (DE_ACTIVE_DOTS-BORDER))
1882:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			rowOffset = 0;
1883:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	}
1884:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1885:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	blueDots += rowOffset;
1886:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1887:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	while(blueDots >= (DE_ACTIVE_DOTS-BORDER))
1888:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	{
1889:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//rowOffset = 0;
1890:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		blueDots -= (DE_ACTIVE_DOTS-BORDER);
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 165


1891:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	}
1892:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//blueDots %= DE_ACTIVE_DOTS;
1893:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1894:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //If dots-to-cyc is used, then calculations should be done ahead of time
1895:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //e.g. in lvds: delay_Dots(n) = delay_cyc(DOTS_TO_CYC(n))
1896:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // but DOTS_TO_CYC is a lot of math when its argument is non-constant
1897:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if(defined(LCDSTUFF_USE_DOTS_TO_CYC_IN_DELAY_DOTS) && \
1898:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 				LCDSTUFF_USE_DOTS_TO_CYC_IN_DELAY_DOTS)
1899:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //	blueDots = rowNum;
1900:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //	blackDots = DE_ACTIVE_DOTS - blueDots;
1901:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//notBlueCyc = rowNum; //DOTS_TO_CYC(rowNum);
1902:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//blueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS-BORDER) - rowNum; //DOTS_TO_CYC(DE_ACTIVE_DOTS-BORDER-rowNu
1903:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	blueCount = DOTS_TO_CYC(blueDots);
1904:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//blueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS-BORDER - rowNum); //DOTS_TO_CYC(DE_ACTIVE_DOTS-BORDER-rowNu
1905:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	blackCount = DOTS_TO_CYC(DE_ACTIVE_DOTS-BORDER) - blueCount;
1906:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	if(blackCount < 0)
1907:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		blackCount = 0;
1908:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #else //delayDots doesn't use DOTS_TO_CYC (e.g. bitbanged pixel-clock)
1909:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	   // or maybe SDRAMThing
1910:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	blueCount = blueDots;
1911:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	blackCount = DE_ACTIVE_DOTS-BORDER - blueDots;
1912:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1913:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1914:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
1915:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1916:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifndef LCDSTUFF_USE_DOTS_TO_CYC_IN_DELAY_DOTS
1917:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #error "LCDSTUFF_USE_DOTS_TO_CYC_IN_DELAY_DOTS is not defined. It should be either TRUE or FALSE; s
1918:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #elif(LCDSTUFF_USE_DOTS_TO_CYC_IN_DELAY_DOTS)
1919:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define delayCount	delay_cyc
1920:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #else //FALSE
1921:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #define delayCount	delay_Dots
1922:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1923:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1924:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** DP_INLINEABLE void drawPix(uint16_t rowNum)
1925:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
1926:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//dpSetup(rowNum);
1927:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//uint16_t blueCyc = DOTS_TO_CYC(rowNum);
1928:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//uint16_t notBlueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS)-blueCyc;
1929:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //		uint16_t blueDots = rowNum;
1930:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //		uint16_t blackDots = DE_ACTIVE_DOTS - blueDots;
1931:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1932:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEonly_fromNada();
1933:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//a/o v0.70-1, swapping blue and not-blue...
1934:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//This is a bit of a hack, since DEblue_fromNada doesn't exist...
1935:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEblue_fromDEonly();
1936:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(BORDER));
1937:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		delay_Dots(BORDER);
1938:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEonly_fromDEblue();
1939:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1940:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		delayCount(blackCount);
1941:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(blueDots);
1942:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//DE_DotDelay(blackDots);
1943:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//DEonly_fromDEblue();
1944:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEblue_fromDEonly();
1945:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1946:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		delayCount(blueCount);
1947:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(blackDots);
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 166


1948:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//DE_DotDelay(blueDots);
1949:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Nada_fromDEonly();
1950:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		Nada_fromDEblue();
1951:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
1952:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1953:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1954:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1955:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //a/o LCDdirectLVDS62: This is the same as above, but scrolls vertically
1956:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // one line per refresh... so it's easy to calculate the refresh-rate
1957:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if(defined(BLUE_DIAG_BAR_SCROLL) && BLUE_DIAG_BAR_SCROLL)
1958:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** /*DP_INLINEABLE void drawPix(uint16_t rowNum)
1959:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
1960:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	static uint16_t rowOffset;
1961:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	if(rowNum == 0)
1962:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		rowOffset++;
1963:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//uint16_t blueCyc = DOTS_TO_CYC(rowNum);
1964:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//uint16_t notBlueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS)-blueCyc;
1965:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		uint16_t notBlueDots = (rowNum + rowOffset)%DE_ACTIVE_DOTS;
1966:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		uint16_t blueDots = DE_ACTIVE_DOTS - notBlueDots;
1967:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1968:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEonly_fromNada();
1969:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEblue_fromDEonly();
1970:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_cyc(notBlueCyc);
1971:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(notBlueDots);
1972:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(blueDots);
1973:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEonly_fromDEblue();
1974:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_cyc(blueCyc);
1975:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(blueDots);
1976:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(notBlueDots);
1977:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		Nada_fromDEonly();
1978:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
1979:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** */
1980:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1981:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
1982:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1983:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1984:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
1985:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //a/o LCDdirectLVDS62: This is the same as above, but alternates colors
1986:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //between each frame...
1987:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // (Careful, this one'll cause seizures!)
1988:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if(defined(BLUE_DIAG_SCROLL_FLASH) && BLUE_DIAG_SCROLL_FLASH)
1989:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #error "BLUE_DIAG_SCROLL_FLASH is broken a/o v91 + GCC48)"
1990:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** DP_INLINEABLE void drawPix(uint16_t rowNum)
1991:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
1992:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	static uint16_t rowOffset;
1993:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	if(rowNum == 0)
1994:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		rowOffset++;
1995:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//uint16_t blueCyc = DOTS_TO_CYC(rowNum);
1996:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//uint16_t notBlueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS)-blueCyc;
1997:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		uint16_t blueDots = (rowNum + rowOffset)%DE_ACTIVE_DOTS;
1998:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		uint16_t notBlueDots = DE_ACTIVE_DOTS - blueDots;
1999:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2000:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if(defined(BDSF_ALTERNATE_ROWS) && BDSF_ALTERNATE_ROWS)
2001:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	if(rowNum&0x01)
2002:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #else
2003:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	if(rowOffset&0x01)
2004:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 167


2005:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	{
2006:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEonly_fromNada();
2007:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_cyc(notBlueCyc);
2008:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(notBlueDots);
2009:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(notBlueDots);
2010:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEblue_fromDEonly();
2011:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_cyc(blueCyc);
2012:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(blueDots);
2013:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(blueDots);
2014:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		Nada_fromDEblue();
2015:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	}
2016:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	else
2017:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	{
2018:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEblue_fromNada();
2019:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_cyc(notBlueCyc);
2020:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(notBlueDots);
2021:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(notBlueDots);
2022:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEonly_fromDEblue();
2023:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_cyc(blueCyc);
2024:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(blueDots);
2025:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(blueDots);
2026:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		Nada_fromDEonly();
2027:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	}
2028:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
2029:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2030:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2031:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2032:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //a/o sdramThing2.0v8-31ish: LooksPromising, but delayed
2033:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // also LVDS bit-shifts causing vertical striping
2034:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if(defined(BLUE_VERT_BAR) && BLUE_VERT_BAR)
2035:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** DP_INLINEABLE void drawPix(uint16_t rowNum)
2036:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
2037:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEonly_fromNada();
2038:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)/3);
2039:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS/3);
2040:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS/3);
2041:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEblue_fromDEonly();
2042:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)*2/3);
2043:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS - DE_ACTIVE_DOTS/3);
2044:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS - DE_ACTIVE_DOTS/3);
2045:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		Nada_fromDEblue();
2046:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
2047:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2048:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2049:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //a/o sdramThing2.0v8-32 nogo... syncs at end of blue instead of Hsync
2050:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if(defined(BLUE_VERT_BAR_REVERSED) && BLUE_VERT_BAR_REVERSED)
2051:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** DP_INLINEABLE void drawPix(uint16_t rowNum)
2052:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
2053:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEblue_fromNada();
2054:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)/3);
2055:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS/3);
2056:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS/3);
2057:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEonly_fromDEblue();
2058:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)*2/3);
2059:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS - DE_ACTIVE_DOTS/3);
2060:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS - DE_ACTIVE_DOTS/3);
2061:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		Nada_fromDEonly();
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 168


2062:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
2063:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2064:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2065:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2066:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if(defined(DE_BLUE) && DE_BLUE)
2067:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** DP_INLINEABLE void drawPix(uint16_t rowNum)
2068:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
2069:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEblue_fromNada();
2070:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS));
2071:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS);
2072:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS);
2073:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		Nada_fromDEblue();
2074:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
2075:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2076:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2077:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if(defined(BLUE_BORDER) && (BLUE_BORDER!=0))
2078:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** DP_INLINEABLE void drawPix(uint16_t rowNum)
2079:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
2080:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEblue_fromNada();
2081:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(BLUE_BORDER);
2082:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEonly_fromDEblue();
2083:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS - BLUE_BORDER*2);
2084:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEblue_fromDEonly();
2085:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(BLUE_BORDER);
2086:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		Nada_fromDEblue();
2087:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
2088:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2089:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2090:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2091:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if(defined(BLUE_FRAME) && BLUE_FRAME)
2092:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define drawPixSetup dpSetup
2093:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** uint8_t insideFrame;
2094:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2095:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** static __inline__ void dpSetup(uint16_t rowNum)
2096:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
2097:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	insideFrame = 
2098:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		((rowNum > V_COUNT/4) && (rowNum < V_COUNT-V_COUNT/4));
2099:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
2100:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #define BORDER	((DE_ACTIVE_DOTS)/4)
2101:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** DP_INLINEABLE void drawPix(uint16_t rowNum)
2102:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
2103:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //	uint8_t insideFrame = 
2104:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //		((rowNum > V_COUNT/4) && (rowNum < V_COUNT-V_COUNT/4));
2105:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2106:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	DEblue_fromNada();
2107:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	/*
2108:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifdef lvds_enableGreen_MakeClockSensitiveToDT
2109:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	lvds_enableGreen_MakeClockSensitiveToDT();
2110:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2111:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** */
2112:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	if(insideFrame) //(rowNum > V_COUNT/4) && (rowNum < V_COUNT-V_COUNT/4))
2113:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	{
2114:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//DEblue_fromNada();
2115:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(BORDER);
2116:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEonly_fromDEblue();
2117:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS - BORDER*2);
2118:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEblue_fromDEonly();
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 169


2119:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(BORDER);//+200);//Not having any effect!
2120:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Nada_fromDEblue();
2121:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	}
2122:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	else
2123:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	{
2124:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//DEblue_fromNada();
2125:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //		DE_DotDelay(DE_ACTIVE_DOTS); //+200); Seems to be affecting above!!!
2126:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //    Rounding-down(?) seems to cause the above to be significantly longer
2127:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//than the three below...
2128:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//WTF.
2129:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// DE_ACTIVE_DOTS = 1000 -> 1750 CYC
2130:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// 437Cyc/BORDER, 875Cyc center
2131:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// = 1749Cyc...
2132:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// Why is it *so far* off without all this rigamorole?!
2133:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// a/o BOE
2134:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2135:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(BORDER);
2136:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//DEonly_fromDEblue();
2137:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifdef DEonly_fromDEblue_Placeholder
2138:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEonly_fromDEblue_Placeholder();
2139:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2140:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS - BORDER*2);
2141:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifdef DEblue_fromDEonly_Placeholder
2142:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DEblue_fromDEonly_Placeholder();
2143:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2144:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//DEblue_fromDEonly();
2145:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		DE_DotDelay(BORDER);//+200);//Not having any effect!
2146:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Nada_fromDEblue();
2147:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	}
2148:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	/*
2149:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifdef lvds_disableGreen_MakeClockInsensitiveToDT
2150:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	lvds_disableGreen_MakeClockInsensitiveToDT();
2151:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2152:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** */
2153:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	Nada_fromDEblue();
2154:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** }
2155:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2156:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2157:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2158:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0
2159:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //NOT BLUE_DIAG_BAR, BLUE_VERT_BAR, NOR DE_BLUE
2160:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #if ( defined(COLOR_BAR_SCROLL) && COLOR_BAR_SCROLL)
2161:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		if(rowNum <= 256)
2162:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			rowNum=0;
2163:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		else
2164:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			rowNum=1;
2165:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #else //NOT COLOR_BAR_SCROLL... drawPix...
2166:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//#warning "see 'shouldBe' here..."
2167:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Should be:
2168:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		rowNum = rowNum*FB_HEIGHT/V_COUNT;
2169:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//rowNum = rowNum / (768/FB_HEIGHT);
2170:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #endif
2171:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2172:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//DEonly_fromNada();
2173:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       drawPix(rowNum);
2174:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Nada_init();
2175:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****  #warning "THIS ISN'T SAFE"
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 170


2176:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		Nada_fromDEonly();
2177:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//Drawing Methods...
2178:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2179:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0 //(defined(CLOCK_INSENSITIVITY_TESTING) && CLOCK_INSENSITIVITY_TESTING)
2180:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//!!! Not sure what the state is at this point...
2181:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// could be any DE+Blue level, or could be NADA...
2182:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// Nada: DT1=3, still leaves one bit for clocking, might be OK
2183:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2184:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       //Disable complementary-output for Green 
2185:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//  (on /OC1B, where CLK is OC1B)
2186:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		// Since Nada, V, and H DT's might be bad for clocking.
2187:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
2188:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****                | (1<<COM1B1) | (0<<COM1B0)
2189:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****                | (1<<PWM1A) | (1<<PWM1B) );
2190:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2191:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2192:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//colorOverride removed in LVDS, revisit LCDdirect50
2193:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2194:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2195:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2196:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2197:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // AND HERE!!!
2198:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2199:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** // rowNum is only used when DE is active...
2200:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** //  and should be 0 at *drawn row* 0
2201:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** void loadData(uint16_t rowNum, uint8_t dataEnable)
2202:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** {
2203:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2204:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #ifdef drawPixSetup
2205:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	drawPixSetup(rowNum);
2206:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #endif
2207:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2208:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	//H Active pulse...
2209:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    if(vSync)
 2982               		.stabn	68,0,2209,.LM355-.LFBB26
 2983               	.LM355:
 2984 0b36 3091 0000 		lds r19,vSync
 2985 0b3a 3323      		tst r19
 2986 0b3c 01F0      		breq .L215
2210:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    {
2211:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Vsync_fromNada() is called at the end of the last interupt
2212:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       VplusH_fromVsync();
 2987               		.stabn	68,0,2212,.LM356-.LFBB26
 2988               	.LM356:
 2989 0b3e 1DBC      		out 0x2d,__zero_reg__
 2990               	.LBB137:
 2991               	.LBB138:
 2992               	.LBB139:
 2993               	.LBB140:
 2994               		.stabs	"/opt/local/avr/include/util/delay_basic.h",132,0,0,.Ltext26
 2995               	.Ltext26:
 2996               		.stabn	68,0,105,.LM357-.LFBB26
 2997               	.LM357:
 2998 0b40 ECE2      		ldi r30,lo8(44)
 2999 0b42 F0E0      		ldi r31,0
 3000               	/* #APP */
 3001               	 ;  105 "/opt/local/avr/include/util/delay_basic.h" 1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 171


 3002 0b44 3197      		1: sbiw r30,1
 3003 0b46 01F4      		brne 1b
 3004               	 ;  0 "" 2
 3005               	/* #NOAPP */
 3006               	.LBE140:
 3007               	.LBE139:
 3008               	.LBE138:
 3009               	.LBE137:
 3010               		.stabs	"_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c",132,0,0,.Ltext27
 3011               	.Ltext27:
2213:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       Hlow_Delay();
2214:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       Vsync_fromVplusH();
 3012               		.stabn	68,0,2214,.LM358-.LFBB26
 3013               	.LM358:
 3014 0b48 35E0      		ldi r19,lo8(5)
 3015 0b4a 00C0      		rjmp .L227
 3016               	.L215:
2215:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       HD_Delay();
2216:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    }
2217:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    else
2218:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    {
2219:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       Hsync_fromNada();
 3017               		.stabn	68,0,2219,.LM359-.LFBB26
 3018               	.LM359:
 3019 0b4c 33E0      		ldi r19,lo8(3)
 3020 0b4e 3DBD      		out 0x2d,r19
 3021               	.LBB141:
 3022               	.LBB142:
 3023               	.LBB143:
 3024               	.LBB144:
 3025               		.stabs	"/opt/local/avr/include/util/delay_basic.h",132,0,0,.Ltext28
 3026               	.Ltext28:
 3027               		.stabn	68,0,105,.LM360-.LFBB26
 3028               	.LM360:
 3029 0b50 ECE2      		ldi r30,lo8(44)
 3030 0b52 F0E0      		ldi r31,0
 3031               	/* #APP */
 3032               	 ;  105 "/opt/local/avr/include/util/delay_basic.h" 1
 3033 0b54 3197      		1: sbiw r30,1
 3034 0b56 01F4      		brne 1b
 3035               	 ;  0 "" 2
 3036               	/* #NOAPP */
 3037               	.LBE144:
 3038               	.LBE143:
 3039               	.LBE142:
 3040               	.LBE141:
 3041               		.stabs	"_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c",132,0,0,.Ltext29
 3042               	.Ltext29:
2220:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       Hlow_Delay();
2221:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       Nada_fromHsync();
 3043               		.stabn	68,0,2221,.LM361-.LFBB26
 3044               	.LM361:
 3045 0b58 34E0      		ldi r19,lo8(4)
 3046               	.L227:
 3047 0b5a 3DBD      		out 0x2d,r19
 3048               	.LBB145:
 3049               	.LBB146:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 172


 3050               	.LBB147:
 3051               	.LBB148:
 3052               		.stabs	"/opt/local/avr/include/util/delay_basic.h",132,0,0,.Ltext30
 3053               	.Ltext30:
 3054               		.stabn	68,0,105,.LM362-.LFBB26
 3055               	.LM362:
 3056 0b5c E2E0      		ldi r30,lo8(2)
 3057 0b5e F0E0      		ldi r31,0
 3058               	/* #APP */
 3059               	 ;  105 "/opt/local/avr/include/util/delay_basic.h" 1
 3060 0b60 3197      		1: sbiw r30,1
 3061 0b62 01F4      		brne 1b
 3062               	 ;  0 "" 2
 3063               	/* #NOAPP */
 3064               	.LBE148:
 3065               	.LBE147:
 3066               	.LBE146:
 3067               	.LBE145:
 3068               		.stabs	"_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c",132,0,0,.Ltext31
 3069               	.Ltext31:
2222:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****       HD_Delay();
2223:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    }
2224:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
2225:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c ****    if(dataEnable)
 3070               		.stabn	68,0,2225,.LM363-.LFBB26
 3071               	.LM363:
 3072 0b64 2111      		cpse r18,__zero_reg__
 3073               	.LBB149:
 3074               	.LBB150:
 3075               		.stabs	"main.c",132,0,0,.Ltext32
 3076               	.Ltext32:
 428:main.c        **** 
 429:main.c        **** 	//The sony display seems to dislike not having a dot-clock...
 430:main.c        **** 	// This is an experiment...
 431:main.c        ****   #if (defined(LCDINTERFACE_BITBANGED_DOTCLOCK_PWM) && \
 432:main.c        **** 		  LCDINTERFACE_BITBANGED_DOTCLOCK_PWM)
 433:main.c        **** 	lcdInterface_pwmDotClockInit(FALSE);
 434:main.c        ****   #endif
 435:main.c        ****  }
 436:main.c        **** 
 437:main.c        ****  //Nearly everything display-related happens in this interrupt
 438:main.c        ****  // It even calls the functions that load (and calculate!) the data for the
 439:main.c        ****  // next row.
 440:main.c        ****  // So basically, the entire project is running via timer-interrupt.
 441:main.c        ****  SIGNAL(HSYNC_TIMER_INTERRUPT_VECT) //TIMER0_COMPA_vect)
 442:main.c        ****  {
 443:main.c        **** 	 //This was an *early* test to compare functionality between v91 and
 444:main.c        **** 	 //V66.51 (which was working)
 445:main.c        **** 	 // Didn't seem to have any effect.
 446:main.c        **** 	 // Wasn't until later it was discovered that GCC4.4 was being used for
 447:main.c        **** 	 // v66.51, and therein lied the problem, not here.
 448:main.c        **** 	 // a/o v92, this has been disabled, and no noticeable change has
 449:main.c        **** 	 // appeared on the BOE display.
 450:main.c        **** 	 // Plus, the heart now works.
 451:main.c        **** 	 // This does NOT make v92+ compatible with V66.51-64 (the last version)
 452:main.c        **** 	 // but more like v66.51-1, so is basically irrelevent, now.
 453:main.c        **** 	 // (And doesn't take into account any changes made since v91, anyhow).
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 173


 454:main.c        **** //#define V6651COMPARE TRUE
 455:main.c        **** 
 456:main.c        **** #if (!defined(V6651COMPARE) || !V6651COMPARE)
 457:main.c        **** #if(defined(_DMS_EXTERNALUPDATE_) && _DMS_EXTERNALUPDATE_)
 458:main.c        **** 	 dms_update();
 459:main.c        **** #endif
 460:main.c        **** 
 461:main.c        **** 		//Since HEART_TCNTER_UPDATES_AND_INIT is not true (could test here)
 462:main.c        **** 		// we need to do it manually...
 463:main.c        **** 		// (because the tcnter uses the hsyncTimer)
 464:main.c        **** #if(!defined(HEART_TCNTER_UPDATES_AND_INIT) || \
 465:main.c        **** 		!HEART_TCNTER_UPDATES_AND_INIT)
 466:main.c        ****  #if(defined(_HEART_TCNTER_) && _HEART_TCNTER_)
 467:main.c        **** 	 tcnter_overflowUpdate();
 468:main.c        ****  #endif
 469:main.c        **** #endif
 470:main.c        **** 
 471:main.c        **** 	 if(!updateFrame)
 472:main.c        **** 		 return;
 473:main.c        **** 
 474:main.c        ****  //	static uint8_t frameCount = 0;
 475:main.c        **** 
 476:main.c        **** 	//Could insert a delay of sorts for scopability...
 477:main.c        **** 	// (otherwise there's not much guarantee that register-assignments
 478:main.c        **** 	//  later will align with the LVDS frame... though ALIGN should help)
 479:main.c        **** 	// see scopeHsync.c
 480:main.c        **** 
 481:main.c        **** 	//So here's the deal:
 482:main.c        **** 	// This handles a single row of pixel/timing data (Hblanks included)
 483:main.c        **** 	// lcd_update()             (from lcdStuff.c) 
 484:main.c        **** 	//  --> loadData()         (from lcdStuff.c)
 485:main.c        **** 	//        HSync
 486:main.c        **** 	//        H-Back-Porch
 487:main.c        **** 	//        --> drawPix()    (drawPix() may be here or elsewhere)
 488:main.c        **** 	//        (H-Front-Porch)
 489:main.c        **** 	//
 490:main.c        **** 	// drawPix is only called for drawn-rows (where DE is active, NOT for
 491:main.c        **** 	// Vblank rows)
 492:main.c        **** 	// H-Front-Porch is handled in the time between completion of this
 493:main.c        **** 	// interrupt and the next interrupt...
 494:main.c        **** 
 495:main.c        **** #endif // testing 91 vs 66.51-1
 496:main.c        **** 	 //a/o v66.51-64: lcdUpdate() was surrounded by heart set/cleared
 497:main.c        **** 	 // for 'scoping syncing... definitely revealed the problem. But easy
 498:main.c        **** 	 // enough to do that the code's not reimplemented here (set/clrpinPORT)
 499:main.c        **** 	int16_t rowNum = lcd_update();
 500:main.c        **** 
 501:main.c        **** 	if(rowNum == LCD_FRAMECOMPLETE)
 502:main.c        **** 	{
 503:main.c        **** 		frameCount++;
 504:main.c        **** 		//lcd_update() returns TRUE when the frame is complete
 505:main.c        **** 		// which can be used for whatever purposes 
 506:main.c        **** 		// (e.g. FRAME_COUNT_TO_DELAY)
 507:main.c        **** #if(!defined(V6651COMPARE) || !V6651COMPARE)
 508:main.c        **** 		endOfFrameHandler();
 509:main.c        **** #endif
 510:main.c        **** 	}
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 174


 511:main.c        **** 
 512:main.c        **** #if(!defined(V6651COMPARE) || !V6651COMPARE)
 513:main.c        **** #if(defined(PARTIAL_REFRESH) && PARTIAL_REFRESH)
 514:main.c        **** 	else if(rowNum >= (int16_t)stopRefreshAtRow)
 515:main.c        **** 	{
 516:main.c        **** 		lcd_init();
 517:main.c        **** 		frameCount++;
 518:main.c        **** 		endOfFrameHandler();
 519:main.c        **** 	}
 520:main.c        **** #endif
 521:main.c        **** #endif
 522:main.c        **** 
 523:main.c        ****  #if(defined(LOADROW) && LOADROW)
 524:main.c        **** 	//a/o v70: All the following notes are old, and should probably be
 525:main.c        **** 	//removed...
 526:main.c        **** 	//  Historically: lcd_update() handled calling loadRow
 527:main.c        **** 	//  That'd been removed, then readded, then removed
 528:main.c        **** 	//  as, somewhere inbetween it was moved here and forgotten
 529:main.c        **** 	//  This makes the most sense, as it's more project-specific
 530:main.c        **** 	//
 531:main.c        **** 	//Load the next row into the row(seg)buffer
 532:main.c        **** 	//data is enabled after T_VD+T_Vlow...
 533:main.c        **** 	//a/o v60: Rereading this is confusing...
 534:main.c        **** 	// Basically, there's no reason to call loadRow for display-lines
 535:main.c        **** 	// which don't display data (e.g. V-Sync)
 536:main.c        **** #warning "This test could probably be replaced with rowNum..."
 537:main.c        **** 
 538:main.c        **** 	if((hsyncCount >= T_VD+T_Vlow) && (hsyncCount < T_VD+T_Vlow+V_COUNT))
 539:main.c        **** 		loadRow(hsyncCount - (T_VD+T_Vlow));
 540:main.c        ****  #endif
 541:main.c        **** 	// a/o v60: This is a funny old note... I can't recall a time when
 542:main.c        **** 	// loadRow was written, then removed, then added again. Weird:
 543:main.c        **** 	// Here is where loadRow used to be called
 544:main.c        **** 	// it has been moved to oldNotes.txt, but it would make more sense
 545:main.c        **** 	// to look at LCDdirectLVDS <25 or LCDdirect
 546:main.c        **** 	// loadRow used the time between DE inactive and the next Hsync
 547:main.c        **** 	// to load a row to a row-buffer (as opposed to a frame-buffer)
 548:main.c        **** 	// thus, DE could gain more pixels because there would be fewer
 549:main.c        **** 	// calculations to determine the memory location to write from
 550:main.c        **** 	// This effect has since been minimized
 551:main.c        **** 	// BUT loadRow might be necessary for program-memory-based images...
 552:main.c        **** 
 553:main.c        **** 
 554:main.c        **** 	//THIS IS A HACK
 555:main.c        **** 	//tcnter_update();
 556:main.c        **** 
 557:main.c        ****  }
 558:main.c        **** #endif //!PWM_TESTING
 559:main.c        **** 
 560:main.c        **** 
 561:main.c        **** #if(defined(SEG_HFM) && SEG_HFM)
 562:main.c        **** 	#include "seg_hfm.c"
 563:main.c        **** #endif
 564:main.c        **** 
 565:main.c        **** #if(defined(SEG_QUESTION) && SEG_QUESTION)
 566:main.c        **** 	#include "seg_question.c"
 567:main.c        **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 175


 568:main.c        **** 
 569:main.c        **** #if(defined(SEG_SINE) && SEG_SINE)
 570:main.c        **** 	#include "seg_sine.c"
 571:main.c        **** #endif
 572:main.c        **** 
 573:main.c        **** #if(defined(LOADROW) && LOADROW)
 574:main.c        **** void loadRow(uint16_t rowNum)
 575:main.c        **** {
 576:main.c        **** 
 577:main.c        **** 
 578:main.c        **** #if(defined(ROW_SEG_BUFFER) && ROW_SEG_BUFFER)
 579:main.c        ****  #if (defined(SEG_RACER) && SEG_RACER)
 580:main.c        **** 	racer_loadRow(rowNum);
 581:main.c        ****  #elif (defined(SEG_HFM) && SEG_HFM)
 582:main.c        ****  	segHFM_loadRow(rowNum);
 583:main.c        ****  #elif (defined(SEG_QUESTION) && SEG_QUESTION)
 584:main.c        ****  	segQuestion_loadRow(rowNum);
 585:main.c        ****  #elif (defined(SEG_SINE) && SEG_SINE)
 586:main.c        ****  	segSine_loadRow(rowNum);
 587:main.c        ****  #elif (defined(SEG_LINE) && SEG_LINE)
 588:main.c        **** 	//Left here for an example...
 589:main.c        **** 	// Draws a diagonal line 
 590:main.c        **** 	//OLD NOTE:
 591:main.c        **** 	//syncing issues due to recursion overflowing the stack???
 592:main.c        **** 	// Apparently was
 593:main.c        **** 	   
 594:main.c        **** 	//Isn't BLAH = 1 necessary so we don't get a row with no data?
 595:main.c        **** 	// *looks* like it's working, but I dunno...
 596:main.c        **** 	#define BLAH 0
 597:main.c        **** 
 598:main.c        **** 	segClear();
 599:main.c        **** 	newSeg(3,0x06, (6<<4) | 3);									//W
 600:main.c        **** 	newSeg((rowNum&0xff) | BLAH, 0x06, (4<<4) | 0);				//R
 601:main.c        **** 	newSeg(1,0x06, (6<<4) | 3);									//W
 602:main.c        **** 	newSeg((255-(rowNum&0xff)) | BLAH, 0x06, (4<<4) | 0 );	//R
 603:main.c        **** 	newSeg(3,0x06, (6<<4) | 3);									//W
 604:main.c        **** 	segTerminate();
 605:main.c        **** 
 606:main.c        ****  #elif (defined(SEG_TET) && SEG_TET)
 607:main.c        **** 	//This isn't particularly functional, anymore
 608:main.c        **** 	// it used to be an intermediate stage between rowBuffer and 
 609:main.c        **** 	//  rowSegBuffer... Left here for an example of how it could be done...
 610:main.c        **** 	//ACTUALLY, a/o v60ish it has been reinstated...
 611:main.c        **** 	// and, in fact, a/o v62, this may become a great early-test for new
 612:main.c        **** 	// displays, as the necessary resolution is low, which would allow for
 613:main.c        **** 	// higher refresh-rates (which some displays may need)
 614:main.c        **** 	// (There are certainly other ways to make things more suitable for new
 615:main.c        **** 	// displays... these'll be explored in later code-revisions, probably)
 616:main.c        **** 
 617:main.c        ****   //SEG_STRETCH is the number of PSEGS that each row-buffer pixel is
 618:main.c        ****   //stretched-across. In this case (SEG_TET) (or any case where *only* the
 619:main.c        ****   //rowbuffer is used to fill the screen), the value of SEG_STRETCH should
 620:main.c        ****   //probably be varied dependent on NUM_PSEGS (which should be dependent on
 621:main.c        ****   //LVDS_PRESCALER and a few other factors) in order to stretch the
 622:main.c        ****   //row-buffer acreoss the entire screen. But I think most of these things
 623:main.c        ****   //are so-far hard-coded...
 624:main.c        ****   // Further, it's entirely possible (in a not-implemented-here case) to
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 176


 625:main.c        ****   // have the row-buffer occupy only a certain portion of the screen and
 626:main.c        ****   // modify the remaining psegs directly via other means... (I had this
 627:main.c        ****   // once, when displaying Tetris, Life, and a few others on the same
 628:main.c        ****   // screen, I think, right?)
 629:main.c        ****   //Anyhow, a/o a while back, SEG_TET is the only case using SEG_STRETCH 
 630:main.c        **** //  #if(!defined(SEG_STRETCH))
 631:main.c        **** // And a/o v62 Trying to bump the frame-rate up so the ChiMei display will
 632:main.c        **** // work, using LVDS_PRESCALER, this might help... again hardcoded where
 633:main.c        **** // ideally the thing would calculate itself... Though it's also handy to
 634:main.c        **** // have it hard-coded as it allows for testing the display's immunity (or
 635:main.c        **** // lack thereof) for long/short DEs
 636:main.c        **** #if(LVDS_PRESCALER == 1)
 637:main.c        ****  #define SEG_STRETCH 1
 638:main.c        **** #else
 639:main.c        ****  #define SEG_STRETCH 5 //(((NUM_PSEGS-6)+RB_WIDTH-1)/RB_WIDTH)
 640:main.c        **** #endif
 641:main.c        **** 	//3-5 = white + cyan
 642:main.c        **** 	//6 = letters alternating with above
 643:main.c        **** 	//7-9 = ditto, stretched
 644:main.c        **** 
 645:main.c        **** #define TET_VSTRETCH	16
 646:main.c        **** 	if(rowNum == 0)
 647:main.c        **** 	{
 648:main.c        **** 		//Probably not best to put this here, as we're still in the interrupt
 649:main.c        **** 		// extra-long calculations might cause syncing issues with displays
 650:main.c        **** 		// that require rows to be a constant time
 651:main.c        **** 		tetUpdate();
 652:main.c        **** 	}
 653:main.c        **** 	if(rowNum % TET_VSTRETCH == 0)
 654:main.c        **** 	{
 655:main.c        **** 		uint8_t i;
 656:main.c        **** 		for(i=0; i<RB_WIDTH; i++)
 657:main.c        **** 			rowBuffer[i] = fb_to_rb(_K);
 658:main.c        **** 		//	rowBuffer[i] = fb_to_rb((i+rowNum/TET_VSTRETCH)&0x3f);
 659:main.c        **** 		
 660:main.c        **** 		tet_drawRow(rowNum/TET_VSTRETCH, rowBuffer);
 661:main.c        **** 	}
 662:main.c        **** 	segClear();
 663:main.c        **** 
 664:main.c        **** 	//Good for syncing to have white on both borders...
 665:main.c        **** 	newSeg(3, 0x06, (6<<4) | 3);
 666:main.c        **** 	
 667:main.c        **** 	uint16_t i;
 668:main.c        **** 	//TET_OVERLAY alternates rows between the TETRIS board and
 669:main.c        **** 	// an rgb "gradient" The only purpose is to test the idea of
 670:main.c        **** 	// using the high vertical-resolution to essentially increase the
 671:main.c        **** 	// number of colors available to a low-resolution image
 672:main.c        **** 	// sort of like "dithering" in the ol' days of 256 colors in Windows
 673:main.c        **** 	// but easy to implement in this case with very little overhead 
 674:main.c        **** 	// row-by-row
 675:main.c        **** 	// The effect, from a ways back, looks like the colors are blended
 676:main.c        **** 	// (like the Text and Game-board are translucent)
 677:main.c        **** #define TET_OVERLAY TRUE
 678:main.c        **** 
 679:main.c        **** 	//TET_GRADIENT takes that a step further and attempts to create a
 680:main.c        **** 	// gradient between each color in that rgb-gradient.
 681:main.c        **** 	// It's not as pretty as I'd hoped... though it makes sense...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 177


 682:main.c        **** 	// first we're alternating between TET's color and the background color
 683:main.c        **** 	// then the background color is (roughly) alternating between a couple
 684:main.c        **** 	// colors, several rows between...
 685:main.c        **** 	// so if a color is stretched 16 rows vertically, that only leaves 8
 686:main.c        **** 	// rows for the color-gradient... might work better over more gradual
 687:main.c        **** 	// color-changes
 688:main.c        **** #define TET_GRADIENT TRUE
 689:main.c        **** 
 690:main.c        **** #if (defined(TET_OVERLAY) && TET_OVERLAY)
 691:main.c        **** 	if(rowNum & 0x01)
 692:main.c        **** 	{
 693:main.c        **** #endif
 694:main.c        **** 	for(i=0; i<RB_WIDTH; i++)
 695:main.c        **** 	{
 696:main.c        **** 		//i+1 because we don't want to overwrite the white border...
 697:main.c        **** 		rbpix_to_seg(rowBuffer[i], i+1, SEG_STRETCH);
 698:main.c        **** 	}
 699:main.c        **** 
 700:main.c        **** #if (defined(TET_OVERLAY) && TET_OVERLAY)
 701:main.c        **** 	}
 702:main.c        **** 	else
 703:main.c        **** 	{
 704:main.c        **** 		#define ROWS_PER 64//(V_COUNT/NUM_COLORS)
 705:main.c        **** 
 706:main.c        **** 		uint8_t fbColor;
 707:main.c        **** 
 708:main.c        **** #if (defined(TET_GRADIENT) && TET_GRADIENT)
 709:main.c        **** 		static hfm_t hfmGradient;
 710:main.c        **** 		if(rowNum%ROWS_PER == 0)
 711:main.c        **** 			hfm_setup(&hfmGradient, 0, ROWS_PER/2-4);
 712:main.c        **** 
 713:main.c        **** 		//It's worth it to experiment with changing the range of the 
 714:main.c        **** 		// hfmGradient, ('-4' above and '+4' below).
 715:main.c        **** 		// to try to avoid one or two stray spikes
 716:main.c        **** 		// (e.g. power = 1, maxPower = 15, there'll be one bright row
 717:main.c        **** 		//  and 14 dark, it sticks out like a sore-thumb)
 718:main.c        **** 		//  These values are experimental, and entirely dependent on the
 719:main.c        **** 		//  values used...
 720:main.c        **** 
 721:main.c        **** 		hfm_setPower(&hfmGradient, (rowNum/2)%(ROWS_PER/2)+4);
 722:main.c        **** 
 723:main.c        **** 		if(hfm_nextOutput(&hfmGradient))
 724:main.c        **** 			fbColor = rgbGradient(ROWS_PER-1 - rowNum/(ROWS_PER)+16-1);
 725:main.c        **** 		else
 726:main.c        **** #endif	//TET_GRADIENT
 727:main.c        **** 			fbColor = rgbGradient(ROWS_PER-1 - rowNum/(ROWS_PER)+16);
 728:main.c        **** 
 729:main.c        **** 		addSegfb(RB_WIDTH*SEG_STRETCH, (fbColor));
 730:main.c        **** 		//newSeg(SEG_STRETCH, fb_to_seg((rowNum*64/768)&0x3f));
 731:main.c        **** 
 732:main.c        **** 	}
 733:main.c        **** #endif	//TET_OVERLAY
 734:main.c        **** 	//white...
 735:main.c        **** 	newSeg(3, 0x06, (6<<4) | 3);
 736:main.c        **** 	segTerminate();
 737:main.c        ****  #elif (defined(SEG_GRADIENT) && SEG_GRADIENT)
 738:main.c        **** 	static hfm_t hfmGradient;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 178


 739:main.c        **** #define ROWS_PER	(255)	//(V_COUNT/3) == 256
 740:main.c        **** 
 741:main.c        **** 	if(rowNum%ROWS_PER == 0)
 742:main.c        **** 		hfm_setup(&hfmGradient, 0, ROWS_PER);
 743:main.c        **** 
 744:main.c        **** 	uint8_t color;
 745:main.c        **** 
 746:main.c        **** 	uint16_t power;
 747:main.c        **** 
 748:main.c        **** 	if(rowNum < ROWS_PER/16)
 749:main.c        **** 		rowNum = 0;
 750:main.c        **** 	else
 751:main.c        **** 		rowNum -= ROWS_PER/16;
 752:main.c        **** 
 753:main.c        **** 	//Since there are four shades, there will be three gradients...
 754:main.c        **** 	if(rowNum < ROWS_PER)
 755:main.c        **** 	{
 756:main.c        **** 		//The ROWS_PER/16 stuff is to help alleviate sharp color-spikes
 757:main.c        **** 		// which occur early-on... see the explanation in SEG_TET.
 758:main.c        **** 		color = 0;
 759:main.c        **** 		//hfm_setPower(&hfmGradient, 
 760:main.c        **** 		power = (rowNum); // + ROWS_PER/16);
 761:main.c        **** 	}
 762:main.c        **** 	else if(rowNum < ROWS_PER*2)
 763:main.c        **** 	{
 764:main.c        **** 		color = 1;
 765:main.c        **** 		//hfm_setPower(&hfmGradient, 
 766:main.c        **** 		power = rowNum-(ROWS_PER); // + ROWS_PER/16;
 767:main.c        **** 	}
 768:main.c        **** 	else
 769:main.c        **** 	{
 770:main.c        **** 		color = 2;
 771:main.c        **** 		//hfm_setPower(&hfmGradient, 
 772:main.c        **** 		power = rowNum-(ROWS_PER*2); // + ROWS_PER/16;
 773:main.c        **** 	}
 774:main.c        **** 
 775:main.c        **** 
 776:main.c        **** 	if(power < ROWS_PER/16)
 777:main.c        **** 		power = 0;
 778:main.c        **** 
 779:main.c        **** 	hfm_setPower(&hfmGradient, (power <= 255) ? power : 255);
 780:main.c        **** 
 781:main.c        **** 	if(hfm_nextOutput(&hfmGradient))
 782:main.c        **** 		color++;
 783:main.c        **** 
 784:main.c        **** 	color |= color<<2 | color<<4;
 785:main.c        **** 
 786:main.c        **** 	segClear();
 787:main.c        **** 	addSegfb(3, _W);
 788:main.c        **** 	addSegfb(NUM_PSEGS-6, color); 
 789:main.c        **** 	addSegfb(3, _W);
 790:main.c        **** 	segTerminate();
 791:main.c        ****  #elif(defined(SEG_GRADIENT2) && SEG_GRADIENT2)
 792:main.c        ****    #error "Heh, never did implement this..."
 793:main.c        ****  #else
 794:main.c        **** 	#error "Gotta select a SEG_... option, or create your own"
 795:main.c        ****  #endif //SEG_ selection
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 179


 796:main.c        **** #elif (defined(ROW_BUFFER) && (ROW_BUFFER))
 797:main.c        **** 
 798:main.c        **** //This is a *really* simple test for ROW_BUFFER
 799:main.c        **** // It just cycles through the colors in diagonal stripes...
 800:main.c        **** // Technically each color should be 16 pixels high, but it appears to be
 801:main.c        **** // coming through much taller. Certainly this is display-specific
 802:main.c        **** // timing-related issues... (This display is known to repeat rows when not
 803:main.c        **** // syncing correctly)
 804:main.c        **** // First-guess is ROW_CALCULATION_CYCS isn't right, but higher values is
 805:main.c        **** // causing syncing problems.
 806:main.c        **** // TODO, I guess.
 807:main.c        **** 	uint16_t col;
 808:main.c        **** 	for(col=0; col<RB_WIDTH; col++)
 809:main.c        **** 		rowBuffer[col] = fb_to_rb((col+rowNum)&0x3f);
 810:main.c        **** 		//rowBuffer[col] = fb_to_rb((col+rowNum/16)&0x3f);
 811:main.c        **** 
 812:main.c        **** #endif //ROW_SEG_BUFFER
 813:main.c        **** }
 814:main.c        **** #endif //LOAD_ROW
 815:main.c        **** 
 816:main.c        **** #include "hsyncTimerStuff.c"
 817:main.c        **** 
 818:main.c        **** 
 819:main.c        **** #if (!defined(EXTERNAL_DRAWPIX) || !EXTERNAL_DRAWPIX)
 820:main.c        **** #if (defined(ROW_SEG_BUFFER) && ROW_SEG_BUFFER)
 821:main.c        **** DP_INLINEABLE void drawPix(uint16_t rowNum)
 822:main.c        **** {
 823:main.c        **** 	//Note that rowNum isn't really used here...
 824:main.c        **** 	// and it's only a uint8_t!
 825:main.c        **** 	rsb_drawPix(rowNum);
 826:main.c        **** }
 827:main.c        **** 
 828:main.c        **** #elif (defined(BLUE_ADC) && BLUE_ADC)
 829:main.c        **** //This is pretty much identical to most of the BLUE_TESTING in lcdStuff.c
 830:main.c        **** // with a slight twist...
 831:main.c        **** DP_INLINEABLE void drawPix(uint16_t rowNum)
 832:main.c        **** {
 833:main.c        ****       //uint16_t blueCyc = DOTS_TO_CYC(rowNum);
 834:main.c        ****       //uint16_t notBlueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS)-blueCyc;
 835:main.c        **** 		adc_startConversion();
 836:main.c        **** 		while(adc_isBusy())
 837:main.c        **** 			asm("nop;");
 838:main.c        **** 
 839:main.c        ****       uint16_t blueDots = adc_getValue();
 840:main.c        ****       uint16_t notBlueDots = DE_ACTIVE_DOTS - blueDots;
 841:main.c        **** 
 842:main.c        ****       DEonly_fromNada();
 843:main.c        ****       //delay_cyc(notBlueCyc);
 844:main.c        ****       //delay_Dots(notBlueDots);
 845:main.c        ****       DE_DotDelay(notBlueDots);
 846:main.c        ****       DEblue_fromDEonly();
 847:main.c        ****       //delay_cyc(blueCyc);
 848:main.c        ****       //delay_Dots(blueDots);
 849:main.c        ****       DE_DotDelay(blueDots);
 850:main.c        ****       Nada_fromDEblue();
 851:main.c        **** }
 852:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 180


 853:main.c        **** #elif (defined(BLUE_AND_COLORS) && BLUE_AND_COLORS)
 854:main.c        **** // This draws four colors on the screen, black, red, blue, and cyan
 855:main.c        **** // in order to test the other colors (red and green)
 856:main.c        **** DP_INLINEABLE void drawPix(uint16_t rowNum)
 857:main.c        **** {
 858:main.c        **** 	//DE_ACTIVE_DELAYABLE attempts to take into account the overhead of
 859:main.c        **** 	//DE_DotDelay, setColors(), etc...
 860:main.c        **** 	//It's entirely arbitrary, and dependent on CPU speed (PLL_SYSCLK)
 861:main.c        **** 	// and many other factors...
 862:main.c        **** #if(defined(PLL_SYSCLK) && PLL_SYSCLK)
 863:main.c        ****  #define DE_ACTIVE_DELAYABLE	(DE_ACTIVE_DOTS-100)
 864:main.c        **** 		//Attempting to stretch the diagonal from corner-to-corner...
 865:main.c        **** 		uint16_t blueDots = (uint32_t)DE_ACTIVE_DELAYABLE * (uint32_t)rowNum
 866:main.c        **** 		  										/ V_COUNT;
 867:main.c        **** #else
 868:main.c        **** 		//Because, I guess, the math is too long without PLL_SYSCLK
 869:main.c        **** 		// since it's not syncing
 870:main.c        ****  #define DE_ACTIVE_DELAYABLE	(DE_ACTIVE_DOTS-200)
 871:main.c        **** 		uint16_t blueDots = rowNum;
 872:main.c        **** #endif
 873:main.c        **** 		uint16_t notBlueDots = DE_ACTIVE_DELAYABLE - blueDots;
 874:main.c        **** 
 875:main.c        **** 		uint16_t halfNotBlueDots = notBlueDots/2;
 876:main.c        **** 
 877:main.c        **** 		uint16_t halfBlueDots = blueDots/2;
 878:main.c        **** 
 879:main.c        **** 
 880:main.c        **** 		//fullRed(), noRed(), fullGreen(), and noGreen()
 881:main.c        **** 		// function differently than the DEblue...() functions.
 882:main.c        **** 		// Since "blue" is shared with the timing-signals,
 883:main.c        **** 		// changing a blue-value requires keeping in mind the previous and
 884:main.c        **** 		// next states of the timing (usually DE-active in all cases, but not
 885:main.c        **** 		// always).
 886:main.c        **** 		// Changing of the "red" and "green" signals is easier, since
 887:main.c        **** 		// doing-so doesn't affect anything else.
 888:main.c        **** 
 889:main.c        **** 		DEonly_fromNada();
 890:main.c        **** 
 891:main.c        **** 		//Black
 892:main.c        **** 		DE_DotDelay(halfNotBlueDots);
 893:main.c        **** 		
 894:main.c        **** 		//Red
 895:main.c        **** 		fullRed();
 896:main.c        **** 		DE_DotDelay(halfNotBlueDots);
 897:main.c        **** 
 898:main.c        **** 		//Blue
 899:main.c        **** 		noRed();
 900:main.c        **** 		DEblue_fromDEonly();
 901:main.c        **** 		
 902:main.c        **** 		DE_DotDelay(halfBlueDots);
 903:main.c        **** 
 904:main.c        **** 		//Cyan
 905:main.c        **** 		fullGreen();
 906:main.c        **** 		
 907:main.c        **** 		DE_DotDelay(halfBlueDots);
 908:main.c        **** 
 909:main.c        **** 		noGreen();
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 181


 910:main.c        **** 		Nada_fromDEblue();
 911:main.c        **** }
 912:main.c        **** #elif (defined(BLUE_ALLSHADES) && BLUE_ALLSHADES)
 913:main.c        **** //This is an attempt at showing all available shades of blue
 914:main.c        **** // Originally it was determined that 11 shades could be shown
 915:main.c        **** // but there seems to be some trouble with using wrap-around values
 916:main.c        **** // (e.g. when reset occurs before set in the count)
 917:main.c        **** // It works fine when it's the *only* shade shown, but if shown with other
 918:main.c        **** // shades on the screen, it causes syncing problems
 919:main.c        **** // So, it's been determined that there are basically four discernable
 920:main.c        **** // shades of blue which are usable with the PWM161
 921:main.c        **** //
 922:main.c        **** // The original idea: BLUE_ALLSHADES=TRUE, ALLSHADES_GRADIENT=FALSE
 923:main.c        **** //  would fade the screen from black to bright blue
 924:main.c        **** //  (it makes use of the wraparound-values)
 925:main.c        **** // Then ALLSHADES_GRADIENT would display them all on the screen at once
 926:main.c        **** // 
 927:main.c        **** // It's since been somewhat hacked, to disable the unstable wrap-around
 928:main.c        **** // values...
 929:main.c        **** // Then ALLSHADES_AND_COLORS was added, to show all usable colors
 930:main.c        **** // This's gotten a bit bloated, and would probably be better-implemented as
 931:main.c        **** // several different BLUE_WHATEVERs
 932:main.c        **** DP_INLINEABLE void drawPix(uint16_t rowNum)
 933:main.c        **** {
 934:main.c        **** #define BLUESHADES_MAX 11
 935:main.c        **** 		
 936:main.c        **** #if(!defined(ALLSHADES_GRADIENT) || !ALLSHADES_GRADIENT)
 937:main.c        ****  #define DOTSPERSHADE (DE_ACTIVE_DOTS) ///BLUESHADES_MAX)
 938:main.c        **** 		static uint8_t frameCount = 0;
 939:main.c        **** 		static uint8_t shadeNum = 0;
 940:main.c        **** 
 941:main.c        **** 		if(rowNum == 0)
 942:main.c        **** 			frameCount++;
 943:main.c        **** 
 944:main.c        **** 		if(frameCount == 60)
 945:main.c        **** 		{
 946:main.c        **** 			frameCount = 0;
 947:main.c        **** 			shadeNum++;
 948:main.c        **** 			if(shadeNum >= BLUESHADES_MAX)
 949:main.c        **** 				shadeNum = 0;
 950:main.c        **** 		}
 951:main.c        **** #else
 952:main.c        ****  #if(defined(ALLSHADES_AND_COLORS) && ALLSHADES_AND_COLORS)
 953:main.c        **** 		setRed4(4*rowNum/V_COUNT);
 954:main.c        **** 		setGreen4((16*rowNum/V_COUNT)%4);
 955:main.c        **** 		/*
 956:main.c        **** 		//K, R, G, Y
 957:main.c        **** 		if(rowNum < V_COUNT/4)
 958:main.c        **** 		{
 959:main.c        **** 			noRed();
 960:main.c        **** 			noGreen();
 961:main.c        **** 		}
 962:main.c        **** 		else if(rowNum < 2*V_COUNT/4)
 963:main.c        **** 		{
 964:main.c        **** 			fullRed();
 965:main.c        **** 			noGreen();
 966:main.c        **** 		}
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 182


 967:main.c        **** 		else if(rowNum < 3*V_COUNT/4)
 968:main.c        **** 		{
 969:main.c        **** 			fullGreen();
 970:main.c        **** 			noRed();
 971:main.c        **** 		}
 972:main.c        **** 		else
 973:main.c        **** 		{
 974:main.c        **** 			fullGreen();
 975:main.c        **** 			fullRed();
 976:main.c        **** 		}
 977:main.c        **** 		*/
 978:main.c        ****  #endif
 979:main.c        ****  //Add a little bit of extra delay for calculations...
 980:main.c        ****  #define START_SHADE 0//10 //5 //10
 981:main.c        ****  #define END_SHADE   10//0 //7 //10 //0
 982:main.c        **** 
 983:main.c        ****  #define SHADE_DIR_SIGN ((END_SHADE > START_SHADE) ? +1 : -1)
 984:main.c        ****  #define NUM_SHADES  (((SHADE_DIR_SIGN > 0) ? (END_SHADE-START_SHADE) \
 985:main.c        **** 			 :(START_SHADE-END_SHADE))+1)
 986:main.c        **** 
 987:main.c        **** // Weird... with +0, syncing is way-off (such that the red/green doesn't
 988:main.c        **** // come through *at all*
 989:main.c        **** // and so-forth.
 990:main.c        ****  #define DOTSPERSHADE (DE_ACTIVE_DOTS/(NUM_SHADES+15))
 991:main.c        **** 		int8_t shadeNum;
 992:main.c        **** 
 993:main.c        **** 		DEonly_init();
 994:main.c        **** 
 995:main.c        **** 		for(shadeNum=START_SHADE; shadeNum != (END_SHADE+SHADE_DIR_SIGN);
 996:main.c        **** 				shadeNum+=SHADE_DIR_SIGN)
 997:main.c        **** 		{
 998:main.c        **** 
 999:main.c        **** #endif
1000:main.c        **** 		uint8_t ocr2sa_val;
1001:main.c        **** 		uint8_t ocr2ra_val;
1002:main.c        **** 
1003:main.c        **** 		//Black
1004:main.c        **** //		DE_DotDelay(DOTSPERSHADE);
1005:main.c        **** 
1006:main.c        **** 		//The commented-out cases are those that require wrapping
1007:main.c        **** 		// (e.g. "set" occurs *after* "reset")
1008:main.c        **** 		// They don't seem to work too well, when switching back and forth
1009:main.c        **** /*		switch(shadeNum)
1010:main.c        **** 		{
1011:main.c        **** 			//Black	//these're from DEonly_init();
1012:main.c        **** 			case 0:
1013:main.c        **** 				ocr2sa_val = 1;
1014:main.c        **** 				ocr2ra_val = 4;
1015:main.c        **** 				break;
1016:main.c        **** 			case 1:
1017:main.c        **** 				//4:
1018:main.c        **** 				ocr2sa_val = 0;
1019:main.c        **** 				ocr2ra_val = 4;	
1020:main.c        **** 				break;
1021:main.c        **** //			case 2:
1022:main.c        **** //				//12:
1023:main.c        **** //				ocr2sa_val = 6;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 183


1024:main.c        **** //				ocr2ra_val = 4;	
1025:main.c        **** //				break;
1026:main.c        **** //			case 3:
1027:main.c        **** //				//28:
1028:main.c        **** //				ocr2sa_val = 5;
1029:main.c        **** //				ocr2ra_val = 4;	
1030:main.c        **** //				break;
1031:main.c        **** 			case 2:
1032:main.c        **** 				//32:
1033:main.c        **** 				ocr2sa_val = 1;
1034:main.c        **** 				ocr2ra_val = 5;	
1035:main.c        **** 				break;
1036:main.c        **** 			case 3:
1037:main.c        **** 				//36:
1038:main.c        **** 				ocr2sa_val = 0;
1039:main.c        **** 				ocr2ra_val = 5;	
1040:main.c        **** 				break;
1041:main.c        **** //			case 6:
1042:main.c        **** //				//44:
1043:main.c        **** //				ocr2sa_val = 6;
1044:main.c        **** //				ocr2ra_val = 5;	
1045:main.c        **** //				break;
1046:main.c        **** 			case 4:
1047:main.c        **** 				//48:
1048:main.c        **** 				ocr2sa_val = 1;
1049:main.c        **** 				ocr2ra_val = 6;	
1050:main.c        **** 				break;
1051:main.c        **** 			case 5:
1052:main.c        **** 				//52:
1053:main.c        **** 				ocr2sa_val = 0;
1054:main.c        **** 				ocr2ra_val = 6;	
1055:main.c        **** 				break;
1056:main.c        **** //			case 9:
1057:main.c        **** //				//56:
1058:main.c        **** //				ocr2sa_val = 1;
1059:main.c        **** //				ocr2ra_val = 0;	
1060:main.c        **** //				break;
1061:main.c        **** 			default:
1062:main.c        **** 				//60:
1063:main.c        **** 				ocr2sa_val = 0;
1064:main.c        **** 				ocr2ra_val = 8;	//7 dun woik... all-low
1065:main.c        **** 				break;
1066:main.c        **** 		}
1067:main.c        **** 
1068:main.c        **** 		//DEonly_fromNada();
1069:main.c        **** 	
1070:main.c        **** 		//setbit(PLOCK2, PCNF2);
1071:main.c        **** 
1072:main.c        **** 		lockPSC2();
1073:main.c        **** 		OCR2SAL = ocr2sa_val;
1074:main.c        **** 		OCR2RAL = ocr2ra_val;
1075:main.c        **** 		unlockPSC2();
1076:main.c        **** 		//clrbit(PLOCK2, PCNF2);
1077:main.c        **** */
1078:main.c        **** 		uint8_t newShade = shadeNum; //rowNum*64/V_COUNT) % NUM_SHADES;
1079:main.c        **** 
1080:main.c        **** 		if(newShade <= 3)			//0, 1, 2, 3
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 184


1081:main.c        **** 			newShade = newShade;
1082:main.c        **** 		else if(newShade <= 6)   //4->2, 5->1, 6->0
1083:main.c        **** 			newShade = (6-newShade);
1084:main.c        **** 		else
1085:main.c        **** 			newShade = 3;
1086:main.c        **** 
1087:main.c        **** 		setBlue4(newShade);
1088:main.c        **** 
1089:main.c        **** 		DE_DotDelay(DOTSPERSHADE);
1090:main.c        **** 
1091:main.c        **** #if(defined(ALLSHADES_GRADIENT) && ALLSHADES_GRADIENT)
1092:main.c        **** 		}
1093:main.c        ****  #if(defined(ALLSHADES_AND_COLORS) && ALLSHADES_AND_COLORS)
1094:main.c        **** 		setRed4(0); //4*rowNum/V_COUNT);
1095:main.c        **** 		setGreen4(0); //(16*rowNum/V_COUNT)%4);
1096:main.c        ****  #endif
1097:main.c        **** #endif
1098:main.c        **** 		Nada_init(); //fromDEblue();
1099:main.c        **** }
1100:main.c        **** 
1101:main.c        **** #elif (defined(PWM_TESTING) && PWM_TESTING)
1102:main.c        **** 	//No drawPix necessary...
1103:main.c        **** 
1104:main.c        **** #else
1105:main.c        **** #if 0
1106:main.c        **** #define drawPix nonRSB_drawPix
1107:main.c        **** #else
1108:main.c        **** //#include "_options/writeColor.c"
1109:main.c        **** //#include "nonRSB_drawPix.c"
1110:main.c        **** DP_INLINEABLE void drawPix(uint16_t rowNum)
1111:main.c        **** {
1112:main.c        **** 	//a/o v70, it's in use again for ROW_BUFFER.
1113:main.c        **** 	//a/o v67, this is used by FRAMEBUFFER_TESTING...
1114:main.c        **** 	//Old:
1115:main.c        **** 	//This hasn't been used in quite some time... 
1116:main.c        **** 	// it may not work at all anymore.
1117:main.c        **** 	nonRSB_drawPix(rowNum);
 3077               		.stabn	68,0,1117,.LM364-.LFBB26
 3078               	.LM364:
 3079 0b66 00D0      		rcall nonRSB_drawPix
 3080               	.L217:
 3081               	.LBE150:
 3082               	.LBE149:
 3083               	.LBE136:
 3084               	.LBE135:
 3085               		.stabs	"_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c",132,0,0,.Ltext33
 3086               	.Ltext33:
1382:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 3087               		.stabn	68,0,1382,.LM365-.LFBB26
 3088               	.LM365:
 3089 0b68 2091 0000 		lds r18,hsyncCount
 3090 0b6c 3091 0000 		lds r19,hsyncCount+1
 3091 0b70 2F5F      		subi r18,-1
 3092 0b72 3F4F      		sbci r19,-1
 3093 0b74 3093 0000 		sts hsyncCount+1,r19
 3094 0b78 2093 0000 		sts hsyncCount,r18
1384:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	{
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 185


 3095               		.stabn	68,0,1384,.LM366-.LFBB26
 3096               	.LM366:
 3097 0b7c 2091 0000 		lds r18,hsyncCount
 3098 0b80 3091 0000 		lds r19,hsyncCount+1
 3099 0b84 2332      		cpi r18,35
 3100 0b86 3105      		cpc r19,__zero_reg__
 3101 0b88 01F0      		breq .L219
 3102 0b8a 00F4      		brsh .L220
 3103 0b8c 2330      		cpi r18,3
 3104 0b8e 3105      		cpc r19,__zero_reg__
 3105 0b90 01F4      		brne .L218
1390:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			//clrpinPORT(VSYNC_PIN, VSYNC_PORT);
 3106               		.stabn	68,0,1390,.LM367-.LFBB26
 3107               	.LM367:
 3108 0b92 1092 0000 		sts dataEnable,__zero_reg__
1392:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			Vsync_fromNada();
 3109               		.stabn	68,0,1392,.LM368-.LFBB26
 3110               	.LM368:
 3111 0b96 81E0      		ldi r24,lo8(1)
 3112 0b98 8093 0000 		sts vSync,r24
1393:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			break;
 3113               		.stabn	68,0,1393,.LM369-.LFBB26
 3114               	.LM369:
 3115 0b9c 80E4      		ldi r24,lo8(64)
 3116 0b9e 84BD      		out 0x24,r24
 3117 0ba0 85E0      		ldi r24,lo8(5)
 3118 0ba2 00C0      		rjmp .L228
 3119               	.L220:
1384:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 	{
 3120               		.stabn	68,0,1384,.LM370-.LFBB26
 3121               	.LM370:
 3122 0ba4 2632      		cpi r18,38
 3123 0ba6 3105      		cpc r19,__zero_reg__
 3124 0ba8 01F0      		breq .L222
 3125 0baa 2632      		cpi r18,38
 3126 0bac 3340      		sbci r19,3
 3127 0bae 01F4      		brne .L218
1412:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//	break;
 3128               		.stabn	68,0,1412,.LM371-.LFBB26
 3129               	.LM371:
 3130 0bb0 1092 0000 		sts dataEnable,__zero_reg__
1417:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** #if 0 //(FRAME_COUNT_TO_DELAY != 0)
 3131               		.stabn	68,0,1417,.LM372-.LFBB26
 3132               	.LM372:
 3133 0bb4 1092 0000 		sts hsyncCount+1,__zero_reg__
 3134 0bb8 1092 0000 		sts hsyncCount,__zero_reg__
1432:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			break;
 3135               		.stabn	68,0,1432,.LM373-.LFBB26
 3136               	.LM373:
 3137 0bbc DFEF      		ldi r29,lo8(-1)
 3138 0bbe CFE7      		ldi r28,lo8(127)
1433:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		default:
 3139               		.stabn	68,0,1433,.LM374-.LFBB26
 3140               	.LM374:
 3141 0bc0 00C0      		rjmp .L218
 3142               	.L219:
1402:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			Nada_fromVsync();
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 186


 3143               		.stabn	68,0,1402,.LM375-.LFBB26
 3144               	.LM375:
 3145 0bc2 1092 0000 		sts vSync,__zero_reg__
1403:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			break;
 3146               		.stabn	68,0,1403,.LM376-.LFBB26
 3147               	.LM376:
 3148 0bc6 80E3      		ldi r24,lo8(48)
 3149 0bc8 84BD      		out 0x24,r24
 3150 0bca 84E0      		ldi r24,lo8(4)
 3151               	.L228:
 3152 0bcc 8DBD      		out 0x2d,r24
1404:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 		//Start of frame (DE active)
 3153               		.stabn	68,0,1404,.LM377-.LFBB26
 3154               	.LM377:
 3155 0bce 00C0      		rjmp .L218
 3156               	.L222:
1407:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 			break;
 3157               		.stabn	68,0,1407,.LM378-.LFBB26
 3158               	.LM378:
 3159 0bd0 81E0      		ldi r24,lo8(1)
 3160 0bd2 8093 0000 		sts dataEnable,r24
 3161               	.L218:
1463:_commonCode_localized/lcdStuff/0.80ncfDD6651/lcdStuff.c **** 
 3162               		.stabn	68,0,1463,.LM379-.LFBB26
 3163               	.LM379:
 3164 0bd6 8D2F      		mov r24,r29
 3165 0bd8 9C2F      		mov r25,r28
 3166               	/* epilogue start */
 3167 0bda DF91      		pop r29
 3168 0bdc CF91      		pop r28
 3169 0bde 0895      		ret
 3170               		.size	lcd_update, .-lcd_update
 3171               	.Lscope26:
 3172               		.stabs	"",36,0,0,.Lscope26-.LFBB26
 3173               		.stabd	78,0,0
 3174               		.stabs	"restartFrameUpdate:F(0,47)",36,0,425,restartFrameUpdate
 3175               	.global	restartFrameUpdate
 3176               		.type	restartFrameUpdate, @function
 3177               	restartFrameUpdate:
 3178               		.stabd	46,0,0
 3179               		.stabs	"main.c",132,0,0,.Ltext34
 3180               	.Ltext34:
 426:main.c        **** 	updateFrame = FB_REFRESH_ON_CHANGE_COUNT;
 3181               		.stabn	68,0,426,.LM380-.LFBB27
 3182               	.LM380:
 3183               	.LFBB27:
 3184               	/* prologue: function */
 3185               	/* frame size = 0 */
 3186               	/* stack size = 0 */
 3187               	.L__stack_usage = 0
 427:main.c        **** 
 3188               		.stabn	68,0,427,.LM381-.LFBB27
 3189               	.LM381:
 3190 0be0 82E0      		ldi r24,lo8(2)
 3191 0be2 8093 0000 		sts updateFrame,r24
 3192 0be6 0895      		ret
 3193               		.size	restartFrameUpdate, .-restartFrameUpdate
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 187


 3194               	.Lscope27:
 3195               		.stabs	"",36,0,0,.Lscope27-.LFBB27
 3196               		.stabd	78,0,0
 3197               		.stabs	"__vector_14:F(0,47)",36,0,441,__vector_14
 3198               	.global	__vector_14
 3199               		.type	__vector_14, @function
 3200               	__vector_14:
 3201               		.stabd	46,0,0
 442:main.c        **** 	 //This was an *early* test to compare functionality between v91 and
 3202               		.stabn	68,0,442,.LM382-.LFBB28
 3203               	.LM382:
 3204               	.LFBB28:
 3205 0be8 1F92      		push r1
 3206 0bea 0F92      		push r0
 3207 0bec 0FB6      		in r0,__SREG__
 3208 0bee 0F92      		push r0
 3209 0bf0 1124      		clr __zero_reg__
 3210 0bf2 2F93      		push r18
 3211 0bf4 3F93      		push r19
 3212 0bf6 4F93      		push r20
 3213 0bf8 5F93      		push r21
 3214 0bfa 6F93      		push r22
 3215 0bfc 7F93      		push r23
 3216 0bfe 8F93      		push r24
 3217 0c00 9F93      		push r25
 3218 0c02 AF93      		push r26
 3219 0c04 BF93      		push r27
 3220 0c06 EF93      		push r30
 3221 0c08 FF93      		push r31
 3222               	/* prologue: Signal */
 3223               	/* frame size = 0 */
 3224               	/* stack size = 15 */
 3225               	.L__stack_usage = 15
 467:main.c        ****  #endif
 3226               		.stabn	68,0,467,.LM383-.LFBB28
 3227               	.LM383:
 3228 0c0a 00D0      		rcall tcnter_overflowUpdate
 471:main.c        **** 		 return;
 3229               		.stabn	68,0,471,.LM384-.LFBB28
 3230               	.LM384:
 3231 0c0c 8091 0000 		lds r24,updateFrame
 3232 0c10 8823      		tst r24
 3233 0c12 01F0      		breq .L230
 499:main.c        **** 
 3234               		.stabn	68,0,499,.LM385-.LFBB28
 3235               	.LM385:
 3236 0c14 00D0      		rcall lcd_update
 501:main.c        **** 	{
 3237               		.stabn	68,0,501,.LM386-.LFBB28
 3238               	.LM386:
 3239 0c16 8F3F      		cpi r24,-1
 3240 0c18 9F47      		sbci r25,127
 3241 0c1a 01F4      		brne .L230
 503:main.c        **** 		//lcd_update() returns TRUE when the frame is complete
 3242               		.stabn	68,0,503,.LM387-.LFBB28
 3243               	.LM387:
 3244 0c1c 8091 0000 		lds r24,frameCount
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 188


 3245 0c20 8F5F      		subi r24,lo8(-(1))
 3246 0c22 8093 0000 		sts frameCount,r24
 3247               	.LBB151:
 3248               	.LBB152:
1118:main.c        **** }
1119:main.c        **** #endif
1120:main.c        **** #endif
1121:main.c        **** #endif
1122:main.c        **** 
1123:main.c        **** 
1124:main.c        **** uint8_t isNewFrame(void)
1125:main.c        **** {
1126:main.c        **** 	uint8_t newFrame = FALSE;
1127:main.c        **** 
1128:main.c        **** 	static uint8_t lastFrameCount = 0;
1129:main.c        **** #define FRAME_COUNT_LIMIT 0x03
1130:main.c        **** 	uint8_t thisFrameCount = frameCount&FRAME_COUNT_LIMIT;
1131:main.c        **** 
1132:main.c        **** //		if(( (thisFrameCount==0) && (lastFrameCount==FRAME_COUNT_LIMIT) ))
1133:main.c        **** 	if(thisFrameCount != lastFrameCount)
1134:main.c        **** 		newFrame = TRUE;
1135:main.c        **** 
1136:main.c        **** 	lastFrameCount = thisFrameCount;
1137:main.c        **** 
1138:main.c        **** 	return newFrame;
1139:main.c        **** }
1140:main.c        **** 
1141:main.c        **** 
1142:main.c        **** 
1143:main.c        **** #if(defined(FB_REFRESH_ON_CHANGE) && FB_REFRESH_ON_CHANGE)
1144:main.c        **** //For FB_QUESTION, FB_SMILEY, etc. it might be nice to only refresh when 
1145:main.c        **** // the actual image changes...
1146:main.c        **** // This is revisited from _unusedIdeas/frameCountToDelay.c
1147:main.c        **** void endOfFrameHandler(void)
1148:main.c        **** {
1149:main.c        **** 	//The original plan was to stop the timer, but now that is used by
1150:main.c        **** 	//dmsTimer... so instead:
1151:main.c        **** 	if(updateFrame)
 3249               		.stabn	68,0,1151,.LM388-.LFBB28
 3250               	.LM388:
 3251 0c26 8091 0000 		lds r24,updateFrame
 3252 0c2a 8823      		tst r24
 3253 0c2c 01F0      		breq .L230
1152:main.c        **** 		updateFrame--; //= FALSE;
 3254               		.stabn	68,0,1152,.LM389-.LFBB28
 3255               	.LM389:
 3256 0c2e 8091 0000 		lds r24,updateFrame
 3257 0c32 8150      		subi r24,lo8(-(-1))
 3258 0c34 8093 0000 		sts updateFrame,r24
 3259               	.L230:
 3260               	/* epilogue start */
 3261               	.LBE152:
 3262               	.LBE151:
 557:main.c        **** #endif //!PWM_TESTING
 3263               		.stabn	68,0,557,.LM390-.LFBB28
 3264               	.LM390:
 3265 0c38 FF91      		pop r31
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 189


 3266 0c3a EF91      		pop r30
 3267 0c3c BF91      		pop r27
 3268 0c3e AF91      		pop r26
 3269 0c40 9F91      		pop r25
 3270 0c42 8F91      		pop r24
 3271 0c44 7F91      		pop r23
 3272 0c46 6F91      		pop r22
 3273 0c48 5F91      		pop r21
 3274 0c4a 4F91      		pop r20
 3275 0c4c 3F91      		pop r19
 3276 0c4e 2F91      		pop r18
 3277 0c50 0F90      		pop r0
 3278 0c52 0FBE      		out __SREG__,r0
 3279 0c54 0F90      		pop r0
 3280 0c56 1F90      		pop r1
 3281 0c58 1895      		reti
 3282               		.size	__vector_14, .-__vector_14
 3283               	.Lscope28:
 3284               		.stabs	"",36,0,0,.Lscope28-.LFBB28
 3285               		.stabd	78,0,0
 3286               		.stabs	"init_hsyncTimer:F(0,47)",36,0,27,init_hsyncTimer
 3287               	.global	init_hsyncTimer
 3288               		.type	init_hsyncTimer, @function
 3289               	init_hsyncTimer:
 3290               		.stabd	46,0,0
 3291               		.stabs	"hsyncTimerStuff.c",132,0,0,.Ltext35
 3292               	.Ltext35:
   1:hsyncTimerStuff.c **** /* mehPL:
   2:hsyncTimerStuff.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:hsyncTimerStuff.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:hsyncTimerStuff.c ****  *    Please see the bottom.
   5:hsyncTimerStuff.c ****  *    Enjoy!
   6:hsyncTimerStuff.c ****  */
   7:hsyncTimerStuff.c **** 
   8:hsyncTimerStuff.c **** 
   9:hsyncTimerStuff.c **** 
  10:hsyncTimerStuff.c **** 
  11:hsyncTimerStuff.c **** 
  12:hsyncTimerStuff.c **** 
  13:hsyncTimerStuff.c **** 
  14:hsyncTimerStuff.c **** 
  15:hsyncTimerStuff.c **** 
  16:hsyncTimerStuff.c **** 
  17:hsyncTimerStuff.c **** 
  18:hsyncTimerStuff.c **** 
  19:hsyncTimerStuff.c **** //hsyncTimer is used for timing each LCD row.
  20:hsyncTimerStuff.c **** // Please see hsyncTimerStuff.h for implementation notes.
  21:hsyncTimerStuff.c **** 
  22:hsyncTimerStuff.c **** #include "hsyncTimerStuff.h"
  23:hsyncTimerStuff.c **** 
  24:hsyncTimerStuff.c **** //Testing with values returned by hsyncTimerCalculator
  25:hsyncTimerStuff.c **** //#define HSYNC_TIMER_OCRVAL	65
  26:hsyncTimerStuff.c **** 
  27:hsyncTimerStuff.c **** void init_hsyncTimer(void)
  28:hsyncTimerStuff.c **** {
 3293               		.stabn	68,0,28,.LM391-.LFBB29
 3294               	.LM391:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 190


 3295               	.LFBB29:
 3296               	/* prologue: function */
 3297               	/* frame size = 0 */
 3298               	/* stack size = 0 */
 3299               	.L__stack_usage = 0
  29:hsyncTimerStuff.c ****    HSYNC_TIMER_OCR = HSYNC_TIMER_OCRVAL; 
 3300               		.stabn	68,0,29,.LM392-.LFBB29
 3301               	.LM392:
 3302 0c5a 8DEE      		ldi r24,lo8(-19)
 3303 0c5c 83BB      		out 0x13,r24
  30:hsyncTimerStuff.c **** 							//T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC;
  31:hsyncTimerStuff.c ****    timer_setWGM(HSYNC_TIMER_NUM, WGM_CLR_ON_COMPARE);
 3304               		.stabn	68,0,31,.LM393-.LFBB29
 3305               	.LM393:
 3306 0c5e 62E0      		ldi r22,lo8(2)
 3307 0c60 80E0      		ldi r24,0
 3308 0c62 00D0      		rcall timer_setWGM
  32:hsyncTimerStuff.c ****    timer_selectDivisor(HSYNC_TIMER_NUM, HSYNC_TIMER_CLKDIV); //CLKDIV1);
 3309               		.stabn	68,0,32,.LM394-.LFBB29
 3310               	.LM394:
 3311 0c64 63E0      		ldi r22,lo8(3)
 3312 0c66 80E0      		ldi r24,0
 3313 0c68 00D0      		rcall timer_selectDivisor
  33:hsyncTimerStuff.c ****    timer_compareMatchIntEnable(HSYNC_TIMER_NUM, OUT_CHANNELA);
 3314               		.stabn	68,0,33,.LM395-.LFBB29
 3315               	.LM395:
 3316 0c6a 41E0      		ldi r20,lo8(1)
 3317 0c6c 60E0      		ldi r22,0
 3318 0c6e 80E0      		ldi r24,0
 3319 0c70 00C0      		rjmp timer_compareMatchIntSetup
 3320               		.size	init_hsyncTimer, .-init_hsyncTimer
 3321               	.Lscope29:
 3322               		.stabs	"",36,0,0,.Lscope29-.LFBB29
 3323               		.stabd	78,0,0
 3324               		.stabs	"drawPix:F(0,47)",36,0,1110,drawPix
 3325               		.stabs	"rowNum:P(4,4)",64,0,1110,24
 3326               	.global	drawPix
 3327               		.type	drawPix, @function
 3328               	drawPix:
 3329               		.stabd	46,0,0
 3330               		.stabs	"main.c",132,0,0,.Ltext36
 3331               	.Ltext36:
1111:main.c        **** 	//a/o v70, it's in use again for ROW_BUFFER.
 3332               		.stabn	68,0,1111,.LM396-.LFBB30
 3333               	.LM396:
 3334               	.LFBB30:
 3335               	/* prologue: function */
 3336               	/* frame size = 0 */
 3337               	/* stack size = 0 */
 3338               	.L__stack_usage = 0
1117:main.c        **** }
 3339               		.stabn	68,0,1117,.LM397-.LFBB30
 3340               	.LM397:
 3341 0c72 00C0      		rjmp nonRSB_drawPix
 3342               		.size	drawPix, .-drawPix
 3343               	.Lscope30:
 3344               		.stabs	"",36,0,0,.Lscope30-.LFBB30
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 191


 3345               		.stabd	78,0,0
 3346               		.stabs	"isNewFrame:F(4,2)",36,0,1124,isNewFrame
 3347               	.global	isNewFrame
 3348               		.type	isNewFrame, @function
 3349               	isNewFrame:
 3350               		.stabd	46,0,0
1125:main.c        **** 	uint8_t newFrame = FALSE;
 3351               		.stabn	68,0,1125,.LM398-.LFBB31
 3352               	.LM398:
 3353               	.LFBB31:
 3354               	/* prologue: function */
 3355               	/* frame size = 0 */
 3356               	/* stack size = 0 */
 3357               	.L__stack_usage = 0
1130:main.c        **** 
 3358               		.stabn	68,0,1130,.LM399-.LFBB31
 3359               	.LM399:
 3360 0c74 9091 0000 		lds r25,frameCount
 3361 0c78 9370      		andi r25,lo8(3)
1133:main.c        **** 		newFrame = TRUE;
 3362               		.stabn	68,0,1133,.LM400-.LFBB31
 3363               	.LM400:
 3364 0c7a 81E0      		ldi r24,lo8(1)
 3365 0c7c 2091 0000 		lds r18,lastFrameCount.2471
 3366 0c80 9213      		cpse r25,r18
 3367 0c82 00C0      		rjmp .L240
 3368 0c84 80E0      		ldi r24,0
 3369               	.L240:
1136:main.c        **** 
 3370               		.stabn	68,0,1136,.LM401-.LFBB31
 3371               	.LM401:
 3372 0c86 9093 0000 		sts lastFrameCount.2471,r25
1139:main.c        **** 
 3373               		.stabn	68,0,1139,.LM402-.LFBB31
 3374               	.LM402:
 3375 0c8a 0895      		ret
 3376               		.size	isNewFrame, .-isNewFrame
 3377               		.stabs	"lastFrameCount:V(4,2)",38,0,1128,lastFrameCount.2471
 3378               		.stabs	"thisFrameCount:r(4,2)",64,0,1130,25
 3379               		.stabn	192,0,0,.LFBB31-.LFBB31
 3380               		.stabn	224,0,0,.Lscope31-.LFBB31
 3381               	.Lscope31:
 3382               		.stabs	"",36,0,0,.Lscope31-.LFBB31
 3383               		.stabd	78,0,0
 3384               		.section	.text.startup,"ax",@progbits
 3385               		.stabs	"main:F(0,1)",36,0,1193,main
 3386               	.global	main
 3387               		.type	main, @function
 3388               	main:
 3389               		.stabd	46,0,0
1153:main.c        **** 
1154:main.c        **** 	//The sony display seems to dislike not having a dot-clock...
1155:main.c        **** 	// This is an experiment...
1156:main.c        ****   #if (defined(LCDINTERFACE_BITBANGED_DOTCLOCK_PWM) && \
1157:main.c        **** 		  LCDINTERFACE_BITBANGED_DOTCLOCK_PWM)
1158:main.c        **** 	if(!updateFrame)
1159:main.c        **** 		lcdInterface_pwmDotClockInit(TRUE);
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 192


1160:main.c        ****   #endif
1161:main.c        **** }
1162:main.c        **** #else
1163:main.c        **** //See the declaration, above...
1164:main.c        **** void endOfFrameHandler(void)
1165:main.c        **** {
1166:main.c        **** }
1167:main.c        **** #endif
1168:main.c        **** 
1169:main.c        **** //#define TEST__FLASH TRUE
1170:main.c        **** 
1171:main.c        **** #if(defined(TEST__FLASH) && TEST__FLASH)
1172:main.c        ****  #include "test__flash.c"
1173:main.c        **** #endif
1174:main.c        **** 
1175:main.c        **** 
1176:main.c        **** 
1177:main.c        **** //v66.51-64:
1178:main.c        **** // This was added for comparing the assembly-output of GCC4.4 vs 4.8
1179:main.c        **** // Otherwise it's not-used
1180:main.c        **** /*
1181:main.c        **** void delayDotsFn(int32_t numDots)
1182:main.c        **** {
1183:main.c        **** 	int32_t numCyc = DOTS_TO_CYC(numDots);
1184:main.c        **** 
1185:main.c        **** 	delay_cyc(numCyc);
1186:main.c        **** }
1187:main.c        **** */
1188:main.c        **** 
1189:main.c        **** 
1190:main.c        **** 
1191:main.c        **** 
1192:main.c        **** 
1193:main.c        **** int main(void)
1194:main.c        **** {
 3390               		.stabn	68,0,1194,.LM403-.LFBB32
 3391               	.LM403:
 3392               	.LFBB32:
 3393               	/* prologue: function */
 3394               	/* frame size = 0 */
 3395               	/* stack size = 0 */
 3396               	.L__stack_usage = 0
1195:main.c        **** // a/o FB_TETRIS, testing...
1196:main.c        **** 	//WTF... this ain't showin' up when FB_WIDTH=24...?!
1197:main.c        **** 
1198:main.c        **** #if(defined(FRAMEBUFFER_TESTING) && FRAMEBUFFER_TESTING)
1199:main.c        **** 	frameBufferInit();
 3397               		.stabn	68,0,1199,.LM404-.LFBB32
 3398               	.LM404:
 3399 0000 00D0      		rcall frameBufferInit
 3400 0002 20E0      		ldi r18,lo8(frameBuffer)
 3401 0004 30E0      		ldi r19,hi8(frameBuffer)
1200:main.c        **** 	uint8_t i, j;
1201:main.c        **** 	for(i=0; i<FB_HEIGHT; i++)
 3402               		.stabn	68,0,1201,.LM405-.LFBB32
 3403               	.LM405:
 3404 0006 40E0      		ldi r20,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 193


 3405               	.L242:
1194:main.c        **** // a/o FB_TETRIS, testing...
 3406               		.stabn	68,0,1194,.LM406-.LFBB32
 3407               	.LM406:
 3408 0008 80E0      		ldi r24,0
 3409 000a 90E0      		ldi r25,0
 3410               	.L245:
 3411 000c F901      		movw r30,r18
 3412 000e E80F      		add r30,r24
 3413 0010 F91F      		adc r31,r25
 3414 0012 542F      		mov r21,r20
 3415 0014 580F      		add r21,r24
1202:main.c        **** 		for(j=0; j<FB_WIDTH; j++)
1203:main.c        **** 			frameBuffer[i][j] = i+j;
 3416               		.stabn	68,0,1203,.LM407-.LFBB32
 3417               	.LM407:
 3418 0016 5083      		st Z,r21
 3419 0018 0196      		adiw r24,1
1202:main.c        **** 		for(j=0; j<FB_WIDTH; j++)
 3420               		.stabn	68,0,1202,.LM408-.LFBB32
 3421               	.LM408:
 3422 001a 8031      		cpi r24,16
 3423 001c 9105      		cpc r25,__zero_reg__
 3424 001e 01F4      		brne .L245
1201:main.c        **** 		for(j=0; j<FB_WIDTH; j++)
 3425               		.stabn	68,0,1201,.LM409-.LFBB32
 3426               	.LM409:
 3427 0020 4F5F      		subi r20,lo8(-(1))
 3428 0022 2F5E      		subi r18,-17
 3429 0024 3F4F      		sbci r19,-1
 3430 0026 4031      		cpi r20,lo8(16)
 3431 0028 01F4      		brne .L242
1204:main.c        **** #endif
1205:main.c        **** 
1206:main.c        **** #if(defined(SEG_RACER) && SEG_RACER)
1207:main.c        **** 	racer_init();
1208:main.c        **** #endif
1209:main.c        **** 
1210:main.c        **** #if (defined(BLUE_ADC) && BLUE_ADC)
1211:main.c        **** 	adc_takeInput(6);
1212:main.c        **** 	adc_init();
1213:main.c        **** 	adc_select(6);
1214:main.c        **** #endif
1215:main.c        **** 
1216:main.c        **** 
1217:main.c        **** #if (defined(PIEZO_HIT_DETECTION) && PIEZO_HIT_DETECTION)
1218:main.c        **** //#if (defined(FB_QUESTION) && FB_QUESTION)
1219:main.c        **** 	//This is identical to the BLUE_ADC case, above, but the adc is used
1220:main.c        **** 	//differently... and I'm trying to do some cleanup, which is more messy
1221:main.c        **** 	//here, because of it. Wee!
1222:main.c        **** 
1223:main.c        **** 	//Actually, it runs adc_startConversion() at the end, so it's no longer
1224:main.c        **** 	//*identical*
1225:main.c        **** 	phd_init();
1226:main.c        **** #endif
1227:main.c        **** 
1228:main.c        **** #if((defined(SEG_TET) && SEG_TET) || (defined(FB_TETRIS) && FB_TETRIS))
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 194


1229:main.c        **** 	tetInit(3);
1230:main.c        **** #endif
1231:main.c        **** 
1232:main.c        **** #if(defined(_DMS_EXTERNALUPDATE_) && _DMS_EXTERNALUPDATE_)
1233:main.c        **** 	//These values could probably be calculated...
1234:main.c        **** 	// (as long as OSCCAL_VAL isn't changed)
1235:main.c        **** 	// But I'm going on the fact, it's refreshing about 8Hz
1236:main.c        **** 	// and there's roughly 768 rows (HSYNC interrupts)
1237:main.c        **** 	// (of course, there's vsync rows, too)
1238:main.c        **** 	// so... that's about .000125s per HSYNC interrupt
1239:main.c        **** 	// or 8000 interrupts per second
1240:main.c        **** 	// Which is roughly 1dms per interrupt...
1241:main.c        **** 	init_dmsExternalUpdate(1,1);
1242:main.c        **** #endif
1243:main.c        **** 
1244:main.c        **** 
1245:main.c        **** 
1246:main.c        **** #if(!defined(PWM_TESTING) || !PWM_TESTING)
1247:main.c        **** 	init_hsyncTimer();
 3432               		.stabn	68,0,1247,.LM410-.LFBB32
 3433               	.LM410:
 3434 002a 00D0      		rcall init_hsyncTimer
1248:main.c        **** #endif
1249:main.c        **** 
1250:main.c        **** 	//This starts pretty late... watch out for WDT
1251:main.c        **** #if(!defined(V6651COMPARE) || !V6651COMPARE)
1252:main.c        **** 	init_heartBeat();
 3435               		.stabn	68,0,1252,.LM411-.LFBB32
 3436               	.LM411:
 3437 002c 00D0      		rcall init_heartBeat
1253:main.c        **** 
1254:main.c        **** 	setHeartRate(0);
 3438               		.stabn	68,0,1254,.LM412-.LFBB32
 3439               	.LM412:
 3440 002e 80E0      		ldi r24,0
 3441 0030 00D0      		rcall setHeartRate
1255:main.c        **** #endif
1256:main.c        **** 
1257:main.c        **** 
1258:main.c        **** 
1259:main.c        **** #if(defined(TEST__FLASH) && TEST__FLASH)
1260:main.c        **** 	test__flash();
1261:main.c        **** #endif
1262:main.c        **** 
1263:main.c        **** 
1264:main.c        **** 
1265:main.c        **** 
1266:main.c        **** 
1267:main.c        **** 
1268:main.c        **** 	lvds_timerInit();
 3442               		.stabn	68,0,1268,.LM413-.LFBB32
 3443               	.LM413:
 3444 0032 00D0      		rcall lvds_timerInit
1269:main.c        **** 
1270:main.c        **** 
1271:main.c        **** #if (defined(FB_QUESTION) && FB_QUESTION)
1272:main.c        ****  #if (defined(BUMP_SWITCH) && BUMP_SWITCH)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 195


1273:main.c        **** 	hitSensor_init();
 3445               		.stabn	68,0,1273,.LM414-.LFBB32
 3446               	.LM414:
 3447 0034 00D0      		rcall hitSensor_init
 3448               	.L247:
1274:main.c        ****  #endif
1275:main.c        **** #endif
1276:main.c        **** 
1277:main.c        **** 
1278:main.c        **** 	while(1)
1279:main.c        **** 	{
1280:main.c        **** #if(defined(FB_QUESTION) && FB_QUESTION)
1281:main.c        **** //THIS PROBABLY SHOULD BE REVISED...
1282:main.c        **** //_hitSensors/bumpSwitch.c handles it differently...
1283:main.c        **** //#if (!defined(BUMP_SWITCH) || !BUMP_SWITCH)
1284:main.c        **** // I don't see why BUMP_SWITCH can't be true as well as
1285:main.c        **** // heartPinInputPoll...
1286:main.c        **** // But PIEZO_HIT_DETECTION is typically on the same pin as BUMP_SWITCH
1287:main.c        **** 
1288:main.c        **** #if(!defined(__HEART_REMOVED__) || !(__HEART_REMOVED__))
1289:main.c        **** #if (defined(PIEZO_HIT_DETECTION) && PIEZO_HIT_DETECTION)
1290:main.c        **** #if (defined(BUMP_SWITCH) && BUMP_SWITCH)
1291:main.c        **** #error "BUMP_SWITCH and PIEZO_HIT_DETECTION can't *both* be enabled, currently"
1292:main.c        **** #endif
1293:main.c        **** 		if(phd_update())				
1294:main.c        **** #else
1295:main.c        **** 		if(!heartPinInputPoll())
 3449               		.stabn	68,0,1295,.LM415-.LFBB32
 3450               	.LM415:
 3451 0036 00D0      		rcall heartPinInputPoll
 3452 0038 8111      		cpse r24,__zero_reg__
 3453 003a 00C0      		rjmp .L246
1296:main.c        **** #endif
1297:main.c        **** 			fbQuestion_hitDetected();
 3454               		.stabn	68,0,1297,.LM416-.LFBB32
 3455               	.LM416:
 3456 003c 00D0      		rcall fbQuestion_hitDetected
 3457               	.L246:
1298:main.c        **** #endif
1299:main.c        **** #endif
1300:main.c        **** 
1301:main.c        **** //#endif
1302:main.c        **** 
1303:main.c        **** //#if( (defined(FB_QUESTION) && FB_QUESTION) 
1304:main.c        **** //	  ||	(defined(FB_SMILEY) && FB_SMILEY) )
1305:main.c        **** #if( defined(FRAMEBUFFER_TESTING) && (FRAMEBUFFER_TESTING))
1306:main.c        **** 		frameBufferUpdate();
 3458               		.stabn	68,0,1306,.LM417-.LFBB32
 3459               	.LM417:
 3460 003e 00D0      		rcall frameBufferUpdate
1307:main.c        **** #endif
1308:main.c        **** 
1309:main.c        **** #if(!defined(V6651COMPARE) || !V6651COMPARE)
1310:main.c        **** 		heartUpdate();
 3461               		.stabn	68,0,1310,.LM418-.LFBB32
 3462               	.LM418:
 3463 0040 00D0      		rcall heartUpdate
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 196


1311:main.c        **** #endif		
1312:main.c        **** 		//THIS IS A HACK
1313:main.c        **** 		//tcnter_update();
1314:main.c        **** 	}
 3464               		.stabn	68,0,1314,.LM419-.LFBB32
 3465               	.LM419:
 3466 0042 00C0      		rjmp .L247
 3467               		.size	main, .-main
 3468               		.stabs	"i:r(4,2)",64,0,1200,20
 3469               		.stabn	192,0,0,.LFBB32-.LFBB32
 3470               		.stabn	224,0,0,.Lscope32-.LFBB32
 3471               	.Lscope32:
 3472               		.stabs	"",36,0,0,.Lscope32-.LFBB32
 3473               		.stabd	78,0,0
 3474               		.local	lastFrameCount.2471
 3475               		.comm	lastFrameCount.2471,1,1
 3476               		.local	lastReward.2322
 3477               		.comm	lastReward.2322,1,1
 3478               		.local	fbLastUpdateTime.2072
 3479               		.comm	fbLastUpdateTime.2072,4,1
 3480               	.global	frameCount
 3481               		.section .bss
 3482               		.type	frameCount, @object
 3483               		.size	frameCount, 1
 3484               	frameCount:
 3485 0000 00        		.zero	1
 3486               	.global	updateFrame
 3487               		.data
 3488               		.type	updateFrame, @object
 3489               		.size	updateFrame, 1
 3490               	updateFrame:
 3491 0000 02        		.byte	2
 3492               	.global	hsyncCount
 3493               		.section .bss
 3494               		.type	hsyncCount, @object
 3495               		.size	hsyncCount, 2
 3496               	hsyncCount:
 3497 0001 0000      		.zero	2
 3498               	.global	vSync
 3499               		.type	vSync, @object
 3500               		.size	vSync, 1
 3501               	vSync:
 3502 0003 00        		.zero	1
 3503               	.global	dataEnable
 3504               		.type	dataEnable, @object
 3505               		.size	dataEnable, 1
 3506               	dataEnable:
 3507 0004 00        		.zero	1
 3508               	.global	qVersion
 3509               		.data
 3510               		.type	qVersion, @object
 3511               		.size	qVersion, 1
 3512               	qVersion:
 3513 0001 01        		.byte	1
 3514               	.global	nowIsReward
 3515               		.section .bss
 3516               		.type	nowIsReward, @object
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 197


 3517               		.size	nowIsReward, 1
 3518               	nowIsReward:
 3519 0005 00        		.zero	1
 3520               	.global	p_nowSprite
 3521               		.data
 3522               		.type	p_nowSprite, @object
 3523               		.size	p_nowSprite, 2
 3524               	p_nowSprite:
 3525 0002 0000      		.word	spriteQ
 3526               	.global	callCount
 3527               		.section .bss
 3528               		.type	callCount, @object
 3529               		.size	callCount, 1
 3530               	callCount:
 3531 0006 00        		.zero	1
 3532               	.global	spriteMUSICBOX
 3533               		.section	.progmem.data,"a",@progbits
 3534               		.type	spriteMUSICBOX, @object
 3535               		.size	spriteMUSICBOX, 19
 3536               	spriteMUSICBOX:
 3537 0000 0000      		.word	pgm_imageMUSICBOX
 3538 0002 0000      		.word	0
 3539 0004 0000      		.word	pgm_paletteMUSICBOX
 3540 0006 01        		.byte	1
 3541 0007 28        		.byte	40
 3542 0008 0000      		.word	0
 3543 000a 0000      		.word	DefaultMotion
 3544 000c 0000      		.word	DefaultLayer
 3545 000e 0000      		.word	DefaultCamMotion
 3546 0010 0000      		.word	0
 3547 0012 03        		.byte	3
 3548               		.type	pgm_paletteMUSICBOX, @object
 3549               		.size	pgm_paletteMUSICBOX, 4
 3550               	pgm_paletteMUSICBOX:
 3551 0013 25        		.byte	37
 3552 0014 00        		.byte	0
 3553 0015 17        		.byte	23
 3554 0016 2F        		.byte	47
 3555               		.type	pgm_imageMUSICBOX, @object
 3556               		.size	pgm_imageMUSICBOX, 192
 3557               	pgm_imageMUSICBOX:
 3558 0017 00        		.byte	0
 3559 0018 55        		.byte	85
 3560 0019 01        		.byte	1
 3561 001a 00        		.byte	0
 3562 001b 50        		.byte	80
 3563 001c AF        		.byte	-81
 3564 001d 16        		.byte	22
 3565 001e 00        		.byte	0
 3566 001f F4        		.byte	-12
 3567 0020 AA        		.byte	-86
 3568 0021 6A        		.byte	106
 3569 0022 00        		.byte	0
 3570 0023 BD        		.byte	-67
 3571 0024 AA        		.byte	-86
 3572 0025 AA        		.byte	-86
 3573 0026 01        		.byte	1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 198


 3574 0027 55        		.byte	85
 3575 0028 55        		.byte	85
 3576 0029 55        		.byte	85
 3577 002a 01        		.byte	1
 3578 002b FD        		.byte	-3
 3579 002c FF        		.byte	-1
 3580 002d FF        		.byte	-1
 3581 002e 01        		.byte	1
 3582 002f FD        		.byte	-3
 3583 0030 57        		.byte	87
 3584 0031 D5        		.byte	-43
 3585 0032 51        		.byte	81
 3586 0033 FD        		.byte	-3
 3587 0034 F7        		.byte	-9
 3588 0035 DF        		.byte	-33
 3589 0036 11        		.byte	17
 3590 0037 FD        		.byte	-3
 3591 0038 57        		.byte	87
 3592 0039 D5        		.byte	-43
 3593 003a 11        		.byte	17
 3594 003b FD        		.byte	-3
 3595 003c F7        		.byte	-9
 3596 003d DF        		.byte	-33
 3597 003e 15        		.byte	21
 3598 003f FD        		.byte	-3
 3599 0040 F7        		.byte	-9
 3600 0041 DF        		.byte	-33
 3601 0042 01        		.byte	1
 3602 0043 7D        		.byte	125
 3603 0044 F5        		.byte	-11
 3604 0045 D5        		.byte	-43
 3605 0046 01        		.byte	1
 3606 0047 5D        		.byte	93
 3607 0048 75        		.byte	117
 3608 0049 D5        		.byte	-43
 3609 004a 01        		.byte	1
 3610 004b 5D        		.byte	93
 3611 004c 7D        		.byte	125
 3612 004d F5        		.byte	-11
 3613 004e 01        		.byte	1
 3614 004f FD        		.byte	-3
 3615 0050 FF        		.byte	-1
 3616 0051 FF        		.byte	-1
 3617 0052 01        		.byte	1
 3618 0053 55        		.byte	85
 3619 0054 55        		.byte	85
 3620 0055 55        		.byte	85
 3621 0056 01        		.byte	1
 3622 0057 00        		.byte	0
 3623 0058 55        		.byte	85
 3624 0059 01        		.byte	1
 3625 005a 00        		.byte	0
 3626 005b 50        		.byte	80
 3627 005c AF        		.byte	-81
 3628 005d 16        		.byte	22
 3629 005e 00        		.byte	0
 3630 005f F4        		.byte	-12
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 199


 3631 0060 AA        		.byte	-86
 3632 0061 6A        		.byte	106
 3633 0062 00        		.byte	0
 3634 0063 BD        		.byte	-67
 3635 0064 AA        		.byte	-86
 3636 0065 AA        		.byte	-86
 3637 0066 01        		.byte	1
 3638 0067 55        		.byte	85
 3639 0068 55        		.byte	85
 3640 0069 55        		.byte	85
 3641 006a 01        		.byte	1
 3642 006b FD        		.byte	-3
 3643 006c FF        		.byte	-1
 3644 006d FF        		.byte	-1
 3645 006e 01        		.byte	1
 3646 006f FD        		.byte	-3
 3647 0070 57        		.byte	87
 3648 0071 D5        		.byte	-43
 3649 0072 01        		.byte	1
 3650 0073 FD        		.byte	-3
 3651 0074 F7        		.byte	-9
 3652 0075 DF        		.byte	-33
 3653 0076 01        		.byte	1
 3654 0077 FD        		.byte	-3
 3655 0078 57        		.byte	87
 3656 0079 D5        		.byte	-43
 3657 007a 51        		.byte	81
 3658 007b FD        		.byte	-3
 3659 007c F7        		.byte	-9
 3660 007d DF        		.byte	-33
 3661 007e 05        		.byte	5
 3662 007f FD        		.byte	-3
 3663 0080 F7        		.byte	-9
 3664 0081 DF        		.byte	-33
 3665 0082 01        		.byte	1
 3666 0083 7D        		.byte	125
 3667 0084 F5        		.byte	-11
 3668 0085 D5        		.byte	-43
 3669 0086 01        		.byte	1
 3670 0087 5D        		.byte	93
 3671 0088 75        		.byte	117
 3672 0089 D5        		.byte	-43
 3673 008a 01        		.byte	1
 3674 008b 5D        		.byte	93
 3675 008c 7D        		.byte	125
 3676 008d F5        		.byte	-11
 3677 008e 01        		.byte	1
 3678 008f FD        		.byte	-3
 3679 0090 FF        		.byte	-1
 3680 0091 FF        		.byte	-1
 3681 0092 01        		.byte	1
 3682 0093 55        		.byte	85
 3683 0094 55        		.byte	85
 3684 0095 55        		.byte	85
 3685 0096 01        		.byte	1
 3686 0097 00        		.byte	0
 3687 0098 55        		.byte	85
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 200


 3688 0099 01        		.byte	1
 3689 009a 00        		.byte	0
 3690 009b 50        		.byte	80
 3691 009c AF        		.byte	-81
 3692 009d 16        		.byte	22
 3693 009e 00        		.byte	0
 3694 009f F4        		.byte	-12
 3695 00a0 AA        		.byte	-86
 3696 00a1 6A        		.byte	106
 3697 00a2 00        		.byte	0
 3698 00a3 BD        		.byte	-67
 3699 00a4 AA        		.byte	-86
 3700 00a5 AA        		.byte	-86
 3701 00a6 01        		.byte	1
 3702 00a7 55        		.byte	85
 3703 00a8 55        		.byte	85
 3704 00a9 55        		.byte	85
 3705 00aa 01        		.byte	1
 3706 00ab FD        		.byte	-3
 3707 00ac FF        		.byte	-1
 3708 00ad FF        		.byte	-1
 3709 00ae 01        		.byte	1
 3710 00af FD        		.byte	-3
 3711 00b0 57        		.byte	87
 3712 00b1 D5        		.byte	-43
 3713 00b2 01        		.byte	1
 3714 00b3 FD        		.byte	-3
 3715 00b4 F7        		.byte	-9
 3716 00b5 DF        		.byte	-33
 3717 00b6 01        		.byte	1
 3718 00b7 FD        		.byte	-3
 3719 00b8 57        		.byte	87
 3720 00b9 D5        		.byte	-43
 3721 00ba 01        		.byte	1
 3722 00bb FD        		.byte	-3
 3723 00bc F7        		.byte	-9
 3724 00bd DF        		.byte	-33
 3725 00be 15        		.byte	21
 3726 00bf FD        		.byte	-3
 3727 00c0 F7        		.byte	-9
 3728 00c1 DF        		.byte	-33
 3729 00c2 11        		.byte	17
 3730 00c3 7D        		.byte	125
 3731 00c4 F5        		.byte	-11
 3732 00c5 D5        		.byte	-43
 3733 00c6 51        		.byte	81
 3734 00c7 5D        		.byte	93
 3735 00c8 75        		.byte	117
 3736 00c9 D5        		.byte	-43
 3737 00ca 01        		.byte	1
 3738 00cb 5D        		.byte	93
 3739 00cc 7D        		.byte	125
 3740 00cd F5        		.byte	-11
 3741 00ce 01        		.byte	1
 3742 00cf FD        		.byte	-3
 3743 00d0 FF        		.byte	-1
 3744 00d1 FF        		.byte	-1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 201


 3745 00d2 01        		.byte	1
 3746 00d3 55        		.byte	85
 3747 00d4 55        		.byte	85
 3748 00d5 55        		.byte	85
 3749 00d6 01        		.byte	1
 3750               	.global	spritePWING
 3751               		.type	spritePWING, @object
 3752               		.size	spritePWING, 19
 3753               	spritePWING:
 3754 00d7 0000      		.word	pgm_imagePWING
 3755 00d9 0000      		.word	0
 3756 00db 0000      		.word	pgm_palettePWING
 3757 00dd 01        		.byte	1
 3758 00de 28        		.byte	40
 3759 00df 0000      		.word	0
 3760 00e1 0000      		.word	DefaultMotion
 3761 00e3 0000      		.word	DefaultLayer
 3762 00e5 0000      		.word	DefaultCamMotion
 3763 00e7 0000      		.word	0
 3764 00e9 01        		.byte	1
 3765               		.type	pgm_palettePWING, @object
 3766               		.size	pgm_palettePWING, 4
 3767               	pgm_palettePWING:
 3768 00ea 25        		.byte	37
 3769 00eb 00        		.byte	0
 3770 00ec 07        		.byte	7
 3771 00ed 2F        		.byte	47
 3772               		.type	pgm_imagePWING, @object
 3773               		.size	pgm_imagePWING, 64
 3774               	pgm_imagePWING:
 3775 00ee 00        		.byte	0
 3776 00ef 00        		.byte	0
 3777 00f0 54        		.byte	84
 3778 00f1 15        		.byte	21
 3779 00f2 00        		.byte	0
 3780 00f3 50        		.byte	80
 3781 00f4 FD        		.byte	-3
 3782 00f5 5F        		.byte	95
 3783 00f6 00        		.byte	0
 3784 00f7 F5        		.byte	-11
 3785 00f8 FF        		.byte	-1
 3786 00f9 7F        		.byte	127
 3787 00fa 40        		.byte	64
 3788 00fb FF        		.byte	-1
 3789 00fc FF        		.byte	-1
 3790 00fd 7F        		.byte	127
 3791 00fe D0        		.byte	-48
 3792 00ff FF        		.byte	-1
 3793 0100 FF        		.byte	-1
 3794 0101 1F        		.byte	31
 3795 0102 F4        		.byte	-12
 3796 0103 FF        		.byte	-1
 3797 0104 FF        		.byte	-1
 3798 0105 07        		.byte	7
 3799 0106 B4        		.byte	-76
 3800 0107 EA        		.byte	-22
 3801 0108 FF        		.byte	-1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 202


 3802 0109 1D        		.byte	29
 3803 010a BD        		.byte	-67
 3804 010b AE        		.byte	-82
 3805 010c 7F        		.byte	127
 3806 010d 1F        		.byte	31
 3807 010e BD        		.byte	-67
 3808 010f AE        		.byte	-82
 3809 0110 FF        		.byte	-1
 3810 0111 07        		.byte	7
 3811 0112 BD        		.byte	-67
 3812 0113 EA        		.byte	-22
 3813 0114 FF        		.byte	-1
 3814 0115 1D        		.byte	29
 3815 0116 BD        		.byte	-67
 3816 0117 FE        		.byte	-2
 3817 0118 7F        		.byte	127
 3818 0119 1F        		.byte	31
 3819 011a BD        		.byte	-67
 3820 011b FE        		.byte	-2
 3821 011c FF        		.byte	-1
 3822 011d 07        		.byte	7
 3823 011e F4        		.byte	-12
 3824 011f FF        		.byte	-1
 3825 0120 FF        		.byte	-1
 3826 0121 07        		.byte	7
 3827 0122 F4        		.byte	-12
 3828 0123 FF        		.byte	-1
 3829 0124 FF        		.byte	-1
 3830 0125 01        		.byte	1
 3831 0126 D0        		.byte	-48
 3832 0127 FF        		.byte	-1
 3833 0128 5F        		.byte	95
 3834 0129 00        		.byte	0
 3835 012a 40        		.byte	64
 3836 012b 55        		.byte	85
 3837 012c 05        		.byte	5
 3838 012d 00        		.byte	0
 3839               	.global	spriteHAMMER
 3840               		.type	spriteHAMMER, @object
 3841               		.size	spriteHAMMER, 19
 3842               	spriteHAMMER:
 3843 012e 0000      		.word	pgm_imageHAMMER
 3844 0130 0000      		.word	0
 3845 0132 0000      		.word	pgm_paletteHAMMER
 3846 0134 01        		.byte	1
 3847 0135 28        		.byte	40
 3848 0136 0000      		.word	0
 3849 0138 0000      		.word	DefaultMotion
 3850 013a 0000      		.word	DefaultLayer
 3851 013c 0000      		.word	DefaultCamMotion
 3852 013e 0000      		.word	0
 3853 0140 01        		.byte	1
 3854               		.type	pgm_paletteHAMMER, @object
 3855               		.size	pgm_paletteHAMMER, 4
 3856               	pgm_paletteHAMMER:
 3857 0141 25        		.byte	37
 3858 0142 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 203


 3859 0143 02        		.byte	2
 3860 0144 2F        		.byte	47
 3861               		.type	pgm_imageHAMMER, @object
 3862               		.size	pgm_imageHAMMER, 64
 3863               	pgm_imageHAMMER:
 3864 0145 00        		.byte	0
 3865 0146 54        		.byte	84
 3866 0147 55        		.byte	85
 3867 0148 54        		.byte	84
 3868 0149 40        		.byte	64
 3869 014a F5        		.byte	-11
 3870 014b 7F        		.byte	127
 3871 014c FD        		.byte	-3
 3872 014d D0        		.byte	-48
 3873 014e 5F        		.byte	95
 3874 014f 55        		.byte	85
 3875 0150 5D        		.byte	93
 3876 0151 74        		.byte	116
 3877 0152 55        		.byte	85
 3878 0153 55        		.byte	85
 3879 0154 55        		.byte	85
 3880 0155 54        		.byte	84
 3881 0156 55        		.byte	85
 3882 0157 55        		.byte	85
 3883 0158 55        		.byte	85
 3884 0159 F5        		.byte	-11
 3885 015a 55        		.byte	85
 3886 015b 55        		.byte	85
 3887 015c 55        		.byte	85
 3888 015d 5D        		.byte	93
 3889 015e 55        		.byte	85
 3890 015f 55        		.byte	85
 3891 0160 54        		.byte	84
 3892 0161 14        		.byte	20
 3893 0162 50        		.byte	80
 3894 0163 55        		.byte	85
 3895 0164 54        		.byte	84
 3896 0165 00        		.byte	0
 3897 0166 40        		.byte	64
 3898 0167 1A        		.byte	26
 3899 0168 00        		.byte	0
 3900 0169 00        		.byte	0
 3901 016a 40        		.byte	64
 3902 016b 1A        		.byte	26
 3903 016c 00        		.byte	0
 3904 016d 00        		.byte	0
 3905 016e 40        		.byte	64
 3906 016f 1A        		.byte	26
 3907 0170 00        		.byte	0
 3908 0171 00        		.byte	0
 3909 0172 40        		.byte	64
 3910 0173 1A        		.byte	26
 3911 0174 00        		.byte	0
 3912 0175 00        		.byte	0
 3913 0176 40        		.byte	64
 3914 0177 1A        		.byte	26
 3915 0178 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 204


 3916 0179 00        		.byte	0
 3917 017a 40        		.byte	64
 3918 017b 1A        		.byte	26
 3919 017c 00        		.byte	0
 3920 017d 00        		.byte	0
 3921 017e 40        		.byte	64
 3922 017f 1A        		.byte	26
 3923 0180 00        		.byte	0
 3924 0181 00        		.byte	0
 3925 0182 00        		.byte	0
 3926 0183 05        		.byte	5
 3927 0184 00        		.byte	0
 3928               	.global	spriteBOOT
 3929               		.type	spriteBOOT, @object
 3930               		.size	spriteBOOT, 19
 3931               	spriteBOOT:
 3932 0185 0000      		.word	pgm_imageBOOT
 3933 0187 0000      		.word	0
 3934 0189 0000      		.word	pgm_paletteBOOT
 3935 018b 01        		.byte	1
 3936 018c 34        		.byte	52
 3937 018d 0000      		.word	0
 3938 018f 0000      		.word	BootMotion
 3939 0191 0000      		.word	DefaultLayer
 3940 0193 0000      		.word	BootCamMotion
 3941 0195 0000      		.word	0
 3942 0197 02        		.byte	2
 3943               	.global	BootCamMotion
 3944               		.type	BootCamMotion, @object
 3945               		.size	BootCamMotion, 6
 3946               	BootCamMotion:
 3947 0198 00        		.byte	0
 3948 0199 0000      		.word	0
 3949 019b 00        		.byte	0
 3950 019c 0000      		.word	BootCamY
 3951               	.global	BootCamY
 3952               		.type	BootCamY, @object
 3953               		.size	BootCamY, 13
 3954               	BootCamY:
 3955 019e 55        		.byte	85
 3956 019f 55        		.byte	85
 3957 01a0 55        		.byte	85
 3958 01a1 55        		.byte	85
 3959 01a2 00        		.byte	0
 3960 01a3 00        		.byte	0
 3961 01a4 00        		.byte	0
 3962 01a5 00        		.byte	0
 3963 01a6 03        		.byte	3
 3964 01a7 55        		.byte	85
 3965 01a8 55        		.byte	85
 3966 01a9 55        		.byte	85
 3967 01aa 55        		.byte	85
 3968               	.global	BootMotion
 3969               		.type	BootMotion, @object
 3970               		.size	BootMotion, 6
 3971               	BootMotion:
 3972 01ab 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 205


 3973 01ac 0000      		.word	BootX
 3974 01ae F0        		.byte	-16
 3975 01af 0000      		.word	BootY
 3976               	.global	BootY
 3977               		.type	BootY, @object
 3978               		.size	BootY, 13
 3979               	BootY:
 3980 01b1 AA        		.byte	-86
 3981 01b2 AA        		.byte	-86
 3982 01b3 AA        		.byte	-86
 3983 01b4 AA        		.byte	-86
 3984 01b5 B8        		.byte	-72
 3985 01b6 BB        		.byte	-69
 3986 01b7 BB        		.byte	-69
 3987 01b8 BB        		.byte	-69
 3988 01b9 BB        		.byte	-69
 3989 01ba BB        		.byte	-69
 3990 01bb 00        		.byte	0
 3991 01bc 00        		.byte	0
 3992 01bd 00        		.byte	0
 3993               	.global	BootX
 3994               		.type	BootX, @object
 3995               		.size	BootX, 13
 3996               	BootX:
 3997 01be 00        		.byte	0
 3998 01bf 00        		.byte	0
 3999 01c0 00        		.byte	0
 4000 01c1 03        		.byte	3
 4001 01c2 54        		.byte	84
 4002 01c3 54        		.byte	84
 4003 01c4 54        		.byte	84
 4004 01c5 54        		.byte	84
 4005 01c6 54        		.byte	84
 4006 01c7 54        		.byte	84
 4007 01c8 00        		.byte	0
 4008 01c9 00        		.byte	0
 4009 01ca 00        		.byte	0
 4010               		.type	pgm_paletteBOOT, @object
 4011               		.size	pgm_paletteBOOT, 4
 4012               	pgm_paletteBOOT:
 4013 01cb 25        		.byte	37
 4014 01cc 00        		.byte	0
 4015 01cd 0C        		.byte	12
 4016 01ce 2F        		.byte	47
 4017               		.type	pgm_imageBOOT, @object
 4018               		.size	pgm_imageBOOT, 128
 4019               	pgm_imageBOOT:
 4020 01cf 50        		.byte	80
 4021 01d0 55        		.byte	85
 4022 01d1 55        		.byte	85
 4023 01d2 15        		.byte	21
 4024 01d3 94        		.byte	-108
 4025 01d4 AA        		.byte	-86
 4026 01d5 AA        		.byte	-86
 4027 01d6 56        		.byte	86
 4028 01d7 A4        		.byte	-92
 4029 01d8 AA        		.byte	-86
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 206


 4030 01d9 AA        		.byte	-86
 4031 01da 5A        		.byte	90
 4032 01db A4        		.byte	-92
 4033 01dc AA        		.byte	-86
 4034 01dd AA        		.byte	-86
 4035 01de 5A        		.byte	90
 4036 01df A4        		.byte	-92
 4037 01e0 AA        		.byte	-86
 4038 01e1 AA        		.byte	-86
 4039 01e2 56        		.byte	86
 4040 01e3 54        		.byte	84
 4041 01e4 55        		.byte	85
 4042 01e5 55        		.byte	85
 4043 01e6 7D        		.byte	125
 4044 01e7 90        		.byte	-112
 4045 01e8 AA        		.byte	-86
 4046 01e9 AA        		.byte	-86
 4047 01ea 7D        		.byte	125
 4048 01eb 90        		.byte	-112
 4049 01ec AA        		.byte	-86
 4050 01ed AA        		.byte	-86
 4051 01ee 75        		.byte	117
 4052 01ef 54        		.byte	84
 4053 01f0 A5        		.byte	-91
 4054 01f1 6A        		.byte	106
 4055 01f2 7F        		.byte	127
 4056 01f3 A5        		.byte	-91
 4057 01f4 9A        		.byte	-102
 4058 01f5 AA        		.byte	-86
 4059 01f6 75        		.byte	117
 4060 01f7 A9        		.byte	-87
 4061 01f8 AA        		.byte	-86
 4062 01f9 AA        		.byte	-86
 4063 01fa 7D        		.byte	125
 4064 01fb A9        		.byte	-87
 4065 01fc AA        		.byte	-86
 4066 01fd AA        		.byte	-86
 4067 01fe 7D        		.byte	125
 4068 01ff A9        		.byte	-87
 4069 0200 AA        		.byte	-86
 4070 0201 AA        		.byte	-86
 4071 0202 56        		.byte	86
 4072 0203 A9        		.byte	-87
 4073 0204 AA        		.byte	-86
 4074 0205 AA        		.byte	-86
 4075 0206 5A        		.byte	90
 4076 0207 A5        		.byte	-91
 4077 0208 AA        		.byte	-86
 4078 0209 AA        		.byte	-86
 4079 020a 56        		.byte	86
 4080 020b 54        		.byte	84
 4081 020c 55        		.byte	85
 4082 020d 55        		.byte	85
 4083 020e 15        		.byte	21
 4084 020f 50        		.byte	80
 4085 0210 55        		.byte	85
 4086 0211 55        		.byte	85
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 207


 4087 0212 15        		.byte	21
 4088 0213 94        		.byte	-108
 4089 0214 AA        		.byte	-86
 4090 0215 AA        		.byte	-86
 4091 0216 56        		.byte	86
 4092 0217 A4        		.byte	-92
 4093 0218 AA        		.byte	-86
 4094 0219 AA        		.byte	-86
 4095 021a 5A        		.byte	90
 4096 021b A4        		.byte	-92
 4097 021c AA        		.byte	-86
 4098 021d AA        		.byte	-86
 4099 021e 5A        		.byte	90
 4100 021f A4        		.byte	-92
 4101 0220 AA        		.byte	-86
 4102 0221 AA        		.byte	-86
 4103 0222 5A        		.byte	90
 4104 0223 54        		.byte	84
 4105 0224 55        		.byte	85
 4106 0225 55        		.byte	85
 4107 0226 55        		.byte	85
 4108 0227 90        		.byte	-112
 4109 0228 AA        		.byte	-86
 4110 0229 AA        		.byte	-86
 4111 022a 55        		.byte	85
 4112 022b 90        		.byte	-112
 4113 022c AA        		.byte	-86
 4114 022d AA        		.byte	-86
 4115 022e 7D        		.byte	125
 4116 022f 54        		.byte	84
 4117 0230 A5        		.byte	-91
 4118 0231 6A        		.byte	106
 4119 0232 7F        		.byte	127
 4120 0233 A5        		.byte	-91
 4121 0234 9A        		.byte	-102
 4122 0235 AA        		.byte	-86
 4123 0236 7D        		.byte	125
 4124 0237 A9        		.byte	-87
 4125 0238 AA        		.byte	-86
 4126 0239 AA        		.byte	-86
 4127 023a 55        		.byte	85
 4128 023b A9        		.byte	-87
 4129 023c AA        		.byte	-86
 4130 023d AA        		.byte	-86
 4131 023e 5A        		.byte	90
 4132 023f A9        		.byte	-87
 4133 0240 AA        		.byte	-86
 4134 0241 AA        		.byte	-86
 4135 0242 5A        		.byte	90
 4136 0243 A9        		.byte	-87
 4137 0244 AA        		.byte	-86
 4138 0245 AA        		.byte	-86
 4139 0246 5A        		.byte	90
 4140 0247 A5        		.byte	-91
 4141 0248 AA        		.byte	-86
 4142 0249 AA        		.byte	-86
 4143 024a 56        		.byte	86
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 208


 4144 024b 54        		.byte	84
 4145 024c 55        		.byte	85
 4146 024d 55        		.byte	85
 4147 024e 15        		.byte	21
 4148               	.global	spriteFROG
 4149               		.type	spriteFROG, @object
 4150               		.size	spriteFROG, 19
 4151               	spriteFROG:
 4152 024f 0000      		.word	pgm_imageFROG
 4153 0251 0000      		.word	0
 4154 0253 0000      		.word	pgm_paletteFROG
 4155 0255 01        		.byte	1
 4156 0256 28        		.byte	40
 4157 0257 0000      		.word	0
 4158 0259 0000      		.word	DefaultMotion
 4159 025b 0000      		.word	DefaultLayer
 4160 025d 0000      		.word	DefaultCamMotion
 4161 025f 0000      		.word	0
 4162 0261 01        		.byte	1
 4163               		.type	pgm_paletteFROG, @object
 4164               		.size	pgm_paletteFROG, 4
 4165               	pgm_paletteFROG:
 4166 0262 25        		.byte	37
 4167 0263 00        		.byte	0
 4168 0264 0C        		.byte	12
 4169 0265 2F        		.byte	47
 4170               		.type	pgm_imageFROG, @object
 4171               		.size	pgm_imageFROG, 64
 4172               	pgm_imageFROG:
 4173 0266 40        		.byte	64
 4174 0267 05        		.byte	5
 4175 0268 50        		.byte	80
 4176 0269 01        		.byte	1
 4177 026a 90        		.byte	-112
 4178 026b 1A        		.byte	26
 4179 026c A4        		.byte	-92
 4180 026d 06        		.byte	6
 4181 026e 90        		.byte	-112
 4182 026f 55        		.byte	85
 4183 0270 55        		.byte	85
 4184 0271 06        		.byte	6
 4185 0272 94        		.byte	-108
 4186 0273 A5        		.byte	-91
 4187 0274 5A        		.byte	90
 4188 0275 16        		.byte	22
 4189 0276 A9        		.byte	-87
 4190 0277 AA        		.byte	-86
 4191 0278 AA        		.byte	-86
 4192 0279 6A        		.byte	106
 4193 027a A9        		.byte	-87
 4194 027b 9A        		.byte	-102
 4195 027c A6        		.byte	-90
 4196 027d 6A        		.byte	106
 4197 027e A9        		.byte	-87
 4198 027f AA        		.byte	-86
 4199 0280 AA        		.byte	-86
 4200 0281 6A        		.byte	106
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 209


 4201 0282 94        		.byte	-108
 4202 0283 AA        		.byte	-86
 4203 0284 AA        		.byte	-86
 4204 0285 16        		.byte	22
 4205 0286 40        		.byte	64
 4206 0287 A9        		.byte	-87
 4207 0288 6A        		.byte	106
 4208 0289 01        		.byte	1
 4209 028a 94        		.byte	-108
 4210 028b 55        		.byte	85
 4211 028c 55        		.byte	85
 4212 028d 16        		.byte	22
 4213 028e 69        		.byte	105
 4214 028f AA        		.byte	-86
 4215 0290 AA        		.byte	-86
 4216 0291 69        		.byte	105
 4217 0292 A9        		.byte	-87
 4218 0293 99        		.byte	-103
 4219 0294 66        		.byte	102
 4220 0295 6A        		.byte	106
 4221 0296 99        		.byte	-103
 4222 0297 99        		.byte	-103
 4223 0298 66        		.byte	102
 4224 0299 66        		.byte	102
 4225 029a 69        		.byte	105
 4226 029b 99        		.byte	-103
 4227 029c 66        		.byte	102
 4228 029d 69        		.byte	105
 4229 029e 94        		.byte	-108
 4230 029f 59        		.byte	89
 4231 02a0 65        		.byte	101
 4232 02a1 16        		.byte	22
 4233 02a2 A9        		.byte	-87
 4234 02a3 69        		.byte	105
 4235 02a4 69        		.byte	105
 4236 02a5 6A        		.byte	106
 4237               	.global	spriteTANOOKI
 4238               		.type	spriteTANOOKI, @object
 4239               		.size	spriteTANOOKI, 19
 4240               	spriteTANOOKI:
 4241 02a6 0000      		.word	pgm_imageTANOOKI
 4242 02a8 0000      		.word	0
 4243 02aa 0000      		.word	pgm_paletteTANOOKI
 4244 02ac 01        		.byte	1
 4245 02ad 28        		.byte	40
 4246 02ae 0000      		.word	0
 4247 02b0 0000      		.word	DefaultMotion
 4248 02b2 0000      		.word	DefaultLayer
 4249 02b4 0000      		.word	DefaultCamMotion
 4250 02b6 0000      		.word	0
 4251 02b8 01        		.byte	1
 4252               		.type	pgm_paletteTANOOKI, @object
 4253               		.size	pgm_paletteTANOOKI, 4
 4254               	pgm_paletteTANOOKI:
 4255 02b9 25        		.byte	37
 4256 02ba 00        		.byte	0
 4257 02bb 02        		.byte	2
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 210


 4258 02bc 2F        		.byte	47
 4259               		.type	pgm_imageTANOOKI, @object
 4260               		.size	pgm_imageTANOOKI, 64
 4261               	pgm_imageTANOOKI:
 4262 02bd 00        		.byte	0
 4263 02be 05        		.byte	5
 4264 02bf 50        		.byte	80
 4265 02c0 00        		.byte	0
 4266 02c1 40        		.byte	64
 4267 02c2 5F        		.byte	95
 4268 02c3 F5        		.byte	-11
 4269 02c4 01        		.byte	1
 4270 02c5 40        		.byte	64
 4271 02c6 AA        		.byte	-86
 4272 02c7 AA        		.byte	-86
 4273 02c8 01        		.byte	1
 4274 02c9 90        		.byte	-112
 4275 02ca 76        		.byte	118
 4276 02cb 9D        		.byte	-99
 4277 02cc 06        		.byte	6
 4278 02cd 90        		.byte	-112
 4279 02ce 75        		.byte	117
 4280 02cf 5D        		.byte	93
 4281 02d0 06        		.byte	6
 4282 02d1 90        		.byte	-112
 4283 02d2 56        		.byte	86
 4284 02d3 95        		.byte	-107
 4285 02d4 06        		.byte	6
 4286 02d5 40        		.byte	64
 4287 02d6 6A        		.byte	106
 4288 02d7 A9        		.byte	-87
 4289 02d8 01        		.byte	1
 4290 02d9 00        		.byte	0
 4291 02da A5        		.byte	-91
 4292 02db 5A        		.byte	90
 4293 02dc 00        		.byte	0
 4294 02dd 50        		.byte	80
 4295 02de AA        		.byte	-86
 4296 02df AA        		.byte	-86
 4297 02e0 05        		.byte	5
 4298 02e1 A4        		.byte	-92
 4299 02e2 FA        		.byte	-6
 4300 02e3 AF        		.byte	-81
 4301 02e4 1A        		.byte	26
 4302 02e5 A9        		.byte	-87
 4303 02e6 FE        		.byte	-2
 4304 02e7 BF        		.byte	-65
 4305 02e8 6A        		.byte	106
 4306 02e9 69        		.byte	105
 4307 02ea FE        		.byte	-2
 4308 02eb BF        		.byte	-65
 4309 02ec 69        		.byte	105
 4310 02ed 7D        		.byte	125
 4311 02ee FA        		.byte	-6
 4312 02ef AF        		.byte	-81
 4313 02f0 7D        		.byte	125
 4314 02f1 54        		.byte	84
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 211


 4315 02f2 AA        		.byte	-86
 4316 02f3 AA        		.byte	-86
 4317 02f4 15        		.byte	21
 4318 02f5 40        		.byte	64
 4319 02f6 7F        		.byte	127
 4320 02f7 FD        		.byte	-3
 4321 02f8 01        		.byte	1
 4322 02f9 00        		.byte	0
 4323 02fa 55        		.byte	85
 4324 02fb 55        		.byte	85
 4325 02fc 00        		.byte	0
 4326               	.global	spriteLEAF
 4327               		.type	spriteLEAF, @object
 4328               		.size	spriteLEAF, 19
 4329               	spriteLEAF:
 4330 02fd 0000      		.word	pgm_imageLEAF
 4331 02ff 0000      		.word	0
 4332 0301 0000      		.word	pgm_paletteLEAF
 4333 0303 01        		.byte	1
 4334 0304 30        		.byte	48
 4335 0305 0000      		.word	LeafFlip
 4336 0307 0000      		.word	LeafMotion
 4337 0309 0000      		.word	LeafLayer
 4338 030b 0000      		.word	LeafCamMotion
 4339 030d 0000      		.word	0
 4340 030f 01        		.byte	1
 4341               	.global	LeafCamMotion
 4342               		.type	LeafCamMotion, @object
 4343               		.size	LeafCamMotion, 6
 4344               	LeafCamMotion:
 4345 0310 00        		.byte	0
 4346 0311 0000      		.word	0
 4347 0313 00        		.byte	0
 4348 0314 0000      		.word	LeafCamY
 4349               	.global	LeafCamY
 4350               		.type	LeafCamY, @object
 4351               		.size	LeafCamY, 12
 4352               	LeafCamY:
 4353 0316 55        		.byte	85
 4354 0317 55        		.byte	85
 4355 0318 55        		.byte	85
 4356 0319 55        		.byte	85
 4357 031a 57        		.byte	87
 4358 031b 55        		.byte	85
 4359 031c 55        		.byte	85
 4360 031d 44        		.byte	68
 4361 031e 44        		.byte	68
 4362 031f 04        		.byte	4
 4363 0320 00        		.byte	0
 4364 0321 00        		.byte	0
 4365               	.global	LeafMotion
 4366               		.type	LeafMotion, @object
 4367               		.size	LeafMotion, 6
 4368               	LeafMotion:
 4369 0322 00        		.byte	0
 4370 0323 0000      		.word	LeafX
 4371 0325 F0        		.byte	-16
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 212


 4372 0326 0000      		.word	LeafY
 4373               	.global	LeafY
 4374               		.type	LeafY, @object
 4375               		.size	LeafY, 12
 4376               	LeafY:
 4377 0328 AA        		.byte	-86
 4378 0329 AA        		.byte	-86
 4379 032a AA        		.byte	-86
 4380 032b AA        		.byte	-86
 4381 032c 57        		.byte	87
 4382 032d 55        		.byte	85
 4383 032e 55        		.byte	85
 4384 032f 55        		.byte	85
 4385 0330 55        		.byte	85
 4386 0331 55        		.byte	85
 4387 0332 55        		.byte	85
 4388 0333 55        		.byte	85
 4389               	.global	LeafX
 4390               		.type	LeafX, @object
 4391               		.size	LeafX, 12
 4392               	LeafX:
 4393 0334 00        		.byte	0
 4394 0335 00        		.byte	0
 4395 0336 00        		.byte	0
 4396 0337 00        		.byte	0
 4397 0338 EA        		.byte	-22
 4398 0339 AA        		.byte	-86
 4399 033a EA        		.byte	-22
 4400 033b AA        		.byte	-86
 4401 033c EA        		.byte	-22
 4402 033d AA        		.byte	-86
 4403 033e EA        		.byte	-22
 4404 033f AA        		.byte	-86
 4405               	.global	LeafLayer
 4406               		.type	LeafLayer, @object
 4407               		.size	LeafLayer, 6
 4408               	LeafLayer:
 4409 0340 FF        		.byte	-1
 4410 0341 FF        		.byte	-1
 4411 0342 00        		.byte	0
 4412 0343 00        		.byte	0
 4413 0344 00        		.byte	0
 4414 0345 00        		.byte	0
 4415               	.global	LeafFlip
 4416               		.type	LeafFlip, @object
 4417               		.size	LeafFlip, 6
 4418               	LeafFlip:
 4419 0346 00        		.byte	0
 4420 0347 00        		.byte	0
 4421 0348 F8        		.byte	-8
 4422 0349 07        		.byte	7
 4423 034a F8        		.byte	-8
 4424 034b 07        		.byte	7
 4425               		.type	pgm_paletteLEAF, @object
 4426               		.size	pgm_paletteLEAF, 4
 4427               	pgm_paletteLEAF:
 4428 034c 25        		.byte	37
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 213


 4429 034d 02        		.byte	2
 4430 034e 00        		.byte	0
 4431 034f 00        		.byte	0
 4432               		.type	pgm_imageLEAF, @object
 4433               		.size	pgm_imageLEAF, 64
 4434               	pgm_imageLEAF:
 4435 0350 00        		.byte	0
 4436 0351 00        		.byte	0
 4437 0352 00        		.byte	0
 4438 0353 00        		.byte	0
 4439 0354 00        		.byte	0
 4440 0355 00        		.byte	0
 4441 0356 00        		.byte	0
 4442 0357 A0        		.byte	-96
 4443 0358 00        		.byte	0
 4444 0359 00        		.byte	0
 4445 035a 00        		.byte	0
 4446 035b 98        		.byte	-104
 4447 035c 00        		.byte	0
 4448 035d 00        		.byte	0
 4449 035e 00        		.byte	0
 4450 035f 98        		.byte	-104
 4451 0360 00        		.byte	0
 4452 0361 00        		.byte	0
 4453 0362 A8        		.byte	-88
 4454 0363 A6        		.byte	-90
 4455 0364 00        		.byte	0
 4456 0365 80        		.byte	-128
 4457 0366 56        		.byte	86
 4458 0367 2B        		.byte	43
 4459 0368 00        		.byte	0
 4460 0369 68        		.byte	104
 4461 036a F5        		.byte	-11
 4462 036b 95        		.byte	-107
 4463 036c 00        		.byte	0
 4464 036d 56        		.byte	86
 4465 036e 7F        		.byte	127
 4466 036f 95        		.byte	-107
 4467 0370 80        		.byte	-128
 4468 0371 FD        		.byte	-3
 4469 0372 75        		.byte	117
 4470 0373 95        		.byte	-107
 4471 0374 E0        		.byte	-32
 4472 0375 77        		.byte	119
 4473 0376 75        		.byte	117
 4474 0377 25        		.byte	37
 4475 0378 7A        		.byte	122
 4476 0379 75        		.byte	117
 4477 037a 5D        		.byte	93
 4478 037b 25        		.byte	37
 4479 037c 56        		.byte	86
 4480 037d 5D        		.byte	93
 4481 037e 55        		.byte	85
 4482 037f 09        		.byte	9
 4483 0380 68        		.byte	104
 4484 0381 55        		.byte	85
 4485 0382 55        		.byte	85
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 214


 4486 0383 02        		.byte	2
 4487 0384 A0        		.byte	-96
 4488 0385 56        		.byte	86
 4489 0386 A5        		.byte	-91
 4490 0387 02        		.byte	2
 4491 0388 00        		.byte	0
 4492 0389 AA        		.byte	-86
 4493 038a 2A        		.byte	42
 4494 038b 00        		.byte	0
 4495 038c 00        		.byte	0
 4496 038d 00        		.byte	0
 4497 038e 00        		.byte	0
 4498 038f 00        		.byte	0
 4499               	.global	spriteSOLIDBUMP3
 4500               		.type	spriteSOLIDBUMP3, @object
 4501               		.size	spriteSOLIDBUMP3, 19
 4502               	spriteSOLIDBUMP3:
 4503 0390 0000      		.word	pgm_imageSOLID3
 4504 0392 0000      		.word	0
 4505 0394 0000      		.word	pgm_paletteQUESTION3
 4506 0396 01        		.byte	1
 4507 0397 03        		.byte	3
 4508 0398 0000      		.word	0
 4509 039a 0000      		.word	SolidBumpMotion
 4510 039c 0000      		.word	DefaultLayer
 4511 039e 0000      		.word	NadaMotion
 4512 03a0 0000      		.word	0
 4513 03a2 01        		.byte	1
 4514               	.global	spriteSOLID3
 4515               		.type	spriteSOLID3, @object
 4516               		.size	spriteSOLID3, 19
 4517               	spriteSOLID3:
 4518 03a3 0000      		.word	pgm_imageSOLID3
 4519 03a5 0000      		.word	0
 4520 03a7 0000      		.word	pgm_paletteQUESTION3
 4521 03a9 01        		.byte	1
 4522 03aa 08        		.byte	8
 4523 03ab 0000      		.word	0
 4524 03ad 0000      		.word	NadaMotion
 4525 03af 0000      		.word	0
 4526 03b1 0000      		.word	NadaMotion
 4527 03b3 0000      		.word	0
 4528 03b5 01        		.byte	1
 4529               		.type	pgm_imageSOLID3, @object
 4530               		.size	pgm_imageSOLID3, 64
 4531               	pgm_imageSOLID3:
 4532 03b6 55        		.byte	85
 4533 03b7 55        		.byte	85
 4534 03b8 55        		.byte	85
 4535 03b9 55        		.byte	85
 4536 03ba FD        		.byte	-3
 4537 03bb FF        		.byte	-1
 4538 03bc FF        		.byte	-1
 4539 03bd 7F        		.byte	127
 4540 03be DD        		.byte	-35
 4541 03bf FF        		.byte	-1
 4542 03c0 FF        		.byte	-1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 215


 4543 03c1 77        		.byte	119
 4544 03c2 FD        		.byte	-3
 4545 03c3 FF        		.byte	-1
 4546 03c4 FF        		.byte	-1
 4547 03c5 7F        		.byte	127
 4548 03c6 FD        		.byte	-3
 4549 03c7 FF        		.byte	-1
 4550 03c8 FF        		.byte	-1
 4551 03c9 7F        		.byte	127
 4552 03ca FD        		.byte	-3
 4553 03cb FF        		.byte	-1
 4554 03cc FF        		.byte	-1
 4555 03cd 7F        		.byte	127
 4556 03ce FD        		.byte	-3
 4557 03cf FF        		.byte	-1
 4558 03d0 FF        		.byte	-1
 4559 03d1 7F        		.byte	127
 4560 03d2 FD        		.byte	-3
 4561 03d3 FF        		.byte	-1
 4562 03d4 FF        		.byte	-1
 4563 03d5 7F        		.byte	127
 4564 03d6 FD        		.byte	-3
 4565 03d7 FF        		.byte	-1
 4566 03d8 FF        		.byte	-1
 4567 03d9 7F        		.byte	127
 4568 03da FD        		.byte	-3
 4569 03db FF        		.byte	-1
 4570 03dc FF        		.byte	-1
 4571 03dd 7F        		.byte	127
 4572 03de FD        		.byte	-3
 4573 03df FF        		.byte	-1
 4574 03e0 FF        		.byte	-1
 4575 03e1 7F        		.byte	127
 4576 03e2 FD        		.byte	-3
 4577 03e3 FF        		.byte	-1
 4578 03e4 FF        		.byte	-1
 4579 03e5 7F        		.byte	127
 4580 03e6 FD        		.byte	-3
 4581 03e7 FF        		.byte	-1
 4582 03e8 FF        		.byte	-1
 4583 03e9 7F        		.byte	127
 4584 03ea DD        		.byte	-35
 4585 03eb FF        		.byte	-1
 4586 03ec FF        		.byte	-1
 4587 03ed 77        		.byte	119
 4588 03ee FD        		.byte	-3
 4589 03ef FF        		.byte	-1
 4590 03f0 FF        		.byte	-1
 4591 03f1 7F        		.byte	127
 4592 03f2 55        		.byte	85
 4593 03f3 55        		.byte	85
 4594 03f4 55        		.byte	85
 4595 03f5 55        		.byte	85
 4596               	.global	spriteLUIGIRUNS
 4597               		.type	spriteLUIGIRUNS, @object
 4598               		.size	spriteLUIGIRUNS, 19
 4599               	spriteLUIGIRUNS:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 216


 4600 03f6 0000      		.word	pgm_imageMARIORUNS
 4601 03f8 0000      		.word	0
 4602 03fa 0000      		.word	pgm_paletteLUIGI
 4603 03fc 01        		.byte	1
 4604 03fd 18        		.byte	24
 4605 03fe 0000      		.word	LuigiRunsFlip
 4606 0400 0000      		.word	LuigiRunsMotion
 4607 0402 0000      		.word	DefaultLayer+2
 4608 0404 0000      		.word	MarioRunsCamMotion
 4609 0406 0000      		.word	0
 4610 0408 03        		.byte	3
 4611               	.global	LuigiRunsFlip
 4612               		.type	LuigiRunsFlip, @object
 4613               		.size	LuigiRunsFlip, 3
 4614               	LuigiRunsFlip:
 4615 0409 FF        		.byte	-1
 4616 040a FF        		.byte	-1
 4617 040b FF        		.byte	-1
 4618               	.global	LuigiRunsMotion
 4619               		.type	LuigiRunsMotion, @object
 4620               		.size	LuigiRunsMotion, 6
 4621               	LuigiRunsMotion:
 4622 040c 00        		.byte	0
 4623 040d 0000      		.word	LuigiRunsX
 4624 040f 10        		.byte	16
 4625 0410 0000      		.word	DefaultY+4
 4626               	.global	LuigiRunsX
 4627               		.type	LuigiRunsX, @object
 4628               		.size	LuigiRunsX, 6
 4629               	LuigiRunsX:
 4630 0412 AB        		.byte	-85
 4631 0413 AA        		.byte	-86
 4632 0414 02        		.byte	2
 4633 0415 00        		.byte	0
 4634 0416 00        		.byte	0
 4635 0417 00        		.byte	0
 4636               	.global	spriteMARIORUNS
 4637               		.type	spriteMARIORUNS, @object
 4638               		.size	spriteMARIORUNS, 19
 4639               	spriteMARIORUNS:
 4640 0418 0000      		.word	pgm_imageMARIORUNS
 4641 041a 0000      		.word	0
 4642 041c 0000      		.word	pgm_paletteMARIO
 4643 041e 01        		.byte	1
 4644 041f 18        		.byte	24
 4645 0420 0000      		.word	0
 4646 0422 0000      		.word	MarioRunsMotion
 4647 0424 0000      		.word	DefaultLayer+2
 4648 0426 0000      		.word	MarioRunsCamMotion
 4649 0428 0000      		.word	0
 4650 042a 03        		.byte	3
 4651               	.global	MarioRunsCamMotion
 4652               		.type	MarioRunsCamMotion, @object
 4653               		.size	MarioRunsCamMotion, 6
 4654               	MarioRunsCamMotion:
 4655 042b 00        		.byte	0
 4656 042c 0000      		.word	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 217


 4657 042e 10        		.byte	16
 4658 042f 0000      		.word	DefaultCamY+4
 4659               	.global	MarioRunsMotion
 4660               		.type	MarioRunsMotion, @object
 4661               		.size	MarioRunsMotion, 6
 4662               	MarioRunsMotion:
 4663 0431 00        		.byte	0
 4664 0432 0000      		.word	MarioRunsX
 4665 0434 10        		.byte	16
 4666 0435 0000      		.word	DefaultY+4
 4667               	.global	MarioRunsX
 4668               		.type	MarioRunsX, @object
 4669               		.size	MarioRunsX, 6
 4670               	MarioRunsX:
 4671 0437 AA        		.byte	-86
 4672 0438 AA        		.byte	-86
 4673 0439 00        		.byte	0
 4674 043a 00        		.byte	0
 4675 043b 00        		.byte	0
 4676 043c 00        		.byte	0
 4677               		.type	pgm_imageMARIORUNS, @object
 4678               		.size	pgm_imageMARIORUNS, 192
 4679               	pgm_imageMARIORUNS:
 4680 043d 00        		.byte	0
 4681 043e 00        		.byte	0
 4682 043f 00        		.byte	0
 4683 0440 00        		.byte	0
 4684 0441 00        		.byte	0
 4685 0442 A8        		.byte	-88
 4686 0443 0A        		.byte	10
 4687 0444 00        		.byte	0
 4688 0445 00        		.byte	0
 4689 0446 AA        		.byte	-86
 4690 0447 AA        		.byte	-86
 4691 0448 02        		.byte	2
 4692 0449 00        		.byte	0
 4693 044a D5        		.byte	-43
 4694 044b 37        		.byte	55
 4695 044c 00        		.byte	0
 4696 044d 40        		.byte	64
 4697 044e F7        		.byte	-9
 4698 044f F7        		.byte	-9
 4699 0450 03        		.byte	3
 4700 0451 40        		.byte	64
 4701 0452 D7        		.byte	-41
 4702 0453 DF        		.byte	-33
 4703 0454 0F        		.byte	15
 4704 0455 40        		.byte	64
 4705 0456 FD        		.byte	-3
 4706 0457 57        		.byte	87
 4707 0458 01        		.byte	1
 4708 0459 00        		.byte	0
 4709 045a FC        		.byte	-4
 4710 045b FF        		.byte	-1
 4711 045c 00        		.byte	0
 4712 045d 00        		.byte	0
 4713 045e 55        		.byte	85
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 218


 4714 045f C6        		.byte	-58
 4715 0460 00        		.byte	0
 4716 0461 C0        		.byte	-64
 4717 0462 55        		.byte	85
 4718 0463 F5        		.byte	-11
 4719 0464 03        		.byte	3
 4720 0465 F0        		.byte	-16
 4721 0466 56        		.byte	86
 4722 0467 F5        		.byte	-11
 4723 0468 00        		.byte	0
 4724 0469 50        		.byte	80
 4725 046a AA        		.byte	-86
 4726 046b 2A        		.byte	42
 4727 046c 00        		.byte	0
 4728 046d 90        		.byte	-112
 4729 046e AA        		.byte	-86
 4730 046f 2A        		.byte	42
 4731 0470 00        		.byte	0
 4732 0471 94        		.byte	-108
 4733 0472 8A        		.byte	-118
 4734 0473 0A        		.byte	10
 4735 0474 00        		.byte	0
 4736 0475 04        		.byte	4
 4737 0476 50        		.byte	80
 4738 0477 01        		.byte	1
 4739 0478 00        		.byte	0
 4740 0479 00        		.byte	0
 4741 047a 50        		.byte	80
 4742 047b 05        		.byte	5
 4743 047c 00        		.byte	0
 4744 047d 00        		.byte	0
 4745 047e A8        		.byte	-88
 4746 047f 0A        		.byte	10
 4747 0480 00        		.byte	0
 4748 0481 00        		.byte	0
 4749 0482 AA        		.byte	-86
 4750 0483 AA        		.byte	-86
 4751 0484 02        		.byte	2
 4752 0485 00        		.byte	0
 4753 0486 D5        		.byte	-43
 4754 0487 37        		.byte	55
 4755 0488 00        		.byte	0
 4756 0489 40        		.byte	64
 4757 048a F7        		.byte	-9
 4758 048b F7        		.byte	-9
 4759 048c 03        		.byte	3
 4760 048d 40        		.byte	64
 4761 048e D7        		.byte	-41
 4762 048f DF        		.byte	-33
 4763 0490 0F        		.byte	15
 4764 0491 40        		.byte	64
 4765 0492 FD        		.byte	-3
 4766 0493 57        		.byte	87
 4767 0494 01        		.byte	1
 4768 0495 00        		.byte	0
 4769 0496 FC        		.byte	-4
 4770 0497 FF        		.byte	-1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 219


 4771 0498 00        		.byte	0
 4772 0499 50        		.byte	80
 4773 049a A5        		.byte	-91
 4774 049b 05        		.byte	5
 4775 049c 00        		.byte	0
 4776 049d 5F        		.byte	95
 4777 049e A5        		.byte	-91
 4778 049f 56        		.byte	86
 4779 04a0 3F        		.byte	63
 4780 04a1 3F        		.byte	63
 4781 04a2 E5        		.byte	-27
 4782 04a3 6A        		.byte	106
 4783 04a4 3D        		.byte	61
 4784 04a5 0F        		.byte	15
 4785 04a6 AA        		.byte	-86
 4786 04a7 2A        		.byte	42
 4787 04a8 04        		.byte	4
 4788 04a9 80        		.byte	-128
 4789 04aa AA        		.byte	-86
 4790 04ab AA        		.byte	-86
 4791 04ac 05        		.byte	5
 4792 04ad A0        		.byte	-96
 4793 04ae AA        		.byte	-86
 4794 04af AA        		.byte	-86
 4795 04b0 05        		.byte	5
 4796 04b1 94        		.byte	-108
 4797 04b2 0A        		.byte	10
 4798 04b3 A8        		.byte	-88
 4799 04b4 05        		.byte	5
 4800 04b5 54        		.byte	84
 4801 04b6 00        		.byte	0
 4802 04b7 00        		.byte	0
 4803 04b8 00        		.byte	0
 4804 04b9 50        		.byte	80
 4805 04ba 01        		.byte	1
 4806 04bb 00        		.byte	0
 4807 04bc 00        		.byte	0
 4808 04bd 00        		.byte	0
 4809 04be A8        		.byte	-88
 4810 04bf 0A        		.byte	10
 4811 04c0 00        		.byte	0
 4812 04c1 00        		.byte	0
 4813 04c2 AA        		.byte	-86
 4814 04c3 AA        		.byte	-86
 4815 04c4 02        		.byte	2
 4816 04c5 00        		.byte	0
 4817 04c6 D5        		.byte	-43
 4818 04c7 37        		.byte	55
 4819 04c8 00        		.byte	0
 4820 04c9 40        		.byte	64
 4821 04ca F7        		.byte	-9
 4822 04cb F7        		.byte	-9
 4823 04cc 03        		.byte	3
 4824 04cd 40        		.byte	64
 4825 04ce D7        		.byte	-41
 4826 04cf DF        		.byte	-33
 4827 04d0 0F        		.byte	15
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 220


 4828 04d1 40        		.byte	64
 4829 04d2 FD        		.byte	-3
 4830 04d3 57        		.byte	87
 4831 04d4 01        		.byte	1
 4832 04d5 00        		.byte	0
 4833 04d6 FC        		.byte	-4
 4834 04d7 FF        		.byte	-1
 4835 04d8 00        		.byte	0
 4836 04d9 00        		.byte	0
 4837 04da 65        		.byte	101
 4838 04db 05        		.byte	5
 4839 04dc 00        		.byte	0
 4840 04dd 40        		.byte	64
 4841 04de 95        		.byte	-107
 4842 04df 16        		.byte	22
 4843 04e0 00        		.byte	0
 4844 04e1 40        		.byte	64
 4845 04e2 A5        		.byte	-91
 4846 04e3 EB        		.byte	-21
 4847 04e4 00        		.byte	0
 4848 04e5 40        		.byte	64
 4849 04e6 95        		.byte	-107
 4850 04e7 AA        		.byte	-86
 4851 04e8 00        		.byte	0
 4852 04e9 80        		.byte	-128
 4853 04ea F5        		.byte	-11
 4854 04eb AB        		.byte	-85
 4855 04ec 00        		.byte	0
 4856 04ed 00        		.byte	0
 4857 04ee F6        		.byte	-10
 4858 04ef 2A        		.byte	42
 4859 04f0 00        		.byte	0
 4860 04f1 00        		.byte	0
 4861 04f2 A8        		.byte	-88
 4862 04f3 15        		.byte	21
 4863 04f4 00        		.byte	0
 4864 04f5 00        		.byte	0
 4865 04f6 54        		.byte	84
 4866 04f7 55        		.byte	85
 4867 04f8 00        		.byte	0
 4868 04f9 00        		.byte	0
 4869 04fa 54        		.byte	84
 4870 04fb 01        		.byte	1
 4871 04fc 00        		.byte	0
 4872               	.global	spriteLUIGI
 4873               		.type	spriteLUIGI, @object
 4874               		.size	spriteLUIGI, 19
 4875               	spriteLUIGI:
 4876 04fd 0000      		.word	pgm_imageMARIO
 4877 04ff 0000      		.word	0
 4878 0501 0000      		.word	pgm_paletteLUIGI
 4879 0503 01        		.byte	1
 4880 0504 10        		.byte	16
 4881 0505 0000      		.word	0
 4882 0507 0000      		.word	DefaultMotion
 4883 0509 0000      		.word	DefaultLayer
 4884 050b 0000      		.word	DefaultCamMotion
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 221


 4885 050d 0000      		.word	0
 4886 050f 01        		.byte	1
 4887               		.type	pgm_paletteLUIGI, @object
 4888               		.size	pgm_paletteLUIGI, 4
 4889               	pgm_paletteLUIGI:
 4890 0510 25        		.byte	37
 4891 0511 04        		.byte	4
 4892 0512 2F        		.byte	47
 4893 0513 07        		.byte	7
 4894               	.global	spriteMARIO
 4895               		.type	spriteMARIO, @object
 4896               		.size	spriteMARIO, 19
 4897               	spriteMARIO:
 4898 0514 0000      		.word	pgm_imageMARIO
 4899 0516 0000      		.word	0
 4900 0518 0000      		.word	pgm_paletteMARIO
 4901 051a 01        		.byte	1
 4902 051b 10        		.byte	16
 4903 051c 0000      		.word	0
 4904 051e 0000      		.word	DefaultMotion
 4905 0520 0000      		.word	DefaultLayer
 4906 0522 0000      		.word	DefaultCamMotion
 4907 0524 0000      		.word	0
 4908 0526 01        		.byte	1
 4909               		.type	pgm_paletteMARIO, @object
 4910               		.size	pgm_paletteMARIO, 4
 4911               	pgm_paletteMARIO:
 4912 0527 25        		.byte	37
 4913 0528 05        		.byte	5
 4914 0529 02        		.byte	2
 4915 052a 07        		.byte	7
 4916               		.type	pgm_imageMARIO, @object
 4917               		.size	pgm_imageMARIO, 64
 4918               	pgm_imageMARIO:
 4919 052b 00        		.byte	0
 4920 052c A8        		.byte	-88
 4921 052d 0A        		.byte	10
 4922 052e 00        		.byte	0
 4923 052f 00        		.byte	0
 4924 0530 AA        		.byte	-86
 4925 0531 AA        		.byte	-86
 4926 0532 02        		.byte	2
 4927 0533 00        		.byte	0
 4928 0534 D5        		.byte	-43
 4929 0535 37        		.byte	55
 4930 0536 00        		.byte	0
 4931 0537 40        		.byte	64
 4932 0538 F7        		.byte	-9
 4933 0539 F7        		.byte	-9
 4934 053a 03        		.byte	3
 4935 053b 40        		.byte	64
 4936 053c D7        		.byte	-41
 4937 053d DF        		.byte	-33
 4938 053e 0F        		.byte	15
 4939 053f 40        		.byte	64
 4940 0540 FD        		.byte	-3
 4941 0541 57        		.byte	87
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 222


 4942 0542 01        		.byte	1
 4943 0543 00        		.byte	0
 4944 0544 FC        		.byte	-4
 4945 0545 FF        		.byte	-1
 4946 0546 00        		.byte	0
 4947 0547 00        		.byte	0
 4948 0548 65        		.byte	101
 4949 0549 05        		.byte	5
 4950 054a 00        		.byte	0
 4951 054b 40        		.byte	64
 4952 054c 65        		.byte	101
 4953 054d 59        		.byte	89
 4954 054e 01        		.byte	1
 4955 054f 50        		.byte	80
 4956 0550 A5        		.byte	-91
 4957 0551 5A        		.byte	90
 4958 0552 05        		.byte	5
 4959 0553 F0        		.byte	-16
 4960 0554 B9        		.byte	-71
 4961 0555 6E        		.byte	110
 4962 0556 0F        		.byte	15
 4963 0557 F0        		.byte	-16
 4964 0558 AB        		.byte	-85
 4965 0559 EA        		.byte	-22
 4966 055a 0F        		.byte	15
 4967 055b F0        		.byte	-16
 4968 055c AA        		.byte	-86
 4969 055d AA        		.byte	-86
 4970 055e 0F        		.byte	15
 4971 055f 00        		.byte	0
 4972 0560 2A        		.byte	42
 4973 0561 A8        		.byte	-88
 4974 0562 00        		.byte	0
 4975 0563 40        		.byte	64
 4976 0564 05        		.byte	5
 4977 0565 50        		.byte	80
 4978 0566 01        		.byte	1
 4979 0567 50        		.byte	80
 4980 0568 05        		.byte	5
 4981 0569 50        		.byte	80
 4982 056a 05        		.byte	5
 4983               	.global	spriteCLOUD
 4984               		.type	spriteCLOUD, @object
 4985               		.size	spriteCLOUD, 19
 4986               	spriteCLOUD:
 4987 056b 0000      		.word	pgm_imageCLOUD
 4988 056d 0000      		.word	0
 4989 056f 0000      		.word	pgm_paletteCLOUD
 4990 0571 01        		.byte	1
 4991 0572 28        		.byte	40
 4992 0573 0000      		.word	0
 4993 0575 0000      		.word	CoinMotion
 4994 0577 0000      		.word	DefaultLayer
 4995 0579 0000      		.word	DefaultCamMotion
 4996 057b 0000      		.word	0
 4997 057d 01        		.byte	1
 4998               		.type	pgm_paletteCLOUD, @object
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 223


 4999               		.size	pgm_paletteCLOUD, 4
 5000               	pgm_paletteCLOUD:
 5001 057e 25        		.byte	37
 5002 057f 2F        		.byte	47
 5003 0580 00        		.byte	0
 5004 0581 2A        		.byte	42
 5005               		.type	pgm_imageCLOUD, @object
 5006               		.size	pgm_imageCLOUD, 64
 5007               	pgm_imageCLOUD:
 5008 0582 80        		.byte	-128
 5009 0583 AA        		.byte	-86
 5010 0584 AA        		.byte	-86
 5011 0585 02        		.byte	2
 5012 0586 60        		.byte	96
 5013 0587 55        		.byte	85
 5014 0588 55        		.byte	85
 5015 0589 0B        		.byte	11
 5016 058a 58        		.byte	88
 5017 058b 55        		.byte	85
 5018 058c 55        		.byte	85
 5019 058d 2D        		.byte	45
 5020 058e 58        		.byte	88
 5021 058f 55        		.byte	85
 5022 0590 55        		.byte	85
 5023 0591 2D        		.byte	45
 5024 0592 58        		.byte	88
 5025 0593 55        		.byte	85
 5026 0594 55        		.byte	85
 5027 0595 2D        		.byte	45
 5028 0596 56        		.byte	86
 5029 0597 65        		.byte	101
 5030 0598 59        		.byte	89
 5031 0599 B5        		.byte	-75
 5032 059a 56        		.byte	86
 5033 059b 65        		.byte	101
 5034 059c 59        		.byte	89
 5035 059d B5        		.byte	-75
 5036 059e 56        		.byte	86
 5037 059f 65        		.byte	101
 5038 05a0 59        		.byte	89
 5039 05a1 B5        		.byte	-75
 5040 05a2 56        		.byte	86
 5041 05a3 55        		.byte	85
 5042 05a4 55        		.byte	85
 5043 05a5 B5        		.byte	-75
 5044 05a6 56        		.byte	86
 5045 05a7 55        		.byte	85
 5046 05a8 55        		.byte	85
 5047 05a9 B5        		.byte	-75
 5048 05aa 56        		.byte	86
 5049 05ab 59        		.byte	89
 5050 05ac 65        		.byte	101
 5051 05ad B5        		.byte	-75
 5052 05ae 58        		.byte	88
 5053 05af A5        		.byte	-91
 5054 05b0 5A        		.byte	90
 5055 05b1 2D        		.byte	45
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 224


 5056 05b2 58        		.byte	88
 5057 05b3 55        		.byte	85
 5058 05b4 55        		.byte	85
 5059 05b5 2F        		.byte	47
 5060 05b6 78        		.byte	120
 5061 05b7 D5        		.byte	-43
 5062 05b8 57        		.byte	87
 5063 05b9 2F        		.byte	47
 5064 05ba E0        		.byte	-32
 5065 05bb BF        		.byte	-65
 5066 05bc FE        		.byte	-2
 5067 05bd 0B        		.byte	11
 5068 05be 80        		.byte	-128
 5069 05bf 2A        		.byte	42
 5070 05c0 A8        		.byte	-88
 5071 05c1 02        		.byte	2
 5072               	.global	spriteCOIN
 5073               		.type	spriteCOIN, @object
 5074               		.size	spriteCOIN, 19
 5075               	spriteCOIN:
 5076 05c2 0000      		.word	pgm_imageCOIN
 5077 05c4 0000      		.word	0
 5078 05c6 0000      		.word	pgm_paletteCOIN
 5079 05c8 01        		.byte	1
 5080 05c9 28        		.byte	40
 5081 05ca 0000      		.word	0
 5082 05cc 0000      		.word	CoinMotion
 5083 05ce 0000      		.word	DefaultLayer
 5084 05d0 0000      		.word	DefaultCamMotion
 5085 05d2 0000      		.word	0
 5086 05d4 04        		.byte	4
 5087               	.global	CoinMotion
 5088               		.type	CoinMotion, @object
 5089               		.size	CoinMotion, 6
 5090               	CoinMotion:
 5091 05d5 00        		.byte	0
 5092 05d6 0000      		.word	0
 5093 05d8 F0        		.byte	-16
 5094 05d9 0000      		.word	CoinY
 5095               	.global	CoinY
 5096               		.type	CoinY, @object
 5097               		.size	CoinY, 10
 5098               	CoinY:
 5099 05db AA        		.byte	-86
 5100 05dc AA        		.byte	-86
 5101 05dd AA        		.byte	-86
 5102 05de AA        		.byte	-86
 5103 05df 55        		.byte	85
 5104 05e0 AA        		.byte	-86
 5105 05e1 AA        		.byte	-86
 5106 05e2 AA        		.byte	-86
 5107 05e3 AA        		.byte	-86
 5108 05e4 AA        		.byte	-86
 5109               		.type	pgm_paletteCOIN, @object
 5110               		.size	pgm_paletteCOIN, 4
 5111               	pgm_paletteCOIN:
 5112 05e5 25        		.byte	37
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 225


 5113 05e6 02        		.byte	2
 5114 05e7 07        		.byte	7
 5115 05e8 2F        		.byte	47
 5116               		.type	pgm_imageCOIN, @object
 5117               		.size	pgm_imageCOIN, 256
 5118               	pgm_imageCOIN:
 5119 05e9 00        		.byte	0
 5120 05ea 00        		.byte	0
 5121 05eb 00        		.byte	0
 5122 05ec 00        		.byte	0
 5123 05ed 00        		.byte	0
 5124 05ee 80        		.byte	-128
 5125 05ef 02        		.byte	2
 5126 05f0 00        		.byte	0
 5127 05f1 00        		.byte	0
 5128 05f2 A0        		.byte	-96
 5129 05f3 0A        		.byte	10
 5130 05f4 00        		.byte	0
 5131 05f5 00        		.byte	0
 5132 05f6 A8        		.byte	-88
 5133 05f7 2A        		.byte	42
 5134 05f8 00        		.byte	0
 5135 05f9 00        		.byte	0
 5136 05fa E8        		.byte	-24
 5137 05fb 29        		.byte	41
 5138 05fc 00        		.byte	0
 5139 05fd 00        		.byte	0
 5140 05fe BA        		.byte	-70
 5141 05ff A6        		.byte	-90
 5142 0600 00        		.byte	0
 5143 0601 00        		.byte	0
 5144 0602 BA        		.byte	-70
 5145 0603 A6        		.byte	-90
 5146 0604 00        		.byte	0
 5147 0605 00        		.byte	0
 5148 0606 BA        		.byte	-70
 5149 0607 A6        		.byte	-90
 5150 0608 00        		.byte	0
 5151 0609 00        		.byte	0
 5152 060a BA        		.byte	-70
 5153 060b A6        		.byte	-90
 5154 060c 00        		.byte	0
 5155 060d 00        		.byte	0
 5156 060e BA        		.byte	-70
 5157 060f A6        		.byte	-90
 5158 0610 00        		.byte	0
 5159 0611 00        		.byte	0
 5160 0612 BA        		.byte	-70
 5161 0613 A6        		.byte	-90
 5162 0614 00        		.byte	0
 5163 0615 00        		.byte	0
 5164 0616 E8        		.byte	-24
 5165 0617 29        		.byte	41
 5166 0618 00        		.byte	0
 5167 0619 00        		.byte	0
 5168 061a A8        		.byte	-88
 5169 061b 2A        		.byte	42
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 226


 5170 061c 00        		.byte	0
 5171 061d 00        		.byte	0
 5172 061e A0        		.byte	-96
 5173 061f 0A        		.byte	10
 5174 0620 00        		.byte	0
 5175 0621 00        		.byte	0
 5176 0622 80        		.byte	-128
 5177 0623 02        		.byte	2
 5178 0624 00        		.byte	0
 5179 0625 00        		.byte	0
 5180 0626 00        		.byte	0
 5181 0627 00        		.byte	0
 5182 0628 00        		.byte	0
 5183 0629 00        		.byte	0
 5184 062a 00        		.byte	0
 5185 062b 00        		.byte	0
 5186 062c 00        		.byte	0
 5187 062d 00        		.byte	0
 5188 062e 80        		.byte	-128
 5189 062f 01        		.byte	1
 5190 0630 00        		.byte	0
 5191 0631 00        		.byte	0
 5192 0632 80        		.byte	-128
 5193 0633 01        		.byte	1
 5194 0634 00        		.byte	0
 5195 0635 00        		.byte	0
 5196 0636 60        		.byte	96
 5197 0637 05        		.byte	5
 5198 0638 00        		.byte	0
 5199 0639 00        		.byte	0
 5200 063a 60        		.byte	96
 5201 063b 05        		.byte	5
 5202 063c 00        		.byte	0
 5203 063d 00        		.byte	0
 5204 063e 60        		.byte	96
 5205 063f 05        		.byte	5
 5206 0640 00        		.byte	0
 5207 0641 00        		.byte	0
 5208 0642 60        		.byte	96
 5209 0643 05        		.byte	5
 5210 0644 00        		.byte	0
 5211 0645 00        		.byte	0
 5212 0646 70        		.byte	112
 5213 0647 05        		.byte	5
 5214 0648 00        		.byte	0
 5215 0649 00        		.byte	0
 5216 064a 70        		.byte	112
 5217 064b 05        		.byte	5
 5218 064c 00        		.byte	0
 5219 064d 00        		.byte	0
 5220 064e 60        		.byte	96
 5221 064f 05        		.byte	5
 5222 0650 00        		.byte	0
 5223 0651 00        		.byte	0
 5224 0652 60        		.byte	96
 5225 0653 05        		.byte	5
 5226 0654 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 227


 5227 0655 00        		.byte	0
 5228 0656 60        		.byte	96
 5229 0657 05        		.byte	5
 5230 0658 00        		.byte	0
 5231 0659 00        		.byte	0
 5232 065a 60        		.byte	96
 5233 065b 05        		.byte	5
 5234 065c 00        		.byte	0
 5235 065d 00        		.byte	0
 5236 065e 80        		.byte	-128
 5237 065f 01        		.byte	1
 5238 0660 00        		.byte	0
 5239 0661 00        		.byte	0
 5240 0662 80        		.byte	-128
 5241 0663 01        		.byte	1
 5242 0664 00        		.byte	0
 5243 0665 00        		.byte	0
 5244 0666 00        		.byte	0
 5245 0667 00        		.byte	0
 5246 0668 00        		.byte	0
 5247 0669 00        		.byte	0
 5248 066a 00        		.byte	0
 5249 066b 00        		.byte	0
 5250 066c 00        		.byte	0
 5251 066d 00        		.byte	0
 5252 066e 80        		.byte	-128
 5253 066f 00        		.byte	0
 5254 0670 00        		.byte	0
 5255 0671 00        		.byte	0
 5256 0672 80        		.byte	-128
 5257 0673 00        		.byte	0
 5258 0674 00        		.byte	0
 5259 0675 00        		.byte	0
 5260 0676 80        		.byte	-128
 5261 0677 00        		.byte	0
 5262 0678 00        		.byte	0
 5263 0679 00        		.byte	0
 5264 067a 80        		.byte	-128
 5265 067b 00        		.byte	0
 5266 067c 00        		.byte	0
 5267 067d 00        		.byte	0
 5268 067e 80        		.byte	-128
 5269 067f 00        		.byte	0
 5270 0680 00        		.byte	0
 5271 0681 00        		.byte	0
 5272 0682 80        		.byte	-128
 5273 0683 00        		.byte	0
 5274 0684 00        		.byte	0
 5275 0685 00        		.byte	0
 5276 0686 C0        		.byte	-64
 5277 0687 00        		.byte	0
 5278 0688 00        		.byte	0
 5279 0689 00        		.byte	0
 5280 068a C0        		.byte	-64
 5281 068b 00        		.byte	0
 5282 068c 00        		.byte	0
 5283 068d 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 228


 5284 068e 80        		.byte	-128
 5285 068f 00        		.byte	0
 5286 0690 00        		.byte	0
 5287 0691 00        		.byte	0
 5288 0692 80        		.byte	-128
 5289 0693 00        		.byte	0
 5290 0694 00        		.byte	0
 5291 0695 00        		.byte	0
 5292 0696 80        		.byte	-128
 5293 0697 00        		.byte	0
 5294 0698 00        		.byte	0
 5295 0699 00        		.byte	0
 5296 069a 80        		.byte	-128
 5297 069b 00        		.byte	0
 5298 069c 00        		.byte	0
 5299 069d 00        		.byte	0
 5300 069e 80        		.byte	-128
 5301 069f 00        		.byte	0
 5302 06a0 00        		.byte	0
 5303 06a1 00        		.byte	0
 5304 06a2 80        		.byte	-128
 5305 06a3 00        		.byte	0
 5306 06a4 00        		.byte	0
 5307 06a5 00        		.byte	0
 5308 06a6 00        		.byte	0
 5309 06a7 00        		.byte	0
 5310 06a8 00        		.byte	0
 5311 06a9 00        		.byte	0
 5312 06aa 00        		.byte	0
 5313 06ab 00        		.byte	0
 5314 06ac 00        		.byte	0
 5315 06ad 00        		.byte	0
 5316 06ae C0        		.byte	-64
 5317 06af 01        		.byte	1
 5318 06b0 00        		.byte	0
 5319 06b1 00        		.byte	0
 5320 06b2 C0        		.byte	-64
 5321 06b3 01        		.byte	1
 5322 06b4 00        		.byte	0
 5323 06b5 00        		.byte	0
 5324 06b6 F0        		.byte	-16
 5325 06b7 07        		.byte	7
 5326 06b8 00        		.byte	0
 5327 06b9 00        		.byte	0
 5328 06ba F0        		.byte	-16
 5329 06bb 07        		.byte	7
 5330 06bc 00        		.byte	0
 5331 06bd 00        		.byte	0
 5332 06be F0        		.byte	-16
 5333 06bf 07        		.byte	7
 5334 06c0 00        		.byte	0
 5335 06c1 00        		.byte	0
 5336 06c2 F0        		.byte	-16
 5337 06c3 07        		.byte	7
 5338 06c4 00        		.byte	0
 5339 06c5 00        		.byte	0
 5340 06c6 F0        		.byte	-16
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 229


 5341 06c7 07        		.byte	7
 5342 06c8 00        		.byte	0
 5343 06c9 00        		.byte	0
 5344 06ca F0        		.byte	-16
 5345 06cb 07        		.byte	7
 5346 06cc 00        		.byte	0
 5347 06cd 00        		.byte	0
 5348 06ce F0        		.byte	-16
 5349 06cf 07        		.byte	7
 5350 06d0 00        		.byte	0
 5351 06d1 00        		.byte	0
 5352 06d2 F0        		.byte	-16
 5353 06d3 07        		.byte	7
 5354 06d4 00        		.byte	0
 5355 06d5 00        		.byte	0
 5356 06d6 F0        		.byte	-16
 5357 06d7 07        		.byte	7
 5358 06d8 00        		.byte	0
 5359 06d9 00        		.byte	0
 5360 06da F0        		.byte	-16
 5361 06db 07        		.byte	7
 5362 06dc 00        		.byte	0
 5363 06dd 00        		.byte	0
 5364 06de C0        		.byte	-64
 5365 06df 01        		.byte	1
 5366 06e0 00        		.byte	0
 5367 06e1 00        		.byte	0
 5368 06e2 C0        		.byte	-64
 5369 06e3 01        		.byte	1
 5370 06e4 00        		.byte	0
 5371 06e5 00        		.byte	0
 5372 06e6 00        		.byte	0
 5373 06e7 00        		.byte	0
 5374 06e8 00        		.byte	0
 5375               	.global	spriteSTAR
 5376               		.type	spriteSTAR, @object
 5377               		.size	spriteSTAR, 19
 5378               	spriteSTAR:
 5379 06e9 0000      		.word	pgm_imageSTAR
 5380 06eb 0000      		.word	0
 5381 06ed 0000      		.word	pgm_paletteSTAR
 5382 06ef 02        		.byte	2
 5383 06f0 28        		.byte	40
 5384 06f1 0000      		.word	0
 5385 06f3 0000      		.word	DefaultMotion
 5386 06f5 0000      		.word	DefaultLayer
 5387 06f7 0000      		.word	DefaultCamMotion
 5388 06f9 0000      		.word	FlowerPA
 5389 06fb 01        		.byte	1
 5390               		.type	pgm_paletteSTAR, @object
 5391               		.size	pgm_paletteSTAR, 8
 5392               	pgm_paletteSTAR:
 5393 06fc 25        		.byte	37
 5394 06fd 07        		.byte	7
 5395 06fe 02        		.byte	2
 5396 06ff 00        		.byte	0
 5397 0700 25        		.byte	37
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 230


 5398 0701 02        		.byte	2
 5399 0702 00        		.byte	0
 5400 0703 00        		.byte	0
 5401               		.type	pgm_imageSTAR, @object
 5402               		.size	pgm_imageSTAR, 64
 5403               	pgm_imageSTAR:
 5404 0704 00        		.byte	0
 5405 0705 40        		.byte	64
 5406 0706 01        		.byte	1
 5407 0707 00        		.byte	0
 5408 0708 00        		.byte	0
 5409 0709 40        		.byte	64
 5410 070a 01        		.byte	1
 5411 070b 00        		.byte	0
 5412 070c 00        		.byte	0
 5413 070d 50        		.byte	80
 5414 070e 05        		.byte	5
 5415 070f 00        		.byte	0
 5416 0710 00        		.byte	0
 5417 0711 50        		.byte	80
 5418 0712 05        		.byte	5
 5419 0713 00        		.byte	0
 5420 0714 00        		.byte	0
 5421 0715 54        		.byte	84
 5422 0716 15        		.byte	21
 5423 0717 00        		.byte	0
 5424 0718 54        		.byte	84
 5425 0719 55        		.byte	85
 5426 071a 55        		.byte	85
 5427 071b 15        		.byte	21
 5428 071c 54        		.byte	84
 5429 071d 65        		.byte	101
 5430 071e 59        		.byte	89
 5431 071f 15        		.byte	21
 5432 0720 50        		.byte	80
 5433 0721 65        		.byte	101
 5434 0722 59        		.byte	89
 5435 0723 05        		.byte	5
 5436 0724 40        		.byte	64
 5437 0725 65        		.byte	101
 5438 0726 59        		.byte	89
 5439 0727 01        		.byte	1
 5440 0728 00        		.byte	0
 5441 0729 55        		.byte	85
 5442 072a 55        		.byte	85
 5443 072b 00        		.byte	0
 5444 072c 00        		.byte	0
 5445 072d 55        		.byte	85
 5446 072e 55        		.byte	85
 5447 072f 00        		.byte	0
 5448 0730 40        		.byte	64
 5449 0731 55        		.byte	85
 5450 0732 55        		.byte	85
 5451 0733 01        		.byte	1
 5452 0734 40        		.byte	64
 5453 0735 55        		.byte	85
 5454 0736 55        		.byte	85
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 231


 5455 0737 01        		.byte	1
 5456 0738 40        		.byte	64
 5457 0739 15        		.byte	21
 5458 073a 54        		.byte	84
 5459 073b 01        		.byte	1
 5460 073c 50        		.byte	80
 5461 073d 01        		.byte	1
 5462 073e 40        		.byte	64
 5463 073f 05        		.byte	5
 5464 0740 50        		.byte	80
 5465 0741 00        		.byte	0
 5466 0742 00        		.byte	0
 5467 0743 05        		.byte	5
 5468               	.global	spriteFLOWER
 5469               		.type	spriteFLOWER, @object
 5470               		.size	spriteFLOWER, 19
 5471               	spriteFLOWER:
 5472 0744 0000      		.word	pgm_imageFLOWER
 5473 0746 0000      		.word	0
 5474 0748 0000      		.word	pgm_paletteFLOWER
 5475 074a 03        		.byte	3
 5476 074b 28        		.byte	40
 5477 074c 0000      		.word	0
 5478 074e 0000      		.word	DefaultMotion
 5479 0750 0000      		.word	DefaultLayer
 5480 0752 0000      		.word	DefaultCamMotion
 5481 0754 0000      		.word	FlowerPA
 5482 0756 01        		.byte	1
 5483               	.global	FlowerPA
 5484               		.type	FlowerPA, @object
 5485               		.size	FlowerPA, 5
 5486               	FlowerPA:
 5487 0757 FF        		.byte	-1
 5488 0758 FF        		.byte	-1
 5489 0759 FF        		.byte	-1
 5490 075a FF        		.byte	-1
 5491 075b FF        		.byte	-1
 5492               		.type	pgm_paletteFLOWER, @object
 5493               		.size	pgm_paletteFLOWER, 16
 5494               	pgm_paletteFLOWER:
 5495 075c 25        		.byte	37
 5496 075d 2F        		.byte	47
 5497 075e 07        		.byte	7
 5498 075f 04        		.byte	4
 5499 0760 25        		.byte	37
 5500 0761 17        		.byte	23
 5501 0762 02        		.byte	2
 5502 0763 00        		.byte	0
 5503 0764 25        		.byte	37
 5504 0765 07        		.byte	7
 5505 0766 05        		.byte	5
 5506 0767 02        		.byte	2
 5507 0768 25        		.byte	37
 5508 0769 04        		.byte	4
 5509 076a 00        		.byte	0
 5510 076b 00        		.byte	0
 5511               		.type	pgm_imageFLOWER, @object
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 232


 5512               		.size	pgm_imageFLOWER, 64
 5513               	pgm_imageFLOWER:
 5514 076c 00        		.byte	0
 5515 076d 55        		.byte	85
 5516 076e 55        		.byte	85
 5517 076f 00        		.byte	0
 5518 0770 50        		.byte	80
 5519 0771 55        		.byte	85
 5520 0772 55        		.byte	85
 5521 0773 05        		.byte	5
 5522 0774 54        		.byte	84
 5523 0775 AA        		.byte	-86
 5524 0776 AA        		.byte	-86
 5525 0777 15        		.byte	21
 5526 0778 A5        		.byte	-91
 5527 0779 FE        		.byte	-2
 5528 077a BF        		.byte	-65
 5529 077b 5A        		.byte	90
 5530 077c A5        		.byte	-91
 5531 077d FE        		.byte	-2
 5532 077e BF        		.byte	-65
 5533 077f 5A        		.byte	90
 5534 0780 54        		.byte	84
 5535 0781 AA        		.byte	-86
 5536 0782 AA        		.byte	-86
 5537 0783 15        		.byte	21
 5538 0784 50        		.byte	80
 5539 0785 55        		.byte	85
 5540 0786 55        		.byte	85
 5541 0787 05        		.byte	5
 5542 0788 00        		.byte	0
 5543 0789 55        		.byte	85
 5544 078a 55        		.byte	85
 5545 078b 00        		.byte	0
 5546 078c 00        		.byte	0
 5547 078d 40        		.byte	64
 5548 078e 01        		.byte	1
 5549 078f 00        		.byte	0
 5550 0790 15        		.byte	21
 5551 0791 40        		.byte	64
 5552 0792 01        		.byte	1
 5553 0793 54        		.byte	84
 5554 0794 54        		.byte	84
 5555 0795 40        		.byte	64
 5556 0796 01        		.byte	1
 5557 0797 15        		.byte	21
 5558 0798 54        		.byte	84
 5559 0799 41        		.byte	65
 5560 079a 41        		.byte	65
 5561 079b 15        		.byte	21
 5562 079c 50        		.byte	80
 5563 079d 45        		.byte	69
 5564 079e 51        		.byte	81
 5565 079f 05        		.byte	5
 5566 07a0 50        		.byte	80
 5567 07a1 45        		.byte	69
 5568 07a2 51        		.byte	81
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 233


 5569 07a3 05        		.byte	5
 5570 07a4 40        		.byte	64
 5571 07a5 55        		.byte	85
 5572 07a6 55        		.byte	85
 5573 07a7 01        		.byte	1
 5574 07a8 00        		.byte	0
 5575 07a9 50        		.byte	80
 5576 07aa 05        		.byte	5
 5577 07ab 00        		.byte	0
 5578               	.global	spriteBIG
 5579               		.type	spriteBIG, @object
 5580               		.size	spriteBIG, 19
 5581               	spriteBIG:
 5582 07ac 0000      		.word	pgm_imageSHROOM
 5583 07ae 0000      		.word	0
 5584 07b0 0000      		.word	pgm_paletteBIG
 5585 07b2 01        		.byte	1
 5586 07b3 28        		.byte	40
 5587 07b4 0000      		.word	0
 5588 07b6 0000      		.word	DefaultMotion
 5589 07b8 0000      		.word	DefaultLayer
 5590 07ba 0000      		.word	DefaultCamMotion
 5591 07bc 0000      		.word	0
 5592 07be 01        		.byte	1
 5593               		.type	pgm_paletteBIG, @object
 5594               		.size	pgm_paletteBIG, 4
 5595               	pgm_paletteBIG:
 5596 07bf 25        		.byte	37
 5597 07c0 07        		.byte	7
 5598 07c1 02        		.byte	2
 5599 07c2 2F        		.byte	47
 5600               	.global	sprite1UP
 5601               		.type	sprite1UP, @object
 5602               		.size	sprite1UP, 19
 5603               	sprite1UP:
 5604 07c3 0000      		.word	pgm_imageSHROOM
 5605 07c5 0000      		.word	0
 5606 07c7 0000      		.word	pgm_palette1UP
 5607 07c9 01        		.byte	1
 5608 07ca 28        		.byte	40
 5609 07cb 0000      		.word	0
 5610 07cd 0000      		.word	DefaultMotion
 5611 07cf 0000      		.word	DefaultLayer
 5612 07d1 0000      		.word	DefaultCamMotion
 5613 07d3 0000      		.word	0
 5614 07d5 01        		.byte	1
 5615               		.type	pgm_palette1UP, @object
 5616               		.size	pgm_palette1UP, 4
 5617               	pgm_palette1UP:
 5618 07d6 25        		.byte	37
 5619 07d7 07        		.byte	7
 5620 07d8 04        		.byte	4
 5621 07d9 2F        		.byte	47
 5622               		.type	pgm_imageSHROOM, @object
 5623               		.size	pgm_imageSHROOM, 64
 5624               	pgm_imageSHROOM:
 5625 07da 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 234


 5626 07db 50        		.byte	80
 5627 07dc 05        		.byte	5
 5628 07dd 00        		.byte	0
 5629 07de 00        		.byte	0
 5630 07df 54        		.byte	84
 5631 07e0 29        		.byte	41
 5632 07e1 00        		.byte	0
 5633 07e2 00        		.byte	0
 5634 07e3 55        		.byte	85
 5635 07e4 AA        		.byte	-86
 5636 07e5 00        		.byte	0
 5637 07e6 40        		.byte	64
 5638 07e7 55        		.byte	85
 5639 07e8 AA        		.byte	-86
 5640 07e9 02        		.byte	2
 5641 07ea 50        		.byte	80
 5642 07eb 55        		.byte	85
 5643 07ec A9        		.byte	-87
 5644 07ed 05        		.byte	5
 5645 07ee 94        		.byte	-108
 5646 07ef 5A        		.byte	90
 5647 07f0 55        		.byte	85
 5648 07f1 15        		.byte	21
 5649 07f2 A4        		.byte	-92
 5650 07f3 6A        		.byte	106
 5651 07f4 55        		.byte	85
 5652 07f5 15        		.byte	21
 5653 07f6 A5        		.byte	-91
 5654 07f7 6A        		.byte	106
 5655 07f8 55        		.byte	85
 5656 07f9 5A        		.byte	90
 5657 07fa A5        		.byte	-91
 5658 07fb 6A        		.byte	106
 5659 07fc 55        		.byte	85
 5660 07fd 6A        		.byte	106
 5661 07fe 95        		.byte	-107
 5662 07ff 5A        		.byte	90
 5663 0800 55        		.byte	85
 5664 0801 69        		.byte	105
 5665 0802 55        		.byte	85
 5666 0803 55        		.byte	85
 5667 0804 55        		.byte	85
 5668 0805 55        		.byte	85
 5669 0806 A4        		.byte	-92
 5670 0807 FE        		.byte	-2
 5671 0808 BF        		.byte	-65
 5672 0809 1A        		.byte	26
 5673 080a 00        		.byte	0
 5674 080b FF        		.byte	-1
 5675 080c FF        		.byte	-1
 5676 080d 00        		.byte	0
 5677 080e 00        		.byte	0
 5678 080f FF        		.byte	-1
 5679 0810 DF        		.byte	-33
 5680 0811 00        		.byte	0
 5681 0812 00        		.byte	0
 5682 0813 FF        		.byte	-1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 235


 5683 0814 DF        		.byte	-33
 5684 0815 00        		.byte	0
 5685 0816 00        		.byte	0
 5686 0817 FC        		.byte	-4
 5687 0818 37        		.byte	55
 5688 0819 00        		.byte	0
 5689               	.global	spriteDEADGOOMBA
 5690               		.type	spriteDEADGOOMBA, @object
 5691               		.size	spriteDEADGOOMBA, 19
 5692               	spriteDEADGOOMBA:
 5693 081a 0000      		.word	pgm_imageDEADGOOMBA
 5694 081c 0000      		.word	0
 5695 081e 0000      		.word	pgm_paletteDEADGOOMBA
 5696 0820 01        		.byte	1
 5697 0821 14        		.byte	20
 5698 0822 0000      		.word	0
 5699 0824 0000      		.word	DeadGoombaMotion
 5700 0826 0000      		.word	0
 5701 0828 0000      		.word	DeadGoombaCamMotion
 5702 082a 0000      		.word	0
 5703 082c 01        		.byte	1
 5704               	.global	DeadGoombaCamMotion
 5705               		.type	DeadGoombaCamMotion, @object
 5706               		.size	DeadGoombaCamMotion, 6
 5707               	DeadGoombaCamMotion:
 5708 082d 00        		.byte	0
 5709 082e 0000      		.word	0
 5710 0830 10        		.byte	16
 5711 0831 0000      		.word	DeadGoombaCamY
 5712               	.global	DeadGoombaCamY
 5713               		.type	DeadGoombaCamY, @object
 5714               		.size	DeadGoombaCamY, 5
 5715               	DeadGoombaCamY:
 5716 0833 03        		.byte	3
 5717 0834 55        		.byte	85
 5718 0835 55        		.byte	85
 5719 0836 55        		.byte	85
 5720 0837 55        		.byte	85
 5721               	.global	DeadGoombaMotion
 5722               		.type	DeadGoombaMotion, @object
 5723               		.size	DeadGoombaMotion, 6
 5724               	DeadGoombaMotion:
 5725 0838 00        		.byte	0
 5726 0839 0000      		.word	0
 5727 083b 10        		.byte	16
 5728 083c 0000      		.word	0
 5729               		.type	pgm_paletteDEADGOOMBA, @object
 5730               		.size	pgm_paletteDEADGOOMBA, 4
 5731               	pgm_paletteDEADGOOMBA:
 5732 083e 25        		.byte	37
 5733 083f 02        		.byte	2
 5734 0840 27        		.byte	39
 5735 0841 00        		.byte	0
 5736               		.type	pgm_imageDEADGOOMBA, @object
 5737               		.size	pgm_imageDEADGOOMBA, 64
 5738               	pgm_imageDEADGOOMBA:
 5739 0842 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 236


 5740 0843 00        		.byte	0
 5741 0844 00        		.byte	0
 5742 0845 00        		.byte	0
 5743 0846 00        		.byte	0
 5744 0847 00        		.byte	0
 5745 0848 00        		.byte	0
 5746 0849 00        		.byte	0
 5747 084a 00        		.byte	0
 5748 084b 00        		.byte	0
 5749 084c 00        		.byte	0
 5750 084d 00        		.byte	0
 5751 084e 00        		.byte	0
 5752 084f 00        		.byte	0
 5753 0850 00        		.byte	0
 5754 0851 00        		.byte	0
 5755 0852 00        		.byte	0
 5756 0853 00        		.byte	0
 5757 0854 00        		.byte	0
 5758 0855 00        		.byte	0
 5759 0856 00        		.byte	0
 5760 0857 00        		.byte	0
 5761 0858 00        		.byte	0
 5762 0859 00        		.byte	0
 5763 085a 00        		.byte	0
 5764 085b 00        		.byte	0
 5765 085c 00        		.byte	0
 5766 085d 00        		.byte	0
 5767 085e 00        		.byte	0
 5768 085f 50        		.byte	80
 5769 0860 05        		.byte	5
 5770 0861 00        		.byte	0
 5771 0862 40        		.byte	64
 5772 0863 55        		.byte	85
 5773 0864 55        		.byte	85
 5774 0865 01        		.byte	1
 5775 0866 D4        		.byte	-44
 5776 0867 5F        		.byte	95
 5777 0868 F5        		.byte	-11
 5778 0869 17        		.byte	23
 5779 086a A5        		.byte	-91
 5780 086b FA        		.byte	-6
 5781 086c AF        		.byte	-81
 5782 086d 5A        		.byte	90
 5783 086e 55        		.byte	85
 5784 086f 55        		.byte	85
 5785 0870 55        		.byte	85
 5786 0871 55        		.byte	85
 5787 0872 80        		.byte	-128
 5788 0873 AA        		.byte	-86
 5789 0874 AA        		.byte	-86
 5790 0875 02        		.byte	2
 5791 0876 80        		.byte	-128
 5792 0877 AA        		.byte	-86
 5793 0878 AA        		.byte	-86
 5794 0879 02        		.byte	2
 5795 087a F0        		.byte	-16
 5796 087b 0F        		.byte	15
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 237


 5797 087c F0        		.byte	-16
 5798 087d 3F        		.byte	63
 5799 087e 00        		.byte	0
 5800 087f 00        		.byte	0
 5801 0880 00        		.byte	0
 5802 0881 00        		.byte	0
 5803               	.global	spriteGOOMBA
 5804               		.type	spriteGOOMBA, @object
 5805               		.size	spriteGOOMBA, 19
 5806               	spriteGOOMBA:
 5807 0882 0000      		.word	pgm_imageGOOMBA
 5808 0884 0000      		.word	0
 5809 0886 0000      		.word	pgm_paletteGOOMBA
 5810 0888 06        		.byte	6
 5811 0889 50        		.byte	80
 5812 088a 0000      		.word	GoombaFlip
 5813 088c 0000      		.word	GoombaMotion
 5814 088e 0000      		.word	GoombaLayer
 5815 0890 0000      		.word	GoombaCamMotion
 5816 0892 0000      		.word	GoombaPA
 5817 0894 01        		.byte	1
 5818               	.global	GoombaPA
 5819               		.type	GoombaPA, @object
 5820               		.size	GoombaPA, 10
 5821               	GoombaPA:
 5822 0895 00        		.byte	0
 5823 0896 00        		.byte	0
 5824 0897 01        		.byte	1
 5825 0898 00        		.byte	0
 5826 0899 04        		.byte	4
 5827 089a 10        		.byte	16
 5828 089b 80        		.byte	-128
 5829 089c 00        		.byte	0
 5830 089d 01        		.byte	1
 5831 089e 00        		.byte	0
 5832               	.global	GoombaLayer
 5833               		.type	GoombaLayer, @object
 5834               		.size	GoombaLayer, 10
 5835               	GoombaLayer:
 5836 089f FF        		.byte	-1
 5837 08a0 FF        		.byte	-1
 5838 08a1 00        		.byte	0
 5839 08a2 00        		.byte	0
 5840 08a3 00        		.byte	0
 5841 08a4 00        		.byte	0
 5842 08a5 00        		.byte	0
 5843 08a6 00        		.byte	0
 5844 08a7 00        		.byte	0
 5845 08a8 00        		.byte	0
 5846               	.global	GoombaCamMotion
 5847               		.type	GoombaCamMotion, @object
 5848               		.size	GoombaCamMotion, 6
 5849               	GoombaCamMotion:
 5850 08a9 00        		.byte	0
 5851 08aa 0000      		.word	0
 5852 08ac 00        		.byte	0
 5853 08ad 0000      		.word	GoombaCamY
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 238


 5854               	.global	GoombaCamY
 5855               		.type	GoombaCamY, @object
 5856               		.size	GoombaCamY, 20
 5857               	GoombaCamY:
 5858 08af 55        		.byte	85
 5859 08b0 55        		.byte	85
 5860 08b1 55        		.byte	85
 5861 08b2 55        		.byte	85
 5862 08b3 00        		.byte	0
 5863 08b4 00        		.byte	0
 5864 08b5 03        		.byte	3
 5865 08b6 00        		.byte	0
 5866 08b7 00        		.byte	0
 5867 08b8 00        		.byte	0
 5868 08b9 00        		.byte	0
 5869 08ba 00        		.byte	0
 5870 08bb 00        		.byte	0
 5871 08bc 00        		.byte	0
 5872 08bd 00        		.byte	0
 5873 08be 00        		.byte	0
 5874 08bf 55        		.byte	85
 5875 08c0 55        		.byte	85
 5876 08c1 55        		.byte	85
 5877 08c2 55        		.byte	85
 5878               	.global	GoombaMotion
 5879               		.type	GoombaMotion, @object
 5880               		.size	GoombaMotion, 6
 5881               	GoombaMotion:
 5882 08c3 00        		.byte	0
 5883 08c4 0000      		.word	0
 5884 08c6 F0        		.byte	-16
 5885 08c7 0000      		.word	GoombaY
 5886               	.global	GoombaY
 5887               		.type	GoombaY, @object
 5888               		.size	GoombaY, 20
 5889               	GoombaY:
 5890 08c9 AA        		.byte	-86
 5891 08ca AA        		.byte	-86
 5892 08cb AA        		.byte	-86
 5893 08cc AA        		.byte	-86
 5894 08cd 00        		.byte	0
 5895 08ce 00        		.byte	0
 5896 08cf 00        		.byte	0
 5897 08d0 00        		.byte	0
 5898 08d1 00        		.byte	0
 5899 08d2 00        		.byte	0
 5900 08d3 00        		.byte	0
 5901 08d4 00        		.byte	0
 5902 08d5 00        		.byte	0
 5903 08d6 00        		.byte	0
 5904 08d7 00        		.byte	0
 5905 08d8 00        		.byte	0
 5906 08d9 00        		.byte	0
 5907 08da 00        		.byte	0
 5908 08db 00        		.byte	0
 5909 08dc 00        		.byte	0
 5910               	.global	GoombaFlip
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 239


 5911               		.type	GoombaFlip, @object
 5912               		.size	GoombaFlip, 10
 5913               	GoombaFlip:
 5914 08dd AA        		.byte	-86
 5915 08de AA        		.byte	-86
 5916 08df AA        		.byte	-86
 5917 08e0 AA        		.byte	-86
 5918 08e1 AA        		.byte	-86
 5919 08e2 AA        		.byte	-86
 5920 08e3 AA        		.byte	-86
 5921 08e4 AA        		.byte	-86
 5922 08e5 FF        		.byte	-1
 5923 08e6 FF        		.byte	-1
 5924               		.type	pgm_paletteGOOMBA, @object
 5925               		.size	pgm_paletteGOOMBA, 24
 5926               	pgm_paletteGOOMBA:
 5927 08e7 25        		.byte	37
 5928 08e8 02        		.byte	2
 5929 08e9 27        		.byte	39
 5930 08ea 00        		.byte	0
 5931 08eb 04        		.byte	4
 5932 08ec 02        		.byte	2
 5933 08ed 27        		.byte	39
 5934 08ee 00        		.byte	0
 5935 08ef 05        		.byte	5
 5936 08f0 02        		.byte	2
 5937 08f1 27        		.byte	39
 5938 08f2 00        		.byte	0
 5939 08f3 07        		.byte	7
 5940 08f4 02        		.byte	2
 5941 08f5 27        		.byte	39
 5942 08f6 00        		.byte	0
 5943 08f7 03        		.byte	3
 5944 08f8 01        		.byte	1
 5945 08f9 26        		.byte	38
 5946 08fa 00        		.byte	0
 5947 08fb 00        		.byte	0
 5948 08fc 20        		.byte	32
 5949 08fd 01        		.byte	1
 5950 08fe 20        		.byte	32
 5951               		.type	pgm_imageGOOMBA, @object
 5952               		.size	pgm_imageGOOMBA, 64
 5953               	pgm_imageGOOMBA:
 5954 08ff 00        		.byte	0
 5955 0900 50        		.byte	80
 5956 0901 05        		.byte	5
 5957 0902 00        		.byte	0
 5958 0903 00        		.byte	0
 5959 0904 54        		.byte	84
 5960 0905 15        		.byte	21
 5961 0906 00        		.byte	0
 5962 0907 00        		.byte	0
 5963 0908 55        		.byte	85
 5964 0909 55        		.byte	85
 5965 090a 00        		.byte	0
 5966 090b 40        		.byte	64
 5967 090c 55        		.byte	85
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 240


 5968 090d 55        		.byte	85
 5969 090e 01        		.byte	1
 5970 090f D0        		.byte	-48
 5971 0910 57        		.byte	87
 5972 0911 D5        		.byte	-43
 5973 0912 07        		.byte	7
 5974 0913 54        		.byte	84
 5975 0914 5E        		.byte	94
 5976 0915 B5        		.byte	-75
 5977 0916 15        		.byte	21
 5978 0917 54        		.byte	84
 5979 0918 FE        		.byte	-2
 5980 0919 BF        		.byte	-65
 5981 091a 15        		.byte	21
 5982 091b 55        		.byte	85
 5983 091c 6E        		.byte	110
 5984 091d B9        		.byte	-71
 5985 091e 55        		.byte	85
 5986 091f 55        		.byte	85
 5987 0920 6A        		.byte	106
 5988 0921 A9        		.byte	-87
 5989 0922 55        		.byte	85
 5990 0923 55        		.byte	85
 5991 0924 55        		.byte	85
 5992 0925 55        		.byte	85
 5993 0926 55        		.byte	85
 5994 0927 54        		.byte	84
 5995 0928 A9        		.byte	-87
 5996 0929 6A        		.byte	106
 5997 092a 15        		.byte	21
 5998 092b 00        		.byte	0
 5999 092c AA        		.byte	-86
 6000 092d AA        		.byte	-86
 6001 092e 00        		.byte	0
 6002 092f 00        		.byte	0
 6003 0930 AA        		.byte	-86
 6004 0931 AA        		.byte	-86
 6005 0932 0F        		.byte	15
 6006 0933 C0        		.byte	-64
 6007 0934 AB        		.byte	-85
 6008 0935 FA        		.byte	-6
 6009 0936 3F        		.byte	63
 6010 0937 C0        		.byte	-64
 6011 0938 AF        		.byte	-81
 6012 0939 FE        		.byte	-2
 6013 093a 3F        		.byte	63
 6014 093b 00        		.byte	0
 6015 093c BF        		.byte	-65
 6016 093d FF        		.byte	-1
 6017 093e 0F        		.byte	15
 6018               	.global	spriteSOLIDBUMP
 6019               		.type	spriteSOLIDBUMP, @object
 6020               		.size	spriteSOLIDBUMP, 19
 6021               	spriteSOLIDBUMP:
 6022 093f 0000      		.word	pgm_imageSOLID
 6023 0941 0000      		.word	0
 6024 0943 0000      		.word	pgm_paletteSOLID
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 241


 6025 0945 01        		.byte	1
 6026 0946 03        		.byte	3
 6027 0947 0000      		.word	0
 6028 0949 0000      		.word	SolidBumpMotion
 6029 094b 0000      		.word	DefaultLayer
 6030 094d 0000      		.word	NadaMotion
 6031 094f 0000      		.word	0
 6032 0951 01        		.byte	1
 6033               	.global	SolidBumpMotion
 6034               		.type	SolidBumpMotion, @object
 6035               		.size	SolidBumpMotion, 6
 6036               	SolidBumpMotion:
 6037 0952 00        		.byte	0
 6038 0953 0000      		.word	0
 6039 0955 00        		.byte	0
 6040 0956 0000      		.word	SolidBumpY
 6041               	.global	SolidBumpY
 6042               		.type	SolidBumpY, @object
 6043               		.size	SolidBumpY, 1
 6044               	SolidBumpY:
 6045 0958 2E        		.byte	46
 6046               	.global	spriteSOLID
 6047               		.type	spriteSOLID, @object
 6048               		.size	spriteSOLID, 19
 6049               	spriteSOLID:
 6050 0959 0000      		.word	pgm_imageSOLID
 6051 095b 0000      		.word	0
 6052 095d 0000      		.word	pgm_paletteSOLID
 6053 095f 01        		.byte	1
 6054 0960 08        		.byte	8
 6055 0961 0000      		.word	0
 6056 0963 0000      		.word	NadaMotion
 6057 0965 0000      		.word	0
 6058 0967 0000      		.word	NadaMotion
 6059 0969 0000      		.word	0
 6060 096b 01        		.byte	1
 6061               		.type	pgm_paletteSOLID, @object
 6062               		.size	pgm_paletteSOLID, 4
 6063               	pgm_paletteSOLID:
 6064 096c 25        		.byte	37
 6065 096d 02        		.byte	2
 6066 096e 00        		.byte	0
 6067 096f 00        		.byte	0
 6068               		.type	pgm_imageSOLID, @object
 6069               		.size	pgm_imageSOLID, 64
 6070               	pgm_imageSOLID:
 6071 0970 FC        		.byte	-4
 6072 0971 FF        		.byte	-1
 6073 0972 FF        		.byte	-1
 6074 0973 3F        		.byte	63
 6075 0974 57        		.byte	87
 6076 0975 55        		.byte	85
 6077 0976 55        		.byte	85
 6078 0977 D5        		.byte	-43
 6079 0978 77        		.byte	119
 6080 0979 55        		.byte	85
 6081 097a 55        		.byte	85
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 242


 6082 097b DD        		.byte	-35
 6083 097c 57        		.byte	87
 6084 097d 55        		.byte	85
 6085 097e 55        		.byte	85
 6086 097f D5        		.byte	-43
 6087 0980 57        		.byte	87
 6088 0981 55        		.byte	85
 6089 0982 55        		.byte	85
 6090 0983 D5        		.byte	-43
 6091 0984 57        		.byte	87
 6092 0985 55        		.byte	85
 6093 0986 55        		.byte	85
 6094 0987 D5        		.byte	-43
 6095 0988 57        		.byte	87
 6096 0989 55        		.byte	85
 6097 098a 55        		.byte	85
 6098 098b D5        		.byte	-43
 6099 098c 57        		.byte	87
 6100 098d 55        		.byte	85
 6101 098e 55        		.byte	85
 6102 098f D5        		.byte	-43
 6103 0990 57        		.byte	87
 6104 0991 55        		.byte	85
 6105 0992 55        		.byte	85
 6106 0993 D5        		.byte	-43
 6107 0994 57        		.byte	87
 6108 0995 55        		.byte	85
 6109 0996 55        		.byte	85
 6110 0997 D5        		.byte	-43
 6111 0998 57        		.byte	87
 6112 0999 55        		.byte	85
 6113 099a 55        		.byte	85
 6114 099b D5        		.byte	-43
 6115 099c 57        		.byte	87
 6116 099d 55        		.byte	85
 6117 099e 55        		.byte	85
 6118 099f D5        		.byte	-43
 6119 09a0 57        		.byte	87
 6120 09a1 55        		.byte	85
 6121 09a2 55        		.byte	85
 6122 09a3 D5        		.byte	-43
 6123 09a4 77        		.byte	119
 6124 09a5 55        		.byte	85
 6125 09a6 55        		.byte	85
 6126 09a7 DD        		.byte	-35
 6127 09a8 57        		.byte	87
 6128 09a9 55        		.byte	85
 6129 09aa 55        		.byte	85
 6130 09ab D5        		.byte	-43
 6131 09ac FC        		.byte	-4
 6132 09ad FF        		.byte	-1
 6133 09ae FF        		.byte	-1
 6134 09af 3F        		.byte	63
 6135               	.global	spriteQ
 6136               		.type	spriteQ, @object
 6137               		.size	spriteQ, 19
 6138               	spriteQ:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 243


 6139 09b0 0000      		.word	pgm_imageQ
 6140 09b2 0000      		.word	0
 6141 09b4 0000      		.word	pgm_paletteQ
 6142 09b6 04        		.byte	4
 6143 09b7 3C        		.byte	60
 6144 09b8 0000      		.word	0
 6145 09ba 0000      		.word	NadaMotion
 6146 09bc 0000      		.word	0
 6147 09be 0000      		.word	NadaMotion
 6148 09c0 0000      		.word	QPaletteAdvance
 6149 09c2 01        		.byte	1
 6150               	.global	QPaletteAdvance
 6151               		.type	QPaletteAdvance, @object
 6152               		.size	QPaletteAdvance, 8
 6153               	QPaletteAdvance:
 6154 09c3 A8        		.byte	-88
 6155 09c4 82        		.byte	-126
 6156 09c5 2A        		.byte	42
 6157 09c6 A8        		.byte	-88
 6158 09c7 82        		.byte	-126
 6159 09c8 2A        		.byte	42
 6160 09c9 A8        		.byte	-88
 6161 09ca 02        		.byte	2
 6162               		.type	pgm_paletteQ, @object
 6163               		.size	pgm_paletteQ, 16
 6164               	pgm_paletteQ:
 6165 09cb 25        		.byte	37
 6166 09cc 02        		.byte	2
 6167 09cd 07        		.byte	7
 6168 09ce 00        		.byte	0
 6169 09cf 25        		.byte	37
 6170 09d0 02        		.byte	2
 6171 09d1 02        		.byte	2
 6172 09d2 00        		.byte	0
 6173 09d3 25        		.byte	37
 6174 09d4 02        		.byte	2
 6175 09d5 01        		.byte	1
 6176 09d6 00        		.byte	0
 6177 09d7 25        		.byte	37
 6178 09d8 02        		.byte	2
 6179 09d9 02        		.byte	2
 6180 09da 00        		.byte	0
 6181               		.type	pgm_imageQ, @object
 6182               		.size	pgm_imageQ, 64
 6183               	pgm_imageQ:
 6184 09db 54        		.byte	84
 6185 09dc 55        		.byte	85
 6186 09dd 55        		.byte	85
 6187 09de 15        		.byte	21
 6188 09df A9        		.byte	-87
 6189 09e0 AA        		.byte	-86
 6190 09e1 AA        		.byte	-86
 6191 09e2 EA        		.byte	-22
 6192 09e3 B9        		.byte	-71
 6193 09e4 AA        		.byte	-86
 6194 09e5 AA        		.byte	-86
 6195 09e6 EE        		.byte	-18
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 244


 6196 09e7 A9        		.byte	-87
 6197 09e8 56        		.byte	86
 6198 09e9 A5        		.byte	-91
 6199 09ea EA        		.byte	-22
 6200 09eb A9        		.byte	-87
 6201 09ec F5        		.byte	-11
 6202 09ed 97        		.byte	-105
 6203 09ee EA        		.byte	-22
 6204 09ef A9        		.byte	-87
 6205 09f0 B5        		.byte	-75
 6206 09f1 D6        		.byte	-42
 6207 09f2 EA        		.byte	-22
 6208 09f3 A9        		.byte	-87
 6209 09f4 B5        		.byte	-75
 6210 09f5 D6        		.byte	-42
 6211 09f6 EA        		.byte	-22
 6212 09f7 A9        		.byte	-87
 6213 09f8 BE        		.byte	-66
 6214 09f9 D5        		.byte	-43
 6215 09fa EA        		.byte	-22
 6216 09fb A9        		.byte	-87
 6217 09fc 6A        		.byte	106
 6218 09fd FD        		.byte	-3
 6219 09fe EA        		.byte	-22
 6220 09ff A9        		.byte	-87
 6221 0a00 6A        		.byte	106
 6222 0a01 AD        		.byte	-83
 6223 0a02 EA        		.byte	-22
 6224 0a03 A9        		.byte	-87
 6225 0a04 AA        		.byte	-86
 6226 0a05 AF        		.byte	-81
 6227 0a06 EA        		.byte	-22
 6228 0a07 A9        		.byte	-87
 6229 0a08 6A        		.byte	106
 6230 0a09 A9        		.byte	-87
 6231 0a0a EA        		.byte	-22
 6232 0a0b A9        		.byte	-87
 6233 0a0c 6A        		.byte	106
 6234 0a0d AD        		.byte	-83
 6235 0a0e EA        		.byte	-22
 6236 0a0f B9        		.byte	-71
 6237 0a10 AA        		.byte	-86
 6238 0a11 AF        		.byte	-81
 6239 0a12 EE        		.byte	-18
 6240 0a13 A9        		.byte	-87
 6241 0a14 AA        		.byte	-86
 6242 0a15 AA        		.byte	-86
 6243 0a16 EA        		.byte	-22
 6244 0a17 FF        		.byte	-1
 6245 0a18 FF        		.byte	-1
 6246 0a19 FF        		.byte	-1
 6247 0a1a FF        		.byte	-1
 6248               	.global	spriteQUESTION3
 6249               		.type	spriteQUESTION3, @object
 6250               		.size	spriteQUESTION3, 19
 6251               	spriteQUESTION3:
 6252 0a1b 0000      		.word	pgm_imageQUESTION3
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 245


 6253 0a1d 0000      		.word	0
 6254 0a1f 0000      		.word	pgm_paletteQUESTION3
 6255 0a21 01        		.byte	1
 6256 0a22 10        		.byte	16
 6257 0a23 0000      		.word	0
 6258 0a25 0000      		.word	NadaMotion
 6259 0a27 0000      		.word	0
 6260 0a29 0000      		.word	NadaMotion
 6261 0a2b 0000      		.word	0
 6262 0a2d 01        		.byte	1
 6263               		.type	pgm_paletteQUESTION3, @object
 6264               		.size	pgm_paletteQUESTION3, 4
 6265               	pgm_paletteQUESTION3:
 6266 0a2e 25        		.byte	37
 6267 0a2f 00        		.byte	0
 6268 0a30 17        		.byte	23
 6269 0a31 07        		.byte	7
 6270               		.type	pgm_imageQUESTION3, @object
 6271               		.size	pgm_imageQUESTION3, 128
 6272               	pgm_imageQUESTION3:
 6273 0a32 FF        		.byte	-1
 6274 0a33 FF        		.byte	-1
 6275 0a34 FF        		.byte	-1
 6276 0a35 FF        		.byte	-1
 6277 0a36 FF        		.byte	-1
 6278 0a37 FF        		.byte	-1
 6279 0a38 FF        		.byte	-1
 6280 0a39 FF        		.byte	-1
 6281 0a3a FF        		.byte	-1
 6282 0a3b FF        		.byte	-1
 6283 0a3c FF        		.byte	-1
 6284 0a3d FF        		.byte	-1
 6285 0a3e FF        		.byte	-1
 6286 0a3f AA        		.byte	-86
 6287 0a40 EA        		.byte	-22
 6288 0a41 FF        		.byte	-1
 6289 0a42 BF        		.byte	-65
 6290 0a43 AA        		.byte	-86
 6291 0a44 AA        		.byte	-86
 6292 0a45 FF        		.byte	-1
 6293 0a46 BF        		.byte	-65
 6294 0a47 5A        		.byte	90
 6295 0a48 A9        		.byte	-87
 6296 0a49 FD        		.byte	-3
 6297 0a4a FF        		.byte	-1
 6298 0a4b D5        		.byte	-43
 6299 0a4c AB        		.byte	-85
 6300 0a4d FD        		.byte	-3
 6301 0a4e FF        		.byte	-1
 6302 0a4f AF        		.byte	-81
 6303 0a50 6A        		.byte	106
 6304 0a51 FD        		.byte	-3
 6305 0a52 FF        		.byte	-1
 6306 0a53 AF        		.byte	-81
 6307 0a54 56        		.byte	86
 6308 0a55 FF        		.byte	-1
 6309 0a56 FF        		.byte	-1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 246


 6310 0a57 7F        		.byte	127
 6311 0a58 F5        		.byte	-11
 6312 0a59 FF        		.byte	-1
 6313 0a5a FF        		.byte	-1
 6314 0a5b AF        		.byte	-81
 6315 0a5c FE        		.byte	-2
 6316 0a5d FF        		.byte	-1
 6317 0a5e FF        		.byte	-1
 6318 0a5f AF        		.byte	-81
 6319 0a60 F6        		.byte	-10
 6320 0a61 FF        		.byte	-1
 6321 0a62 FF        		.byte	-1
 6322 0a63 7F        		.byte	127
 6323 0a64 F5        		.byte	-11
 6324 0a65 FF        		.byte	-1
 6325 0a66 FF        		.byte	-1
 6326 0a67 FF        		.byte	-1
 6327 0a68 FF        		.byte	-1
 6328 0a69 FF        		.byte	-1
 6329 0a6a FF        		.byte	-1
 6330 0a6b FF        		.byte	-1
 6331 0a6c FF        		.byte	-1
 6332 0a6d FF        		.byte	-1
 6333 0a6e FF        		.byte	-1
 6334 0a6f FF        		.byte	-1
 6335 0a70 FF        		.byte	-1
 6336 0a71 FF        		.byte	-1
 6337 0a72 55        		.byte	85
 6338 0a73 55        		.byte	85
 6339 0a74 55        		.byte	85
 6340 0a75 55        		.byte	85
 6341 0a76 A9        		.byte	-87
 6342 0a77 AA        		.byte	-86
 6343 0a78 AA        		.byte	-86
 6344 0a79 6A        		.byte	106
 6345 0a7a 19        		.byte	25
 6346 0a7b 00        		.byte	0
 6347 0a7c 00        		.byte	0
 6348 0a7d 44        		.byte	68
 6349 0a7e 09        		.byte	9
 6350 0a7f 00        		.byte	0
 6351 0a80 00        		.byte	0
 6352 0a81 40        		.byte	64
 6353 0a82 09        		.byte	9
 6354 0a83 00        		.byte	0
 6355 0a84 00        		.byte	0
 6356 0a85 40        		.byte	64
 6357 0a86 09        		.byte	9
 6358 0a87 00        		.byte	0
 6359 0a88 00        		.byte	0
 6360 0a89 40        		.byte	64
 6361 0a8a 09        		.byte	9
 6362 0a8b 00        		.byte	0
 6363 0a8c 00        		.byte	0
 6364 0a8d 40        		.byte	64
 6365 0a8e 09        		.byte	9
 6366 0a8f 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 247


 6367 0a90 00        		.byte	0
 6368 0a91 40        		.byte	64
 6369 0a92 09        		.byte	9
 6370 0a93 00        		.byte	0
 6371 0a94 00        		.byte	0
 6372 0a95 40        		.byte	64
 6373 0a96 09        		.byte	9
 6374 0a97 00        		.byte	0
 6375 0a98 00        		.byte	0
 6376 0a99 40        		.byte	64
 6377 0a9a 09        		.byte	9
 6378 0a9b 00        		.byte	0
 6379 0a9c 00        		.byte	0
 6380 0a9d 40        		.byte	64
 6381 0a9e 09        		.byte	9
 6382 0a9f 00        		.byte	0
 6383 0aa0 00        		.byte	0
 6384 0aa1 40        		.byte	64
 6385 0aa2 09        		.byte	9
 6386 0aa3 00        		.byte	0
 6387 0aa4 00        		.byte	0
 6388 0aa5 40        		.byte	64
 6389 0aa6 19        		.byte	25
 6390 0aa7 00        		.byte	0
 6391 0aa8 00        		.byte	0
 6392 0aa9 44        		.byte	68
 6393 0aaa 09        		.byte	9
 6394 0aab 00        		.byte	0
 6395 0aac 00        		.byte	0
 6396 0aad 40        		.byte	64
 6397 0aae 55        		.byte	85
 6398 0aaf 55        		.byte	85
 6399 0ab0 55        		.byte	85
 6400 0ab1 55        		.byte	85
 6401               	.global	DefaultCamMotion
 6402               		.type	DefaultCamMotion, @object
 6403               		.size	DefaultCamMotion, 6
 6404               	DefaultCamMotion:
 6405 0ab2 00        		.byte	0
 6406 0ab3 0000      		.word	0
 6407 0ab5 00        		.byte	0
 6408 0ab6 0000      		.word	DefaultCamY
 6409               	.global	DefaultCamY
 6410               		.type	DefaultCamY, @object
 6411               		.size	DefaultCamY, 10
 6412               	DefaultCamY:
 6413 0ab8 55        		.byte	85
 6414 0ab9 55        		.byte	85
 6415 0aba 55        		.byte	85
 6416 0abb 55        		.byte	85
 6417 0abc 00        		.byte	0
 6418 0abd 03        		.byte	3
 6419 0abe 55        		.byte	85
 6420 0abf 55        		.byte	85
 6421 0ac0 55        		.byte	85
 6422 0ac1 55        		.byte	85
 6423               	.global	DefaultLayer
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 248


 6424               		.type	DefaultLayer, @object
 6425               		.size	DefaultLayer, 8
 6426               	DefaultLayer:
 6427 0ac2 FF        		.byte	-1
 6428 0ac3 FF        		.byte	-1
 6429 0ac4 00        		.byte	0
 6430 0ac5 00        		.byte	0
 6431 0ac6 00        		.byte	0
 6432 0ac7 00        		.byte	0
 6433 0ac8 00        		.byte	0
 6434 0ac9 00        		.byte	0
 6435               	.global	DefaultMotion
 6436               		.type	DefaultMotion, @object
 6437               		.size	DefaultMotion, 6
 6438               	DefaultMotion:
 6439 0aca 00        		.byte	0
 6440 0acb 0000      		.word	0
 6441 0acd F0        		.byte	-16
 6442 0ace 0000      		.word	DefaultY
 6443               	.global	DefaultY
 6444               		.type	DefaultY, @object
 6445               		.size	DefaultY, 10
 6446               	DefaultY:
 6447 0ad0 AA        		.byte	-86
 6448 0ad1 AA        		.byte	-86
 6449 0ad2 AA        		.byte	-86
 6450 0ad3 AA        		.byte	-86
 6451 0ad4 00        		.byte	0
 6452 0ad5 00        		.byte	0
 6453 0ad6 00        		.byte	0
 6454 0ad7 00        		.byte	0
 6455 0ad8 00        		.byte	0
 6456 0ad9 00        		.byte	0
 6457               	.global	NadaMotion
 6458               		.type	NadaMotion, @object
 6459               		.size	NadaMotion, 6
 6460               	NadaMotion:
 6461 0ada 0000 0000 		.zero	6
 6461      0000 
 6462               		.comm	cameraState,14,1
 6463               		.comm	nowSpriteState,14,1
 6464               	.global	skyOverrideSprite
 6465               		.section .bss
 6466               		.type	skyOverrideSprite, @object
 6467               		.size	skyOverrideSprite, 2
 6468               	skyOverrideSprite:
 6469 0007 0000      		.zero	2
 6470               		.comm	frameBuffer,272,1
 6471               	.global	header
 6472               		.section	.progmem.data,"a",@progbits
 6473               		.type	header, @object
 6474               		.size	header, 36
 6475               	header:
 6476 0ae0 4C43 4464 		.string	"LCDdirectLVDS98 2014-07-16 06:52:20"
 6476      6972 6563 
 6476      744C 5644 
 6476      5339 3820 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 249


 6476      3230 3134 
 6477               		.stabs	"pgm_imageQUESTION3:S(0,51)=ar(15,8);0;1;(15,7)",38,0,75,pgm_imageQUESTION3
 6478               		.stabs	"pgm_paletteQUESTION3:S(0,52)=ar(15,8);0;3;(15,2)",38,0,86,pgm_paletteQUESTION3
 6479               		.stabs	"pgm_imageQ:S(0,53)=ar(15,8);0;0;(15,7)",38,0,48,pgm_imageQ
 6480               		.stabs	"pgm_paletteQ:S(0,54)=ar(15,8);0;15;(15,2)",38,0,60,pgm_paletteQ
 6481               		.stabs	"pgm_imageSOLID:S(0,53)",38,0,47,pgm_imageSOLID
 6482               		.stabs	"pgm_paletteSOLID:S(0,52)",38,0,59,pgm_paletteSOLID
 6483               		.stabs	"pgm_imageGOOMBA:S(0,53)",38,0,45,pgm_imageGOOMBA
 6484               		.stabs	"pgm_paletteGOOMBA:S(0,55)=ar(15,8);0;23;(15,2)",38,0,63,pgm_paletteGOOMBA
 6485               		.stabs	"pgm_imageDEADGOOMBA:S(0,53)",38,0,44,pgm_imageDEADGOOMBA
 6486               		.stabs	"pgm_paletteDEADGOOMBA:S(0,52)",38,0,56,pgm_paletteDEADGOOMBA
 6487               		.stabs	"pgm_imageSHROOM:S(0,53)",38,0,47,pgm_imageSHROOM
 6488               		.stabs	"pgm_palette1UP:S(0,52)",38,0,61,pgm_palette1UP
 6489               		.stabs	"pgm_paletteBIG:S(0,52)",38,0,34,pgm_paletteBIG
 6490               		.stabs	"pgm_imageFLOWER:S(0,53)",38,0,50,pgm_imageFLOWER
 6491               		.stabs	"pgm_paletteFLOWER:S(0,54)",38,0,70,pgm_paletteFLOWER
 6492               		.stabs	"pgm_imageSTAR:S(0,53)",38,0,50,pgm_imageSTAR
 6493               		.stabs	"pgm_paletteSTAR:S(0,56)=ar(15,8);0;7;(15,2)",38,0,62,pgm_paletteSTAR
 6494               		.stabs	"pgm_imageCOIN:S(0,57)=ar(15,8);0;3;(15,7)",38,0,103,pgm_imageCOIN
 6495               		.stabs	"pgm_paletteCOIN:S(0,52)",38,0,129,pgm_paletteCOIN
 6496               		.stabs	"pgm_imageCLOUD:S(0,53)",38,0,87,pgm_imageCLOUD
 6497               		.stabs	"pgm_paletteCLOUD:S(0,52)",38,0,94,pgm_paletteCLOUD
 6498               		.stabs	"pgm_imageMARIO:S(0,53)",38,0,46,pgm_imageMARIO
 6499               		.stabs	"pgm_paletteMARIO:S(0,52)",38,0,53,pgm_paletteMARIO
 6500               		.stabs	"pgm_paletteLUIGI:S(0,52)",38,0,21,pgm_paletteLUIGI
 6501               		.stabs	"pgm_imageMARIORUNS:S(0,58)=ar(15,8);0;2;(15,7)",38,0,80,pgm_imageMARIORUNS
 6502               		.stabs	"pgm_imageSOLID3:S(0,53)",38,0,47,pgm_imageSOLID3
 6503               		.stabs	"pgm_imageLEAF:S(0,53)",38,0,62,pgm_imageLEAF
 6504               		.stabs	"pgm_paletteLEAF:S(0,52)",38,0,69,pgm_paletteLEAF
 6505               		.stabs	"pgm_imageTANOOKI:S(0,53)",38,0,49,pgm_imageTANOOKI
 6506               		.stabs	"pgm_paletteTANOOKI:S(0,52)",38,0,63,pgm_paletteTANOOKI
 6507               		.stabs	"pgm_imageFROG:S(0,53)",38,0,61,pgm_imageFROG
 6508               		.stabs	"pgm_paletteFROG:S(0,52)",38,0,75,pgm_paletteFROG
 6509               		.stabs	"pgm_imageBOOT:S(0,51)",38,0,69,pgm_imageBOOT
 6510               		.stabs	"pgm_paletteBOOT:S(0,52)",38,0,86,pgm_paletteBOOT
 6511               		.stabs	"pgm_imageHAMMER:S(0,53)",38,0,98,pgm_imageHAMMER
 6512               		.stabs	"pgm_paletteHAMMER:S(0,52)",38,0,114,pgm_paletteHAMMER
 6513               		.stabs	"pgm_imagePWING:S(0,53)",38,0,50,pgm_imagePWING
 6514               		.stabs	"pgm_palettePWING:S(0,52)",38,0,64,pgm_palettePWING
 6515               		.stabs	"pgm_imageMUSICBOX:S(0,58)",38,0,90,pgm_imageMUSICBOX
 6516               		.stabs	"pgm_paletteMUSICBOX:S(0,52)",38,0,108,pgm_paletteMUSICBOX
 6517               		.stabs	"header:G(0,59)=ar(15,8);0;35;(15,2)",32,0,12,0
 6518               		.stabs	"updateFrame:G(0,60)=B(4,2)",32,0,421,0
 6519               		.stabs	"frameBuffer:G(0,61)=ar(15,8);0;15;(0,62)=ar(15,8);0;16;(4,2)",32,0,44,0
 6520               		.stabs	"skyOverrideSprite:G(16,3)",32,0,119,0
 6521               		.stabs	"nowSpriteState:G(16,5)",32,0,66,0
 6522               		.stabs	"cameraState:G(16,5)",32,0,70,0
 6523               		.stabs	"NadaMotion:G(0,63)=ar(15,8);0;1;(15,10)",32,0,179,0
 6524               		.stabs	"DefaultY:G(0,64)=ar(15,8);0;9;(15,2)",32,0,73,0
 6525               		.stabs	"DefaultMotion:G(0,63)",32,0,90,0
 6526               		.stabs	"DefaultLayer:G(0,56)",32,0,96,0
 6527               		.stabs	"DefaultCamY:G(0,64)",32,0,110,0
 6528               		.stabs	"DefaultCamMotion:G(0,63)",32,0,127,0
 6529               		.stabs	"spriteQUESTION3:G(16,4)",32,0,106,0
 6530               		.stabs	"QPaletteAdvance:G(0,56)",32,0,105,0
 6531               		.stabs	"spriteQ:G(16,4)",32,0,120,0
 6532               		.stabs	"spriteSOLID:G(16,4)",32,0,62,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 250


 6533               		.stabs	"SolidBumpY:G(0,65)=ar(15,8);0;0;(15,2)",32,0,31,0
 6534               		.stabs	"SolidBumpMotion:G(0,63)",32,0,40,0
 6535               		.stabs	"spriteSOLIDBUMP:G(16,4)",32,0,44,0
 6536               		.stabs	"GoombaFlip:G(0,64)",32,0,127,0
 6537               		.stabs	"GoombaY:G(0,66)=ar(15,8);0;19;(15,2)",32,0,146,0
 6538               		.stabs	"GoombaMotion:G(0,63)",32,0,172,0
 6539               		.stabs	"GoombaCamY:G(0,66)",32,0,175,0
 6540               		.stabs	"GoombaCamMotion:G(0,63)",32,0,201,0
 6541               		.stabs	"GoombaLayer:G(0,64)",32,0,204,0
 6542               		.stabs	"GoombaPA:G(0,64)",32,0,278,0
 6543               		.stabs	"spriteGOOMBA:G(16,4)",32,0,302,0
 6544               		.stabs	"DeadGoombaMotion:G(0,63)",32,0,79,0
 6545               		.stabs	"DeadGoombaCamY:G(0,67)=ar(15,8);0;4;(15,2)",32,0,81,0
 6546               		.stabs	"DeadGoombaCamMotion:G(0,63)",32,0,92,0
 6547               		.stabs	"spriteDEADGOOMBA:G(16,4)",32,0,95,0
 6548               		.stabs	"sprite1UP:G(16,4)",32,0,64,0
 6549               		.stabs	"spriteBIG:G(16,4)",32,0,37,0
 6550               		.stabs	"FlowerPA:G(0,67)",32,0,79,0
 6551               		.stabs	"spriteFLOWER:G(16,4)",32,0,92,0
 6552               		.stabs	"spriteSTAR:G(16,4)",32,0,82,0
 6553               		.stabs	"CoinY:G(0,64)",32,0,140,0
 6554               		.stabs	"CoinMotion:G(0,63)",32,0,165,0
 6555               		.stabs	"spriteCOIN:G(16,4)",32,0,181,0
 6556               		.stabs	"spriteCLOUD:G(16,4)",32,0,111,0
 6557               		.stabs	"spriteMARIO:G(16,4)",32,0,69,0
 6558               		.stabs	"spriteLUIGI:G(16,4)",32,0,36,0
 6559               		.stabs	"MarioRunsX:G(0,68)=ar(15,8);0;5;(15,2)",32,0,93,0
 6560               		.stabs	"MarioRunsMotion:G(0,63)",32,0,109,0
 6561               		.stabs	"MarioRunsCamMotion:G(0,63)",32,0,112,0
 6562               		.stabs	"spriteMARIORUNS:G(16,4)",32,0,116,0
 6563               		.stabs	"LuigiRunsX:G(0,68)",32,0,27,0
 6564               		.stabs	"LuigiRunsMotion:G(0,63)",32,0,43,0
 6565               		.stabs	"LuigiRunsFlip:G(0,69)=ar(15,8);0;2;(15,2)",32,0,48,0
 6566               		.stabs	"spriteLUIGIRUNS:G(16,4)",32,0,56,0
 6567               		.stabs	"spriteSOLID3:G(16,4)",32,0,66,0
 6568               		.stabs	"spriteSOLIDBUMP3:G(16,4)",32,0,31,0
 6569               		.stabs	"LeafFlip:G(0,68)",32,0,93,0
 6570               		.stabs	"LeafLayer:G(0,68)",32,0,106,0
 6571               		.stabs	"LeafX:G(0,70)=ar(15,8);0;11;(15,2)",32,0,123,0
 6572               		.stabs	"LeafY:G(0,70)",32,0,142,0
 6573               		.stabs	"LeafMotion:G(0,63)",32,0,163,0
 6574               		.stabs	"LeafCamY:G(0,70)",32,0,166,0
 6575               		.stabs	"LeafCamMotion:G(0,63)",32,0,186,0
 6576               		.stabs	"spriteLEAF:G(16,4)",32,0,189,0
 6577               		.stabs	"spriteTANOOKI:G(16,4)",32,0,70,0
 6578               		.stabs	"spriteFROG:G(16,4)",32,0,82,0
 6579               		.stabs	"BootX:G(0,71)=ar(15,8);0;12;(15,2)",32,0,94,0
 6580               		.stabs	"BootY:G(0,71)",32,0,114,0
 6581               		.stabs	"BootMotion:G(0,63)",32,0,144,0
 6582               		.stabs	"BootCamY:G(0,71)",32,0,147,0
 6583               		.stabs	"BootCamMotion:G(0,63)",32,0,167,0
 6584               		.stabs	"spriteBOOT:G(16,4)",32,0,171,0
 6585               		.stabs	"spriteHAMMER:G(16,4)",32,0,127,0
 6586               		.stabs	"spritePWING:G(16,4)",32,0,71,0
 6587               		.stabs	"spriteMUSICBOX:G(16,4)",32,0,116,0
 6588               		.stabs	"callCount:G(4,2)",32,0,129,0
 6589               		.stabs	"p_nowSprite:G(16,3)",32,0,137,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 251


 6590               		.stabs	"nowIsReward:G(4,2)",32,0,143,0
 6591               		.stabs	"qVersion:G(4,2)",32,0,160,0
 6592               		.stabs	"dataEnable:G(0,60)",32,0,1045,0
 6593               		.stabs	"vSync:G(0,60)",32,0,1046,0
 6594               		.stabs	"hsyncCount:G(0,72)=B(4,4)",32,0,1047,0
 6595               		.stabs	"frameCount:G(0,60)",32,0,422,0
 6596               		.text
 6597               		.stabs	"",100,0,0,.Letext0
 6598               	.Letext0:
 6599               		.ident	"GCC: (GNU) 4.8.2"
 6600               	.global __do_copy_data
 6601               	.global __do_clear_bss
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 252


DEFINED SYMBOLS
                            *ABS*:00000000 main.c
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:2      *ABS*:0000003e __SP_H__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3      *ABS*:0000003d __SP_L__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4      *ABS*:0000003f __SREG__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5      *ABS*:00000000 __tmp_reg__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6      *ABS*:00000001 __zero_reg__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:148    .text:00000000 hitSensor_init
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:190    .text:00000018 pll_enable
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:250    .text:0000003c lvds_timerInit
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:346    .text:0000008a setColor
                            *COM*:00000110 frameBuffer
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:422    .text:000000d4 frameBufferInit
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:458    .text:000000e8 writeColorDelay
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:500    .text:000000f2 writeColor
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:526    .text:00000108 red1tst_197
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:539    .text:00000122 end_197
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:533    .text:00000116 red23_197
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:537    .text:0000011e red3_197
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:555    .text:00000138 grn4tst_198
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:568    .text:00000152 end_198
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:562    .text:00000146 grn8C_198
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:566    .text:0000014e grn3_198
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:581    .text:00000162 blu1tst_199
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:587    .text:0000016e end_199
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:585    .text:0000016a blu23_199
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:614    .text:0000017a nonRSB_drawPix
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:809    .text:00000244 setSpriteSkyColorOverride
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6468   .bss:00000007 skyOverrideSprite
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:836    .text:0000024e getRawPixelVal
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:906    .text:00000294 rawPixValToGimpColorVal
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:951    .text:000002b6 fbQ_repositionSprite
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:1194   .text:000003c0 fbQ_overlaySprite
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6251   .progmem.data:00000a1b spriteQUESTION3
                            *COM*:0000000e cameraState
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5471   .progmem.data:00000744 spriteFLOWER
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:1668   .text:000005ee pseudoRandom
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3530   .bss:00000006 callCount
                            *COM*:0000000e nowSpriteState
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:1697   .text:000005fe initSpriteStates
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3524   .data:00000002 p_nowSprite
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:1813   .text:000006ae fbQuestion_hitDetected
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6138   .progmem.data:000009b0 spriteQ
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3512   .data:00000001 qVersion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4502   .progmem.data:00000390 spriteSOLIDBUMP3
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6021   .progmem.data:0000093f spriteSOLIDBUMP
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5806   .progmem.data:00000882 spriteGOOMBA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5692   .progmem.data:0000081a spriteDEADGOOMBA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:1889   .text:00000704 __vector_2
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:1952   .text:00000750 prepReward
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3475   .bss:0000000a lastReward.2322
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5603   .progmem.data:000007c3 sprite1UP
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5581   .progmem.data:000007ac spriteBIG
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5378   .progmem.data:000006e9 spriteSTAR
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4897   .progmem.data:00000514 spriteMARIO
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4875   .progmem.data:000004fd spriteLUIGI
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4329   .progmem.data:000002fd spriteLEAF
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 253


/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4986   .progmem.data:0000056b spriteCLOUD
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4240   .progmem.data:000002a6 spriteTANOOKI
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4151   .progmem.data:0000024f spriteFROG
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3931   .progmem.data:00000185 spriteBOOT
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3842   .progmem.data:0000012e spriteHAMMER
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3753   .progmem.data:000000d7 spritePWING
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3536   .progmem.data:00000000 spriteMUSICBOX
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5075   .progmem.data:000005c2 spriteCOIN
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3518   .bss:00000005 nowIsReward
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:2185   .text:00000822 prepNextSprite
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4639   .progmem.data:00000418 spriteMARIORUNS
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4599   .progmem.data:000003f6 spriteLUIGIRUNS
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6049   .progmem.data:00000959 spriteSOLID
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4517   .progmem.data:000003a3 spriteSOLID3
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:2320   .text:000008be fbQ_drawBackground
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:2389   .text:00000900 fbQuestion_update
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:2594   .text:000009ec frameBufferUpdate
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3490   .data:00000000 updateFrame
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3477   .bss:0000000b fbLastUpdateTime.2072
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:2694   .text:00000a68 getSpritePalette
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:2821   .text:00000abc getSpritePhase
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:2924   .text:00000b06 lcd_init
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3501   .bss:00000003 vSync
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3496   .bss:00000001 hsyncCount
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3506   .bss:00000004 dataEnable
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:2959   .text:00000b20 lcd_update
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3177   .text:00000be0 restartFrameUpdate
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3200   .text:00000be8 __vector_14
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3484   .bss:00000000 frameCount
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3289   .text:00000c5a init_hsyncTimer
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3328   .text:00000c72 drawPix
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3349   .text:00000c74 isNewFrame
                             .bss:00000009 lastFrameCount.2471
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3388   .text.startup:00000000 main
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3557   .progmem.data:00000017 pgm_imageMUSICBOX
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3550   .progmem.data:00000013 pgm_paletteMUSICBOX
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6438   .progmem.data:00000aca DefaultMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6426   .progmem.data:00000ac2 DefaultLayer
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6404   .progmem.data:00000ab2 DefaultCamMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3774   .progmem.data:000000ee pgm_imagePWING
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3767   .progmem.data:000000ea pgm_palettePWING
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3863   .progmem.data:00000145 pgm_imageHAMMER
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3856   .progmem.data:00000141 pgm_paletteHAMMER
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4019   .progmem.data:000001cf pgm_imageBOOT
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4012   .progmem.data:000001cb pgm_paletteBOOT
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3971   .progmem.data:000001ab BootMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3946   .progmem.data:00000198 BootCamMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3954   .progmem.data:0000019e BootCamY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3996   .progmem.data:000001be BootX
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:3979   .progmem.data:000001b1 BootY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4172   .progmem.data:00000266 pgm_imageFROG
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4165   .progmem.data:00000262 pgm_paletteFROG
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4261   .progmem.data:000002bd pgm_imageTANOOKI
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4254   .progmem.data:000002b9 pgm_paletteTANOOKI
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4434   .progmem.data:00000350 pgm_imageLEAF
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4427   .progmem.data:0000034c pgm_paletteLEAF
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4418   .progmem.data:00000346 LeafFlip
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 254


/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4368   .progmem.data:00000322 LeafMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4408   .progmem.data:00000340 LeafLayer
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4344   .progmem.data:00000310 LeafCamMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4352   .progmem.data:00000316 LeafCamY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4392   .progmem.data:00000334 LeafX
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4376   .progmem.data:00000328 LeafY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4531   .progmem.data:000003b6 pgm_imageSOLID3
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6265   .progmem.data:00000a2e pgm_paletteQUESTION3
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6036   .progmem.data:00000952 SolidBumpMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6460   .progmem.data:00000ada NadaMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4679   .progmem.data:0000043d pgm_imageMARIORUNS
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4889   .progmem.data:00000510 pgm_paletteLUIGI
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4614   .progmem.data:00000409 LuigiRunsFlip
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4621   .progmem.data:0000040c LuigiRunsMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4654   .progmem.data:0000042b MarioRunsCamMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4629   .progmem.data:00000412 LuigiRunsX
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6446   .progmem.data:00000ad0 DefaultY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4911   .progmem.data:00000527 pgm_paletteMARIO
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4662   .progmem.data:00000431 MarioRunsMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6412   .progmem.data:00000ab8 DefaultCamY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4670   .progmem.data:00000437 MarioRunsX
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:4918   .progmem.data:0000052b pgm_imageMARIO
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5007   .progmem.data:00000582 pgm_imageCLOUD
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5000   .progmem.data:0000057e pgm_paletteCLOUD
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5090   .progmem.data:000005d5 CoinMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5118   .progmem.data:000005e9 pgm_imageCOIN
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5111   .progmem.data:000005e5 pgm_paletteCOIN
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5098   .progmem.data:000005db CoinY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5403   .progmem.data:00000704 pgm_imageSTAR
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5392   .progmem.data:000006fc pgm_paletteSTAR
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5486   .progmem.data:00000757 FlowerPA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5513   .progmem.data:0000076c pgm_imageFLOWER
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5494   .progmem.data:0000075c pgm_paletteFLOWER
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5624   .progmem.data:000007da pgm_imageSHROOM
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5595   .progmem.data:000007bf pgm_paletteBIG
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5617   .progmem.data:000007d6 pgm_palette1UP
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5738   .progmem.data:00000842 pgm_imageDEADGOOMBA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5731   .progmem.data:0000083e pgm_paletteDEADGOOMBA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5724   .progmem.data:00000838 DeadGoombaMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5707   .progmem.data:0000082d DeadGoombaCamMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5715   .progmem.data:00000833 DeadGoombaCamY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5953   .progmem.data:000008ff pgm_imageGOOMBA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5926   .progmem.data:000008e7 pgm_paletteGOOMBA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5913   .progmem.data:000008dd GoombaFlip
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5881   .progmem.data:000008c3 GoombaMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5835   .progmem.data:0000089f GoombaLayer
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5849   .progmem.data:000008a9 GoombaCamMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5821   .progmem.data:00000895 GoombaPA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5857   .progmem.data:000008af GoombaCamY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:5889   .progmem.data:000008c9 GoombaY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6070   .progmem.data:00000970 pgm_imageSOLID
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6063   .progmem.data:0000096c pgm_paletteSOLID
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6044   .progmem.data:00000958 SolidBumpY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6183   .progmem.data:000009db pgm_imageQ
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6164   .progmem.data:000009cb pgm_paletteQ
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6153   .progmem.data:000009c3 QPaletteAdvance
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6272   .progmem.data:00000a32 pgm_imageQUESTION3
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s 			page 255


/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//cc833J6k.s:6475   .progmem.data:00000ae0 header

UNDEFINED SYMBOLS
__mulhi3
__udivmodhi4
__mulqi3
__udivmodqi4
__divmodhi4
tcnter_get
tcnter_myTcnter
tcnter_overflowUpdate
timer_setWGM
timer_selectDivisor
timer_compareMatchIntSetup
init_heartBeat
setHeartRate
heartPinInputPoll
heartUpdate
__do_copy_data
__do_clear_bss
