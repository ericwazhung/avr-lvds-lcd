GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 1


   1               		.file	"main.c"
   2               	__SREG__ = 0x3f
   3               	__SP_H__ = 0x3e
   4               	__SP_L__ = 0x3d
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.global __do_copy_data
   8               		.global __do_clear_bss
   9               		.stabs	"/Users/meh/_avrProjects/LCDdirectLVDS/59-reallyCommon2/",100,0,2,.Ltext0
  10               		.stabs	"main.c",100,0,2,.Ltext0
  11               		.text
  12               	.Ltext0:
  13               		.stabs	"gcc2_compiled.",60,0,0,0
  14               		.stabs	"int:t(0,1)=r(0,1);-32768;32767;",128,0,1,0
  15               		.stabs	"char:t(0,2)=@s8;r(0,2);0;255;",128,0,1,0
  16               		.stabs	"long int:t(0,3)=@s32;r(0,3);020000000000;017777777777;",128,0,1,0
  17               		.stabs	"unsigned int:t(0,4)=r(0,4);0;0177777;",128,0,1,0
  18               		.stabs	"long unsigned int:t(0,5)=@s32;r(0,5);0;037777777777;",128,0,1,0
  19               		.stabs	"long long int:t(0,6)=@s64;r(0,6);01000000000000000000000;0777777777777777777777;",128,0,1,
  20               		.stabs	"long long unsigned int:t(0,7)=@s64;r(0,7);0;01777777777777777777777;",128,0,1,0
  21               		.stabs	"short int:t(0,8)=r(0,8);-32768;32767;",128,0,1,0
  22               		.stabs	"short unsigned int:t(0,9)=r(0,9);0;0177777;",128,0,1,0
  23               		.stabs	"signed char:t(0,10)=@s8;r(0,10);-128;127;",128,0,1,0
  24               		.stabs	"unsigned char:t(0,11)=@s8;r(0,11);0;255;",128,0,1,0
  25               		.stabs	"float:t(0,12)=r(0,1);4;0;",128,0,1,0
  26               		.stabs	"double:t(0,13)=r(0,1);4;0;",128,0,1,0
  27               		.stabs	"long double:t(0,14)=r(0,1);4;0;",128,0,1,0
  28               		.stabs	"void:t(0,15)=(0,15)",128,0,1,0
  29               		.stabs	"projInfo.h",130,0,0,0
  30               		.stabs	"/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/inttypes.h",130,0,0,0
  31               		.stabs	"/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/stdint.h",130,0,0,0
  32               		.stabs	"int8_t:t(3,1)=(0,10)",128,0,121,0
  33               		.stabs	"uint8_t:t(3,2)=(0,11)",128,0,122,0
  34               		.stabs	"int16_t:t(3,3)=(0,1)",128,0,123,0
  35               		.stabs	"uint16_t:t(3,4)=(0,4)",128,0,124,0
  36               		.stabs	"int32_t:t(3,5)=(0,3)",128,0,125,0
  37               		.stabs	"uint32_t:t(3,6)=(0,5)",128,0,126,0
  38               		.stabs	"int64_t:t(3,7)=(0,6)",128,0,128,0
  39               		.stabs	"uint64_t:t(3,8)=(0,7)",128,0,129,0
  40               		.stabs	"intptr_t:t(3,9)=(3,3)",128,0,142,0
  41               		.stabs	"uintptr_t:t(3,10)=(3,4)",128,0,147,0
  42               		.stabs	"int_least8_t:t(3,11)=(3,1)",128,0,159,0
  43               		.stabs	"uint_least8_t:t(3,12)=(3,2)",128,0,164,0
  44               		.stabs	"int_least16_t:t(3,13)=(3,3)",128,0,169,0
  45               		.stabs	"uint_least16_t:t(3,14)=(3,4)",128,0,174,0
  46               		.stabs	"int_least32_t:t(3,15)=(3,5)",128,0,179,0
  47               		.stabs	"uint_least32_t:t(3,16)=(3,6)",128,0,184,0
  48               		.stabs	"int_least64_t:t(3,17)=(3,7)",128,0,192,0
  49               		.stabs	"uint_least64_t:t(3,18)=(3,8)",128,0,199,0
  50               		.stabs	"int_fast8_t:t(3,19)=(3,1)",128,0,213,0
  51               		.stabs	"uint_fast8_t:t(3,20)=(3,2)",128,0,218,0
  52               		.stabs	"int_fast16_t:t(3,21)=(3,3)",128,0,223,0
  53               		.stabs	"uint_fast16_t:t(3,22)=(3,4)",128,0,228,0
  54               		.stabs	"int_fast32_t:t(3,23)=(3,5)",128,0,233,0
  55               		.stabs	"uint_fast32_t:t(3,24)=(3,6)",128,0,238,0
  56               		.stabs	"int_fast64_t:t(3,25)=(3,7)",128,0,246,0
  57               		.stabs	"uint_fast64_t:t(3,26)=(3,8)",128,0,253,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 2


  58               		.stabs	"intmax_t:t(3,27)=(3,7)",128,0,273,0
  59               		.stabs	"uintmax_t:t(3,28)=(3,8)",128,0,278,0
  60               		.stabn	162,0,0,0
  61               		.stabs	"int_farptr_t:t(2,1)=(3,5)",128,0,77,0
  62               		.stabs	"uint_farptr_t:t(2,2)=(3,6)",128,0,81,0
  63               		.stabn	162,0,0,0
  64               		.stabn	162,0,0,0
  65               		.stabs	"main.h",130,0,0,0
  66               		.stabs	"/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/avr/io.h",130,0,0,0
  67               		.stabs	"/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/avr/fuse.h",130,0,0,0
  68               		.stabs	"__fuse_t:t(6,1)=(6,2)=s3low:(0,11),0,8;high:(0,11),8,8;extended:(0,11),16,8;;",128,0,244,0
  69               		.stabn	162,0,0,0
  70               		.stabn	162,0,0,0
  71               		.stabs	"/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/stdlib.h",130,0,0,0
  72               		.stabs	"/usr/local/lib/gcc/avr/4.4.5/include/stddef.h",130,0,0,0
  73               		.stabs	"size_t:t(8,1)=(0,4)",128,0,211,0
  74               		.stabs	"wchar_t:t(8,2)=(0,1)",128,0,323,0
  75               		.stabn	162,0,0,0
  76               		.stabs	"div_t:t(7,1)=(7,2)=s4quot:(0,1),0,16;rem:(0,1),16,16;;",128,0,71,0
  77               		.stabs	"ldiv_t:t(7,3)=(7,4)=s8quot:(0,3),0,32;rem:(0,3),32,32;;",128,0,77,0
  78               		.stabs	"__compar_fn_t:t(7,5)=(7,6)=*(7,7)=f(0,1)",128,0,80,0
  79               		.stabn	162,0,0,0
  80               		.stabs	"_commonCode_localized/heartbeat/1.21/heartbeat.h",130,0,0,0
  81               		.stabs	"./_commonCode_localized/hfModulation/0.93/hfModulation.h",130,0,0,0
  82               		.stabs	"hfm_t:t(10,1)=(10,2)=B(10,3)=s6runningSum:(3,4),0,16;desiredSum:(3,4),16,16;maxPower:(3,2)
  83               		.stabn	162,0,0,0
  84               		.stabn	162,0,0,0
  85               		.stabn	162,0,0,0
  86               		.stabs	"/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/avr/pgmspace.h",130,0,0,0
  87               		.stabs	"prog_void:t(11,1)=(11,2)=(11,2)",128,0,217,0
  88               		.stabs	"prog_char:t(11,3)=(11,4)=@s8;r(11,4);0;255;",128,0,218,0
  89               		.stabs	"prog_uchar:t(11,5)=(11,6)=@s8;r(11,6);0;255;",128,0,219,0
  90               		.stabs	"prog_int8_t:t(11,7)=(11,8)=(0,10)",128,0,221,0
  91               		.stabs	"prog_uint8_t:t(11,9)=(11,10)=(0,11)",128,0,222,0
  92               		.stabs	"prog_int16_t:t(11,11)=(11,12)=(0,1)",128,0,223,0
  93               		.stabs	"prog_uint16_t:t(11,13)=(11,14)=(0,4)",128,0,224,0
  94               		.stabs	"prog_int32_t:t(11,15)=(11,16)=(0,3)",128,0,225,0
  95               		.stabs	"prog_uint32_t:t(11,17)=(11,18)=(0,5)",128,0,226,0
  96               		.stabs	"prog_int64_t:t(11,19)=(11,20)=(0,6)",128,0,228,0
  97               		.stabs	"prog_uint64_t:t(11,21)=(11,22)=(0,7)",128,0,229,0
  98               		.stabn	162,0,0,0
  99               		.stabs	"_commonCode_localized/sineTable/0.99/sineTable.h",130,0,0,0
 100               		.stabs	"theta_t:t(12,1)=(3,3)",128,0,69,0
 101               		.stabs	"sine_t:t(12,2)=(3,3)",128,0,96,0
 102               		.stabs	"mult_t:t(12,3)=(3,5)",128,0,99,0
 103               		.stabs	"axis_t:t(12,4)=(3,5)",128,0,114,0
 104               		.stabn	162,0,0,0
 105               		.stabs	"rowSegBuffer.c",130,0,0,0
 106               		.stabs	"_NONAME_:T(13,1)=s2red_length:(3,2),0,8;green_blue:(3,2),8,8;;",128,0,0,0
 107               		.stabs	"seg_t:t(13,2)=(13,1)",128,0,101,0
 108               		.stabn	162,0,0,0
 109               		.stabs	"icons/Question.h",130,0,0,0
 110               		.stabs	"icons/iconPacking.h",130,0,0,0
 111               		.stabs	"_BLAH_SHROOM_:T(15,1)=s7p_image:(15,2)=*(3,2),0,16;p_mask:(15,2),16,16;p_palette:(15,2),32
 112               		.stabs	"sprite_t:t(15,3)=(15,1)",128,0,25,0
 113               		.stabn	162,0,0,0
 114               		.stabn	162,0,0,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 3


 115               		.stabs	"getTetBrick:F(3,2)",36,0,378,getTetBrick
 116               		.stabs	"row:P(3,2)",64,0,378,24
 117               		.stabs	"col:P(3,2)",64,0,378,22
 118               	.global	getTetBrick
 119               		.type	getTetBrick, @function
 120               	getTetBrick:
 121               		.stabd	46,0,0
 122               		.stabs	"tetStuff.c",132,0,0,.Ltext1
 123               	.Ltext1:
   1:tetStuff.c    **** #if (TRUE)
   2:tetStuff.c    **** 
   3:tetStuff.c    **** //in main...
   4:tetStuff.c    **** uint8_t fb_to_rb(uint8_t fbColor);
   5:tetStuff.c    **** 
   6:tetStuff.c    **** // Tetris:
   7:tetStuff.c    **** // 10 across
   8:tetStuff.c    **** // 18 up
   9:tetStuff.c    **** // 7 pieces (colors = 3 bits each)
  10:tetStuff.c    **** // Using 4 bits, for easy-access: 90 bytes
  11:tetStuff.c    **** // Using 3 bits: 67.5 bytes
  12:tetStuff.c    **** // How about a happy-medium... use 32-bits for a row...
  13:tetStuff.c    **** #define TET_HEIGHT	18
  14:tetStuff.c    **** #define TET_WIDTH		10
  15:tetStuff.c    **** #define TET_TOP_ROW  (0)
  16:tetStuff.c    **** 
  17:tetStuff.c    **** extern uint16_t pgm_tetPiece[7][4];
  18:tetStuff.c    **** #define bin4x4(b15,b14,b13,b12,\
  19:tetStuff.c    **** 		         b11,b10, b9, b8,\
  20:tetStuff.c    **** 		          b7, b6, b5, b4,\
  21:tetStuff.c    ****                 b3, b2, b1, b0)\
  22:tetStuff.c    ****          ((bin(b15,b14,b13,b12,b11,b10, b9, b8) << 8) | \
  23:tetStuff.c    **** 			          (bin( b7, b6, b5, b4, b3, b2, b1, b0)))
  24:tetStuff.c    **** 
  25:tetStuff.c    **** #define getTetPieceBrick(piece, orientation, row, col) \
  26:tetStuff.c    **** 	   getbit((row*4+col), pgm_getTetPiece(piece,orientation))
  27:tetStuff.c    **** 
  28:tetStuff.c    **** #define pgm_getTetPiece(piece,orientation) \
  29:tetStuff.c    **** 	   ((uint16_t)pgm_read_word(&(pgm_tetPiece[piece][orientation])))
  30:tetStuff.c    **** 
  31:tetStuff.c    **** uint8_t getTetBrick(uint8_t row, uint8_t col);
  32:tetStuff.c    **** void setTetBrick(uint8_t row, uint8_t col, uint8_t val);
  33:tetStuff.c    **** uint8_t tetBrick_to_fb(uint8_t tetBrick);
  34:tetStuff.c    **** 	
  35:tetStuff.c    **** //For now, let's just test that it works...
  36:tetStuff.c    **** // (This could be implemented with bitfields?)
  37:tetStuff.c    **** uint32_t tetRow[TET_HEIGHT];
  38:tetStuff.c    **** 
  39:tetStuff.c    **** void tetInit(uint8_t filledRows)
  40:tetStuff.c    **** {
  41:tetStuff.c    **** 	uint8_t row;
  42:tetStuff.c    **** 
  43:tetStuff.c    **** 	//Clear the board...
  44:tetStuff.c    **** 	for(row=0; row<TET_HEIGHT; row++)
  45:tetStuff.c    **** 		tetRow[row]=0;
  46:tetStuff.c    **** #if (TRUE) //Load random-ish "bricks" for testing...
  47:tetStuff.c    **** 	uint8_t col;
  48:tetStuff.c    **** 	//Now, leaving the first several rows blank for piece-testing...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 4


  49:tetStuff.c    **** 	for(row=TET_HEIGHT-filledRows; row<TET_HEIGHT; row++)
  50:tetStuff.c    **** 		for(col=0; col<TET_WIDTH; col++)
  51:tetStuff.c    **** 			setTetBrick(row, col, (row+col)&0x07);
  52:tetStuff.c    **** 
  53:tetStuff.c    **** #endif
  54:tetStuff.c    **** #if (FALSE) //Just throw some random pieces in for testing... Dun Woik
  55:tetStuff.c    **** 	row = 0;
  56:tetStuff.c    **** 	uint8_t col;
  57:tetStuff.c    **** 	uint8_t piece = 0;
  58:tetStuff.c    **** 	uint8_t pieceRow;
  59:tetStuff.c    **** 
  60:tetStuff.c    **** 	for(col=0; col<TET_WIDTH; col++)
  61:tetStuff.c    **** 	{
  62:tetStuff.c    **** 		piece = col/4;
  63:tetStuff.c    **** 
  64:tetStuff.c    **** 		for(pieceRow=0; pieceRow<4; pieceRow++)
  65:tetStuff.c    **** 			setTetBrick(pieceRow + row, col, (row+col) & 0x07);
  66:tetStuff.c    **** 				  	//(getTetPieceBrick(piece,0,pieceRow,col)) ? piece : 0);
  67:tetStuff.c    **** 
  68:tetStuff.c    **** 		row+=4;
  69:tetStuff.c    **** 
  70:tetStuff.c    **** 	}
  71:tetStuff.c    **** #endif
  72:tetStuff.c    **** }
  73:tetStuff.c    **** 
  74:tetStuff.c    **** 
  75:tetStuff.c    **** //Also determines color (pieceNum+1)...
  76:tetStuff.c    **** uint8_t pieceNum = 0;
  77:tetStuff.c    **** uint8_t pieceOrientation = 0;
  78:tetStuff.c    **** //Upper-Left corner
  79:tetStuff.c    **** uint8_t pieceTopRow = 0;
  80:tetStuff.c    **** uint8_t pieceLeftCol = 0;
  81:tetStuff.c    **** #define PIECE_HEIGHT 4
  82:tetStuff.c    **** #define PIECE_WIDTH	4
  83:tetStuff.c    **** #define NUM_PIECES	7
  84:tetStuff.c    **** #define PIECE_STARTCOL 3
  85:tetStuff.c    **** #define PIECE_STARTROW 0
  86:tetStuff.c    **** 
  87:tetStuff.c    **** 
  88:tetStuff.c    **** static __inline__ \
  89:tetStuff.c    **** void tet_drawRow(uint8_t rowNum, uint8_t rowBuffer[]) \
  90:tetStuff.c    **** 	  __attribute__((__always_inline__));
  91:tetStuff.c    **** //This assumes rowBuffer[] points to the first column we should draw
  92:tetStuff.c    **** // it could be called as, e.g. tet_drawRow(rbRowNum, &RealRowBuffer[5])
  93:tetStuff.c    **** // to shift it right five pixels...
  94:tetStuff.c    **** // rowNum corresponds to the row in drawable pixels
  95:tetStuff.c    **** // (though this may change later... for, e.g. high vertical resolution)
  96:tetStuff.c    **** // (e.g. for brick separators...)
  97:tetStuff.c    **** void tet_drawRow(uint8_t rowNum, uint8_t rowBuffer[])
  98:tetStuff.c    **** {
  99:tetStuff.c    **** 	uint8_t i; 
 100:tetStuff.c    **** 
 101:tetStuff.c    **** 	if( (rowNum >= TET_TOP_ROW) &&
 102:tetStuff.c    **** 		 (rowNum < TET_TOP_ROW+TET_HEIGHT) )
 103:tetStuff.c    **** 	{
 104:tetStuff.c    **** 		//left border:
 105:tetStuff.c    **** 		rowBuffer[0]=fb_to_rb(_W);
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 5


 106:tetStuff.c    **** 
 107:tetStuff.c    **** 		//Draw active (and inactive) bricks
 108:tetStuff.c    **** 		for(i=1; i<=TET_WIDTH; i++)
 109:tetStuff.c    **** 		{
 110:tetStuff.c    **** 			rowBuffer[i]=
 111:tetStuff.c    **** 				fb_to_rb(tetBrick_to_fb(
 112:tetStuff.c    **** 							getTetBrick(rowNum-TET_TOP_ROW,i-1)));
 113:tetStuff.c    **** 		}
 114:tetStuff.c    **** 
 115:tetStuff.c    **** 		//right border:
 116:tetStuff.c    **** 		rowBuffer[i]=fb_to_rb(_W);
 117:tetStuff.c    **** 
 118:tetStuff.c    **** 		//SEE NOTE in main.c re: _b and _c -> _W syncing...
 119:tetStuff.c    **** 	}
 120:tetStuff.c    **** 	//bottom border:
 121:tetStuff.c    **** 	else if(rowNum == TET_TOP_ROW+TET_HEIGHT)
 122:tetStuff.c    **** 		for(i=0; i<=TET_WIDTH+1; i++)
 123:tetStuff.c    **** 			rowBuffer[i]=fb_to_rb(_W);
 124:tetStuff.c    **** //	else
 125:tetStuff.c    **** //		return;
 126:tetStuff.c    **** 
 127:tetStuff.c    **** 
 128:tetStuff.c    **** 	//Active (falling) piece:
 129:tetStuff.c    **** 
 130:tetStuff.c    **** 	if((rowNum >= pieceTopRow) &&
 131:tetStuff.c    **** 		(rowNum < pieceTopRow+PIECE_HEIGHT) )
 132:tetStuff.c    **** 	{
 133:tetStuff.c    **** 		uint8_t pieceRowNum = rowNum - pieceTopRow;
 134:tetStuff.c    **** 
 135:tetStuff.c    **** 		for(i=0; i<PIECE_WIDTH; i++)
 136:tetStuff.c    **** 		{
 137:tetStuff.c    **** 			uint8_t pieceBrick = 
 138:tetStuff.c    **** 					getTetPieceBrick(pieceNum, pieceOrientation, 
 139:tetStuff.c    **** 										  pieceRowNum, i);
 140:tetStuff.c    **** 
 141:tetStuff.c    **** 			//Only draw piece pixels (not black/empty pixels)
 142:tetStuff.c    **** 			// (we don't want to overwrite nearby bricks)
 143:tetStuff.c    **** 			if(pieceBrick)
 144:tetStuff.c    **** 			//+1 for the left border...
 145:tetStuff.c    **** 				rowBuffer[i+1+pieceLeftCol] =
 146:tetStuff.c    **** 						fb_to_rb(tetBrick_to_fb(pieceNum+1));
 147:tetStuff.c    **** 		}
 148:tetStuff.c    **** 	}
 149:tetStuff.c    **** 
 150:tetStuff.c    **** 
 151:tetStuff.c    **** 
 152:tetStuff.c    **** 
 153:tetStuff.c    **** 	//Draw "TETRIS" vertically...
 154:tetStuff.c    **** #define CHARACTER_START_COL   14 //FB_WIDTH
 155:tetStuff.c    ****    //i=FB_WIDTH;
 156:tetStuff.c    ****    i=CHARACTER_START_COL;
 157:tetStuff.c    **** 
 158:tetStuff.c    ****    uint8_t charRow;
 159:tetStuff.c    ****    uint8_t color;
 160:tetStuff.c    ****    char character;
 161:tetStuff.c    ****    switch(rowNum/8)
 162:tetStuff.c    ****    {
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 6


 163:tetStuff.c    ****          case 0:
 164:tetStuff.c    ****             //charRow = getCharRow('T', rowNum%8);
 165:tetStuff.c    ****             character = 'T';
 166:tetStuff.c    ****             color = _R;
 167:tetStuff.c    ****             break;
 168:tetStuff.c    ****          case 1:
 169:tetStuff.c    ****             //charRow = getCharRow('E', rowNum%8);
 170:tetStuff.c    ****             character = 'E';
 171:tetStuff.c    ****             color = _O;
 172:tetStuff.c    ****             break;
 173:tetStuff.c    ****          case 2:
 174:tetStuff.c    ****             //charRow = getCharRow('T', rowNum%8);
 175:tetStuff.c    ****             character = 'T';
 176:tetStuff.c    ****             color = _Y;
 177:tetStuff.c    ****             break;
 178:tetStuff.c    ****          case 3:
 179:tetStuff.c    ****             { 
 180:tetStuff.c    ****                uint8_t z, temp;
 181:tetStuff.c    ****                
 182:tetStuff.c    ****                //Reverse the "R" to make it look Russian
 183:tetStuff.c    ****                // And shift it one left...
 184:tetStuff.c    ****                temp = getCharRow('R', rowNum%8);
 185:tetStuff.c    ****                
 186:tetStuff.c    ****                for(z=0; z<8; z++)
 187:tetStuff.c    ****                {
 188:tetStuff.c    ****                   writebit(7-z, charRow, getbit(z,temp));
 189:tetStuff.c    ****                }  
 190:tetStuff.c    ****                //Characters are reversed... bit 0 is far-left
 191:tetStuff.c    ****                //So to shift a character left, I must shift its bits right
 192:tetStuff.c    ****                // (right?)
 193:tetStuff.c    ****                charRow >>= 1;
 194:tetStuff.c    ****                color = _G; 
 195:tetStuff.c    ****             }  
 196:tetStuff.c    ****             break;
 197:tetStuff.c    ****          case 4:
 198:tetStuff.c    ****             //charRow = getCharRow('I', rowNum%8);
 199:tetStuff.c    ****             character = 'I';
 200:tetStuff.c    ****             color = _C; 
 201:tetStuff.c    ****             break;
 202:tetStuff.c    ****          case 5:
 203:tetStuff.c    ****             //charRow = getCharRow('S', rowNum%8);
 204:tetStuff.c    ****             character = 'S';
 205:tetStuff.c    ****             color = _B; 
 206:tetStuff.c    ****             break;
 207:tetStuff.c    ****          default:
 208:tetStuff.c    ****             character = ' ';
 209:tetStuff.c    ****             //charRow = 0;
 210:tetStuff.c    ****             break;
 211:tetStuff.c    ****    }     
 212:tetStuff.c    **** 
 213:tetStuff.c    **** 	//Load charRow for all cases except the backwards "R"
 214:tetStuff.c    **** 	// which is handled above...      
 215:tetStuff.c    ****    if(rowNum/8 != 3)
 216:tetStuff.c    ****          charRow = getCharRow(character, rowNum%8);
 217:tetStuff.c    **** 
 218:tetStuff.c    ****    i++;
 219:tetStuff.c    **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 7


 220:tetStuff.c    ****    uint8_t j;
 221:tetStuff.c    ****    for(j=0; j<8; j++)
 222:tetStuff.c    ****          if(getbit(j, charRow))
 223:tetStuff.c    ****             //frameBuffer[rowNum][j+i+1] = 0x25;
 224:tetStuff.c    ****             rowBuffer[j+i] = fb_to_rb(color); //0x25);
 225:tetStuff.c    ****          else
 226:tetStuff.c    ****             //frameBuffer[rowNum][j+i+1] = 0x01;
 227:tetStuff.c    ****             rowBuffer[j+i] = fb_to_rb(0x00);
 228:tetStuff.c    **** 
 229:tetStuff.c    **** 
 230:tetStuff.c    **** }
 231:tetStuff.c    **** 
 232:tetStuff.c    **** void tetUpdate(void)
 233:tetStuff.c    **** {
 234:tetStuff.c    **** 	//For now, we're just experimenting with the different pieces/
 235:tetStuff.c    **** 	// orientations/positions...	
 236:tetStuff.c    **** 	static uint8_t callCount = 0;
 237:tetStuff.c    **** 	static uint8_t newPieceHitCount=0;
 238:tetStuff.c    **** 
 239:tetStuff.c    **** 	uint8_t new_pieceOrientation;
 240:tetStuff.c    **** 	uint8_t new_pieceTopRow;
 241:tetStuff.c    **** 	uint8_t new_pieceLeftCol;
 242:tetStuff.c    **** //	uint8_t new_pieceNum;
 243:tetStuff.c    **** 
 244:tetStuff.c    **** 	uint8_t pieceRow;
 245:tetStuff.c    **** 	uint8_t pieceCol;
 246:tetStuff.c    **** 
 247:tetStuff.c    **** 	uint8_t noChange = FALSE;
 248:tetStuff.c    **** 	uint8_t settle = FALSE;
 249:tetStuff.c    **** 
 250:tetStuff.c    **** 	if(newPieceHitCount == 5)
 251:tetStuff.c    **** 	{
 252:tetStuff.c    **** 		newPieceHitCount = 0;
 253:tetStuff.c    **** 		tetInit(0);
 254:tetStuff.c    **** 	}
 255:tetStuff.c    **** 
 256:tetStuff.c    **** 	new_pieceOrientation = pieceOrientation;
 257:tetStuff.c    **** 	new_pieceLeftCol = pieceLeftCol;
 258:tetStuff.c    **** 	new_pieceTopRow = pieceTopRow;
 259:tetStuff.c    **** 
 260:tetStuff.c    **** 	if(callCount%4 == 2)
 261:tetStuff.c    ****    {
 262:tetStuff.c    **** 		new_pieceOrientation=pieceOrientation+1;
 263:tetStuff.c    ****       if (new_pieceOrientation==4)
 264:tetStuff.c    **** 			new_pieceOrientation=0;
 265:tetStuff.c    **** 	}
 266:tetStuff.c    **** 
 267:tetStuff.c    ****       if(callCount%4==0)
 268:tetStuff.c    ****       {  
 269:tetStuff.c    ****          new_pieceLeftCol=pieceLeftCol+1;
 270:tetStuff.c    **** 		}
 271:tetStuff.c    **** 
 272:tetStuff.c    **** 		if(callCount%4==3)
 273:tetStuff.c    **** 		{
 274:tetStuff.c    **** 			new_pieceTopRow=pieceTopRow+1;
 275:tetStuff.c    ****       }
 276:tetStuff.c    **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 8


 277:tetStuff.c    **** 	callCount++;
 278:tetStuff.c    **** 
 279:tetStuff.c    **** 
 280:tetStuff.c    **** 
 281:tetStuff.c    **** 
 282:tetStuff.c    **** 
 283:tetStuff.c    **** 	//Check for collision in the new piece position/orientation...
 284:tetStuff.c    **** 	//Starting from the bottom... (intentional wraparound)
 285:tetStuff.c    **** 	for(pieceRow = 3; (pieceRow < 128) && !settle && !noChange; pieceRow--)
 286:tetStuff.c    **** 		for(pieceCol = 0; pieceCol < 4; pieceCol++)
 287:tetStuff.c    **** 		{
 288:tetStuff.c    **** 			//This isn't particularly efficient...
 289:tetStuff.c    **** 			// rereading each time...
 290:tetStuff.c    **** 			uint8_t pieceBrick =
 291:tetStuff.c    **** 						getTetPieceBrick(pieceNum, new_pieceOrientation,
 292:tetStuff.c    **** 											  pieceRow, pieceCol);
 293:tetStuff.c    **** 
 294:tetStuff.c    **** 			uint8_t boardRow = new_pieceTopRow + pieceRow;
 295:tetStuff.c    **** 
 296:tetStuff.c    **** 			uint8_t boardCol = new_pieceLeftCol + pieceCol;
 297:tetStuff.c    **** 
 298:tetStuff.c    **** 			uint8_t boardBrick = getTetBrick(boardRow, boardCol);
 299:tetStuff.c    **** 
 300:tetStuff.c    **** 
 301:tetStuff.c    **** 			if(pieceBrick)
 302:tetStuff.c    **** 			{
 303:tetStuff.c    **** 				if(boardRow >= TET_HEIGHT)
 304:tetStuff.c    **** 				{
 305:tetStuff.c    **** 					noChange = TRUE;
 306:tetStuff.c    **** 					settle = TRUE;
 307:tetStuff.c    **** 					break;
 308:tetStuff.c    **** 				}
 309:tetStuff.c    **** 
 310:tetStuff.c    **** 				//There's some plausibility for some oddities here...
 311:tetStuff.c    **** 				// revisit 41-15.zip
 312:tetStuff.c    **** 				if(boardCol >= TET_WIDTH)
 313:tetStuff.c    **** 				{
 314:tetStuff.c    **** 				   noChange = TRUE;
 315:tetStuff.c    **** 				   break;
 316:tetStuff.c    **** 				}
 317:tetStuff.c    **** 
 318:tetStuff.c    **** 
 319:tetStuff.c    **** 				if(boardBrick)
 320:tetStuff.c    **** 				{
 321:tetStuff.c    **** 					//Must be a settle...
 322:tetStuff.c    **** 					if((new_pieceOrientation == pieceOrientation) &&
 323:tetStuff.c    **** 						(new_pieceLeftCol == pieceLeftCol))
 324:tetStuff.c    **** 						settle = TRUE;
 325:tetStuff.c    **** 
 326:tetStuff.c    **** 					noChange = TRUE;
 327:tetStuff.c    **** 					break;
 328:tetStuff.c    **** 				}
 329:tetStuff.c    **** 			}
 330:tetStuff.c    **** 		}
 331:tetStuff.c    **** 
 332:tetStuff.c    **** 
 333:tetStuff.c    **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 9


 334:tetStuff.c    **** 
 335:tetStuff.c    **** 
 336:tetStuff.c    **** 	if(!noChange)
 337:tetStuff.c    **** 	{
 338:tetStuff.c    **** 		pieceOrientation = new_pieceOrientation;
 339:tetStuff.c    **** 		pieceLeftCol = new_pieceLeftCol;
 340:tetStuff.c    **** 		pieceTopRow = new_pieceTopRow;
 341:tetStuff.c    **** 	}
 342:tetStuff.c    **** 
 343:tetStuff.c    **** 	if(settle)
 344:tetStuff.c    **** 	{
 345:tetStuff.c    **** 		// Check if we've hit on a new piece...
 346:tetStuff.c    **** 		if((pieceTopRow == PIECE_STARTROW) &&
 347:tetStuff.c    **** 		   (pieceLeftCol == PIECE_STARTCOL) &&
 348:tetStuff.c    **** 		   (pieceOrientation == 0))
 349:tetStuff.c    **** 		   newPieceHitCount++;
 350:tetStuff.c    **** 
 351:tetStuff.c    **** 
 352:tetStuff.c    **** 		//Load the piece into the board...
 353:tetStuff.c    **** 		for(pieceRow = 0; pieceRow < 4; pieceRow++)
 354:tetStuff.c    **** 			for(pieceCol = 0; pieceCol < 4; pieceCol++)
 355:tetStuff.c    **** 			{
 356:tetStuff.c    **** 				if(getTetPieceBrick(pieceNum, pieceOrientation,
 357:tetStuff.c    **** 										  pieceRow, pieceCol))
 358:tetStuff.c    **** 				setTetBrick(pieceTopRow+pieceRow,
 359:tetStuff.c    **** 								pieceLeftCol+pieceCol,
 360:tetStuff.c    **** 								pieceNum+1);
 361:tetStuff.c    **** 			}
 362:tetStuff.c    **** 
 363:tetStuff.c    **** 
 364:tetStuff.c    **** 		//Load a new piece...
 365:tetStuff.c    **** 		pieceNum++;
 366:tetStuff.c    **** 		if(pieceNum==NUM_PIECES)
 367:tetStuff.c    **** 			pieceNum = 0;
 368:tetStuff.c    **** 		pieceLeftCol = PIECE_STARTCOL;
 369:tetStuff.c    **** 		pieceTopRow = PIECE_STARTROW;
 370:tetStuff.c    **** 		pieceOrientation = 0;
 371:tetStuff.c    **** 	}
 372:tetStuff.c    **** 
 373:tetStuff.c    **** }
 374:tetStuff.c    **** 
 375:tetStuff.c    **** //returns a 3-bit value
 376:tetStuff.c    **** // 0 corresponds to no brick
 377:tetStuff.c    **** // 1-7 corresponds to the type of piece the brick came from...
 378:tetStuff.c    **** uint8_t getTetBrick(uint8_t row, uint8_t col)
 379:tetStuff.c    **** {
 124               		.stabn	68,0,379,.LM0-.LFBB1
 125               	.LM0:
 126               	.LFBB1:
 127               	/* prologue: function */
 128               	/* frame size = 0 */
 129               		.stabn	68,0,379,.LM1-.LFBB1
 130               	.LM1:
 131 0000 E82F      		mov r30,r24
 132 0002 F0E0      		ldi r31,lo8(0)
 133 0004 EE0F      		lsl r30
 134 0006 FF1F      		rol r31
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 10


 135 0008 EE0F      		lsl r30
 136 000a FF1F      		rol r31
 137 000c E050      		subi r30,lo8(-(tetRow))
 138 000e F040      		sbci r31,hi8(-(tetRow))
 139 0010 862F      		mov r24,r22
 140 0012 90E0      		ldi r25,lo8(0)
 141 0014 63E0      		ldi r22,lo8(3)
 142 0016 70E0      		ldi r23,hi8(3)
 143 0018 00D0      		rcall __mulhi3
 144 001a 2081      		ld r18,Z
 145 001c 3181      		ldd r19,Z+1
 146 001e 4281      		ldd r20,Z+2
 147 0020 5381      		ldd r21,Z+3
 148 0022 00C0      		rjmp 2f
 149 0024 5695      	1:	lsr r21
 150 0026 4795      		ror r20
 151 0028 3795      		ror r19
 152 002a 2795      		ror r18
 153 002c 8A95      	2:	dec r24
 154 002e 02F4      		brpl 1b
 380:tetStuff.c    **** 	//uint8_t tetCol = col*3;
 381:tetStuff.c    **** //	uint8_t tetMask = '\007';
 382:tetStuff.c    **** 	
 383:tetStuff.c    **** 	return ((uint8_t)(tetRow[row] >> (3*col))) & '\007';
 384:tetStuff.c    **** 
 385:tetStuff.c    **** }
 155               		.stabn	68,0,385,.LM2-.LFBB1
 156               	.LM2:
 157 0030 822F      		mov r24,r18
 158 0032 8770      		andi r24,lo8(7)
 159               	/* epilogue start */
 160 0034 0895      		ret
 161               		.size	getTetBrick, .-getTetBrick
 162               	.Lscope1:
 163               		.stabs	"",36,0,0,.Lscope1-.LFBB1
 164               		.stabd	78,0,0
 165               		.stabs	"setTetBrick:F(0,15)",36,0,391,setTetBrick
 166               		.stabs	"row:P(3,2)",64,0,391,24
 167               		.stabs	"col:P(3,2)",64,0,391,22
 168               		.stabs	"val:P(3,2)",64,0,391,20
 169               	.global	setTetBrick
 170               		.type	setTetBrick, @function
 171               	setTetBrick:
 172               		.stabd	46,0,0
 386:tetStuff.c    **** 
 387:tetStuff.c    **** 
 388:tetStuff.c    **** //val should only be 0-7
 389:tetStuff.c    **** // 0 corresponds to no brick
 390:tetStuff.c    **** // 1-7 corresponds to the type of piece the brick came from...
 391:tetStuff.c    **** void setTetBrick(uint8_t row, uint8_t col, uint8_t val)
 392:tetStuff.c    **** {
 173               		.stabn	68,0,392,.LM3-.LFBB2
 174               	.LM3:
 175               	.LFBB2:
 176 0036 0F93      		push r16
 177 0038 1F93      		push r17
 178               	/* prologue: function */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 11


 179               	/* frame size = 0 */
 393:tetStuff.c    **** 	//Clear the old value...
 394:tetStuff.c    **** 	tetRow[row] &= ~(((uint32_t)'\007')<<(3*col));
 180               		.stabn	68,0,394,.LM4-.LFBB2
 181               	.LM4:
 182 003a E82F      		mov r30,r24
 183 003c F0E0      		ldi r31,lo8(0)
 184 003e 862F      		mov r24,r22
 185 0040 90E0      		ldi r25,lo8(0)
 186 0042 63E0      		ldi r22,lo8(3)
 187 0044 70E0      		ldi r23,hi8(3)
 188 0046 00D0      		rcall __mulhi3
 189 0048 A82F      		mov r26,r24
 395:tetStuff.c    **** 	//Write the new value...
 396:tetStuff.c    **** 	tetRow[row] |= (((uint32_t)val)<<(3*col));
 190               		.stabn	68,0,396,.LM5-.LFBB2
 191               	.LM5:
 192 004a EE0F      		lsl r30
 193 004c FF1F      		rol r31
 194 004e EE0F      		lsl r30
 195 0050 FF1F      		rol r31
 196 0052 E050      		subi r30,lo8(-(tetRow))
 197 0054 F040      		sbci r31,hi8(-(tetRow))
 198 0056 67E0      		ldi r22,lo8(7)
 199 0058 70E0      		ldi r23,hi8(7)
 200 005a 80E0      		ldi r24,hlo8(7)
 201 005c 90E0      		ldi r25,hhi8(7)
 202 005e 0A2E      		mov r0,r26
 203 0060 00C0      		rjmp 2f
 204 0062 660F      	1:	lsl r22
 205 0064 771F      		rol r23
 206 0066 881F      		rol r24
 207 0068 991F      		rol r25
 208 006a 0A94      	2:	dec r0
 209 006c 02F4      		brpl 1b
 210 006e 6095      		com r22
 211 0070 7095      		com r23
 212 0072 8095      		com r24
 213 0074 9095      		com r25
 214 0076 0081      		ld r16,Z
 215 0078 1181      		ldd r17,Z+1
 216 007a 2281      		ldd r18,Z+2
 217 007c 3381      		ldd r19,Z+3
 218 007e 6023      		and r22,r16
 219 0080 7123      		and r23,r17
 220 0082 8223      		and r24,r18
 221 0084 9323      		and r25,r19
 222 0086 242F      		mov r18,r20
 223 0088 30E0      		ldi r19,lo8(0)
 224 008a 40E0      		ldi r20,lo8(0)
 225 008c 50E0      		ldi r21,hi8(0)
 226 008e 00C0      		rjmp 2f
 227 0090 220F      	1:	lsl r18
 228 0092 331F      		rol r19
 229 0094 441F      		rol r20
 230 0096 551F      		rol r21
 231 0098 AA95      	2:	dec r26
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 12


 232 009a 02F4      		brpl 1b
 233 009c 622B      		or r22,r18
 234 009e 732B      		or r23,r19
 235 00a0 842B      		or r24,r20
 236 00a2 952B      		or r25,r21
 237 00a4 6083      		st Z,r22
 238 00a6 7183      		std Z+1,r23
 239 00a8 8283      		std Z+2,r24
 240 00aa 9383      		std Z+3,r25
 241               	/* epilogue start */
 397:tetStuff.c    **** }
 242               		.stabn	68,0,397,.LM6-.LFBB2
 243               	.LM6:
 244 00ac 1F91      		pop r17
 245 00ae 0F91      		pop r16
 246 00b0 0895      		ret
 247               		.size	setTetBrick, .-setTetBrick
 248               	.Lscope2:
 249               		.stabs	"",36,0,0,.Lscope2-.LFBB2
 250               		.stabd	78,0,0
 251               		.stabs	"tetInit:F(0,15)",36,0,39,tetInit
 252               		.stabs	"filledRows:P(3,2)",64,0,39,24
 253               	.global	tetInit
 254               		.type	tetInit, @function
 255               	tetInit:
 256               		.stabd	46,0,0
  40:tetStuff.c    **** {
 257               		.stabn	68,0,40,.LM7-.LFBB3
 258               	.LM7:
 259               	.LFBB3:
 260 00b2 0F93      		push r16
 261 00b4 1F93      		push r17
 262               	/* prologue: function */
 263               	/* frame size = 0 */
  40:tetStuff.c    **** {
 264               		.stabn	68,0,40,.LM8-.LFBB3
 265               	.LM8:
 266 00b6 E0E0      		ldi r30,lo8(tetRow)
 267 00b8 F0E0      		ldi r31,hi8(tetRow)
 268               	.L6:
  45:tetStuff.c    **** 		tetRow[row]=0;
 269               		.stabn	68,0,45,.LM9-.LFBB3
 270               	.LM9:
 271 00ba 1192      		st Z+,__zero_reg__
 272 00bc 1192      		st Z+,__zero_reg__
 273 00be 1192      		st Z+,__zero_reg__
 274 00c0 1192      		st Z+,__zero_reg__
  44:tetStuff.c    **** 	for(row=0; row<TET_HEIGHT; row++)
 275               		.stabn	68,0,44,.LM10-.LFBB3
 276               	.LM10:
 277 00c2 90E0      		ldi r25,hi8(tetRow+72)
 278 00c4 E030      		cpi r30,lo8(tetRow+72)
 279 00c6 F907      		cpc r31,r25
 280 00c8 01F4      		brne .L6
  49:tetStuff.c    **** 	for(row=TET_HEIGHT-filledRows; row<TET_HEIGHT; row++)
 281               		.stabn	68,0,49,.LM11-.LFBB3
 282               	.LM11:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 13


 283 00ca 12E1      		ldi r17,lo8(18)
 284 00cc 181B      		sub r17,r24
 285 00ce 00C0      		rjmp .L7
 286               	.L9:
 287 00d0 00E0      		ldi r16,lo8(0)
 288               	.L8:
  51:tetStuff.c    **** 			setTetBrick(row, col, (row+col)&0x07);
 289               		.stabn	68,0,51,.LM12-.LFBB3
 290               	.LM12:
 291 00d2 402F      		mov r20,r16
 292 00d4 410F      		add r20,r17
 293 00d6 4770      		andi r20,lo8(7)
 294 00d8 812F      		mov r24,r17
 295 00da 602F      		mov r22,r16
 296 00dc 00D0      		rcall setTetBrick
  50:tetStuff.c    **** 		for(col=0; col<TET_WIDTH; col++)
 297               		.stabn	68,0,50,.LM13-.LFBB3
 298               	.LM13:
 299 00de 0F5F      		subi r16,lo8(-(1))
 300 00e0 0A30      		cpi r16,lo8(10)
 301 00e2 01F4      		brne .L8
  49:tetStuff.c    **** 	for(row=TET_HEIGHT-filledRows; row<TET_HEIGHT; row++)
 302               		.stabn	68,0,49,.LM14-.LFBB3
 303               	.LM14:
 304 00e4 1F5F      		subi r17,lo8(-(1))
 305               	.L7:
 306 00e6 1231      		cpi r17,lo8(18)
 307 00e8 00F0      		brlo .L9
 308               	/* epilogue start */
  72:tetStuff.c    **** }
 309               		.stabn	68,0,72,.LM15-.LFBB3
 310               	.LM15:
 311 00ea 1F91      		pop r17
 312 00ec 0F91      		pop r16
 313 00ee 0895      		ret
 314               		.size	tetInit, .-tetInit
 315               		.stabs	"row:r(3,2)",64,0,41,17
 316               		.stabs	"col:r(3,2)",64,0,47,16
 317               		.stabn	192,0,0,.LFBB3-.LFBB3
 318               		.stabn	224,0,0,.Lscope3-.LFBB3
 319               	.Lscope3:
 320               		.stabs	"",36,0,0,.Lscope3-.LFBB3
 321               		.stabd	78,0,0
 322               		.stabs	"tetUpdate:F(0,15)",36,0,232,tetUpdate
 323               	.global	tetUpdate
 324               		.type	tetUpdate, @function
 325               	tetUpdate:
 326               		.stabd	46,0,0
 233:tetStuff.c    **** {
 327               		.stabn	68,0,233,.LM16-.LFBB4
 328               	.LM16:
 329               	.LFBB4:
 330 00f0 2F92      		push r2
 331 00f2 3F92      		push r3
 332 00f4 4F92      		push r4
 333 00f6 5F92      		push r5
 334 00f8 6F92      		push r6
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 14


 335 00fa 7F92      		push r7
 336 00fc 8F92      		push r8
 337 00fe 9F92      		push r9
 338 0100 AF92      		push r10
 339 0102 BF92      		push r11
 340 0104 CF92      		push r12
 341 0106 DF92      		push r13
 342 0108 EF92      		push r14
 343 010a FF92      		push r15
 344 010c 0F93      		push r16
 345 010e 1F93      		push r17
 346 0110 DF93      		push r29
 347 0112 CF93      		push r28
 348 0114 00D0      		rcall .
 349 0116 CDB7      		in r28,__SP_L__
 350 0118 DEB7      		in r29,__SP_H__
 351               	/* prologue: function */
 352               	/* frame size = 2 */
 250:tetStuff.c    **** 	if(newPieceHitCount == 5)
 353               		.stabn	68,0,250,.LM17-.LFBB4
 354               	.LM17:
 355 011a 8091 0000 		lds r24,newPieceHitCount.1823
 356 011e 8530      		cpi r24,lo8(5)
 357 0120 01F4      		brne .L15
 252:tetStuff.c    **** 		newPieceHitCount = 0;
 358               		.stabn	68,0,252,.LM18-.LFBB4
 359               	.LM18:
 360 0122 1092 0000 		sts newPieceHitCount.1823,__zero_reg__
 253:tetStuff.c    **** 		tetInit(0);
 361               		.stabn	68,0,253,.LM19-.LFBB4
 362               	.LM19:
 363 0126 80E0      		ldi r24,lo8(0)
 364 0128 00D0      		rcall tetInit
 365               	.L15:
 256:tetStuff.c    **** 	new_pieceOrientation = pieceOrientation;
 366               		.stabn	68,0,256,.LM20-.LFBB4
 367               	.LM20:
 368 012a 3090 0000 		lds r3,pieceOrientation
 257:tetStuff.c    **** 	new_pieceLeftCol = pieceLeftCol;
 369               		.stabn	68,0,257,.LM21-.LFBB4
 370               	.LM21:
 371 012e 4091 0000 		lds r20,pieceLeftCol
 258:tetStuff.c    **** 	new_pieceTopRow = pieceTopRow;
 372               		.stabn	68,0,258,.LM22-.LFBB4
 373               	.LM22:
 374 0132 2090 0000 		lds r2,pieceTopRow
 260:tetStuff.c    **** 	if(callCount%4 == 2)
 375               		.stabn	68,0,260,.LM23-.LFBB4
 376               	.LM23:
 377 0136 5091 0000 		lds r21,callCount.1822
 378 013a 852F      		mov r24,r21
 379 013c 90E0      		ldi r25,lo8(0)
 380 013e 8370      		andi r24,lo8(3)
 381 0140 9070      		andi r25,hi8(3)
 382 0142 8230      		cpi r24,2
 383 0144 9105      		cpc r25,__zero_reg__
 384 0146 01F4      		brne .L16
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 15


 262:tetStuff.c    **** 		new_pieceOrientation=pieceOrientation+1;
 385               		.stabn	68,0,262,.LM24-.LFBB4
 386               	.LM24:
 387 0148 232D      		mov r18,r3
 388 014a 2F5F      		subi r18,lo8(-(1))
 263:tetStuff.c    ****       if (new_pieceOrientation==4)
 389               		.stabn	68,0,263,.LM25-.LFBB4
 390               	.LM25:
 391 014c 2430      		cpi r18,lo8(4)
 392 014e 01F0      		breq .+2
 393 0150 00C0      		rjmp .L18
 394 0152 00C0      		rjmp .L48
 395               	.L16:
 267:tetStuff.c    ****       if(callCount%4==0)
 396               		.stabn	68,0,267,.LM26-.LFBB4
 397               	.LM26:
 398 0154 0097      		sbiw r24,0
 399 0156 01F4      		brne .L19
 269:tetStuff.c    ****          new_pieceLeftCol=pieceLeftCol+1;
 400               		.stabn	68,0,269,.LM27-.LFBB4
 401               	.LM27:
 402 0158 342F      		mov r19,r20
 403 015a 3F5F      		subi r19,lo8(-(1))
 404 015c 00C0      		rjmp .L43
 405               	.L19:
 272:tetStuff.c    **** 		if(callCount%4==3)
 406               		.stabn	68,0,272,.LM28-.LFBB4
 407               	.LM28:
 408 015e 8330      		cpi r24,3
 409 0160 9105      		cpc r25,__zero_reg__
 410 0162 01F4      		brne .L45
 274:tetStuff.c    **** 			new_pieceTopRow=pieceTopRow+1;
 411               		.stabn	68,0,274,.LM29-.LFBB4
 412               	.LM29:
 413 0164 2394      		inc r2
 414               	.L45:
 415 0166 342F      		mov r19,r20
 416               	.L43:
 417 0168 232D      		mov r18,r3
 418               	.L20:
 277:tetStuff.c    **** 	callCount++;
 419               		.stabn	68,0,277,.LM30-.LFBB4
 420               	.LM30:
 421 016a 5F5F      		subi r21,lo8(-(1))
 422 016c 5093 0000 		sts callCount.1822,r21
 423               	.LBB81:
 424               	.LBB82:
 291:tetStuff.c    **** 						getTetPieceBrick(pieceNum, new_pieceOrientation,
 425               		.stabn	68,0,291,.LM31-.LFBB4
 426               	.LM31:
 427 0170 8091 0000 		lds r24,pieceNum
 428 0174 90E0      		ldi r25,lo8(0)
 429 0176 880F      		lsl r24
 430 0178 991F      		rol r25
 431 017a 880F      		lsl r24
 432 017c 991F      		rol r25
 433 017e 820F      		add r24,r18
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 16


 434 0180 911D      		adc r25,__zero_reg__
 435 0182 880F      		lsl r24
 436 0184 991F      		rol r25
 437 0186 8050      		subi r24,lo8(-(pgm_tetPiece))
 438 0188 9040      		sbci r25,hi8(-(pgm_tetPiece))
 439 018a 122D      		mov r17,r2
 440 018c 1D5F      		subi r17,lo8(-(3))
 441 018e A0E0      		ldi r26,lo8(0)
 442 0190 B3E0      		ldi r27,lo8(3)
 443 0192 FC01      		movw r30,r24
 444               	/* #APP */
 445               	 ;  291 "tetStuff.c" 1
 446 0194 C590      		lpm r12, Z+
 447 0196 D490      		lpm r13, Z
 448               		
 449               	 ;  0 "" 2
 450               	/* #NOAPP */
 451 0198 00C0      		rjmp .L22
 452               	.L26:
 453               	.LBE82:
 301:tetStuff.c    **** 			if(pieceBrick)
 454               		.stabn	68,0,301,.LM32-.LFBB4
 455               	.LM32:
 456 019a CF01      		movw r24,r30
 457 019c 8E0D      		add r24,r14
 458 019e 9F1D      		adc r25,r15
 459 01a0 2601      		movw r4,r12
 460 01a2 00C0      		rjmp 2f
 461 01a4 5694      	1:	lsr r5
 462 01a6 4794      		ror r4
 463 01a8 8A95      	2:	dec r24
 464 01aa 02F4      		brpl 1b
 465 01ac 40FE      		sbrs r4,0
 466 01ae 00C0      		rjmp .L23
 303:tetStuff.c    **** 				if(boardRow >= TET_HEIGHT)
 467               		.stabn	68,0,303,.LM33-.LFBB4
 468               	.LM33:
 469 01b0 1231      		cpi r17,lo8(18)
 470 01b2 00F4      		brsh .L24
 312:tetStuff.c    **** 				if(boardCol >= TET_WIDTH)
 471               		.stabn	68,0,312,.LM34-.LFBB4
 472               	.LM34:
 473 01b4 0A30      		cpi r16,lo8(10)
 474 01b6 00F4      		brsh .L25
 319:tetStuff.c    **** 				if(boardBrick)
 475               		.stabn	68,0,319,.LM35-.LFBB4
 476               	.LM35:
 477 01b8 802F      		mov r24,r16
 478 01ba 90E0      		ldi r25,lo8(0)
 479 01bc 63E0      		ldi r22,lo8(3)
 480 01be 70E0      		ldi r23,hi8(3)
 481 01c0 00D0      		rcall __mulhi3
 482 01c2 2401      		movw r4,r8
 483 01c4 3501      		movw r6,r10
 484 01c6 00C0      		rjmp 2f
 485 01c8 7694      	1:	lsr r7
 486 01ca 6794      		ror r6
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 17


 487 01cc 5794      		ror r5
 488 01ce 4794      		ror r4
 489 01d0 8A95      	2:	dec r24
 490 01d2 02F4      		brpl 1b
 491 01d4 842D      		mov r24,r4
 492 01d6 8770      		andi r24,lo8(7)
 493 01d8 01F0      		breq .L23
 322:tetStuff.c    **** 					if((new_pieceOrientation == pieceOrientation) &&
 494               		.stabn	68,0,322,.LM36-.LFBB4
 495               	.LM36:
 496 01da 2315      		cp r18,r3
 497 01dc 01F4      		brne .L25
 498 01de 3417      		cp r19,r20
 499 01e0 01F4      		brne .L25
 500 01e2 00C0      		rjmp .L24
 501               	.L23:
 502 01e4 3196      		adiw r30,1
 503 01e6 0F5F      		subi r16,lo8(-(1))
 504               	.LBE81:
 286:tetStuff.c    **** 		for(pieceCol = 0; pieceCol < 4; pieceCol++)
 505               		.stabn	68,0,286,.LM37-.LFBB4
 506               	.LM37:
 507 01e8 E430      		cpi r30,4
 508 01ea F105      		cpc r31,__zero_reg__
 509 01ec 01F4      		brne .L26
 510 01ee 80E0      		ldi r24,lo8(0)
 511 01f0 00C0      		rjmp .L27
 512               	.L24:
 513 01f2 81E0      		ldi r24,lo8(1)
 514 01f4 00C0      		rjmp .L44
 515               	.L25:
 516 01f6 80E0      		ldi r24,lo8(0)
 517               	.L44:
 518 01f8 A1E0      		ldi r26,lo8(1)
 519               	.L27:
 285:tetStuff.c    **** 	for(pieceRow = 3; (pieceRow < 128) && !settle && !noChange; pieceRow--)
 520               		.stabn	68,0,285,.LM38-.LFBB4
 521               	.LM38:
 522 01fa B150      		subi r27,lo8(-(-1))
 523 01fc 1150      		subi r17,lo8(-(-1))
 524 01fe BF3F      		cpi r27,lo8(-1)
 525 0200 01F0      		breq .L28
 526 0202 8823      		tst r24
 527 0204 01F4      		brne .L28
 528               	.L22:
 529 0206 AA23      		tst r26
 530 0208 01F0      		breq .+2
 531 020a 00C0      		rjmp .L37
 532               	.LBB85:
 291:tetStuff.c    **** 						getTetPieceBrick(pieceNum, new_pieceOrientation,
 533               		.stabn	68,0,291,.LM39-.LFBB4
 534               	.LM39:
 535 020c EB2E      		mov r14,r27
 536 020e FF24      		clr r15
 537 0210 EE0C      		lsl r14
 538 0212 FF1C      		rol r15
 539 0214 EE0C      		lsl r14
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 18


 540 0216 FF1C      		rol r15
 541               	.LBB83:
 542               	.LBB84:
 383:tetStuff.c    **** 	return ((uint8_t)(tetRow[row] >> (3*col))) & '\007';
 543               		.stabn	68,0,383,.LM40-.LFBB4
 544               	.LM40:
 545 0218 E12F      		mov r30,r17
 546 021a F0E0      		ldi r31,lo8(0)
 547 021c EE0F      		lsl r30
 548 021e FF1F      		rol r31
 549 0220 EE0F      		lsl r30
 550 0222 FF1F      		rol r31
 551 0224 E050      		subi r30,lo8(-(tetRow))
 552 0226 F040      		sbci r31,hi8(-(tetRow))
 553 0228 8080      		ld r8,Z
 554 022a 9180      		ldd r9,Z+1
 555 022c A280      		ldd r10,Z+2
 556 022e B380      		ldd r11,Z+3
 557 0230 032F      		mov r16,r19
 558 0232 E0E0      		ldi r30,lo8(0)
 559 0234 F0E0      		ldi r31,hi8(0)
 560 0236 00C0      		rjmp .L26
 561               	.L28:
 562               	.LBE84:
 563               	.LBE83:
 564               	.LBE85:
 336:tetStuff.c    **** 	if(!noChange)
 565               		.stabn	68,0,336,.LM41-.LFBB4
 566               	.LM41:
 567 0238 AA23      		tst r26
 568 023a 01F4      		brne .L30
 338:tetStuff.c    **** 		pieceOrientation = new_pieceOrientation;
 569               		.stabn	68,0,338,.LM42-.LFBB4
 570               	.LM42:
 571 023c 2093 0000 		sts pieceOrientation,r18
 339:tetStuff.c    **** 		pieceLeftCol = new_pieceLeftCol;
 572               		.stabn	68,0,339,.LM43-.LFBB4
 573               	.LM43:
 574 0240 3093 0000 		sts pieceLeftCol,r19
 340:tetStuff.c    **** 		pieceTopRow = new_pieceTopRow;
 575               		.stabn	68,0,340,.LM44-.LFBB4
 576               	.LM44:
 577 0244 2092 0000 		sts pieceTopRow,r2
 578               	.L30:
 343:tetStuff.c    **** 	if(settle)
 579               		.stabn	68,0,343,.LM45-.LFBB4
 580               	.LM45:
 581 0248 8823      		tst r24
 582 024a 01F4      		brne .+2
 583 024c 00C0      		rjmp .L37
 346:tetStuff.c    **** 		if((pieceTopRow == PIECE_STARTROW) &&
 584               		.stabn	68,0,346,.LM46-.LFBB4
 585               	.LM46:
 586 024e 8091 0000 		lds r24,pieceTopRow
 587 0252 8823      		tst r24
 588 0254 01F0      		breq .+2
 589 0256 00C0      		rjmp .L31
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 19


 590 0258 8091 0000 		lds r24,pieceLeftCol
 591 025c 8330      		cpi r24,lo8(3)
 592 025e 01F0      		breq .+2
 593 0260 00C0      		rjmp .L31
 594 0262 8091 0000 		lds r24,pieceOrientation
 595 0266 8823      		tst r24
 596 0268 01F0      		breq .+2
 597 026a 00C0      		rjmp .L31
 349:tetStuff.c    **** 		   newPieceHitCount++;
 598               		.stabn	68,0,349,.LM47-.LFBB4
 599               	.LM47:
 600 026c 8091 0000 		lds r24,newPieceHitCount.1823
 601 0270 8F5F      		subi r24,lo8(-(1))
 602 0272 8093 0000 		sts newPieceHitCount.1823,r24
 603 0276 00C0      		rjmp .L31
 604               	.L34:
 605               	.LBB86:
 356:tetStuff.c    **** 				if(getTetPieceBrick(pieceNum, pieceOrientation,
 606               		.stabn	68,0,356,.LM48-.LFBB4
 607               	.LM48:
 608 0278 4091 0000 		lds r20,pieceNum
 609 027c E42F      		mov r30,r20
 610 027e F0E0      		ldi r31,lo8(0)
 611 0280 EE0F      		lsl r30
 612 0282 FF1F      		rol r31
 613 0284 EE0F      		lsl r30
 614 0286 FF1F      		rol r31
 615 0288 8091 0000 		lds r24,pieceOrientation
 616 028c E80F      		add r30,r24
 617 028e F11D      		adc r31,__zero_reg__
 618 0290 EE0F      		lsl r30
 619 0292 FF1F      		rol r31
 620 0294 E050      		subi r30,lo8(-(pgm_tetPiece))
 621 0296 F040      		sbci r31,hi8(-(pgm_tetPiece))
 622               	/* #APP */
 623               	 ;  356 "tetStuff.c" 1
 624 0298 8591      		lpm r24, Z+
 625 029a 9491      		lpm r25, Z
 626               		
 627               	 ;  0 "" 2
 628               	/* #NOAPP */
 629               	.LBE86:
 630 029c B701      		movw r22,r14
 631 029e 620F      		add r22,r18
 632 02a0 731F      		adc r23,r19
 633 02a2 00C0      		rjmp 2f
 634 02a4 9695      	1:	lsr r25
 635 02a6 8795      		ror r24
 636 02a8 6A95      	2:	dec r22
 637 02aa 02F4      		brpl 1b
 638 02ac 80FF      		sbrs r24,0
 639 02ae 00C0      		rjmp .L33
 358:tetStuff.c    **** 				setTetBrick(pieceTopRow+pieceRow,
 640               		.stabn	68,0,358,.LM49-.LFBB4
 641               	.LM49:
 642 02b0 8091 0000 		lds r24,pieceTopRow
 643 02b4 6091 0000 		lds r22,pieceLeftCol
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 20


 644 02b8 6E0D      		add r22,r14
 645 02ba 4F5F      		subi r20,lo8(-(1))
 646 02bc 810F      		add r24,r17
 647 02be 2983      		std Y+1,r18
 648 02c0 3A83      		std Y+2,r19
 649 02c2 00D0      		rcall setTetBrick
 650 02c4 3A81      		ldd r19,Y+2
 651 02c6 2981      		ldd r18,Y+1
 652               	.L33:
 653 02c8 0894      		sec
 654 02ca E11C      		adc r14,__zero_reg__
 655 02cc F11C      		adc r15,__zero_reg__
 354:tetStuff.c    **** 			for(pieceCol = 0; pieceCol < 4; pieceCol++)
 656               		.stabn	68,0,354,.LM50-.LFBB4
 657               	.LM50:
 658 02ce 64E0      		ldi r22,lo8(4)
 659 02d0 E616      		cp r14,r22
 660 02d2 F104      		cpc r15,__zero_reg__
 661 02d4 01F4      		brne .L34
 353:tetStuff.c    **** 		for(pieceRow = 0; pieceRow < 4; pieceRow++)
 662               		.stabn	68,0,353,.LM51-.LFBB4
 663               	.LM51:
 664 02d6 1F5F      		subi r17,lo8(-(1))
 665 02d8 2C5F      		subi r18,lo8(-(4))
 666 02da 3F4F      		sbci r19,hi8(-(4))
 667 02dc 1430      		cpi r17,lo8(4)
 668 02de 01F4      		brne .L38
 669 02e0 00C0      		rjmp .L49
 670               	.L31:
 671 02e2 20E0      		ldi r18,lo8(0)
 672 02e4 30E0      		ldi r19,hi8(0)
 673 02e6 10E0      		ldi r17,lo8(0)
 674               	.L38:
 675 02e8 EE24      		clr r14
 676 02ea FF24      		clr r15
 677 02ec 00C0      		rjmp .L34
 678               	.L49:
 365:tetStuff.c    **** 		pieceNum++;
 679               		.stabn	68,0,365,.LM52-.LFBB4
 680               	.LM52:
 681 02ee 8091 0000 		lds r24,pieceNum
 682 02f2 8F5F      		subi r24,lo8(-(1))
 683 02f4 8093 0000 		sts pieceNum,r24
 366:tetStuff.c    **** 		if(pieceNum==NUM_PIECES)
 684               		.stabn	68,0,366,.LM53-.LFBB4
 685               	.LM53:
 686 02f8 8730      		cpi r24,lo8(7)
 687 02fa 01F4      		brne .L36
 367:tetStuff.c    **** 			pieceNum = 0;
 688               		.stabn	68,0,367,.LM54-.LFBB4
 689               	.LM54:
 690 02fc 1092 0000 		sts pieceNum,__zero_reg__
 691               	.L36:
 368:tetStuff.c    **** 		pieceLeftCol = PIECE_STARTCOL;
 692               		.stabn	68,0,368,.LM55-.LFBB4
 693               	.LM55:
 694 0300 83E0      		ldi r24,lo8(3)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 21


 695 0302 8093 0000 		sts pieceLeftCol,r24
 369:tetStuff.c    **** 		pieceTopRow = PIECE_STARTROW;
 696               		.stabn	68,0,369,.LM56-.LFBB4
 697               	.LM56:
 698 0306 1092 0000 		sts pieceTopRow,__zero_reg__
 370:tetStuff.c    **** 		pieceOrientation = 0;
 699               		.stabn	68,0,370,.LM57-.LFBB4
 700               	.LM57:
 701 030a 1092 0000 		sts pieceOrientation,__zero_reg__
 702 030e 00C0      		rjmp .L37
 703               	.L48:
 373:tetStuff.c    **** }
 704               		.stabn	68,0,373,.LM58-.LFBB4
 705               	.LM58:
 706 0310 20E0      		ldi r18,lo8(0)
 707               	.L18:
 708 0312 342F      		mov r19,r20
 709 0314 00C0      		rjmp .L20
 710               	.L37:
 711               	/* epilogue start */
 712 0316 0F90      		pop __tmp_reg__
 713 0318 0F90      		pop __tmp_reg__
 714 031a CF91      		pop r28
 715 031c DF91      		pop r29
 716 031e 1F91      		pop r17
 717 0320 0F91      		pop r16
 718 0322 FF90      		pop r15
 719 0324 EF90      		pop r14
 720 0326 DF90      		pop r13
 721 0328 CF90      		pop r12
 722 032a BF90      		pop r11
 723 032c AF90      		pop r10
 724 032e 9F90      		pop r9
 725 0330 8F90      		pop r8
 726 0332 7F90      		pop r7
 727 0334 6F90      		pop r6
 728 0336 5F90      		pop r5
 729 0338 4F90      		pop r4
 730 033a 3F90      		pop r3
 731 033c 2F90      		pop r2
 732 033e 0895      		ret
 733               		.size	tetUpdate, .-tetUpdate
 734               		.stabs	"callCount:V(3,2)",38,0,236,callCount.1822
 735               		.stabs	"newPieceHitCount:V(3,2)",38,0,237,newPieceHitCount.1823
 736               		.stabs	"new_pieceOrientation:r(3,2)",64,0,239,3
 737               		.stabs	"new_pieceTopRow:r(3,2)",64,0,240,2
 738               		.stabs	"new_pieceLeftCol:r(3,2)",64,0,241,20
 739               		.stabs	"pieceRow:r(3,2)",64,0,244,27
 740               		.stabs	"pieceCol:r(3,2)",64,0,245,21
 741               		.stabs	"noChange:r(3,2)",64,0,247,26
 742               		.stabs	"settle:r(3,2)",64,0,248,24
 743               		.stabn	192,0,0,.LFBB4-.LFBB4
 744               		.stabs	"__addr16:r(3,4)",64,0,291,24
 745               		.stabn	192,0,0,.LBB82-.LFBB4
 746               		.stabn	224,0,0,.LBE82-.LFBB4
 747               		.stabs	"__addr16:r(3,4)",64,0,356,30
 748               		.stabn	192,0,0,.LBB86-.LFBB4
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 22


 749               		.stabn	224,0,0,.LBE86-.LFBB4
 750               		.stabn	224,0,0,.Lscope4-.LFBB4
 751               	.Lscope4:
 752               		.stabs	"",36,0,0,.Lscope4-.LFBB4
 753               		.stabd	78,0,0
 754               		.stabs	"tetBrick_to_fb:F(3,2)",36,0,401,tetBrick_to_fb
 755               		.stabs	"tetBrick:P(3,2)",64,0,401,24
 756               	.global	tetBrick_to_fb
 757               		.type	tetBrick_to_fb, @function
 758               	tetBrick_to_fb:
 759               		.stabd	46,0,0
 398:tetStuff.c    **** 
 399:tetStuff.c    **** uint8_t tetColorScheme = 0;
 400:tetStuff.c    **** 
 401:tetStuff.c    **** uint8_t tetBrick_to_fb(uint8_t tetBrick)
 402:tetStuff.c    **** {
 760               		.stabn	68,0,402,.LM59-.LFBB5
 761               	.LM59:
 762               	.LFBB5:
 763               	/* prologue: function */
 764               	/* frame size = 0 */
 403:tetStuff.c    **** 	if(!tetBrick)
 765               		.stabn	68,0,403,.LM60-.LFBB5
 766               	.LM60:
 767 0340 8823      		tst r24
 768 0342 01F0      		breq .L52
 404:tetStuff.c    **** 		return 0;
 405:tetStuff.c    **** 
 406:tetStuff.c    **** 	switch(tetColorScheme)
 769               		.stabn	68,0,406,.LM61-.LFBB5
 770               	.LM61:
 771 0344 9091 0000 		lds r25,tetColorScheme
 772 0348 8150      		subi r24,lo8(-(-1))
 773 034a 9230      		cpi r25,lo8(2)
 774 034c 00F4      		brsh .L53
 775               		.stabs	"main.c",132,0,0,.Ltext2
 776               	.Ltext2:
   1:main.c        **** #include "projInfo.h"   //Don't include in main.h 'cause that's included in other .c's?
   2:main.c        **** #include "main.h"
   3:main.c        **** #include <util/delay.h> //For delay_us in pll_enable
   4:main.c        **** #include <avr/pgmspace.h>
   5:main.c        **** #include _TIMERCOMMON_HEADER_
   6:main.c        **** //#include "../../../_commonCode/charBitmap/0.10/charBitmap.h"
   7:main.c        **** #include _CHARBITMAP_HEADER_
   8:main.c        **** #include "fbColors.h"
   9:main.c        **** 
  10:main.c        **** #include _SINETABLE_HEADER_
  11:main.c        **** #include "tetStuff.c"
  12:main.c        **** 
  13:main.c        **** 
  14:main.c        **** 
  15:main.c        **** 
  16:main.c        **** 
  17:main.c        **** 
  18:main.c        **** 
  19:main.c        **** //#define SEG_HFM		TRUE
  20:main.c        **** #define SEG_QUESTION	TRUE
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 23


  21:main.c        **** 
  22:main.c        **** // When this isn't true, remove ADC stuff from the makefile
  23:main.c        **** // to save codespace
  24:main.c        **** //#define SEG_RACER 	TRUE
  25:main.c        **** 
  26:main.c        **** 
  27:main.c        **** 
  28:main.c        **** 
  29:main.c        **** 
  30:main.c        **** //#warning "This needs to be moved... and conditional"
  31:main.c        **** //#include "rowSegBuffer.c"
  32:main.c        **** 
  33:main.c        **** //Called as: pgm_readImageByte(pgm_image1, row, col)
  34:main.c        **** #define pgm_readImageByte(image, row, col)   \
  35:main.c        **** 	   pgm_read_byte((uint8_t *)(&((image)[(row)*FB_WIDTH+(col)])))
  36:main.c        **** 
  37:main.c        **** 
  38:main.c        **** 
  39:main.c        **** // I hereby declare this FPD-Link simulation technique to forever be called
  40:main.c        **** //  PW-BANGing
  41:main.c        **** 
  42:main.c        **** 
  43:main.c        **** //For testing of slower LVDS pixel-rates
  44:main.c        **** // (maybe we can increase the resolution)
  45:main.c        **** // value must be 1, 2, 4, or 8
  46:main.c        **** // This is overridden by 8 when SLOW_LVDS_TEST is true...
  47:main.c        **** // If commented-out the default of 1 is used...
  48:main.c        **** // AFAICT, this only increases codesize in HLow_delay...
  49:main.c        **** // CHANGING THIS MIGHT AFFECT DISPLAYABILITY...
  50:main.c        **** // One place to look is the delay_cyc in drawPix
  51:main.c        **** //  Currently 1, 2, and 8 seem to work.
  52:main.c        **** //  8 no longer works, noticed a/o v46
  53:main.c        **** #define LVDS_PRESCALER 8//2//1//8//2//4//8//2//8//2
  54:main.c        **** //8//2//1//2//2//2//2//2//2//2//2//2//2//2//8//4 //1 //2//4//8//2//4
  55:main.c        **** 
  56:main.c        **** 
  57:main.c        **** //#define LIFE TRUE
  58:main.c        **** #if (defined(LIFE) && LIFE)
  59:main.c        ****  #include "lifeStuff.c"
  60:main.c        **** #endif
  61:main.c        **** 
  62:main.c        **** #define ROW_SEG_BUFFER	TRUE
  63:main.c        **** //now, SEG_STRETCH >= 3 causes weirdness... (repeated rows)
  64:main.c        **** // previously 3 was OK
  65:main.c        **** // This is fixed a/o newSeg, etc.
  66:main.c        **** #define SEG_STRETCH 5//4//3//2//3//4//6//3//4//6	//Stretch pixels using longer segments
  67:main.c        **** 
  68:main.c        **** #if (defined(ROW_SEG_BUFFER) && ROW_SEG_BUFFER)
  69:main.c        ****  #warning "ROW_SEG_BUFFER requires ROW_BUFFER, but this is a hack"
  70:main.c        ****  #if (!defined(LVDS_PRESCALER) || (LVDS_PRESCALER < 2))
  71:main.c        ****   #error "ROW_SEG_BUFFER uses 20cyc/pixel, which isn't compatible with ROW_BUFFER -> width=64, sinc
  72:main.c        ****  #endif
  73:main.c        ****  #define ROW_BUFFER TRUE
  74:main.c        ****  #include "rowSegBuffer.c"
  75:main.c        **** #endif
  76:main.c        **** 
  77:main.c        **** #define ROW_BUFFER TRUE
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 24


  78:main.c        **** #if (defined(ROW_BUFFER) && ROW_BUFFER)
  79:main.c        ****  #include "rowBuffer.c"
  80:main.c        **** #endif
  81:main.c        **** 
  82:main.c        **** //Only valid with ROW_BUFFER=TRUE above:
  83:main.c        **** //#define HORIZONTAL_COLOR_BARS TRUE
  84:main.c        **** 
  85:main.c        **** 
  86:main.c        **** 
  87:main.c        **** 
  88:main.c        **** 
  89:main.c        **** 
  90:main.c        **** 
  91:main.c        **** 
  92:main.c        **** 
  93:main.c        **** 
  94:main.c        **** //See its old definition elsewhere
  95:main.c        **** #define NUM_PSEGS (1024/3+16)
  96:main.c        **** 
  97:main.c        **** 
  98:main.c        **** 
  99:main.c        **** #if(defined(SEG_RACER) && SEG_RACER)
 100:main.c        **** 	#include _ADC_HEADER_
 101:main.c        **** //	#include <stdio.h>
 102:main.c        **** 
 103:main.c        **** //Returns 0-9 or -1 if we've reached 0...
 104:main.c        **** int8_t grabDecimal_u32(uint32_t value, uint8_t newVal)
 105:main.c        **** {
 106:main.c        ****    static uint32_t divisor = 1000000000;
 107:main.c        **** 
 108:main.c        ****    static uint32_t thisVal;
 109:main.c        **** 
 110:main.c        ****    if(newVal)
 111:main.c        ****    {
 112:main.c        ****       divisor = 1000000000;
 113:main.c        ****       thisVal = value;
 114:main.c        ****    }
 115:main.c        **** 
 116:main.c        ****    uint8_t decimal = 0;
 117:main.c        **** 
 118:main.c        **** 
 119:main.c        **** 
 120:main.c        ****    if(divisor == 0)
 121:main.c        ****       return -1;
 122:main.c        **** 
 123:main.c        ****    while(thisVal >= divisor)
 124:main.c        ****    {
 125:main.c        ****       decimal++;
 126:main.c        ****       thisVal -= divisor;
 127:main.c        **** 
 128:main.c        ****    }
 129:main.c        **** 
 130:main.c        **** 
 131:main.c        **** 
 132:main.c        **** 
 133:main.c        ****    divisor /= 10;
 134:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 25


 135:main.c        ****    return decimal;
 136:main.c        **** }
 137:main.c        **** 
 138:main.c        **** 
 139:main.c        **** //Including raceWidth, and maybe some buffer...
 140:main.c        **** #define RACE_WIDTH_PSEGS	272
 141:main.c        **** 
 142:main.c        **** 
 143:main.c        **** void showScore(uint16_t rowNum, uint32_t score, uint8_t color)
 144:main.c        **** {
 145:main.c        **** 
 146:main.c        **** 	//The first few rows aren't displaying?
 147:main.c        **** //		rowNum-=6;
 148:main.c        **** 		int8_t decimal;
 149:main.c        **** 		uint8_t scoreFound = FALSE;
 150:main.c        **** 
 151:main.c        **** 		static uint32_t thisScore;
 152:main.c        **** 
 153:main.c        **** 		if(rowNum == 0)
 154:main.c        **** 			thisScore = score; // goodCount;
 155:main.c        **** 
 156:main.c        **** 		decimal = grabDecimal_u32(thisScore, 1);
 157:main.c        **** 
 158:main.c        **** 		uint8_t col;
 159:main.c        **** 
 160:main.c        **** 		uint8_t charRow = 0;
 161:main.c        **** 
 162:main.c        **** 		for(col=0; col<NUM_PSEGS-3-RACE_WIDTH_PSEGS; col++)
 163:main.c        **** 		{
 164:main.c        **** //			uint8_t charRow = 0;
 165:main.c        **** 			
 166:main.c        **** 			if(col%8==0)
 167:main.c        **** 			{
 168:main.c        **** 				if((decimal != 0) && (decimal != -1))
 169:main.c        **** 					scoreFound = TRUE;
 170:main.c        **** 
 171:main.c        **** 				if((decimal == -1) || (!scoreFound))
 172:main.c        **** 					charRow = 0;
 173:main.c        **** 				else
 174:main.c        **** 					charRow = getCharRow(decimal+'0', rowNum/2);
 175:main.c        **** 				decimal = grabDecimal_u32(thisScore, 0);
 176:main.c        **** 			}
 177:main.c        **** 
 178:main.c        **** 			if(getbit(col%8, charRow))
 179:main.c        **** 				addSegfb(1,color);
 180:main.c        **** 			else
 181:main.c        **** 				addSegfb(1,_B);
 182:main.c        **** 		}
 183:main.c        **** }	
 184:main.c        **** 
 185:main.c        **** #endif
 186:main.c        **** 
 187:main.c        **** 
 188:main.c        **** 
 189:main.c        **** 
 190:main.c        **** 
 191:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 26


 192:main.c        **** 
 193:main.c        **** 
 194:main.c        **** //Options LTN, IDT, or TESTVALS
 195:main.c        **** // IDT display *still* doesn't sync... maybe my H/V signals aren't right
 196:main.c        **** #define DISPLAY TESTVALS //LTN //TESTVALS //IDT //LTN
 197:main.c        **** 
 198:main.c        **** //For Red and Green (NOT Blue) This enables four shades, instead of three
 199:main.c        **** // (including black)
 200:main.c        **** // Doing so increases pixel-processing time, thus the pixel-widths
 201:main.c        **** // (thus decreasing resolution)
 202:main.c        **** // each color takes 9 cycles to process in three-shade mode
 203:main.c        **** // or 12 cycles for red and green, plus 9 for blue in four-shade mode
 204:main.c        **** #define FOUR_SHADES TRUE
 205:main.c        **** 
 206:main.c        **** // TODO: Between OSCCAL_VAL and FRAME_UPDATE_DELAY
 207:main.c        **** //  it seems the speed (at least for the LTN) isn't so important after all
 208:main.c        **** //  This could be used to my advantage...
 209:main.c        **** //  Maybe bump OSCCAL_VAL all the way up, but use a slower "bit-rate"
 210:main.c        **** //  Thus, pixels could be skinnier, thus higher-resolution.
 211:main.c        **** //   Or more instructions could be used for the same resolution
 212:main.c        **** //   allowing, e.g. sprites from program-memory, without necessitating a
 213:main.c        **** //   large (or any?) frame-buffer...
 214:main.c        **** 
 215:main.c        **** 
 216:main.c        **** //This used to be handled by TOOFAST_TEST, but now can be configured here
 217:main.c        **** // 0xff sets the processor to run as fast as possible 
 218:main.c        **** //  (~16MHz? ~128MHz bit-rate)
 219:main.c        **** // 0x00 sets it as slow as possible (~4MHz, ~32MHz bit-rate)
 220:main.c        **** //  good for testing whether odd colors
 221:main.c        **** //  or bad syncing is due to bits being shifted, etc. 
 222:main.c        **** //  Maybe due to slow "LVDS" conversion chips, or whatnot.
 223:main.c        **** //   This seems to be the case right now... 0xff: black is appearing green
 224:main.c        **** //   There should be *some* green in it, but not this much.
 225:main.c        **** //   Likely due to different propagation delays between my under-driven
 226:main.c        **** //    74LS86's (running red and green), from 3.3V!
 227:main.c        **** //    and the happier and newer 74AHC XOR and OR currently driving the
 228:main.c        **** //    clock and DVH/Blue signals
 229:main.c        **** //  Highly dependent on the screen itself, some may not run at all with
 230:main.c        **** //  such slow bitrates... heck, some may not run at all even at the fastest
 231:main.c        **** // If SLOW_EVERYTHING_TEST is true, this value is overridden
 232:main.c        **** // LTN last used 0x20
 233:main.c        **** #define OSCCAL_VAL	0xff//0x20//0xff //0x00
 234:main.c        **** 
 235:main.c        **** //This would normally be 0 for the highest-speed frame-refresh possible
 236:main.c        **** // However, increasing this value can slow the frame-refresh rate
 237:main.c        **** //   if desired
 238:main.c        **** // e.g. 50000 causes it to refresh ~ every few seconds
 239:main.c        **** //   (durn-near the limit for how long the LCD will retain an image)
 240:main.c        **** // The benefit being that it doesn't flicker at annoying rates for
 241:main.c        **** //  stationary images
 242:main.c        **** //  worth exploring...
 243:main.c        **** // This may be highly dependent on the screen capabilities...
 244:main.c        **** //   of course, this sorta thing is undocumented
 245:main.c        **** //   it just has to be experimented with
 246:main.c        **** //   Further, it may be quite hard on the Liquid Crystals, since they'd 
 247:main.c        **** //   likely be driven DC... not sure what the long term effects are.
 248:main.c        **** // This could be a hell of a lot more sophisticated...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 27


 249:main.c        **** // e.g. refresh after a frameBuffer change
 250:main.c        **** //      refresh based on a seconds-timer
 251:main.c        **** //      ...
 252:main.c        **** // AS-IS: Does refreshes completely independent of the frame-buffer
 253:main.c        **** //      if it's too slow, some images may be missed completely.
 254:main.c        **** //      This is not true for FRAME_SYNC TRUE (below)
 255:main.c        **** //      (and it's not really useful anymore with FRAME_SYNC)
 256:main.c        **** #define FRAME_UPDATE_DELAY 0//5000//50000 //2000 //5000 //20000 //50000
 257:main.c        **** 
 258:main.c        **** //SHOULD PROBABLY BE REVISITED
 259:main.c        **** // It probably doesn't work with all cases...
 260:main.c        **** // Definitely with drawPix/Images...
 261:main.c        **** //This causes main o update the image *after* FRAME_UPDATE_DELAY
 262:main.c        **** #define FRAME_SYNC TRUE
 263:main.c        **** 
 264:main.c        **** //New Idea:
 265:main.c        **** // Disable the Hsync timer interrupt after the frame completes
 266:main.c        **** //  and reenable elsewhere...
 267:main.c        **** //  (It seems pixels changing from one shade to another take an
 268:main.c        **** //   intermediate step halfway between)
 269:main.c        **** //  (Thus, two updates then a pause might clear that up)
 270:main.c        **** //  (Duh... it doesn't clear that up, because the fastest refresh rate
 271:main.c        **** //   is the same...)
 272:main.c        **** //  (but it is an interesting effect)
 273:main.c        **** //  (Double-Duh... I was using a slow refresh with FRAME_UPDATE_DELAY)
 274:main.c        **** //  Reworded: Having several frame refreshes before a pause helps to
 275:main.c        **** //  "solidify" the color changes... especially the sharp changes 
 276:main.c        **** //  (e.g. yellow<->black)
 277:main.c        **** //  (Side Note: I saw this effect on a regular (NON-LVDS) TFT display 
 278:main.c        **** //   in LCDdirect that was only connected such that R, G, and B were each
 279:main.c        **** //   either full-off or full-on, i.e. all Red bits were connected to a
 280:main.c        **** //   single output pin (full on when 1, full off when 0).
 281:main.c        **** //   I hadn't attributed it to improper refresh synchronization
 282:main.c        **** //   as the refresh rate was too fast to see... That's a handy way to get
 283:main.c        **** //   intermediate shades/colors without refresh-flicker from pulsing them!)
 284:main.c        **** //  connected with each color 
 285:main.c        **** //  0 means no delay (except FRAME_UPDATE_DELAY) via interrupt disabling
 286:main.c        **** //  If you WANT this effect (for intermediate shades?) 
 287:main.c        **** //   set FRAME_COUNT_TO_DELAY to 1
 288:main.c        **** //  Then, each change of color will (apparently) result in a value halfway
 289:main.c        **** //   between the old color and the new color
 290:main.c        **** //  Not sure whether it's an electrical problem, but these half-shades 
 291:main.c        **** //   appear dithered, sometimes ugilly, sometimes it's nice. I guess it
 292:main.c        **** //   depends on the goal...
 293:main.c        **** #define FRAME_COUNT_TO_DELAY 2//7//1//5//2//3
 294:main.c        **** 
 295:main.c        **** 
 296:main.c        **** //These two are mutually-exclusive (BLUE_VERT_BAR overrides DE_BLUE)
 297:main.c        **** // (BLUE_DIAG_BAR overrides both...)
 298:main.c        **** 
 299:main.c        **** 
 300:main.c        **** // Default is drawPix, from program memory...
 301:main.c        **** 
 302:main.c        **** //These are only used in drawPix...
 303:main.c        **** //This probably has no purpose outside of COLOR_BAR_SCROLL below
 304:main.c        **** // Actually, it's kinda funny watcching the top of the smiley's
 305:main.c        **** // head scroll... like he's getting a brain transplant
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 28


 306:main.c        **** //#define PIXEL_SCROLL TRUE
 307:main.c        **** 
 308:main.c        **** //This is only valid in drawPix with an image...
 309:main.c        **** #define IMAGE_CHANGE TRUE
 310:main.c        **** 
 311:main.c        **** 
 312:main.c        **** //#define COLOR_BAR_SCROLL TRUE
 313:main.c        **** #if (defined(COLOR_BAR_SCROLL) && COLOR_BAR_SCROLL)
 314:main.c        **** 
 315:main.c        **** //#warning "COLOR_BAR_SCROLL is broken a/o v29, possibly earlier"
 316:main.c        **** // Probably just a timing issue...
 317:main.c        **** 
 318:main.c        **** //Optional, but only useful here...
 319:main.c        ****  #define PIXEL_SCROLL TRUE
 320:main.c        **** 
 321:main.c        ****  //Handles all the displayable colors in a single row for scrolling...
 322:main.c        ****  #define FB_WIDTH 64 //28
 323:main.c        ****  //Two different arrangements of colors...
 324:main.c        ****  #define FB_HEIGHT 2
 325:main.c        **** 
 326:main.c        **** #else //drawPix from program memory
 327:main.c        ****  #define FB_WIDTH	16
 328:main.c        ****  #define FB_HEIGHT 16
 329:main.c        **** #endif
 330:main.c        **** 
 331:main.c        **** 
 332:main.c        **** 
 333:main.c        **** //DC_DE is only used in drawPix...
 334:main.c        **** //#define DC_DE_DISABLE TRUE
 335:main.c        **** //This should remove DC from Vsync, etc...
 336:main.c        **** // Currently only implemented with FULL_INIT_TESTS below...
 337:main.c        **** //#define REMOVE_DC TRUE
 338:main.c        **** 
 339:main.c        **** //#define FULL_INIT_TESTS TRUE
 340:main.c        **** 
 341:main.c        **** 
 342:main.c        **** //#define BLUE_DIAG_BAR TRUE
 343:main.c        **** 
 344:main.c        **** //A single black bar, followed by a single blue bar... ~1/3 and 2/3's width
 345:main.c        **** //#define BLUE_VERT_BAR TRUE
 346:main.c        **** 
 347:main.c        **** //#define DE_BLUE TRUE
 348:main.c        **** // NONE SELECTED DOESN'T SYNC!!! DE not detected???
 349:main.c        **** 
 350:main.c        **** 
 351:main.c        **** //#define DE_ONLY_DISPLAY	TRUE
 352:main.c        **** 
 353:main.c        **** 
 354:main.c        **** //a/0 v24, this allows the clock signal to be affected by DT
 355:main.c        **** // if it works, we'll be able to use Green on /OC1B
 356:main.c        **** // Sort of works... Blues with DT=0 are good, timing's not screwed
 357:main.c        **** // but blues with DT!=0 are damn-near black except for a light pixel
 358:main.c        **** // before-hand
 359:main.c        **** //a/0 v26, this is now required for Green IN MODES OTHER THAN DRAWPIX
 360:main.c        **** // Not sure where that note makes sense...
 361:main.c        **** // a/o 56-36-3ish it's been removed completely.
 362:main.c        **** //DO NOT define CLOCK_INSENSITIVITY_TESTING TRUE
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 29


 363:main.c        **** 
 364:main.c        **** // Rather than *possibly* mess with timing (on other displays?)
 365:main.c        **** // Also for testing...
 366:main.c        **** //#define DT0_BLUES_ONLY	TRUE
 367:main.c        **** 
 368:main.c        **** //A/O v13: Using the Samsung LTN display, instead of the IDTech IAXG
 369:main.c        **** // LTN appears to be content with my pseudo-LVDS scheme.
 370:main.c        **** // IAXG has never unblanked
 371:main.c        **** //      Even though suitable timings were found with SwitchResX
 372:main.c        **** //      Maybe due to psuedo-LVDS
 373:main.c        **** //            slight timing issues // It probably doesn't work with all cases...
 374:main.c        **** // Definitely with drawPix/Images...(RC oscillator variances?)
 375:main.c        **** //            glitches when switching LVDS states 
 376:main.c        **** //                 (thought I had that figured out, originally)
 377:main.c        **** //      The fact the LTN appears to recognize the signalling suggests the
 378:main.c        **** //      IAXG would be worth further exploration...
 379:main.c        **** //         Unfortunately, the CCFT blew out my inverter
 380:main.c        **** //                        And I must have put it back together incorrectly
 381:main.c        **** //                        (backlight filters out of order or flipped?)
 382:main.c        **** //                        (which actually makes for some very interesting
 383:main.c        **** //                         visuals, but hard to develop with)
 384:main.c        **** //      IAXG: uses DE, V, and H
 385:main.c        **** //             At low pixel-clock DE is active for fewer pixels...
 386:main.c        **** //              Last Tested: 680 was full-screen
 387:main.c        **** //             Nice because it increases the frame-rate!
 388:main.c        **** //      LTN:  uses DE only
 389:main.c        **** 
 390:main.c        **** 
 391:main.c        **** // The idea is to use FastPWM with the PLL to implement 64-85Mbits/sec
 392:main.c        **** //  (the PLL on the Tiny861 supposedly maxes out at 85MHz)
 393:main.c        **** //  (Though I am currently running with OSCAL set to the highest frequency
 394:main.c        **** //   and the PLL seems to be syncing at about 128MHz)
 395:main.c        **** 
 396:main.c        **** 
 397:main.c        **** // Wiring:
 398:main.c        **** //   Many iterations of AVR->Differential "LVDS" circuitry resulted in the
 399:main.c        **** //   simplest of all:
 400:main.c        **** //
 401:main.c        **** //   Believe it or not, the XOR is a standard TTL LS-series XOR: 74LS86
 402:main.c        **** //     Specifically: TI SN74LS86N from 1980 (the only XOR in my collection)
 403:main.c        **** //   It's spec'd to run from 4.5-5.5V, and its propagatio delays and slew
 404:main.c        **** //     rates aren't really spec'd to be good enough for 128MHz pixel clock
 405:main.c        **** //     yet it's working...
 406:main.c        **** //   Further, the output voltages are right in the LVDS range,
 407:main.c        **** //     IIRC (last I 'scoped) around 1.5V High and 1.0V Low
 408:main.c        **** //      (Don't forget the LCD has a 100ohm resistor between
 409:main.c        **** //         RXinN/clk+ and RXinN/clk-)
 410:main.c        **** //   Most signals are connected as shown (RXin0, RXin2, RXclk)
 411:main.c        **** //   Green is the only one which has RXin1- and RXin1+ swapped
 412:main.c        **** //     since it is on the /OC1B (inverted) output
 413:main.c        **** //   Green may benefit from a pull-up resistor on /OC1B
 414:main.c        **** //     there was some weird noise appearing like a floating-input
 415:main.c        **** //     when the full frame was not filled with pixels
 416:main.c        **** //     (but it should've waited to disable /OC1B until *after* the delays,
 417:main.c        **** //      etc. So I'm not sure what it was)
 418:main.c        **** //
 419:main.c        **** //   It's probably best to use two XORs from the same chip for a single
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 30


 420:main.c        **** //    LVDS channel, since different chips may have slightly different
 421:main.c        **** //    characteristics. 
 422:main.c        **** //
 423:main.c        **** //   The entire circuit, thus, requires TWO 74LS86's 
 424:main.c        **** //    (four XORs apiece, two per LVDS channel, 8-total)
 425:main.c        **** //
 426:main.c        **** //
 427:main.c        **** //              VCC3V3   VCC3V3
 428:main.c        **** //                |        |
 429:main.c        **** //                +---\ \-_
 430:main.c        **** //                     | |    -
 431:main.c        **** //                     | | XOR   >------> RXinN/clk-
 432:main.c        **** //   AVR               | |    _-
 433:main.c        **** //   OC1x >----+------/ /___-
 434:main.c        **** //   output    |
 435:main.c        **** //             |   
 436:main.c        **** //             |      
 437:main.c        **** //             `------\ \-_
 438:main.c        **** //                     | |    -
 439:main.c        **** //                     | | XOR   >------> RXinN/clk+
 440:main.c        **** //                     | |    _-
 441:main.c        **** //                +---/ /___-
 442:main.c        **** //                |        |
 443:main.c        **** //               GND      GND
 444:main.c        **** //
 445:main.c        **** //  
 446:main.c        **** //  Also used: The TTL 74AHC series...
 447:main.c        **** //    I found some one-gang 74AHC1G32 and 74AHC1G86's on an old iBook
 448:main.c        **** //     motherboard. (An OR and an XOR, respectively). These are spec'd for
 449:main.c        **** //     3.3V operation, and faster. The output voltages appear OK for LVDS
 450:main.c        **** //     (with a 100ohm load in the LCD)
 451:main.c        **** //
 452:main.c        **** //  NOTE: Since I only had enough of these 1-gang devices for two LVDS
 453:main.c        **** //     channels, I had to implement Red and Green with the LS 
 454:main.c        **** //     before switching all channels to the LS... Using different chips
 455:main.c        **** //     (specifically, different TYPES of chips) for different channels
 456:main.c        **** //     caused timing issues: Since the AHC is faster, the clock and Blue
 457:main.c        **** //     signals are synchronized, but the red and green signals were shifted
 458:main.c        **** //     a bit or two (resulting in "Black" appearing green, of course
 459:main.c        **** //     true black isn't really possible with my timing scheme... see below)
 460:main.c        **** //
 461:main.c        **** //  For other circuits attempted, see oldNotes.txt
 462:main.c        **** //     (and boy there were many, involving voltage dividers, AC coupling,
 463:main.c        **** //      reference voltages, BJT differential amplifiers... I doubt I 
 464:main.c        **** //      documented them all, or even most. Whoda thunk the simplest, 
 465:main.c        **** //      especially under- AND over-spec'd--timing, supply voltage, and
 466:main.c        **** //      output voltage--would be the one...?)
 467:main.c        **** //
 468:main.c        **** // LVDS/FPD-Link timing:
 469:main.c        **** 
 470:main.c        **** //            |<--- (LCDdirectLVDS: "pixel") --->|
 471:main.c        **** //  Timer1:   |<-- One Timer1 Cycle (OCR1C=6) -->|
 472:main.c        **** //  TCNT:     |  0   1    2    3    4    5    6  |  0   1    2    3    
 473:main.c        **** //            |____.____.____.____               |____.____.____.____
 474:main.c        **** //  RXclk+:   /         |         \    .    .    /         |         \ //
 475:main.c        **** //            |         |            |         |
 476:main.c        **** // One Pixel: |         |<--- One FPD-Link Pixel Cycle --->|
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 31


 477:main.c        **** //            |                                  |
 478:main.c        **** // "Blue/DVH" |____ ____v____ ____ ____v____ ____|____ ____
 479:main.c        **** //  RXin2:    X B3 X B2 X DE X /V X /H X B5 X B4 X B3 X B2 X ...
 480:main.c        **** //            | ^  ^ | 
 481:main.c        **** //            |         |<--Not Blue-->|         |
 482:main.c        **** //            |                                  |
 483:main.c        **** // "Green"    |____ ____v____ ____v____ ____ ____|____ ____
 484:main.c        **** //  RXin1:    X G2 X G1 X B1 X B0 X G5 X G4 X G3 X G2 X G1 X ...
 485:main.c        **** //            | ^ ^  |  
 486:main.c        **** //            |         |<------->|-Not Green    |
 487:main.c        **** //
 488:main.c        **** // "Red"      |____ ____v____v____ ____ ____ ____|____ ____
 489:main.c        **** //  RXin0:    X R1 X R0 X G0 X R5 X R4 X R3 X R2 X R1 X R0 X ...
 490:main.c        **** //            | ^^     
 491:main.c        **** //            |         |<-->|-Not Red
 492:main.c        **** //
 493:main.c        **** //   Of course: The Not Green/Red bits above are low-bits and
 494:main.c        **** //              basically have little/no visible effect
 495:main.c        **** //
 496:main.c        **** //
 497:main.c        **** // Ponderings on using /OC1x's and OC1D for other colors...
 498:main.c        **** //    /OC1D could easily be used for another color, unaffected by others
 499:main.c        **** //          since DT1(L) and OCR1D are unused
 500:main.c        **** //
 501:main.c        **** // DE:   Blue Values
 502:main.c        **** //       -----------
 503:main.c        **** //       OCR1A=4,5,6   (OCR1A=6, Full-Blue would force /OC1A low,
 504:main.c        **** //       DT1(H)=0,1,2                      e.g. Green=Full-Green or Off)
 505:main.c        **** //                      Also: OCR1A=4,5 would affect Green
 506:main.c        **** //                            (DT1(L) is from this edge...)
 507:main.c        **** //                            DT1(H) also affects complementary OC1D
 508:main.c        **** //
 509:main.c        **** // CLK:  OCR1B=3       CLOCK can NOT be complementary-output mode
 510:main.c        **** //                                   (/OC1B unusuable)
 511:main.c        **** //                                   otherwise, DT1 would affect clock
 512:main.c        **** //
 513:main.c        **** //
 514:main.c        **** // CLOCK_INSENSITIVITY_TESTING:
 515:main.c        **** //   (a/o 56-36-3ish, no longer testable)
 516:main.c        **** //    Testing of DE/Blue's DeadTime values on Clocking...
 517:main.c        **** //    	Image-shift (not sure why, more calculations? Not *that* many!)
 518:main.c        **** //       Blue now has only two shades besides black
 519:main.c        **** //         ~66% and 100%
 520:main.c        **** //       Now each blue pixel (the ones appearing black)
 521:main.c        **** //         is bordered by a blue line...
 522:main.c        **** //    All doable. Would have preferred 3 shades besides black,
 523:main.c        **** //       but two isn't bad.
 524:main.c        **** //
 525:main.c        **** //  New Idea: Since CLOCK can be used with DT1H (during DE)
 526:main.c        **** //    DE/Blue DT values are 0, 1, or 2 (D0, D1, D2)
 527:main.c        **** //     Dn corresponds to the low-to-high dead-timer value
 528:main.c        **** //                   (aka counter-reset delay, on OCR1x)
 529:main.c        **** //     dn corresponds to the high-to-low dead-timer value
 530:main.c        **** //                   (aka OCR match delay, on /OCR1x)
 531:main.c        **** //     Cn corresponds to OCR1x=n
 532:main.c        **** //
 533:main.c        **** // This was easier to comprehend in v<26... now it's more informative
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 32


 534:main.c        **** //   but harder to view...
 535:main.c        **** //                          OCR1B = 3
 536:main.c        **** //  TCNT:     |  0   1    2    3  | 4    5    6
 537:main.c        **** //
 538:main.c        **** //  CLKideal: /\______________/
 539:main.c        **** //
 540:main.c        **** //            |____ ____ ____.____v              |
 541:main.c        **** //  CLK:   D0>/ D1>/ D2>/         \    .    .    /
 542:main.c        **** //  OC1B      |           |  |
 543:main.c        **** //            |                   |
 544:main.c        **** //            | G2   G1   B1   B0 | G5   G4   G3
 545:main.c        **** //  Green:    |                   |____ ____ ____
 546:main.c        **** //  /OC1B     \    .    .    . d0>/ d1>/ d2>/ d3?\  //
 547:main.c        **** //            |      
 548:main.c        **** //            |
 549:main.c        **** //            | R1   R0   G0   R5   R4   R3   R2
 550:main.c        **** //  Red:      |____ ____ ____ ____ ____ ____ ____
 551:main.c        **** //  OC1D   D0>/ D1>/ D2>/ C2>\ C3>\ C4>\ C5>\ C6...
 552:main.c        **** //                       
 553:main.c        **** //             ____ ____ ____ ____ ____ ____ ____
 554:main.c        **** //  /OC1D     \ ^OCR1D>=6^ L>/  M>/  N>/  O>/ P?>...
 555:main.c        **** //                   
 556:main.c        **** //
 557:main.c        **** //              B3   B2   DE   /V   /H   B5   B4
 558:main.c        **** // "Blue/DVH" |____ ____ ____.____.____ ____ ____
 559:main.c        **** //  OC1A:  D0>/ D1>/ D2>/           C4>\ C5>\ C6...
 560:main.c        **** //            |                  
 561:main.c        **** //             ____ ____ ____ ____ ____ ____ ____
 562:main.c        **** //  /OC1A:    \  ^^^--OCR1A>=6--^^^  X>/  Y>/ Z?>\  //
 563:main.c        **** //  (usable?)        
 564:main.c        **** //                 X: OCR1A=4, DTL=0
 565:main.c        **** //                 Y: OCR1A=4, DTL=1; OCR1A=5, DTL=0
 566:main.c        **** //                 Z: OCR1A=4, DTL=2; OCR1A=5, DTL=1; OCR1A>=6
 567:main.c        **** 
 568:main.c        **** //I've looked it over extensively, albiet exhaustedly, and it seems
 569:main.c        **** // there's only one way to do this. Unfortunately, DTH=1,2 *does* affect
 570:main.c        **** // the clocking. Everything displays properly, but the lighter shades of 
 571:main.c        **** // blue enabled by DTH=1,2 don't display at all (or dang-near black)
 572:main.c        **** // So there's really no benefit to using DTH=1,2 during DE for blues...
 573:main.c        **** // That gives two (similar) shades of bright blue 63/63 and 47/63
 574:main.c        **** // *'d are arbitrarily chosen for implementation
 575:main.c        **** // F'd are selected when FOUR_SHADES is TRUE
 576:main.c        **** //   (experimentation might show other choices are better)
 577:main.c        **** //
 578:main.c        **** // Red is connected to OC1D, Complementary output is not necessary
 579:main.c        **** //  OCR1D determines its brightness:
 580:main.c        **** //   (+OC1D => RX0+)
 581:main.c        **** //   *Off (0/63): OCR1D = 0  \      //
 582:main.c        **** //    3/63:			OCR1D = 1   > These three appear identical in glColorTest
 583:main.c        **** //    3/63:			OCR1D = 2  /  (G0 Active, from here down)
 584:main.c        **** //   *35/63:		OCR1D = 3
 585:main.c        **** //   F51/63:		OCR1D = 4
 586:main.c        **** //    59/63:		OCR1D = 5  \  These two appear identical in glColorTest
 587:main.c        **** //   *63/63:		OCR1D >= 6 /
 588:main.c        **** //    (+OC1D => RX0-)
 589:main.c        **** //    Not really worth pursuing, next step from 60/63 is 28/63 then 12
 590:main.c        **** //
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 33


 591:main.c        **** // Green is connected to /OC1B (the complementary channel to CLK)
 592:main.c        **** //  Its polarity is reversed (but that's easy since we have a single-ended
 593:main.c        **** //  to differential converter, and its outputs can just be swapped)
 594:main.c        **** //  DTL1 determines its brightness (G0 affected by Red):
 595:main.c        **** //   (/OC1B => RX1+)
 596:main.c        **** //    Off (0/63):	DTL1 = 3 (is this possible?)
 597:main.c        **** //    8-9/63:			DTL1 = 2
 598:main.c        **** //    24-25/63:		DTL1 = 1
 599:main.c        **** //    56-57/63:		DTL1 = 0
 600:main.c        **** //   (/OC1B => RX1-)				(B1,0 Active, as well as G2,1)
 601:main.c        **** //	  *Off (6/63):	DTL1 = 0
 602:main.c        **** //   *38-39/63:		DTL1 = 1
 603:main.c        **** //   F54-55/63:		DTL1 = 2
 604:main.c        **** //   *62-63/63:		DTL1 = 3
 605:main.c        **** //
 606:main.c        **** // Blue, as in previous versions, is connected to OC1A, DTH=0 during DE 
 607:main.c        **** //  so as not to interfere with the clock
 608:main.c        **** //  OCR1A determines the brightness (B1,0 active, per Green->RX1-):
 609:main.c        **** //    (+OC1A => RX2+)			      (B3,2 Active from here down)
 610:main.c        **** //    *Off (15/63):	OCR1A=4
 611:main.c        **** //    *47/63:		 	OCR1A=5
 612:main.c        **** //		*63/63:			OCR1A=6
 613:main.c        **** //
 614:main.c        **** // The clock is single-ended (complementary-mode disabled) during NON-DE
 615:main.c        **** //  because the DE/V/H signals (except in DE mode) require DT1H to vary.
 616:main.c        **** //  When DE is active the clock channel (OC1B) is switched to 
 617:main.c        **** //  complementary-output-mode to enable the Green PWM output
 618:main.c        **** //
 619:main.c        **** // For easier viewing:
 620:main.c        **** //   Red: (+OC1D => RX0+)
 621:main.c        **** //    Off (0/63): OCR1D = 0
 622:main.c        **** //    35/63:      OCR1D = 3
 623:main.c        **** //    51/63:      OCR1D = 4	(FOUR_SHADES only)
 624:main.c        **** //    63/63:      OCR1D >= 6
 625:main.c        **** //   Green: (/OC1B => RX1-)          (B1,0 Active, as well as G2,1)
 626:main.c        **** //    Off (6/63): DTL1 = 0
 627:main.c        **** //    38-39/63:      DTL1 = 1
 628:main.c        **** //    54-55/63:		DTL1 = 2	(FOUR_SHADES only)
 629:main.c        **** //    62-63/63:      DTL1 = 3
 630:main.c        **** //   Blue: (+OC1A => RX2+)               (B3,2 Active from here down)
 631:main.c        **** //    Off (15/63):  OCR1A=4
 632:main.c        **** //    47/63:        OCR1A=5
 633:main.c        **** //    63/63:        OCR1A=6
 634:main.c        **** //
 635:main.c        **** 
 636:main.c        **** // Toward creating a GIMP palette... v54.5
 637:main.c        **** // Probably absurd, but this was brown/orange on GIMP and it's yellow here
 638:main.c        **** //
 639:main.c        **** //   Red: (+OC1D => RX0+)
 640:main.c        **** //    Off (0/63): OCR1D = 0	r=0
 641:main.c        **** //    35/63:      OCR1D = 3	r=142
 642:main.c        **** //    51/63:      OCR1D = 4	r=206
 643:main.c        **** //    63/63:      OCR1D >= 6	r=255
 644:main.c        **** //   Green: (/OC1B => RX1-)          (B1,0 Active, as well as G2,1)
 645:main.c        **** //    Off (6/63): DTL1 = 0		g=24
 646:main.c        **** //    38-39/63:      DTL1 = 1 g=154
 647:main.c        **** //    54-55/63:		DTL1 = 2	g=218
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 34


 648:main.c        **** //    62-63/63:      DTL1 = 3 g=251
 649:main.c        **** //   Blue: (+OC1A => RX2+)               (B3,2 Active from here down)
 650:main.c        **** //    Off (15/63):  OCR1A=4	b=61
 651:main.c        **** //    47/63:        OCR1A=5	b=190
 652:main.c        **** //    63/63:        OCR1A=6	b=255
 653:main.c        **** //
 654:main.c        **** //  These numbers don't look entirely accurate...
 655:main.c        **** //    they vary depending on the other colors... and why is blue so high
 656:main.c        **** //    even when it's off?
 657:main.c        **** //  Maybe I'm looking at old notes...?
 658:main.c        **** //   SEE lvdsColorExperiments.c Now Here.
 659:main.c        **** 
 660:main.c        **** 
 661:main.c        **** //  Implementations/prospects:
 662:main.c        **** //  * rowBuffer.c (more like row-settings-buffer)
 663:main.c        **** //     calculate a row's worth of pixels before drawing that row
 664:main.c        **** //     (uses packed color settings in a single byte per drawable pixel)
 665:main.c        **** //     64 drawable pixels across, regardless of LVDS speed
 666:main.c        **** //  * For faster pixels: these settings values could be stored 
 667:main.c        **** //     in individual bytes. Gives about 1/3 more pixels at 3x the memory
 668:main.c        **** //     (not implemented)
 669:main.c        **** //  * rowSegBuffer.c
 670:main.c        **** //     also calculates an entire row before drawing it
 671:main.c        **** //     instead of storing pixels, store "segments"
 672:main.c        **** //     i.e. each segment is defined by a color value and a length
 673:main.c        **** //      the color-value is stored as DT/OCR values (not RGB values)
 674:main.c        **** //     Number of segments is limited only by memory...
 675:main.c        **** //      e.g. 64 segments per row (max) is 64*3Bytes
 676:main.c        **** //       Three bytes for color, and *really simple* packing for seg-length
 677:main.c        **** //      BUT: at slow LVDS speeds, the resolution of these segments could be
 678:main.c        **** //       as high as one LCD pixel.
 679:main.c        **** //      possibly: at *really* low LVDS speeds we could be 64*2Bytes
 680:main.c        **** //      (with packing)
 681:main.c        **** //      Actually: Using GB_COMBINED gives 2Bytes per segment
 682:main.c        **** //      only adds two clock cycles to each "pixel", so probably worth it
 683:main.c        **** 
 684:main.c        **** //   In Any Case: There's not enough RAM for a full frame
 685:main.c        **** //          64 pixels across * 64 pixels down is 4096 bytes
 686:main.c        **** //          So whatever method, we need to precalculate each row before
 687:main.c        **** //          displaying it
 688:main.c        **** //          Could be as simple as loading direct from program memory
 689:main.c        **** //
 690:main.c        **** 
 691:main.c        **** // Since low-bits are barely visible, their effect is neglected.
 692:main.c        **** //   Thus: Green is affected only by the Compare-Match deadTimer (DT1L)
 693:main.c        **** //         Red is affected only by OCR1D, and could be single-ended
 694:main.c        **** //   OTOH:
 695:main.c        **** //         The Visible blue values (with DT affecting clock)
 696:main.c        **** //         are only the high-two values, which are affected only by OCR1A
 697:main.c        **** //         So counter-reset dead-time (DT1H) needn't be varied
 698:main.c        **** //         And, then, the clock won't be affected at all
 699:main.c        **** //         (assuming we set it to single-ended during DE disabled, for V/H)
 700:main.c        **** //
 701:main.c        **** // NEW CONSIDERATION: "The dead timer delays the waveform by a minimum of
 702:main.c        **** //    "of one count, when DT=0..."
 703:main.c        **** // So changing the clock from single-ended to complementary
 704:main.c        **** //   might actually cause the clock output to be shifted!
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 35


 705:main.c        **** 
 706:main.c        **** 
 707:main.c        **** // DE/V/H Timing (LCDdirectLVDS):
 708:main.c        **** //  
 709:main.c        **** //
 710:main.c        **** //            |  0   1    2    3    4    5    6       All: set @ 0
 711:main.c        **** //            |____.____.____.____                         OCR1C = 6 
 712:main.c        **** //  Clock:    /                   \    .    .    /         Complementary-
 713:main.c        **** //                                             Output Mode
 714:main.c        **** //                                                          required for DT
 715:main.c        **** //   Signal:    B3   B2   DE   /V   /H   B5   B4 | B3
 716:main.c        **** //             ____ ____ ____ ____ ____ ____ ____|____    
 717:main.c        **** //   DE:      X B3 X B2 /    .    .    \ B5 X B4 X B3 X    
 718:main.c        **** //   state2                      |    
 719:main.c        **** //   DE_BLUE: >|    DT=X, OCR=0
 720:main.c        **** //                         Watch the transition!! -------^
 721:main.c        **** //   DE_NORM: >_________/\_________|    DT=2, OCR=4
 722:main.c        **** //   DC_DISABLED:
 723:main.c        **** //   maxBlue: >\____|		DT=0, OCR=5
 724:main.c        **** //             See below for more blue settings...
 725:main.c        **** //
 726:main.c        **** //             ____ ____      ____      ____ ____|____ 
 727:main.c        **** //  H (only): X xx X xx \    /    \    / xx X xx X xx X    
 728:main.c        **** //   state1              | 
 729:main.c        **** //            >______________/\______________|    DT=3, OCR=3
 730:main.c        **** //  DC_DISABLED:
 731:main.c        **** //   Not much can be done...
 732:main.c        **** //
 733:main.c        **** //             ____ ____           ____ ____ ____|____ 
 734:main.c        **** //  V w/o H:  X xx X xx \    .    /    \ xx X xx X xx X
 735:main.c        **** //   state3              |
 736:main.c        **** //            >___________________/\_________|    DT=4, OCR=4 (+?)
 737:main.c        **** // DC_DISABLED:
 738:main.c        **** //            >___________________/\____|		DT=4, OCR=5
 739:main.c        **** 
 740:main.c        **** //             ____ ____                ____ ____|____ 
 741:main.c        **** //  V w/ H:   X xx X xx \    .    .    / xx X xx X xx X
 742:main.c        **** //   state4          | 
 743:main.c        **** //            >__________________________________|    DT=X, OCR=0
 744:main.c        **** //                             TransitionWatch!!! -------^
 745:main.c        **** //                             Shouldn't matter... DT from no-edge
 746:main.c        **** // DC_DISABLED:
 747:main.c        **** //            >\________________________|		DT=0, OCR=1
 748:main.c        **** 
 749:main.c        **** //             ____ ____      ____ ____ ____ ____|____ 
 750:main.c        **** //  Nada:     X xx X xx \    /    .    \ xx X xx X xx X    
 751:main.c        **** //   state0                  |     
 752:main.c        **** //            >______________/\_________|    DT=3, OCR=4 (+?)
 753:main.c        **** // DC_DISABLED:
 754:main.c        **** //            >______________/\____|		DT=3, OCR=5
 755:main.c        **** 
 756:main.c        **** // Transitions: OLD!!!!! WRONG!!!!
 757:main.c        **** //   (are they? There're several additional transitions, now, for one.)
 758:main.c        **** //  The idea is to reduce the number of instructions between each
 759:main.c        **** //  LVDS "state."
 760:main.c        **** //  These are implemented below in the case:
 761:main.c        **** //    "#else //NOT FULL_INIT_TESTS"
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 36


 762:main.c        **** //  Since each instruction takes *longer than* a single pixel
 763:main.c        **** //    two instructions would *at best* occur on two consecutive pixels
 764:main.c        **** //    Thus, there's likely to be a transition-glitch
 765:main.c        **** //    (e.g. old OCR value with new DT value)
 766:main.c        **** //  Note that the new DT values are implemented at the next corresponding
 767:main.c        **** //    edge after the DT-write instruction completes
 768:main.c        **** //    (for +OC1A/DT1H, when TCNT is reset to 0)
 769:main.c        **** //    (for -OC1A/DT1L, when TCNT passes OCR1A)
 770:main.c        **** //    New OCR values are delayed until the next TCNT reset to 0
 771:main.c        **** //
 772:main.c        **** //  Initial:
 773:main.c        **** //  Nada					DT=2  NADA_OCR = (3<=OCR<(=?)6)
 774:main.c        **** 
 775:main.c        **** //  Nada	->	H			OCR=2
 776:main.c        **** //  H		->	Nada		OCR=NADA_OCR
 777:main.c        **** //  
 778:main.c        **** //  Nada	->	V			DT=3
 779:main.c        **** //  V		->	V+H		OCR=0
 780:main.c        **** //  V+H	->	V			OCR=NADA_OCR
 781:main.c        **** //  V		->	Nada		DT=2
 782:main.c        **** //
 783:main.c        **** //  Nada	->	DE			DT=1
 784:main.c        **** //  DE	->	Nada		DT=2
 785:main.c        **** 
 786:main.c        **** 
 787:main.c        **** #if (defined(REMOVE_DC) && REMOVE_DC)
 788:main.c        **** #error "REMOVE_DC hasn't been tested since lcdStuff, or long prior"
 789:main.c        ****  #define Nada_init()         { DT1=(3<<4); OCR1A=5; }
 790:main.c        **** 
 791:main.c        ****  //Unused, normally...
 792:main.c        ****  #define Vsync_init()       { DT1=(4<<4);  OCR1A=5; }
 793:main.c        ****  #define VplusH_init()      { DT1=0;       OCR1A=1; }
 794:main.c        ****  #define Hsync_init()       { DT1=(3<<4);  OCR1A=3; }
 795:main.c        ****  #define DEonly_init()      { DT1=(2<<4);  OCR1A=4; }
 796:main.c        ****  #define DEblue_init()		 { DT1=0;       OCR1A=5; }
 797:main.c        **** 
 798:main.c        **** #else //!REMOVE_DC
 799:main.c        **** //Nada init
 800:main.c        ****  #define Nada_init()         { DT1=(3<<4); OCR1A=4; }
 801:main.c        **** 
 802:main.c        **** //Unused, normally...
 803:main.c        ****  #define Vsync_init()			{ DT1=(4<<4);	OCR1A=4; }
 804:main.c        ****  #define VplusH_init()		{ DT1=0;			OCR1A=0; }
 805:main.c        ****  #define Hsync_init()			{ DT1=(3<<4);	OCR1A=3; }
 806:main.c        **** // #define DE_init()				{ DT1=(2<<4);	OCR1A=4; } //...SHOULD BE
 807:main.c        ****  #define DEonly_init()			{ DT1=(2<<4);  OCR1A=4; }
 808:main.c        ****  #define DEblue_init()			{ DT1=0;       OCR1A=6; }
 809:main.c        **** //#define DE_init()				{ DT1=(1<<4);	OCR1A=2; } //Works with DE_ONLY
 810:main.c        ****  //#define DE_init()				{ DT1=0;			OCR1A=0xff; }	//DE_BLUE
 811:main.c        **** #endif //REMOVE_DC
 812:main.c        **** 
 813:main.c        **** 
 814:main.c        **** //#define FULL_INIT_TESTS TRUE
 815:main.c        **** 
 816:main.c        **** //Display is DE-Only (doesn't use H/Vsync)
 817:main.c        **** // Shouldn't be necessary to select this if it is,
 818:main.c        **** // since DE timing is the same either way
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 37


 819:main.c        **** // but I want to test whether a single-bit is being detected
 820:main.c        **** // (e.g. maybe the rise/fall-times of the output aren't fast enough for a
 821:main.c        **** //  single bit, which might explain why the other display didn't work)
 822:main.c        **** #if (defined(DE_ONLY_DISPLAY) && DE_ONLY_DISPLAY)
 823:main.c        **** #define Vsync_fromNada()      Nada_init()
 824:main.c        **** #define VplusH_fromVsync()    Nada_init()
 825:main.c        **** #define Vsync_fromVplusH()    Nada_init()
 826:main.c        **** #define Nada_fromVsync()      Nada_init()
 827:main.c        **** #define Hsync_fromNada()      Nada_init()
 828:main.c        **** #define Nada_fromHsync()      Nada_init()
 829:main.c        **** #define DEonly_fromNada()     DE_init()
 830:main.c        **** #define DEblue_fromDEonly()	DE_init()
 831:main.c        **** #define Nada_fromDEblue()		Nada_init()
 832:main.c        ****  #if(DE_BLUE)
 833:main.c        ****   #warning "DE_BLUE is true, but not implemented with DE_ONLY_DISPLAY"
 834:main.c        ****   #warning "...The display should be blank"
 835:main.c        ****  #endif
 836:main.c        **** //Use full initialization of each LVDS state
 837:main.c        **** // (might not be good during transitions, but should guarantee
 838:main.c        **** //  steady-state, in case my transitions aren't correct...)
 839:main.c        **** #elif (defined(FULL_INIT_TESTS) && FULL_INIT_TESTS)
 840:main.c        **** #define Vsync_fromNada()		Vsync_init()
 841:main.c        **** #define VplusH_fromVsync()		VplusH_init()
 842:main.c        **** #define Vsync_fromVplusH()		Vsync_init()
 843:main.c        **** #define Nada_fromVsync()		Nada_init()
 844:main.c        **** #define Hsync_fromNada()		Hsync_init()
 845:main.c        **** #define Nada_fromHsync()		Nada_init()
 846:main.c        **** #define DEonly_fromNada()		DEonly_init()
 847:main.c        **** #define DEblue_fromDEonly()	DEblue_init()
 848:main.c        **** #define Nada_fromDEonly()		Nada_init()
 849:main.c        **** #define Nada_fromDEblue()		Nada_init()
 850:main.c        **** 
 851:main.c        **** 
 852:main.c        **** #else	//NOT FULL_INIT_TESTS
 853:main.c        **** //#define Vsync_fromNada()   { DT1=(4<<4); }
 854:main.c        **** #define Vsync_fromNada()   { DT1=(4<<4); OCR1A=5; } //Leave two bits high
 855:main.c        **** 																	 //for easy-scoping
 856:main.c        **** 						//Three would be nicer, but I'm pretty sure OCR=TOP=ON
 857:main.c        **** #define VplusH_fromVsync() { OCR1A=0; }
 858:main.c        **** //#define Vsync_fromVplusH() { OCR1A=4; }
 859:main.c        **** #define Vsync_fromVplusH() { OCR1A=5; }				//Extra bits for scoping
 860:main.c        **** //#define Nada_fromVsync()   { DT1=(3<<4); }
 861:main.c        **** #define Nada_fromVsync()   { DT1=(3<<4); OCR1A=4; } //scoping...
 862:main.c        **** #define Hsync_fromNada()   { OCR1A=3; }
 863:main.c        **** #define Nada_fromHsync()   { OCR1A=4; }
 864:main.c        **** 
 865:main.c        **** #define Nada_fromDEblue()	{ DT1=(3<<4); OCR1A=4; }
 866:main.c        **** #define Nada_fromDEonly()	{ DT1=(3<<4); }
 867:main.c        **** #define DEonly_fromNada()	{ DT1=(2<<4); }
 868:main.c        **** #define DEblue_fromNada()	{ OCR1A=0xff; }
 869:main.c        **** #define DEblue_fromDEonly() { OCR1A=0xff; }
 870:main.c        **** 
 871:main.c        **** /*
 872:main.c        **** #if (!defined(DE_BLUE) || !DE_BLUE)
 873:main.c        ****  //Nada -> DE
 874:main.c        ****  //#define DE_fromNada()      { DT1=(1<<4); }	//DT1 = (1<<4);
 875:main.c        ****  #define DE_fromNada()      { DT1=(2<<4); }
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 38


 876:main.c        ****  //DE -> Nada
 877:main.c        ****  //#define Nada_fromDE()      { DT1=(2<<4); }	//DT1 = (2<<4);
 878:main.c        ****  #define Nada_fromDE()      { DT1=(3<<4); }
 879:main.c        **** #else
 880:main.c        ****  //Nada -> DE
 881:main.c        ****  //#define DE_fromNada()      { OCR1A=0xff; }   //DT1 = (1<<4);
 882:main.c        ****  #define DE_fromNada()      { OCR1A=0xff; }
 883:main.c        ****  //DE -> Nada
 884:main.c        ****  //#define Nada_fromDE()      { OCR1A=3; }   //DT1 = (2<<4);
 885:main.c        ****  #define Nada_fromDE()      { OCR1A=4; }
 886:main.c        **** #endif
 887:main.c        **** */
 888:main.c        **** #endif //End Of FULL_INIT_TESTS
 889:main.c        **** 
 890:main.c        **** 
 891:main.c        **** 
 892:main.c        **** // NOTES:
 893:main.c        **** //    DeadTimer requires
 894:main.c        **** //        COM1x1:0 = 01 ("Complementary Compare Output Mode" ?)
 895:main.c        **** //      Complementary Compare Output Mode:
 896:main.c        **** //        OCW1A: cleared on match, set at BOTTOM
 897:main.c        **** //    If PWM1X (pwm inversion) is used, OC1A = !OCW1A
 898:main.c        **** //        (Does not affect DT)
 899:main.c        **** //
 900:main.c        **** // CLOCK:
 901:main.c        **** //    Can NOT use differential mode with:
 902:main.c        **** //		 OC1B pin is -differential input (through a resistor)
 903:main.c        **** //    /OC1B pin is +differential input (through a resistor)
 904:main.c        **** //    BECAUSE: DeadTimer affects ALL PWM channels
 905:main.c        **** //
 906:main.c        **** 
 907:main.c        **** //
 908:main.c        **** //
 909:main.c        **** // ISSUES:
 910:main.c        **** //    Using Dead-Timer does not allow for use of complementary outputs
 911:main.c        **** //      as complementary LVDS inputs... 
 912:main.c        **** //      DeadTimer affects ALL PWM channels in complementary mode
 913:main.c        **** //    (e.g. RXclkin+ on OC1B and RXclkin- on /OC1B is not an option)
 914:main.c        **** //
 915:main.c        **** 
 916:main.c        **** 
 917:main.c        **** // The typical patterns look like this (not at all to scale):
 918:main.c        **** //   ----______------------------------------------------___----- V
 919:main.c        **** //      --_--_--_--_--_--_--_--_--_--_--_--_--_--_ H
 920:main.c        **** //      __________-__-__-__-__-__-__-__-__-__-  DE
 921:main.c        **** //                 
 922:main.c        **** //             ^^^^\														//blah
 923:main.c        **** //             1234 5?
 924:main.c        **** // Pixels are sent during DE High (basically all the CPU will be used here)
 925:main.c        **** //Ideally, 
 926:main.c        **** //  there won't be any glitches when changing from one state to another
 927:main.c        **** //
 928:main.c        **** //  NOTES: PWM1X inversion affects all PWM channels!
 929:main.c        **** //
 930:main.c        **** //  Unchangeables:
 931:main.c        **** //    FastPWM
 932:main.c        **** //		inverted with PWM1X
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 39


 933:main.c        **** //
 934:main.c        **** //  Init (pre 1):
 935:main.c        **** //    DeadTimerRising=1
 936:main.c        **** //
 937:main.c        **** //  The states are:
 938:main.c        **** //   (Not necessarily accurate, just looking into necessary changes)
 939:main.c        **** //   (from Vsync L->H)
 940:main.c        **** //
 941:main.c        **** //   1  NothingActive (long, No DE, VporchFrontTimes)
 942:main.c        **** //      *  1<=DeadTimerRising<=5
 943:main.c        **** //        (OCW1A: set @ BOTTOM, cleared @ OCR1A
 944:main.c        **** //      *  OCR1A == 6
 945:main.c        **** //
 946:main.c        **** //   2  Hsync
 947:main.c        **** //      *  DeadTimer _OFF_ -> Horiz
 948:main.c        **** //        (OCW1A: set @ BOTTOM, cleared @ OCR1A
 949:main.c        **** //        (OCR1A == 6
 950:main.c        **** //   3  NothingActive (short)
 951:main.c        **** //      *  1<=DeadTimerRising<=5
 952:main.c        **** //        (OCW1A: set @ BOTTOM, cleared @ OCR1A
 953:main.c        **** //        (OCR1A == 6
 954:main.c        **** //   4  DE
 955:main.c        **** //        (1<=DeadTimerRising<(=?)5 (>1 for blue pixels?) 
 956:main.c        **** //            (==5 cancelled by OCR1A match?)
 957:main.c        **** //        (OCW1A: set @ BOTTOM, cleared @ OCR1A
 958:main.c        **** //      *  OCR1A = 5 (or 1<=OCR1A<5 for blue pixels?)
 959:main.c        **** //   5  NothingActive(?)
 960:main.c        **** //        (1<=DeadTimerRising<=5
 961:main.c        **** //        (OCW1A: set @ BOTTOM, cleared @ OCR1A
 962:main.c        **** //      *  OCR1A == 6
 963:main.c        **** //
 964:main.c        **** //   7  Repeat 2-5 for each row
 965:main.c        **** //
 966:main.c        **** //   8  NothingActive (long, No DE, VporchBackTimes)
 967:main.c        **** //      ?  1<=DeadTimerRising<=5
 968:main.c        **** //        (OCW1A: set @ BOTTOM, cleared @ OCR1A
 969:main.c        **** //        (OCR1A == 6
 970:main.c        **** //
 971:main.c        **** //   9  V w/o H
 972:main.c        **** //      ?  OFF <= DeadTimer <= (5 - OCR1A)
 973:main.c        **** //     **  OCW1A: cleared at BOTTOM, set at OCR1A
 974:main.c        **** //            ??? What is the effect of changing this while running?
 975:main.c        **** //      *  1 <= OCR1A <= 5
 976:main.c        **** //   10 V w/  H
 977:main.c        **** //      ?   DeadTimer OFF (H -> Low)
 978:main.c        **** //      *   OCW1A: set @ BOTTOM, cleared @ OCR1A
 979:main.c        **** //      *   OCR1A > (=?) OCR1C
 980:main.c        **** //
 981:main.c        **** //   11 Repeat 9-10 for Vsync time...
 982:main.c        **** //
 983:main.c        **** 
 984:main.c        **** // Here's how it worked pre-lvds:
 985:main.c        **** // HSYNC, VSYNC, and DE refer to the actual pins
 986:main.c        **** // In the LVDS setup, there're modes corresponding to each pin-combination
 987:main.c        **** //
 988:main.c        **** // Timer Interrupt:
 989:main.c        **** //  loadData:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 40


 990:main.c        **** //   HSYNC active
 991:main.c        **** //   HSYNC Low delay
 992:main.c        **** //   HSYNC inactive
 993:main.c        **** //   if(dataEnable)
 994:main.c        **** //    DE active
 995:main.c        **** //     Send row data
 996:main.c        **** //    DE inactive
 997:main.c        **** //  //Prep for next interrupt
 998:main.c        **** //  switch(hsyncCount++)
 999:main.c        **** //    //Vsync H->L (active)
1000:main.c        **** //    1:
1001:main.c        **** //          dataEnable=FALSE
1002:main.c        **** //          VSYNC active
1003:main.c        **** //    //Vsync L->H (inactive)
1004:main.c        **** //    T_Vlow:
1005:main.c        **** //          VSYNC inactive
1006:main.c        **** //    //Start of frame
1007:main.c        **** //    T_VD +(T_Vlow):
1008:main.c        **** //          dataEnable=TRUE
1009:main.c        **** //    //All rows have been displayed
1010:main.c        **** //    V_COUNT +(T_VD+T_Vlow):
1011:main.c        **** //          dataEnable=FALSE
1012:main.c        **** //    //Frame Complete
1013:main.c        **** //    T_DV +(V_COUNT+T_VD+T_Vlow): 
1014:main.c        **** //          hsyncCount=0
1015:main.c        **** //  if(dataEnable)
1016:main.c        **** //    Use the remaining time to load the next row to memory
1017:main.c        **** 
1018:main.c        **** //  So:
1019:main.c        **** //Interrupt0       End
1020:main.c        **** //    |             |  Interrupt1
1021:main.c        **** //    v             v  v
1022:main.c        **** //  H |_||_||_|
1023:main.c        **** // DE ___________________________________________________ ...
1024:main.c        **** //  V |_____________________________________ ...
1025:main.c        **** //       |        ||
1026:main.c        **** // DETIME^--------^|
1027:main.c        **** //                 |
1028:main.c        **** //                 VSYNC active
1029:main.c        **** //                 dataEnable=FALSE (not necessary?)
1030:main.c        **** //
1031:main.c        **** //InterruptT_Vlow   End
1032:main.c        **** //    |             |
1033:main.c        **** //    v             v
1034:main.c        **** //  H |_||_||_|
1035:main.c        **** // DE ___________________________________________________ ...
1036:main.c        **** //  V _____________| ...
1037:main.c        **** //       |        ||
1038:main.c        **** // DETIME^--------^|
1039:main.c        **** //                 |
1040:main.c        **** //                 VSYNC inactive
1041:main.c        **** //
1042:main.c        **** //
1043:main.c        **** //InterruptT_VD   End  InterruptT_VD+1
1044:main.c        **** //    |             |  |            End
1045:main.c        **** //    v             v  v            v
1046:main.c        **** //  H |_||_||_|
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 41


1047:main.c        **** // DE ____________________||_______||____ ...
1048:main.c        **** //  V 
1049:main.c        **** //       |        ||      |        |
1050:main.c        **** // DETIME^--------^|      ^--------^
1051:main.c        **** //                 |
1052:main.c        **** //                 dataEnable=TRUE
1053:main.c        **** //
1054:main.c        **** //InterruptV_COUNT  End
1055:main.c        **** //    |             |
1056:main.c        **** //    v             v
1057:main.c        **** //  H |_||_||_|
1058:main.c        **** // DE ___||______________________________________ ...
1059:main.c        **** //  V 
1060:main.c        **** //       |        ||      |        |
1061:main.c        **** // DETIME^--------^|      ^--------^
1062:main.c        **** //                 |
1063:main.c        **** //                 dataEnable=FALSE
1064:main.c        **** //
1065:main.c        **** //
1066:main.c        **** // This isn't really a state, it's basically just:
1067:main.c        **** // if(hsyncCount == NUM_HYSYNCS_PER_FRAME)
1068:main.c        **** //    hsyncCount = 0;
1069:main.c        **** //                    .....................................
1070:main.c        **** //                    .                                   .
1071:main.c        **** //InterruptT_DV   End .Interrupt0                         .
1072:main.c        **** //    |             | .|                                  .
1073:main.c        **** //    v             v .v                                  .
1074:main.c        **** //  H |_||_||_|
1075:main.c        **** // DE ___________________________________________________ .
1076:main.c        **** //  V |____________________ .
1077:main.c        **** //       |        ||  .   |        |                      .
1078:main.c        **** // DETIME^--------^|  .   ^--------^                      .
1079:main.c        **** //                 |  .                                   .
1080:main.c        **** //                 hsyncCount=0 (repeat from Interrupt0)  .
1081:main.c        **** //                    .                                   .
1082:main.c        **** //                    .....................................
1083:main.c        **** //
1084:main.c        **** 
1085:main.c        **** 
1086:main.c        **** // NOW to compare with LVDS states:
1087:main.c        **** //
1088:main.c        **** //Interrupt0       End
1089:main.c        **** //    |             |  Interrupt1
1090:main.c        **** //    v             v  v
1091:main.c        **** //  H |_||_||_|
1092:main.c        **** // DE ___________________________________________________ ...
1093:main.c        **** //  V |_____________________________________ ...
1094:main.c        **** //    ^ ^          ^   ^ ^
1095:main.c        **** //    | |          |   | |
1096:main.c        **** //    | |          |   | +--- V w/o H  \ These two toggle until
1097:main.c        **** //    | |          |   +----- V w/ H   / next LCD state...
1098:main.c        **** //    | |          |
1099:main.c        **** //    | |          +--------- V w/o H > Intermediate change of state
1100:main.c        **** //    | |
1101:main.c        **** //    | +----- NothingActive  \ From Previous State (?)
1102:main.c        **** //    +------- H_Only         /
1103:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 42


1104:main.c        **** 
1105:main.c        **** //InterruptT_Vlow   End
1106:main.c        **** //    |             |
1107:main.c        **** //    v             v
1108:main.c        **** //  H |_||_||_|
1109:main.c        **** // DE ___________________________________________________ ...
1110:main.c        **** //  V _____________| ...
1111:main.c        **** //    ^ ^          ^   ^ ^
1112:main.c        **** //    | |          |   | |
1113:main.c        **** //    | |          |   | +--- NothingActive  \ These two toggle until
1114:main.c        **** //    | |          |   +----- H_Only         / next LCD state...
1115:main.c        **** //    | |          |
1116:main.c        **** //    | |          +--------- NothingActive > Intermediate change of state
1117:main.c        **** //    | |
1118:main.c        **** //    | +----- V w/o H   \ From previous state
1119:main.c        **** //    +------- V w/ H    /
1120:main.c        **** 
1121:main.c        **** 
1122:main.c        **** //InterruptT_VD   End  InterruptT_VD+1
1123:main.c        **** //    |             |  |            End
1124:main.c        **** //    v             v  v            v
1125:main.c        **** //  H |_||_||_|
1126:main.c        **** // DE ____________________||_______||____ ...
1127:main.c        **** //  V 
1128:main.c        **** //    ^ ^              ^ ^^        ^ 
1129:main.c        **** //    | |              | ||        |
1130:main.c        **** //    | |              | ||        +--- NothingActive  \  These four
1131:main.c        **** //    | |              | |+------------ DE              | cycle until
1132:main.c        **** //    | |              | +------------- NothingActive   | next LCD state...
1133:main.c        **** //    | |              +--------------- H_Only  ^      /
1134:main.c        **** //    | |                                       |
1135:main.c        **** //    | +----- NothingActive  \ From previous   |
1136:main.c        **** //    +------- H_Only         / state           +-This intermediate state
1137:main.c        **** //                                                may not be necessary
1138:main.c        **** //                                                (IAXG01 shows 160 dots!)
1139:main.c        **** 
1140:main.c        **** 
1141:main.c        **** 
1142:main.c        **** //InterruptV_COUNT  End
1143:main.c        **** //    |             |
1144:main.c        **** //    v             v
1145:main.c        **** //  H |_||_||_|
1146:main.c        **** // DE ___||______________________________________ ...
1147:main.c        **** //  V 
1148:main.c        **** //    ^ ^^        ^    ^ ^
1149:main.c        **** //    | ||        |    | |
1150:main.c        **** //    | ||        |    | +--- NothingActive \  These two toggle
1151:main.c        **** //    | ||        |    +----- H_Only        /  until next LCD state
1152:main.c        **** //    | ||        |
1153:main.c        **** //    | ||        +---- NothingActive \ 								//blah
1154:main.c        **** //    | |+------------- DE             |  From previous state
1155:main.c        **** //    | +-------------- NothingActive  |
1156:main.c        **** //    +---------------- H_Only        /
1157:main.c        **** 
1158:main.c        **** // This isn't really a state, it's essentially just:
1159:main.c        **** //  if(hsyncCount == NUM_HSYNCS_PER_FRAME)
1160:main.c        **** //    hsyncCount = 0;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 43


1161:main.c        **** //                    .....................................
1162:main.c        **** //                    .                                   .
1163:main.c        **** //InterruptT_DV   End .Interrupt0                         .
1164:main.c        **** //    |             | .|                                  .
1165:main.c        **** //    v             v .v                                  .
1166:main.c        **** //  H |_||_||_|
1167:main.c        **** // DE ___________________________________________________ .
1168:main.c        **** //  V |____________________ .
1169:main.c        **** //    ^ ^             .                                   .
1170:main.c        **** //    | |             .....................................
1171:main.c        **** //    | +--- NothingActive \											//blah
1172:main.c        **** //    +----- H_Only        / From previous state...
1173:main.c        **** 
1174:main.c        **** 
1175:main.c        **** 
1176:main.c        **** //  LVDS State transitions:
1177:main.c        **** //   1 H_Only
1178:main.c        **** //   2 NothingActive
1179:main.c        **** //
1180:main.c        **** //   3 V w/o H
1181:main.c        **** //   4 V w/ H
1182:main.c        **** //    
1183:main.c        **** //   (repeat 3,4)
1184:main.c        **** //
1185:main.c        **** //   5 V w/o H
1186:main.c        **** //
1187:main.c        **** //   6 NothingActive
1188:main.c        **** //   7 H_Only
1189:main.c        **** //
1190:main.c        **** //   (repeat 6,7)
1191:main.c        **** //
1192:main.c        **** //   8 NothingActive
1193:main.c        **** //
1194:main.c        **** //   9 H_Only
1195:main.c        **** //  10 NothingActive
1196:main.c        **** //  11 DE
1197:main.c        **** //  12 NothingActive
1198:main.c        **** //
1199:main.c        **** //  (repeat 9-12)
1200:main.c        **** //
1201:main.c        **** //  13 H_Only
1202:main.c        **** //  14 NothingActive
1203:main.c        **** //
1204:main.c        **** //  (repeat 13-14)
1205:main.c        **** //
1206:main.c        **** //   These should be reviewed to determine which changes are necessary
1207:main.c        **** //   between each state...
1208:main.c        **** //   (the fewer changes, the less likely we'll glitch...?)
1209:main.c        **** 
1210:main.c        **** 
1211:main.c        **** // This'll probably be better rearranged...
1212:main.c        **** //  For now, though, OC1A is in all the notes above, for the D/V/H signal
1213:main.c        **** //  so OC1B is for the clock...
1214:main.c        **** // CHANGING THESE does NOT change channel association.
1215:main.c        **** #define DVH_OCR	OCR1A
1216:main.c        **** #define CLOCK_OCR	OCR1B
1217:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 44


1218:main.c        **** 
1219:main.c        **** void pll_enable(void)
1220:main.c        **** {
1221:main.c        **** 	//Stolen from threePinIDer109t:
1222:main.c        **** 
1223:main.c        ****    //Set Timer1 to use the "asynchronous clock source" (PLL at 64MHz)
1224:main.c        ****    // With phase-correct PWM (256 steps up, then back down) and CLKDIV1
1225:main.c        ****    // this is 64MHz/512=125kHz
1226:main.c        ****    // The benefit of such high PWM frequency is the low RC values necessary
1227:main.c        ****    //  for filtering to DC.
1228:main.c        ****    // "To change Timer/Counter1 to the async mode follow this procedure"
1229:main.c        ****    // 1: Enable the PLL
1230:main.c        ****    setbit(PLLE, PLLCSR);
1231:main.c        ****    // 2: Wait 100us for the PLL to stabilize
1232:main.c        ****    // (can't use dmsWait since the timer updating the dmsCount hasn't yet been started!)
1233:main.c        ****    _delay_us(100);
1234:main.c        **** //   dmsWait(1);
1235:main.c        ****    // 3: Poll PLOCK until it is set...
1236:main.c        ****    while(!getbit(PLOCK, PLLCSR))
1237:main.c        ****    {
1238:main.c        ****       asm("nop");
1239:main.c        ****    }
1240:main.c        ****    // 4: Set the PCKE bit to enable async mode
1241:main.c        ****    setbit(PCKE, PLLCSR);
1242:main.c        **** 
1243:main.c        **** }
1244:main.c        **** 
1245:main.c        **** void lvds_timerInit(void)
1246:main.c        **** {
1247:main.c        ****    //Timer1 is used for LVDS (in PLL clocking mode)
1248:main.c        ****   
1249:main.c        ****   	//pll_enable();	
1250:main.c        ****    
1251:main.c        ****    //We want it to count 7 bits, 0-6 and reset at 7
1252:main.c        ****    OCR1C = 6;
1253:main.c        **** 
1254:main.c        **** 	//We want the clock to go low at TCNT=0 and high at TCNT=4
1255:main.c        **** 	CLOCK_OCR = 3; //2; //3;
1256:main.c        ****    
1257:main.c        **** 
1258:main.c        **** // My 'scope is only 20MHz, and I'd rather be able to use the digital mode
1259:main.c        **** // which is even slower...
1260:main.c        **** 
1261:main.c        **** 
1262:main.c        **** //Overridden when SLOW_EVERYTHING_TEST is true...
1263:main.c        **** //#define TOOFAST_TEST TRUE
1264:main.c        **** #warning "HERE AND BELOW, doesn't OSCCAL have special write requirements?"
1265:main.c        **** //OSCCAL = 0x00;
1266:main.c        **** #if (defined(SLOW_EVERYTHING_TEST) && SLOW_EVERYTHING_TEST)
1267:main.c        **** //FOR TESTING. This should slow the clock...
1268:main.c        **** 	// Gives roughly 4MHz...
1269:main.c        **** 	OSCCAL = 0x00; //0x80; 
1270:main.c        **** 
1271:main.c        **** 	// This should divide the system clock by 256
1272:main.c        **** 	// does this affect the PLL? NO.
1273:main.c        **** 	// The PLL is clocked only by the RC Oscillator
1274:main.c        **** 	//   OSCCAL does affect it.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 45


1275:main.c        **** 	// OPTIONS FOR SIMULATING FULL FUNCTIONALITY AT LOW SPEED:
1276:main.c        **** 	// Run PLL as normal
1277:main.c        **** 	//  Prescale Timer1 and DeadTimer equally
1278:main.c        **** 	//  Prescale System clock equally
1279:main.c        **** 	CLKPR = (1<<CLKPCE);
1280:main.c        **** 	CLKPR = (1<<CLKPS1) | (1<<CLKPS0);	//CLKDIV8
1281:main.c        **** 	//4MHz / 8 = .5Mhz...
1282:main.c        **** 	//PLL is 4MHz*8 = 32MHz
1283:main.c        **** 	// then TimerClockDivisor=8 gives 4MHz
1284:main.c        **** 	pll_enable();
1285:main.c        **** 	#define SLOW_LVDS_TEST TRUE
1286:main.c        **** #elif (defined(OSCCAL_VAL))
1287:main.c        ****    OSCCAL = OSCCAL_VAL;
1288:main.c        **** #endif
1289:main.c        **** 
1290:main.c        **** 
1291:main.c        **** 
1292:main.c        **** #if (defined(SLOW_LVDS_TEST) && SLOW_LVDS_TEST)
1293:main.c        **** 	//This case doesn't really make sense without SLOW_EVERYTHING...
1294:main.c        **** 	//8x prescaler for Timer1
1295:main.c        **** 	#define CSBITS (1<<CS12)
1296:main.c        **** 	//8x prescaler for the dead-timer
1297:main.c        **** 	#define DTPSBITS ((1<<DTPS11) | (1<<DTPS10))
1298:main.c        **** #elif (defined(LVDS_PRESCALER))
1299:main.c        **** 	//Timer1 on the Tiny861 uses a strange CLKDIV scheme...
1300:main.c        **** 	// (but it's nicer!)
1301:main.c        **** 	// The divisor is (1<<(csbits-1))
1302:main.c        **** 	// so a divisor of 1 = (1<<0) = (1<<(1-1)), (csbits = 0x1)
1303:main.c        **** 	// 256 = (1<<8) = (1<<(9-1)), (csbits = 0x9)
1304:main.c        **** 	// 512 = (1<<9) = (1<<(10-1)), (csbits = 0xA)
1305:main.c        **** 	// ...
1306:main.c        **** 	// (0x0 stops the timer)
1307:main.c        **** 	/*
1308:main.c        **** 		uint16_t divisor;
1309:main.c        **** 		uint8_t csbits = 0;
1310:main.c        **** 		for(divisor=CLKDIV; divisor != 0; divisor>>=1)
1311:main.c        **** 		   csbits++;
1312:main.c        **** 			writeMasked(csbits, 0x0f, TCCR1B);
1313:main.c        **** 	*/
1314:main.c        **** 
1315:main.c        **** //#if ((LVDS_PRESCALER != 64) && (LVDS_PRESCALER != 32) && \
1316:main.c        **** //	  (LVDS_PRESCALER != 16) && 
1317:main.c        **** #if ((LVDS_PRESCALER != 8) && \
1318:main.c        **** 	  (LVDS_PRESCALER != 4)  && (LVDS_PRESCALER != 2) && \
1319:main.c        **** 	  (LVDS_PRESCALER != 1))
1320:main.c        **** #error "LVDS_PRESCALER must be a power of 2, from 1 to 8"
1321:main.c        **** #endif
1322:main.c        **** 
1323:main.c        **** 	//Figured this out in cTools/dePower.c...
1324:main.c        **** 	//64 is overkill here, since the deadTimer prescaler only goes to 8...
1325:main.c        **** #define divToCS(div) \
1326:main.c        **** 	( (div == 64) ? 7 : (div == 32) ? 6 : (div == 16) ? 5 : (div == 8) ? 4 \
1327:main.c        **** 	  : (div == 4) ? 3 : (div == 2) ? 2 : (div == 1) ? 1 : 0)
1328:main.c        **** 
1329:main.c        **** 
1330:main.c        **** 	//CSBITS (through PLL/8) (CS10 is bit 0)
1331:main.c        **** 	//CS12:10	CS12	CS11	CS10		PLL division
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 46


1332:main.c        **** 	//1			0		0		1			1
1333:main.c        **** 	//2			0		1		0			2
1334:main.c        **** 	//3			0		1		1			4
1335:main.c        **** 	//4			1		0		0			8
1336:main.c        **** 	#define CSBITS divToCS(LVDS_PRESCALER) //<<CS10 should be redundant
1337:main.c        **** 	//DTPSBITS (DTPS10 is bit 4)
1338:main.c        **** 	//DTPS11:10	DTPS11 DTPS10	PLL division
1339:main.c        **** 	//0			0		0			1
1340:main.c        **** 	//1			0		1			2
1341:main.c        **** 	//2			1		0			4
1342:main.c        **** 	//3			1		1			8
1343:main.c        **** 	#define DTPSBITS ((CSBITS-1)<<DTPS10)
1344:main.c        **** 
1345:main.c        **** 	//Whoops! Forgot this (a/o 42-som'n WTF1pix)
1346:main.c        **** 	// so, it's promising to get single-pixel control...
1347:main.c        **** 	//  the result was kinda ugly, though... scroll was quite slow
1348:main.c        **** 	// Further, it was only drawing a certain number of pixels...
1349:main.c        **** 	//  (horizontally... pre LVDS_PRESCALER affecting DOTS_TO_CYC)
1350:main.c        **** 	//  so accessing *all* pixels in a row would make it even slower...
1351:main.c        **** 	// Further, it didn't seem to be paying attention to the fact that
1352:main.c        **** 	// the same pixels are drawn on multiple rows...
1353:main.c        **** 	// WTF? (the image was scaled, proportionately! 1pix x 1pix)
1354:main.c        **** 	pll_enable();
1355:main.c        **** 
1356:main.c        **** #else
1357:main.c        **** 	//No clock divisor
1358:main.c        **** 	#define CSBITS (1<<CS10)
1359:main.c        **** 	//No dead-timer divisor
1360:main.c        **** 	#define DTPSBITS 0
1361:main.c        **** 	pll_enable();
1362:main.c        **** 	//#warning "The PLL configuration code is not in here yet!"
1363:main.c        **** #endif
1364:main.c        **** 
1365:main.c        **** 	//Set the Timer1 clock prescaler...
1366:main.c        **** 	writeMasked(CSBITS, 
1367:main.c        **** 					((1<<CS13) | (1<<CS12) | (1<<CS11) | (1<<CS10)),
1368:main.c        **** 					TCCR1B);
1369:main.c        **** 
1370:main.c        **** 	//Set the DeadTime prescaler (no prescaling, same speed as TCNT1)...
1371:main.c        **** 	// Allegedly this is prescaled from the PCK (or CK)
1372:main.c        **** 	// 	NOT from the Timer1 prescaler...
1373:main.c        **** 	writeMasked(DTPSBITS,
1374:main.c        **** 					((1<<DTPS11) | (1<<DTPS10)),
1375:main.c        **** 					TCCR1B);
1376:main.c        **** 
1377:main.c        **** 
1378:main.c        **** 
1379:main.c        ****    //All LVDS modes (and signals) use FastPWM.. 
1380:main.c        ****  
1381:main.c        ****    //FastPWM
1382:main.c        **** //Now Handled in lvds_xxxOnCompare():
1383:main.c        **** 
1384:main.c        **** 	//These are also written below (excluding PWM1D)
1385:main.c        **** 	setbit(PWM1A, TCCR1A);  //Enable PWM on OC1A for DVH
1386:main.c        ****                            //Need to do the same for other channels
1387:main.c        ****   
1388:main.c        **** 	setbit(PWM1B, TCCR1A);  //Enable PWM on OC1B for CLOCK 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 47


1389:main.c        **** 
1390:main.c        **** 	setbit(PWM1D, TCCR1C);
1391:main.c        **** 
1392:main.c        **** 	//PWM1D is not in TCCR1A...
1393:main.c        **** 
1394:main.c        **** 	setoutPORT(PB1, PORTB);	//+OC1A, DVH/BLUE, MISO (usually heart)
1395:main.c        **** //	setoutPORT(PB0, PORTB);	//-OC1A 	MOSI unused
1396:main.c        **** 	setoutPORT(PB2, PORTB); //-OC1B, -GREEN	 (INVERTED) SCK
1397:main.c        **** 	setoutPORT(PB3, PORTB); //+OC1B Clock (OC1B, not inverted)
1398:main.c        **** 	setoutPORT(PB5, PORTB); //+OC1D, RED
1399:main.c        **** 
1400:main.c        **** 
1401:main.c        ****    writeMasked(((0<<WGM11) | (0<<WGM10)), //FastPWM (combined with above)
1402:main.c        ****                ((1<<WGM11) | (1<<WGM10)), // (affects all PWM channels)
1403:main.c        ****                TCCR1D);
1404:main.c        **** 
1405:main.c        **** 	//OC1A is used, but /OC1A isn't
1406:main.c        **** // Not Valid (deadTime only functions if in complementary-mode):
1407:main.c        **** 	// OTOH: dead-time is not necessary in the only case we need to switch
1408:main.c        **** 	// Most lvds states use clear on compare-match, set at 0
1409:main.c        **** 	// But there is one that uses the opposite
1410:main.c        **** 	// This can be toggled by a single bit-change
1411:main.c        **** 	//  COM1A1 = 1
1412:main.c        **** 	//  COM1A0 value indicates what happens on Compare-Match
1413:main.c        **** 	//					  or ! at BOTTOM
1414:main.c        **** //#define lvds_clrOnCompare() clrbit(COM1A0, TCCR1A)
1415:main.c        **** //#define lvds_setOnCompare() setbit(COM1A0, TCCR1A)
1416:main.c        **** 	//HOWEVER: the alternative is possible:
1417:main.c        **** 	// Use complementary (clear-on-compare)
1418:main.c        **** 	// and single-ended with set-on-compare
1419:main.c        **** 	// COM1A0 = 1
1420:main.c        **** 	// COM1A1 value indicates what happens on Compare-Match
1421:main.c        **** 
1422:main.c        **** /* These are three instructions apiece!
1423:main.c        **** #define lvds_ComplementaryClrOnCompare() clrbit(COM1A1, TCCR1A)
1424:main.c        **** 
1425:main.c        **** #define lvds_setOnCompare() setbit(COM1A1, TCCR1A)
1426:main.c        **** #define lvds_clrOnCompare() lvds_ComplementaryClrOnCompare()
1427:main.c        **** */
1428:main.c        **** 
1429:main.c        **** //Page 99:
1430:main.c        **** // "In Fast PWM Mode ... when the COM1x1:0 bits are set to 01 ...
1431:main.c        **** //  an user programmable Dead Time delay is inserted for 
1432:main.c        **** //  these complementary output pairs (OC1x and OC1x)."
1433:main.c        **** 
1434:main.c        **** //Page 98:
1435:main.c        **** // "The counter is loaded with a 4-bit DT1H or DT1L value from DT1 
1436:main.c        **** //  I/O register, depending on the edge of the Waveform 
1437:main.c        **** //  Output (OCW1x) when the dead time insertion is started."
1438:main.c        **** // In other words, (as it appears from the diagram)
1439:main.c        **** //  the dead-time value is loaded into the counter when the corresponding
1440:main.c        **** //  edge in OCW1x is detected
1441:main.c        **** //  So changing the value of DT1 affects the *next* corresponding edge 
1442:main.c        **** //   (NOT if the dead timer is already running)
1443:main.c        **** 
1444:main.c        **** //Page 96:
1445:main.c        **** // "The OCR1x Registers are double buffered when using any of the 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 48


1446:main.c        **** // Pulse Width Modulation (PWM) modes."
1447:main.c        **** // "The double buffering synchronizes the update of the OCR1x 
1448:main.c        **** // Compare Registers to either top or bottom of the counting sequence.
1449:main.c        **** // The synchronization prevents the occurrence of odd-length, non-sym- 
1450:main.c        **** // metrical PWM pulses, thereby making the output glitch-free."
1451:main.c        **** 
1452:main.c        **** //Page 100:
1453:main.c        **** //"A change of the COM1x1:0 bits state will have effect 
1454:main.c        **** // at the first Compare Match after the bits are written."
1455:main.c        **** //Page 97: HAH!
1456:main.c        **** //"Be aware that the COM1x1:0 bits are not double buffered 
1457:main.c        **** // together with the compare value. 
1458:main.c        **** // Changing the COM1x1:0 bits will take effect immediately."
1459:main.c        **** 
1460:main.c        **** 
1461:main.c        **** //#define lvds_setOnCompare()	
1462:main.c        **** //	TCCR1A = ( (1<<COM1A1) | (1<<COM1A0) 
1463:main.c        **** //			   | (0<<COM1B1) | (1<<COM1B0) 
1464:main.c        **** //			   | (1<<PWM1A) | (1<<PWM1B) )
1465:main.c        **** //#define lvds_ComplementaryClrOnCompare() \ //
1466:main.c        **** 	//Do TCCR1C first, because it contains shadow-bits of TCCR1A that I
1467:main.c        **** 	// don't want to have to rewrite...
1468:main.c        **** 	TCCR1C = ( (1<<COM1D1) | (0<<COM1D0)
1469:main.c        **** 				| (1<<PWM1D) );
1470:main.c        **** 
1471:main.c        **** 	TCCR1A = ( (0<<COM1A1) | (1<<COM1A0) 
1472:main.c        ****             | (1<<COM1B1) | (0<<COM1B0) //Don't use complementary for CLK
1473:main.c        ****             | (1<<PWM1A) | (1<<PWM1B) );
1474:main.c        **** 
1475:main.c        **** //#define lvds_clrOnCompare() lvds_ComplementaryClrOnCompare()
1476:main.c        **** 
1477:main.c        **** 	// Enable Complementary-Mode (and thus the dead-timer)
1478:main.c        **** 	// This'll be changed as needed, but we need COM1A0 set prior to that
1479:main.c        **** 
1480:main.c        **** 	//	lvds_clrOnCompare();
1481:main.c        **** //	writeMasked(((0<<COM1A1) | (1<<COM1A0)), 
1482:main.c        **** //					((1<<COM1A1) | (1<<COM1A0)), 
1483:main.c        **** //					TCCR1A);
1484:main.c        **** 
1485:main.c        **** 
1486:main.c        **** 
1487:main.c        **** 	//THIS IS NOT THOROUGHLY THOUGHT-OUT...
1488:main.c        **** 	// as I recall, we need to use /OC1B for the clock output
1489:main.c        **** 	//  because it won't be affected by the deadtime...
1490:main.c        **** //Now Handled in lvds_xxxOnCompare():
1491:main.c        **** //	writeMasked(((0<<COM1B1) | (1<<COM1B0)),
1492:main.c        **** //					((1<<COM1B1) | (1<<COM1B0)),
1493:main.c        **** //					TCCR1A);
1494:main.c        **** 
1495:main.c        ****    //Since PWM inversion affects all channels, great-pains were taken
1496:main.c        ****    // to assure that it needn't be changed in any lvds state...
1497:main.c        ****    // PWM inversion must be enabled:
1498:main.c        **** 
1499:main.c        **** 	//inverted with PWM1X
1500:main.c        **** //   setbit(PWM1X, TCCR1B);
1501:main.c        ****  
1502:main.c        ****  	Nada_init();
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 49


1503:main.c        **** }
1504:main.c        **** 
1505:main.c        **** 
1506:main.c        **** //PWM Timing:
1507:main.c        **** // (ATTiny861, Timer1, FastPWM, PWM1X;
1508:main.c        **** //  a/o LCDdirectLVDS1_5_PWMtimingTests):
1509:main.c        **** //
1510:main.c        **** //  PWM output on OC1A
1511:main.c        **** //    if OCR1A = 0, OC1A remains constant High
1512:main.c        **** //       OCR1A = 1, OC1A is low for 2 counts
1513:main.c        **** //       OCR1A = 2, OC1A is low for 3 counts
1514:main.c        **** //       OCR1A = 3, OC1A is low for 4 counts
1515:main.c        **** //       OCR1A = OCR1C, OC1A remains constant Low
1516:main.c        **** //
1517:main.c        **** //    THUS:
1518:main.c        **** //       compare-match occurs when TCNT changes AWAY from match
1519:main.c        **** //         (assuming TCNT starts at 0 for one pulse, 1 for one pulse...)
1520:main.c        **** //       TOP (OCR1C) is included in the count...
1521:main.c        **** //       There is no single-count pulse-width
1522:main.c        **** //         (Though, it seems dead-time could simulate it...)
1523:main.c        **** //         (set a deadtime of 1 on the BOTTOM edge and OCR1A)
1524:main.c        **** //         (but then there's no high for only one clock)
1525:main.c        **** 
1526:main.c        **** 
1527:main.c        **** 
1528:main.c        **** 
1529:main.c        **** //This isn't valid, who knows how many instructions the for loop takes
1530:main.c        **** static __inline__ \
1531:main.c        **** void delay_cyc(int32_t numCyc) \
1532:main.c        **** 	  __attribute__((__always_inline__));
1533:main.c        **** 
1534:main.c        **** //This'll optimze-out in some cases.
1535:main.c        **** // The timings and instructions used are probably specific to the
1536:main.c        **** // instruction-set in the MCU, the GCC version, optimization-level, etc.
1537:main.c        **** // a/o LCDdirectLVDS11 HLow_delay() this is how it's compiling...
1538:main.c        **** 
1539:main.c        **** // The actual number of cycs will probably be a few higher...
1540:main.c        **** // (or who knows, if things optimze-out, e.g. small ~0-8 numCycs)
1541:main.c        **** // Due to init, and division...
1542:main.c        **** // Using rounding-up as well...
1543:main.c        **** 
1544:main.c        **** // the argument is int32_t to allow for negative value testing
1545:main.c        **** // BUT: numCyc is only tested against a uint16_t...
1546:main.c        **** //  the greatest value (?) is (UINT16_MAX - 7)
1547:main.c        **** // (maybe it'd make more sense to do the math outside the delay_cyc call
1548:main.c        **** // and allow the preprocessor to change it to 0, instead of doing it here.
1549:main.c        **** 
1550:main.c        **** //This should probably be reimplemented using _delay_loop_1/2() from 
1551:main.c        **** // util/delay_basic.h
1552:main.c        **** //  1 uses three cycles per count, counts from 1-256, 
1553:main.c        **** //		256 counts: _delay_loop_1(0)
1554:main.c        **** //  2 uses four, counts from 1-65536, 65536 is passed as 0
1555:main.c        **** 
1556:main.c        **** #define DELAY_CYC_DELAY_LOOP TRUE//FALSE
1557:main.c        **** 
1558:main.c        **** #if(defined(DELAY_CYC_DELAY_LOOP) && DELAY_CYC_DELAY_LOOP)
1559:main.c        **** #warning "This has only been tested with v54+... rowSegBuffer, etc."
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 50


1560:main.c        **** void delay_cyc(int32_t numCyc)
1561:main.c        **** {
1562:main.c        **** 	if(numCyc <= 0)
1563:main.c        **** 		return;
1564:main.c        **** 
1565:main.c        **** 	uint16_t numLoops = (numCyc+3)/4;
1566:main.c        **** 
1567:main.c        **** 	_delay_loop_2(numLoops);
1568:main.c        **** 
1569:main.c        **** /*	uint32_t delayLoops = (numCyc+3)/4;
1570:main.c        **** 
1571:main.c        **** 	do
1572:main.c        **** 	{
1573:main.c        **** 		delayLoops--;
1574:main.c        **** //		_delay_loop_2(delayLoops&0xffff);
1575:main.c        **** 
1576:main.c        **** //		delayLoops -= (delayLoops&0xffff);
1577:main.c        **** 	} while(delayLoops);
1578:main.c        **** */
1579:main.c        **** /*
1580:main.c        **** 	//Since this is inline, AND it's only called with values computed
1581:main.c        **** 	// at compile time, only one of these should be compiled in...
1582:main.c        **** 	// as necessary...
1583:main.c        **** 	// If called without precomputed value (i.e. a variable)????
1584:main.c        **** 	// Maybe I should only use delay_loop_2...
1585:main.c        **** 	if(numCyc < 256*3)
1586:main.c        **** 		_delay_loop_1(numCyc/&0xff);
1587:main.c        **** 
1588:main.c        **** 	else
1589:main.c        **** */
1590:main.c        **** }
1591:main.c        **** 
1592:main.c        **** #else
1593:main.c        **** void delay_cyc(int32_t numCyc)
1594:main.c        **** {
1595:main.c        **** 
1596:main.c        **** 	//This shouldn't happen often, but some delay_cyc() calls use math
1597:main.c        **** 	// to calculate the number of cycles, and it could be negative
1598:main.c        **** 	if(numCyc < 0)
1599:main.c        **** 		return;
1600:main.c        **** 											//#Clocks
1601:main.c        **** 	//Two instructions:
1602:main.c        **** 	// ldi r24, 0						//1 			i=0
1603:main.c        **** 	// ldi r25, 0						//1
1604:main.c        **** 	uint16_t i;
1605:main.c        **** 
1606:main.c        **** 
1607:main.c        **** 	//Loop instructions:
1608:main.c        **** 	//nop									//1
1609:main.c        **** 	//adiw  r24, 0x01   ; 1			//2 			i++
1610:main.c        **** 	//cpi   r24, 0x77   ; 119		//1 			i<numCyc (119 in this case)
1611:main.c        **** 	//cpc   r25, r1					//1 			Apparently it's also testing
1612:main.c        **** 											//  			the high byte is 0
1613:main.c        **** 	//brne  .-10        ;			//"1/2"		return to nop
1614:main.c        **** 											//				if I understand, this is two
1615:main.c        **** 											//				cyc when branching
1616:main.c        **** 											//				or one if not (when complete)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 51


1617:main.c        **** 
1618:main.c        **** 	//READ THIS:
1619:main.c        **** 	// Current Compilation Settings: A/O v18:
1620:main.c        **** 	//    THIS LOOP WILL BE UNROLLED if numLoops <= 5!!!
1621:main.c        **** 	//    Which then turns into numLoops*2 cycles (instead of numLoops*8)
1622:main.c        **** 	// 
1623:main.c        **** 	// Here's an attempted hack...
1624:main.c        **** 	//  it *should* optimize the test out in either case, so it's like a 
1625:main.c        **** 	//  preprocessing directive...
1626:main.c        **** 	uint16_t numLoops = (((uint16_t)(numCyc)+7)>>3);
1627:main.c        **** 
1628:main.c        **** 
1629:main.c        **** 	// HACK ATTEMPT 2: THATS A LOT OF CODE.
1630:main.c        **** 		switch(numLoops)
1631:main.c        **** 		{
1632:main.c        **** 			case 5:
1633:main.c        **** 				asm("nop");
1634:main.c        **** 				asm("nop");
1635:main.c        **** 				asm("nop");
1636:main.c        **** 				asm("nop");
1637:main.c        **** 				asm("nop");
1638:main.c        **** 				asm("nop");
1639:main.c        **** 				asm("nop");
1640:main.c        **** 				asm("nop");
1641:main.c        **** 			case 4:
1642:main.c        **** 				asm("nop");
1643:main.c        **** 				asm("nop");
1644:main.c        **** 				asm("nop");
1645:main.c        **** 				asm("nop");
1646:main.c        **** 				asm("nop");
1647:main.c        **** 				asm("nop");
1648:main.c        **** 				asm("nop");
1649:main.c        **** 				asm("nop");
1650:main.c        **** 			case 3:
1651:main.c        **** 				asm("nop");
1652:main.c        **** 				asm("nop");
1653:main.c        **** 				asm("nop");
1654:main.c        **** 				asm("nop");
1655:main.c        **** 				asm("nop");
1656:main.c        **** 				asm("nop");
1657:main.c        **** 				asm("nop");
1658:main.c        **** 				asm("nop");
1659:main.c        **** 			case 2:
1660:main.c        **** 				asm("nop");
1661:main.c        **** 				asm("nop");
1662:main.c        **** 				asm("nop");
1663:main.c        **** 				asm("nop");
1664:main.c        **** 				asm("nop");
1665:main.c        **** 				asm("nop");
1666:main.c        **** 				asm("nop");
1667:main.c        **** 				asm("nop");
1668:main.c        **** 			case 1:
1669:main.c        **** 				asm("nop");
1670:main.c        **** 				asm("nop");
1671:main.c        **** 				asm("nop");
1672:main.c        **** 				asm("nop");
1673:main.c        **** 				asm("nop");
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 52


1674:main.c        **** 				asm("nop");
1675:main.c        **** 				asm("nop");
1676:main.c        **** 				asm("nop");
1677:main.c        **** 				return;
1678:main.c        **** 				break;
1679:main.c        **** 			default:
1680:main.c        **** 				break;
1681:main.c        **** 		}
1682:main.c        **** 	// THUS:
1683:main.c        **** 	// Each loop is 7 cycles, make it 8 by adding an extra nop and we can
1684:main.c        **** 	// use >> instead of / for calculations...
1685:main.c        **** 	// +7 assures rounding-up...
1686:main.c        **** #warning "This loop seems to be optimizing out!"
1687:main.c        **** 	//for(i=0; i<((numCyc+7)>>3); i++)
1688:main.c        **** 	for(i=0; i<numLoops; i++)
1689:main.c        **** 	{
1690:main.c        **** 		//THIS IS A HACK DUE TO OPTIMIZATION, see above
1691:main.c        **** 		// It will NOT likely be happy with different versions of gcc...
1692:main.c        **** 	/*	// NOGO: Apparently it won't expand the loop if this is part of it
1693:main.c        **** 		// so then we have 5 loops AND 8 instructions /within/ the loop
1694:main.c        **** 		// AND the comparison overhead!`
1695:main.c        **** 		if(numLoops <= 5)
1696:main.c        **** 		{
1697:main.c        **** 		   asm("nop");
1698:main.c        **** 			asm("nop");
1699:main.c        **** 		//	asm("nop");
1700:main.c        **** 		//	asm("nop");
1701:main.c        **** 		//	asm("nop");
1702:main.c        **** 		//	asm("nop");
1703:main.c        **** 		}
1704:main.c        **** 		else
1705:main.c        **** 		{
1706:main.c        **** 			asm("nop");
1707:main.c        **** 			asm("nop");
1708:main.c        **** 		}
1709:main.c        **** 	*/
1710:main.c        **** 		//Apparently this loop will optimize-out without this:
1711:main.c        **** 		// Obviously, one instruction each...
1712:main.c        **** 		asm("nop");
1713:main.c        **** 		asm("nop");
1714:main.c        **** 	}
1715:main.c        **** }
1716:main.c        **** #endif
1717:main.c        **** 
1718:main.c        **** //One dot-clock is 7/8ths of a CPU cycle... (prescaler = 1)
1719:main.c        **** //                 14/8ths with prescaler = 2 ...
1720:main.c        **** //
1721:main.c        **** //    1 dot = 7/8 cyc
1722:main.c        **** //    n dots = n * 7/8 cyc
1723:main.c        **** //
1724:main.c        **** //    1 = 1 dot / (7/8) cyc
1725:main.c        **** //    1 = 8 dots / 7 cyc
1726:main.c        **** //
1727:main.c        **** //  With prescaling = 2:
1728:main.c        **** //
1729:main.c        **** //    1 dot = 7/8 * 2 cyc = 14/8 cyc
1730:main.c        **** //   
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 53


1731:main.c        **** //    8/14 dots = 1 cyc
1732:main.c        **** //    n dots = n*14/8 cyc
1733:main.c        **** //   
1734:main.c        **** //    I coulda sworn the prescaler was on the divide-side...
1735:main.c        **** //   Also, is there any benefit to adding +7*LVDS_PRESCALER-1 for rounding?
1736:main.c        **** #define DOTS_TO_CYC(dots) ((((dots)*(7l)*(LVDS_PRESCALER))/8))
1737:main.c        **** 
1738:main.c        **** #define delay_Dots(numDots) delay_cyc(DOTS_TO_CYC(numDots))
1739:main.c        **** 
1740:main.c        **** 
1741:main.c        **** //THESE NOTES ARE OLD:
1742:main.c        **** //This has to be changed every time the DE code is changed...
1743:main.c        **** // Actually, I think it should just match IMAGE_WIDTH
1744:main.c        **** //#define FB_WIDTH 28 //21//19
1745:main.c        **** //#define IMAGE_WIDTH 21
1746:main.c        **** 
1747:main.c        **** 
1748:main.c        **** #define TESTVALS	0
1749:main.c        **** #define LTN 1
1750:main.c        **** #define IDT 2
1751:main.c        **** 
1752:main.c        **** 
1753:main.c        **** //TIMING:
1754:main.c        **** //  Measurements below (in microseconds) are referring to preLVDS
1755:main.c        **** //  There may be other such old-notes...
1756:main.c        **** 
1757:main.c        **** 
1758:main.c        **** //        |<--T_Hhigh-->| |<-T_Hlow
1759:main.c        **** //    __   _____________   ____________  3.6V
1760:main.c        **** // H    |_|             |_|           _  0V
1761:main.c        **** //
1762:main.c        **** //    Data Enable
1763:main.c        **** //       Only active when there's valid pixel data
1764:main.c        **** //       (for 512 of the 717 clocks in HSYNC-active)
1765:main.c        **** //       Low during Vsync... (~720us)
1766:main.c        **** //
1767:main.c        **** 
1768:main.c        **** //IDTech display: 136 dots
1769:main.c        **** //2-136+
1770:main.c        **** //IDTech, last used: 40
1771:main.c        **** //LTN Last used 8
1772:main.c        **** // LTN: 1072-1344-1500 clocks per line, 1024DE... Hsync unused
1773:main.c        **** // SEE Hlow_Delay() notes if this value is large!
1774:main.c        **** 
1775:main.c        **** #if (DISPLAY == LTN)
1776:main.c        **** #define H_LOW_DOTS	8
1777:main.c        **** #elif (DISPLAY == IDT)
1778:main.c        **** #define H_LOW_DOTS   40//8//1//40 //30 //2//136
1779:main.c        **** #elif (DISPLAY == TESTVALS)
1780:main.c        **** #define H_LOW_DOTS	100//0 //LTN doesn't use H_LOW (DE-only)
1781:main.c        **** 							  // And having a value here increases codesize
1782:main.c        **** #endif
1783:main.c        **** 
1784:main.c        **** 
1785:main.c        **** //H is set low immediately upon entry of the timer interrupt
1786:main.c        **** // its low-time is controlled via nops
1787:main.c        **** // (so if HLow is long for a particular display, this might need revising)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 54


1788:main.c        **** #define Hlow_Delay() \
1789:main.c        **** 	delay_Dots(H_LOW_DOTS)
1790:main.c        **** 
1791:main.c        **** 
1792:main.c        **** //#define T_Hlow_CYC 1//8 //(T_Halow_REAL*3)
1793:main.c        **** #define T_Hlow_CYC DOTS_TO_CYC(H_LOW_DOTS)
1794:main.c        **** 
1795:main.c        **** 
1796:main.c        **** 
1797:main.c        **** //This was found expermentally with SwitchResX
1798:main.c        **** //IDTech Last Used: 680
1799:main.c        **** //LTN last used 1024
1800:main.c        **** // Oddly: For the LTN, this doesn't seem to affect the horizontal
1801:main.c        **** //        it does, however, affect the vertical(!)
1802:main.c        **** // If I recall Correctly, this is used only for setting the timer interrupt
1803:main.c        **** //  rate...
1804:main.c        **** #if (DISPLAY == LTN)
1805:main.c        **** #define DE_ACTIVE_DOTS	1024
1806:main.c        **** #elif (DISPLAY == IDT)
1807:main.c        **** #define DE_ACTIVE_DOTS	680 //1024 //800 //920 //943 //812 //472 //1024
1808:main.c        **** #elif (DISPLAY == TESTVALS)
1809:main.c        **** #define DE_ACTIVE_DOTS	1024
1810:main.c        **** #endif
1811:main.c        **** 
1812:main.c        **** #define T_DE_CYC	DOTS_TO_CYC(DE_ACTIVE_DOTS)
1813:main.c        **** 
1814:main.c        **** //Horizontal Blank Time: HD_DOTS + H_LOW + DH_DOTS
1815:main.c        **** //  90-320+
1816:main.c        **** //Horizontal Total Time: 1206-1344-2047
1817:main.c        **** // ... but Total = Blank + Pixels, so 90+1024 != 1206
1818:main.c        **** // Excess waits should be thrown in DH (since that's between interrupts)
1819:main.c        **** //T_HD is the time from H inactivated to DE activated
1820:main.c        **** //aka H back-porch: 1-160+
1821:main.c        **** //IDTech Last Used: 50
1822:main.c        **** //LTN last used 5
1823:main.c        **** 
1824:main.c        **** #if (DISPLAY == LTN)
1825:main.c        **** #define HD_DOTS 5
1826:main.c        **** #elif (DISPLAY == IDT)
1827:main.c        **** #define HD_DOTS	50 //5 //0//20//5 //50 //30 //1 //160
1828:main.c        **** #elif (DISPLAY == TESTVALS)
1829:main.c        **** #define HD_DOTS 50//5
1830:main.c        **** #endif
1831:main.c        **** 
1832:main.c        **** #define HD_Delay()	delay_Dots(HD_DOTS)
1833:main.c        **** 
1834:main.c        **** //#define T_HD_CYC 1//3//(T_HD_REAL*3)
1835:main.c        **** #define T_HD_CYC	DOTS_TO_CYC(HD_DOTS)
1836:main.c        **** 
1837:main.c        **** // This is the number of CPU cycles between DE->L and Horiz->L
1838:main.c        **** // This is just used in calculating the OCR value...
1839:main.c        **** // aka H Front Porch: 0-24+
1840:main.c        **** // IDTech Last Used: 24
1841:main.c        **** // LTN last used 46
1842:main.c        **** // 1072-1024-1-1 = 46
1843:main.c        **** #if (DISPLAY == LTN)
1844:main.c        **** #define DH_DOTS	46
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 55


1845:main.c        **** #elif (DISPLAY == IDT)
1846:main.c        **** #define DH_DOTS	24 //46 //480//6//12//24 //46 //24 //122//30 //0 //24
1847:main.c        **** #elif (DISPLAY == TESTVALS)
1848:main.c        **** #define DH_DOTS	0//1000//100//46
1849:main.c        **** #endif
1850:main.c        **** 
1851:main.c        **** #define T_DH_CYC	DOTS_TO_CYC(DH_DOTS)
1852:main.c        **** 
1853:main.c        **** //       |
1854:main.c        **** //       v
1855:main.c        **** //      T_DH
1856:main.c        **** //      ||    |<-T_DE->|  |  |<--T_HD (Hsync->DE)
1857:main.c        **** // H   __.  ____________  .___________
1858:main.c        **** //      .|_|  .        .|_|  .
1859:main.c        **** //     _.     .________.     .___________
1860:main.c        **** // DE   |_____| 512clk |_____|
1861:main.c        **** //      ^              ^
1862:main.c        **** //       \___________   \                        (just avoiding \ warning)
1863:main.c        **** //                   \  |     768 Hsyncs
1864:main.c        **** //                    v v
1865:main.c        **** //     _             _ _ _ _ _ _ _ _ _ _ 
1866:main.c        **** // DE   |___________| | | | | | | | | | |______
1867:main.c        **** //
1868:main.c        **** // one Hsync = T_HD+T_DH+T_Hlow+T_DE = 19.865us
1869:main.c        **** 
1870:main.c        **** //aka V-sync back porch: 7-29-63 "Vbp should be static"
1871:main.c        **** // IDTech Last Used: 29
1872:main.c        **** // LTN last used 3
1873:main.c        **** //LTN Frame: 772-806-1000 lines...
1874:main.c        **** #if (DISPLAY == LTN)
1875:main.c        **** #define T_VD 3
1876:main.c        **** #elif (DISPLAY == IDT)
1877:main.c        **** #define  T_VD 29 //3//29 //7 //29
1878:main.c        **** #elif (DISPLAY == TESTVALS)
1879:main.c        **** #define T_VD 3
1880:main.c        **** #endif
1881:main.c        **** 
1882:main.c        **** //aka V-sync front porch: 1-3+
1883:main.c        **** // IDTech Last Used: 3
1884:main.c        **** // LTN last used 3
1885:main.c        **** #if (DISPLAY == LTN)
1886:main.c        **** #define T_DV 3
1887:main.c        **** #elif (DISPLAY == IDT)
1888:main.c        **** #define T_DV 3//3 //1 //3
1889:main.c        **** #elif (DISPLAY == TESTVALS)
1890:main.c        **** #define T_DV 3
1891:main.c        **** #endif
1892:main.c        **** 
1893:main.c        **** //1-6+ (1 is used by the first switch-case...)
1894:main.c        **** // IDTech Last Used: 6
1895:main.c        **** // LTN Last used 16
1896:main.c        **** // 772 - 768 - 1 - 1 = 2
1897:main.c        **** #if (DISPLAY == LTN)
1898:main.c        **** #define T_Vlow 16
1899:main.c        **** #elif (DISPLAY == IDT)
1900:main.c        **** #define T_Vlow	6 //16//6 //2 //6
1901:main.c        **** #elif (DISPLAY == TESTVALS)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 56


1902:main.c        **** #define T_Vlow 32
1903:main.c        **** #endif
1904:main.c        **** 
1905:main.c        **** // IDTech Last Used: 768
1906:main.c        **** #if (DISPLAY == LTN)
1907:main.c        **** #define V_COUNT	768
1908:main.c        **** #elif (DISPLAY == IDT)
1909:main.c        **** #define V_COUNT	768
1910:main.c        **** #elif (DISPLAY == TESTVALS)
1911:main.c        ****  #if (LVDS_PRESCALER == 8)
1912:main.c        ****   #define V_COUNT 768
1913:main.c        ****  #else
1914:main.c        ****   #define V_COUNT	(768*2/3)
1915:main.c        ****  #endif
1916:main.c        **** #endif
1917:main.c        **** 
1918:main.c        **** //                       
1919:main.c        **** //                      |           
1920:main.c        **** //                      V           
1921:main.c        **** //              |<-T_DV>|           |<-T_VD-->|
1922:main.c        **** //              .       .           .         .
1923:main.c        **** //     _____________||__.   124us   .____||___________________
1924:main.c        **** //  V           .   ||  |___________|    ||   .
1925:main.c        **** //     _ _ _ _ _ _ _|| _ _ _ _ _ _ _ _ _ ||_ _ _ _ _ _ _ _ _ _ _
1926:main.c        **** //  H   | | | | | | ||| | | | | | | | | ||| | | | | | | | | | |
1927:main.c        **** //              .   ||                   ||   .
1928:main.c        **** //     _ _ _ _ _.   ||       720us       ||   ._ _ _ _ _ _ _ _ _
1929:main.c        **** // DE   | | | | |___||___________________||___| | | | | | | | |
1930:main.c        **** //                  ||                   ||
1931:main.c        **** //
1932:main.c        **** //                        1
1933:main.c        **** //                        |
1934:main.c        **** //                        v               
1935:main.c        **** //     _________________   ___________________   _____________
1936:main.c        **** //  V                   |_|                   |_|
1937:main.c        **** //  H  |||||||||||||||||||||||||||||||||||||||||||||||||||||||
1938:main.c        **** // DE  ||||||||||||||||_____|||||||||||||||||_____||||||||||||
1939:main.c        **** //                          ^
1940:main.c        **** //                          |
1941:main.c        **** //                          2
1942:main.c        **** 
1943:main.c        **** 
1944:main.c        **** 
1945:main.c        **** 
1946:main.c        **** static __inline__ \
1947:main.c        **** void loadData(uint16_t rowNum, uint8_t dataEnable) \
1948:main.c        **** 	  __attribute__((__always_inline__));
1949:main.c        **** 
1950:main.c        **** //volatile uint8_t rowBuffer[FB_WIDTH] =
1951:main.c        **** //There's not enough memory for a full frame-buffer...
1952:main.c        **** // but this is how LCDdirect worked, and changing it would be a pain.
1953:main.c        **** //uint8_t settingBuffer[FB_HEIGHT][FB_WIDTH]; 
1954:main.c        **** #if(defined(IMAGE_BUFFER) && IMAGE_BUFFER)
1955:main.c        **** uint8_t frameBuffer[FB_HEIGHT][FB_WIDTH];
1956:main.c        **** #else
1957:main.c        **** uint8_t *pimage;
1958:main.c        **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 57


1959:main.c        **** 
1960:main.c        **** /* in LCDStuff
1961:main.c        **** uint8_t dataEnable = 0;
1962:main.c        **** uint8_t vSync = 0;
1963:main.c        **** uint16_t hsyncCount = 0;
1964:main.c        **** */
1965:main.c        **** 
1966:main.c        **** /* in LCDStuff, along with the if, woot
1967:main.c        **** //frameCount=0 can be used in main to detect whether we've completed a 
1968:main.c        **** //  a frame AND its FRAME_UPDATE_DELAY
1969:main.c        **** #if (FRAME_COUNT_TO_DELAY != 0)
1970:main.c        **** uint8_t frameCount = 0;
1971:main.c        **** #endif
1972:main.c        **** */
1973:main.c        **** 
1974:main.c        **** static __inline__ \
1975:main.c        **** void loadRow(uint16_t rowNum) \
1976:main.c        **** 	__attribute__((__always_inline__));
1977:main.c        **** 
1978:main.c        **** 
1979:main.c        **** #include _LCDSTUFF_CFILE_
1980:main.c        **** //#include "../../../_commonCode/lcdStuff/0.50ncf/lcdStuff.c"
1981:main.c        **** //#include "lcdUpdate.c"
1982:main.c        **** 
1983:main.c        **** //SIGNAL(TIMER1_COMPA_vect)
1984:main.c        **** SIGNAL(TIMER0_COMPA_vect)
1985:main.c        **** {
1986:main.c        **** 	static uint8_t frameCount = 0;
1987:main.c        **** 
1988:main.c        **** #if (defined(SLOW_EVERYTHING_TEST) && SLOW_EVERYTHING_TEST)
1989:main.c        **** 	while(TCNT0L != 7){};
1990:main.c        **** 	//This won't work... who knows how many cycles interrupt-entry will be
1991:main.c        **** 	//Above should fix that...
1992:main.c        **** 	//I believe this was only so I'd have something for the 'scope to
1993:main.c        **** 	// trigger on... 
1994:main.c        **** #error "These shouldn't be used anymore, since PB2 is GREEN"
1995:main.c        **** 	setpinPORT(PB2, PORTB);
1996:main.c        **** 	clrpinPORT(PB2, PORTB);
1997:main.c        **** #endif
1998:main.c        **** 
1999:main.c        **** 
2000:main.c        **** 	if(updateLCD())
2001:main.c        **** 	{
2002:main.c        **** #if (FRAME_COUNT_TO_DELAY != 0)
2003:main.c        **** 			//static uint8_t frameCount = 0;
2004:main.c        **** 			frameCount++;
2005:main.c        **** 			if(frameCount == FRAME_COUNT_TO_DELAY)
2006:main.c        **** 			{
2007:main.c        **** 				frameCount = 0;
2008:main.c        **** 				timer_compareMatchIntSetup(0, OUT_CHANNELA, FALSE);
2009:main.c        **** 				//timer_compareMatchIntDisable(0, OUT_CHANNELA);
2010:main.c        **** 			}
2011:main.c        **** #endif
2012:main.c        **** 	}
2013:main.c        **** 
2014:main.c        **** #if(defined(LOADROW) && LOADROW)
2015:main.c        **** 	//Load the next row into the row(seg)buffer
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 58


2016:main.c        **** 	//data is enabled after T_VD+T_Vlow...
2017:main.c        **** 	if((hsyncCount >= T_VD+T_Vlow) && (hsyncCount < T_VD+T_Vlow+V_COUNT))
2018:main.c        **** 		loadRow(hsyncCount - (T_VD+T_Vlow));
2019:main.c        **** #endif
2020:main.c        **** 	// Here is where loadRow used to be called
2021:main.c        **** 	// it has been moved to oldNotes.txt, but it would make more sense
2022:main.c        **** 	// to look at LCDdirectLVDS <25 or LCDdirect
2023:main.c        **** 	// loadRow used the time between DE inactive and the next Hsync
2024:main.c        **** 	// to load a row to a row-buffer (as opposed to a frame-buffer)
2025:main.c        **** 	// thus, DE could gain more pixels because there would be fewer
2026:main.c        **** 	// calculations to determine the memory location to write from
2027:main.c        **** 	// This effect has since been minimized
2028:main.c        **** 	// BUT loadRow might be necessary for program-memory-based images...
2029:main.c        **** }
2030:main.c        **** 
2031:main.c        **** 
2032:main.c        **** #define nibbletochar(val)	\
2033:main.c        **** 	(((val)<=9) ? ((val) + '0') : ((val) + ('A' - 10)))
2034:main.c        **** 
2035:main.c        **** 
2036:main.c        **** #if 0
2037:main.c        **** uint8_t hexColor = 0;
2038:main.c        **** 
2039:main.c        **** static __inline__ \
2040:main.c        **** void hexColor_drawRow(uint8_t rbRowNum, uint8_t rowBuffer[]) \
2041:main.c        **** 	  __attribute__((__always_inline__));
2042:main.c        **** 
2043:main.c        **** //Takes a nibble and makes it a hex character...
2044:main.c        **** 
2045:main.c        **** #define HEXCOLOR_TOPROW 32
2046:main.c        **** void hexColor_drawRow(uint8_t rbRowNum, uint8_t rowBuffer[])
2047:main.c        **** {
2048:main.c        **** //	static uint8_t color = 0;
2049:main.c        **** 
2050:main.c        **** 	if( (rbRowNum >= HEXCOLOR_TOPROW) &&
2051:main.c        **** 		 (rbRowNum < HEXCOLOR_TOPROW+8) )
2052:main.c        **** 	{
2053:main.c        **** 		uint8_t charRow1, charRow2;
2054:main.c        **** 		//uint8_t color;
2055:main.c        **** 
2056:main.c        **** 		charRow1 = 
2057:main.c        **** 			getCharRow(nibbletochar((hexColor)>>4), rbRowNum-HEXCOLOR_TOPROW);
2058:main.c        **** 		charRow2 = 
2059:main.c        **** 			getCharRow(nibbletochar(hexColor&0x0f), rbRowNum-HEXCOLOR_TOPROW);
2060:main.c        **** 
2061:main.c        **** 		uint8_t col;
2062:main.c        **** 		for(col=0; col<8; col++)
2063:main.c        **** 		{
2064:main.c        **** 			if(getbit(col, charRow1))
2065:main.c        **** 				rowBuffer[col+1] = fb_to_rb(hexColor);
2066:main.c        **** 			//else
2067:main.c        **** 			//	rowBuffer[col] = fb_to_rb(0x00);
2068:main.c        **** 
2069:main.c        **** 			if(getbit(col, charRow2))
2070:main.c        **** 				rowBuffer[col+8+1] = fb_to_rb(hexColor);
2071:main.c        **** 		}
2072:main.c        **** 	}
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 59


2073:main.c        **** }
2074:main.c        **** #endif //0
2075:main.c        **** 
2076:main.c        **** 
2077:main.c        **** #if(defined(LOADROW) && LOADROW)
2078:main.c        **** #warning "loadRow is currently in an intermediate phase..."
2079:main.c        **** void loadRow(uint16_t rowNum)
2080:main.c        **** {
2081:main.c        **** 
2082:main.c        **** #if 0
2083:main.c        **** 	uint8_t i=0;
2084:main.c        **** 
2085:main.c        **** //	if((rowNum < 0) || (rowNum >= V_COUNT))
2086:main.c        **** //		return;
2087:main.c        **** 
2088:main.c        **** 	//THIS DOES NOT MAKE AN OUNCE OF SENSE TO ME:
2089:main.c        **** 	// why do I need *2 here?! Without it, the image is stretched and cut
2090:main.c        **** 	// in half vertically!
2091:main.c        **** 	// Apparently has to do with delayed Hsyncs due to calculations...?
2092:main.c        **** 	// LIFE with delay = 10 causes 2/3 frame at *2
2093:main.c        **** 	// The screen itself appears to be repeating rows...
2094:main.c        **** #if(!defined(HORIZONTAL_COLOR_BARS) || !HORIZONTAL_COLOR_BARS)
2095:main.c        ****  #if(LVDS_PRESCALER == 8)
2096:main.c        ****   #define ROW_SCALE 1
2097:main.c        ****  #else
2098:main.c        ****   #define ROW_SCALE 2
2099:main.c        ****  #endif
2100:main.c        **** 	uint8_t rbRowNum = ((uint32_t)rowNum)*RB_HEIGHT*ROW_SCALE/V_COUNT;
2101:main.c        **** 
2102:main.c        **** 	//Old note pre tet_drawRow... (code deleted a/o v45)	
2103:main.c        **** 	//WITHOUT THIS: syncing seems OK
2104:main.c        **** 	// But this is necessary for the right-border...
2105:main.c        **** 	// Adding it causes syncing problems at _b and _c -> _W
2106:main.c        **** 	// TODO: Look into sync-problems above!!!
2107:main.c        **** 	//  (revisit 41-1)
2108:main.c        **** 	//i++;
2109:main.c        **** 
2110:main.c        **** 	//Clear the rowBuffer, it will be reloaded, where appropriate, after
2111:main.c        **** 	// This isn't particularly speed-efficient, since most pixels will 
2112:main.c        **** 	// be written twice... but it should make things more plug-n-play...
2113:main.c        **** 	for(i=0; i<RB_WIDTH; i++)
2114:main.c        **** 		rowBuffer[i]=fb_to_rb(0);
2115:main.c        **** 
2116:main.c        **** 
2117:main.c        **** 	tet_drawRow(rbRowNum, rowBuffer);
2118:main.c        **** 
2119:main.c        **** 
2120:main.c        **** 	hexColor_drawRow(rbRowNum, rowBuffer);
2121:main.c        **** 
2122:main.c        **** 	
2123:main.c        **** 	i=63-40;
2124:main.c        **** 
2125:main.c        **** 	static uint16_t colorShift = 0;
2126:main.c        **** 
2127:main.c        **** 	//!!! This *should* only increment once per frame (RIGHT?)
2128:main.c        **** 	// BUT, set colorShift>>5 to colorShift>>3 or even >>0
2129:main.c        **** 	// and it seems this is not true... WTF, again?
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 60


2130:main.c        **** 	if(rbRowNum == 0)
2131:main.c        **** 		colorShift++;
2132:main.c        **** 
2133:main.c        **** 	//Just fill up the remaining pixels with color...
2134:main.c        **** 	// i-- to overwrite the blank column in the characters
2135:main.c        **** 	// Leaving one column of black to check into syncing problems
2136:main.c        **** 	// with LVDS_PRESCALER=8...
2137:main.c        **** 	// apparently, the garbage-lines are related to the last color drawn(?!)
2138:main.c        **** 	for( ;i<RB_WIDTH;i++)
2139:main.c        **** 	{
2140:main.c        **** 			uint8_t colorVal = (i + rbRowNum + (colorShift>>5)) & 0x3f;
2141:main.c        **** 
2142:main.c        **** 			//We don't want Black, since it's used for LIFE...
2143:main.c        **** 			if(colorVal==0)
2144:main.c        **** 				colorVal = 0x15;
2145:main.c        **** 
2146:main.c        **** 			//Only draw colors where there isn't already data
2147:main.c        **** 			// (e.g. LIFE or the SMILEY)
2148:main.c        **** 			// Actually, this can't work, since Black is a possibility...
2149:main.c        **** 			//if(!rowBuffer[i])
2150:main.c        **** 				rowBuffer[i] = fb_to_rb(colorVal);
2151:main.c        **** 	}
2152:main.c        **** 
2153:main.c        **** /* This is now handled in the rowSegBuffer loading...
2154:main.c        **** 	I guess that doesn't fix it for the old non-row-seg case...
2155:main.c        **** 
2156:main.c        **** 	//Apparently *black* causes issues... as well as some dark colors
2157:main.c        **** 	// (certain shades of blue?)
2158:main.c        **** 	// White, as the last pixel, causes syncing to work fine, ish
2159:main.c        **** 	//And adding a black column doesn't do anything?!
2160:main.c        **** 	// either way, thsi should be redundant due to rowBuffer clearing
2161:main.c        **** 	// and RB_WIDTH-2 in the color-filling
2162:main.c        **** 	// WTF?
2163:main.c        **** 	//rowBuffer[RB_WIDTH-2] = fb_to_rb(_K);
2164:main.c        **** 	rowBuffer[RB_WIDTH-1] = fb_to_rb(_W);
2165:main.c        **** */
2166:main.c        **** 
2167:main.c        **** 	//Draw the smiley on top of the color pixels
2168:main.c        **** #define SMILE_TOP_ROW (20)
2169:main.c        **** #define SMILE_HEIGHT FB_HEIGHT
2170:main.c        **** #define SMILE_SHIFT	(24+(40-FB_WIDTH)/2)
2171:main.c        **** 	if((rbRowNum >= SMILE_TOP_ROW) &&
2172:main.c        **** 			(rbRowNum < (SMILE_HEIGHT+SMILE_TOP_ROW)))
2173:main.c        **** 	{
2174:main.c        **** 			for(i=0; i<FB_WIDTH; i++)
2175:main.c        **** 			{
2176:main.c        **** 				uint8_t temp;
2177:main.c        **** 			#if(defined(IMAGE_BUFFER) && IMAGE_BUFFER)
2178:main.c        ****          	temp=frameBuffer[rbRowNum-SMILE_TOP_ROW][i];
2179:main.c        **** 			#else
2180:main.c        ****          	temp=pgm_readImageByte(pimage, rbRowNum-SMILE_TOP_ROW, i);
2181:main.c        **** 			#endif
2182:main.c        **** 
2183:main.c        **** 				if(!(temp & 0xC0))
2184:main.c        **** 					rowBuffer[i+SMILE_SHIFT] = fb_to_rb(temp);
2185:main.c        **** 			}
2186:main.c        **** 	}
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 61


2187:main.c        **** 
2188:main.c        **** 
2189:main.c        **** 	#if(defined(LIFE) && LIFE)
2190:main.c        **** 	//This has to be called *after* the colored background is drawn...
2191:main.c        **** 	// (that could be changed... with _Tr?)
2192:main.c        **** 	life_drawRow(rbRowNum, &(rowBuffer[RB_WIDTH-LIFE_WIDTH]));
2193:main.c        **** 	#endif //LIFE
2194:main.c        **** 
2195:main.c        **** 
2196:main.c        **** #else //HORIZONTAL_COLOR_BARS
2197:main.c        **** 	for(i=0; i<RB_WIDTH; i++)
2198:main.c        **** 		rowBuffer[i] = fb_to_rb(rowNum);
2199:main.c        **** #endif
2200:main.c        **** 
2201:main.c        **** 
2202:main.c        **** #endif //0
2203:main.c        **** 
2204:main.c        **** 	
2205:main.c        **** //#define SEG_LINE TRUE
2206:main.c        **** //#define SEG_SINE TRUE
2207:main.c        **** 
2208:main.c        **** //#define SEG_QUESTION TRUE
2209:main.c        **** 	//Isn't BLAH = 1 necessary so we don't get a row with no data?
2210:main.c        **** 	// *looks* like it's working, but I dunno...
2211:main.c        **** #define BLAH 0
2212:main.c        **** 
2213:main.c        **** 
2214:main.c        **** #if(defined(ROW_SEG_BUFFER) && ROW_SEG_BUFFER)
2215:main.c        **** // Wasn't sure where 357 came from... and now I'm wondering where the
2216:main.c        **** // notes I wrote regarding it disappeared to...
2217:main.c        **** // Anyhow, from line 72, if ROW_SEG_BUFFER && !LVDS_PRESCALER
2218:main.c        **** // "ROW_SEG_BUFFER uses 20cyc/pixel" (doesn't match the math I've 
2219:main.c        **** // elsewhere) 1024/20*7 = 358.4... so maybe that's something to do with it
2220:main.c        **** // TODO: If it was 21cyc/pixel, wouldn't we have perfect alignment with
2221:main.c        **** //       color-transitions and segment widths?
2222:main.c        **** //#define NUM_PSEGS	(1024/3+16) //357
2223:main.c        ****  #if (defined(SEG_RACER) && SEG_RACER)
2224:main.c        ****   #include <stdlib.h>	//rand()
2225:main.c        ****   #define NEXT_COLOR	_R
2226:main.c        ****   #define THIS_COLOR	_G
2227:main.c        ****   #define OVERLAP_COLOR	_Y
2228:main.c        ****   #define BG_COLOR	_C
2229:main.c        ****   #define BG_BAD_COLOR	_M
2230:main.c        **** 
2231:main.c        **** 
2232:main.c        **** 
2233:main.c        **** 	int16_t racerPseg = NUM_PSEGS/2 - 2;
2234:main.c        **** 
2235:main.c        **** 	adc_startConversion();
2236:main.c        **** 	while(adc_isBusy())
2237:main.c        **** 		asm("nop;");
2238:main.c        **** 	racerPseg = (adc_getValue()>>2)+5;
2239:main.c        **** 	if(racerPseg > NUM_PSEGS-2)
2240:main.c        **** 		racerPseg = NUM_PSEGS-2;
2241:main.c        **** 
2242:main.c        **** 	segClear();
2243:main.c        **** 	addSegfb(1, _W);
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 62


2244:main.c        **** 	static uint16_t raceWidth = 16;
2245:main.c        **** 	static uint8_t trackPosition = 0;
2246:main.c        ****   #define TRACK_LENGTH	24	//24*32 = 768
2247:main.c        ****   #define TRACK_ROWS	(V_COUNT/TRACK_LENGTH)
2248:main.c        **** 	static uint16_t raceTrack[TRACK_LENGTH*2];
2249:main.c        **** 
2250:main.c        **** 	uint8_t bgColor = BG_COLOR;
2251:main.c        **** 
2252:main.c        **** 	//racePseg += ((rand()&0xff0)>>4)*2/0xff - 1;
2253:main.c        **** 
2254:main.c        **** 	uint8_t thisTrackRow = rowNum/TRACK_ROWS; //(V_COUNT/TRACK_LENGTH);
2255:main.c        **** 	uint8_t thisPosition = thisTrackRow + (trackPosition? TRACK_LENGTH : 0);
2256:main.c        **** 	uint8_t nextPosition = thisTrackRow + (trackPosition? 0 : TRACK_LENGTH);
2257:main.c        **** 
2258:main.c        **** 	static hfm_t thisSmoothingHFM, nextSmoothingHFM;
2259:main.c        **** 	static uint8_t thisTrackGrowing, nextTrackGrowing;
2260:main.c        **** 
2261:main.c        **** /*
2262:main.c        **** 	static theta_t racerTheta = 0;
2263:main.c        **** 	if(racerTheta >= SINE_2PI)
2264:main.c        **** 		racerTheta -= SINE_2PI;
2265:main.c        **** 
2266:main.c        **** 	racerPseg = sineRaw8(racerTheta) + -(INT8_MIN);
2267:main.c        **** 	racerTheta++;
2268:main.c        **** */
2269:main.c        **** 
2270:main.c        **** 	uint8_t outOfTrack = FALSE;
2271:main.c        **** 	typedef struct _IST_BLAH_
2272:main.c        **** 	{
2273:main.c        **** 		uint16_t length;
2274:main.c        **** 		uint8_t color;
2275:main.c        **** 	}	intermediateSeg_t;
2276:main.c        **** 
2277:main.c        **** #define ISEGS_PER_WHATEVER	3
2278:main.c        **** #define IS_SEGS (5*ISEGS_PER_WHATEVER)
2279:main.c        **** 	intermediateSeg_t is[IS_SEGS] = 
2280:main.c        **** 	{ {0,_W}, {0,_W}, {0,_W}, {0,_W}, {0,_W},
2281:main.c        **** 	  {0,_W}, {0,_W}, {0,_W}, {0,_W}, {0,_W},
2282:main.c        **** 	  {0,_W}, {0,_W}, {0,_W}, {0,_W}, {0,_W} };
2283:main.c        **** 
2284:main.c        **** 	uint8_t isPos = 0;
2285:main.c        **** 
2286:main.c        **** #define addSegIS(len, c) \
2287:main.c        **** ({\
2288:main.c        ****  	is[isPos].length = (len); \
2289:main.c        ****  	is[isPos].color = (c); \
2290:main.c        ****  	isPos+=ISEGS_PER_WHATEVER; \
2291:main.c        ****  	{}; \
2292:main.c        **** })
2293:main.c        **** 
2294:main.c        **** 
2295:main.c        **** 
2296:main.c        **** 	int8_t prevNextPosition;
2297:main.c        **** 	int8_t prevThisPosition;
2298:main.c        **** 
2299:main.c        **** 	static uint16_t thisIS, nextIS;
2300:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 63


2301:main.c        **** 	static uint8_t level = 1;
2302:main.c        **** 
2303:main.c        **** 
2304:main.c        **** 	if(rowNum%TRACK_ROWS == 0) //(V_COUNT/TRACK_LENGTH) == 0)
2305:main.c        **** 	{
2306:main.c        **** 		prevNextPosition = nextPosition - 1;
2307:main.c        **** 		if(prevNextPosition < 0)
2308:main.c        **** 			prevNextPosition = TRACK_LENGTH*2 - 1; //+prevNextPosition;
2309:main.c        **** 
2310:main.c        **** 		prevThisPosition = thisPosition - 1;
2311:main.c        **** 		if(prevThisPosition < 0)
2312:main.c        **** 			prevThisPosition = TRACK_LENGTH*2 - 1; //+prevThisPosition;
2313:main.c        **** 		
2314:main.c        **** 		static theta_t racerTheta=0;
2315:main.c        **** 
2316:main.c        **** 		int16_t nextTrackPseg;
2317:main.c        **** 
2318:main.c        **** 		nextTrackPseg = sineRaw8(racerTheta) + -(INT8_MIN);
2319:main.c        **** 		racerTheta+=level;
2320:main.c        **** 		if(racerTheta >= SINE_2PI)
2321:main.c        **** 			racerTheta-=SINE_2PI;
2322:main.c        **** /*
2323:main.c        **** 	int8_t randomVal = rand()&0x03;
2324:main.c        **** 	switch(randomVal)
2325:main.c        **** 	{
2326:main.c        **** 		case 1:
2327:main.c        **** 			if(nextTrackPseg < NUM_PSEGS-2-raceWidth)
2328:main.c        **** 				nextTrackPseg += 1;
2329:main.c        **** 			break;
2330:main.c        **** 		case 2:
2331:main.c        **** 			if(nextTrackPseg > 1)
2332:main.c        **** 				nextTrackPseg -= 1;
2333:main.c        **** 			break;
2334:main.c        **** 		default:
2335:main.c        **** 			break;
2336:main.c        **** 	}
2337:main.c        **** */
2338:main.c        **** 
2339:main.c        **** 
2340:main.c        **** 		raceTrack[nextPosition] = nextTrackPseg;
2341:main.c        **** 
2342:main.c        **** 		thisIS = raceTrack[prevThisPosition];
2343:main.c        **** 		nextIS = raceTrack[prevNextPosition];
2344:main.c        **** 		uint8_t nextHFMdist, thisHFMdist;
2345:main.c        **** 
2346:main.c        **** 		if(raceTrack[nextPosition] > nextIS)
2347:main.c        **** 		{
2348:main.c        **** 			nextTrackGrowing = TRUE;
2349:main.c        **** 			nextHFMdist = raceTrack[nextPosition] - nextIS;
2350:main.c        **** 		}
2351:main.c        **** 		else
2352:main.c        **** 		{
2353:main.c        **** 			nextTrackGrowing = FALSE;
2354:main.c        **** 			nextHFMdist = nextIS - raceTrack[nextPosition];
2355:main.c        **** 		}
2356:main.c        **** 		
2357:main.c        **** 		if(raceTrack[thisPosition] > thisIS)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 64


2358:main.c        **** 		{
2359:main.c        **** 			thisTrackGrowing = TRUE;
2360:main.c        **** 			thisHFMdist = raceTrack[thisPosition] - thisIS;
2361:main.c        **** 		}
2362:main.c        **** 		else
2363:main.c        **** 		{
2364:main.c        **** 			thisTrackGrowing = FALSE;
2365:main.c        **** 			thisHFMdist = thisIS - raceTrack[thisPosition];
2366:main.c        **** 		}
2367:main.c        **** 
2368:main.c        **** 		hfm_setup(&nextSmoothingHFM, nextHFMdist, TRACK_ROWS);
2369:main.c        **** 
2370:main.c        **** 		hfm_setup(&thisSmoothingHFM, thisHFMdist, TRACK_ROWS);
2371:main.c        **** 	}
2372:main.c        **** 
2373:main.c        **** 
2374:main.c        **** 	if(thisTrackGrowing)//raceTrack[thisPosition] > raceTrack[prevThisPosition])
2375:main.c        **** 		thisIS += hfm_nextOutput(&thisSmoothingHFM);
2376:main.c        **** 	else
2377:main.c        **** 		thisIS -= hfm_nextOutput(&thisSmoothingHFM);
2378:main.c        **** 
2379:main.c        **** 	if(nextTrackGrowing)//raceTrack[nextPosition] > raceTrack[prevNextPosition])
2380:main.c        **** 		nextIS += hfm_nextOutput(&nextSmoothingHFM);
2381:main.c        **** 	else
2382:main.c        **** 		nextIS -= hfm_nextOutput(&nextSmoothingHFM);
2383:main.c        **** 
2384:main.c        **** 	if(thisIS < nextIS)
2385:main.c        **** 	{
2386:main.c        **** 		addSegIS(thisIS, bgColor);
2387:main.c        **** 
2388:main.c        **** 		//Tracks overlap
2389:main.c        **** 		if(nextIS < thisIS + raceWidth)
2390:main.c        **** 		{
2391:main.c        **** 			addSegIS(nextIS - thisIS, THIS_COLOR);
2392:main.c        **** 			addSegIS(thisIS + raceWidth - nextIS, OVERLAP_COLOR);
2393:main.c        **** 			addSegIS(nextIS - thisIS, NEXT_COLOR);
2394:main.c        **** 			//outOfTrack=TRUE;
2395:main.c        **** 		}
2396:main.c        **** 		else
2397:main.c        **** 		{
2398:main.c        **** 			addSegIS(raceWidth, THIS_COLOR);
2399:main.c        **** 			addSegIS(nextIS - thisIS - raceWidth, bgColor);
2400:main.c        **** 			addSegIS(raceWidth, NEXT_COLOR);
2401:main.c        **** 		}
2402:main.c        **** 
2403:main.c        **** 		//addSegIS(NUM_PSEGS-2-nextIS-raceWidth, bgColor);
2404:main.c        **** 		addSegIS(RACE_WIDTH_PSEGS-nextIS-raceWidth, bgColor);
2405:main.c        **** 
2406:main.c        **** 	}
2407:main.c        **** 	else if(thisIS > nextIS)
2408:main.c        **** 	{
2409:main.c        **** 		addSegIS(nextIS, bgColor);
2410:main.c        **** 
2411:main.c        **** 		//Tracks overlap
2412:main.c        **** 		if(thisIS < nextIS + raceWidth)
2413:main.c        **** 		{
2414:main.c        **** 			addSegIS(thisIS - nextIS, NEXT_COLOR);
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 65


2415:main.c        **** 			addSegIS(nextIS + raceWidth - thisIS, OVERLAP_COLOR);
2416:main.c        **** 			addSegIS(thisIS - nextIS, THIS_COLOR);
2417:main.c        **** 			//outOfTrack=TRUE;
2418:main.c        **** 		}
2419:main.c        **** 		else
2420:main.c        **** 		{
2421:main.c        **** 			addSegIS(raceWidth, NEXT_COLOR);
2422:main.c        **** 			addSegIS(thisIS - nextIS - raceWidth, bgColor);
2423:main.c        **** 			addSegIS(raceWidth, THIS_COLOR);
2424:main.c        **** 		}
2425:main.c        **** 	
2426:main.c        **** 		//addSegIS(NUM_PSEGS-2-thisIS-raceWidth, bgColor);
2427:main.c        **** 		addSegIS(RACE_WIDTH_PSEGS-thisIS-raceWidth, bgColor);
2428:main.c        **** 	}
2429:main.c        **** 	else //Positions equal
2430:main.c        **** 	{
2431:main.c        **** 		//outOfTrack=TRUE;
2432:main.c        **** 		addSegIS(thisIS, bgColor);
2433:main.c        **** 
2434:main.c        **** 		addSegIS(raceWidth, OVERLAP_COLOR);
2435:main.c        **** 		//addSegIS(NUM_PSEGS-2-thisIS-raceWidth, bgColor);
2436:main.c        **** 		addSegIS(RACE_WIDTH_PSEGS-thisIS-raceWidth, bgColor);
2437:main.c        **** 	}
2438:main.c        **** /*
2439:main.c        **** addSegfb(raceWidth, _W);
2440:main.c        **** 	addSegfb(NUM_PSEGS-racePseg-raceWidth-2, _R);
2441:main.c        **** */
2442:main.c        **** 	uint8_t isSeg;
2443:main.c        **** 	uint16_t isSegTrackPos = 0;
2444:main.c        **** 	uint16_t oldTrackPos = 0;
2445:main.c        **** 	//uint8_t racerFound = FALSE;
2446:main.c        **** 
2447:main.c        **** 	for(isSeg = 0; isSeg<IS_SEGS; isSeg++)
2448:main.c        **** 	{
2449:main.c        **** 		isSegTrackPos += is[isSeg].length;
2450:main.c        **** 
2451:main.c        **** 		//if(!racerFound && 
2452:main.c        **** 		if((isSegTrackPos >= (uint16_t)racerPseg))
2453:main.c        **** 		{
2454:main.c        **** 			//racerFound = TRUE;
2455:main.c        **** 			uint16_t oldLength = is[isSeg].length;
2456:main.c        **** 			is[isSeg].length = racerPseg - oldTrackPos;
2457:main.c        **** 			is[isSeg+1].length = 1;
2458:main.c        **** 			is[isSeg+1].color = _K;
2459:main.c        **** 			//Not sure why this shouldn't be -1...
2460:main.c        **** 			is[isSeg+2].length = oldLength - is[isSeg].length; //- 1;
2461:main.c        **** 			is[isSeg+2].color = is[isSeg].color;
2462:main.c        **** 			if((is[isSeg].color != THIS_COLOR) && (is[isSeg].color != OVERLAP_COLOR))
2463:main.c        **** 				outOfTrack = TRUE;
2464:main.c        **** 			isSeg++;
2465:main.c        **** 			break;
2466:main.c        **** 		}
2467:main.c        **** 		oldTrackPos = isSegTrackPos;
2468:main.c        **** 	}
2469:main.c        **** 
2470:main.c        **** 	
2471:main.c        **** 	for(isSeg = 0; isSeg<IS_SEGS; isSeg++)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 66


2472:main.c        ****   	{
2473:main.c        **** 		if(is[isSeg].length == 0)
2474:main.c        **** 			continue;
2475:main.c        **** 		if(outOfTrack && (is[isSeg].color==BG_COLOR))
2476:main.c        **** 			addSegfb(is[isSeg].length, BG_BAD_COLOR);
2477:main.c        **** 		else
2478:main.c        **** 			addSegfb(is[isSeg].length, is[isSeg].color);
2479:main.c        **** 	}
2480:main.c        **** 
2481:main.c        **** 	static uint32_t badCount=0;
2482:main.c        **** 	static uint32_t goodCount=0;
2483:main.c        **** 
2484:main.c        **** 	if(outOfTrack)
2485:main.c        **** 		badCount++;
2486:main.c        **** 	else
2487:main.c        **** 		goodCount++;
2488:main.c        **** 
2489:main.c        **** 	
2490:main.c        **** 	addSegfb(1, _B);
2491:main.c        **** 
2492:main.c        **** 
2493:main.c        **** 	uint8_t percentage = goodCount*100/(badCount+goodCount);
2494:main.c        **** 	static uint32_t lastLevelUpdate = 0;
2495:main.c        **** 
2496:main.c        **** 	if((percentage > 50) && (goodCount - lastLevelUpdate > V_COUNT*3))
2497:main.c        **** 	{
2498:main.c        **** 		lastLevelUpdate = goodCount;
2499:main.c        **** 		level++;
2500:main.c        **** 	}
2501:main.c        **** 
2502:main.c        **** 	if((rowNum>=6) && (rowNum < 22))
2503:main.c        **** 		showScore(rowNum-6, level, _C);
2504:main.c        **** 
2505:main.c        **** 	else if((rowNum>=24) && (rowNum <40))
2506:main.c        **** 		showScore(rowNum-24, goodCount, _G);
2507:main.c        **** 	else if((rowNum >= 42) && rowNum < 58)
2508:main.c        **** 		showScore(rowNum-42, badCount, _R);
2509:main.c        **** 	else if((rowNum >= 60) && (rowNum < 76))
2510:main.c        **** 		showScore(rowNum-60, percentage, _Y);
2511:main.c        **** 
2512:main.c        **** 
2513:main.c        **** 	addSegfb(NUM_PSEGS-2-RACE_WIDTH_PSEGS, _B);
2514:main.c        **** 
2515:main.c        **** 	addSegfb(1, _W);
2516:main.c        **** 	segTerminate();
2517:main.c        **** 
2518:main.c        **** 	if(rowNum >= V_COUNT-1)
2519:main.c        **** 		trackPosition = !trackPosition;
2520:main.c        **** 
2521:main.c        ****  #elif (defined(SEG_HFM) && SEG_HFM)
2522:main.c        **** 	segClear();
2523:main.c        **** 	//Just some experimenting... 1024/3+16 seems to be the width...
2524:main.c        **** 	// == 357 segments (Where does this come from?)
2525:main.c        **** //Pixel Segments...
2526:main.c        **** #define BORDER_PSEGS	1
2527:main.c        **** #define SEGS_AVAILABLE (NUM_SEGMENTS-2)
2528:main.c        **** #define PSEGS_AVAILABLE	(NUM_PSEGS-BORDER_PSEGS*2)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 67


2529:main.c        **** #define HFM_PSEGS	(PSEGS_AVAILABLE/SEGS_AVAILABLE)
2530:main.c        **** #define HFM_PSEGS_REMAINDER	(PSEGS_AVAILABLE%SEGS_AVAILABLE)
2531:main.c        **** 	addSegfb(BORDER_PSEGS,_W);
2532:main.c        **** 
2533:main.c        **** 	hfm_t hfmThing;
2534:main.c        **** 	hfm_setup(&hfmThing, (uint8_t)((uint32_t)rowNum*(uint32_t)SEGS_AVAILABLE/V_COUNT), SEGS_AVAILABLE)
2535:main.c        **** 
2536:main.c        **** 	hfm_t hfmColStretcher;
2537:main.c        **** 	hfm_setup(&hfmColStretcher, HFM_PSEGS_REMAINDER, SEGS_AVAILABLE);
2538:main.c        **** 
2539:main.c        **** 	uint16_t pseg;
2540:main.c        **** 	for(pseg=0; pseg<SEGS_AVAILABLE; pseg++)
2541:main.c        **** 	{
2542:main.c        **** 		if(hfm_nextOutput(&hfmThing))
2543:main.c        **** 			addSegfb(HFM_PSEGS + hfm_nextOutput(&hfmColStretcher),_R);
2544:main.c        **** 		else
2545:main.c        **** 			addSegfb(HFM_PSEGS + hfm_nextOutput(&hfmColStretcher),_C);
2546:main.c        **** 	}
2547:main.c        **** 
2548:main.c        **** 	//addSegfb(NUM_PSEGS-BORDER_PSEGS*2-SEGS_AVAILABLE*HFM_PSEGS, _M);
2549:main.c        **** 	addSegfb(BORDER_PSEGS,_W);
2550:main.c        **** 	segTerminate();
2551:main.c        **** 
2552:main.c        ****  #elif (defined(SEG_QUESTION) && SEG_QUESTION)
2553:main.c        **** 
2554:main.c        **** //Actually, this probably won't work right...
2555:main.c        **** // because the rgb values aren't exact like that, right?
2556:main.c        **** // e.g. black = 0,0,0 but it shows as 0,0,60 ish...
2557:main.c        **** // then again, going in reverse like this might work fine...
2558:main.c        **** // due to rounding (seems OK with this color-scheme)
2559:main.c        **** // The idea wasn't so much to be able to input an 8-bit RGB value to get
2560:main.c        **** // a close match (would probably want rounding up for that, not that it'd
2561:main.c        **** // be even close)
2562:main.c        **** // but to be able to read color-values from GIMP when using the 
2563:main.c        **** //  LCDdirectLVDS color-palette... which isn't especially necessary since
2564:main.c        **** //  now the colors are named with 3-based colors.
2565:main.c        **** #define rgb8(r,g,b) \
2566:main.c        **** 		rgb((((r)*3)/255), (((g)*3)/255), (((b)*3)/255))
2567:main.c        **** 
2568:main.c        **** 
2569:main.c        **** 
2570:main.c        **** //THESE DON'T BELONG HERE
2571:main.c        **** // AND they shouldn't be "Q" specific, at all.
2572:main.c        **** #define Q_WIDTH	16
2573:main.c        **** #define Q_HEIGHT	16
2574:main.c        **** 		//This should be an init-thing, I guess... it's only a 2-cycle
2575:main.c        **** 		// instruction, so it doesn't hurt too much to have it in the loop
2576:main.c        **** 		// BUT it does have to occur a while before the first getpinPORT
2577:main.c        **** 		// to allow time for the pull-ups to do their job
2578:main.c        **** 		setinpuPORT(PB0, PORTB);
2579:main.c        **** 
2580:main.c        **** 	static uint8_t qCount = 0;
2581:main.c        **** 
2582:main.c        **** 	segClear();
2583:main.c        **** 	//Not sure why this is stretched without /2...
2584:main.c        **** 	// I think I ran into this elsewhere as well.
2585:main.c        **** 	//!!! INSTEAD: filled the rest of the row properly...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 68


2586:main.c        **** 	// (wasn't filling up the entire row, due to rounding...
2587:main.c        **** 	//   result was the rows were carrying-over into the next)
2588:main.c        **** 	uint8_t qRow;// = (rowNum*Q_HEIGHT/(V_COUNT)); ///2));
2589:main.c        **** 	uint8_t qCol;
2590:main.c        **** 	
2591:main.c        **** 	//Guess white helps with sync...?
2592:main.c        **** 	// can't hurt.
2593:main.c        **** 	//addSegfb(3, _W);
2594:main.c        **** 	// Looks like some white is already being inserted (or syncing on end-
2595:main.c        **** 	// white?) about 3pixels wide.
2596:main.c        **** 
2597:main.c        **** 	// 1024/3/32 = 10.67... so for every 3 segments, add 2
2598:main.c        **** #define Q_STRETCHTOP	1//0//28//2
2599:main.c        **** #define Q_STRETCHDIV 5//30//3
2600:main.c        **** 	hfm_t colincrementer_hfm;
2601:main.c        **** 	hfm_setup(&colincrementer_hfm, Q_STRETCHTOP, Q_STRETCHDIV);
2602:main.c        **** 
2603:main.c        **** 	for(qCol=0; qCol<Q_WIDTH; qCol++)
2604:main.c        **** 	{
2605:main.c        **** 		//Not sure where this is defined, if it is...
2606:main.c        **** 		// each "segment length" appears to be 3 physical pixels
2607:main.c        **** 		//+1 is a result of random experiments with stretch
2608:main.c        **** 		// resulting in a stretch larger than 1
2609:main.c        **** 		#define Q_SEGLENGTH	(1024/3/Q_WIDTH+1)
2610:main.c        **** 
2611:main.c        **** 	//These are not included in NUM_ICONS
2612:main.c        **** 	#include "icons/Question.h"
2613:main.c        **** 	#include "icons/Solid.h"
2614:main.c        **** 	#include "icons/GoombaDead.h"
2615:main.c        **** 
2616:main.c        **** 	//These are included in NUM_ICONS
2617:main.c        **** 	#include "icons/1up.h"
2618:main.c        **** 	#include "icons/Biggie.h"
2619:main.c        **** 	#include "icons/StarV.h"
2620:main.c        **** 	#include "icons/FlowerPowerV.h"
2621:main.c        **** 	#include "icons/Goomba.h"
2622:main.c        **** 	#include "icons/Coin.h"
2623:main.c        **** 
2624:main.c        **** 	//Excluding Solid and Question, etc...
2625:main.c        **** 	#define NUM_ICONS 6
2626:main.c        **** 		/*
2627:main.c        **** 		static uint8_t iconSelection = 0;
2628:main.c        **** 		static uint8_t * icon[NUM_ICONS] = { pgm_imageUP, pgm_imageCOIN};
2629:main.c        **** 		static uint8_t iconFrames[NUM_ICONS] = {NUM_UPS, NUM_COINS};
2630:main.c        **** 
2631:main.c        **** 		static uint8_t * p_image = pgm_imageUP; // = icon[0]; //(pgm_imageFLOWER);
2632:main.c        **** 		static uint8_t NumFramesInImage = NUM_UPS; // = NUM_FLOWERS;
2633:main.c        **** 		*/
2634:main.c        **** 		//For changing images...
2635:main.c        **** 		static sprite_t *p_selectedSprite = &spriteQ;
2636:main.c        **** 		static uint16_t buttonPressed = FALSE;
2637:main.c        **** 
2638:main.c        **** #define DEBUGGING_PRESSIMMEDIATE TRUE
2639:main.c        **** 
2640:main.c        **** #if(!defined(DEBUGGING_PRESSIMMEDIATE) || !DEBUGGING_PRESSIMMEDIATE)
2641:main.c        **** 		if((p_selectedSprite == &spriteQ) 
2642:main.c        **** 				|| (p_selectedSprite == &spriteGOOMBA))
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 69


2643:main.c        **** #else
2644:main.c        **** 	#warning "Debugging mode... players can change their result!"
2645:main.c        **** #endif
2646:main.c        **** 		if(!getpinPORT(PB0, PORTB))
2647:main.c        **** 		{
2648:main.c        **** 			if(!buttonPressed)
2649:main.c        **** 			{
2650:main.c        **** 				buttonPressed = rowNum;
2651:main.c        **** 				if(buttonPressed == 0)
2652:main.c        **** 					buttonPressed = 1;
2653:main.c        **** 			}
2654:main.c        **** 			else if((rowNum-buttonPressed) >= 64)
2655:main.c        **** 				buttonPressed += 0x4000;
2656:main.c        **** 		}
2657:main.c        **** 
2658:main.c        **** 
2659:main.c        **** #define REALLY_IMMEDIATE	TRUE
2660:main.c        **** #if (defined(REALLY_IMMEDIATE) && REALLY_IMMEDIATE)
2661:main.c        **** 		if((rowNum == 0) || (buttonPressed&0x8000))
2662:main.c        **** #else
2663:main.c        **** 		if(rowNum==0)
2664:main.c        **** #endif
2665:main.c        **** 		{
2666:main.c        **** 			if(!(buttonPressed&0x8000) && !((p_selectedSprite == &spriteQ) ||
2667:main.c        **** 												(p_selectedSprite == &spriteGOOMBA)))
2668:main.c        **** 				buttonPressed = FALSE;
2669:main.c        **** 
2670:main.c        **** 			if(buttonPressed)
2671:main.c        **** 			{
2672:main.c        **** 				if(p_selectedSprite == &spriteGOOMBA)
2673:main.c        **** 				{
2674:main.c        **** 					if(qCount == 1)
2675:main.c        **** 						p_selectedSprite = &spriteDEADGOOMBA;
2676:main.c        **** 
2677:main.c        **** 				}
2678:main.c        **** 				else
2679:main.c        **** 				{
2680:main.c        **** 					//Duh...
2681:main.c        **** 					// But still, 255 % 3 should give a value from 0 to 2
2682:main.c        **** 					//buttonPressed=FALSE;
2683:main.c        **** 					qCount = 0;
2684:main.c        **** 					//static uint8_t iconSelection;
2685:main.c        **** 					//iconSelection++;
2686:main.c        **** 					//iconSelection%=NUM_ICONS;
2687:main.c        **** 					//NumFramesInImage = iconFrames[iconSelection];
2688:main.c        **** //#define RANDOMSPRITE_OVERRIDE 0
2689:main.c        **** #if(defined(RANDOMSPRITE_OVERRIDE))
2690:main.c        **** 					switch(RANDOMSPRITE_OVERRIDE)
2691:main.c        **** #else
2692:main.c        **** 					switch ((buttonPressed-1)%(NUM_ICONS*2))
2693:main.c        **** #endif
2694:main.c        **** 					{
2695:main.c        **** 						case 0:
2696:main.c        **** 							p_selectedSprite = &spriteFLOWER;
2697:main.c        **** 							break;
2698:main.c        **** 						case 1:
2699:main.c        **** 							p_selectedSprite = &sprite1UP;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 70


2700:main.c        **** 							break;
2701:main.c        **** 						case 2:
2702:main.c        **** 							p_selectedSprite = &spriteBIG;
2703:main.c        **** 							break;
2704:main.c        **** 						case 3:
2705:main.c        **** 							p_selectedSprite = &spriteSTAR;
2706:main.c        **** 							break;
2707:main.c        **** 						case 4:
2708:main.c        **** 							p_selectedSprite = &spriteGOOMBA;
2709:main.c        **** 							break;
2710:main.c        **** 						default:
2711:main.c        **** 							p_selectedSprite = &spriteCOIN;
2712:main.c        **** 							break;
2713:main.c        **** 					}
2714:main.c        **** 				}
2715:main.c        **** 
2716:main.c        **** 				//buttonPressed=FALSE;
2717:main.c        **** 			}
2718:main.c        **** 			if(p_selectedSprite == &spriteCOIN)
2719:main.c        **** 			{
2720:main.c        **** 				if(qCount >= 2)
2721:main.c        **** 					p_selectedSprite = &spriteSOLID;
2722:main.c        **** 			}
2723:main.c        **** 			else if(p_selectedSprite != &spriteQ)
2724:main.c        **** 			{
2725:main.c        **** 				if(qCount >= 4)
2726:main.c        **** 				{
2727:main.c        **** 					qCount = 0;
2728:main.c        **** 					if(p_selectedSprite != &spriteSOLID)
2729:main.c        **** 						p_selectedSprite = &spriteSOLID;
2730:main.c        **** 					else
2731:main.c        **** 						p_selectedSprite = &spriteQ;
2732:main.c        **** 				}
2733:main.c        **** 			}
2734:main.c        **** 
2735:main.c        **** 			buttonPressed = FALSE;
2736:main.c        **** 		}
2737:main.c        **** 
2738:main.c        **** 		qRow = (rowNum*ICON_HEIGHT/(V_COUNT)); ///2));
2739:main.c        **** 		
2740:main.c        **** 
2741:main.c        **** 
2742:main.c        **** 
2743:main.c        **** //		p_image = (icon[iconSelection] + 
2744:main.c        **** //						(qCount%NumFramesInImage)*ICON_HEIGHT*ICON_WIDTH);
2745:main.c        **** 
2746:main.c        **** 		// Should use readImageByte... but it's specific to FB_WIDTH
2747:main.c        **** 		//uint8_t data=
2748:main.c        **** 		//  pgm_read_byte((uint8_t *)(&((p_image)[(qRow)*Q_WIDTH+(qCol)])));
2749:main.c        **** 		uint8_t data;
2750:main.c        **** 	  
2751:main.c        **** 		if(p_selectedSprite == &spriteFLOWER)
2752:main.c        **** 		{
2753:main.c        **** 			if(qRow<FLOWER_PALETTE1_ROW)
2754:main.c        **** 				data = getGimpColorVal(&spriteFLOWER,
2755:main.c        **** 							qCount%(spriteFLOWER.numPalettes-1) + 1, qRow, qCol);
2756:main.c        **** 			else
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 71


2757:main.c        **** 				data = getGimpColorVal(&spriteFLOWER,0,qRow, qCol);
2758:main.c        **** 		}
2759:main.c        **** 		else if(p_selectedSprite == &spriteGOOMBA)
2760:main.c        **** 		{
2761:main.c        **** 			uint8_t gCol = qCol;
2762:main.c        **** 			//Goomba moves by flipping horizontally...
2763:main.c        **** 			if(qCount & 0x01)
2764:main.c        **** 				gCol = 15-qCol;
2765:main.c        **** 
2766:main.c        **** 			data = getGimpColorVal(&spriteGOOMBA, 0, qRow, gCol);
2767:main.c        **** 		}
2768:main.c        **** 		else
2769:main.c        **** 		{
2770:main.c        **** 			data = getGimpColorVal(p_selectedSprite, 
2771:main.c        **** 							qCount%p_selectedSprite->numPalettes, qRow, qCol);
2772:main.c        **** 		}
2773:main.c        **** 		data = gimpPixelValToLColor(data);
2774:main.c        **** 
2775:main.c        **** 		addSegfb(Q_SEGLENGTH + hfm_nextOutput(&colincrementer_hfm), data);
2776:main.c        **** 	}
2777:main.c        **** 
2778:main.c        **** 
2779:main.c        **** 	//Wow, is it really so smart as to recognize that rowNum is never >=
2780:main.c        **** 	// V_COUNT?! was 7684 when if(rowNum==0), then 7668 after this bug...
2781:main.c        **** 	//if(rowNum >= V_COUNT)
2782:main.c        **** 	if(rowNum >= V_COUNT-1)
2783:main.c        **** 	{
2784:main.c        **** 		qCount++;
2785:main.c        **** 	}
2786:main.c        **** 
2787:main.c        **** 
2788:main.c        **** 	//Wait, what?! We can't fit 1024 segments! But this sorta works
2789:main.c        **** 	// We're gtting syncing, a tiny bit of white-space on the right
2790:main.c        **** 	// which seems reasonable based on shotty math, 
2791:main.c        **** 	//                10     *  32   +  10   *    2       /   3 = 326
2792:main.c        **** 	// but 1024/3 is 341 (where's my math error?)
2793:main.c        **** 	//addSegfb(1024-Q_SEGLENGTH*Q_WIDTH-Q_WIDTH*Q_STRETCHTOP/Q_STRETCHDIV, _W);
2794:main.c        **** 	// But, nope, 341-... doesn't sync (vertical stretching again)
2795:main.c        **** 	// But, 342 does. Sweet. 1024/3=341.33333, actually.
2796:main.c        **** 	//addSegfb(342-Q_SEGLENGTH*Q_WIDTH-Q_WIDTH*Q_STRETCHTOP/Q_STRETCHDIV, _W);
2797:main.c        **** 	// Because it's not 10*2/3, it's 32*2/3=21.3...
2798:main.c        **** 	// which is exactly right
2799:main.c        **** 	// which then doesn't explain why it has whitespace and doesn't sync
2800:main.c        **** 	// without 342 above...
2801:main.c        **** 	// something to do with white being necessary?
2802:main.c        **** 	// Can't recall where 1024/3 was determined, maybe it varies
2803:main.c        **** 	// since the LVDS clock is 7 cycles...?
2804:main.c        **** 	//OK, so maybe we just need a white pixel at the end...
2805:main.c        **** 	// I mean, this works.
2806:main.c        **** 	addSegfb(1,_W);
2807:main.c        **** 
2808:main.c        **** 
2809:main.c        **** 	segTerminate();
2810:main.c        **** 
2811:main.c        ****  #elif (defined(SEG_LINE) && SEG_LINE)
2812:main.c        **** 
2813:main.c        **** 	//syncing issues due to recursion overflowing the stack???
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 72


2814:main.c        **** 	// Apparently was
2815:main.c        **** 	segClear();
2816:main.c        **** 	newSeg(3,0x06, (6<<4) | 3);									//W
2817:main.c        **** 	newSeg((rowNum&0xff) | BLAH, 0x06, (4<<4) | 0);				//R
2818:main.c        **** 	newSeg(1,0x06, (6<<4) | 3);									//W
2819:main.c        **** 	newSeg((255-(rowNum&0xff)) | BLAH, 0x06, (4<<4) | 0 );	//R
2820:main.c        **** 	newSeg(3,0x06, (6<<4) | 3);									//W
2821:main.c        **** 	segTerminate();
2822:main.c        **** 
2823:main.c        ****  #elif (defined(SEG_SINE) && SEG_SINE)
2824:main.c        **** 	static uint16_t lastThetaOffset = 0;
2825:main.c        **** 	static uint8_t frameCount = 0;
2826:main.c        **** 
2827:main.c        **** 	if(rowNum == 0)
2828:main.c        **** 	{
2829:main.c        **** 		lastThetaOffset+=16;
2830:main.c        **** 		frameCount++;
2831:main.c        **** 	}
2832:main.c        **** 	//pgm_read_sine(sineTable[theta])
2833:main.c        **** 
2834:main.c        **** 	segClear();
2835:main.c        **** 	//addSegfb(3,0x06, (6<<4) | 3);
2836:main.c        **** 	addSegfb(3, _W);
2837:main.c        **** 
2838:main.c        **** 	uint8_t sineVal = (uint8_t)((int8_t)128 + 
2839:main.c        **** 			sineRaw8(rowNum+lastThetaOffset));
2840:main.c        **** 
2841:main.c        **** 	uint8_t nextSineVal = (uint8_t)((int8_t)128 +
2842:main.c        **** 			sineRaw8(rowNum+1+lastThetaOffset));
2843:main.c        **** 
2844:main.c        **** 	uint8_t length; 
2845:main.c        **** 
2846:main.c        **** 	//If the step-size is greater than one pixel, we'll see hashing
2847:main.c        **** 	// this should fix that.
2848:main.c        **** 	if(nextSineVal < sineVal)
2849:main.c        **** 	{
2850:main.c        **** 		length = (sineVal - nextSineVal);
2851:main.c        **** 		//This assures that the additional length of the white-segment
2852:main.c        **** 		// goes in the proper direction...
2853:main.c        **** 		sineVal-=length;//*4;
2854:main.c        **** 	}
2855:main.c        **** 	else if(nextSineVal > sineVal)
2856:main.c        **** 		length = (nextSineVal - sineVal);
2857:main.c        **** 		
2858:main.c        **** 	//But we don't want zero-length white segments (where the sine values
2859:main.c        **** 	// are horizontal)
2860:main.c        **** 	if(length == 0)
2861:main.c        **** 		length = 1;
2862:main.c        **** 
2863:main.c        **** 	uint8_t rgbVal=0;
2864:main.c        **** 	uint8_t J=0;
2865:main.c        **** 	uint8_t j = frameCount;
2866:main.c        **** 
2867:main.c        **** #define WIDTH 5//3//4
2868:main.c        **** 	while(1)
2869:main.c        **** 	{
2870:main.c        **** 		J++;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 73


2871:main.c        **** 		j++; // = J+frameCount;
2872:main.c        **** 		
2873:main.c        **** 		rgbVal = rgbGradient(j);
2874:main.c        **** 
2875:main.c        **** 		if((uint16_t)J*(uint16_t)WIDTH>=sineVal)
2876:main.c        **** 			break;
2877:main.c        **** 
2878:main.c        **** 		addSegfb(WIDTH, rgbVal);
2879:main.c        **** 	}
2880:main.c        **** 
2881:main.c        **** 	J--;
2882:main.c        **** 
2883:main.c        **** 	addSegfb(sineVal-(uint16_t)J*(uint16_t)WIDTH, rgbVal); 
2884:main.c        **** 
2885:main.c        **** 	addSegfb(length, _W); 
2886:main.c        **** 	addSegfb(257-sineVal-length, rgbGradient(rowNum/8)); //rowNum/8);
2887:main.c        **** 
2888:main.c        **** 	addSegfb(3, _W);
2889:main.c        **** 
2890:main.c        **** 	//Draw a sideways character...
2891:main.c        **** 	{
2892:main.c        **** 		addSegfb(3, _R);
2893:main.c        **** 
2894:main.c        **** 		uint8_t i;
2895:main.c        **** 
2896:main.c        **** 		//Without + ' ' we get the same alphabet but shifted
2897:main.c        **** 		// starting with the lower-case letters which are shifted down a row
2898:main.c        **** 	   // and some garbage in the top row...
2899:main.c        **** 		// now I get that I'm reading weird memory locations, but this
2900:main.c        **** 		// doesn't seem right. I should be accessing outside the array 
2901:main.c        **** 		// altogether, no? 	
2902:main.c        **** 		char thisChar = (rowNum/8)%('~'-' '+1) + ' '; //pgm_read_byte(&(string[rowNum/8])); 
2903:main.c        **** 		//'A'; //string[rowNum/8];
2904:main.c        **** 
2905:main.c        **** 		//Ironically, there are exactly the number of characters to be
2906:main.c        **** 		// displayed in 768 lines (plus one on the right, to center)
2907:main.c        **** 		for(i=8; i>0; i--)
2908:main.c        **** 		{
2909:main.c        **** 			if(getbit(rowNum%8, getCharRow(thisChar,i-1)))
2910:main.c        **** 				addSegfb(1, _Y); //0x06, (4<<4) | 3);
2911:main.c        **** 			else
2912:main.c        **** 				addSegfb(1, _R); //0x06, (4<<4) | 0);
2913:main.c        **** 		}
2914:main.c        **** 
2915:main.c        **** 		addSegfb(3, _R); //0x06, (4<<4) | 0);
2916:main.c        **** 
2917:main.c        **** 		addSegfb(1, _W); //0x04, (6<<4) | 3);
2918:main.c        **** 
2919:main.c        **** 		//PGM_P charPtr = strchrnul_P(
2920:main.c        **** 		PGM_P tqbf = PSTR(" The Quick Brown Fox Jumped Over The Lazy Dog!"); 
2921:main.c        **** 		//, rowNum/8);
2922:main.c        **** 
2923:main.c        **** 		strncpy_P(&thisChar, tqbf+(rowNum/8), 1);
2924:main.c        **** 
2925:main.c        **** 		addSegfb(3, rgb(0,0,1));//_B); //0, (6<<4) | 0);
2926:main.c        **** 
2927:main.c        **** 		if(rowNum/8 < strlen_P(tqbf))
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 74


2928:main.c        **** 		{
2929:main.c        **** 			for(i=8; i>0; i--)
2930:main.c        **** 			{
2931:main.c        **** 				if(getbit(rowNum%8, getCharRow(thisChar,i-1)))
2932:main.c        **** 					addSegfb(1, rgb(3,0,1));//_C); //0, (6<<4) | 3);
2933:main.c        **** 				else
2934:main.c        **** 					addSegfb(1, rgb(0,0,1));//_B); //0, (6<<4) | 0);
2935:main.c        **** 			}
2936:main.c        **** 		}
2937:main.c        **** 		else
2938:main.c        **** 			addSegfb(8, rgb(0,0,1));//_B); //0,(6<<4) | 0);
2939:main.c        **** 
2940:main.c        **** 		addSegfb(3, rgb(0,0,1));//_B); //0,(6<<4)|0);
2941:main.c        **** 
2942:main.c        **** 	}
2943:main.c        **** 
2944:main.c        **** 	//newSeg(3,0x06,(4<<4) | 0);
2945:main.c        **** 
2946:main.c        **** 	for(i=0; i<64; i++)
2947:main.c        **** 		addSegfb(1, (i+rowNum/4)&0x3f);
2948:main.c        **** 
2949:main.c        **** 	addSegfb(3, _W); //0x06, (6<<4) | 3);
2950:main.c        **** 
2951:main.c        **** 	segTerminate();
2952:main.c        **** 
2953:main.c        ****  #else //NOT SEG_LINE NOR SEG_SINE
2954:main.c        ****   #if(!defined(SEG_STRETCH))
2955:main.c        **** 	#define SEG_STRETCH 1
2956:main.c        ****   #endif
2957:main.c        **** 
2958:main.c        **** 	segClear();
2959:main.c        **** 
2960:main.c        **** 	//Good for syncing to have white on both borders...
2961:main.c        **** 	newSeg(1, 0x06, (6<<4) | 3);
2962:main.c        **** 	
2963:main.c        **** 	//i+1 because we don't want to overwrite the white border...
2964:main.c        **** 	for(i=0; i<RB_WIDTH; i++)
2965:main.c        **** 		rbpix_to_seg(rowBuffer[i], i+1, SEG_STRETCH);
2966:main.c        **** 	
2967:main.c        **** 	//white...
2968:main.c        **** 	newSeg(1, 0x06, (6<<4) | 3);
2969:main.c        **** 	segTerminate();
2970:main.c        ****  #endif //SEG_LINE
2971:main.c        **** #endif //ROW_SEG_BUFFER
2972:main.c        **** }
2973:main.c        **** #endif //LOAD_ROW
2974:main.c        **** 
2975:main.c        **** void init_timer0Hsync(void)
2976:main.c        **** {
2977:main.c        **** 	//T_HD + T_DH + T_low + T_DE
2978:main.c        **** 	// For the original system, 19.865us = 695 dot-clocks
2979:main.c        **** 	// We'd need to take advantage of the 16-bit timer
2980:main.c        **** 	//  OCR1A may not be written properly (with a temporary high-byte)
2981:main.c        **** 	//  ... not sure.
2982:main.c        **** 	// TIMER0 DOES NOT HAVE CTC MODE in 16-bit mode
2983:main.c        **** 
2984:main.c        **** // This is a hack, for testing syncability with long row-calculations
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 75


2985:main.c        **** // before actually drawing it... e.g. loading from program memory
2986:main.c        **** // This value needs to be larger than the calculation time
2987:main.c        **** // otherwise, it seems, syncing isn't stable
2988:main.c        **** // BUT THIS IS A HACK, has nothing to do with actual calculation time
2989:main.c        **** // And for slow LVDS or whatnot, this may be unnecessarily HUGE
2990:main.c        **** 
2991:main.c        **** #define DISPLAY_CYC_COUNT \
2992:main.c        **** 	(T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC)
2993:main.c        **** 
2994:main.c        **** //NOTE that with longer ROW_CALCULATION_CYCS, lines can be repeated...
2995:main.c        **** // apparently an effect of the display, definitely not a code-thing
2996:main.c        **** // in which case the vertical resolution decreases
2997:main.c        **** // though, this could be used to advantage... 
2998:main.c        **** // (e.g. more processing time outside the drawing interrupts?)
2999:main.c        **** // NOTE that if the value is too small and calculations take longer in some
3000:main.c        **** // lines than others (?), those lines may repeat, or syncing could be off
3001:main.c        **** #if (LVDS_PRESCALER == 8)
3002:main.c        ****  //#define ROW_CALCULATION_DELAY 1//20
3003:main.c        ****  #define ROW_CALCULATION_CYCS (50000) //0 //(70000) //(100000)
3004:main.c        **** #else
3005:main.c        ****  //#define ROW_CALCULATION_DELAY 9//7//5//2//1//10
3006:main.c        ****  #define ROW_CALCULATION_CYCS	(8*DISPLAY_CYC_COUNT)
3007:main.c        **** #endif
3008:main.c        **** 
3009:main.c        **** #define TOTAL_CYC_COUNT \
3010:main.c        **** 	(ROW_CALCULATION_CYCS + DISPLAY_CYC_COUNT)
3011:main.c        **** //	(ROW_CALCULATION_DELAY * (T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC))
3012:main.c        **** //#define TOTAL_CYC_COUNT 2000
3013:main.c        **** #if (TOTAL_CYC_COUNT > 255)
3014:main.c        ****  //Adding +7 causes it to round up (hopefully)
3015:main.c        ****  #define TIMER0_TCNTS ((TOTAL_CYC_COUNT+7)/8)
3016:main.c        ****  #define TIMER0_CLKDIV	CLKDIV8
3017:main.c        ****  #warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+7)/8: Timer0 CLKDIV8"
3018:main.c        ****  #if (TIMER0_TCNTS > 255)
3019:main.c        ****   #warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+63)/64: Timer0 CLKDIV64"
3020:main.c        ****   #define TIMER0_TCNTS ((TOTAL_CYC_COUNT+63)/64)
3021:main.c        ****   #define TIMER0_CLKDIV CLKDIV64
3022:main.c        ****   #if (TIMER0_TCNTS > 255)
3023:main.c        **** 	 #warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+255)/256: Timer0 CLKDIV256"
3024:main.c        **** 	 #define TIMER0_TCNTS ((TOTAL_CYC_COUNT+255)/256)
3025:main.c        **** 	 #define TIMER0_CLKDIV CLKDIV256
3026:main.c        **** 	 #if (TIMER0_TCNTS > 255)
3027:main.c        **** 		#warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+1023)/1024: Timer0 CLKDIV1024"
3028:main.c        **** 		#define TIMER0_TCNTS ((TOTAL_CYC_COUNT+1023)/1024)
3029:main.c        **** 		#define TIMER0_CLKDIV	CLKDIV1024
3030:main.c        **** 	 #endif
3031:main.c        ****   #endif
3032:main.c        ****  #endif
3033:main.c        ****  #if (TIMER0_TCNTS == 0)
3034:main.c        ****   #error "TIMER0_OCRVAL == 0"
3035:main.c        ****  #endif
3036:main.c        **** #else
3037:main.c        ****  #define TIMER0_TCNTS TOTAL_CYC_COUNT
3038:main.c        ****  #define TIMER0_CLKDIV CLKDIV1
3039:main.c        **** #endif
3040:main.c        **** 
3041:main.c        **** #if (defined(SLOW_EVERYTHING_TEST) && SLOW_EVERYTHING_TEST)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 76


3042:main.c        ****  //For testing, I want to see the pulses with the 'scope
3043:main.c        ****  // Unless the timer is divisible by 7 the pulses will not align with the
3044:main.c        ****  // timer overflow...
3045:main.c        ****  //but shit... it's running at clkdiv8 so each TCNT is 64 bits!
3046:main.c        ****  // but this shouldn't matter for visualizing, that's only ~10 pixel clocks
3047:main.c        ****  // and we'll only start visualizing *after* the extra TCNTs...
3048:main.c        ****  //Since the timer counts from 0 to (and including) OCR1A
3049:main.c        ****  // Add one to this test...
3050:main.c        ****  #if (((TIMER0_TCNTS + 1) % 7) == 0)
3051:main.c        ****   #warning "(TIMER0_TCNTS + 1) % 7 == 0"
3052:main.c        ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS"
3053:main.c        ****   #define TIMER0_OCRVAL (TIMER0_TCNTS)
3054:main.c        **** 
3055:main.c        ****  #elif (((TIMER0_TCNTS + 2) % 7) == 0)
3056:main.c        ****   #warning "(TIMER0_TCNTS + 2) % 7 == 0"
3057:main.c        ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 1"
3058:main.c        ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 1)
3059:main.c        **** 
3060:main.c        ****  #elif (((TIMER0_TCNTS + 3) % 7) == 0)
3061:main.c        ****   #warning "(TIMER0_TCNTS + 3) % 7 == 0"
3062:main.c        ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 2"
3063:main.c        ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 2)
3064:main.c        **** 
3065:main.c        ****  #elif (((TIMER0_TCNTS + 4) % 7) == 0)
3066:main.c        ****   #warning "(TIMER0_TCNTS + 4) % 7 == 0"
3067:main.c        ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 3"
3068:main.c        ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 3)
3069:main.c        **** 
3070:main.c        ****  #elif (((TIMER0_TCNTS + 5) % 7) == 0)
3071:main.c        ****   #warning "(TIMER0_TCNTS + 5) % 7 == 0"
3072:main.c        ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 4"
3073:main.c        ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 4)
3074:main.c        **** 
3075:main.c        ****  #elif (((TIMER0_TCNTS + 6) % 7) == 0)
3076:main.c        ****   #warning "(TIMER0_TCNTS + 6) % 7 == 0"
3077:main.c        ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 5"
3078:main.c        ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 5)
3079:main.c        **** 
3080:main.c        ****  #elif (((TIMER0_TCNTS) % 7) == 0)
3081:main.c        ****   #warning "(TIMER0_TCNTS) % 7 == 0"
3082:main.c        ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS - 1"
3083:main.c        ****   #define TIMER0_OCRVAL (TIMER0_TCNTS - 1)
3084:main.c        **** 
3085:main.c        ****  #else
3086:main.c        ****   #error "WTF?"
3087:main.c        ****  #endif
3088:main.c        **** #else
3089:main.c        ****  #define TIMER0_OCRVAL (TIMER0_TCNTS-1)
3090:main.c        **** #endif
3091:main.c        **** 
3092:main.c        **** #if (TIMER0_OCRVAL > 255)
3093:main.c        ****  #error "Despite all my efforts, TIMER0_OCRVAL is *still* > 255!"
3094:main.c        **** #endif
3095:main.c        **** 
3096:main.c        ****    OCR0A = TIMER0_OCRVAL; //T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC;
3097:main.c        **** 	timer_setWGM(0, WGM_CLR_ON_COMPARE);
3098:main.c        ****    timer_selectDivisor(0, TIMER0_CLKDIV); //CLKDIV1);
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 77


3099:main.c        ****    timer_compareMatchIntEnable(0, OUT_CHANNELA);
3100:main.c        **** }
3101:main.c        **** 
3102:main.c        **** //For a first go...
3103:main.c        **** // B5 = OCR=5
3104:main.c        **** // B4 = OCR=6+
3105:main.c        **** // B3 = DT=0
3106:main.c        **** // B2 = DT=1
3107:main.c        **** // Possible combinations:
3108:main.c        **** // B3, B2, B5, B4		OCR>6 (DT=0)
3109:main.c        **** // B3, B2, B5			OCR=5, DT=0
3110:main.c        **** // B3, B2				OCR=4, DT=0
3111:main.c        **** //     B2, B5, B4		OCR=6, DT=1 (is OCR=6 possible?)
3112:main.c        **** //     B2, B5			OCR=5, DT=1
3113:main.c        **** //     B2				OCR=4, DT=1
3114:main.c        **** //         B5, B4		OCR=6, DT=2 (is OCR=6 possible?)
3115:main.c        **** //         B5			OCR=5, DT=2
3116:main.c        **** // OCR=6 is full-on...
3117:main.c        **** 
3118:main.c        **** //            |  0   1    2    3    4    5    6    
3119:main.c        **** //            |____ ____ ____ ____ ____ ____ ____
3120:main.c        **** //   DE:      X B3 X B2 /    .    .    \ B5 X B4 X
3121:main.c        **** //            |                  
3122:main.c        **** 
3123:main.c        **** // Active Bits     | Brightness   |
3124:main.c        **** //                 | (0-63)       |    Configuration
3125:main.c        **** // ----------------+--------------+-------------------------
3126:main.c        **** // B5  B4  B3  B2  |     60		 |		OCR>6 (DT=0)  //DC
3127:main.c        **** // B5      B3  B2  |     44 		 |		OCR=5, DT=0
3128:main.c        **** // B5          B2  |     36 		 |		OCR=5, DT=1
3129:main.c        **** // B5              |     32 		 |		OCR=5, DT=2  
3130:main.c        **** //         B3  B2  |     12 		 |		OCR=4, DT=0  //Damn-near black...
3131:main.c        **** //             B2  |     4  		 |		OCR=4, DT=1  //Even closer
3132:main.c        **** // None = Black    |     0        |    OCR=4, DT=2
3133:main.c        **** //
3134:main.c        **** // The colors 60, 44, 36, and 32 are all discernable
3135:main.c        **** // (though 36 and 32 mightn't be if not side-by-side)
3136:main.c        **** // 12, 4, and 0 are damn-near identical and may not be worth the overhead
3137:main.c        **** // There is a SIGNIFICANT jump between 32 and 12
3138:main.c        **** //   32 is I'd say half-bright, maybe more
3139:main.c        **** //   12 is damn-near black
3140:main.c        **** 
3141:main.c        **** #define fullBlue()	DEblue_init()
3142:main.c        **** 
3143:main.c        **** /*
3144:main.c        **** static __inline__ \
3145:main.c        **** void writeBlue(uint8_t settingVal) \
3146:main.c        **** 	  __attribute__((__always_inline__));
3147:main.c        **** */
3148:main.c        **** 
3149:main.c        **** #if FALSE
3150:main.c        **** #define GREEN_PIN_MASK	0x03
3151:main.c        **** #define GREEN_PORT		PORTA
3152:main.c        **** #define GREEN_ON			0x01
3153:main.c        **** #define GREEN_ON_STRING	"0x01"
3154:main.c        **** #define GREEN_OFF			0x02
3155:main.c        **** #define GREEN_OFF_STRING "0x02"
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 78


3156:main.c        **** // in settingVal: bit 3 is unused by blue (4<=OCR<=6), so use it for green
3157:main.c        **** #define GREEN_SETTING_BIT	3
3158:main.c        **** #define GREEN_SETTING_BIT_STRING	"3"
3159:main.c        **** // for setBlue:
3160:main.c        **** #define GREEN_BLUEVAL_BIT	0
3161:main.c        **** 
3162:main.c        **** #define RED_PIN_MASK		0x0C
3163:main.c        **** #define RED_PORT			PORTA
3164:main.c        **** #define RED_ON				0x04
3165:main.c        **** #define RED_ON_STRING	"0x04"
3166:main.c        **** #define RED_OFF			0x08
3167:main.c        **** #define RED_OFF_STRING	"0x08"
3168:main.c        **** #define RED_SETTING_BIT	7
3169:main.c        **** #define RED_SETTING_BIT_STRING "7"
3170:main.c        **** #define RED_BLUEVAL_BIT	1
3171:main.c        **** 
3172:main.c        **** #define REDGREEN_PORT 	RED_PORT
3173:main.c        **** 
3174:main.c        **** 
3175:main.c        **** void writeBlue(uint8_t settingVal)
3176:main.c        **** {
3177:main.c        **** 	//Best to do these calculations first and write the registers later
3178:main.c        **** 	// it's a noticeable change (green is offset a bit, but much less)
3179:main.c        **** 	uint8_t dt = settingVal & 0x70;
3180:main.c        **** 	uint8_t ocr = settingVal & 0x07;
3181:main.c        **** 
3182:main.c        **** 	//The red and green PORT value will be temporarily calculated here...
3183:main.c        **** 	uint8_t redGreen; 
3184:main.c        **** 
3185:main.c        **** 
3186:main.c        **** 	//ASM Notes:
3187:main.c        ****    // avr-libc-user-manual-1.7.0/inline__asm.html
3188:main.c        **** 
3189:main.c        **** 	//This is timing-critical... the amount of time taken in writeBlue
3190:main.c        **** 	// determines the width of each pixel.
3191:main.c        **** 	// Most importantly: if standard C-style if/else statements are used
3192:main.c        **** 	//  it compiles differently each time (based on optimization, etc.)
3193:main.c        **** 	//  Often, though not always, it would compile such that different
3194:main.c        **** 	//  color values would use more instructions than others (branching)...
3195:main.c        **** 	//  It was too unpredictable (and believe me I tried) to code it in C
3196:main.c        **** 	//  and make it consistent. e.g. adding a nop in an else-case caused
3197:main.c        **** 	//  it to compile using brne, but not adding the nop caused breq
3198:main.c        **** 
3199:main.c        **** 	//Simply: if(getbit(greenBit, settingVal)) 	redGreen=GREEN_ON;
3200:main.c        **** 	//        else											redGreen=GREEN_OFF;
3201:main.c        **** __asm__ __volatile__
3202:main.c        **** 		  //SBRC takes 1 cycle if not skipping, 2 (or 3) if skipping
3203:main.c        **** 	     ( "sbrc %1, " GREEN_SETTING_BIT_STRING "; \n\t"				//0,1
3204:main.c        **** 							//Skip the jump if !getbit(GREEN, settingVal)
3205:main.c        **** 			 "rjmp .+4; \n\t"  //jump if getbit(GREEN, settingVal)	//1-
3206:main.c        **** 			 "ldi  %0, " GREEN_OFF_STRING "; \n\t"							//0-
3207:main.c        **** 			 "rjmp .+4; \n\t"  // skip setting GREEN_ON					//0-
3208:main.c        **** 			 "nop; \n\t"
3209:main.c        **** 			 "ldi  %0, " GREEN_ON_STRING "; \n\t"							//1-
3210:main.c        **** 			: "=r" (redGreen)		//redGreen is assigned to %0
3211:main.c        **** 			: "r"  (settingVal)	//settingVal is assigned to %1
3212:main.c        **** 			);
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 79


3213:main.c        **** 	//Simply: if(getbit(redBit, settingVal))		redGreen|=RED_ON;
3214:main.c        **** 	//			 else											redGreen|=RED_OFF;
3215:main.c        **** __asm__ __volatile__
3216:main.c        **** 	     ( "sbrc %1, " RED_SETTING_BIT_STRING "; \n\t"
3217:main.c        ****                      //Skip the jump if !getbit(GREEN, settingVal)
3218:main.c        ****           "rjmp .+4; \n\t"  //jump if getbit(GREEN, settingVal)
3219:main.c        ****           "ori  %2, " RED_OFF_STRING "; \n\t"
3220:main.c        ****           "rjmp .+4; \n\t"  // skip setting GREEN_ON
3221:main.c        ****           "nop; \n\t"
3222:main.c        **** 			 "ori  %2, " RED_ON_STRING "; \n\t"
3223:main.c        ****          : "=r" (redGreen)    //redGreen is assigned to %0
3224:main.c        ****          : "r"  (settingVal),  //settingVal is assigned to %1
3225:main.c        **** 			  "d0"  (redGreen) //d is necessary for ori
3226:main.c        ****          );                 // 0 means 2 is shared with 0 for r/w... 
3227:main.c        **** 									 //(its value is also an input)
3228:main.c        **** 	//See notes in [the new] setBlue()
3229:main.c        **** 
3230:main.c        **** 	//Since instructions are longer than pixels, it's damn-near impossible
3231:main.c        **** 	// to have perfectly sharp edges... this order seems best,
3232:main.c        **** 	// but I haven't experimented much
3233:main.c        **** 	// May be that the reverse order is best when switching from lighter
3234:main.c        **** 	// to darker, which would require more overhead to detect
3235:main.c        **** 	// making pixels even longer. Best to have a single-LCD-pixel of ugly
3236:main.c        **** 	// than to make displayable pixels wider, reducing resolution...
3237:main.c        **** 	OCR1A = ocr;
3238:main.c        **** 	DT1 = dt;
3239:main.c        **** 	REDGREEN_PORT = redGreen;
3240:main.c        **** 
3241:main.c        **** 	//This is just to try to mimic 17's timing...
3242:main.c        **** 	// (right now, there's some timing issues, 
3243:main.c        **** 	//   line seems to start somewhat randomly, near the right edge
3244:main.c        **** 	//   some PIXEL_SCROLLs give static...)
3245:main.c        **** 	// <= 46 optimizes out, somehow, even though the code-size is larger
3246:main.c        **** 	// Should be fixed now... (see delay_cyc hacks)
3247:main.c        **** //	delay_Dots(15);
3248:main.c        **** 
3249:main.c        **** }
3250:main.c        **** #endif //FALSE
3251:main.c        **** 
3252:main.c        **** static __inline__ \
3253:main.c        **** void writeColor(uint8_t colorVal) \
3254:main.c        **** 	  __attribute__((__always_inline__));
3255:main.c        **** 
3256:main.c        **** #if(defined(ROW_BUFFER) && ROW_BUFFER)
3257:main.c        **** //THIS IS JUST AN ESTIMATE
3258:main.c        ****  #define WRITE_COLOR_CYCS	(13)
3259:main.c        **** #elif(defined(FOUR_SHADES) && FOUR_SHADES)
3260:main.c        ****  // Roughly...
3261:main.c        ****  #define WRITE_COLOR_CYCS	(12*2+9+3)
3262:main.c        **** #else
3263:main.c        ****  // Roughly...
3264:main.c        ****  #define WRITE_COLOR_CYCS	(9*3+3)
3265:main.c        **** #endif
3266:main.c        **** 
3267:main.c        **** void writeColor(uint8_t colorVal)
3268:main.c        **** {
3269:main.c        **** //#warning "I'm absolutely certain this'll need to be revised, probably asm"
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 80


3270:main.c        **** 	//   Red: (+OC1D => RX0+)
3271:main.c        **** 	//    Off (0/63): OCR1D = 0
3272:main.c        **** 	//    35/63:      OCR1D = 3
3273:main.c        **** 	//    63/63:      OCR1D >= 6
3274:main.c        **** 
3275:main.c        **** /* No Shit: This compiles to a 16-bit test!
3276:main.c        **** 	switch((uint8_t)(colorVal & (uint8_t)0x03))
3277:main.c        **** 	{
3278:main.c        **** 		case (uint8_t)0:
3279:main.c        **** 			OCR1D = 0;
3280:main.c        **** 			break;
3281:main.c        **** 		case (uint8_t)1:
3282:main.c        **** 			OCR1D = 3;
3283:main.c        **** 			break;
3284:main.c        **** 		case (uint8_t)2:
3285:main.c        **** 		default:
3286:main.c        **** 			OCR1D = 6;
3287:main.c        **** 			break;
3288:main.c        **** 	}
3289:main.c        **** */
3290:main.c        **** 
3291:main.c        **** #if(defined(ROW_BUFFER) && ROW_BUFFER)
3292:main.c        **** 	// In this case, colorVal is actually settingVal...
3293:main.c        **** 	// Between LDI, these instructions, and OCR/DT register writes
3294:main.c        **** 	// this is 14 cycles... or 16 pixels...
3295:main.c        **** 
3296:main.c        **** 	//										//ldi (colorVal) (2 cyc)
3297:main.c        **** 	//Red: (temp)
3298:main.c        **** 	uint8_t ocrd = colorVal >> 2;	//mov, shl, shl
3299:main.c        **** 	//Green:
3300:main.c        **** 	uint8_t dt = colorVal & 0x03; //andi
3301:main.c        **** 	//Blue:
3302:main.c        **** 	uint8_t ocra = ocrd >> 3;		//mov, shl, shl, shl
3303:main.c        **** 	//And red...
3304:main.c        **** 	ocrd &= 0x07;						//andi
3305:main.c        **** 											//out OCRD, out DT, out OCRA
3306:main.c        **** 
3307:main.c        **** #else //NOT ROW_BUFFER (FRAMEBUFFER)
3308:main.c        **** 
3309:main.c        **** //	uint8_t redVal; // = colorVal & 0x03;
3310:main.c        **** 	uint8_t ocrd;
3311:main.c        **** 
3312:main.c        **** /*
3313:main.c        **** 	if(redVal == 0x00)
3314:main.c        **** 		ocrd = 0;
3315:main.c        **** 	else if(redVal == 0x01)
3316:main.c        **** 		ocrd = 3;
3317:main.c        **** 	else //2, 3
3318:main.c        **** 		ocrd = 6;
3319:main.c        **** */
3320:main.c        **** #if(defined(FOUR_SHADES) && FOUR_SHADES)
3321:main.c        ****  // "nop; nop; nop;" compiles to just a single nop! 
3322:main.c        ****  //"\n\t" or maybe the space is necessary
3323:main.c        ****  #define FOUR_SHADES_NOPS "nop ; \n\t nop ; \n\t nop ; \n\t"
3324:main.c        **** #else
3325:main.c        ****  #define FOUR_SHADES_NOPS "\n\t"
3326:main.c        **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 81


3327:main.c        **** 	//Each branch is 9 cycles... (12 with FOUR_SHADES)
3328:main.c        **** __asm__ __volatile__
3329:main.c        **** 	( "mov 	%0, %1 	; \n\t"	// ocrd (redVal) = colorVal			  //1
3330:main.c        **** 	  "andi	%0, 0x03	; \n\t"	// ocrd = ocrd & 0x03					  //1
3331:main.c        **** 	  "brne	red1tst_%=; \n\t"	// if(ocrd != 0x00) jump to red1test  //1`2
3332:main.c        **** 	  "ldi   %0, 0x00	; \n\t"	// (ocrd==0x00) add some delays		  //1 .
3333:main.c        **** 	  "nop            ; \n\t"  //                                    //1 .
3334:main.c        **** 	  "nop            ; \n\t"  //                                    //1 .
3335:main.c        **** 	  "nop				; \n\t"  //                                    //1 .
3336:main.c        **** 	  FOUR_SHADES_NOPS         //                                    //N .
3337:main.c        **** 	  "rjmp  end_%=	; \n\t"	//   jump to the end						  //2 .
3338:main.c        **** 	  									// (ocrd_reg = redVal_reg = 0)            .
3339:main.c        **** 	"red1tst_%=:"					//"%=" is a unique identifier for this asm.
3340:main.c        **** 										//  invocation, so the label won't be     .
3341:main.c        **** 										//  mistaken from another invocation      .
3342:main.c        **** 	  "cpi	%0, 0x01	; \n\t"	// if(ocrd-0x01 != 0)					  //  1
3343:main.c        **** 	  "brne	red23_%=	; \n\t"	//   jump to red=2,3						  //  1`2
3344:main.c        **** 	  FOUR_SHADES_NOPS         //                                    //  N .
3345:main.c        **** 	  "ldi	%0, 0x03	; \n\t"	// else ocrd = 0x03                   //  1 .
3346:main.c        **** 	  "rjmp	end_%=	; \n\t"	//      jump to the end               //  2 .
3347:main.c        **** 	"red23_%=:"                                                      //    .
3348:main.c        **** #if (defined(FOUR_SHADES) && FOUR_SHADES)                           //   /.
3349:main.c        **** 	  "cpi	%0, 0x02 ; \n\t"	// if(ocrd-0x02 !=0)                  //( . 1
3350:main.c        **** 	  "brne  red3_%=	; \n\t"	//		jump to red=3                   //( . 1`2
3351:main.c        **** 	  "ldi   %0, 0x04 ; \n\t"	// else ocrd=4                        //( . 1 .
3352:main.c        **** 	  "rjmp  end_%=	; \n\t"	//      jump to the end               //( . 2 .
3353:main.c        **** 	"red3_%=:"                                                       //( .   /
3354:main.c        **** #endif                                                              //(  \ /
3355:main.c        ****      "ldi	%0, 0x06	; \n\t"	// ocrd = 0x06                        //    1
3356:main.c        **** 	  "nop				; \n\t"  // one delay...							  //    1
3357:main.c        ****   "end_%=:"
3358:main.c        **** 
3359:main.c        **** 	  : "=r" (ocrd)      //Output only "%0"
3360:main.c        **** 	  : "r"  (colorVal)  //colorVal is "%1"
3361:main.c        **** 	  //,  "d0"  (ocrd)     //ocrd is also used for andi, and is %2
3362:main.c        **** 	);
3363:main.c        **** 
3364:main.c        **** 
3365:main.c        **** //	OCR1D = ocrd;
3366:main.c        **** 
3367:main.c        **** 
3368:main.c        **** 	//   Green: (/OC1B => RX1-)          (B1,0 Active, as well as G2,1)
3369:main.c        **** 	//    Off (6/63): DTL1 = 0
3370:main.c        **** 	//    38-39/63:      DTL1 = 1
3371:main.c        **** 	//    62-63/63:      DTL1 = 3
3372:main.c        **** /*	switch(colorVal & 0x0C)
3373:main.c        **** 	{
3374:main.c        **** 		case 0x00:
3375:main.c        **** 			DT1 = 0;
3376:main.c        **** 			break;
3377:main.c        **** 		case 0x04:
3378:main.c        **** 			DT1 = 1;
3379:main.c        **** 			break;
3380:main.c        **** 		case 0x08:
3381:main.c        **** 		default:
3382:main.c        **** 			DT1 = 3;
3383:main.c        **** 			break;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 82


3384:main.c        **** 	}
3385:main.c        **** */
3386:main.c        **** //	uint8_t greenVal = colorVal & 0x0C;
3387:main.c        **** 	uint8_t dt;
3388:main.c        **** /*	if(greenVal == 0x00)
3389:main.c        **** 		dt=0;
3390:main.c        **** 	else if(greenVal == 0x04)
3391:main.c        **** 		dt=1;
3392:main.c        **** 	else //0x06, 0x0C
3393:main.c        **** 		dt=3;
3394:main.c        **** */
3395:main.c        ****    //Each branch is 9 cycles... (12 with FOUR_SHADES)
3396:main.c        **** __asm__ __volatile__
3397:main.c        ****    ( "mov   %0, %1   ; \n\t"  // dt (greenVal) = colorVal           //1
3398:main.c        ****      "andi  %0, 0x0C ; \n\t"  // dt = dt & 0x0C                     //1
3399:main.c        ****      "brne  grn4tst_%=; \n\t" // if(dt != 0x00) jump to grn4test    //1`2
3400:main.c        ****      "ldi   %0, 0x00 ; \n\t"  // (dt==0x00) add some delays         //1 .
3401:main.c        ****      "nop            ; \n\t"  //                                    //1 .
3402:main.c        ****      "nop            ; \n\t"  //                                    //1 .
3403:main.c        ****      "nop            ; \n\t"  //                                    //1 .
3404:main.c        ****      FOUR_SHADES_NOPS         //                                    //N .
3405:main.c        **** 	  "rjmp  end_%=   ; \n\t"  //   jump to the end                  //2 .
3406:main.c        ****    "grn4tst_%=:"              //"%=" is a unique identifier for this asm.
3407:main.c        ****                               //  invocation, so the label won't be     .
3408:main.c        ****                               //  mistaken from another invocation      .
3409:main.c        ****      "cpi   %0, 0x04 ; \n\t"  // if(dt-0x04 != 0)                   //  1
3410:main.c        ****      "brne  grn8C_%= ; \n\t"  //   jump to green=8,C                //  1`2
3411:main.c        ****      "ldi   %0, 0x01 ; \n\t"  // else dt = 0x01                     //  1 .
3412:main.c        ****      FOUR_SHADES_NOPS         //                                    //  N .
3413:main.c        **** 	  "rjmp  end_%=   ; \n\t"  //      jump to the end               //  2 .
3414:main.c        ****    "grn8C_%=:"                                                      //    .
3415:main.c        **** #if (defined(FOUR_SHADES) && FOUR_SHADES)                           //   /.
3416:main.c        ****      "cpi   %0, 0x08 ; \n\t"  // if(dt-0x08 !=0)                    //( . 1
3417:main.c        ****      "brne  grn3_%=  ; \n\t"  //    jump to green=3                 //( . 1`2
3418:main.c        ****      "ldi   %0, 0x02 ; \n\t"  // else dt=2                          //( . 1 .
3419:main.c        ****      "rjmp  end_%=   ; \n\t"  //      jump to the end               //( . 2 .
3420:main.c        ****    "grn3_%=:"                                                       //( .   /
3421:main.c        **** #endif                                                              //(  \ /
3422:main.c        ****      "ldi   %0, 0x03 ; \n\t"  // dt = 0x03                          //    1
3423:main.c        ****      "nop            ; \n\t"  // one delay...                       //    1
3424:main.c        ****    "end_%=:"
3425:main.c        **** 
3426:main.c        ****      : "=r" (dt)      //Output only "%0"
3427:main.c        ****      : "r"  (colorVal)  //colorVal is "%1"
3428:main.c        ****      //,  "d0"  (ocrd)     //ocrd is also used for andi, and is %2
3429:main.c        ****    );
3430:main.c        **** 
3431:main.c        **** 
3432:main.c        **** 
3433:main.c        **** //	DT1 = dt;
3434:main.c        **** 	//   Blue: (+OC1A => RX2+)               (B3,2 Active from here down)
3435:main.c        **** 	//    Off (15/63):  OCR1A=4
3436:main.c        **** 	//    47/63:        OCR1A=5
3437:main.c        **** 	//    63/63:        OCR1A=6
3438:main.c        **** /*	switch(colorVal & 0x30)
3439:main.c        **** 	{
3440:main.c        **** 		case 0x00:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 83


3441:main.c        **** 			OCR1A = 4;
3442:main.c        **** 			break;
3443:main.c        **** 		case 0x10:
3444:main.c        **** 			OCR1A = 5;
3445:main.c        **** 			break;
3446:main.c        **** 		case 0x20:
3447:main.c        **** 		default:
3448:main.c        **** 			OCR1A = 6;
3449:main.c        **** 			break;
3450:main.c        **** 	}
3451:main.c        **** */
3452:main.c        **** //	uint8_t blueVal = colorVal & 0x30;
3453:main.c        **** 	uint8_t ocra;
3454:main.c        **** /*	if(blueVal == 0x00)
3455:main.c        **** 		ocra=4;
3456:main.c        **** 	else if(blueVal == 0x10)
3457:main.c        **** 		ocra=5;
3458:main.c        **** 	else //0x20, 0x30
3459:main.c        **** 		ocra=6;
3460:main.c        **** */
3461:main.c        **** 
3462:main.c        ****    //Each branch is 9 cycles...
3463:main.c        **** __asm__ __volatile__
3464:main.c        ****    ( "mov   %0, %1   ; \n\t"  // ocra (blueVal) = colorVal          //1
3465:main.c        ****      "andi  %0, 0x30 ; \n\t"  // ocra = ocra & 0x30                 //1
3466:main.c        ****      "brne  blu1tst_%=; \n\t" // if(ocra != 0x00) jump to red1test  //1`2
3467:main.c        ****      "ldi   %0, 0x04 ; \n\t"  // (ocra==0x00) add some delays       //1 .
3468:main.c        ****      "nop            ; \n\t"  //                                    //1 .
3469:main.c        ****      "nop            ; \n\t"  //                                    //1 .
3470:main.c        ****      "nop            ; \n\t"  //                                    //1 .
3471:main.c        ****      "rjmp  end_%=   ; \n\t"  //   jump to the end                  //2 .
3472:main.c        ****                               // (ocra_reg = blueVal_reg = 0)            .
3473:main.c        ****    "blu1tst_%=:"              //"%=" is a unique identifier for this asm.
3474:main.c        ****                               //  invocation, so the label won't be     .
3475:main.c        ****                               //  mistaken from another invocation      .
3476:main.c        ****      "cpi   %0, 0x10 ; \n\t"  // if(ocra-0x10 != 0)                 //  1
3477:main.c        ****      "brne  blu23_%= ; \n\t"  //   jump to red=2,3                  //  1`2
3478:main.c        ****      "ldi   %0, 0x05 ; \n\t"  // else ocra = 0x05                   //  1 .
3479:main.c        ****      "rjmp  end_%=   ; \n\t"  //      jump to the end               //  2 .
3480:main.c        ****    "blu23_%=:"                                                      //    .
3481:main.c        ****      "ldi   %0, 0x06 ; \n\t"  // ocra = 0x06                        //    1
3482:main.c        ****      "nop            ; \n\t"  // one delay...                       //    1
3483:main.c        ****    "end_%=:"
3484:main.c        **** 
3485:main.c        ****      : "=r" (ocra)      //Output only "%0"
3486:main.c        ****      : "r"  (colorVal)  //colorVal is "%1"
3487:main.c        ****      //,  "d0"  (ocra)     //ocra is also used for andi, and is %2
3488:main.c        ****    );
3489:main.c        **** 
3490:main.c        **** #endif //SETTING vs. FRAMEBUFFER
3491:main.c        **** 
3492:main.c        **** 	DT1 = dt;
3493:main.c        **** 	OCR1D = ocrd;
3494:main.c        **** 	OCR1A=ocra;
3495:main.c        **** }
3496:main.c        **** 
3497:main.c        **** #if(defined(IMAGE_BUFFER) && IMAGE_BUFFER)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 84


3498:main.c        **** void setColor(uint8_t red, uint8_t green, uint8_t blue, 
3499:main.c        **** 					uint8_t row, uint8_t col)
3500:main.c        **** {
3501:main.c        **** 	red = (red > 3) ? 3 : red;
3502:main.c        **** 	green = (green > 3) ? 3 : green;
3503:main.c        **** 	blue = (blue > 3) ? 3 : blue;
3504:main.c        **** 
3505:main.c        **** 	frameBuffer[row][col] = red | ((green)<<2) | ((blue)<<4);
3506:main.c        **** }
3507:main.c        **** #endif
3508:main.c        **** 
3509:main.c        **** /*
3510:main.c        **** void setBlue(uint8_t val, uint8_t r, uint8_t c)
3511:main.c        **** {
3512:main.c        **** 	//Each If statement consists of (rougly):
3513:main.c        **** 	//  comparison (cpi)
3514:main.c        **** 	//  jump if false to next (brcs)
3515:main.c        **** 	//    load immediate -> register
3516:main.c        **** 	//    out OCR1a <- register
3517:main.c        **** 	//    load immediate -> register
3518:main.c        **** 	//    out DT1 <- register
3519:main.c        **** 	//    jump to end of If's...
3520:main.c        **** 
3521:main.c        **** 	//THUS: the brighter the color, the fewer cycles are executed
3522:main.c        **** 	// (fewer comparisons, fewer jumps)
3523:main.c        **** 	
3524:main.c        **** 	// One option: insert NOPs...
3525:main.c        **** 	// Another option (and probably better all 'round):
3526:main.c        **** 	//   Store the OCR1A and DT1 values in the settingBuffer
3527:main.c        **** 	//   instead of storing the color value
3528:main.c        **** 	//   (IOW: do this test when writing the "settingBuffer"
3529:main.c        **** 	//    instead of when reading)
3530:main.c        **** 	//   Then, here, just write OCR1A and DT1
3531:main.c        **** 	//   If a single-byte is used for both, DT1 could be written directly
3532:main.c        **** 	//     e.g. blueSetting=(DTVal<<4) | OCR1AVal
3533:main.c        **** 	//     DT1 = blueSetting; //OK since /OCR1n outputs are unused
3534:main.c        **** 	//     OCR1A = (blueSetting & 0x0f);
3535:main.c        **** 
3536:main.c        **** 
3537:main.c        **** 
3538:main.c        ****    // | (val & GREEN_SETTING_BIT)  is a hack a/o v20, for GREEN
3539:main.c        ****    uint8_t green =
3540:main.c        ****       getbit(GREEN_BLUEVAL_BIT, val) ? (1<<GREEN_SETTING_BIT) : 0 ;
3541:main.c        ****    uint8_t red =
3542:main.c        ****       getbit(RED_BLUEVAL_BIT, val) ? (1<<RED_SETTING_BIT) : 0 ;
3543:main.c        **** 
3544:main.c        ****    uint8_t redGreen = green | red;
3545:main.c        **** 
3546:main.c        **** 
3547:main.c        **** 
3548:main.c        **** #if(defined(DC_DE_DISABLE) && DC_DE_DISABLE)
3549:main.c        **** // #define NUM_BLUES 5		//Currently Unused... (not including black)
3550:main.c        **** #else
3551:main.c        **** // #define NUM_BLUES 6		//Currently Unused... (not including black)
3552:main.c        **** 
3553:main.c        **** 	if(val>=(60<<2)) 
3554:main.c        **** 	{
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 85


3555:main.c        **** 		//OCR1A = 0xff;
3556:main.c        **** 		settingBuffer[r][c] = (0<<4) | 6 | redGreen;
3557:main.c        **** 	}
3558:main.c        **** 	else
3559:main.c        **** #endif
3560:main.c        **** 	if(val >= (44<<2))
3561:main.c        **** 	{
3562:main.c        **** 		//OCR1A = 5;
3563:main.c        **** 		//DT1 = (0<<4);
3564:main.c        **** 		settingBuffer[r][c] = (0<<4) | 5 | redGreen;
3565:main.c        **** 	}
3566:main.c        **** #if (!defined(DT0_BLUES_ONLY) || !DT0_BLUES_ONLY)
3567:main.c        **** 	else if(val >= (36<<2)) //OK
3568:main.c        **** 	{
3569:main.c        **** 		//OCR1A = 5;
3570:main.c        **** 		//DT1 = (1<<4);
3571:main.c        **** 		settingBuffer[r][c] = (1<<4) | 5 | redGreen;
3572:main.c        **** 	}
3573:main.c        **** 	else if(val >= (32<<2)) //OK
3574:main.c        **** 	{
3575:main.c        **** 		//DT1=(2<<4);
3576:main.c        **** 		//OCR1A = 5;
3577:main.c        **** 		settingBuffer[r][c] = (2<<4) | 5 | redGreen;
3578:main.c        **** 	}
3579:main.c        **** 	else if(val >= (12<<2)) //DIM
3580:main.c        **** #else //DT0_BLUES_ONLY
3581:main.c        **** 	else //Closest to black we can get with DT=0
3582:main.c        **** #endif
3583:main.c        **** 	{
3584:main.c        **** 		//DT1=(0<<4);
3585:main.c        **** 		//OCR1A = 4;
3586:main.c        **** 		settingBuffer[r][c] = (0<<4) | 4 | redGreen;
3587:main.c        **** 	}
3588:main.c        **** #if (!defined(DT0_BLUES_ONLY) || !DT0_BLUES_ONLY)
3589:main.c        **** 	else if(val >= (4<<2)) //DIM
3590:main.c        **** 	{
3591:main.c        **** 		//DT1=(1<<4);
3592:main.c        **** 		//OCR1A = 4;
3593:main.c        **** 		settingBuffer[r][c] = (1<<4) | 4 | redGreen;
3594:main.c        **** 	}
3595:main.c        **** 	else	//Black
3596:main.c        **** 	{
3597:main.c        **** 		//DT1=(2<<4);
3598:main.c        **** 		//OCR1A = 4;
3599:main.c        **** 		settingBuffer[r][c] = (2<<4) | 4 | redGreen;
3600:main.c        **** 	}
3601:main.c        **** #endif
3602:main.c        **** }
3603:main.c        **** */
3604:main.c        **** 
3605:main.c        **** /*
3606:main.c        **** static __inline__ \
3607:main.c        **** void drawPix(uint8_t rowNum) \
3608:main.c        **** 	  __attribute__((__always_inline__));
3609:main.c        **** */
3610:main.c        **** #if (!defined(ROW_SEG_BUFFER) || !ROW_SEG_BUFFER)
3611:main.c        **** void drawPix(uint8_t rowNum)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 86


3612:main.c        **** {
3613:main.c        **** 	//uint8_t *setting = &(settingBuffer[rowNum][0]);
3614:main.c        **** #if(defined(ROW_BUFFER) && ROW_BUFFER)
3615:main.c        **** 	uint8_t *color = &(rowBuffer[0]);
3616:main.c        **** #else
3617:main.c        **** 	uint8_t *color = &(frameBuffer[rowNum][0]);
3618:main.c        **** #endif
3619:main.c        **** 	/*
3620:main.c        ****       DEonly_fromNada();
3621:main.c        ****       //Enable complementary-output for Green (on /OC1B, where CLK is OC1B)
3622:main.c        ****       TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
3623:main.c        ****                | (0<<COM1B1) | (1<<COM1B0)
3624:main.c        ****                | (1<<PWM1A) | (1<<PWM1B) );
3625:main.c        **** 	*/
3626:main.c        **** 		//The Greenish-bar on the left is due to the time it takes to execute
3627:main.c        **** 		// the first writeColor (since its value is only written at the END)
3628:main.c        **** 		// Thus the greenish-bar is about one write-color wide...
3629:main.c        **** 
3630:main.c        **** 	//Judging by some weird experiences re v21/22,
3631:main.c        **** 	// it's not entirely likely this will be predictable
3632:main.c        **** 	// it may try to recalculate the Z register between writeBlues...
3633:main.c        **** 	// hopefully not, for now. I should probably assemblify this
3634:main.c        **** 		writeColor(*(color+0));
3635:main.c        **** 
3636:main.c        **** 		//Moving this here not only removes (most of) the green bar
3637:main.c        **** 		// but also seems to make the pixel edges significantly sharper
3638:main.c        **** 		// (v29 has ~1/8in of noise, v30 has ~1pixel noise at the right edge)
3639:main.c        **** 		TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
3640:main.c        **** 		         | (0<<COM1B1) | (1<<COM1B0)
3641:main.c        **** 		         | (1<<PWM1A) | (1<<PWM1B) );
3642:main.c        **** 
3643:main.c        **** 		writeColor(*(color+1));	 
3644:main.c        **** 		writeColor(*(color+2));	 
3645:main.c        **** 		writeColor(*(color+3)); 
3646:main.c        **** 		writeColor(*(color+4));	 
3647:main.c        **** 		writeColor(*(color+5));					 
3648:main.c        **** 		writeColor(*(color+6));  
3649:main.c        **** 		writeColor(*(color+7));                         
3650:main.c        **** 		writeColor(*(color+8));                         
3651:main.c        **** 		writeColor(*(color+9));                         
3652:main.c        **** 		writeColor(*(color+10));                         
3653:main.c        **** 		writeColor(*(color+11));                         
3654:main.c        **** 		writeColor(*(color+12));                         
3655:main.c        **** 		writeColor(*(color+13));                         
3656:main.c        **** 		writeColor(*(color+14));                         
3657:main.c        **** 		writeColor(*(color+15));   
3658:main.c        **** #define COLORS_WRITTEN	16		
3659:main.c        **** #if ( (defined(COLOR_BAR_SCROLL) && COLOR_BAR_SCROLL) \
3660:main.c        **** 	|| (defined(ROW_BUFFER) && (ROW_BUFFER)) )
3661:main.c        **** 		writeColor(*(color+16));
3662:main.c        **** 		writeColor(*(color+17));
3663:main.c        **** 		writeColor(*(color+18));
3664:main.c        **** 		writeColor(*(color+19));
3665:main.c        **** writeColor(*(color+20));
3666:main.c        **** writeColor(*(color+21));
3667:main.c        **** writeColor(*(color+22));
3668:main.c        **** writeColor(*(color+23));
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 87


3669:main.c        **** writeColor(*(color+24));
3670:main.c        **** writeColor(*(color+25));
3671:main.c        **** writeColor(*(color+26));
3672:main.c        **** writeColor(*(color+27));
3673:main.c        **** #define COLORS_WRITTEN	28
3674:main.c        **** #if (defined(ROW_BUFFER) && (ROW_BUFFER))
3675:main.c        **** writeColor(*(color+28));
3676:main.c        **** writeColor(*(color+29));
3677:main.c        **** writeColor(*(color+30));
3678:main.c        **** writeColor(*(color+31));
3679:main.c        **** //Some sort of syncing problem after 32... (?)
3680:main.c        **** 
3681:main.c        **** writeColor(*(color+32));
3682:main.c        **** writeColor(*(color+33));
3683:main.c        **** writeColor(*(color+34));
3684:main.c        **** writeColor(*(color+35));
3685:main.c        **** writeColor(*(color+36));
3686:main.c        **** writeColor(*(color+37));
3687:main.c        **** writeColor(*(color+38));
3688:main.c        **** writeColor(*(color+39));
3689:main.c        **** writeColor(*(color+40));
3690:main.c        **** writeColor(*(color+41));
3691:main.c        **** writeColor(*(color+42));
3692:main.c        **** writeColor(*(color+43));
3693:main.c        **** writeColor(*(color+44));
3694:main.c        **** writeColor(*(color+45));
3695:main.c        **** writeColor(*(color+46));
3696:main.c        **** writeColor(*(color+47));
3697:main.c        **** writeColor(*(color+48));
3698:main.c        **** writeColor(*(color+49));
3699:main.c        **** writeColor(*(color+50));
3700:main.c        **** writeColor(*(color+51));
3701:main.c        **** writeColor(*(color+52));
3702:main.c        **** writeColor(*(color+53));
3703:main.c        **** writeColor(*(color+54));
3704:main.c        **** writeColor(*(color+55));
3705:main.c        **** writeColor(*(color+56));
3706:main.c        **** writeColor(*(color+57));
3707:main.c        **** writeColor(*(color+58));
3708:main.c        **** writeColor(*(color+59));
3709:main.c        **** writeColor(*(color+60));
3710:main.c        **** writeColor(*(color+61));
3711:main.c        **** writeColor(*(color+62));
3712:main.c        **** writeColor(*(color+63));
3713:main.c        **** // WriteColor writes the pixel *after* the calculations...
3714:main.c        **** // thus the pixel appears basically after writeColor completes
3715:main.c        **** // These nops assure the 64th pixel is fully-displayed before exitting
3716:main.c        **** // (Not sure how the other following instructions apply to this)
3717:main.c        **** // The number of nops was found experimentally...
3718:main.c        **** asm("nop");
3719:main.c        **** asm("nop");
3720:main.c        **** asm("nop");
3721:main.c        **** asm("nop");
3722:main.c        **** asm("nop");
3723:main.c        **** asm("nop");
3724:main.c        **** asm("nop");
3725:main.c        **** asm("nop");
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 88


3726:main.c        **** //count "0" below, as well..
3727:main.c        **** #define COLORS_WRITTEN 65
3728:main.c        **** #endif //ROW_BUFFER
3729:main.c        **** #else
3730:main.c        **** //	writeColor(0);
3731:main.c        **** #endif //COLOR_BARS || ROW_BUFFER
3732:main.c        **** 
3733:main.c        **** /*		reg[17] = colorBuffer[rowNum][17];                         
3734:main.c        **** 		writeColor(reg[17]);                         
3735:main.c        **** 		...
3736:main.c        **** 		reg[20] = colorBuffer[rowNum][20];                         
3737:main.c        **** 		writeColor(reg[20]);  
3738:main.c        **** 		
3739:main.c        **** 		//REPEATING to fill screen... (delayDots = 342 worked prior to this)
3740:main.c        **** 		reg[0] = colorBuffer[rowNum][0];
3741:main.c        **** 		writeColor(reg[0]);
3742:main.c        **** 		...
3743:main.c        **** 		reg[10] = colorBuffer[rowNum][10];
3744:main.c        **** 		writeColor(reg[10]);
3745:main.c        **** */
3746:main.c        **** 		//Display the rest as black...
3747:main.c        **** 		writeColor(0);
3748:main.c        **** 		//writeColor(0xff);
3749:main.c        **** 	  	//delay_Dots(500);//142); //Don't want to disable DE too early...	
3750:main.c        **** 		//900 leaves a buffer for various calculations while also showing
3751:main.c        **** 		// a blue bar at the right-side...
3752:main.c        **** 		//LTN Last Used 900
3753:main.c        **** 		// -68 is from 900's intent, IIRC
3754:main.c        **** 		//  seems arbitrary, but its value (especially if too small)
3755:main.c        **** 		// causes blank lines... (?!)
3756:main.c        **** 		// -60 makes more sense for a delay (was the original post-900)
3757:main.c        **** 		//  (outside DOTS_TO_CYC because it's for cycles used for calcs...
3758:main.c        **** 		// -68 worked for LVDS_PRE=2
3759:main.c        **** 		// -60 for 1
3760:main.c        **** 		// 4 doesn't work... blue-lines
3761:main.c        **** 
3762:main.c        **** #else		//ROW_SEG_BUFFER
3763:main.c        **** void drawPix(uint8_t rowNum)
3764:main.c        **** {
3765:main.c        **** 	TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
3766:main.c        **** 	         | (0<<COM1B1) | (1<<COM1B0)
3767:main.c        **** 	         | (1<<PWM1A) | (1<<PWM1B) );
3768:main.c        **** 
3769:main.c        **** 		drawSegs();
3770:main.c        **** 
3771:main.c        **** #if (defined(GB_COMBINED) && GB_COMBINED)
3772:main.c        ****  #define WRITE_COLOR_CYCS 20
3773:main.c        **** #else
3774:main.c        ****  #define WRITE_COLOR_CYCS 16
3775:main.c        **** #endif
3776:main.c        **** #define COLORS_WRITTEN	64
3777:main.c        **** 
3778:main.c        **** #endif
3779:main.c        **** 
3780:main.c        **** 
3781:main.c        **** 
3782:main.c        **** #define ROW_COMPLETION_DELAY \
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 89


3783:main.c        **** 		(DOTS_TO_CYC(DE_ACTIVE_DOTS) -60  \
3784:main.c        **** 		 - WRITE_COLOR_CYCS * COLORS_WRITTEN)
3785:main.c        **** /*
3786:main.c        **** 
3787:main.c        **** #error "should add SEG_STRETCH here..."
3788:main.c        **** #if (ROW_COMPLETION_DELAY > 0)
3789:main.c        **** 		delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS) -60 // - 68)// - 60
3790:main.c        **** 				- WRITE_COLOR_CYCS*COLORS_WRITTEN);
3791:main.c        **** #else
3792:main.c        **** #warning "ROW_COMPLETION_DELAY <= 0"
3793:main.c        **** #endif
3794:main.c        **** */		//DE->Nada transition expects fullBlue...
3795:main.c        **** 		//Also helps to show the edge of the DE timing...
3796:main.c        **** 
3797:main.c        **** 		//!!! Not sure what the state is at this point...
3798:main.c        **** 		// could be any DE+Blue level, or could be NADA...
3799:main.c        **** 		// Nada: DT1=3, still leaves one bit for clocking, might be OK
3800:main.c        ****          
3801:main.c        **** 		//Among the things that don't make sense...
3802:main.c        **** 		// This appears to go into affect BEFORE delay_cyc (?)
3803:main.c        **** 		// as, without a pull-up resistor on the /OC1B output, 
3804:main.c        **** 		// green seems to be floating between the last pixel and the
3805:main.c        **** 		// delay_cyc (!)
3806:main.c        **** 		//Disable complementary-output for Green 
3807:main.c        **** 		//  (on /OC1B, where CLK is OC1B)
3808:main.c        **** 		// Since Nada, V, and H DT's might be bad for clocking.
3809:main.c        **** 		TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
3810:main.c        ****          | (1<<COM1B1) | (0<<COM1B0)
3811:main.c        ****          | (1<<PWM1A) | (1<<PWM1B) );
3812:main.c        **** 
3813:main.c        **** 		fullBlue();
3814:main.c        **** 		Nada_fromDEonly();
3815:main.c        **** }
3816:main.c        **** 
3817:main.c        **** #if 0   //in LCDStuff...
3818:main.c        **** // SCOPING has been removed in LVDS, revisit LCDdirect50
3819:main.c        **** //#else //NOT SCOPING
3820:main.c        **** void loadData(uint16_t rowNum, uint8_t dataEnable)
3821:main.c        **** {
3822:main.c        **** 	//H Active pulse...
3823:main.c        ****    if(vSync)
3824:main.c        ****    {
3825:main.c        **** 		//Vsync_fromNada() is called at the end of the last interupt
3826:main.c        ****       VplusH_fromVsync();
3827:main.c        ****       Hlow_Delay();
3828:main.c        ****       Vsync_fromVplusH();
3829:main.c        ****       HD_Delay();
3830:main.c        ****    }
3831:main.c        ****    else
3832:main.c        ****    {
3833:main.c        ****       Hsync_fromNada();
3834:main.c        ****       Hlow_Delay();
3835:main.c        ****       Nada_fromHsync();
3836:main.c        ****       HD_Delay();
3837:main.c        ****    }
3838:main.c        **** 
3839:main.c        ****    if(dataEnable)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 90


3840:main.c        ****    {
3841:main.c        **** 
3842:main.c        **** /* WTF, how did this work?! Am I not using drawPix?!
3843:main.c        **** 	Yes, but drawPix calls drawSegs, which doesn't have an argument
3844:main.c        **** 	because loadRow takes the row argument elsewhere, drawSegs just
3845:main.c        **** 	draws 'em
3846:main.c        **** 		//#warning "see 'shouldBe' here..."
3847:main.c        **** 		//Should be:
3848:main.c        **** 		rowNum = rowNum*FB_HEIGHT/V_COUNT;
3849:main.c        **** 		//rowNum = rowNum / (768/FB_HEIGHT);
3850:main.c        **** */
3851:main.c        **** 
3852:main.c        **** 		//DEonly_fromNada();
3853:main.c        ****       drawPix(rowNum);
3854:main.c        **** 		//Nada_init();
3855:main.c        **** //#warning "THIS ISN'T SAFE"
3856:main.c        **** //		Nada_fromDEonly();
3857:main.c        **** //#endif
3858:main.c        **** 
3859:main.c        **** 	}
3860:main.c        **** }
3861:main.c        **** #endif
3862:main.c        **** /* These are old tests from above, under if(dataEnable)
3863:main.c        **** 	They should all be implemented in lcdStuff.c, but have not been
3864:main.c        **** 	retested since...
3865:main.c        **** #if(defined(BLUE_DIAG_BAR) && BLUE_DIAG_BAR)
3866:main.c        **** 		uint16_t blueCyc = DOTS_TO_CYC(rowNum);
3867:main.c        **** 		uint16_t notBlueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS)-blueCyc;
3868:main.c        **** 		
3869:main.c        **** 		DEonly_fromNada();
3870:main.c        **** 		delay_cyc(notBlueCyc);
3871:main.c        **** 		DEblue_fromDEonly();
3872:main.c        **** 		delay_cyc(blueCyc);
3873:main.c        **** 
3874:main.c        **** 		Nada_fromDEblue();
3875:main.c        **** #elif(defined(BLUE_VERT_BAR) && BLUE_VERT_BAR)
3876:main.c        **** 		DEonly_fromNada();
3877:main.c        **** 		delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)/3);
3878:main.c        **** 		DEblue_fromDEonly();
3879:main.c        **** 		delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)*2/3);
3880:main.c        **** 		Nada_fromDEblue();
3881:main.c        **** #elif(defined(DE_BLUE) && DE_BLUE)
3882:main.c        **** 		DEblue_fromNada();
3883:main.c        **** 		delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS));
3884:main.c        **** 		Nada_fromDEblue();
3885:main.c        **** #else  //NOT BLUE_DIAG_BAR, BLUE_VERT_BAR, NOR DE_BLUE
3886:main.c        ****  #if ( defined(COLOR_BAR_SCROLL) && COLOR_BAR_SCROLL)
3887:main.c        **** 		if(rowNum <= 256)
3888:main.c        **** 			rowNum=0;
3889:main.c        **** 		else
3890:main.c        **** 			rowNum=1;
3891:main.c        ****  #else //NOT COLOR_BAR_SCROLL... drawPix...
3892:main.c        **** */
3893:main.c        **** 
3894:main.c        **** //Moved Above
3895:main.c        **** //Called as: pgm_readImageByte(pgm_image1, row, col)
3896:main.c        **** //#define pgm_readImageByte(image, row, col)	\
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 91


3897:main.c        **** //	pgm_read_byte((uint8_t *)(&((image)[(row)*FB_WIDTH+(col)])))
3898:main.c        **** 
3899:main.c        **** #if( !defined(COLOR_BAR_SCROLL) || !COLOR_BAR_SCROLL)
3900:main.c        **** #if ( (FB_WIDTH != 16) || (FB_HEIGHT != 16) )
3901:main.c        ****  #error "image1 dimensions don't match FB_HEIGHT/WIDTH"
3902:main.c        ****  #error "It's likely I just need to create a specific DRAWIMAGE definition and tests"
3903:main.c        **** #endif
3904:main.c        **** 
3905:main.c        **** #define RED_IMAGEVAL_BIT 0
3906:main.c        **** #define GREEN_IMAGEVAL_BIT 1
3907:main.c        **** #define BLUE_IMAGEVAL_BIT 2
3908:main.c        **** 
3909:main.c        **** /*
3910:main.c        **** #define _R	0x03
3911:main.c        **** #define _O	0x07
3912:main.c        **** #define _G 0x0C
3913:main.c        **** #define _B 0x30
3914:main.c        **** #define _V 0x13
3915:main.c        **** #define _Y	0x0F
3916:main.c        **** #define _C 0x3C
3917:main.c        **** #define _M	0x33
3918:main.c        **** #define _K	0x00
3919:main.c        **** #define _W 0x3F
3920:main.c        **** #define _r 0x01
3921:main.c        **** #define _g 0x04
3922:main.c        **** #define _b 0x10
3923:main.c        **** #define _c 0x14
3924:main.c        **** #define _m 0x11
3925:main.c        **** #define _y 0x05
3926:main.c        **** #define _k 0x15
3927:main.c        **** #define Tr 0xC0	//Transparet
3928:main.c        **** */
3929:main.c        **** #if (TRUE || (!defined(LIFE) || !LIFE))
3930:main.c        **** uint8_t pgm_image1[256] PROGMEM =
3931:main.c        **** {
3932:main.c        **** 	Tr,Tr,Tr,Tr,Tr,_K,_K,_K,_K,_K,_K,Tr,Tr,Tr,Tr,Tr,
3933:main.c        **** 	Tr,Tr,Tr,_K,_K,_Y,_Y,_Y,_Y,_Y,_Y,_K,_K,Tr,Tr,Tr,
3934:main.c        **** 	Tr,Tr,_K,_K,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_K,_K,Tr,Tr,
3935:main.c        **** 	Tr,_K,_K,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_K,_K,Tr,
3936:main.c        **** 	Tr,_K,_Y,_Y,_Y,_K,_Y,_Y,_Y,_Y,_K,_Y,_Y,_Y,_K,Tr,
3937:main.c        **** 	_K,_Y,_Y,_Y,_K,_K,_K,_Y,_Y,_K,_K,_K,_Y,_Y,_Y,_K,
3938:main.c        **** 	_K,_Y,_Y,_Y,_Y,_K,_Y,_Y,_Y,_Y,_K,_Y,_Y,_Y,_Y,_K,
3939:main.c        **** 	_K,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_K,
3940:main.c        **** 	_K,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_K,
3941:main.c        **** 	_K,_Y,_Y,_K,_K,_Y,_Y,_Y,_Y,_Y,_Y,_K,_K,_Y,_Y,_K,
3942:main.c        **** 	_K,_Y,_Y,_Y,_K,_K,_Y,_Y,_Y,_Y,_K,_K,_Y,_Y,_Y,_K,
3943:main.c        **** 	Tr,_K,_Y,_Y,_Y,_K,_K,_K,_K,_K,_K,_Y,_Y,_Y,_K,Tr,
3944:main.c        **** 	Tr,_K,_K,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_K,_K,Tr,
3945:main.c        **** 	Tr,Tr,_K,_K,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_K,_K,Tr,Tr,
3946:main.c        **** 	Tr,Tr,Tr,_K,_K,_Y,_Y,_Y,_Y,_Y,_Y,_K,_K,Tr,Tr,Tr,
3947:main.c        **** 	Tr,Tr,Tr,Tr,Tr,_K,_K,_K,_K,_K,_K,Tr,Tr,Tr,Tr,Tr
3948:main.c        **** };
3949:main.c        **** #else
3950:main.c        **** /*uint8_t pgm_image1[256] PROGMEM =
3951:main.c        **** {  
3952:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3953:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 92


3954:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3955:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3956:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3957:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3958:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3959:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3960:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3961:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3962:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3963:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3964:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3965:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3966:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
3967:main.c        ****    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
3968:main.c        **** };
3969:main.c        **** */
3970:main.c        **** /*
3971:main.c        **** {  
3972:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,
3973:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,
3974:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,
3975:main.c        ****    _K,_K,_K,_K,_K,_R,_R,_R,_K,_K,_K,_K,_K,_K,_K,_K,
3976:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,
3977:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,
3978:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_R,_R,_K,_K,_K,
3979:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_R,_R,_K,_K,_K,
3980:main.c        ****    _K,_K,_K,_K,_R,_R,_R,_K,_K,_K,_K,_K,_K,_K,_K,_K,
3981:main.c        ****    _K,_K,_K,_K,_K,_R,_R,_R,_K,_K,_K,_K,_K,_K,_K,_K,
3982:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_R,_R,_R,_K,_K,
3983:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_R,_K,_K,_K,_K,
3984:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_R,_K,_K,_K,
3985:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,
3986:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,
3987:main.c        ****    _K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K,_K
3988:main.c        **** };
3989:main.c        **** */
3990:main.c        **** 
3991:main.c        **** 
3992:main.c        **** 
3993:main.c        **** #endif
3994:main.c        **** 
3995:main.c        **** 
3996:main.c        **** uint8_t pgm_image2[256] PROGMEM =
3997:main.c        **** {
3998:main.c        **** 	Tr,Tr,Tr,Tr,Tr,_K,_K,_K,_K,_K,_K,Tr,Tr,Tr,Tr,Tr,
3999:main.c        **** 	Tr,Tr,Tr,_K,_K,_Y,_Y,_Y,_Y,_Y,_Y,_K,_K,Tr,Tr,Tr,
4000:main.c        **** 	Tr,Tr,_K,_K,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_K,_K,Tr,Tr,
4001:main.c        **** 	Tr,_K,_K,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_K,_K,Tr,
4002:main.c        **** 	Tr,_K,_Y,_Y,_Y,_K,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_K,Tr,
4003:main.c        **** 	_K,_Y,_Y,_Y,_K,_K,_K,_Y,_Y,_K,_Y,_Y,_Y,_Y,_Y,_K,
4004:main.c        **** 	_K,_Y,_Y,_Y,_Y,_K,_Y,_Y,_Y,_Y,_K,_K,_Y,_Y,_Y,_K,
4005:main.c        **** 	_K,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_K,
4006:main.c        **** 	_K,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_Y,_K,
4007:main.c        **** 	_K,_Y,_Y,_K,_K,_Y,_Y,_Y,_Y,_Y,_Y,_K,_K,_Y,_Y,_K,
4008:main.c        **** 	_K,_Y,_Y,_Y,_K,_K,_Y,_Y,_Y,_Y,_K,_K,_Y,_Y,_Y,_K,
4009:main.c        **** 	Tr,_K,_Y,_Y,_Y,_K,_K,_K,_K,_K,_K,_Y,_Y,_Y,_K,Tr,
4010:main.c        **** 	Tr,_K,_K,_Y,_Y,_Y,_K,_R,_K,_R,_K,_Y,_Y,_K,_K,Tr,
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 93


4011:main.c        **** 	Tr,Tr,_K,_K,_Y,_Y,_K,_R,_R,_R,_K,_Y,_K,_K,Tr,Tr,
4012:main.c        **** 	Tr,Tr,Tr,_K,_K,_Y,_Y,_K,_K,_K,_Y,_K,_K,Tr,Tr,Tr,
4013:main.c        **** 	Tr,Tr,Tr,Tr,Tr,_K,_K,_K,_K,_K,_K,Tr,Tr,Tr,Tr,Tr
4014:main.c        **** };
4015:main.c        **** #endif //COLOR_BAR_SCROLL
4016:main.c        **** 
4017:main.c        **** /*
4018:main.c        **** #if (IMAGE_WIDTH == 21)
4019:main.c        **** uint8_t mainData[2][768>>5][IMAGE_WIDTH] =
4020:main.c        **** {
4021:main.c        **** 	{
4022:main.c        **** 	{6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4},
4023:main.c        **** 	{5,4,3,2,1,6,0,0,0,0,0,0,0,0,0,2,1,6,5,4,3},
4024:main.c        **** 	{4,3,2,1,0,0,0,3,3,3,3,3,3,3,0,0,0,5,4,3,4},
4025:main.c        **** 	{3,2,1,0,0,3,3,3,3,3,3,3,3,3,3,3,0,0,3,2,1},
4026:main.c        **** 	{2,1,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,1,6},
4027:main.c        **** 	{1,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,5},
4028:main.c        **** 	{6,0,3,3,3,3,3,0,3,3,3,3,0,3,3,3,3,3,3,0,4},
4029:main.c        **** 	{0,0,3,3,3,3,0,0,0,3,3,0,0,0,3,3,3,3,3,0,0},
4030:main.c        **** 	{0,3,3,3,3,3,0,0,0,3,3,0,0,0,3,3,3,3,3,3,0},
4031:main.c        **** 	{0,3,3,3,3,3,3,0,3,3,3,3,0,3,3,3,3,3,3,3,0},
4032:main.c        **** 	{0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0},
4033:main.c        **** 	{0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0},
4034:main.c        **** 	{0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0},
4035:main.c        **** 	{0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0},
4036:main.c        **** 	{0,3,3,3,3,0,0,3,3,3,3,3,3,3,0,0,3,3,3,3,0},
4037:main.c        **** 	{0,0,3,3,3,3,0,0,3,3,3,3,3,0,0,3,3,3,3,0,0},
4038:main.c        **** 	{6,0,3,3,3,3,3,0,0,0,0,0,0,0,3,3,3,3,3,0,4},
4039:main.c        **** 	{5,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,3},
4040:main.c        **** 	{4,3,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,3,2},
4041:main.c        **** 	{3,2,6,0,0,3,3,3,3,3,3,3,3,3,3,3,0,0,3,2,1},
4042:main.c        **** 	{2,1,5,5,0,0,0,3,3,3,3,3,3,3,0,0,0,3,2,1,6},
4043:main.c        **** 	{1,6,3,4,3,2,0,0,0,0,0,0,0,0,0,4,3,2,1,6,5},
4044:main.c        **** 	{6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4},
4045:main.c        **** 	{5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3}
4046:main.c        **** 	},
4047:main.c        **** 	{	
4048:main.c        **** 	{5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3},
4049:main.c        **** 	{4,3,2,1,6,5,0,0,0,0,0,0,0,0,0,1,6,5,4,3,2},
4050:main.c        **** 	{3,2,1,6,0,0,0,3,3,3,3,3,3,3,0,0,0,4,3,2,1},
4051:main.c        **** 	{2,1,6,0,0,3,3,3,3,3,3,3,3,3,3,3,0,0,2,1,6},
4052:main.c        **** 	{1,6,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,6,5},
4053:main.c        **** 	{6,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,4},
4054:main.c        **** 	{5,0,3,3,3,3,3,0,3,3,3,3,3,3,3,3,3,3,3,0,3},
4055:main.c        **** 	{0,0,3,3,3,3,0,0,0,3,3,0,3,3,3,3,3,3,3,0,0},
4056:main.c        **** 	{0,3,3,3,3,3,0,0,0,3,3,3,0,0,0,3,3,3,3,3,0},
4057:main.c        **** 	{0,3,3,3,3,3,3,0,3,3,3,3,3,3,3,3,3,3,3,3,0},
4058:main.c        **** 	{0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0},
4059:main.c        **** 	{0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0},
4060:main.c        **** 	{0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0},
4061:main.c        **** 	{0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0},
4062:main.c        **** 	{0,3,3,3,3,0,0,3,3,3,3,3,3,3,0,0,3,3,3,3,0},
4063:main.c        **** 	{0,0,3,3,3,3,0,0,3,3,3,3,3,0,0,3,3,3,3,0,0},
4064:main.c        **** 	{5,0,3,3,3,3,3,0,0,0,0,0,0,0,3,3,3,3,3,0,3},
4065:main.c        **** 	{4,0,0,3,3,3,3,3,3,0,1,0,1,0,3,3,3,3,0,0,2},
4066:main.c        **** 	{3,2,0,0,3,3,3,3,3,0,1,1,1,0,3,3,3,0,0,2,1},
4067:main.c        **** 	{2,1,6,0,0,3,3,3,3,3,0,0,0,3,3,3,0,0,2,1,6},
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 94


4068:main.c        **** 	{1,6,5,4,0,0,0,3,3,3,3,3,3,3,0,0,0,2,1,6,5},
4069:main.c        **** 	{6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,3,2,1,6,5,4},
4070:main.c        **** 	{5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3},
4071:main.c        ****    {4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2}
4072:main.c        **** 	}
4073:main.c        **** };
4074:main.c        **** #else
4075:main.c        **** 	#error
4076:main.c        **** #endif
4077:main.c        **** */
4078:main.c        **** 
4079:main.c        **** 
4080:main.c        **** int main(void)
4081:main.c        **** {
4082:main.c        **** 
4083:main.c        **** #if(defined(SEG_RACER) && SEG_RACER)
4084:main.c        **** 	adc_takeInput(6);
4085:main.c        **** 	adc_init();
4086:main.c        **** 	adc_select(6);
4087:main.c        **** #endif
4088:main.c        **** 
4089:main.c        **** 	tetInit(7);
4090:main.c        **** 
4091:main.c        **** 	init_timer0Hsync();
4092:main.c        **** 
4093:main.c        **** 	//This starts pretty late... watch out for WDT
4094:main.c        **** 	init_heartBeat();
4095:main.c        **** 
4096:main.c        **** 	setHeartRate(0);
4097:main.c        **** 
4098:main.c        **** 	lvds_timerInit();
4099:main.c        **** 
4100:main.c        **** 	//For synchronizing timer1 settings (to avoid glitches)
4101:main.c        **** 	// count the number of CPU cycles...
4102:main.c        **** 	// depending on how many cycles it takes to start this and whatnot, 
4103:main.c        **** 	// there may be an offset. But the jist is we know every 7 cycles
4104:main.c        **** 	// the timer1 reset is synchronized with the CPU instructions...
4105:main.c        **** //	OCR0A = 6;
4106:main.c        **** //	timer_setWGM(0, WGM_CLR_ON_COMPARE);
4107:main.c        **** //	timer_selectDivisor(0, CLKDIV1);
4108:main.c        **** 
4109:main.c        **** /*
4110:main.c        **** 	segPosition=0;
4111:main.c        **** 	newSeg(32, 0x06, (6<<4) | 3);
4112:main.c        **** 	newSeg(16, 0x00, (4<<4) | 0);
4113:main.c        **** 	newSeg(8, 0x06, (4<<4) | 0);
4114:main.c        **** 	newSeg(32, 0x00, (4<<4) | 3);
4115:main.c        **** 	newSeg(32, 0x06, (6<<4) | 3);
4116:main.c        **** 	segTerminate();
4117:main.c        **** */
4118:main.c        **** 
4119:main.c        **** /* I Think these were LONG AGO when Green and Red weren't implemented
4120:main.c        **** 	//For Green...
4121:main.c        **** 	// Possibly later to be reimplemented on PWM, but deadTime might inhibit
4122:main.c        **** 	setoutPORT(PA0, PORTA);
4123:main.c        **** 	setoutPORT(PA1, PORTA);
4124:main.c        **** 	//Red:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 95


4125:main.c        **** 	setoutPORT(PA2, PORTA);
4126:main.c        **** 	setoutPORT(PA3, PORTA);
4127:main.c        **** */
4128:main.c        **** 
4129:main.c        **** 
4130:main.c        **** 	// MUCH Of this is outside the screen...
4131:main.c        **** 
4132:main.c        **** #if (defined(COLOR_BAR_SCROLL) && COLOR_BAR_SCROLL)
4133:main.c        **** /*	uint8_t frameBuffer[FB_HEIGHT][FB_WIDTH] = 
4134:main.c        **** 	{ {
4135:main.c        **** 		(0<<2), 
4136:main.c        **** 			(0<<2) | (1<<RED_BLUEVAL_BIT), (0<<2) | (1<<GREEN_BLUEVAL_BIT),
4137:main.c        **** 	   	(1<<RED_BLUEVAL_BIT) | (0<<2) | (1<<GREEN_BLUEVAL_BIT),
4138:main.c        **** 		(4<<2), 
4139:main.c        **** 			(4<<2) | (1<<RED_BLUEVAL_BIT), (4<<2) | (1<<GREEN_BLUEVAL_BIT),
4140:main.c        **** 			(1<<RED_BLUEVAL_BIT) | (4<<2) | (1<<GREEN_BLUEVAL_BIT),
4141:main.c        **** 	   (12<<2), 
4142:main.c        **** 			(12<<2) | (1<<RED_BLUEVAL_BIT), (12<<2) | (1<<GREEN_BLUEVAL_BIT),
4143:main.c        **** 	   	(1<<RED_BLUEVAL_BIT) | (12<<2) | (1<<GREEN_BLUEVAL_BIT),
4144:main.c        **** 		(32<<2), 
4145:main.c        **** 			(32<<2) | (1<<RED_BLUEVAL_BIT), (32<<2) | (1<<GREEN_BLUEVAL_BIT),
4146:main.c        **** 	   	(1<<RED_BLUEVAL_BIT) | (32<<2) | (1<<GREEN_BLUEVAL_BIT),
4147:main.c        **** 		(36<<2), 
4148:main.c        **** 			(36<<2) | (1<<RED_BLUEVAL_BIT), (36<<2) | (1<<GREEN_BLUEVAL_BIT),
4149:main.c        **** 	   	(1<<RED_BLUEVAL_BIT) | (36<<2) | (1<<GREEN_BLUEVAL_BIT),
4150:main.c        **** 		(44<<2), 
4151:main.c        **** 			(44<<2) | (1<<RED_BLUEVAL_BIT), (44<<2) | (1<<GREEN_BLUEVAL_BIT),
4152:main.c        **** 	   	(1<<RED_BLUEVAL_BIT) | (44<<2) | (1<<GREEN_BLUEVAL_BIT),
4153:main.c        **** 		(60<<2),
4154:main.c        **** 	  		(60<<2) | (1<<RED_BLUEVAL_BIT), (60<<2) | (1<<GREEN_BLUEVAL_BIT),
4155:main.c        **** 			(1<<RED_BLUEVAL_BIT) | (60<<2) | (1<<GREEN_BLUEVAL_BIT)
4156:main.c        **** 	  },
4157:main.c        **** 	  {
4158:main.c        **** 		(0<<2) | (1<<RED_BLUEVAL_BIT), (4<<2) | (1<<RED_BLUEVAL_BIT),
4159:main.c        **** 	  	(12<<2) | (1<<RED_BLUEVAL_BIT), (32<<2) | (1<<RED_BLUEVAL_BIT),
4160:main.c        **** 	  	(36<<2) | (1<<RED_BLUEVAL_BIT), (44<<2) | (1<<RED_BLUEVAL_BIT),
4161:main.c        **** 		(60<<2) | (1<<RED_BLUEVAL_BIT),
4162:main.c        **** 		
4163:main.c        **** 		(0<<2) | (1<<GREEN_BLUEVAL_BIT), (4<<2) | (1<<GREEN_BLUEVAL_BIT), 
4164:main.c        **** 		(12<<2) | (1<<GREEN_BLUEVAL_BIT), (32<<2) | (1<<GREEN_BLUEVAL_BIT), 
4165:main.c        **** 		(36<<2)| (1<<GREEN_BLUEVAL_BIT), (44<<2) | (1<<GREEN_BLUEVAL_BIT),
4166:main.c        **** 		(60<<2) | (1<<GREEN_BLUEVAL_BIT), 
4167:main.c        **** 		
4168:main.c        **** 		(0<<2), (4<<2), (12<<2),(32<<2), (36<<2), (44<<2), (60<<2),
4169:main.c        **** 
4170:main.c        **** 		(0<<2) | (1<<RED_BLUEVAL_BIT) | (1<<GREEN_BLUEVAL_BIT),
4171:main.c        **** 	  	(4<<2) | (1<<RED_BLUEVAL_BIT) | (1<<GREEN_BLUEVAL_BIT),
4172:main.c        **** 		(12<<2) | (1<<RED_BLUEVAL_BIT) | (1<<GREEN_BLUEVAL_BIT),
4173:main.c        **** 	  	(32<<2) | (1<<RED_BLUEVAL_BIT) | (1<<GREEN_BLUEVAL_BIT),
4174:main.c        **** 		(36<<2) | (1<<RED_BLUEVAL_BIT) | (1<<GREEN_BLUEVAL_BIT),
4175:main.c        **** 	  	(44<<2) | (1<<RED_BLUEVAL_BIT) | (1<<GREEN_BLUEVAL_BIT),
4176:main.c        **** 		(60<<2) | (1<<RED_BLUEVAL_BIT) | (1<<GREEN_BLUEVAL_BIT)
4177:main.c        **** 
4178:main.c        ****   	  }
4179:main.c        **** 	};
4180:main.c        **** */
4181:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 96


4182:main.c        **** 
4183:main.c        **** 	//Init:
4184:main.c        **** 	uint8_t i;
4185:main.c        **** 	for(i=0; i<FB_WIDTH; i++)
4186:main.c        **** 	{
4187:main.c        **** 		uint8_t j=FB_WIDTH-1-i;
4188:main.c        **** 		setColor((i&0x03), (i&0x0C)>>2, (i&0x30)>>4, 0, i);
4189:main.c        **** 		setColor((i&0x30)>>4, (i&0x0C)>>2, (i&0x03), 1, i);
4190:main.c        **** //		setBlue(frameBuffer[0][i], 0, i);
4191:main.c        **** //		setBlue(frameBuffer[1][i], 1, i);
4192:main.c        **** 	}
4193:main.c        **** #else	//NOT COLOR_BAR_SCROLL
4194:main.c        **** 	//uint8_t frameBuffer[16][16];
4195:main.c        **** 
4196:main.c        **** 	uint8_t row,col;
4197:main.c        **** /*	for(r=0; r<FB_HEIGHT; r++)
4198:main.c        **** 	{
4199:main.c        **** 		for(c=0; c<FB_WIDTH; c++)
4200:main.c        **** 		{
4201:main.c        **** 			uint8_t imagePixel=pgm_readImageByte(pgm_image1, r, c);
4202:main.c        **** 
4203:main.c        **** 			setColor(
4204:main.c        **** 				(getbit(RED_IMAGEVAL_BIT, imagePixel) ? 0x03 : 0),
4205:main.c        **** 				(getbit(GREEN_IMAGEVAL_BIT, imagePixel) ? 0x0C : 0),
4206:main.c        **** 				(getbit(BLUE_IMAGEVAL_BIT, imagePixel) ? 0x30 : 0),
4207:main.c        **** 				r, c);
4208:main.c        **** //			setBlue(
4209:main.c        **** //					(
4210:main.c        **** //	(getbit(BLUE_IMAGEVAL_BIT, imagePixel) ? (60<<2) : 0) |
4211:main.c        **** //	(getbit(GREEN_IMAGEVAL_BIT, imagePixel) ? (1<<GREEN_BLUEVAL_BIT) : 0) |
4212:main.c        **** //	(getbit(RED_IMAGEVAL_BIT, imagePixel) ? (1<<RED_BLUEVAL_BIT) : 0)
4213:main.c        **** //					), r, c);
4214:main.c        **** 		}
4215:main.c        **** 	}
4216:main.c        **** */
4217:main.c        ****  #if (defined(IMAGE_CHANGE) && IMAGE_CHANGE)
4218:main.c        **** 	uint32_t counter=0;
4219:main.c        **** 	uint8_t imageNum = 0;
4220:main.c        **** 	uint8_t colorShift = 0;
4221:main.c        **** 	while(1)
4222:main.c        **** 	{
4223:main.c        ****  #if (defined(FRAME_SYNC) && FRAME_SYNC)
4224:main.c        **** 		if(frameCount==0 && !getbit(OCIE0A, T0_TIMSK))
4225:main.c        ****  #else
4226:main.c        **** 		if(counter==0)
4227:main.c        ****  #endif
4228:main.c        **** 		{
4229:main.c        ****  #if (defined(IMAGE_BUFFER) && IMAGE_BUFFER)
4230:main.c        **** 			uint8_t *pimage;
4231:main.c        ****  #endif
4232:main.c        **** 
4233:main.c        **** 	#if 0
4234:main.c        **** 			tetUpdate();
4235:main.c        **** 
4236:main.c        **** 			if(imageNum == 0)
4237:main.c        **** 			{
4238:main.c        **** 				imageNum = 1;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 97


4239:main.c        **** 				pimage = pgm_image1;
4240:main.c        **** 				tetColorScheme = 1;
4241:main.c        **** 			}
4242:main.c        **** 			else
4243:main.c        **** 			{
4244:main.c        **** 				hexColor++;
4245:main.c        **** 				hexColor&=0x3f;
4246:main.c        **** 				imageNum = 0;
4247:main.c        **** 				pimage = pgm_image2;
4248:main.c        **** 				tetColorScheme = 0;
4249:main.c        **** 			}
4250:main.c        **** 	#endif //0
4251:main.c        **** 
4252:main.c        ****  #if (defined(IMAGE_BUFFER) && IMAGE_BUFFER)
4253:main.c        **** 			for(row=0; row<FB_HEIGHT; row++)
4254:main.c        **** 	      for(col=0; col<FB_WIDTH; col++)
4255:main.c        **** 	      {
4256:main.c        **** 	         uint8_t imagePixel=pgm_readImageByte(pimage, row, col);
4257:main.c        **** 
4258:main.c        **** 
4259:main.c        **** 				if(imagePixel == Tr)
4260:main.c        **** 					frameBuffer[row][col] = colorShift+row+col;
4261:main.c        **** 				else
4262:main.c        **** 					frameBuffer[row][col] = imagePixel;	
4263:main.c        **** 			/*
4264:main.c        **** 	         setColor(
4265:main.c        **** 		         (getbit(RED_IMAGEVAL_BIT, imagePixel) ? 0x03 : 0),
4266:main.c        **** 	            (getbit(GREEN_IMAGEVAL_BIT, imagePixel) ? 0x0C : 0),
4267:main.c        **** 	            (getbit(BLUE_IMAGEVAL_BIT, imagePixel) ? 0x30 : 0),
4268:main.c        **** 	            r, c);
4269:main.c        **** 			*/
4270:main.c        **** 			}
4271:main.c        **** 			colorShift++;
4272:main.c        ****  #endif
4273:main.c        ****  #if (defined(LIFE) && LIFE)
4274:main.c        **** 			lifeRound();
4275:main.c        ****  #endif //LIFE
4276:main.c        ****  
4277:main.c        ****  #if (FRAME_COUNT_TO_DELAY != 0)
4278:main.c        **** 			timer_compareMatchIntEnable(0, OUT_CHANNELA);
4279:main.c        ****  #endif //FRAME_COUNT_TO_DELAY
4280:main.c        **** 		}
4281:main.c        ****  #if (!defined(FRAME_SYNC) && !FRAME_SYNC)
4282:main.c        **** 		counter+=16384;
4283:main.c        ****  #else
4284:main.c        **** 		//for LIFE testing...
4285:main.c        **** 		counter++;
4286:main.c        **** #endif
4287:main.c        **** 		heartUpdate();
4288:main.c        **** 	}
4289:main.c        ****  #else
4290:main.c        ****   #error "IMAGE_CHANGE is now required for drawPix with image..."
4291:main.c        ****  #endif
4292:main.c        **** #endif
4293:main.c        **** 
4294:main.c        **** #if (defined(PIXEL_SCROLL) && PIXEL_SCROLL)
4295:main.c        **** 	uint32_t counter=0;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 98


4296:main.c        **** 
4297:main.c        **** 	while(1)
4298:main.c        **** 	{
4299:main.c        **** 		if(counter==0)
4300:main.c        **** 		{
4301:main.c        **** 			uint8_t firstCol[2];
4302:main.c        **** 			firstCol[0] = frameBuffer[0][0];
4303:main.c        **** 			firstCol[1] = frameBuffer[1][0];
4304:main.c        **** 
4305:main.c        **** 			uint8_t i;
4306:main.c        **** 			for(i=0; i<FB_WIDTH-1; i++)
4307:main.c        **** 			{
4308:main.c        **** 				frameBuffer[0][i] = frameBuffer[0][i+1];
4309:main.c        **** 				frameBuffer[1][i] = frameBuffer[1][i+1];
4310:main.c        **** //				setBlue(frameBuffer[0][i], 0, i);
4311:main.c        **** //				setBlue(frameBuffer[1][i], 1, i);
4312:main.c        **** 			}
4313:main.c        **** 
4314:main.c        **** 			frameBuffer[0][i] = firstCol[0];
4315:main.c        **** 			frameBuffer[1][i] = firstCol[1];
4316:main.c        **** //			setBlue(frameBuffer[0][i], 0, i);
4317:main.c        **** //			setBlue(frameBuffer[1][i], 1, i);
4318:main.c        **** 		}
4319:main.c        **** 		counter+=16384;
4320:main.c        **** 		heartUpdate();
4321:main.c        **** 	}
4322:main.c        **** #else
4323:main.c        **** 	while(1)
4324:main.c        **** 	{
4325:main.c        **** 		heartUpdate();
4326:main.c        **** 	}
4327:main.c        **** #endif
4328:main.c        **** 
4329:main.c        **** }
 777               		.stabn	68,0,4329,.LM62-.LFBB5
 778               	.LM62:
 779 034e 8730      		cpi r24,lo8(7)
 780 0350 00F4      		brsh .L55
 781 0352 E82F      		mov r30,r24
 782 0354 F0E0      		ldi r31,lo8(0)
 783 0356 E050      		subi r30,lo8(-(CSWTCH.60))
 784 0358 F040      		sbci r31,hi8(-(CSWTCH.60))
 785 035a 00C0      		rjmp .L57
 786               	.L53:
 787 035c 8730      		cpi r24,lo8(7)
 788 035e 00F4      		brsh .L55
 789 0360 E82F      		mov r30,r24
 790 0362 F0E0      		ldi r31,lo8(0)
 791 0364 E050      		subi r30,lo8(-(CSWTCH.63))
 792 0366 F040      		sbci r31,hi8(-(CSWTCH.63))
 793               	.L57:
 794 0368 8081      		ld r24,Z
 795 036a 0895      		ret
 796               	.L55:
 797 036c 8FE3      		ldi r24,lo8(63)
 798               	.L52:
 799               		.stabs	"tetStuff.c",132,0,0,.Ltext3
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 99


 800               	.Ltext3:
 407:tetStuff.c    **** 	{
 408:tetStuff.c    **** 		case 0:
 409:tetStuff.c    **** 		case 1:
 410:tetStuff.c    **** 			switch(tetBrick)
 411:tetStuff.c    **** 			{
 412:tetStuff.c    **** 				case 1:
 413:tetStuff.c    **** 					return _R;
 414:tetStuff.c    **** 				case 2:
 415:tetStuff.c    **** 					return _O;
 416:tetStuff.c    **** 				case 3:
 417:tetStuff.c    **** 					return _Y;
 418:tetStuff.c    **** 				case 4:
 419:tetStuff.c    **** 					return _G;
 420:tetStuff.c    **** 				case 5:
 421:tetStuff.c    **** 					return _C;
 422:tetStuff.c    **** 				case 6:
 423:tetStuff.c    **** 					return _B;
 424:tetStuff.c    **** 				case 7:
 425:tetStuff.c    **** 					return _M;
 426:tetStuff.c    **** 				default:	//WTF???
 427:tetStuff.c    **** 					return _W;
 428:tetStuff.c    **** 			}
 429:tetStuff.c    **** 			break;
 430:tetStuff.c    **** 		default: //Shouldn't happen...
 431:tetStuff.c    **** 			// was case1 but these colors are ugly
 432:tetStuff.c    **** 			// and cause syncing problems...
 433:tetStuff.c    **** 			switch(tetBrick)
 434:tetStuff.c    **** 			{
 435:tetStuff.c    **** 				case 1:
 436:tetStuff.c    **** 					return _r;
 437:tetStuff.c    **** 				case 2:
 438:tetStuff.c    **** 					return _g;
 439:tetStuff.c    **** 				case 3:
 440:tetStuff.c    **** 					return _b;
 441:tetStuff.c    **** 				case 4:
 442:tetStuff.c    **** 					return _c;
 443:tetStuff.c    **** 				case 5:
 444:tetStuff.c    **** 					return _m;
 445:tetStuff.c    **** 				case 6:
 446:tetStuff.c    **** 					return _y;
 447:tetStuff.c    **** 				case 7:
 448:tetStuff.c    **** 					return _k;
 449:tetStuff.c    **** 				default:	//WTF
 450:tetStuff.c    **** 					return _W;
 451:tetStuff.c    **** 			}
 452:tetStuff.c    **** //		default:
 453:tetStuff.c    **** //			return 0;
 454:tetStuff.c    **** 	}
 455:tetStuff.c    **** 
 456:tetStuff.c    **** }
 801               		.stabn	68,0,456,.LM63-.LFBB5
 802               	.LM63:
 803 036e 0895      		ret
 804               		.size	tetBrick_to_fb, .-tetBrick_to_fb
 805               	.Lscope5:
 806               		.stabs	"",36,0,0,.Lscope5-.LFBB5
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 100


 807               		.stabd	78,0,0
 808               		.stabs	"segClear:F(0,15)",36,0,157,segClear
 809               	.global	segClear
 810               		.type	segClear, @function
 811               	segClear:
 812               		.stabd	46,0,0
 813               		.stabs	"rowSegBuffer.c",132,0,0,.Ltext4
 814               	.Ltext4:
   1:rowSegBuffer.c **** 
   2:rowSegBuffer.c **** 
   3:rowSegBuffer.c **** #define NUM_SEGMENTS	68//128 //68 //128//68
   4:rowSegBuffer.c **** 
   5:rowSegBuffer.c **** //Green and blue are in the same byte...
   6:rowSegBuffer.c **** // I don't think the code will compile anymore without this.
   7:rowSegBuffer.c **** // It increases the pixel calculation from 18 cycles to 20 cycles
   8:rowSegBuffer.c **** #define GB_COMBINED TRUE
   9:rowSegBuffer.c **** 
  10:rowSegBuffer.c **** // SQUARE_SEGMENTS inserts nops in the counter-loop
  11:rowSegBuffer.c **** // such that each loop takes the equivalent time as the first load/write
  12:rowSegBuffer.c **** //  of the values...
  13:rowSegBuffer.c **** // Then, each incremet of length is equivalent to one drawable-pixel
  14:rowSegBuffer.c **** // (Later, maybe, setting this FALSE would allow for LCD pixel-resolution
  15:rowSegBuffer.c **** //  down to a single pixel, with LVDS_PRESCALER, etc. BUT, the minimum 
  16:rowSegBuffer.c **** //  width of a segment would be longer, due to higher calculation time
  17:rowSegBuffer.c **** //  at the beginning)
  18:rowSegBuffer.c **** // Another benefit of SQUARE_SEGMENTS is that more distance can be
  19:rowSegBuffer.c **** //  covered in the same count... (fewer segments necessary in memory for a
  20:rowSegBuffer.c **** //  long color-segment)
  21:rowSegBuffer.c **** // Another "benefit" is that all count values can be used,
  22:rowSegBuffer.c **** //  (less testing is necessary to make sure a pixel can be added)
  23:rowSegBuffer.c **** //  (meh...)
  24:rowSegBuffer.c **** #define SQUARE_SEGMENTS TRUE
  25:rowSegBuffer.c **** 
  26:rowSegBuffer.c **** //Segments have four values:
  27:rowSegBuffer.c **** // segment length
  28:rowSegBuffer.c **** // red	(OCR)
  29:rowSegBuffer.c **** // green	(DT)
  30:rowSegBuffer.c **** // blue	(OCR)
  31:rowSegBuffer.c **** //
  32:rowSegBuffer.c **** // To save space, and no additional instruction cycles are needed,
  33:rowSegBuffer.c **** //  combine red and length
  34:rowSegBuffer.c **** //  red_length bit:  7 6 5 4 3 2 1 0
  35:rowSegBuffer.c **** //                   \__ __/ \__ __/
  36:rowSegBuffer.c **** //								V       V
  37:rowSegBuffer.c **** //                      |       Red OCR value
  38:rowSegBuffer.c **** //                      segLength
  39:rowSegBuffer.c **** 
  40:rowSegBuffer.c **** // NOW:
  41:rowSegBuffer.c **** //  red_length bit:  7 6 5 4 3 2 1 0
  42:rowSegBuffer.c **** //                   \___ ___/ \_ _/
  43:rowSegBuffer.c **** //                       V       V
  44:rowSegBuffer.c **** //                       |       Red OCR value
  45:rowSegBuffer.c **** //                       segLength
  46:rowSegBuffer.c **** // RISK:
  47:rowSegBuffer.c **** //  At one point I was considering doubling OCR/DT values
  48:rowSegBuffer.c **** //   in able to get higher resolution...
  49:rowSegBuffer.c **** //   (more CPU cycles per pixel clock)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 101


  50:rowSegBuffer.c **** //  That would require a significant overhaul
  51:rowSegBuffer.c **** //   and LVDS_PRESCALER has already helped...
  52:rowSegBuffer.c **** #define SEG_LENGTH_BITS 5
  53:rowSegBuffer.c **** 
  54:rowSegBuffer.c **** //#if (defined(SEG_LENGTH_BITS))
  55:rowSegBuffer.c ****  #define SEG_LENGTH_MASK 	((UPPER_BIT_MASK8(SEG_LENGTH_BITS)))
  56:rowSegBuffer.c **** //&0xff is necessary for an assembly operand to be 8-bits
  57:rowSegBuffer.c ****  #define RED_MASK 			(((~(SEG_LENGTH_MASK))&0xff))
  58:rowSegBuffer.c ****  #define SEG_COUNT_1			((UPPER_BIT_MASK8__COUNT_1(SEG_LENGTH_BITS)))
  59:rowSegBuffer.c ****  #define SEG_LENGTH_SHIFT	((8-(SEG_LENGTH_BITS)))
  60:rowSegBuffer.c **** //#else
  61:rowSegBuffer.c **** // #define SEG_LENGTH_MASK (0xf0)
  62:rowSegBuffer.c **** // #define RED_MASK (~(SEG_LENGTH_MASK))
  63:rowSegBuffer.c **** //#endif
  64:rowSegBuffer.c **** 
  65:rowSegBuffer.c **** 
  66:rowSegBuffer.c **** //This seems backwards, but it's not. See SQUARE_SEGMENTS notes, above
  67:rowSegBuffer.c **** #if (defined(SQUARE_SEGMENTS) && SQUARE_SEGMENTS)
  68:rowSegBuffer.c ****  #define COUNT_INCREMENT SEG_COUNT_1 //0x10
  69:rowSegBuffer.c ****  //This is the actual length, not as shifted for storage
  70:rowSegBuffer.c ****  #define SEG_MAXLENGTH	(SEG_LENGTH_MASK >> SEG_LENGTH_SHIFT)
  71:rowSegBuffer.c **** #else
  72:rowSegBuffer.c **** #error "This probably isn't implemented anymore..."
  73:rowSegBuffer.c ****  #if (defined(GB_COMBINED) && GB_COMBINED)
  74:rowSegBuffer.c ****   #define COUNT_INCREMENT (5*SEG_COUNT_1) //0x50
  75:rowSegBuffer.c ****  #else
  76:rowSegBuffer.c ****   #define COUNT_INCREMENT (4*SEG_COUNT_1) //0x40
  77:rowSegBuffer.c ****  #endif
  78:rowSegBuffer.c **** #endif
  79:rowSegBuffer.c **** 
  80:rowSegBuffer.c **** 
  81:rowSegBuffer.c **** // Similar *might* be possible with green and blue
  82:rowSegBuffer.c **** // IF we can switch DE/Blue to /OC1A
  83:rowSegBuffer.c **** //           switch Green to OC1B
  84:rowSegBuffer.c **** //           use DTH for green -> mov, andi, andi
  85:rowSegBuffer.c **** // Not sure if this is possible
  86:rowSegBuffer.c **** // Otherwise, sharing a byte for green/blue introduces
  87:rowSegBuffer.c **** //            mov, andi, and four lsrs
  88:rowSegBuffer.c **** //            mov, andi, swap, andi... maybe not so bad...?
  89:rowSegBuffer.c **** //                       only two additional cycles (since ld is two)
  90:rowSegBuffer.c **** // the benefit with red_length is killing two birds with one stone
  91:rowSegBuffer.c **** //   andi both &='s AND tests for 0...
  92:rowSegBuffer.c **** typedef struct _NONAME_
  93:rowSegBuffer.c **** {
  94:rowSegBuffer.c **** 	uint8_t red_length;	// segLength<<3 | OCR1D
  95:rowSegBuffer.c **** #if (defined(GB_COMBINED) && GB_COMBINED)
  96:rowSegBuffer.c **** 	uint8_t green_blue;	// blue<<4 | green
  97:rowSegBuffer.c **** #else
  98:rowSegBuffer.c **** 	uint8_t green;			//DT1(Low nibble)
  99:rowSegBuffer.c **** 	uint8_t blue;			//OCR1A
 100:rowSegBuffer.c **** #endif
 101:rowSegBuffer.c **** } seg_t;
 102:rowSegBuffer.c **** 
 103:rowSegBuffer.c **** 
 104:rowSegBuffer.c **** // Was thinking about loading the last segment as black, but that doesn't
 105:rowSegBuffer.c **** // work if the last segment isn't read, due to length=0...
 106:rowSegBuffer.c **** seg_t rowSegBuffer[NUM_SEGMENTS+1];/*=
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 102


 107:rowSegBuffer.c **** {
 108:rowSegBuffer.c **** 	{(4<<SEG_LENGTH_SHIFT) | 0x06, (6<<4) | 3},  //White
 109:rowSegBuffer.c ****    {(8<<SEG_LENGTH_SHIFT) | 0x00, (4<<4) | 0},  //Black
 110:rowSegBuffer.c **** 	{(16<<SEG_LENGTH_SHIFT)| 0x06, (4<<4) | 0},  //Red
 111:rowSegBuffer.c **** 	{(32<<SEG_LENGTH_SHIFT) | 0x06, (6<<4) | 3}, //White
 112:rowSegBuffer.c **** 	{0,(4<<4)}                                   //Terminate
 113:rowSegBuffer.c **** };
 114:rowSegBuffer.c **** */
 115:rowSegBuffer.c **** /*=
 116:rowSegBuffer.c **** {
 117:rowSegBuffer.c **** 	{0x10,4,6},
 118:rowSegBuffer.c **** 	{0x32,4,8},
 119:rowSegBuffer.c **** 	{0x03,5,2},
 120:rowSegBuffer.c **** 	{0x00,0,0}
 121:rowSegBuffer.c **** };
 122:rowSegBuffer.c **** */
 123:rowSegBuffer.c **** 
 124:rowSegBuffer.c **** 
 125:rowSegBuffer.c **** 
 126:rowSegBuffer.c **** //See rowBuffer.c for an explanation...
 127:rowSegBuffer.c **** // The first three will probably seldom be used
 128:rowSegBuffer.c **** // The last....
 129:rowSegBuffer.c **** #define fbBlue_to_seg(fbColor) \
 130:rowSegBuffer.c **** 		((((fbColor & 0x30) | 0x40)))
 131:rowSegBuffer.c **** 		//((((fbColor & 0x30) >> 4) | 0x04)<<4) //fixed
 132:rowSegBuffer.c **** //	   (((fbColor & 0x30) << 1) | 0x40)
 133:rowSegBuffer.c **** 
 134:rowSegBuffer.c **** #define fbGreen_to_seg(fbColor) \
 135:rowSegBuffer.c **** 	   ((fbColor & 0x0C) >> 2)
 136:rowSegBuffer.c **** 
 137:rowSegBuffer.c **** #define fbRed_to_seg(fbColor) \
 138:rowSegBuffer.c **** 	   (((fbColor & 0x03) << 1) | (fbColor & 0x01))
 139:rowSegBuffer.c **** 
 140:rowSegBuffer.c **** //This gives 'red, green_blue' pairs for arguments to newSeg, etc.
 141:rowSegBuffer.c **** // It's kinda hokey to call a three-argument function with *apparently*
 142:rowSegBuffer.c **** // only two arguments, but this'll be used probably more often than
 143:rowSegBuffer.c **** // the actual function-call...
 144:rowSegBuffer.c **** // use newSegfb(length, fbColor) 
 145:rowSegBuffer.c **** //    instead of newSeg(length, fb_to_seg(fbColor))
 146:rowSegBuffer.c **** // it's just a macro, but it makes more sense
 147:rowSegBuffer.c **** #define fb_to_seg(fbColor) \
 148:rowSegBuffer.c ****   fbRed_to_seg(fbColor), (fbBlue_to_seg(fbColor) | fbGreen_to_seg(fbColor))
 149:rowSegBuffer.c **** 
 150:rowSegBuffer.c **** //Outside of rbpix_to_seg, this corresponds with the last-written segment
 151:rowSegBuffer.c **** uint8_t segPosition = 0;
 152:rowSegBuffer.c **** 
 153:rowSegBuffer.c **** 
 154:rowSegBuffer.c **** uint8_t newSeg(uint16_t length, uint8_t red, uint8_t green_blue);
 155:rowSegBuffer.c **** uint8_t stretchSeg(uint16_t additionalLength);
 156:rowSegBuffer.c **** 
 157:rowSegBuffer.c **** void segClear(void)
 158:rowSegBuffer.c **** {
 815               		.stabn	68,0,158,.LM64-.LFBB6
 816               	.LM64:
 817               	.LFBB6:
 818               	/* prologue: function */
 819               	/* frame size = 0 */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 103


 159:rowSegBuffer.c **** 	segPosition = 0;
 820               		.stabn	68,0,159,.LM65-.LFBB6
 821               	.LM65:
 822 0370 1092 0000 		sts segPosition,__zero_reg__
 160:rowSegBuffer.c **** 	//The important part is the null-length
 161:rowSegBuffer.c **** 	// but let's load white just in case
 162:rowSegBuffer.c **** 	rowSegBuffer[segPosition].red_length = 6;
 823               		.stabn	68,0,162,.LM66-.LFBB6
 824               	.LM66:
 825 0374 86E0      		ldi r24,lo8(6)
 826 0376 8093 0000 		sts rowSegBuffer,r24
 163:rowSegBuffer.c **** 	rowSegBuffer[segPosition].green_blue = (6<<4) | 3;
 827               		.stabn	68,0,163,.LM67-.LFBB6
 828               	.LM67:
 829 037a 83E6      		ldi r24,lo8(99)
 830 037c 8093 0000 		sts rowSegBuffer+1,r24
 831               	/* epilogue start */
 164:rowSegBuffer.c **** }
 832               		.stabn	68,0,164,.LM68-.LFBB6
 833               	.LM68:
 834 0380 0895      		ret
 835               		.size	segClear, .-segClear
 836               	.Lscope6:
 837               		.stabs	"",36,0,0,.Lscope6-.LFBB6
 838               		.stabd	78,0,0
 839               		.stabs	"segTerminate:F(0,15)",36,0,168,segTerminate
 840               	.global	segTerminate
 841               		.type	segTerminate, @function
 842               	segTerminate:
 843               		.stabd	46,0,0
 165:rowSegBuffer.c **** 
 166:rowSegBuffer.c **** #define rbpix_to_segTerminate segTerminate
 167:rowSegBuffer.c **** 
 168:rowSegBuffer.c **** void segTerminate(void)
 169:rowSegBuffer.c **** {
 844               		.stabn	68,0,169,.LM69-.LFBB7
 845               	.LM69:
 846               	.LFBB7:
 847               	/* prologue: function */
 848               	/* frame size = 0 */
 170:rowSegBuffer.c **** 
 171:rowSegBuffer.c **** 	//Add a new NULL-SEGMENT
 172:rowSegBuffer.c **** 	//This might appear as a stretched last pixel/segment...
 173:rowSegBuffer.c **** 	if((segPosition < NUM_SEGMENTS-1) 
 849               		.stabn	68,0,173,.LM70-.LFBB7
 850               	.LM70:
 851 0382 8091 0000 		lds r24,segPosition
 852 0386 8334      		cpi r24,lo8(67)
 853 0388 00F4      		brsh .L61
 854 038a E82F      		mov r30,r24
 855 038c F0E0      		ldi r31,lo8(0)
 856 038e EE0F      		lsl r30
 857 0390 FF1F      		rol r31
 858 0392 E050      		subi r30,lo8(-(rowSegBuffer))
 859 0394 F040      		sbci r31,hi8(-(rowSegBuffer))
 860 0396 9081      		ld r25,Z
 861 0398 987F      		andi r25,lo8(-8)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 104


 862 039a 01F0      		breq .L63
 174:rowSegBuffer.c **** 		&& (rowSegBuffer[segPosition].red_length & SEG_LENGTH_MASK))
 175:rowSegBuffer.c **** 	{
 176:rowSegBuffer.c **** 		segPosition++;
 863               		.stabn	68,0,176,.LM71-.LFBB7
 864               	.LM71:
 865 039c 8F5F      		subi r24,lo8(-(1))
 866 039e 8093 0000 		sts segPosition,r24
 177:rowSegBuffer.c **** 
 178:rowSegBuffer.c **** 		rowSegBuffer[segPosition].red_length 
 179:rowSegBuffer.c **** 			= rowSegBuffer[segPosition-1].red_length & RED_MASK;
 867               		.stabn	68,0,179,.LM72-.LFBB7
 868               	.LM72:
 869 03a2 A82F      		mov r26,r24
 870 03a4 B0E0      		ldi r27,lo8(0)
 178:rowSegBuffer.c **** 		rowSegBuffer[segPosition].red_length 
 871               		.stabn	68,0,178,.LM73-.LFBB7
 872               	.LM73:
 873 03a6 FD01      		movw r30,r26
 874 03a8 EE0F      		lsl r30
 875 03aa FF1F      		rol r31
 876 03ac E050      		subi r30,lo8(-(rowSegBuffer))
 877 03ae F040      		sbci r31,hi8(-(rowSegBuffer))
 878 03b0 AA0F      		lsl r26
 879 03b2 BB1F      		rol r27
 880 03b4 A050      		subi r26,lo8(-(rowSegBuffer-2))
 881 03b6 B040      		sbci r27,hi8(-(rowSegBuffer-2))
 882 03b8 8C91      		ld r24,X
 883 03ba 8770      		andi r24,lo8(7)
 884 03bc 8083      		st Z,r24
 180:rowSegBuffer.c **** 		rowSegBuffer[segPosition].green_blue
 885               		.stabn	68,0,180,.LM74-.LFBB7
 886               	.LM74:
 887 03be 1196      		adiw r26,1
 888 03c0 8C91      		ld r24,X
 889 03c2 1197      		sbiw r26,1
 890 03c4 8183      		std Z+1,r24
 173:rowSegBuffer.c **** 	if((segPosition < NUM_SEGMENTS-1) 
 891               		.stabn	68,0,173,.LM75-.LFBB7
 892               	.LM75:
 893 03c6 0895      		ret
 894               	.L61:
 181:rowSegBuffer.c **** 			= rowSegBuffer[segPosition-1].green_blue;
 182:rowSegBuffer.c **** 	}
 183:rowSegBuffer.c **** 	//We're already at the last segment, so we have to nullify it
 184:rowSegBuffer.c **** 	//This might terminate the last pixel early, but is necessary.
 185:rowSegBuffer.c **** 	else if(segPosition == NUM_SEGMENTS-1)
 895               		.stabn	68,0,185,.LM76-.LFBB7
 896               	.LM76:
 897 03c8 8334      		cpi r24,lo8(67)
 898 03ca 01F4      		brne .L63
 186:rowSegBuffer.c **** 	{
 187:rowSegBuffer.c **** 		//Apparently white doesn't cause sync problems... so load it white
 188:rowSegBuffer.c **** 		rowSegBuffer[segPosition].red_length = fbRed_to_seg(_W);
 899               		.stabn	68,0,188,.LM77-.LFBB7
 900               	.LM77:
 901 03cc 87E0      		ldi r24,lo8(7)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 105


 902 03ce 8093 0000 		sts rowSegBuffer+134,r24
 189:rowSegBuffer.c **** 		rowSegBuffer[segPosition].green_blue = 
 903               		.stabn	68,0,189,.LM78-.LFBB7
 904               	.LM78:
 905 03d2 83E7      		ldi r24,lo8(115)
 906 03d4 8093 0000 		sts rowSegBuffer+135,r24
 907               	.L63:
 908 03d8 0895      		ret
 909               		.size	segTerminate, .-segTerminate
 910               	.Lscope7:
 911               		.stabs	"",36,0,0,.Lscope7-.LFBB7
 912               		.stabd	78,0,0
 913               		.stabs	"newSeg:F(3,2)",36,0,332,newSeg
 914               		.stabs	"length:P(3,4)",64,0,332,24
 915               		.stabs	"red:P(3,2)",64,0,332,22
 916               		.stabs	"green_blue:P(3,2)",64,0,332,20
 917               	.global	newSeg
 918               		.type	newSeg, @function
 919               	newSeg:
 920               		.stabd	46,0,0
 190:rowSegBuffer.c **** 										fbBlue_to_seg(_W) | fbGreen_to_seg(_W);
 191:rowSegBuffer.c **** 	}
 192:rowSegBuffer.c **** 
 193:rowSegBuffer.c **** 	//If we got here, it's already been terminated...
 194:rowSegBuffer.c **** 	//else...
 195:rowSegBuffer.c **** }
 196:rowSegBuffer.c **** 
 197:rowSegBuffer.c **** 
 198:rowSegBuffer.c **** #define newSegfb(length, fbColor) newSeg((length), fb_to_seg(fbColor))
 199:rowSegBuffer.c **** #define addSegfb(length, fbColor) addSeg((length), fb_to_seg(fbColor))
 200:rowSegBuffer.c **** 
 201:rowSegBuffer.c **** //This is just an intermediate test, for now...
 202:rowSegBuffer.c **** // for reloading the rowbuffer to a seg-buffer.
 203:rowSegBuffer.c **** //This could easily be revised (and generalized) to be...
 204:rowSegBuffer.c **** // addSegment or addPixel
 205:rowSegBuffer.c **** void rbpix_to_seg(uint8_t rbValue, uint8_t col, uint8_t length)
 206:rowSegBuffer.c **** {
 207:rowSegBuffer.c **** 	static uint8_t last_rbValue = 0;
 208:rowSegBuffer.c **** 	//uint8_t length = 1;
 209:rowSegBuffer.c **** 
 210:rowSegBuffer.c **** 	if(col == 0)
 211:rowSegBuffer.c **** 	{
 212:rowSegBuffer.c **** 		last_rbValue = 0;
 213:rowSegBuffer.c **** 		segClear();
 214:rowSegBuffer.c **** 	}
 215:rowSegBuffer.c **** 	//Same color as last pixel...
 216:rowSegBuffer.c **** 	else if(segPosition && (rbValue == last_rbValue))
 217:rowSegBuffer.c **** 	{
 218:rowSegBuffer.c **** 		stretchSeg(length);
 219:rowSegBuffer.c **** 		return;
 220:rowSegBuffer.c **** 	}
 221:rowSegBuffer.c **** 
 222:rowSegBuffer.c **** 	uint8_t green = rbValue & 0x03;
 223:rowSegBuffer.c **** 	uint8_t red = (rbValue & 0x1C) >> 2;
 224:rowSegBuffer.c **** 	uint8_t blue = rbValue >> 5;
 225:rowSegBuffer.c **** 
 226:rowSegBuffer.c **** 	newSeg(length, red, (blue<<4) | green);
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 106


 227:rowSegBuffer.c **** 
 228:rowSegBuffer.c **** 	last_rbValue = rbValue;
 229:rowSegBuffer.c **** }
 230:rowSegBuffer.c **** 
 231:rowSegBuffer.c **** //Call this when we already know the color in the last segment is the same
 232:rowSegBuffer.c **** // so we wish to stretch the segment by additionalLength
 233:rowSegBuffer.c **** // these values are real-lengths, not as shifted for storage...
 234:rowSegBuffer.c **** // Return TRUE if the stretch was truncated...
 235:rowSegBuffer.c **** // THIS DOES NOT TEST DISPLAY_WIDTH!
 236:rowSegBuffer.c **** // DON'T FORGET to make additionalLength square before the call
 237:rowSegBuffer.c **** // if necesary....
 238:rowSegBuffer.c **** uint8_t stretchSeg(uint16_t additionalLength)
 239:rowSegBuffer.c **** {
 240:rowSegBuffer.c **** 		uint8_t oldLength=
 241:rowSegBuffer.c **** 			(rowSegBuffer[segPosition].red_length >> SEG_LENGTH_SHIFT);
 242:rowSegBuffer.c **** 
 243:rowSegBuffer.c **** 		if(!additionalLength)
 244:rowSegBuffer.c **** 			return FALSE;
 245:rowSegBuffer.c **** 
 246:rowSegBuffer.c **** 		//We can stretch the current segment
 247:rowSegBuffer.c **** 		if(oldLength < SEG_MAXLENGTH)
 248:rowSegBuffer.c **** 		{
 249:rowSegBuffer.c **** 			uint8_t maxStretch = SEG_MAXLENGTH - oldLength;
 250:rowSegBuffer.c **** 
 251:rowSegBuffer.c **** 			// Will the entire addition fit in the previous segment?
 252:rowSegBuffer.c **** 			if(additionalLength <= maxStretch)
 253:rowSegBuffer.c **** 			{
 254:rowSegBuffer.c **** 				rowSegBuffer[segPosition].red_length += 
 255:rowSegBuffer.c **** 					(additionalLength << SEG_LENGTH_SHIFT);
 256:rowSegBuffer.c **** 
 257:rowSegBuffer.c **** 				//Then we're done.
 258:rowSegBuffer.c **** 			//	additionalLength = 0;
 259:rowSegBuffer.c **** 			//	break;
 260:rowSegBuffer.c **** 				return FALSE;
 261:rowSegBuffer.c **** 			}
 262:rowSegBuffer.c **** 			// Nope... stretch it all the way, then later we'll make another
 263:rowSegBuffer.c **** 			else
 264:rowSegBuffer.c **** 			{
 265:rowSegBuffer.c **** 				uint8_t red = 
 266:rowSegBuffer.c **** 					rowSegBuffer[segPosition].red_length & RED_MASK;
 267:rowSegBuffer.c **** 
 268:rowSegBuffer.c **** 				rowSegBuffer[segPosition].red_length =
 269:rowSegBuffer.c **** 					red | (SEG_MAXLENGTH << SEG_LENGTH_SHIFT);
 270:rowSegBuffer.c **** 
 271:rowSegBuffer.c **** 				additionalLength -= maxStretch;
 272:rowSegBuffer.c **** 			}
 273:rowSegBuffer.c **** 		}
 274:rowSegBuffer.c **** 
 275:rowSegBuffer.c **** 		//The current segment has been stretched and there's more remaining
 276:rowSegBuffer.c **** 		// or it was already maxed-out...
 277:rowSegBuffer.c **** 
 278:rowSegBuffer.c **** 		// We shouldn't ever get here if additionalLength = 0...
 279:rowSegBuffer.c **** 
 280:rowSegBuffer.c **** 		//But we should test to make sure there's still lenth after
 281:rowSegBuffer.c **** 		// the stretch...
 282:rowSegBuffer.c **** 		if(additionalLength)
 283:rowSegBuffer.c **** 		{
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 107


 284:rowSegBuffer.c **** 			uint8_t red =
 285:rowSegBuffer.c **** 				rowSegBuffer[segPosition].red_length & RED_MASK;
 286:rowSegBuffer.c **** 
 287:rowSegBuffer.c **** 			uint8_t green_blue =
 288:rowSegBuffer.c **** 				rowSegBuffer[segPosition].green_blue;
 289:rowSegBuffer.c **** 
 290:rowSegBuffer.c **** 			uint8_t retVal;
 291:rowSegBuffer.c **** 
 292:rowSegBuffer.c **** 			//Create new segment(s) with the remaining length
 293:rowSegBuffer.c **** 			retVal = newSeg(additionalLength, red, green_blue);
 294:rowSegBuffer.c **** 
 295:rowSegBuffer.c **** 			//Then we're done...
 296:rowSegBuffer.c **** 			//additionalLength = 0;
 297:rowSegBuffer.c **** 			//break;
 298:rowSegBuffer.c **** 
 299:rowSegBuffer.c **** 			return retVal;
 300:rowSegBuffer.c **** 		}	
 301:rowSegBuffer.c **** 
 302:rowSegBuffer.c **** 		//We shouldn't ever get here...
 303:rowSegBuffer.c **** 		// Well, maybe... if additionalLength == maxStretch...?
 304:rowSegBuffer.c **** 		return FALSE;
 305:rowSegBuffer.c **** }
 306:rowSegBuffer.c **** 
 307:rowSegBuffer.c **** //This should be like newSeg, but also checks whether it can stretch
 308:rowSegBuffer.c **** // the last segment...
 309:rowSegBuffer.c **** uint8_t addSeg(uint16_t length, uint8_t red, uint8_t green_blue)
 310:rowSegBuffer.c **** {
 311:rowSegBuffer.c **** 
 312:rowSegBuffer.c **** 	//Currently not smart enough to stretch the first segment...
 313:rowSegBuffer.c **** 	if(segPosition == 0)
 314:rowSegBuffer.c **** 		return newSeg(length, red, green_blue);
 315:rowSegBuffer.c **** 
 316:rowSegBuffer.c **** 	//Can we stretch?
 317:rowSegBuffer.c **** 	if(((rowSegBuffer[segPosition].red_length & RED_MASK) == red)
 318:rowSegBuffer.c **** 		&& (rowSegBuffer[segPosition].green_blue == green_blue))
 319:rowSegBuffer.c **** 			return stretchSeg(length);
 320:rowSegBuffer.c **** 	else
 321:rowSegBuffer.c **** 		return newSeg(length, red, green_blue);
 322:rowSegBuffer.c **** 
 323:rowSegBuffer.c **** }
 324:rowSegBuffer.c **** 
 325:rowSegBuffer.c **** //This assumes you intend to create a new segment
 326:rowSegBuffer.c **** // it does *not* check whether the previous segment could be stretched
 327:rowSegBuffer.c **** // (it in fact, is called by stretchSeg as necessary)
 328:rowSegBuffer.c **** // Returns TRUE if it had to be truncated
 329:rowSegBuffer.c **** //  (out of segment memory, past the display edge...)
 330:rowSegBuffer.c **** // length is the real length, not shifted for storage...
 331:rowSegBuffer.c **** // THIS DOES NOT squarify, so adjust length as necessary before calling
 332:rowSegBuffer.c **** uint8_t newSeg(uint16_t length, uint8_t red, uint8_t green_blue)
 333:rowSegBuffer.c **** {
 921               		.stabn	68,0,333,.LM79-.LFBB8
 922               	.LM79:
 923               	.LFBB8:
 924               	/* prologue: function */
 925               	/* frame size = 0 */
 926               		.stabn	68,0,333,.LM80-.LFBB8
 927               	.LM80:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 108


 928 03da 2091 0000 		lds r18,segPosition
 334:rowSegBuffer.c **** 
 335:rowSegBuffer.c **** 	//Recursion would be simpler, but we've got a limited stack.
 336:rowSegBuffer.c **** 	while(length >= SEG_MAXLENGTH)
 337:rowSegBuffer.c **** 	{
 338:rowSegBuffer.c **** 		// No more segments available...	
 339:rowSegBuffer.c **** 		// The last segment must have a length of 0
 340:rowSegBuffer.c **** 		if(segPosition == NUM_SEGMENTS-1)
 341:rowSegBuffer.c **** 		{
 342:rowSegBuffer.c **** 			segTerminate();
 343:rowSegBuffer.c **** 			return TRUE;
 344:rowSegBuffer.c **** 		}
 345:rowSegBuffer.c **** 
 346:rowSegBuffer.c **** 		// Not yet sure how to handle display-width...
 347:rowSegBuffer.c **** 		//if(segTotal > DISPLAY_WIDTH)
 348:rowSegBuffer.c **** 		//  at least draw as much of the segment as possible...
 349:rowSegBuffer.c **** 		//  then segTerminate();
 350:rowSegBuffer.c **** 		//  and return TRUE
 351:rowSegBuffer.c **** 
 352:rowSegBuffer.c **** 		// If we've gotten this far, then we can add the segment
 353:rowSegBuffer.c **** 	
 354:rowSegBuffer.c **** 		//Check if the segment buffer is cleared...
 355:rowSegBuffer.c **** 		// then DON'T increment segPosition...
 356:rowSegBuffer.c **** 		//if(!((segPosition == 0) && 
 357:rowSegBuffer.c **** 		//  !(rowSegBuffer[segPosition].red_length & SEG_LENGTH_MASK)))
 358:rowSegBuffer.c **** 		if(segPosition || 
 359:rowSegBuffer.c **** 			((rowSegBuffer[segPosition].red_length & SEG_LENGTH_MASK) != 0))
 360:rowSegBuffer.c **** 				segPosition++;
 361:rowSegBuffer.c **** 
 362:rowSegBuffer.c **** 
 363:rowSegBuffer.c **** 		//Create a maxlength segment
 364:rowSegBuffer.c **** 		rowSegBuffer[segPosition].red_length =
 929               		.stabn	68,0,364,.LM81-.LFBB8
 930               	.LM81:
 931 03de 562F      		mov r21,r22
 932 03e0 586F      		ori r21,lo8(-8)
 336:rowSegBuffer.c **** 	while(length >= SEG_MAXLENGTH)
 933               		.stabn	68,0,336,.LM82-.LFBB8
 934               	.LM82:
 935 03e2 00C0      		rjmp .L65
 936               	.L70:
 340:rowSegBuffer.c **** 		if(segPosition == NUM_SEGMENTS-1)
 937               		.stabn	68,0,340,.LM83-.LFBB8
 938               	.LM83:
 939 03e4 2334      		cpi r18,lo8(67)
 940 03e6 01F4      		brne .L66
 941 03e8 2093 0000 		sts segPosition,r18
 942 03ec 00C0      		rjmp .L76
 943               	.L66:
 358:rowSegBuffer.c **** 		if(segPosition || 
 944               		.stabn	68,0,358,.LM84-.LFBB8
 945               	.LM84:
 946 03ee 2223      		tst r18
 947 03f0 01F4      		brne .L68
 948 03f2 3091 0000 		lds r19,rowSegBuffer
 949 03f6 387F      		andi r19,lo8(-8)
 950 03f8 01F0      		breq .L69
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 109


 951               	.L68:
 360:rowSegBuffer.c **** 				segPosition++;
 952               		.stabn	68,0,360,.LM85-.LFBB8
 953               	.LM85:
 954 03fa 2F5F      		subi r18,lo8(-(1))
 955               	.L69:
 956               		.stabn	68,0,364,.LM86-.LFBB8
 957               	.LM86:
 958 03fc E22F      		mov r30,r18
 959 03fe F0E0      		ldi r31,lo8(0)
 960 0400 EE0F      		lsl r30
 961 0402 FF1F      		rol r31
 962 0404 E050      		subi r30,lo8(-(rowSegBuffer))
 963 0406 F040      		sbci r31,hi8(-(rowSegBuffer))
 964 0408 5083      		st Z,r21
 365:rowSegBuffer.c **** 			red | (SEG_MAXLENGTH<<SEG_LENGTH_SHIFT);
 366:rowSegBuffer.c **** 
 367:rowSegBuffer.c **** 		rowSegBuffer[segPosition].green_blue = green_blue;
 965               		.stabn	68,0,367,.LM87-.LFBB8
 966               	.LM87:
 967 040a 4183      		std Z+1,r20
 368:rowSegBuffer.c **** 
 369:rowSegBuffer.c **** 		length -= SEG_MAXLENGTH;
 968               		.stabn	68,0,369,.LM88-.LFBB8
 969               	.LM88:
 970 040c 4F97      		sbiw r24,31
 971               	.L65:
 336:rowSegBuffer.c **** 	while(length >= SEG_MAXLENGTH)
 972               		.stabn	68,0,336,.LM89-.LFBB8
 973               	.LM89:
 974 040e 8F31      		cpi r24,31
 975 0410 9105      		cpc r25,__zero_reg__
 976 0412 00F4      		brsh .L70
 977 0414 2093 0000 		sts segPosition,r18
 370:rowSegBuffer.c **** 
 371:rowSegBuffer.c **** 	}
 372:rowSegBuffer.c **** 
 373:rowSegBuffer.c **** 	//We can fit whatever's left (or the whole thing) into a single segment
 374:rowSegBuffer.c **** 	// Unless, of course, there's nothing left...
 375:rowSegBuffer.c **** 	if(length > 0) //< SEG_MAXLENGTH)//Guaranteed now...
 978               		.stabn	68,0,375,.LM90-.LFBB8
 979               	.LM90:
 980 0418 0097      		sbiw r24,0
 981 041a 01F4      		brne .L71
 982 041c 80E0      		ldi r24,lo8(0)
 983 041e 0895      		ret
 984               	.L71:
 376:rowSegBuffer.c **** 	{
 377:rowSegBuffer.c **** 		//Make sure there's another segment to write to!
 378:rowSegBuffer.c **** 		if(segPosition == NUM_SEGMENTS-1)
 985               		.stabn	68,0,378,.LM91-.LFBB8
 986               	.LM91:
 987 0420 2334      		cpi r18,lo8(67)
 988 0422 01F4      		brne .L72
 989               	.L76:
 379:rowSegBuffer.c **** 		{
 380:rowSegBuffer.c **** 			segTerminate();
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 110


 990               		.stabn	68,0,380,.LM92-.LFBB8
 991               	.LM92:
 992 0424 00D0      		rcall segTerminate
 993 0426 81E0      		ldi r24,lo8(1)
 381:rowSegBuffer.c **** 			return TRUE;
 994               		.stabn	68,0,381,.LM93-.LFBB8
 995               	.LM93:
 996 0428 0895      		ret
 997               	.L72:
 382:rowSegBuffer.c **** 		}
 383:rowSegBuffer.c **** 
 384:rowSegBuffer.c **** 		//if(!((segPosition == 0) &&
 385:rowSegBuffer.c **** 		//  !(rowSegBuffer[segPosition].red_length & SEG_LENGTH_MASK)))
 386:rowSegBuffer.c **** 		if(segPosition || 
 998               		.stabn	68,0,386,.LM94-.LFBB8
 999               	.LM94:
 1000 042a 2223      		tst r18
 1001 042c 01F4      		brne .L73
 1002 042e 3091 0000 		lds r19,rowSegBuffer
 1003 0432 387F      		andi r19,lo8(-8)
 1004 0434 01F0      		breq .L74
 1005               	.L73:
 387:rowSegBuffer.c **** 	     ((rowSegBuffer[segPosition].red_length & SEG_LENGTH_MASK) != 0))
 388:rowSegBuffer.c ****   				segPosition++;
 1006               		.stabn	68,0,388,.LM95-.LFBB8
 1007               	.LM95:
 1008 0436 2F5F      		subi r18,lo8(-(1))
 1009 0438 2093 0000 		sts segPosition,r18
 1010               	.L74:
 389:rowSegBuffer.c **** 
 390:rowSegBuffer.c **** 
 391:rowSegBuffer.c **** 		rowSegBuffer[segPosition].red_length = 
 1011               		.stabn	68,0,391,.LM96-.LFBB8
 1012               	.LM96:
 1013 043c E091 0000 		lds r30,segPosition
 1014 0440 F0E0      		ldi r31,lo8(0)
 1015 0442 EE0F      		lsl r30
 1016 0444 FF1F      		rol r31
 1017 0446 E050      		subi r30,lo8(-(rowSegBuffer))
 1018 0448 F040      		sbci r31,hi8(-(rowSegBuffer))
 1019 044a 880F      		lsl r24
 1020 044c 880F      		lsl r24
 1021 044e 880F      		lsl r24
 1022 0450 862B      		or r24,r22
 1023 0452 8083      		st Z,r24
 392:rowSegBuffer.c **** 			red | (length<<SEG_LENGTH_SHIFT);
 393:rowSegBuffer.c **** 
 394:rowSegBuffer.c **** 		rowSegBuffer[segPosition].green_blue = green_blue;
 1024               		.stabn	68,0,394,.LM97-.LFBB8
 1025               	.LM97:
 1026 0454 4183      		std Z+1,r20
 1027 0456 80E0      		ldi r24,lo8(0)
 395:rowSegBuffer.c **** 	}
 396:rowSegBuffer.c **** 
 397:rowSegBuffer.c **** 	return FALSE;
 398:rowSegBuffer.c **** 
 399:rowSegBuffer.c **** }
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 111


 1028               		.stabn	68,0,399,.LM98-.LFBB8
 1029               	.LM98:
 1030 0458 0895      		ret
 1031               		.size	newSeg, .-newSeg
 1032               	.Lscope8:
 1033               		.stabs	"",36,0,0,.Lscope8-.LFBB8
 1034               		.stabd	78,0,0
 1035               		.stabs	"stretchSeg:F(3,2)",36,0,238,stretchSeg
 1036               		.stabs	"additionalLength:P(3,4)",64,0,238,24
 1037               	.global	stretchSeg
 1038               		.type	stretchSeg, @function
 1039               	stretchSeg:
 1040               		.stabd	46,0,0
 239:rowSegBuffer.c **** {
 1041               		.stabn	68,0,239,.LM99-.LFBB9
 1042               	.LM99:
 1043               	.LFBB9:
 1044               	/* prologue: function */
 1045               	/* frame size = 0 */
 241:rowSegBuffer.c **** 			(rowSegBuffer[segPosition].red_length >> SEG_LENGTH_SHIFT);
 1046               		.stabn	68,0,241,.LM100-.LFBB9
 1047               	.LM100:
 1048 045a E091 0000 		lds r30,segPosition
 1049 045e F0E0      		ldi r31,lo8(0)
 1050 0460 DF01      		movw r26,r30
 1051 0462 AA0F      		lsl r26
 1052 0464 BB1F      		rol r27
 1053 0466 A050      		subi r26,lo8(-(rowSegBuffer))
 1054 0468 B040      		sbci r27,hi8(-(rowSegBuffer))
 1055 046a 2C91      		ld r18,X
 243:rowSegBuffer.c **** 		if(!additionalLength)
 1056               		.stabn	68,0,243,.LM101-.LFBB9
 1057               	.LM101:
 1058 046c 0097      		sbiw r24,0
 1059 046e 01F0      		breq .L78
 241:rowSegBuffer.c **** 			(rowSegBuffer[segPosition].red_length >> SEG_LENGTH_SHIFT);
 1060               		.stabn	68,0,241,.LM102-.LFBB9
 1061               	.LM102:
 1062 0470 422F      		mov r20,r18
 1063 0472 4695      		lsr r20
 1064 0474 4695      		lsr r20
 1065 0476 4695      		lsr r20
 247:rowSegBuffer.c **** 		if(oldLength < SEG_MAXLENGTH)
 1066               		.stabn	68,0,247,.LM103-.LFBB9
 1067               	.LM103:
 1068 0478 4F31      		cpi r20,lo8(31)
 1069 047a 00F4      		brsh .L79
 1070               	.LBB87:
 252:rowSegBuffer.c **** 			if(additionalLength <= maxStretch)
 1071               		.stabn	68,0,252,.LM104-.LFBB9
 1072               	.LM104:
 1073 047c 3FE1      		ldi r19,lo8(31)
 1074 047e 341B      		sub r19,r20
 1075 0480 432F      		mov r20,r19
 1076 0482 50E0      		ldi r21,lo8(0)
 1077 0484 4817      		cp r20,r24
 1078 0486 5907      		cpc r21,r25
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 112


 1079 0488 00F0      		brlo .L80
 254:rowSegBuffer.c **** 				rowSegBuffer[segPosition].red_length += 
 1080               		.stabn	68,0,254,.LM105-.LFBB9
 1081               	.LM105:
 1082 048a 880F      		lsl r24
 1083 048c 880F      		lsl r24
 1084 048e 880F      		lsl r24
 1085 0490 820F      		add r24,r18
 1086 0492 8C93      		st X,r24
 1087 0494 80E0      		ldi r24,lo8(0)
 260:rowSegBuffer.c **** 				return FALSE;
 1088               		.stabn	68,0,260,.LM106-.LFBB9
 1089               	.LM106:
 1090 0496 0895      		ret
 1091               	.L80:
 1092               	.LBB88:
 268:rowSegBuffer.c **** 				rowSegBuffer[segPosition].red_length =
 1093               		.stabn	68,0,268,.LM107-.LFBB9
 1094               	.LM107:
 1095 0498 286F      		ori r18,lo8(-8)
 1096 049a 2C93      		st X,r18
 271:rowSegBuffer.c **** 				additionalLength -= maxStretch;
 1097               		.stabn	68,0,271,.LM108-.LFBB9
 1098               	.LM108:
 1099 049c 841B      		sub r24,r20
 1100 049e 950B      		sbc r25,r21
 1101               	.LBE88:
 1102               	.LBE87:
 282:rowSegBuffer.c **** 		if(additionalLength)
 1103               		.stabn	68,0,282,.LM109-.LFBB9
 1104               	.LM109:
 1105 04a0 01F0      		breq .L78
 1106               	.L79:
 1107               	.LBB89:
 293:rowSegBuffer.c **** 			retVal = newSeg(additionalLength, red, green_blue);
 1108               		.stabn	68,0,293,.LM110-.LFBB9
 1109               	.LM110:
 1110 04a2 EE0F      		lsl r30
 1111 04a4 FF1F      		rol r31
 1112 04a6 E050      		subi r30,lo8(-(rowSegBuffer))
 1113 04a8 F040      		sbci r31,hi8(-(rowSegBuffer))
 1114 04aa 6081      		ld r22,Z
 1115 04ac 6770      		andi r22,lo8(7)
 1116 04ae 4181      		ldd r20,Z+1
 1117 04b0 00D0      		rcall newSeg
 299:rowSegBuffer.c **** 			return retVal;
 1118               		.stabn	68,0,299,.LM111-.LFBB9
 1119               	.LM111:
 1120 04b2 0895      		ret
 1121               	.L78:
 1122 04b4 80E0      		ldi r24,lo8(0)
 1123               	.LBE89:
 305:rowSegBuffer.c **** }
 1124               		.stabn	68,0,305,.LM112-.LFBB9
 1125               	.LM112:
 1126 04b6 0895      		ret
 1127               		.size	stretchSeg, .-stretchSeg
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 113


 1128               		.stabs	"oldLength:r(3,2)",64,0,240,20
 1129               		.stabn	192,0,0,.LFBB9-.LFBB9
 1130               		.stabs	"retVal:r(3,2)",64,0,290,24
 1131               		.stabn	192,0,0,.LBB89-.LFBB9
 1132               		.stabn	224,0,0,.LBE89-.LFBB9
 1133               		.stabn	224,0,0,.Lscope9-.LFBB9
 1134               	.Lscope9:
 1135               		.stabs	"",36,0,0,.Lscope9-.LFBB9
 1136               		.stabd	78,0,0
 1137               		.stabs	"addSeg:F(3,2)",36,0,309,addSeg
 1138               		.stabs	"length:P(3,4)",64,0,309,24
 1139               		.stabs	"red:P(3,2)",64,0,309,22
 1140               		.stabs	"green_blue:P(3,2)",64,0,309,20
 1141               	.global	addSeg
 1142               		.type	addSeg, @function
 1143               	addSeg:
 1144               		.stabd	46,0,0
 310:rowSegBuffer.c **** {
 1145               		.stabn	68,0,310,.LM113-.LFBB10
 1146               	.LM113:
 1147               	.LFBB10:
 1148               	/* prologue: function */
 1149               	/* frame size = 0 */
 313:rowSegBuffer.c **** 	if(segPosition == 0)
 1150               		.stabn	68,0,313,.LM114-.LFBB10
 1151               	.LM114:
 1152 04b8 E091 0000 		lds r30,segPosition
 1153 04bc EE23      		tst r30
 1154 04be 01F4      		brne .L84
 314:rowSegBuffer.c **** 		return newSeg(length, red, green_blue);
 1155               		.stabn	68,0,314,.LM115-.LFBB10
 1156               	.LM115:
 1157 04c0 00D0      		rcall newSeg
 1158 04c2 0895      		ret
 1159               	.L84:
 317:rowSegBuffer.c **** 	if(((rowSegBuffer[segPosition].red_length & RED_MASK) == red)
 1160               		.stabn	68,0,317,.LM116-.LFBB10
 1161               	.LM116:
 1162 04c4 F0E0      		ldi r31,lo8(0)
 1163 04c6 EE0F      		lsl r30
 1164 04c8 FF1F      		rol r31
 1165 04ca E050      		subi r30,lo8(-(rowSegBuffer))
 1166 04cc F040      		sbci r31,hi8(-(rowSegBuffer))
 1167 04ce 2081      		ld r18,Z
 1168 04d0 30E0      		ldi r19,lo8(0)
 1169 04d2 2770      		andi r18,lo8(7)
 1170 04d4 3070      		andi r19,hi8(7)
 1171 04d6 A62F      		mov r26,r22
 1172 04d8 B0E0      		ldi r27,lo8(0)
 1173 04da 2A17      		cp r18,r26
 1174 04dc 3B07      		cpc r19,r27
 1175 04de 01F4      		brne .L86
 1176 04e0 2181      		ldd r18,Z+1
 1177 04e2 2417      		cp r18,r20
 1178 04e4 01F4      		brne .L86
 319:rowSegBuffer.c **** 			return stretchSeg(length);
 1179               		.stabn	68,0,319,.LM117-.LFBB10
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 114


 1180               	.LM117:
 1181 04e6 00D0      		rcall stretchSeg
 1182 04e8 0895      		ret
 1183               	.L86:
 321:rowSegBuffer.c **** 		return newSeg(length, red, green_blue);
 1184               		.stabn	68,0,321,.LM118-.LFBB10
 1185               	.LM118:
 1186 04ea 00D0      		rcall newSeg
 323:rowSegBuffer.c **** }
 1187               		.stabn	68,0,323,.LM119-.LFBB10
 1188               	.LM119:
 1189 04ec 0895      		ret
 1190               		.size	addSeg, .-addSeg
 1191               	.Lscope10:
 1192               		.stabs	"",36,0,0,.Lscope10-.LFBB10
 1193               		.stabd	78,0,0
 1194               		.stabs	"rbpix_to_seg:F(0,15)",36,0,205,rbpix_to_seg
 1195               		.stabs	"rbValue:P(3,2)",64,0,205,17
 1196               		.stabs	"col:P(3,2)",64,0,205,22
 1197               		.stabs	"length:P(3,2)",64,0,205,24
 1198               	.global	rbpix_to_seg
 1199               		.type	rbpix_to_seg, @function
 1200               	rbpix_to_seg:
 1201               		.stabd	46,0,0
 206:rowSegBuffer.c **** {
 1202               		.stabn	68,0,206,.LM120-.LFBB11
 1203               	.LM120:
 1204               	.LFBB11:
 1205 04ee 1F93      		push r17
 1206               	/* prologue: function */
 1207               	/* frame size = 0 */
 1208 04f0 182F      		mov r17,r24
 1209 04f2 842F      		mov r24,r20
 210:rowSegBuffer.c **** 	if(col == 0)
 1210               		.stabn	68,0,210,.LM121-.LFBB11
 1211               	.LM121:
 1212 04f4 6623      		tst r22
 1213 04f6 01F4      		brne .L89
 212:rowSegBuffer.c **** 		last_rbValue = 0;
 1214               		.stabn	68,0,212,.LM122-.LFBB11
 1215               	.LM122:
 1216 04f8 1092 0000 		sts last_rbValue.2025,__zero_reg__
 1217               	.LBB90:
 1218               	.LBB91:
 159:rowSegBuffer.c **** 	segPosition = 0;
 1219               		.stabn	68,0,159,.LM123-.LFBB11
 1220               	.LM123:
 1221 04fc 1092 0000 		sts segPosition,__zero_reg__
 162:rowSegBuffer.c **** 	rowSegBuffer[segPosition].red_length = 6;
 1222               		.stabn	68,0,162,.LM124-.LFBB11
 1223               	.LM124:
 1224 0500 96E0      		ldi r25,lo8(6)
 1225 0502 9093 0000 		sts rowSegBuffer,r25
 163:rowSegBuffer.c **** 	rowSegBuffer[segPosition].green_blue = (6<<4) | 3;
 1226               		.stabn	68,0,163,.LM125-.LFBB11
 1227               	.LM125:
 1228 0506 93E6      		ldi r25,lo8(99)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 115


 1229 0508 9093 0000 		sts rowSegBuffer+1,r25
 1230 050c 00C0      		rjmp .L90
 1231               	.L89:
 1232               	.LBE91:
 1233               	.LBE90:
 216:rowSegBuffer.c **** 	else if(segPosition && (rbValue == last_rbValue))
 1234               		.stabn	68,0,216,.LM126-.LFBB11
 1235               	.LM126:
 1236 050e 9091 0000 		lds r25,segPosition
 1237 0512 9923      		tst r25
 1238 0514 01F0      		breq .L90
 1239 0516 9091 0000 		lds r25,last_rbValue.2025
 1240 051a 1917      		cp r17,r25
 1241 051c 01F4      		brne .L90
 218:rowSegBuffer.c **** 		stretchSeg(length);
 1242               		.stabn	68,0,218,.LM127-.LFBB11
 1243               	.LM127:
 1244 051e 90E0      		ldi r25,lo8(0)
 1245 0520 00D0      		rcall stretchSeg
 219:rowSegBuffer.c **** 		return;
 1246               		.stabn	68,0,219,.LM128-.LFBB11
 1247               	.LM128:
 1248 0522 00C0      		rjmp .L92
 1249               	.L90:
 226:rowSegBuffer.c **** 	newSeg(length, red, (blue<<4) | green);
 1250               		.stabn	68,0,226,.LM129-.LFBB11
 1251               	.LM129:
 1252 0524 612F      		mov r22,r17
 1253 0526 70E0      		ldi r23,lo8(0)
 1254 0528 6C71      		andi r22,lo8(28)
 1255 052a 7070      		andi r23,hi8(28)
 1256 052c 7595      		asr r23
 1257 052e 6795      		ror r22
 1258 0530 7595      		asr r23
 1259 0532 6795      		ror r22
 1260 0534 212F      		mov r18,r17
 1261 0536 2295      		swap r18
 1262 0538 2695      		lsr r18
 1263 053a 2770      		andi r18,lo8(7)
 1264 053c 2295      		swap r18
 1265 053e 207F      		andi r18,lo8(-16)
 1266 0540 912F      		mov r25,r17
 1267 0542 9370      		andi r25,lo8(3)
 1268 0544 292B      		or r18,r25
 1269 0546 90E0      		ldi r25,lo8(0)
 1270 0548 422F      		mov r20,r18
 1271 054a 00D0      		rcall newSeg
 228:rowSegBuffer.c **** 	last_rbValue = rbValue;
 1272               		.stabn	68,0,228,.LM130-.LFBB11
 1273               	.LM130:
 1274 054c 1093 0000 		sts last_rbValue.2025,r17
 1275               	.L92:
 1276               	/* epilogue start */
 229:rowSegBuffer.c **** }
 1277               		.stabn	68,0,229,.LM131-.LFBB11
 1278               	.LM131:
 1279 0550 1F91      		pop r17
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 116


 1280 0552 0895      		ret
 1281               		.size	rbpix_to_seg, .-rbpix_to_seg
 1282               		.stabs	"last_rbValue:V(3,2)",38,0,207,last_rbValue.2025
 1283               		.stabn	192,0,0,.LFBB11-.LFBB11
 1284               		.stabn	224,0,0,.Lscope11-.LFBB11
 1285               	.Lscope11:
 1286               		.stabs	"",36,0,0,.Lscope11-.LFBB11
 1287               		.stabd	78,0,0
 1288               		.stabs	"fb_to_rb:F(3,2)",36,0,85,fb_to_rb
 1289               		.stabs	"fbColor:P(3,2)",64,0,85,24
 1290               	.global	fb_to_rb
 1291               		.type	fb_to_rb, @function
 1292               	fb_to_rb:
 1293               		.stabd	46,0,0
 1294               		.stabs	"rowBuffer.c",132,0,0,.Ltext5
 1295               	.Ltext5:
   1:rowBuffer.c   **** // RowBuffer
   2:rowBuffer.c   **** //    An entire row is calculated and stored in the rowbuffer
   3:rowBuffer.c   **** //    before each line is displayed.
   4:rowBuffer.c   **** //    (There is not nearly enough memory for an entire frameBuffer)
   5:rowBuffer.c   **** //
   6:rowBuffer.c   **** //    A single byte is used for each drawable pixel in the row
   7:rowBuffer.c   **** //    this byte is actually a bit-mask of the OCR/DT values
   8:rowBuffer.c   **** //    so it's more of a settings-buffer
   9:rowBuffer.c   **** //    
  10:rowBuffer.c   **** //    Processing each byte and writing registers takes 14 clock cycles
  11:rowBuffer.c   **** //     so at full-speed LVDS (1 pixel per 7/8ths clock cycle)
  12:rowBuffer.c   **** //     then each drawable pixel is 16 LCD pixels wide
  13:rowBuffer.c   **** //     for a maximum resolution of 64 drawable pixels across
  14:rowBuffer.c   **** //     (thus, the row-settings-buffer is 64Bytes)
  15:rowBuffer.c   **** //    (Were the bytes not packed, and we used three bytes per drawable
  16:rowBuffer.c   **** //     pixel, each readFromSRAM*3+loadToRegister*3 pixel would be 
  17:rowBuffer.c   **** //     9 cycles... for ~100 pixels and ~300Bytes. Would it really be worth
  18:rowBuffer.c   **** //     3 times the memory for 1/3 more pixels? Probably not...
  19:rowBuffer.c   **** //     See RowSegmentBuffer for higher resolution...)
  20:rowBuffer.c   **** //
  21:rowBuffer.c   **** //   Red: (+OC1D => RX0+)
  22:rowBuffer.c   **** //    Off (0/63): OCR1D = 0
  23:rowBuffer.c   **** //    35/63:      OCR1D = 3
  24:rowBuffer.c   **** //    51/63:      OCR1D = 4   (FOUR_SHADES only)
  25:rowBuffer.c   **** //    63/63:      OCR1D >= 6
  26:rowBuffer.c   **** //   Green: (/OC1B => RX1-)          (B1,0 Active, as well as G2,1)
  27:rowBuffer.c   **** //    Off (6/63): DTL1 = 0
  28:rowBuffer.c   **** //    38-39/63:      DTL1 = 1
  29:rowBuffer.c   **** //    54-55/63:      DTL1 = 2 (FOUR_SHADES only)
  30:rowBuffer.c   **** //    62-63/63:      DTL1 = 3
  31:rowBuffer.c   **** //   Blue: (+OC1A => RX2+)               (B3,2 Active from here down)
  32:rowBuffer.c   **** //    Off (15/63):  OCR1A=4
  33:rowBuffer.c   **** //    47/63:        OCR1A=5
  34:rowBuffer.c   **** //    63/63:        OCR1A=6
  35:rowBuffer.c   **** //
  36:rowBuffer.c   **** //  For faster pixels: these values could be stored in a settingsBuffer
  37:rowBuffer.c   **** //  (instead of a frame-buffer based on color values)
  38:rowBuffer.c   **** //  we have: 
  39:rowBuffer.c   **** //                             0    1    2    3
  40:rowBuffer.c   **** //                 ColorVal:  00   01   10   11
  41:rowBuffer.c   **** //     Red (OCR1D): 0,3,4,6  000, 011, 100, 110
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 117


  42:rowBuffer.c   **** //   Green (DTL1):  0,1,2,3  000, 001, 010, 011
  43:rowBuffer.c   **** //    Blue (OCR1A): 4,5,6    100, 101, 110, 110
  44:rowBuffer.c   **** //           (I guess it could be noted that Blue's bit2 is always 1)
  45:rowBuffer.c   **** //           (also: OCR1A = 7 is totally acceptable, 
  46:rowBuffer.c   **** //                  so blueOCR=0x4|blueColor)
  47:rowBuffer.c   **** //           ( Similar can be said for Red... 7 is acceptable)
  48:rowBuffer.c   **** //  For memory space, we could fit these values directly in a single byte
  49:rowBuffer.c   **** //    Red Mask: 0x07
  50:rowBuffer.c   **** //  Green Mask: 0x14
  51:rowBuffer.c   **** //   Blue Mask: 0x60
  52:rowBuffer.c   **** //
  53:rowBuffer.c   **** //  Options: mask and shift, no extra memory
  54:rowBuffer.c   **** //           andi for red
  55:rowBuffer.c   **** //           andi for green + 3 shifts
  56:rowBuffer.c   **** //           5 shifts for blue
  57:rowBuffer.c   **** //           ... 10 cycles (12 pixels)
  58:rowBuffer.c   **** //           If green is the low two bits:
  59:rowBuffer.c   **** //           andi for green
  60:rowBuffer.c   **** //           andi for red + 2 shifts
  61:rowBuffer.c   **** //           5 shifts for blue
  62:rowBuffer.c   **** //           ... 9 cycles (11 pixels)
  63:rowBuffer.c   **** //          + 3 register writes (3 cycles) = 12cycles
  64:rowBuffer.c   **** //          + 1 SRAM read (2 cycles) = 14 cycles (16 pixels)
  65:rowBuffer.c   **** //           ALSO: 5 shifts TOTAL, usable?
  66:rowBuffer.c   **** //         (This may be outdated... and doesn't take into account
  67:rowBuffer.c   **** //          mov instructions... so see the code instead of believing this)
  68:rowBuffer.c   **** //         BUT:
  69:rowBuffer.c   **** //          64 pixels across * 64 pixels down is 4096 bytes
  70:rowBuffer.c   **** //          WAY more than my RAM
  71:rowBuffer.c   **** //          So either way we need to precalculate each row before
  72:rowBuffer.c   **** //          displaying it
  73:rowBuffer.c   **** //          Could be as simple as loading direct from program memory
  74:rowBuffer.c   **** 
  75:rowBuffer.c   **** 
  76:rowBuffer.c   **** 
  77:rowBuffer.c   **** #define LOADROW	TRUE
  78:rowBuffer.c   **** 
  79:rowBuffer.c   **** #define RB_WIDTH 64 //100
  80:rowBuffer.c   **** #define RB_HEIGHT 48
  81:rowBuffer.c   **** uint8_t rowBuffer[RB_WIDTH];
  82:rowBuffer.c   **** 
  83:rowBuffer.c   **** 
  84:rowBuffer.c   **** //Convert from a frameBuffer color to a rowBuffer setting value...
  85:rowBuffer.c   **** uint8_t fb_to_rb(uint8_t fbColor)
  86:rowBuffer.c   **** {
 1296               		.stabn	68,0,86,.LM132-.LFBB12
 1297               	.LM132:
 1298               	.LFBB12:
 1299               	/* prologue: function */
 1300               	/* frame size = 0 */
  87:rowBuffer.c   ****    uint8_t rb = 0;
  88:rowBuffer.c   **** 
  89:rowBuffer.c   ****    //rb bit: 7 6 5 4 3 2 1 0
  90:rowBuffer.c   ****    //        \_ _/ \_ _/ \ /
  91:rowBuffer.c   ****    //          V     V    V
  92:rowBuffer.c   ****    //          |     |    Green Setting
  93:rowBuffer.c   ****    //          |     Red Setting
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 118


  94:rowBuffer.c   ****    //          Blue Setting
  95:rowBuffer.c   **** 
  96:rowBuffer.c   ****    // Frame Buffer color/shade values:
  97:rowBuffer.c   ****    //fb bit: 7 6 5 4 3 2 1 0
  98:rowBuffer.c   ****    //        \ / \ / \ / \ /
  99:rowBuffer.c   ****    //         V   V   V   V
 100:rowBuffer.c   ****    //         |   |   |   Red Value (0-3)
 101:rowBuffer.c   ****    //         |   |   Green Value (0-3)
 102:rowBuffer.c   ****    //         |   Blue Value (0-3)
 103:rowBuffer.c   ****    //         Alpha... only partially implemented
 104:rowBuffer.c   **** 
 105:rowBuffer.c   **** #warning "This isn't at all optimized..."
 106:rowBuffer.c   ****    // Blue setting = Blue Value | 0x04
 107:rowBuffer.c   ****    uint8_t blueValue = (fbColor & 0x30) >> 4;
 1301               		.stabn	68,0,107,.LM133-.LFBB12
 1302               	.LM133:
 1303 0554 682F      		mov r22,r24
 1304 0556 70E0      		ldi r23,lo8(0)
 108:rowBuffer.c   ****    rb = (blueValue << 5) | 0x80;
 109:rowBuffer.c   **** 
 110:rowBuffer.c   ****    // Red setting = redVal << 1 | redVal & 0x01
 111:rowBuffer.c   ****    uint8_t redValue = (fbColor & 0x03);
 112:rowBuffer.c   ****    rb |= ((redValue << 1) | (redValue & 0x01)) << 2;
 1305               		.stabn	68,0,112,.LM134-.LFBB12
 1306               	.LM134:
 1307 0558 8370      		andi r24,lo8(3)
 1308 055a 90E0      		ldi r25,lo8(0)
 1309 055c 9C01      		movw r18,r24
 1310 055e 2170      		andi r18,lo8(1)
 1311 0560 3070      		andi r19,hi8(1)
 1312 0562 880F      		lsl r24
 1313 0564 991F      		rol r25
 1314 0566 282B      		or r18,r24
 1315 0568 392B      		or r19,r25
 1316 056a 220F      		lsl r18
 1317 056c 331F      		rol r19
 1318 056e 220F      		lsl r18
 1319 0570 331F      		rol r19
 1320 0572 2068      		ori r18,lo8(-128)
 1321 0574 AB01      		movw r20,r22
 1322 0576 4073      		andi r20,lo8(48)
 1323 0578 5070      		andi r21,hi8(48)
 1324 057a 440F      		lsl r20
 1325 057c 551F      		rol r21
 1326 057e 242B      		or r18,r20
 1327 0580 CB01      		movw r24,r22
 1328 0582 8C70      		andi r24,lo8(12)
 1329 0584 9070      		andi r25,hi8(12)
 1330 0586 9595      		asr r25
 1331 0588 8795      		ror r24
 1332 058a 9595      		asr r25
 1333 058c 8795      		ror r24
 113:rowBuffer.c   **** 
 114:rowBuffer.c   ****    // Green Setting = Green Value...
 115:rowBuffer.c   ****    uint8_t greenValue = (fbColor & 0x0C) >> 2;
 116:rowBuffer.c   ****    rb |= greenValue;
 117:rowBuffer.c   **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 119


 118:rowBuffer.c   ****    return rb;
 119:rowBuffer.c   **** }
 1334               		.stabn	68,0,119,.LM135-.LFBB12
 1335               	.LM135:
 1336 058e 822B      		or r24,r18
 1337               	/* epilogue start */
 1338 0590 0895      		ret
 1339               		.size	fb_to_rb, .-fb_to_rb
 1340               		.stabs	"rb:r(3,2)",64,0,87,18
 1341               		.stabn	192,0,0,.LFBB12-.LFBB12
 1342               		.stabn	224,0,0,.Lscope12-.LFBB12
 1343               	.Lscope12:
 1344               		.stabs	"",36,0,0,.Lscope12-.LFBB12
 1345               		.stabd	78,0,0
 1346               		.stabs	"pll_enable:F(0,15)",36,0,1219,pll_enable
 1347               	.global	pll_enable
 1348               		.type	pll_enable, @function
 1349               	pll_enable:
 1350               		.stabd	46,0,0
 1351               		.stabs	"main.c",132,0,0,.Ltext6
 1352               	.Ltext6:
1220:main.c        **** {
 1353               		.stabn	68,0,1220,.LM136-.LFBB13
 1354               	.LM136:
 1355               	.LFBB13:
 1356               	/* prologue: function */
 1357               	/* frame size = 0 */
1230:main.c        ****    setbit(PLLE, PLLCSR);
 1358               		.stabn	68,0,1230,.LM137-.LFBB13
 1359               	.LM137:
 1360 0592 89B5      		in r24,73-0x20
 1361 0594 8260      		ori r24,lo8(2)
 1362 0596 89BD      		out 73-0x20,r24
 1363               	.LBB92:
 1364               	.LBB93:
 1365               	.LBB94:
 1366               	.LBB95:
 1367               	.LBB96:
 1368               	.LBB97:
 1369               		.stabs	"/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h",132,0,0,.Ltext7
 1370               	.Ltext7:
   1:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** /* Copyright (c) 2002, Marek Michalkiewicz
   2:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****    Copyright (c) 2007 Joerg Wunsch
   3:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****    All rights reserved.
   4:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
   5:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****    Redistribution and use in source and binary forms, with or without
   6:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****    modification, are permitted provided that the following conditions are met:
   7:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
   8:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****    * Redistributions of source code must retain the above copyright
   9:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****      notice, this list of conditions and the following disclaimer.
  10:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  11:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****    * Redistributions in binary form must reproduce the above copyright
  12:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****      notice, this list of conditions and the following disclaimer in
  13:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****      the documentation and/or other materials provided with the
  14:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****      distribution.
  15:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  16:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****    * Neither the name of the copyright holders nor the names of
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 120


  17:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****      contributors may be used to endorse or promote products derived
  18:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****      from this software without specific prior written permission.
  19:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  20:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  21:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****   AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  22:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  23:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****   ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
  24:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****   LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
  25:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****   CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
  26:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****   SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
  27:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****   INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
  28:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****   CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
  29:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  30:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****   POSSIBILITY OF SUCH DAMAGE. */
  31:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  32:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** /* $Id: delay_basic.h 2143 2010-06-08 21:19:51Z joerg_wunsch $ */
  33:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  34:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** #ifndef _UTIL_DELAY_BASIC_H_
  35:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** #define _UTIL_DELAY_BASIC_H_ 1
  36:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  37:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** #include <inttypes.h>
  38:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  39:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** #if !defined(__DOXYGEN__)
  40:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** static inline void _delay_loop_1(uint8_t __count) __attribute__((always_inline));
  41:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** static inline void _delay_loop_2(uint16_t __count) __attribute__((always_inline));
  42:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** #endif
  43:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  44:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** /** \file */
  45:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** /** \defgroup util_delay_basic <util/delay_basic.h>: Basic busy-wait delay loops
  46:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     \code
  47:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     #include <util/delay_basic.h>
  48:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     \endcode
  49:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  50:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     The functions in this header file implement simple delay loops
  51:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     that perform a busy-waiting.  They are typically used to
  52:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     facilitate short delays in the program execution.  They are
  53:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     implemented as count-down loops with a well-known CPU cycle
  54:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     count per loop iteration.  As such, no other processing can
  55:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     occur simultaneously.  It should be kept in mind that the
  56:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     functions described here do not disable interrupts.
  57:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  58:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     In general, for long delays, the use of hardware timers is
  59:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     much preferrable, as they free the CPU, and allow for
  60:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     concurrent processing of other events while the timer is
  61:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     running.  However, in particular for very short delays, the
  62:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     overhead of setting up a hardware timer is too much compared
  63:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     to the overall delay time.
  64:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  65:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     Two inline functions are provided for the actual delay algorithms.
  66:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  67:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** */
  68:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  69:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** /** \ingroup util_delay_basic
  70:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  71:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     Delay loop using an 8-bit counter \c __count, so up to 256
  72:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     iterations are possible.  (The value 256 would have to be passed
  73:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     as 0.)  The loop executes three CPU cycles per iteration, not
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 121


  74:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     including the overhead the compiler needs to setup the counter
  75:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     register.
  76:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  77:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     Thus, at a CPU speed of 1 MHz, delays of up to 768 microseconds
  78:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     can be achieved.
  79:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** */
  80:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** void
  81:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** _delay_loop_1(uint8_t __count)
  82:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** {
  83:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 	__asm__ volatile (
  84:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 		"1: dec %0" "\n\t"
  85:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 		"brne 1b"
  86:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 		: "=r" (__count)
  87:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 		: "0" (__count)
  88:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 	);
  89:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** }
  90:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  91:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** /** \ingroup util_delay_basic
  92:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  93:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     Delay loop using a 16-bit counter \c __count, so up to 65536
  94:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     iterations are possible.  (The value 65536 would have to be
  95:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     passed as 0.)  The loop executes four CPU cycles per iteration,
  96:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     not including the overhead the compiler requires to setup the
  97:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     counter register pair.
  98:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 
  99:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     Thus, at a CPU speed of 1 MHz, delays of up to about 262.1
 100:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****     milliseconds can be achieved.
 101:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h ****  */
 102:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** void
 103:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** _delay_loop_2(uint16_t __count)
 104:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** {
 105:/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h **** 	__asm__ volatile (
 1371               		.stabn	68,0,105,.LM138-.LFBB13
 1372               	.LM138:
 1373 0598 88EC      		ldi r24,lo8(200)
 1374 059a 90E0      		ldi r25,hi8(200)
 1375               	/* #APP */
 1376               	 ;  105 "/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h" 1
 1377 059c 0197      		1: sbiw r24,1
 1378 059e 01F4      		brne 1b
 1379               	 ;  0 "" 2
 1380               	/* #NOAPP */
 1381 05a0 00C0      		rjmp .L96
 1382               	.L97:
 1383               	.LBE97:
 1384               	.LBE96:
 1385               	.LBE95:
 1386               	.LBE94:
 1387               	.LBE93:
 1388               	.LBE92:
 1389               		.stabs	"main.c",132,0,0,.Ltext8
 1390               	.Ltext8:
1238:main.c        ****       asm("nop");
 1391               		.stabn	68,0,1238,.LM139-.LFBB13
 1392               	.LM139:
 1393               	/* #APP */
 1394               	 ;  1238 "main.c" 1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 122


 1395 05a2 0000      		nop
 1396               	 ;  0 "" 2
 1397               	/* #NOAPP */
 1398               	.L96:
1236:main.c        ****    while(!getbit(PLOCK, PLLCSR))
 1399               		.stabn	68,0,1236,.LM140-.LFBB13
 1400               	.LM140:
 1401 05a4 09B4      		in __tmp_reg__,73-0x20
 1402 05a6 00FE      		sbrs __tmp_reg__,0
 1403 05a8 00C0      		rjmp .L97
1241:main.c        ****    setbit(PCKE, PLLCSR);
 1404               		.stabn	68,0,1241,.LM141-.LFBB13
 1405               	.LM141:
 1406 05aa 89B5      		in r24,73-0x20
 1407 05ac 8460      		ori r24,lo8(4)
 1408 05ae 89BD      		out 73-0x20,r24
 1409               	/* epilogue start */
1243:main.c        **** }
 1410               		.stabn	68,0,1243,.LM142-.LFBB13
 1411               	.LM142:
 1412 05b0 0895      		ret
 1413               		.size	pll_enable, .-pll_enable
 1414               		.stabs	"__count:r(3,4)",64,0,138,24
 1415               		.stabn	192,0,0,.LBB96-.LFBB13
 1416               		.stabn	224,0,0,.LBE96-.LFBB13
 1417               	.Lscope13:
 1418               		.stabs	"",36,0,0,.Lscope13-.LFBB13
 1419               		.stabd	78,0,0
 1420               		.stabs	"lvds_timerInit:F(0,15)",36,0,1245,lvds_timerInit
 1421               	.global	lvds_timerInit
 1422               		.type	lvds_timerInit, @function
 1423               	lvds_timerInit:
 1424               		.stabd	46,0,0
1246:main.c        **** {
 1425               		.stabn	68,0,1246,.LM143-.LFBB14
 1426               	.LM143:
 1427               	.LFBB14:
 1428               	/* prologue: function */
 1429               	/* frame size = 0 */
1252:main.c        ****    OCR1C = 6;
 1430               		.stabn	68,0,1252,.LM144-.LFBB14
 1431               	.LM144:
 1432 05b2 86E0      		ldi r24,lo8(6)
 1433 05b4 8BBD      		out 75-0x20,r24
1255:main.c        **** 	CLOCK_OCR = 3; //2; //3;
 1434               		.stabn	68,0,1255,.LM145-.LFBB14
 1435               	.LM145:
 1436 05b6 83E0      		ldi r24,lo8(3)
 1437 05b8 8CBD      		out 76-0x20,r24
1287:main.c        ****    OSCCAL = OSCCAL_VAL;
 1438               		.stabn	68,0,1287,.LM146-.LFBB14
 1439               	.LM146:
 1440 05ba 8FEF      		ldi r24,lo8(-1)
 1441 05bc 81BF      		out 81-0x20,r24
1354:main.c        **** 	pll_enable();
 1442               		.stabn	68,0,1354,.LM147-.LFBB14
 1443               	.LM147:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 123


 1444 05be 00D0      		rcall pll_enable
1366:main.c        **** 	writeMasked(CSBITS, 
 1445               		.stabn	68,0,1366,.LM148-.LFBB14
 1446               	.LM148:
 1447 05c0 8FB5      		in r24,79-0x20
 1448 05c2 807F      		andi r24,lo8(-16)
 1449 05c4 8460      		ori r24,lo8(4)
 1450 05c6 8FBD      		out 79-0x20,r24
1373:main.c        **** 	writeMasked(DTPSBITS,
 1451               		.stabn	68,0,1373,.LM149-.LFBB14
 1452               	.LM149:
 1453 05c8 8FB5      		in r24,79-0x20
 1454 05ca 8063      		ori r24,lo8(48)
 1455 05cc 8FBD      		out 79-0x20,r24
1385:main.c        **** 	setbit(PWM1A, TCCR1A);  //Enable PWM on OC1A for DVH
 1456               		.stabn	68,0,1385,.LM150-.LFBB14
 1457               	.LM150:
 1458 05ce 80B7      		in r24,80-0x20
 1459 05d0 8260      		ori r24,lo8(2)
 1460 05d2 80BF      		out 80-0x20,r24
1388:main.c        **** 	setbit(PWM1B, TCCR1A);  //Enable PWM on OC1B for CLOCK 
 1461               		.stabn	68,0,1388,.LM151-.LFBB14
 1462               	.LM151:
 1463 05d4 80B7      		in r24,80-0x20
 1464 05d6 8160      		ori r24,lo8(1)
 1465 05d8 80BF      		out 80-0x20,r24
1390:main.c        **** 	setbit(PWM1D, TCCR1C);
 1466               		.stabn	68,0,1390,.LM152-.LFBB14
 1467               	.LM152:
 1468 05da 87B5      		in r24,71-0x20
 1469 05dc 8160      		ori r24,lo8(1)
 1470 05de 87BD      		out 71-0x20,r24
1394:main.c        **** 	setoutPORT(PB1, PORTB);	//+OC1A, DVH/BLUE, MISO (usually heart)
 1471               		.stabn	68,0,1394,.LM153-.LFBB14
 1472               	.LM153:
 1473 05e0 B99A      		sbi 55-0x20,1
1396:main.c        **** 	setoutPORT(PB2, PORTB); //-OC1B, -GREEN	 (INVERTED) SCK
 1474               		.stabn	68,0,1396,.LM154-.LFBB14
 1475               	.LM154:
 1476 05e2 BA9A      		sbi 55-0x20,2
1397:main.c        **** 	setoutPORT(PB3, PORTB); //+OC1B Clock (OC1B, not inverted)
 1477               		.stabn	68,0,1397,.LM155-.LFBB14
 1478               	.LM155:
 1479 05e4 BB9A      		sbi 55-0x20,3
1398:main.c        **** 	setoutPORT(PB5, PORTB); //+OC1D, RED
 1480               		.stabn	68,0,1398,.LM156-.LFBB14
 1481               	.LM156:
 1482 05e6 BD9A      		sbi 55-0x20,5
1401:main.c        ****    writeMasked(((0<<WGM11) | (0<<WGM10)), //FastPWM (combined with above)
 1483               		.stabn	68,0,1401,.LM157-.LFBB14
 1484               	.LM157:
 1485 05e8 86B5      		in r24,70-0x20
 1486 05ea 8C7F      		andi r24,lo8(-4)
 1487 05ec 86BD      		out 70-0x20,r24
1468:main.c        **** 	TCCR1C = ( (1<<COM1D1) | (0<<COM1D0)
 1488               		.stabn	68,0,1468,.LM158-.LFBB14
 1489               	.LM158:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 124


 1490 05ee 89E0      		ldi r24,lo8(9)
 1491 05f0 87BD      		out 71-0x20,r24
1471:main.c        **** 	TCCR1A = ( (0<<COM1A1) | (1<<COM1A0) 
 1492               		.stabn	68,0,1471,.LM159-.LFBB14
 1493               	.LM159:
 1494 05f2 83E6      		ldi r24,lo8(99)
 1495 05f4 80BF      		out 80-0x20,r24
1502:main.c        ****  	Nada_init();
 1496               		.stabn	68,0,1502,.LM160-.LFBB14
 1497               	.LM160:
 1498 05f6 80E3      		ldi r24,lo8(48)
 1499 05f8 84BD      		out 68-0x20,r24
 1500 05fa 84E0      		ldi r24,lo8(4)
 1501 05fc 8DBD      		out 77-0x20,r24
 1502               	/* epilogue start */
1503:main.c        **** }
 1503               		.stabn	68,0,1503,.LM161-.LFBB14
 1504               	.LM161:
 1505 05fe 0895      		ret
 1506               		.size	lvds_timerInit, .-lvds_timerInit
 1507               	.Lscope14:
 1508               		.stabs	"",36,0,0,.Lscope14-.LFBB14
 1509               		.stabd	78,0,0
 1510               		.stabs	"lcd_Init:F(0,15)",36,0,870,lcd_Init
 1511               	.global	lcd_Init
 1512               		.type	lcd_Init, @function
 1513               	lcd_Init:
 1514               		.stabd	46,0,0
 1515               		.stabs	"_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c",132,0,0,.Ltext9
 1516               	.Ltext9:
   1:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //lcdStuff 0.51ncf-git
   2:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
   3:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.51ncf-git first attempt at using git for uploading to googleCode...
   4:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        this version isn't yet used by any projects
   5:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.50ncf cleanup, colorOverride is unused...
   6:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //				SMILEY -> LCD_SMILEY
   7:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.40ncf-1 loadRow unused... removal untested...
   8:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.40ncf drawPix...
   9:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.30ncf-6 HSYNC_INACTIVE, etc. definable elsewhere
  10:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.30ncf-5 Adding BLUE_VERT_BAR_REVERSED
  11:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.30ncf-4 Adding NOTES: DON'T START WITH BLUE_DIAG_BAR
  12:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.30ncf-3 T_DV and T_Vlow overrideable
  13:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.30ncf-2 Not sure if I've modified it between... but here: 
  14:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        FRAME_COUNT_TO_DELAY wasn't defined, giving warnings
  15:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.30ncf-1 updateLCD() has return-values for state-switches
  16:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          (VFP, VSync, VBP, DE)
  17:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        ACTUALLY, that's unnecessary... state-transitions can be
  18:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        determined by vSync and dataEnable...
  19:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.30ncf Haven't been keeping these backed up regularly...
  20:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        More toward realtime adjustable timing values
  21:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        V Front Porch now occurs at the beginning of the frame, instead
  22:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        of at the end...
  23:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
  24:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.20ncf More Timing Value experiment preparation... 
  25:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.10ncf-3ish looking into reloading methods for e.g. experimenting with
  26:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          timing values: sdramThing2.0-7
  27:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          How to "move" timing-values around data which needn't be
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 125


  28:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          changed...
  29:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.10ncf-andsomemore
  30:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          Added MAKELONG to fix integer overflow warnings
  31:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          Revised it from "... + MAKELONG" to "MAKELONG(...)"
  32:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          (The +MAKELONG version is lost in the ether... if you *really*
  33:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //           want it, there's a localized version in sdramThing2.0-6)
  34:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.10ncf-1ish - Adding HSYNC_COUNT_FRAME_COMPLETE
  35:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //               Removal of LVDS_PRESCALER stuff...
  36:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //0.10ncf - Stolen from LCDdirectLVDS/54-moreColorStuff/main.c
  37:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          Removal of LCDdirectLVDS-specific stuff...
  38:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //				A little bit of rewriting of notes to be more generalized
  39:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          All delay_cyc references replaced with delay_Dots,
  40:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //					math changed accordingly...
  41:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
  42:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
  43:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // I hereby declare this FPD-Link simulation technique to forever be called
  44:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  PW-BANGing
  45:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
  46:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // a/o 0.10ncf-4: (sdramThing2.0v8-28)
  47:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   DON'T START WITH BLUE_DIAG_BAR
  48:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Unless you want to be depressed
  49:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Good Starting Point DE_BLUE
  50:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
  51:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
  52:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
  53:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //new notes a/o 0.10ncf-3ish:
  54:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // The basic idea is that timing is something that needs to be experimented
  55:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // with, often... so, for cases where LCD timing/drawing data is loaded
  56:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // beforehand (e.g. sdramThing2.0-7), it would be nice not to have to
  57:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // reload *all* the data, only to change the necessary timing data
  58:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
  59:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Neglecting the SDRAM for a second, we have essentially:
  60:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // (The exact placement is not necessarily in order... e.g. DH_DOTS could
  61:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  be at the end of a row, or at the beginning... VSYNC rows could be at
  62:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  the top, or at the bottom.....)
  63:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // (See also notes "Here's how it worked pre-lvds:", which actually are a
  64:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   bit off, e.g. I don't think VSYNC L->H was delayed by DE_TIME after
  65:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Hsync)
  66:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
  67:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // H_LOW_DOTS + HD_DOTS + DH_DOTS = "Horizontal Blank Time"
  68:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // (This "front/back" thing always confused me...
  69:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  DH_DOTS is *in front of* Hsync as far as *time* is concerned...
  70:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  i.e. looking at a 'scope trace... But something about reading left-to-
  71:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  right causes me to feel like "front" is the furthest to the right
  72:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  which would be *later* in time... weird.
  73:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  
  74:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
  75:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        |--|<--H_LOW_DOTS                       "Horiz Front Porch"
  76:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        |  |--|<--HD_DOTS="Horiz Back Porch"    |<---->|<--DH_DOTS
  77:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        |  .  .                                 .      |
  78:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        |<............................................./
  79:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        |  .  .                                 .    
  80:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        v  v  .                                 .      
  81:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     /V _______________________________________________  \ VSYNC Rows
  82:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     /H |__|
  83:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     DE _______________________________________________  /  T_Vlow times)
  84:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              .                                 .
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 126


  85:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              .                                 .      "Vsync Back Porch"
  86:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     /V 
  87:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     /H |__|
  88:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     DE _______________________________________________  /  T_VD times)
  89:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              .                                 .         "Vbp should be
  90:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              v                                 v          static"
  91:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              ***********************************
  92:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              *                                 *
  93:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     /V 
  94:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     /H |__|
  95:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     DE ______||______   /
  96:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              *                                 *
  97:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              *<------ DE_ACTIVE_DOTS --------->*        (Repeat V_COUNT
  98:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              *      .                          *         =1024 times)
  99:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                     .   Displayed Pixels
 100:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              *      .                          *
 101:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              *                                 *
 102:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              *                                 *
 103:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     /V 
 104:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     /H |__|
 105:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     DE ______||______   /
 106:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              *                                 *
 107:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              ***********************************      
 108:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                                                      "Vsync Front Porch"
 109:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     /V 
 110:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     /H |__|
 111:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     DE _______________________________________________  /  T_DV times)
 112:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 113:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 114:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #warning "TODO Maybe: LCDdirectLVDS (which so far is the only version which synced with such low re
 115:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 116:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Front vs. Back porches....
 117:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   If I were to draw a car driving down a street... 
 118:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   I would draw it with its front to the right, driving to the right...
 119:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 120:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       _____/\________     \O/
 121:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   ...|__   _________   __\     |
 122:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      ...\_/         \_/       / \							//
 123:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 124:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   The person is *in front of* the car... which means the car has not yet
 125:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   arrived at the person, but will soon... 
 126:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   (later in time, not *before* in time)
 127:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  This is my logic...
 128:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   So The "Horizontal Front Porch", to me, should be to the RIGHT of the
 129:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Horizontal Sync Pulse...
 130:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   But that ain't how it is (unless I've confused myself into a circle
 131:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   where my logic is actually right, and I just think it's wrong?)
 132:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   
 133:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  By the logic that the front porch occurs *before* the sync pulse,
 134:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   ... I suppose we could think of a person in front of a house... it
 135:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   makes more sense, anyhow, since it's a porch in front of a house, 
 136:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   not person in front of a car.
 137:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   The person's walking into the house, crosses the *front*-porch 
 138:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   *before* enterring the doorway. If he continues walking all the way
 139:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   through the house and out the back-door, he'll be crossing the *back*
 140:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   porch later in time...
 141:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 127


 142:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Right, so the logic makes sense... but for some reason I have to run 
 143:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  through this whole diatribe every time I see the terms.
 144:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Heh, and even after going through it, the damned thing seems backwards.
 145:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (Probably because I drew it with the front-porch to the right side...)
 146:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (AND THEN there's the issue that it seems to me like the front-porch
 147:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   should be to the left of the drawing-area whereas the back-porch
 148:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   should be to the right of it... rather than to the HSYNC pulse)
 149:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 150:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 151:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Anyways, all that drawing was to figure out where to position this
 152:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // in memory, such that it would be the least processing-effort to modify
 153:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // timing values for testing... (because loading the SDRAM's free-running 
 154:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // data takes ~20minutes!)
 155:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 156:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 157:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 158:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Options LTN, IDT, or TESTVALS
 159:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // IDT display *still* doesn't sync... maybe my H/V signals aren't right
 160:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef DISPLAY
 161:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DISPLAY TESTVALS //LTN //TESTVALS //IDT //LTN
 162:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 163:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 164:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //oldNote:
 165:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // TODO: Between OSCCAL_VAL and FRAME_UPDATE_DELAY
 166:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  it seems the speed (at least for the LTN) isn't so important after all
 167:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  This could be used to my advantage...
 168:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Maybe bump OSCCAL_VAL all the way up, but use a slower "bit-rate"
 169:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Thus, pixels could be skinnier, thus higher-resolution.
 170:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Or more instructions could be used for the same resolution
 171:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   allowing, e.g. sprites from program-memory, without necessitating a
 172:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   large (or any?) frame-buffer...
 173:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 174:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 175:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //This would normally be 0 for the highest-speed frame-refresh possible
 176:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // However, increasing this value can slow the frame-refresh rate
 177:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   if desired
 178:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // e.g. 50000 causes it to refresh ~ every few seconds
 179:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   (durn-near the limit for how long the LCD will retain an image)
 180:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // The benefit being that it doesn't flicker at annoying rates for
 181:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  stationary images
 182:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  worth exploring...
 183:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // This may be highly dependent on the screen capabilities...
 184:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   of course, this sorta thing is undocumented
 185:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   it just has to be experimented with
 186:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Further, it may be quite hard on the Liquid Crystals, since they'd 
 187:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   likely be driven DC... not sure what the long term effects are.
 188:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // This could be a hell of a lot more sophisticated...
 189:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // e.g. refresh after a frameBuffer change
 190:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      refresh based on a seconds-timer
 191:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      ...
 192:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // AS-IS: Does refreshes completely independent of the frame-buffer
 193:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      if it's too slow, some images may be missed completely.
 194:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      This is not true for FRAME_SYNC TRUE (below)
 195:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      (and it's not really useful anymore with FRAME_SYNC)
 196:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // a/o sdramThing2.0, this is not really relevent...
 197:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // 	if the frame needs updating, just stop free-running, right?
 198:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // 	well, doing-so might cause issues, since the LVDS clock will not be
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 128


 199:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    running... this is a TBD
 200:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define FRAME_UPDATE_DELAY 0//5000//50000 //2000 //5000 //20000 //50000
 201:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 202:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 203:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //New Idea:
 204:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Disable the Hsync timer interrupt after the frame completes
 205:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  and reenable elsewhere...
 206:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (It seems pixels changing from one shade to another take an
 207:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   intermediate step halfway between)
 208:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (Thus, two updates then a pause might clear that up)
 209:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (Duh... it doesn't clear that up, because the fastest refresh rate
 210:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   is the same...)
 211:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (but it is an interesting effect)
 212:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (Double-Duh... I was using a slow refresh with FRAME_UPDATE_DELAY)
 213:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Reworded: Having several frame refreshes before a pause helps to
 214:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  "solidify" the color changes... especially the sharp changes 
 215:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (e.g. yellow<->black)
 216:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (Side Note: I saw this effect on a regular (NON-LVDS) TFT display 
 217:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   in LCDdirect that was only connected such that R, G, and B were each
 218:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   either full-off or full-on, i.e. all Red bits were connected to a
 219:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   single output pin (full on when 1, full off when 0).
 220:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   I hadn't attributed it to improper refresh synchronization
 221:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   as the refresh rate was too fast to see... That's a handy way to get
 222:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   intermediate shades/colors without refresh-flicker from pulsing them!)
 223:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  connected with each color 
 224:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  0 means no delay (except FRAME_UPDATE_DELAY) via interrupt disabling
 225:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  If you WANT this effect (for intermediate shades?) 
 226:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   set FRAME_COUNT_TO_DELAY to 1
 227:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Then, each change of color will (apparently) result in a value halfway
 228:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   between the old color and the new color
 229:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Not sure whether it's an electrical problem, but these half-shades 
 230:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   appear dithered, sometimes ugilly, sometimes it's nice. I guess it
 231:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   depends on the goal...
 232:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#define FRAME_COUNT_TO_DELAY 2//7//1//5//2//3
 233:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 234:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 235:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //A/O v13: Using the Samsung LTN display, instead of the IDTech IAXG
 236:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // LTN appears to be content with my pseudo-LVDS scheme.
 237:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // IAXG has never unblanked
 238:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      Even though suitable timings were found with SwitchResX
 239:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      Maybe due to psuedo-LVDS
 240:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            slight timing issues // It probably doesn't work with all cases...
 241:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Definitely with drawPix/Images...(RC oscillator variances?)
 242:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            glitches when switching LVDS states 
 243:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 (thought I had that figured out, originally)
 244:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      The fact the LTN appears to recognize the signalling suggests the
 245:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      IAXG would be worth further exploration...
 246:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //         Unfortunately, the CCFT blew out my inverter
 247:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                        And I must have put it back together incorrectly
 248:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                        (backlight filters out of order or flipped?)
 249:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                        (which actually makes for some very interesting
 250:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                         visuals, but hard to develop with)
 251:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      IAXG: uses DE, V, and H
 252:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //             At low pixel-clock DE is active for fewer pixels...
 253:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              Last Tested: 680 was full-screen
 254:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //             Nice because it increases the frame-rate!
 255:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      LTN:  uses DE only
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 129


 256:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 257:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 258:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // The idea is to use FastPWM with the PLL to implement 64-85Mbits/sec
 259:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (the PLL on the Tiny861 supposedly maxes out at 85MHz)
 260:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (Though I am currently running with OSCAL set to the highest frequency
 261:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   and the PLL seems to be syncing at about 128MHz)
 262:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (New Note, a/o sdramThing2.0v5... it's kinda ironic that I was able to
 263:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   run it at 128MHz with nothing more than an AVR and some gates...
 264:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   seeing as how sdramThing has been fidgetty just running at 8MHz
 265:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Anyways, an eventual goal is to run at 133MHz+, using basically
 266:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   nothing more than the SDRAM itself for timing and refreshes...
 267:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   would allow for full resolution and full color-depth)
 268:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 269:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 270:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 271:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 272:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Wiring:
 273:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Many iterations of AVR->Differential "LVDS" circuitry resulted in the
 274:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   simplest of all:
 275:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 276:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Believe it or not, the XOR is a standard TTL LS-series XOR: 74LS86
 277:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     Specifically: TI SN74LS86N from 1980 (the only XOR in my collection)
 278:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   It's spec'd to run from 4.5-5.5V, and its propagation delays and slew
 279:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     rates aren't really spec'd to be good enough for 128MHz pixel clock
 280:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     yet it's working...
 281:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Further, the output voltages are right in the LVDS range,
 282:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     IIRC (last I 'scoped) around 1.5V High and 1.0V Low
 283:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      (Don't forget the LCD has a 100ohm resistor between
 284:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //         RXinN/clk+ and RXinN/clk-)
 285:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 286:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   It's probably best to use two XORs from the same chip for a single
 287:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    LVDS channel, since different chips may have slightly different
 288:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    characteristics. 
 289:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 290:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   The entire circuit, thus, requires TWO 74LS86's 
 291:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    (four XORs apiece, two per LVDS channel, 8-total)
 292:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 293:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 294:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              VCC3V3   VCC3V3
 295:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                |        |                           ______________
 296:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                +---\ \-_                        |  LCD (1 channel
 297:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                     | |    -                      |       of 4)
 298:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                     | | XOR   >------> RXinN/clk-  | ----.
 299:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   AVR, etc.         | |    _-                      |     |
 300:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   3.3V TTL >---+---/ /___-                        |     \ 100
 301:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   output       |                                   |     /
 302:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                |                                   |     \ ohms
 303:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                |                                   |     /
 304:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                `---\ \-_                        |     |
 305:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                     | |    -                      |     |
 306:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                     | | XOR   >------> RXinN/clk+  | ----'
 307:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                     | |    _-                      |
 308:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                +---/ /___-                        |
 309:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                |        |                          |
 310:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //               GND      GND
 311:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 312:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 130


 313:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Also used: The TTL 74AHC series...
 314:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    I found some one-gang 74AHC1G32 and 74AHC1G86's on an old iBook
 315:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     motherboard. (An OR and an XOR, respectively). These are spec'd for
 316:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     3.3V operation, and faster. The output voltages appear OK for LVDS
 317:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     (with a 100ohm load in the LCD)
 318:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 319:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  NOTE: Since I only had enough of these 1-gang devices for two LVDS
 320:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     channels, I had to implement Red and Green with the LS 
 321:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     before switching all channels to the LS... Using different chips
 322:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     (specifically, different TYPES of chips) for different channels
 323:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     caused timing issues: Since the AHC is faster, the clock and Blue
 324:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     signals are synchronized, but the red and green signals were shifted
 325:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     a bit or two (resulting in "Black" appearing green)
 326:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 327:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  For other circuits attempted, see oldNotes.txt
 328:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     (and boy there were many, involving voltage dividers, AC coupling,
 329:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      reference voltages, BJT differential amplifiers... I doubt I 
 330:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      documented them all, or even most. Whoda thunk the simplest, 
 331:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      especially under- AND over-spec'd--timing, supply voltage, and
 332:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      output voltage--would be the one...?)
 333:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 334:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // LVDS/FPD-Link timing:
 335:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 336:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            |<--- (LCDdirectLVDS: "pixel") --->|
 337:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Timer1:   |<-- One Timer1 Cycle (OCR1C=6) -->|
 338:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  TCNT:     |  0   1    2    3    4    5    6  |  0   1    2    3    
 339:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            |____.____.____.____               |____.____.____.____
 340:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  RXclk+:   /         |         \    .    .    /         |         \ //
 341:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            |         |            |         |
 342:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // One Pixel: |         |<--- One FPD-Link Pixel Cycle --->|
 343:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            |                                  |
 344:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // "Blue/DVH" |____ ____v____ ____ ____v____ ____|____ ____
 345:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  RXin2:    X B3 X B2 X DE X /V X /H X B5 X B4 X B3 X B2 X ...
 346:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            | ^  ^ | 
 347:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            |         |<--Not Blue-->|         |
 348:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            |                                  |
 349:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // "Green"    |____ ____v____ ____v____ ____ ____|____ ____
 350:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  RXin1:    X G2 X G1 X B1 X B0 X G5 X G4 X G3 X G2 X G1 X ...
 351:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            | ^ ^  |  
 352:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            |         |<------->|-Not Green    |
 353:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 354:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // "Red"      |____ ____v____v____ ____ ____ ____|____ ____
 355:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  RXin0:    X R1 X R0 X G0 X R5 X R4 X R3 X R2 X R1 X R0 X ...
 356:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            | ^^     
 357:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            |         |<-->|-Not Red
 358:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 359:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Of course: The "Not Green/Red" bits above are least-significant-bits
 360:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              and basically have little/no visible effect
 361:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 362:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 363:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Implementations/prospects:
 364:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  * rowBuffer.c (more like row-settings-buffer)
 365:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     calculate a row's worth of pixels before drawing that row
 366:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     (uses packed color settings in a single byte per drawable pixel)
 367:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     64 drawable pixels across, regardless of LVDS speed
 368:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  * For faster pixels: these settings values could be stored 
 369:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     in individual bytes. Gives about 1/3 more pixels at 3x the memory
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 131


 370:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     (not implemented)
 371:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  * rowSegBuffer.c
 372:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     also calculates an entire row before drawing it
 373:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     instead of storing pixels, store "segments"
 374:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     i.e. each segment is defined by a color value and a length
 375:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     Number of segments is limited only by memory...
 376:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      e.g. 64 segments per row (max) is 64*3Bytes
 377:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       Three bytes for color, and *really simple* packing for seg-length
 378:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      BUT: at slow LVDS speeds, the resolution of these segments could be
 379:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       as high as one LCD pixel.
 380:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      possibly: at *really* low LVDS speeds we could be 64*2Bytes
 381:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      (with packing)
 382:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      Actually: Using GB_COMBINED gives 2Bytes per segment
 383:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      only adds two clock cycles to each "pixel", so probably worth it
 384:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 385:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   In Any Case: There's not enough RAM for a full frame
 386:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          64 pixels across * 64 pixels down is 4096 bytes
 387:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          So whatever method, we need to precalculate each row before
 388:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          displaying it
 389:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          Could be as simple as loading direct from program memory
 390:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 391:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 392:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Since low-bits are barely visible, their effect is neglected.
 393:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 394:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 395:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE/V/H Timing (LCDdirectLVDS):
 396:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  
 397:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 398:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            |  0   1    2    3    4    5    6       All: set @ 0
 399:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            |____.____.____.____                         OCR1C = 6 
 400:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Clock:    /                   \    .    .    /         Complementary-
 401:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                                             Output Mode
 402:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                                                          required for DT
 403:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Signal:    B3   B2   DE   /V   /H   B5   B4 | B3
 404:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //             ____ ____ ____ ____ ____ ____ ____|____    
 405:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   DE:      X B3 X B2 /    .    .    \ B5 X B4 X B3 X    
 406:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   state2                      |    
 407:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   DE_BLUE: >|    DT=X, OCR=0
 408:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                         Watch the transition!! -------^
 409:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   DE_NORM: >_________/\_________|    DT=2, OCR=4
 410:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   DC_DISABLED:
 411:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   maxBlue: >\____|		DT=0, OCR=5
 412:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //             See below for more blue settings...
 413:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 414:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //             ____ ____      ____      ____ ____|____ 
 415:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H (only): X xx X xx \    /    \    / xx X xx X xx X    
 416:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   state1              | 
 417:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            >______________/\______________|    DT=3, OCR=3
 418:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  DC_DISABLED:
 419:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Not much can be done...
 420:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 421:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //             ____ ____           ____ ____ ____|____ 
 422:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V w/o H:  X xx X xx \    .    /    \ xx X xx X xx X
 423:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   state3              |
 424:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            >___________________/\_________|    DT=4, OCR=4 (+?)
 425:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DC_DISABLED:
 426:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            >___________________/\____|		DT=4, OCR=5
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 132


 427:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 428:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //             ____ ____                ____ ____|____ 
 429:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V w/ H:   X xx X xx \    .    .    / xx X xx X xx X
 430:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   state4          | 
 431:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            >__________________________________|    DT=X, OCR=0
 432:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                             TransitionWatch!!! -------^
 433:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                             Shouldn't matter... DT from no-edge
 434:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DC_DISABLED:
 435:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            >\________________________|		DT=0, OCR=1
 436:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 437:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //             ____ ____      ____ ____ ____ ____|____ 
 438:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Nada:     X xx X xx \    /    .    \ xx X xx X xx X    
 439:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   state0                  |     
 440:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            >______________/\_________|    DT=3, OCR=4 (+?)
 441:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DC_DISABLED:
 442:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //            >______________/\____|		DT=3, OCR=5
 443:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 444:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //So far this is the only case I've seen:
 445:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // /Vsync
 446:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef VSYNC_ACTIVE
 447:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define VSYNC_ACTIVE		0
 448:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 449:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef VSYNC_INACTIVE
 450:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define VSYNC_INACTIVE	1
 451:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 452:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // /Hsync
 453:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef HSYNC_ACTIVE
 454:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define HSYNC_ACTIVE		0
 455:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 456:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef HSYNC_INACTIVE
 457:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define HSYNC_INACTIVE	1
 458:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 459:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE (active high)
 460:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef DE_ACTIVE
 461:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DE_ACTIVE			1
 462:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 463:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef DE_INACTIVE
 464:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DE_INACTIVE		0
 465:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 466:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 467:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // HERE!
 468:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 469:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 470:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 471:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 472:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Transitions: OLD!!!!! WRONG!!!!
 473:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   (are they? There're several additional transitions, now, for one.)
 474:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  The idea is to reduce the number of instructions between each
 475:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  LVDS "state."
 476:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  These are implemented below in the case:
 477:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    "#else //NOT FULL_INIT_TESTS"
 478:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Since each instruction takes *longer than* a single pixel
 479:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    two instructions would *at best* occur on two consecutive pixels
 480:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    Thus, there's likely to be a transition-glitch
 481:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    (e.g. old OCR value with new DT value)
 482:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Note that the new DT values are implemented at the next corresponding
 483:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    edge after the DT-write instruction completes
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 133


 484:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    (for +OC1A/DT1H, when TCNT is reset to 0)
 485:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    (for -OC1A/DT1L, when TCNT passes OCR1A)
 486:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    New OCR values are delayed until the next TCNT reset to 0
 487:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 488:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Initial:
 489:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Nada					DT=2  NADA_OCR = (3<=OCR<(=?)6)
 490:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 491:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Nada	->	H			OCR=2
 492:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H		->	Nada		OCR=NADA_OCR
 493:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  
 494:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Nada	->	V			DT=3
 495:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V		->	V+H		OCR=0
 496:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V+H	->	V			OCR=NADA_OCR
 497:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V		->	Nada		DT=2
 498:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 499:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Nada	->	DE			DT=1
 500:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  DE	->	Nada		DT=2
 501:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 502:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if 0
 503:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (defined(REMOVE_DC) && REMOVE_DC)
 504:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define Nada_init()         { DT1=(3<<4); OCR1A=5; }
 505:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 506:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  //Unused, normally...
 507:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define Vsync_init()       { DT1=(4<<4);  OCR1A=5; }
 508:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define VplusH_init()      { DT1=0;       OCR1A=1; }
 509:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define Hsync_init()       { DT1=(3<<4);  OCR1A=3; }
 510:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define DEonly_init()      { DT1=(2<<4);  OCR1A=4; }
 511:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define DEblue_init()		 { DT1=0;       OCR1A=5; }
 512:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 513:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #else //!REMOVE_DC
 514:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Nada init
 515:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define Nada_init()         { DT1=(3<<4); OCR1A=4; }
 516:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 517:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Unused, normally...
 518:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define Vsync_init()			{ DT1=(4<<4);	OCR1A=4; }
 519:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define VplusH_init()		{ DT1=0;			OCR1A=0; }
 520:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define Hsync_init()			{ DT1=(3<<4);	OCR1A=3; }
 521:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // #define DE_init()				{ DT1=(2<<4);	OCR1A=4; } //...SHOULD BE
 522:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define DEonly_init()			{ DT1=(2<<4);  OCR1A=4; }
 523:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define DEblue_init()			{ DT1=0;       OCR1A=6; }
 524:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#define DE_init()				{ DT1=(1<<4);	OCR1A=2; } //Works with DE_ONLY
 525:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  //#define DE_init()				{ DT1=0;			OCR1A=0xff; }	//DE_BLUE
 526:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif //REMOVE_DC
 527:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 528:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 529:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#define FULL_INIT_TESTS TRUE
 530:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 531:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Display is DE-Only (doesn't use H/Vsync)
 532:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Shouldn't be necessary to select this if it is,
 533:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // since DE timing is the same either way
 534:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // but I want to test whether a single-bit is being detected
 535:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // (e.g. maybe the rise/fall-times of the output aren't fast enough for a
 536:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  single bit, which might explain why the other display didn't work)
 537:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //These are just examples... the project should define them:
 538:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if 0
 539:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (defined(DE_ONLY_DISPLAY) && DE_ONLY_DISPLAY)
 540:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Vsync_fromNada()      Nada_init()
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 134


 541:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define VplusH_fromVsync()    Nada_init()
 542:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Vsync_fromVplusH()    Nada_init()
 543:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Nada_fromVsync()      Nada_init()
 544:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Hsync_fromNada()      Nada_init()
 545:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Nada_fromHsync()      Nada_init()
 546:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DEonly_fromNada()     DE_init()
 547:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DEblue_fromDEonly()	DE_init()
 548:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Nada_fromDEblue()		Nada_init()
 549:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #if(DE_BLUE)
 550:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "DE_BLUE is true, but not implemented with DE_ONLY_DISPLAY"
 551:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "...The display should be blank"
 552:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #endif
 553:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Use full initialization of each LVDS state
 554:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // (might not be good during transitions, but should guarantee
 555:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  steady-state, in case my transitions aren't correct...)
 556:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (defined(FULL_INIT_TESTS) && FULL_INIT_TESTS)
 557:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Vsync_fromNada()		Vsync_init()
 558:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define VplusH_fromVsync()		VplusH_init()
 559:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Vsync_fromVplusH()		Vsync_init()
 560:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Nada_fromVsync()		Nada_init()
 561:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Hsync_fromNada()		Hsync_init()
 562:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Nada_fromHsync()		Nada_init()
 563:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DEonly_fromNada()		DEonly_init()
 564:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DEblue_fromDEonly()	DEblue_init()
 565:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Nada_fromDEonly()		Nada_init()
 566:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Nada_fromDEblue()		Nada_init()
 567:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 568:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 569:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #else	//NOT FULL_INIT_TESTS
 570:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#define Vsync_fromNada()   { DT1=(4<<4); }
 571:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Vsync_fromNada()   { DT1=(4<<4); OCR1A=5; } //Leave two bits high
 572:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 																	 //for easy-scoping
 573:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 						//Three would be nicer, but I'm pretty sure OCR=TOP=ON
 574:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define VplusH_fromVsync() { OCR1A=0; }
 575:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#define Vsync_fromVplusH() { OCR1A=4; }
 576:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Vsync_fromVplusH() { OCR1A=5; }				//Extra bits for scoping
 577:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#define Nada_fromVsync()   { DT1=(3<<4); }
 578:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Nada_fromVsync()   { DT1=(3<<4); OCR1A=4; } //scoping...
 579:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Hsync_fromNada()   { OCR1A=3; }
 580:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Nada_fromHsync()   { OCR1A=4; }
 581:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 582:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Nada_fromDEblue()	{ DT1=(3<<4); OCR1A=4; }
 583:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define Nada_fromDEonly()	{ DT1=(3<<4); }
 584:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DEonly_fromNada()	{ DT1=(2<<4); }
 585:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DEblue_fromNada()	{ OCR1A=0xff; }
 586:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DEblue_fromDEonly() { OCR1A=0xff; }
 587:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 588:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif //End Of FULL_INIT_TESTS
 589:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 590:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 591:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 592:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 593:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // The typical patterns look like this (not at all to scale):
 594:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   ----______------------------------------------------______-- V
 595:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //             ....
 596:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      --_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_ H
 597:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //             ....
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 135


 598:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      __________-__-__-__-__-__-__-__-__-__-__________________  DE
 599:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 
 600:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //             ^^^^\														//blah
 601:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //             1234 5?
 602:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Pixels are sent during DE High (basically all the CPU will be used here)
 603:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Ideally, 
 604:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  there won't be any glitches when changing from one state to another
 605:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 606:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Init (pre 1):
 607:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    DeadTimerRising=1
 608:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 609:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  The states are:
 610:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   (Not necessarily accurate, just looking into necessary changes)
 611:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   (from Vsync L->H)
 612:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 613:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   1  NothingActive (long, No DE, VporchFrontTimes)
 614:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 615:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   2  Hsync
 616:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 617:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   3  NothingActive (short)
 618:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 619:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   4  DE
 620:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 621:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   5  NothingActive(?)
 622:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 623:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   7  Repeat 2-5 for each row
 624:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 625:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   8  NothingActive (long, No DE, VporchBackTimes)
 626:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 627:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   9  V w/o H
 628:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 629:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   10 V w/  H
 630:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 631:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   11 Repeat 9-10 for Vsync time...
 632:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 633:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 634:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Here's how it worked pre-lvds:
 635:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // HSYNC, VSYNC, and DE refer to the actual pins
 636:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // In the LVDS setup, there're modes corresponding to each pin-combination
 637:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 638:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Timer Interrupt:
 639:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  loadData:
 640:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   HSYNC active
 641:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   HSYNC Low delay
 642:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   HSYNC inactive
 643:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   if(dataEnable)
 644:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    DE active
 645:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     Send row data
 646:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    DE inactive
 647:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  //Prep for next interrupt
 648:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  switch(hsyncCount++)
 649:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    //Vsync H->L (active)
 650:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    1:
 651:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          dataEnable=FALSE
 652:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          VSYNC active
 653:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    //Vsync L->H (inactive)
 654:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    T_Vlow:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 136


 655:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          VSYNC inactive
 656:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    //Start of frame
 657:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    T_VD +(T_Vlow):
 658:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          dataEnable=TRUE
 659:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    //All rows have been displayed
 660:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    V_COUNT +(T_VD+T_Vlow):
 661:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          dataEnable=FALSE
 662:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    //Frame Complete
 663:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    T_DV +(V_COUNT+T_VD+T_Vlow): 
 664:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          hsyncCount=0
 665:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  if(dataEnable)
 666:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    Use the remaining time to load the next row to memory
 667:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 668:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  So:
 669:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Interrupt0       End
 670:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    |             |  Interrupt1
 671:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    v             v  v
 672:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H |_||_||_|
 673:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE ___________________________________________________ ...
 674:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V |_____________________________________ ...
 675:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       |        ||
 676:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DETIME^--------^|
 677:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 |
 678:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 VSYNC active
 679:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 dataEnable=FALSE (not necessary?)
 680:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 681:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //InterruptT_Vlow   End
 682:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    |             |
 683:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    v             v
 684:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H |_||_||_|
 685:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE ___________________________________________________ ...
 686:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V _____________| ...
 687:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       |        ||
 688:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DETIME^--------^|
 689:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 |
 690:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 VSYNC inactive
 691:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 692:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 693:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //InterruptT_VD   End  InterruptT_VD+1
 694:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    |             |  |            End
 695:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    v             v  v            v
 696:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H |_||_||_|
 697:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE ____________________||_______||____ ...
 698:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V 
 699:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       |        ||      |        |
 700:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DETIME^--------^|      ^--------^
 701:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 |
 702:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 dataEnable=TRUE
 703:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 704:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //InterruptV_COUNT  End
 705:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    |             |
 706:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    v             v
 707:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H |_||_||_|
 708:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE ___||______________________________________ ...
 709:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V 
 710:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       |        ||      |        |
 711:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DETIME^--------^|      ^--------^
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 137


 712:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 |
 713:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 dataEnable=FALSE
 714:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 715:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 716:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // This isn't really a state, it's basically just:
 717:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // if(hsyncCount == NUM_HYSYNCS_PER_FRAME)
 718:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    hsyncCount = 0;
 719:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                    .....................................
 720:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                    .                                   .
 721:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //InterruptT_DV   End .Interrupt0                         .
 722:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    |             | .|                                  .
 723:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    v             v .v                                  .
 724:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H |_||_||_|
 725:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE ___________________________________________________ .
 726:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V |____________________ .
 727:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       |        ||  .   |        |                      .
 728:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DETIME^--------^|  .   ^--------^                      .
 729:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 |  .                                   .
 730:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                 hsyncCount=0 (repeat from Interrupt0)  .
 731:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                    .                                   .
 732:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                    .....................................
 733:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 734:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 735:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 736:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // THESE STATES ARE NO LONGER ACCURATE
 737:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // ESPECIALLY THIS FIRST STATE.
 738:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // V Front Porch originally (and in these drawings) occurred at the end
 739:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // of the frame...
 740:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // More logically, it now starts at the beginning of the frame
 741:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // (Also removing this initial "glitch" of a single interrupt with
 742:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  NothingActive)
 743:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 744:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // THESE STATES ARE NO LONGER ACCURATE (a/o 0.30, for certain)
 745:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // NOW to compare with LVDS states:
 746:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 747:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Interrupt0       End
 748:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    |             |  Interrupt1
 749:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    v             v  v
 750:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H |_||_||_|
 751:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE ___________________________________________________ ...
 752:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V |_____________________________________ ...
 753:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    ^ ^          ^   ^ ^
 754:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |          |   | |
 755:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |          |   | +--- V w/o H  \ These two toggle until
 756:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |          |   +----- V w/ H   / next LCD state...
 757:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |          |
 758:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |          +--------- V w/o H > Intermediate change of state
 759:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |
 760:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | +----- NothingActive  \ From Previous State (?)
 761:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    +------- H_Only         /
 762:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 763:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 764:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //InterruptT_Vlow   End
 765:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    |             |
 766:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    v             v
 767:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H |_||_||_|
 768:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE ___________________________________________________ ...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 138


 769:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V _____________| ...
 770:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    ^ ^          ^   ^ ^
 771:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |          |   | |
 772:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |          |   | +--- NothingActive  \ These two toggle until
 773:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |          |   +----- H_Only         / next LCD state...
 774:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |          |
 775:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |          +--------- NothingActive > Intermediate change of state
 776:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |
 777:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | +----- V w/o H   \ From previous state
 778:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    +------- V w/ H    /
 779:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 780:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 781:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //InterruptT_VD   End  InterruptT_VD+1
 782:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    |             |  |            End
 783:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    v             v  v            v
 784:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H |_||_||_|
 785:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE ____________________||_______||____ ...
 786:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V 
 787:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    ^ ^              ^ ^^        ^ 
 788:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |              | ||        |
 789:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |              | ||        +--- NothingActive  \  These four
 790:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |              | |+------------ DE              | cycle until
 791:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |              | +------------- NothingActive   | next LCD state...
 792:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |              +--------------- H_Only  ^      /
 793:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |                                       |
 794:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | +----- NothingActive  \ From previous   |
 795:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    +------- H_Only         / state           +-This intermediate state
 796:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                                                may not be necessary
 797:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                                                (IAXG01 shows 160 dots!)
 798:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 799:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 800:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 801:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //InterruptV_COUNT  End
 802:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    |             |
 803:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    v             v
 804:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H |_||_||_|
 805:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE ___||______________________________________ ...
 806:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V 
 807:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    ^ ^^        ^    ^ ^
 808:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | ||        |    | |
 809:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | ||        |    | +--- NothingActive \  These two toggle
 810:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | ||        |    +----- H_Only        /  until next LCD state
 811:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | ||        |
 812:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | ||        +---- NothingActive \ 								//blah
 813:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |+------------- DE             |  From previous state
 814:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | +-------------- NothingActive  |
 815:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    +---------------- H_Only        /
 816:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 817:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // This isn't really a state, it's essentially just:
 818:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  if(hsyncCount == NUM_HSYNCS_PER_FRAME)
 819:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    hsyncCount = 0;
 820:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                    .....................................
 821:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                    .                                   .
 822:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //InterruptT_DV   End .Interrupt0                         .
 823:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    |             | .|                                  .
 824:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    v             v .v                                  .
 825:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H |_||_||_|
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 139


 826:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE ___________________________________________________ .
 827:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V |____________________ .
 828:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    ^ ^             .                                   .
 829:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | |             .....................................
 830:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    | +--- NothingActive \											//blah
 831:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    +----- H_Only        / From previous state...
 832:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 833:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 834:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 835:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  LVDS State transitions:
 836:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   1 H_Only
 837:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   2 NothingActive
 838:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 839:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   3 V w/o H
 840:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   4 V w/ H
 841:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    
 842:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   (repeat 3,4)
 843:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 844:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   5 V w/o H
 845:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 846:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   6 NothingActive
 847:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   7 H_Only
 848:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 849:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   (repeat 6,7)
 850:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 851:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   8 NothingActive
 852:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 853:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   9 H_Only
 854:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  10 NothingActive
 855:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  11 DE
 856:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  12 NothingActive
 857:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 858:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (repeat 9-12)
 859:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 860:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  13 H_Only
 861:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  14 NothingActive
 862:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 863:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (repeat 13-14)
 864:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 865:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   These should be reviewed to determine which changes are necessary
 866:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   between each state...
 867:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   (the fewer changes, the less likely we'll glitch...?)
 868:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 869:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 870:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** void lcd_Init(void)
 871:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** {
 1517               		.stabn	68,0,871,.LM162-.LFBB15
 1518               	.LM162:
 1519               	.LFBB15:
 1520               	/* prologue: function */
 1521               	/* frame size = 0 */
 872:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  	Nada_init();
 1522               		.stabn	68,0,872,.LM163-.LFBB15
 1523               	.LM163:
 1524 0600 80E3      		ldi r24,lo8(48)
 1525 0602 84BD      		out 68-0x20,r24
 1526 0604 84E0      		ldi r24,lo8(4)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 140


 1527 0606 8DBD      		out 77-0x20,r24
 1528               	/* epilogue start */
 873:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** }
 1529               		.stabn	68,0,873,.LM164-.LFBB15
 1530               	.LM164:
 1531 0608 0895      		ret
 1532               		.size	lcd_Init, .-lcd_Init
 1533               	.Lscope15:
 1534               		.stabs	"",36,0,0,.Lscope15-.LFBB15
 1535               		.stabd	78,0,0
 1536               		.stabs	"updateLCD:F(3,2)",36,0,1165,updateLCD
 1537               	.global	updateLCD
 1538               		.type	updateLCD, @function
 1539               	updateLCD:
 1540               		.stabd	46,0,0
 874:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 875:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 876:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define TESTVALS	0
 877:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define LTN 1
 878:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define IDT 2
 879:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 880:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 881:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //TIMING:
 882:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Measurements below (in microseconds) are referring to preLVDS
 883:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  There may be other such old-notes...
 884:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 885:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 886:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        |<--T_Hhigh-->| |<-T_Hlow
 887:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    __   _____________   ____________  3.6V
 888:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // H    |_|             |_|           _  0V
 889:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 890:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    Data Enable
 891:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       Only active when there's valid pixel data
 892:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       (For a dual-pixel 1024x768 display:
 893:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //         for 512 of the 717 clocks in HSYNC-active)
 894:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       Low during Vsync... (~720us)
 895:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
 896:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 897:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //IDTech display: 136 dots
 898:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //2-136+
 899:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //IDTech, last used: 40
 900:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //LTN Last used 8
 901:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // LTN: 1072<=1344<=1500 clocks per line, 1024DE... Hsync unused
 902:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // SEE Hlow_Delay() notes if this value is large!
 903:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 904:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef H_LOW_DOTS
 905:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (DISPLAY == LTN)
 906:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define H_LOW_DOTS	8
 907:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == IDT)
 908:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define H_LOW_DOTS   40//8//1//40 //30 //2//136
 909:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
 910:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define H_LOW_DOTS	100//0 //LTN doesn't use H_LOW (DE-only)
 911:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 							  // And having a value here increases codesize
 912:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 913:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 914:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 915:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //H is set low immediately upon entry of the timer interrupt
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 141


 916:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // its low-time is controlled via nops
 917:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // (so if HLow is long for a particular display, this might need revising)
 918:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 919:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if((!defined(HLOW_DELAY_OVERRIDE) || !HLOW_DELAY_OVERRIDE) \
 920:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		                                         && !defined(Hlow_Delay))
 921:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define Hlow_Delay() \
 922:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	delay_Dots(H_LOW_DOTS)
 923:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 924:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 925:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 926:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 927:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 928:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //This was found expermentally with SwitchResX
 929:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //IDTech Last Used: 680
 930:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // (IDTech had some oddities regarding slow pixel-clocks, where pixels
 931:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  would be repeated, regardless of the pixel-clock, thus, for slow clocks
 932:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  it has the effect of *stretching* the image, thus 680 "pixels" across
 933:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  instead of its 1024 *physical* pixels)
 934:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //LTN last used 1024
 935:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Oddly: For the LTN, this doesn't seem to affect the horizontal
 936:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //        it does, however, affect the vertical(!)
 937:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // If I recall Correctly, this is used only for setting the timer interrupt
 938:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  rate...
 939:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (DISPLAY == LTN)
 940:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define DE_ACTIVE_DOTS	1024
 941:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == IDT)
 942:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define DE_ACTIVE_DOTS	680 //1024 //800 //920 //943 //812 //472 //1024
 943:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
 944:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define DE_ACTIVE_DOTS	1024
 945:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 946:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 947:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 948:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Horizontal Blank Time: HD_DOTS + H_LOW + DH_DOTS
 949:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  90-320+
 950:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Horizontal Total Time: 1206<=1344<=2047
 951:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // ... but Total = Blank + Pixels, so 90+1024 != 1206
 952:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Excess waits should be thrown in DH (since that's between interrupts)
 953:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //T_HD is the time from H inactivated to DE activated
 954:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //aka H back-porch: 1-160+
 955:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //IDTech Last Used: 50
 956:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //LTN last used 5
 957:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 958:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef HD_DOTS
 959:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (DISPLAY == LTN)
 960:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define HD_DOTS 5
 961:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == IDT)
 962:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define HD_DOTS	50 //5 //0//20//5 //50 //30 //1 //160
 963:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
 964:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define HD_DOTS 50//5
 965:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 966:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 967:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 968:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef HD_Delay
 969:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define HD_Delay()	delay_Dots(HD_DOTS)
 970:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 971:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 972:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // I think this was just a mistake. This change to delay_Dots a/o 0.10ncf
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 142


 973:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // (untested in LCDdirectLVDS)
 974:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //delay_cyc(HD_DOTS)
 975:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 976:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 977:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // This is the number of CPU cycles between DE->L and Horiz->L
 978:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // This is just used in calculating the OCR value...
 979:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // aka H Front Porch: 0-24+
 980:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // IDTech Last Used: 24
 981:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // LTN last used 46
 982:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // 1072-1024-1-1 = 46
 983:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef DH_DOTS
 984:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (DISPLAY == LTN)
 985:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define DH_DOTS	46
 986:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == IDT)
 987:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define DH_DOTS	24 //46 //480//6//12//24 //46 //24 //122//30 //0 //24
 988:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
 989:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define DH_DOTS	0//1000//100//46
 990:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 991:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
 992:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
 993:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       |
 994:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       v
 995:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      T_DH
 996:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      ||    |<-T_DE->|  |  |<--T_HD (Hsync->DE)
 997:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // H   __.  ____________  .___________
 998:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      .|_|  .        .|_|  .
 999:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     _.     .________.     .___________
1000:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE   |_____| 512clk |_____|
1001:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //      ^              ^
1002:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //       \___________   \                        (just avoiding \ warning)
1003:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                   \  |     768 Hsyncs
1004:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                    v v
1005:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     _             _ _ _ _ _ _ _ _ _ _ 
1006:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE   |___________| | | | | | | | | | |______
1007:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
1008:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // one Hsync = T_HD+T_DH+T_Hlow+T_DE = 19.865us
1009:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1010:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //aka V-sync back porch: 7-29-63 "Vbp should be static"
1011:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // IDTech Last Used: 29
1012:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // LTN last used 3
1013:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //LTN Frame: 772<=806<=1000 lines...
1014:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1015:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef T_VD
1016:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (DISPLAY == LTN)
1017:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define T_VD 3
1018:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == IDT)
1019:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define  T_VD 29 //3//29 //7 //29
1020:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1021:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define T_VD 3
1022:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1023:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1024:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1025:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //aka V-sync front porch: 1-3+
1026:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // IDTech Last Used: 3
1027:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // LTN last used 3
1028:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef T_DV
1029:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (DISPLAY == LTN)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 143


1030:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define T_DV 3
1031:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == IDT)
1032:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define T_DV 3//3 //1 //3
1033:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1034:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define T_DV 3
1035:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1036:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1037:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1038:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //1-6+ (1 is used by the first switch-case...)
1039:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // IDTech Last Used: 6
1040:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // LTN Last used 16
1041:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // 772 - 768 - 1 - 1 = 2
1042:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef T_Vlow
1043:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (DISPLAY == LTN)
1044:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define T_Vlow 16
1045:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == IDT)
1046:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define T_Vlow	6 //16//6 //2 //6
1047:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1048:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define T_Vlow 32
1049:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1050:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1051:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1052:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // IDTech Last Used: 768
1053:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #ifndef V_COUNT
1054:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (DISPLAY == LTN)
1055:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define V_COUNT	768
1056:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == IDT)
1057:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define V_COUNT	768
1058:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1059:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // #if (LVDS_PRESCALER == 8)
1060:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #define V_COUNT 768
1061:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // #else
1062:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  #define V_COUNT	(768*2/3)
1063:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // #endif
1064:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1065:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1066:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1067:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                       
1068:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                      |           
1069:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                      V           
1070:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              |<-T_DV>|           |<-T_VD-->|
1071:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              .       .           .         .
1072:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     _____________||__.   124us   .____||___________________
1073:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V           .   ||  |___________|    ||   .
1074:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     _ _ _ _ _ _ _|| _ _ _ _ _ _ _ _ _ ||_ _ _ _ _ _ _ _ _ _ _
1075:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H   | | | | | | ||| | | | | | | | | ||| | | | | | | | | | |
1076:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //              .   ||                   ||   .
1077:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     _ _ _ _ _.   ||       720us       ||   ._ _ _ _ _ _ _ _ _
1078:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE   | | | | |___||___________________||___| | | | | | | | |
1079:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                  ||                   ||
1080:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
1081:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                        1
1082:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                        |
1083:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                        v               
1084:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     _________________   ___________________   _____________
1085:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  V                   |_|                   |_|
1086:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  H  |||||||||||||||||||||||||||||||||||||||||||||||||||||||
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 144


1087:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE  ||||||||||||||||_____|||||||||||||||||_____||||||||||||
1088:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                          ^
1089:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                          |
1090:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //                          2
1091:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1092:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1093:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1094:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define HSYNC_COUNT_FRAME_COMPLETE  \
1095:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	(T_DV +(V_COUNT+T_VD+T_Vlow) + FRAME_UPDATE_DELAY)
1096:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // T_DV = 3
1097:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // V_COUNT = 768 
1098:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // T_VD = 3
1099:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // T_Vlow = 32
1100:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // FRAME_UPDATE_DELAY = 0
1101:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // TOTAL = 806
1102:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1103:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if(FRAME_UPDATE_DELAY != 0)
1104:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #error "FRAME_UPDATE_DELAY is no longer implemented..."
1105:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1106:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1107:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1108:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#if(HSYNC_COUNT_FRAME_COMPLETE & 0x01)
1109:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // #warning "Total vertical lines might need to be even!"
1110:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  //This should be fixed...
1111:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#endif
1112:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1113:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1114:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DOT_COUNT_PER_HSYNC \
1115:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	(H_LOW_DOTS + HD_DOTS + DE_ACTIVE_DOTS + DH_DOTS)
1116:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // H_LOW_DOTS = 100
1117:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // HD_DOTS = 50 
1118:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DE_ACTIVE_DOTS = 1024
1119:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DH_DOTS = 0
1120:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // TOTAL = 1174
1121:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1122:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1123:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#define MAKELONG (0L)
1124:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1125:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DOT_COUNT_PER_FRAME \
1126:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  ((MAKELONG(HSYNC_COUNT_FRAME_COMPLETE)) * (MAKELONG(DOT_COUNT_PER_HSYNC)))
1127:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // TOTAL = 946,244
1128:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1129:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Hlow_Delay 		H_LOW_DOTS
1130:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //HD_Delay			HD_DOTS	
1131:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //DE_ACTIVE_DOTS
1132:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //DH_DOTS
1133:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1134:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1135:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1136:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** static __inline__ \
1137:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** void loadData(uint16_t rowNum, uint8_t dataEnable) \
1138:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	  __attribute__((__always_inline__));
1139:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1140:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1141:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** uint8_t dataEnable = 0;
1142:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** uint8_t vSync = 0;
1143:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** uint16_t hsyncCount = 0;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 145


1144:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1145:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //frameCount=0 can be used in main to detect whether we've completed a 
1146:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  a frame AND its FRAME_UPDATE_DELAY
1147:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (defined(FRAME_COUNT_TO_DELAY) && (FRAME_COUNT_TO_DELAY != 0))
1148:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** uint8_t frameCount = 0;
1149:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1150:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1151:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** /*
1152:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** static __inline__ \
1153:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** void loadRow(uint16_t rowNum) \
1154:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	__attribute__((__always_inline__));
1155:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** */
1156:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1157:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Returns TRUE when the frame is complete
1158:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Should send nada (and maybe hsyncs?) thereafter(?)
1159:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // In sdramThing2.0, when this returns TRUE, the SDRAM loading is complete
1160:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // EXCEPT: the final HD_Dots' FR_READ/ACTIVATE commands will point to a
1161:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  non-existent "next" Hsync... these commands need to be rewritten to
1162:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  point to the "first" Hsync. This is handled in sdramThing2.0's code
1163:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Used to be:
1164:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //SIGNAL(TIMER0_COMPA_vect)
1165:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** uint8_t updateLCD(void)
1166:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** {
 1541               		.stabn	68,0,1166,.LM165-.LFBB16
 1542               	.LM165:
 1543               	.LFBB16:
 1544               	/* prologue: function */
 1545               	/* frame size = 0 */
1167:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	uint8_t frameComplete = FALSE;
1168:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1169:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//static uint8_t frameCount = 0;
1170:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1171:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if 0 // (defined(SLOW_EVERYTHING_TEST) && SLOW_EVERYTHING_TEST)
1172:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	while(TCNT0L != 7){};
1173:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//This won't work... who knows how many cycles interrupt-entry will be
1174:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//Above should fix that...
1175:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//I think this was just an indicator for scope triggering...
1176:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// not relevent for 
1177:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	setpinPORT(PB2, PORTB);
1178:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	clrpinPORT(PB2, PORTB);
1179:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1180:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1181:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//Hsync and Actually draw the pixels... (when DE is active)
1182:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// This takes a LONG time and will occupy most of the CPU...
1183:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//  ... IN THIS INTERRUPT
1184:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//loadData(((hsyncCount-T_VD-T_Vlow)>>3)&31, dataEnable,colorOverride);
1185:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	loadData(hsyncCount-T_DV-T_VD-T_Vlow, dataEnable);
 1546               		.stabn	68,0,1185,.LM166-.LFBB16
 1547               	.LM166:
 1548 060a 2091 0000 		lds r18,dataEnable
 1549               	.LBB98:
 1550               	.LBB99:
1186:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1187:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	hsyncCount++;
1188:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1189:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	switch(hsyncCount)
1190:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	{
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 146


1191:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//V Front Porch, begins with initLCD
1192:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1193:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//Vsync H->L (Begin V-Sync)
1194:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		case T_DV:
1195:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			dataEnable = FALSE;
1196:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			//clrpinPORT(VSYNC_PIN, VSYNC_PORT);
1197:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			vSync = TRUE;
1198:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			Vsync_fromNada();
1199:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			break;
1200:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//Vsync L->H (Begin V Back Porch)
1201:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		case T_Vlow + T_DV:
1202:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//	if(hfm_nextOutput(&modulator))
1203:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//		colorOverride = 0xff;
1204:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//	else
1205:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//		colorOverride = 7;
1206:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			//setpinPORT(VSYNC_PIN, VSYNC_PORT);
1207:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			vSync = FALSE;
1208:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			Nada_fromVsync();
1209:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			break;
1210:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//Start of frame (DE active)
1211:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		case T_VD +(T_Vlow + T_DV):
1212:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			dataEnable = TRUE;
1213:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			break;
1214:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		// All rows have been displayed
1215:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		// Return to V Front Porch
1216:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		case V_COUNT +(T_VD + T_Vlow + T_DV):
1217:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			dataEnable = FALSE;
1218:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//	break;
1219:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//Frame complete
1220:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//case HSYNC_COUNT_FRAME_COMPLETE:
1221:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			//T_DV +(V_COUNT+T_VD+T_Vlow) + FRAME_UPDATE_DELAY:
1222:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			hsyncCount = 0;
1223:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if 0 //(FRAME_COUNT_TO_DELAY != 0)
1224:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			//static uint8_t frameCount = 0;
1225:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			frameCount++;
1226:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			if(frameCount == FRAME_COUNT_TO_DELAY)
1227:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			{
1228:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 				frameCount = 0;
1229:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 				timer_compareMatchIntSetup(0, OUT_CHANNELA, FALSE);
1230:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 				//timer_compareMatchIntDisable(0, OUT_CHANNELA);
1231:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			}
1232:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1233:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			
1234:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#warning "NewNote: WTF, are we relying on loadData to have properly set the mode?"
1235:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // Yeah, guess that makes sense... Must be Nada...
1236:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			frameComplete = TRUE;
1237:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			break;
1238:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		default:
1239:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			break;
1240:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	}
1241:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1242:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1243:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if 0 // (defined(LOADROW) && LOADROW)
1244:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//Load the next row into the row(seg)buffer
1245:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//data is enabled after T_VD+T_Vlow...
1246:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	if((hsyncCount >= T_VD+T_Vlow) && (hsyncCount < T_VD+T_Vlow+V_COUNT))
1247:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		loadRow(hsyncCount - (T_VD+T_Vlow));
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 147


1248:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1249:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1250:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//This note was written long before the above was commented-out...
1251:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//So...?
1252:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// Here is where loadRow used to be called
1253:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// it has been moved to oldNotes.txt, but it would make more sense
1254:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// to look at LCDdirectLVDS <25 or LCDdirect
1255:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// loadRow used the time between DE inactive and the next Hsync
1256:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// to load a row to a row-buffer (as opposed to a frame-buffer)
1257:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// thus, DE could gain more pixels because there would be fewer
1258:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// calculations to determine the memory location to write from
1259:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// This effect has since been minimized
1260:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// BUT loadRow might be necessary for program-memory-based images...
1261:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1262:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	return frameComplete;
1263:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** }
1264:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1265:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1266:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //See LCDdirectLVDS for an example...
1267:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // basically it loads a single row into a buffer for the next dateEnable
1268:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  (either the row-buffer or the row-segment-buffer) 
1269:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // This has been *greatly* reduced, is not at all functional, just
1270:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // to give an idea of loadRow's purpose.
1271:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if 0 //(defined(LOADROW) && LOADROW)
1272:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** void loadRow(uint16_t rowNum)
1273:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** {
1274:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//e.g....
1275:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	tet_drawRow(rbRowNum, rowBuffer);
1276:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	
1277:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//and...	
1278:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	rowBuffer[i] = fb_to_rb(colorVal);
1279:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	
1280:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//and...
1281:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	if((rbRowNum >= SMILE_TOP_ROW) &&
1282:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			(rbRowNum < (SMILE_HEIGHT+SMILE_TOP_ROW)))
1283:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	{
1284:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			for(i=0; i<FB_WIDTH; i++)
1285:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			{
1286:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****          	temp=pgm_readImageByte(pimage, rbRowNum-SMILE_TOP_ROW, i);
1287:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 				if(!(temp & 0xC0))
1288:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 					rowBuffer[i+SMILE_SHIFT] = fb_to_rb(temp);
1289:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			}
1290:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	}
1291:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1292:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	life_drawRow(rbRowNum, &(rowBuffer[RB_WIDTH-LIFE_WIDTH]));
1293:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1294:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//HORIZONTAL_COLOR_BARS
1295:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	for(i=0; i<RB_WIDTH; i++)
1296:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		rowBuffer[i] = fb_to_rb(rowNum);
1297:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1298:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//Good for syncing to have white on both borders...
1299:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	newSeg(1, 0x06, (6<<4) | 3);
1300:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	
1301:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** }
1302:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif //LOAD_ROW
1303:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1304:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 148


1305:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Including inactive pixel-clocks (timing)
1306:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // DotCount per row...
1307:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  TOTAL_CYC_COUNT was used for the timer-interrupt in LCDdirectLVDS
1308:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  This was DOTS_TO_CYC(DISPLAY_DOT_COUNT) + ROW_CALCULATION_CYCS
1309:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  ROW_CALCULATION_CYCS was 50,000 (!!!)
1310:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   DOTS_TO_CYC(dots), last-used, was dots*7 (LVDS_PRESCALER nullified /8)
1311:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   So, the overall dot-count per row was... 
1312:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     DISPLAY_DOT_COUNT + ROW_CALCULATION_DOTS
1313:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     where ROW_CALCULATION_DOTS = 50,000cyc/7 = 7142 dots
1314:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //     So... the overall dot-count per row was *MUCH* longer than usual
1315:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  Pretty certain there's not nearly enough memory to simulate that
1316:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   (in sdramThing2.0)
1317:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   But It does suggest that it would be worthwhile to try to stretch
1318:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   the rows as much as possible...
1319:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   During this time, NADA is sent normally, (V=H, H=H, DE=L)
1320:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //    Or Vsync (V=L, H=H, DE=L)
1321:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   Maybe something could be simulated with PWM again, if necessary...
1322:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //   (Certainly not at full-speed)
1323:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DISPLAY_DOT_COUNT \
1324:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	(H_LOW_DOTS + HD_DOTS + DE_ACTIVE_DOTS + DH_DOTS)
1325:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1326:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if 0
1327:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1328:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#define T_Hlow_CYC 1//8 //(T_Halow_REAL*3)
1329:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define T_Hlow_CYC DOTS_TO_CYC(H_LOW_DOTS)
1330:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1331:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define T_DE_CYC	DOTS_TO_CYC(DE_ACTIVE_DOTS)
1332:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1333:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#define T_HD_CYC 1//3//(T_HD_REAL*3)
1334:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define T_HD_CYC	DOTS_TO_CYC(HD_DOTS)
1335:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1336:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define T_DH_CYC	DOTS_TO_CYC(DH_DOTS)
1337:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1338:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1339:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1340:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1341:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1342:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** void init_timer0Hsync(void)
1343:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** {
1344:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//T_HD + T_DH + T_low + T_DE
1345:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// For the original system, 19.865us = 695 dot-clocks
1346:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// We'd need to take advantage of the 16-bit timer
1347:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//  OCR1A may not be written properly (with a temporary high-byte)
1348:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//  ... not sure.
1349:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// TIMER0 DOES NOT HAVE CTC MODE in 16-bit mode
1350:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1351:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // This is a hack, for testing syncability with long row-calculations
1352:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // before actually drawing it... e.g. loading from program memory
1353:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // This value needs to be larger than the calculation time
1354:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // otherwise, it seems, syncing isn't stable
1355:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // BUT THIS IS A HACK, has nothing to do with actual calculation time
1356:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // And for slow LVDS or whatnot, this may be unnecessarily HUGE
1357:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1358:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define DISPLAY_CYC_COUNT	(DOTS_TO_CYC(DISPLAY_DOT_COUNT))
1359:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //	(T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC)
1360:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1361:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //NOTE that with longer ROW_CALCULATION_CYCS, lines can be repeated...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 149


1362:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // apparently an effect of the display, definitely not a code-thing
1363:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // in which case the vertical resolution decreases
1364:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // though, this could be used to advantage... 
1365:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // (e.g. more processing time outside the drawing interrupts?)
1366:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // NOTE that if the value is too small and calculations take longer in some
1367:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // lines than others (?), those lines may repeat, or syncing could be off
1368:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (LVDS_PRESCALER == 8)
1369:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  //#define ROW_CALCULATION_DELAY 1//20
1370:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define ROW_CALCULATION_CYCS (50000) //0 //(70000) //(100000)
1371:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #else
1372:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  //#define ROW_CALCULATION_DELAY 9//7//5//2//1//10
1373:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define ROW_CALCULATION_CYCS	(8*DISPLAY_CYC_COUNT)
1374:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1375:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1376:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define TOTAL_CYC_COUNT \
1377:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	(ROW_CALCULATION_CYCS + DISPLAY_CYC_COUNT)
1378:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //	(ROW_CALCULATION_DELAY * (T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC))
1379:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //#define TOTAL_CYC_COUNT 2000
1380:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (TOTAL_CYC_COUNT > 255)
1381:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  //Adding +7 causes it to round up (hopefully)
1382:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define TIMER0_TCNTS ((TOTAL_CYC_COUNT+7)/8)
1383:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define TIMER0_CLKDIV	CLKDIV8
1384:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+7)/8: Timer0 CLKDIV8"
1385:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #if (TIMER0_TCNTS > 255)
1386:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+63)/64: Timer0 CLKDIV64"
1387:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #define TIMER0_TCNTS ((TOTAL_CYC_COUNT+63)/64)
1388:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #define TIMER0_CLKDIV CLKDIV64
1389:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #if (TIMER0_TCNTS > 255)
1390:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	 #warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+255)/256: Timer0 CLKDIV256"
1391:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	 #define TIMER0_TCNTS ((TOTAL_CYC_COUNT+255)/256)
1392:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	 #define TIMER0_CLKDIV CLKDIV256
1393:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	 #if (TIMER0_TCNTS > 255)
1394:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		#warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+1023)/1024: Timer0 CLKDIV1024"
1395:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		#define TIMER0_TCNTS ((TOTAL_CYC_COUNT+1023)/1024)
1396:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		#define TIMER0_CLKDIV	CLKDIV1024
1397:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	 #endif
1398:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #endif
1399:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #endif
1400:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #if (TIMER0_TCNTS == 0)
1401:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #error "TIMER0_OCRVAL == 0"
1402:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #endif
1403:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #else
1404:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define TIMER0_TCNTS TOTAL_CYC_COUNT
1405:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define TIMER0_CLKDIV CLKDIV1
1406:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1407:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1408:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (defined(SLOW_EVERYTHING_TEST) && SLOW_EVERYTHING_TEST)
1409:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  //For testing, I want to see the pulses with the 'scope
1410:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  // Unless the timer is divisible by 7 the pulses will not align with the
1411:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  // timer overflow...
1412:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  //but shit... it's running at clkdiv8 so each TCNT is 64 bits!
1413:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  // but this shouldn't matter for visualizing, that's only ~10 pixel clocks
1414:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  // and we'll only start visualizing *after* the extra TCNTs...
1415:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  //Since the timer counts from 0 to (and including) OCR1A
1416:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  // Add one to this test...
1417:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #if (((TIMER0_TCNTS + 1) % 7) == 0)
1418:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 1) % 7 == 0"
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 150


1419:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS"
1420:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS)
1421:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1422:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 2) % 7) == 0)
1423:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 2) % 7 == 0"
1424:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 1"
1425:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 1)
1426:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1427:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 3) % 7) == 0)
1428:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 3) % 7 == 0"
1429:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 2"
1430:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 2)
1431:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1432:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 4) % 7) == 0)
1433:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 4) % 7 == 0"
1434:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 3"
1435:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 3)
1436:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1437:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 5) % 7) == 0)
1438:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 5) % 7 == 0"
1439:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 4"
1440:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 4)
1441:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1442:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 6) % 7) == 0)
1443:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 6) % 7 == 0"
1444:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 5"
1445:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 5)
1446:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1447:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #elif (((TIMER0_TCNTS) % 7) == 0)
1448:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "(TIMER0_TCNTS) % 7 == 0"
1449:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS - 1"
1450:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS - 1)
1451:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1452:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #else
1453:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****   #error "WTF?"
1454:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #endif
1455:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #else
1456:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #define TIMER0_OCRVAL (TIMER0_TCNTS-1)
1457:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1458:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1459:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (TIMER0_OCRVAL > 255)
1460:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #error "Despite all my efforts, TIMER0_OCRVAL is *still* > 255!"
1461:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1462:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1463:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****    OCR0A = TIMER0_OCRVAL; //T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC;
1464:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	timer_setWGM(0, WGM_CLR_ON_COMPARE);
1465:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****    timer_selectDivisor(0, TIMER0_CLKDIV); //CLKDIV1);
1466:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****    timer_compareMatchIntEnable(0, OUT_CHANNELA);
1467:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** }
1468:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1469:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #define fullBlue()	DEblue_init()
1470:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1471:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1472:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1473:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //Either use one of the ones here, or define your own...
1474:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // rowNum is the drawable row number on the LCD...
1475:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //static __inline__ void drawPix(uint16_t rowNum);
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 151


1476:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1477:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1478:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** static __inline__ \
1479:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** void drawPix(uint8_t rowNum) \
1480:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	  __attribute__((__always_inline__));
1481:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if 0
1482:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if (!defined(ROW_SEG_BUFFER) || !ROW_SEG_BUFFER)
1483:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //drawPix loads each pixel individually... It doesn't use a for-loop
1484:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // since that would take away from actual pixel-drawing time...
1485:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // I think it's been removed... but here's a (non-functional) example...
1486:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** void drawPix(uint8_t rowNum)
1487:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** {
1488:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	writeColor(*(color+1));	 
1489:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	writeColor(*(color+2));	 
1490:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	writeColor(*(color+3)); 
1491:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	...
1492:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	writeColor(*(color+61));
1493:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	writeColor(*(color+62));
1494:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	writeColor(*(color+63));
1495:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// WriteColor writes the pixel *after* the calculations...
1496:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// thus the pixel appears basically after writeColor completes
1497:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	// These nops assure the 64th pixel is fully-displayed before exitting
1498:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	asm("nop");
1499:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	...
1500:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	asm("nop");
1501:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1502:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** /*		reg[17] = colorBuffer[rowNum][17];                         
1503:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		writeColor(reg[17]);                         
1504:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		...
1505:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		reg[20] = colorBuffer[rowNum][20];                         
1506:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		writeColor(reg[20]);  
1507:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		
1508:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//REPEATING to fill screen... (delayDots = 342 worked prior to this)
1509:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		reg[0] = colorBuffer[rowNum][0];
1510:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		writeColor(reg[0]);
1511:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		...
1512:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		reg[10] = colorBuffer[rowNum][10];
1513:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		writeColor(reg[10]);
1514:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** */
1515:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//Display the rest as black...
1516:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		writeColor(0);
1517:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** }
1518:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #else		//ROW_SEG_BUFFER
1519:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** void drawPix(uint8_t rowNum)
1520:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** {
1521:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
1522:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	         | (0<<COM1B1) | (1<<COM1B0)
1523:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	         | (1<<PWM1A) | (1<<PWM1B) );
1524:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1525:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		drawSegs();
1526:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1527:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1528:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//DE->Nada transition expects fullBlue...
1529:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//Also helps to show the edge of the DE timing...
1530:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1531:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//!!! Not sure what the state is at this point...
1532:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		// could be any DE+Blue level, or could be NADA...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 152


1533:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		// Nada: DT1=3, still leaves one bit for clocking, might be OK
1534:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****          
1535:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//Among the things that don't make sense...
1536:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		// This appears to go into affect BEFORE delay_cyc (?)
1537:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		// as, without a pull-up resistor on the /OC1B output, 
1538:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		// green seems to be floating between the last pixel and the
1539:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		// delay_cyc (!)
1540:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//Disable complementary-output for Green 
1541:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//  (on /OC1B, where CLK is OC1B)
1542:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		// Since Nada, V, and H DT's might be bad for clocking.
1543:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
1544:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****          | (1<<COM1B1) | (0<<COM1B0)
1545:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****          | (1<<PWM1A) | (1<<PWM1B) );
1546:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1547:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		fullBlue();
1548:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** }
1549:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif //0
1550:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1551:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1552:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
1553:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //          G) groovy little spiral...
1554:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //
1555:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1556:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if 0 //(defined(CLOCK_INSENSITIVITY_TESTING) && CLOCK_INSENSITIVITY_TESTING)
1557:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DEonly_fromNada();
1558:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//Enable complementary-output for Green (on /OC1B, where CLK is OC1B)
1559:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
1560:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 				   | (0<<COM1B1) | (1<<COM1B0)
1561:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 					| (1<<PWM1A) | (1<<PWM1B) );
1562:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1563:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1564:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //a/o sdramThing2.0v8 early... appears to be syncing on Blue signal
1565:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // thus we get diagonal data including Hsync (colored in red) along the
1566:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // as a diagonal stripe at the right
1567:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if(defined(BLUE_DIAG_BAR) && BLUE_DIAG_BAR)
1568:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** static __inline__ void drawPix(uint16_t rowNum)
1569:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** {
1570:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//uint16_t blueCyc = DOTS_TO_CYC(rowNum);
1571:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//uint16_t notBlueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS)-blueCyc;
1572:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		uint16_t blueDots = rowNum;
1573:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		uint16_t notBlueDots = DE_ACTIVE_DOTS - blueDots;
1574:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1575:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DEonly_fromNada();
1576:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_cyc(notBlueCyc);
1577:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_Dots(notBlueDots);
1578:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DE_DotDelay(notBlueDots);
1579:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DEblue_fromDEonly();
1580:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_cyc(blueCyc);
1581:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_Dots(blueDots);
1582:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DE_DotDelay(blueDots);
1583:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		Nada_fromDEblue();
1584:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** }
1585:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1586:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1587:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //a/o sdramThing2.0v8-31ish: LooksPromising, but delayed
1588:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // also LVDS bit-shifts causing vertical striping
1589:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if(defined(BLUE_VERT_BAR) && BLUE_VERT_BAR)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 153


1590:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** static __inline__ void drawPix(uint16_t rowNum)
1591:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** {
1592:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DEonly_fromNada();
1593:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)/3);
1594:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS/3);
1595:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS/3);
1596:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DEblue_fromDEonly();
1597:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)*2/3);
1598:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS - DE_ACTIVE_DOTS/3);
1599:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS - DE_ACTIVE_DOTS/3);
1600:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		Nada_fromDEblue();
1601:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** }
1602:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1603:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1604:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //a/o sdramThing2.0v8-32 nogo... syncs at end of blue instead of Hsync
1605:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if(defined(BLUE_VERT_BAR_REVERSED) && BLUE_VERT_BAR_REVERSED)
1606:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** static __inline__ void drawPix(uint16_t rowNum)
1607:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** {
1608:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DEblue_fromNada();
1609:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)/3);
1610:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS/3);
1611:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS/3);
1612:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DEonly_fromDEblue();
1613:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)*2/3);
1614:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS - DE_ACTIVE_DOTS/3);
1615:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS - DE_ACTIVE_DOTS/3);
1616:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		Nada_fromDEonly();
1617:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** }
1618:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1619:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1620:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1621:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if(defined(DE_BLUE) && DE_BLUE)
1622:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** static __inline__ void drawPix(uint16_t rowNum)
1623:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** {
1624:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DEblue_fromNada();
1625:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS));
1626:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS);
1627:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS);
1628:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		Nada_fromDEblue();
1629:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** }
1630:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1631:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1632:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if(defined(BLUE_BORDER) && (BLUE_BORDER!=0))
1633:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** static __inline__ void drawPix(uint16_t rowNum)
1634:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** {
1635:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DEblue_fromNada();
1636:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DE_DotDelay(BLUE_BORDER);
1637:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DEonly_fromDEblue();
1638:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS - BLUE_BORDER*2);
1639:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DEblue_fromDEonly();
1640:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		DE_DotDelay(BLUE_BORDER);
1641:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		Nada_fromDEblue();
1642:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** }
1643:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1644:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1645:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if 0
1646:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //NOT BLUE_DIAG_BAR, BLUE_VERT_BAR, NOR DE_BLUE
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 154


1647:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #if ( defined(COLOR_BAR_SCROLL) && COLOR_BAR_SCROLL)
1648:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		if(rowNum <= 256)
1649:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			rowNum=0;
1650:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		else
1651:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			rowNum=1;
1652:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #else //NOT COLOR_BAR_SCROLL... drawPix...
1653:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//#warning "see 'shouldBe' here..."
1654:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//Should be:
1655:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		rowNum = rowNum*FB_HEIGHT/V_COUNT;
1656:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//rowNum = rowNum / (768/FB_HEIGHT);
1657:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #endif
1658:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1659:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//DEonly_fromNada();
1660:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****       drawPix(rowNum);
1661:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//Nada_init();
1662:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****  #warning "THIS ISN'T SAFE"
1663:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		Nada_fromDEonly();
1664:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//Drawing Methods...
1665:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1666:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #if 0 //(defined(CLOCK_INSENSITIVITY_TESTING) && CLOCK_INSENSITIVITY_TESTING)
1667:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//!!! Not sure what the state is at this point...
1668:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		// could be any DE+Blue level, or could be NADA...
1669:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		// Nada: DT1=3, still leaves one bit for clocking, might be OK
1670:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1671:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****       //Disable complementary-output for Green 
1672:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//  (on /OC1B, where CLK is OC1B)
1673:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		// Since Nada, V, and H DT's might be bad for clocking.
1674:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****       TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
1675:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****                | (1<<COM1B1) | (0<<COM1B0)
1676:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****                | (1<<PWM1A) | (1<<PWM1B) );
1677:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1678:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1679:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//colorOverride removed in LVDS, revisit LCDdirect50
1680:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** #endif
1681:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1682:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1683:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1684:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // AND HERE!!!
1685:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1686:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** // rowNum is only used when DE is active...
1687:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** //  and should be 0 at *drawn row* 0
1688:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** void loadData(uint16_t rowNum, uint8_t dataEnable)
1689:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** {
1690:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	//H Active pulse...
1691:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****    if(vSync)
 1551               		.stabn	68,0,1691,.LM167-.LFBB16
 1552               	.LM167:
 1553 060e 8091 0000 		lds r24,vSync
 1554 0612 8823      		tst r24
 1555 0614 01F0      		breq .L104
1692:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****    {
1693:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 		//Vsync_fromNada() is called at the end of the last interupt
1694:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****       VplusH_fromVsync();
 1556               		.stabn	68,0,1694,.LM168-.LFBB16
 1557               	.LM168:
 1558 0616 1DBC      		out 77-0x20,__zero_reg__
 1559               	.LBB100:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 155


 1560               	.LBB101:
 1561               	.LBB102:
 1562               	.LBB103:
 1563               		.stabs	"/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h",132,0,0,.Ltext10
 1564               	.Ltext10:
 1565               		.stabn	68,0,105,.LM169-.LFBB16
 1566               	.LM169:
 1567 0618 8FEA      		ldi r24,lo8(175)
 1568 061a 90E0      		ldi r25,hi8(175)
 1569               	/* #APP */
 1570               	 ;  105 "/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h" 1
 1571 061c 0197      		1: sbiw r24,1
 1572 061e 01F4      		brne 1b
 1573               	 ;  0 "" 2
 1574               	/* #NOAPP */
 1575               	.LBE103:
 1576               	.LBE102:
 1577               	.LBE101:
 1578               	.LBE100:
 1579               		.stabs	"_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c",132,0,0,.Ltext11
 1580               	.Ltext11:
1695:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****       Hlow_Delay();
1696:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****       Vsync_fromVplusH();
 1581               		.stabn	68,0,1696,.LM170-.LFBB16
 1582               	.LM170:
 1583 0620 85E0      		ldi r24,lo8(5)
 1584 0622 00C0      		rjmp .L115
 1585               	.L104:
1697:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****       HD_Delay();
1698:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****    }
1699:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****    else
1700:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****    {
1701:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****       Hsync_fromNada();
 1586               		.stabn	68,0,1701,.LM171-.LFBB16
 1587               	.LM171:
 1588 0624 83E0      		ldi r24,lo8(3)
 1589 0626 8DBD      		out 77-0x20,r24
 1590               	.LBB104:
 1591               	.LBB105:
 1592               	.LBB106:
 1593               	.LBB107:
 1594               		.stabs	"/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h",132,0,0,.Ltext12
 1595               	.Ltext12:
 1596               		.stabn	68,0,105,.LM172-.LFBB16
 1597               	.LM172:
 1598 0628 8FEA      		ldi r24,lo8(175)
 1599 062a 90E0      		ldi r25,hi8(175)
 1600               	/* #APP */
 1601               	 ;  105 "/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h" 1
 1602 062c 0197      		1: sbiw r24,1
 1603 062e 01F4      		brne 1b
 1604               	 ;  0 "" 2
 1605               	/* #NOAPP */
 1606               	.LBE107:
 1607               	.LBE106:
 1608               	.LBE105:
 1609               	.LBE104:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 156


 1610               		.stabs	"_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c",132,0,0,.Ltext13
 1611               	.Ltext13:
1702:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****       Hlow_Delay();
1703:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****       Nada_fromHsync();
 1612               		.stabn	68,0,1703,.LM173-.LFBB16
 1613               	.LM173:
 1614 0630 84E0      		ldi r24,lo8(4)
 1615               	.L115:
 1616 0632 8DBD      		out 77-0x20,r24
 1617               	.LBB108:
 1618               	.LBB109:
 1619               	.LBB110:
 1620               	.LBB111:
 1621               		.stabs	"/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h",132,0,0,.Ltext14
 1622               	.Ltext14:
 1623               		.stabn	68,0,105,.LM174-.LFBB16
 1624               	.LM174:
 1625 0634 88E5      		ldi r24,lo8(88)
 1626 0636 90E0      		ldi r25,hi8(88)
 1627               	/* #APP */
 1628               	 ;  105 "/usr/local/lib/gcc/avr/4.4.5/../../../../avr/include/util/delay_basic.h" 1
 1629 0638 0197      		1: sbiw r24,1
 1630 063a 01F4      		brne 1b
 1631               	 ;  0 "" 2
 1632               	/* #NOAPP */
 1633               	.LBE111:
 1634               	.LBE110:
 1635               	.LBE109:
 1636               	.LBE108:
 1637               		.stabs	"_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c",132,0,0,.Ltext15
 1638               	.Ltext15:
1704:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****       HD_Delay();
1705:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****    }
1706:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 
1707:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c ****    if(dataEnable)
 1639               		.stabn	68,0,1707,.LM175-.LFBB16
 1640               	.LM175:
 1641 063c 2223      		tst r18
 1642 063e 01F4      		brne .+2
 1643 0640 00C0      		rjmp .L106
 1644               	.LBB112:
 1645               	.LBB113:
 1646               		.stabs	"main.c",132,0,0,.Ltext16
 1647               	.Ltext16:
3765:main.c        **** 	TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
 1648               		.stabn	68,0,3765,.LM176-.LFBB16
 1649               	.LM176:
 1650 0642 83E5      		ldi r24,lo8(83)
 1651 0644 80BF      		out 80-0x20,r24
 1652               	.LBB114:
 1653               	.LBB115:
 1654               		.stabs	"rowSegBuffer.c",132,0,0,.Ltext17
 1655               	.Ltext17:
 400:rowSegBuffer.c **** 
 401:rowSegBuffer.c **** 
 402:rowSegBuffer.c **** static __inline__ \
 403:rowSegBuffer.c **** void drawSegs(void) \
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 157


 404:rowSegBuffer.c **** 	__attribute__((__always_inline__));
 405:rowSegBuffer.c **** 
 406:rowSegBuffer.c **** 
 407:rowSegBuffer.c **** void drawSegs(void)
 408:rowSegBuffer.c **** {
 409:rowSegBuffer.c **** #warning "This might need to be modified such that DE is active *with* the first pixel... and compl
 410:rowSegBuffer.c **** 	//Declared volatile *just in case* I decide to use it after the asm...
 411:rowSegBuffer.c **** 	// (as modified by the asm)
 412:rowSegBuffer.c **** 	volatile uint8_t *byteptr = &(rowSegBuffer[0].red_length);
 413:rowSegBuffer.c **** 
 414:rowSegBuffer.c **** 	//These should only be used in the asm...
 415:rowSegBuffer.c **** 	// declaring them here, instead of using specific registers in asm
 416:rowSegBuffer.c **** 	// should help assure that those registers aren't clobbered
 417:rowSegBuffer.c **** 	// if used elsewhere
 418:rowSegBuffer.c **** 	//volatile uint8_t r=0, rl=0, g=0, b=0;
 419:rowSegBuffer.c **** 
 420:rowSegBuffer.c **** 	//uint8_t r, rl, g, b;
 421:rowSegBuffer.c **** 
 422:rowSegBuffer.c **** 	//Basic idea:
 423:rowSegBuffer.c **** 
 424:rowSegBuffer.c **** 	//do{
 425:rowSegBuffer.c **** 	//  red_length = rowSegBuffer[n].red_length;
 426:rowSegBuffer.c **** 	//  green      = rowSegBuffer[n].green;
 427:rowSegBuffer.c **** 	//  blue       = rowSegBuffer[n].blue;
 428:rowSegBuffer.c **** 	//  
 429:rowSegBuffer.c **** 	//  OCR1D = red_length&0x0f;
 430:rowSegBuffer.c **** 	//  DT1   = green;
 431:rowSegBuffer.c **** 	//  OCR1A = blue;
 432:rowSegBuffer.c **** 	//
 433:rowSegBuffer.c **** 	//  red_length &= 0xf0;
 434:rowSegBuffer.c **** 	//  if(!red_length)
 435:rowSegBuffer.c **** 	//     break;
 436:rowSegBuffer.c **** 	//
 437:rowSegBuffer.c **** 	//  while(red_length)
 438:rowSegBuffer.c **** 	//		red_length -= 0x10;
 439:rowSegBuffer.c **** 	// } while(1);
 440:rowSegBuffer.c **** 
 441:rowSegBuffer.c **** 	//This looks like it should work...
 442:rowSegBuffer.c **** 	// but there are some oddities
 443:rowSegBuffer.c **** 	// in this case, registers are loaded such that andi can't be used
 444:rowSegBuffer.c **** 	// but and can... thus it's a few instructions larger...
 445:rowSegBuffer.c **** 	/*
 446:rowSegBuffer.c **** 	do
 447:rowSegBuffer.c **** 	{
 448:rowSegBuffer.c **** 		rl = *(byteptr++);
 449:rowSegBuffer.c **** 		r = rl;
 450:rowSegBuffer.c **** 		r &= 0x0f;
 451:rowSegBuffer.c **** 		g = *(byteptr++);
 452:rowSegBuffer.c **** 		b = *(byteptr++);
 453:rowSegBuffer.c **** 
 454:rowSegBuffer.c **** 		//just testing pushes and pops...
 455:rowSegBuffer.c **** 		// apparently the optimizer realizes which registers are in use
 456:rowSegBuffer.c **** 		// in the (only) call to drawSegs() and doesn't bother to push the
 457:rowSegBuffer.c **** 		// the rest...
 458:rowSegBuffer.c **** //		drawSegs();
 459:rowSegBuffer.c **** 		OCR1D = r;
 460:rowSegBuffer.c **** 		DT1 = g;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 158


 461:rowSegBuffer.c **** 		OCR1A = b;
 462:rowSegBuffer.c **** 
 463:rowSegBuffer.c **** 		rl &= 0xf0;
 464:rowSegBuffer.c **** 
 465:rowSegBuffer.c **** 		if(!rl)
 466:rowSegBuffer.c **** 			break;
 467:rowSegBuffer.c **** 
 468:rowSegBuffer.c **** 		while(rl)
 469:rowSegBuffer.c **** 			rl -= 0x10;
 470:rowSegBuffer.c **** 	} while(1);
 471:rowSegBuffer.c **** */
 472:rowSegBuffer.c **** 
 473:rowSegBuffer.c **** 	//LoadNext:
 474:rowSegBuffer.c **** 	//  ld   Rredlength, Z+	(Red|length)								2
 475:rowSegBuffer.c **** 	//  ld   Rgreen, Z+	(Green)											2
 476:rowSegBuffer.c **** 	//  ld   Rblue, Z+	(Blue)											2
 477:rowSegBuffer.c **** 	//	 mov  Rred, Rredlength												1
 478:rowSegBuffer.c **** 	//  andi Rred, 0x0f				//Remove length from Rred		1
 479:rowSegBuffer.c **** 	//  out  OCR1D, Rred														1
 480:rowSegBuffer.c **** 	//  out  DT1, Rgreen														1
 481:rowSegBuffer.c **** 	//  out  OCR1A, Rblue													1
 482:rowSegBuffer.c **** 
 483:rowSegBuffer.c **** 	//  andi Rredlength, 0xf0		//Remove red from length		1
 484:rowSegBuffer.c **** 	//  breq Done						// if length==0, we're done	1 2
 485:rowSegBuffer.c **** 
 486:rowSegBuffer.c **** 	//Counter:
 487:rowSegBuffer.c **** 	//  subi Rlength, 0x10			//Subtract 0x10 each time...	1
 488:rowSegBuffer.c **** 	//  breq LoadNext					// if length==0, next segment	1 2
 489:rowSegBuffer.c **** 	//  rjmp Counter					// else, next counter loop    2
 490:rowSegBuffer.c **** 
 491:rowSegBuffer.c **** 	//Done:
 492:rowSegBuffer.c **** 
 493:rowSegBuffer.c **** 	// Thus, minimum inter-pixel time is 16 clock cycles
 494:rowSegBuffer.c **** 	// (14 for the last one)
 495:rowSegBuffer.c **** 	// This cannot be reuced by using a separate byte for red and length
 496:rowSegBuffer.c **** 	// because the mov and andi in LoadNext would be replaced by a ld
 497:rowSegBuffer.c **** 
 498:rowSegBuffer.c **** 	// To make the counter take longer between each count,
 499:rowSegBuffer.c **** 	// decrement it by a smaller number...
 500:rowSegBuffer.c **** 
 501:rowSegBuffer.c **** //	drawSegs();
 502:rowSegBuffer.c **** /*
 503:rowSegBuffer.c **** __asm__ __volatile__
 504:rowSegBuffer.c **** 	(
 505:rowSegBuffer.c **** 	"LoadNext_%=: \n\t"
 506:rowSegBuffer.c **** 	 	"ld %1, %a0+ ; \n\t"		//%a1 refers to XYZ whichever is selected
 507:rowSegBuffer.c **** 		"mov %2, %1 ; \n\t"		// Load R (+length)
 508:rowSegBuffer.c **** 		"andi %2, 0x0f ; \n\t"	//Remove length from Rred
 509:rowSegBuffer.c **** 		"ld %3, %a0+ ; \n\t"		//Load G	
 510:rowSegBuffer.c **** 		"ld %4, %a0+ ; \n\t"		//Load B
 511:rowSegBuffer.c **** 		"out %5, %2 ; \n\t"	// Write OCR1D (Red)
 512:rowSegBuffer.c **** 		"out %6, %3 ; \n\t"		// Write DT1 (Green)
 513:rowSegBuffer.c **** 		"out %7, %4 ; \n\t"	// Write OCR1A (Blue)
 514:rowSegBuffer.c **** 
 515:rowSegBuffer.c **** 		"andi %1, 0xf0 ; \n\t"	// Remove red from length
 516:rowSegBuffer.c **** 		"breq Done_%= ; \n\t"		// if length==0 from the start, we're done
 517:rowSegBuffer.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 159


 518:rowSegBuffer.c **** 	"Counter_%=: \n\t"
 519:rowSegBuffer.c **** 		"subi %1, 0x10 ; \n\t"	//Decrement the counter by 0x10
 520:rowSegBuffer.c **** 		"breq LoadNext_%= ; \n\t"	// if we've decremented to 0, next segment
 521:rowSegBuffer.c **** 
 522:rowSegBuffer.c **** 	"Done_%=: \n\t"
 523:rowSegBuffer.c **** 		:								//No output register...
 524:rowSegBuffer.c **** 		: "e" (byteptr),			//byteptr: %0, r/w and assigned to X,Y,orZ
 525:rowSegBuffer.c **** 		  "d"  (rl),				//rl: %1, andi and subi will be used
 526:rowSegBuffer.c **** 		  "d"  (r),					//r: %2, andi will be used
 527:rowSegBuffer.c **** 		  "r"  (g),					//g: %3
 528:rowSegBuffer.c **** 		  "r"  (b),					//b: %4
 529:rowSegBuffer.c **** 		  "I"  (_SFR_IO_ADDR(OCR1D)), //OCR1D: %5
 530:rowSegBuffer.c **** 		  "I"  (_SFR_IO_ADDR(DT1)),	//DT1: %6
 531:rowSegBuffer.c **** 		  "I"  (_SFR_IO_ADDR(OCR1A))	//OCR1A %7
 532:rowSegBuffer.c **** 	);
 533:rowSegBuffer.c **** */
 534:rowSegBuffer.c **** 
 535:rowSegBuffer.c **** __asm__ __volatile__
 1656               		.stabn	68,0,535,.LM177-.LFBB16
 1657               	.LM177:
 1658 0646 E0E0      		ldi r30,lo8(rowSegBuffer)
 1659 0648 F0E0      		ldi r31,hi8(rowSegBuffer)
 1660               	/* #APP */
 1661               	 ;  535 "rowSegBuffer.c" 1
 1662               		LoadNext_974: 
 1663 064a 4191      		ld r20, Z+ ; 
 1664 064c 542F      		mov r21, r20 ; 
 1665 064e 5770      		andi r21, 7 ; 
 1666 0650 6191      		ld r22, Z+ ; 
 1667 0652 762F      		mov r23, r22 ; 
 1668 0654 6F70      		andi r22, 0x0f ; 
 1669 0656 7295      		swap r23 ; 
 1670 0658 7F70      		andi r23, 0x0f 
 1671 065a 5ABD      		out 42, r21 ; 
 1672 065c 64BD      		out 36, r22 ; 
 1673 065e 7DBD      		out 45, r23 ; 
 1674 0660 487F      		andi r20, 248 ; 
 1675 0662 01F0      		breq Done_974 ; 
 1676 0664 0000      		nop ; 
 1677 0666 0000      		nop ; 
 1678               		Counter_974: 
 1679 0668 4850      		subi r20, 8 ; 
 1680 066a 01F0      		breq LoadNext_974 ; 
 1681 066c 0000      		nop ; 
 1682 066e 0000      		nop ; 
 1683 0670 0000      		nop ; 
 1684 0672 0000      		nop ; 
 1685 0674 0000      		nop ; 
 1686 0676 0000      		nop ; 
 1687 0678 0000      		nop ; 
 1688 067a 0000      		nop ; 
 1689 067c 0000      		nop ; 
 1690 067e 0000      		nop ; 
 1691 0680 0000      		nop ; 
 1692 0682 0000      		nop ; 
 1693 0684 0000      		nop ; 
 1694 0686 0000      		nop ; 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 160


 1695 0688 0000      		nop ; 
 1696 068a 0000      		nop ; 
 1697 068c 00C0      		rjmp Counter_974 ; 
 1698               		Done_974: 
 1699               		
 1700               	 ;  0 "" 2
 1701               	/* #NOAPP */
 1702               	.LBE115:
 1703               	.LBE114:
 1704               		.stabs	"main.c",132,0,0,.Ltext18
 1705               	.Ltext18:
3809:main.c        **** 		TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
 1706               		.stabn	68,0,3809,.LM178-.LFBB16
 1707               	.LM178:
 1708 068e 83E6      		ldi r24,lo8(99)
 1709 0690 80BF      		out 80-0x20,r24
3813:main.c        **** 		fullBlue();
 1710               		.stabn	68,0,3813,.LM179-.LFBB16
 1711               	.LM179:
 1712 0692 14BC      		out 68-0x20,__zero_reg__
 1713 0694 86E0      		ldi r24,lo8(6)
 1714 0696 8DBD      		out 77-0x20,r24
3814:main.c        **** 		Nada_fromDEonly();
 1715               		.stabn	68,0,3814,.LM180-.LFBB16
 1716               	.LM180:
 1717 0698 80E3      		ldi r24,lo8(48)
 1718 069a 84BD      		out 68-0x20,r24
 1719               	.L106:
 1720               	.LBE113:
 1721               	.LBE112:
 1722               	.LBE99:
 1723               	.LBE98:
 1724               		.stabs	"_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c",132,0,0,.Ltext19
 1725               	.Ltext19:
1187:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	hsyncCount++;
 1726               		.stabn	68,0,1187,.LM181-.LFBB16
 1727               	.LM181:
 1728 069c 8091 0000 		lds r24,hsyncCount
 1729 06a0 9091 0000 		lds r25,(hsyncCount)+1
 1730 06a4 0196      		adiw r24,1
 1731 06a6 9093 0000 		sts (hsyncCount)+1,r25
 1732 06aa 8093 0000 		sts hsyncCount,r24
1189:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 	switch(hsyncCount)
 1733               		.stabn	68,0,1189,.LM182-.LFBB16
 1734               	.LM182:
 1735 06ae 8332      		cpi r24,35
 1736 06b0 9105      		cpc r25,__zero_reg__
 1737 06b2 01F0      		breq .L109
 1738 06b4 8432      		cpi r24,36
 1739 06b6 9105      		cpc r25,__zero_reg__
 1740 06b8 00F4      		brsh .L112
 1741 06ba 8330      		cpi r24,3
 1742 06bc 9105      		cpc r25,__zero_reg__
 1743 06be 01F4      		brne .L116
 1744 06c0 00C0      		rjmp .L119
 1745               	.L112:
 1746 06c2 8632      		cpi r24,38
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 161


 1747 06c4 9105      		cpc r25,__zero_reg__
 1748 06c6 01F0      		breq .L110
 1749 06c8 23E0      		ldi r18,hi8(806)
 1750 06ca 8632      		cpi r24,lo8(806)
 1751 06cc 9207      		cpc r25,r18
 1752 06ce 01F4      		brne .L116
 1753 06d0 00C0      		rjmp .L120
 1754               	.L119:
1195:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			dataEnable = FALSE;
 1755               		.stabn	68,0,1195,.LM183-.LFBB16
 1756               	.LM183:
 1757 06d2 1092 0000 		sts dataEnable,__zero_reg__
1197:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			vSync = TRUE;
 1758               		.stabn	68,0,1197,.LM184-.LFBB16
 1759               	.LM184:
 1760 06d6 81E0      		ldi r24,lo8(1)
 1761 06d8 8093 0000 		sts vSync,r24
1198:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			Vsync_fromNada();
 1762               		.stabn	68,0,1198,.LM185-.LFBB16
 1763               	.LM185:
 1764 06dc 80E4      		ldi r24,lo8(64)
 1765 06de 84BD      		out 68-0x20,r24
 1766 06e0 85E0      		ldi r24,lo8(5)
 1767 06e2 00C0      		rjmp .L117
 1768               	.L109:
1207:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			vSync = FALSE;
 1769               		.stabn	68,0,1207,.LM186-.LFBB16
 1770               	.LM186:
 1771 06e4 1092 0000 		sts vSync,__zero_reg__
1208:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			Nada_fromVsync();
 1772               		.stabn	68,0,1208,.LM187-.LFBB16
 1773               	.LM187:
 1774 06e8 80E3      		ldi r24,lo8(48)
 1775 06ea 84BD      		out 68-0x20,r24
 1776 06ec 84E0      		ldi r24,lo8(4)
 1777               	.L117:
 1778 06ee 8DBD      		out 77-0x20,r24
 1779 06f0 00C0      		rjmp .L116
 1780               	.L110:
1212:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			dataEnable = TRUE;
 1781               		.stabn	68,0,1212,.LM188-.LFBB16
 1782               	.LM188:
 1783 06f2 81E0      		ldi r24,lo8(1)
 1784 06f4 8093 0000 		sts dataEnable,r24
 1785               	.L116:
 1786 06f8 80E0      		ldi r24,lo8(0)
1213:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			break;
 1787               		.stabn	68,0,1213,.LM189-.LFBB16
 1788               	.LM189:
 1789 06fa 0895      		ret
 1790               	.L120:
1217:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			dataEnable = FALSE;
 1791               		.stabn	68,0,1217,.LM190-.LFBB16
 1792               	.LM190:
 1793 06fc 1092 0000 		sts dataEnable,__zero_reg__
1222:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** 			hsyncCount = 0;
 1794               		.stabn	68,0,1222,.LM191-.LFBB16
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 162


 1795               	.LM191:
 1796 0700 1092 0000 		sts (hsyncCount)+1,__zero_reg__
 1797 0704 1092 0000 		sts hsyncCount,__zero_reg__
 1798 0708 81E0      		ldi r24,lo8(1)
1263:_commonCode_localized/lcdStuff/0.51ncf-git/lcdStuff.c **** }
 1799               		.stabn	68,0,1263,.LM192-.LFBB16
 1800               	.LM192:
 1801 070a 0895      		ret
 1802               		.size	updateLCD, .-updateLCD
 1803               		.stabs	"frameComplete:r(3,2)",64,0,1167,24
 1804               		.stabn	192,0,0,.LFBB16-.LFBB16
 1805               		.stabs	"__count:r(3,4)",64,0,1567,24
 1806               		.stabn	192,0,0,.LBB102-.LFBB16
 1807               		.stabn	224,0,0,.LBE102-.LFBB16
 1808               		.stabs	"__count:r(3,4)",64,0,1567,24
 1809               		.stabn	192,0,0,.LBB106-.LFBB16
 1810               		.stabn	224,0,0,.LBE106-.LFBB16
 1811               		.stabs	"__count:r(3,4)",64,0,1567,24
 1812               		.stabn	192,0,0,.LBB110-.LFBB16
 1813               		.stabn	224,0,0,.LBE110-.LFBB16
 1814               		.stabn	224,0,0,.Lscope16-.LFBB16
 1815               	.Lscope16:
 1816               		.stabs	"",36,0,0,.Lscope16-.LFBB16
 1817               		.stabd	78,0,0
 1818               		.stabs	"getGimpColorVal.2304:f(3,2),getGimpColorVal.2304,loadRow",36,0,43,getGimpColorVal.2304
 1819               		.stabs	"sprite:P(0,16)=*(15,3)",64,0,43,26
 1820               		.stabs	"palette:P(3,2)",64,0,43,22
 1821               		.stabs	"row:P(3,2)",64,0,43,20
 1822               		.stabs	"col:P(3,2)",64,0,44,18
 1823               		.type	getGimpColorVal.2304, @function
 1824               	getGimpColorVal.2304:
 1825               		.stabd	46,0,0
 1826               		.stabs	"icons/iconPacking.h",132,0,0,.Ltext20
 1827               	.Ltext20:
   1:icons/iconPacking.h **** #ifndef __ICONPACKING_H__
   2:icons/iconPacking.h **** #define __ICONPACKING_H__
   3:icons/iconPacking.h **** 
   4:icons/iconPacking.h **** #include "gPixelVal.h"
   5:icons/iconPacking.h **** 
   6:icons/iconPacking.h **** #define ICON_WIDTH	16
   7:icons/iconPacking.h **** #define ICON_HEIGHT	16
   8:icons/iconPacking.h **** #define ICON_PIXELS	((ICON_WIDTH)*(ICON_HEIGHT))
   9:icons/iconPacking.h **** 
  10:icons/iconPacking.h **** #define ICON_PACKED_BYTES	((ICON_PIXELS)/4)
  11:icons/iconPacking.h **** #define ICON_MASK_BYTES		((ICON_PIXELS)/8)
  12:icons/iconPacking.h **** 
  13:icons/iconPacking.h **** #define PACKED_BYTES_PER_ROW	(ICON_WIDTH/4)
  14:icons/iconPacking.h **** 
  15:icons/iconPacking.h **** #define PIXELS_PER_PACKAGE	4
  16:icons/iconPacking.h **** 
  17:icons/iconPacking.h **** #define PACKED_BITS_PER_PIXEL	(8/PIXELS_PER_PACKAGE)
  18:icons/iconPacking.h **** 
  19:icons/iconPacking.h **** typedef struct _BLAH_SHROOM_
  20:icons/iconPacking.h **** {
  21:icons/iconPacking.h **** 	uint8_t * p_image;
  22:icons/iconPacking.h **** 	uint8_t * p_mask;
  23:icons/iconPacking.h **** 	uint8_t * p_palette;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 163


  24:icons/iconPacking.h **** 	uint8_t numPalettes;
  25:icons/iconPacking.h **** }	sprite_t;
  26:icons/iconPacking.h **** 
  27:icons/iconPacking.h **** /*
  28:icons/iconPacking.h **** #define getGimpColorVal(sprite, row, col) \
  29:icons/iconPacking.h **** 		(((pgm_read_byte((uint8_t *)(&((sprite).p_image[ \
  30:icons/iconPacking.h **** 					(row)*PACKED_BYTES_PER_ROW + (col)/PIXELS_PER_PACKAGE])))\
  31:icons/iconPacking.h **** 		  )>>((col)%PIXELS_PER_PACKAGE)*(PACKED_BITS_PER_PIXEL))&0x03)
  32:icons/iconPacking.h **** */
  33:icons/iconPacking.h **** 
  34:icons/iconPacking.h **** /*
  35:icons/iconPacking.h **** #define getGimpColorVal(sprite, palette, row, col) \
  36:icons/iconPacking.h **** 	pgm_read_byte((uint8_t *)(&((sprite).p_palette[ (palette)*4 + \
  37:icons/iconPacking.h **** 		(((pgm_read_byte((uint8_t *)(&((sprite).p_image[ \
  38:icons/iconPacking.h **** 					(row)*PACKED_BYTES_PER_ROW + (col)/PIXELS_PER_PACKAGE])))\
  39:icons/iconPacking.h **** 		  )>>((col)%PIXELS_PER_PACKAGE)*(PACKED_BITS_PER_PIXEL))&0x03) ])))
  40:icons/iconPacking.h **** */
  41:icons/iconPacking.h **** 
  42:icons/iconPacking.h **** 
  43:icons/iconPacking.h **** uint8_t getGimpColorVal(sprite_t *sprite, uint8_t palette, uint8_t row, 
  44:icons/iconPacking.h **** 																			 	uint8_t col)
  45:icons/iconPacking.h **** {
 1828               		.stabn	68,0,45,.LM193-.LFBB17
 1829               	.LM193:
 1830               	.LFBB17:
 1831               	/* prologue: function */
 1832               	/* frame size = 0 */
 1833 070c DC01      		movw r26,r24
 1834               	.LBB116:
 1835               	.LBB117:
  46:icons/iconPacking.h **** 	return 
  47:icons/iconPacking.h **** 	pgm_read_byte((uint8_t *)(&(sprite->p_palette[ (palette)*4 + \
 1836               		.stabn	68,0,47,.LM194-.LFBB17
 1837               	.LM194:
 1838 070e 822F      		mov r24,r18
 1839 0710 8695      		lsr r24
 1840 0712 8695      		lsr r24
 1841 0714 50E0      		ldi r21,lo8(0)
 1842 0716 440F      		lsl r20
 1843 0718 551F      		rol r21
 1844 071a 440F      		lsl r20
 1845 071c 551F      		rol r21
 1846 071e 480F      		add r20,r24
 1847 0720 511D      		adc r21,__zero_reg__
 1848 0722 8D91      		ld r24,X+
 1849 0724 9C91      		ld r25,X
 1850 0726 1197      		sbiw r26,1
 1851 0728 840F      		add r24,r20
 1852 072a 951F      		adc r25,r21
 1853 072c FC01      		movw r30,r24
 1854               	/* #APP */
 1855               	 ;  47 "icons/iconPacking.h" 1
 1856 072e 4491      		lpm r20, Z
 1857               		
 1858               	 ;  0 "" 2
 1859               	/* #NOAPP */
 1860               	.LBE117:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 164


 1861 0730 50E0      		ldi r21,lo8(0)
 1862 0732 30E0      		ldi r19,lo8(0)
 1863 0734 2370      		andi r18,lo8(3)
 1864 0736 3070      		andi r19,hi8(3)
 1865 0738 220F      		lsl r18
 1866 073a 331F      		rol r19
 1867 073c 00C0      		rjmp 2f
 1868 073e 5595      	1:	asr r21
 1869 0740 4795      		ror r20
 1870 0742 2A95      	2:	dec r18
 1871 0744 02F4      		brpl 1b
 1872 0746 4370      		andi r20,lo8(3)
 1873 0748 5070      		andi r21,hi8(3)
 1874 074a 70E0      		ldi r23,lo8(0)
 1875 074c 660F      		lsl r22
 1876 074e 771F      		rol r23
 1877 0750 660F      		lsl r22
 1878 0752 771F      		rol r23
 1879 0754 460F      		add r20,r22
 1880 0756 571F      		adc r21,r23
 1881 0758 1496      		adiw r26,4
 1882 075a ED91      		ld r30,X+
 1883 075c FC91      		ld r31,X
 1884 075e 1597      		sbiw r26,4+1
 1885 0760 E40F      		add r30,r20
 1886 0762 F51F      		adc r31,r21
 1887               	/* #APP */
 1888               	 ;  47 "icons/iconPacking.h" 1
 1889 0764 8491      		lpm r24, Z
 1890               		
 1891               	 ;  0 "" 2
 1892               	/* epilogue start */
 1893               	/* #NOAPP */
 1894               	.LBE116:
  48:icons/iconPacking.h **** 		(((pgm_read_byte((uint8_t *)(&(sprite->p_image[ \
  49:icons/iconPacking.h **** 					(row)*PACKED_BYTES_PER_ROW + (col)/PIXELS_PER_PACKAGE])))\
  50:icons/iconPacking.h **** 		  )>>((col)%PIXELS_PER_PACKAGE)*(PACKED_BITS_PER_PIXEL))&0x03) ])));
  51:icons/iconPacking.h **** }
 1895               		.stabn	68,0,51,.LM195-.LFBB17
 1896               	.LM195:
 1897 0766 0895      		ret
 1898               		.size	getGimpColorVal.2304, .-getGimpColorVal.2304
 1899               		.stabs	"__result:r(3,2)",64,0,47,24
 1900               		.stabn	192,0,0,.LBB116-.LFBB17
 1901               		.stabs	"__result:r(3,2)",64,0,47,20
 1902               		.stabn	192,0,0,.LBB117-.LFBB17
 1903               		.stabn	224,0,0,.LBE117-.LFBB17
 1904               		.stabn	224,0,0,.LBE116-.LFBB17
 1905               	.Lscope17:
 1906               		.stabs	"",36,0,0,.Lscope17-.LFBB17
 1907               		.stabd	78,0,0
 1908               		.stabs	"init_timer0Hsync:F(0,15)",36,0,2975,init_timer0Hsync
 1909               	.global	init_timer0Hsync
 1910               		.type	init_timer0Hsync, @function
 1911               	init_timer0Hsync:
 1912               		.stabd	46,0,0
 1913               		.stabs	"main.c",132,0,0,.Ltext21
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 165


 1914               	.Ltext21:
2976:main.c        **** {
 1915               		.stabn	68,0,2976,.LM196-.LFBB18
 1916               	.LM196:
 1917               	.LFBB18:
 1918               	/* prologue: function */
 1919               	/* frame size = 0 */
3096:main.c        ****    OCR0A = TIMER0_OCRVAL; //T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC;
 1920               		.stabn	68,0,3096,.LM197-.LFBB18
 1921               	.LM197:
 1922 0768 83EE      		ldi r24,lo8(-29)
 1923 076a 83BB      		out 51-0x20,r24
3097:main.c        **** 	timer_setWGM(0, WGM_CLR_ON_COMPARE);
 1924               		.stabn	68,0,3097,.LM198-.LFBB18
 1925               	.LM198:
 1926 076c 80E0      		ldi r24,lo8(0)
 1927 076e 62E0      		ldi r22,lo8(2)
 1928 0770 00D0      		rcall timer_setWGM
3098:main.c        ****    timer_selectDivisor(0, TIMER0_CLKDIV); //CLKDIV1);
 1929               		.stabn	68,0,3098,.LM199-.LFBB18
 1930               	.LM199:
 1931 0772 80E0      		ldi r24,lo8(0)
 1932 0774 68E0      		ldi r22,lo8(8)
 1933 0776 00D0      		rcall timer_selectDivisor
3099:main.c        ****    timer_compareMatchIntEnable(0, OUT_CHANNELA);
 1934               		.stabn	68,0,3099,.LM200-.LFBB18
 1935               	.LM200:
 1936 0778 80E0      		ldi r24,lo8(0)
 1937 077a 60E0      		ldi r22,lo8(0)
 1938 077c 41E0      		ldi r20,lo8(1)
 1939 077e 00D0      		rcall timer_compareMatchIntSetup
 1940               	/* epilogue start */
3100:main.c        **** }
 1941               		.stabn	68,0,3100,.LM201-.LFBB18
 1942               	.LM201:
 1943 0780 0895      		ret
 1944               		.size	init_timer0Hsync, .-init_timer0Hsync
 1945               	.Lscope18:
 1946               		.stabs	"",36,0,0,.Lscope18-.LFBB18
 1947               		.stabd	78,0,0
 1948               		.stabs	"main:F(0,1)",36,0,4080,main
 1949               	.global	main
 1950               		.type	main, @function
 1951               	main:
 1952               		.stabd	46,0,0
4081:main.c        **** {
 1953               		.stabn	68,0,4081,.LM202-.LFBB19
 1954               	.LM202:
 1955               	.LFBB19:
 1956               	/* prologue: function */
 1957               	/* frame size = 0 */
4089:main.c        **** 	tetInit(7);
 1958               		.stabn	68,0,4089,.LM203-.LFBB19
 1959               	.LM203:
 1960 0782 87E0      		ldi r24,lo8(7)
 1961 0784 00D0      		rcall tetInit
4091:main.c        **** 	init_timer0Hsync();
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 166


 1962               		.stabn	68,0,4091,.LM204-.LFBB19
 1963               	.LM204:
 1964 0786 00D0      		rcall init_timer0Hsync
4098:main.c        **** 	lvds_timerInit();
 1965               		.stabn	68,0,4098,.LM205-.LFBB19
 1966               	.LM205:
 1967 0788 00D0      		rcall lvds_timerInit
 1968               	.L128:
4224:main.c        **** 		if(frameCount==0 && !getbit(OCIE0A, T0_TIMSK))
 1969               		.stabn	68,0,4224,.LM206-.LFBB19
 1970               	.LM206:
 1971 078a 8091 0000 		lds r24,frameCount
 1972 078e 8823      		tst r24
 1973 0790 01F4      		brne .L126
 1974               	.L131:
 1975 0792 89B7      		in r24,89-0x20
 1976 0794 8071      		andi r24,lo8(16)
 1977 0796 01F4      		brne .L131
4278:main.c        **** 			timer_compareMatchIntEnable(0, OUT_CHANNELA);
 1978               		.stabn	68,0,4278,.LM207-.LFBB19
 1979               	.LM207:
 1980 0798 60E0      		ldi r22,lo8(0)
 1981 079a 41E0      		ldi r20,lo8(1)
 1982 079c 00D0      		rcall timer_compareMatchIntSetup
 1983 079e 00C0      		rjmp .L128
 1984               	.L126:
 1985               	.L133:
 1986 07a0 00C0      		rjmp .L133
 1987               		.size	main, .-main
 1988               	.Lscope19:
 1989               		.stabs	"",36,0,0,.Lscope19-.LFBB19
 1990               		.stabd	78,0,0
 1991               		.stabs	"__vector_14:F(0,15)",36,0,1984,__vector_14
 1992               	.global	__vector_14
 1993               		.type	__vector_14, @function
 1994               	__vector_14:
 1995               		.stabd	46,0,0
1985:main.c        **** {
 1996               		.stabn	68,0,1985,.LM208-.LFBB20
 1997               	.LM208:
 1998               	.LFBB20:
 1999 07a2 1F92      		push __zero_reg__
 2000 07a4 0F92      		push r0
 2001 07a6 0FB6      		in r0,__SREG__
 2002 07a8 0F92      		push r0
 2003 07aa 1124      		clr __zero_reg__
 2004 07ac 2F92      		push r2
 2005 07ae 3F92      		push r3
 2006 07b0 4F92      		push r4
 2007 07b2 5F92      		push r5
 2008 07b4 6F92      		push r6
 2009 07b6 7F92      		push r7
 2010 07b8 9F92      		push r9
 2011 07ba AF92      		push r10
 2012 07bc BF92      		push r11
 2013 07be CF92      		push r12
 2014 07c0 DF92      		push r13
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 167


 2015 07c2 EF92      		push r14
 2016 07c4 FF92      		push r15
 2017 07c6 0F93      		push r16
 2018 07c8 1F93      		push r17
 2019 07ca 2F93      		push r18
 2020 07cc 3F93      		push r19
 2021 07ce 4F93      		push r20
 2022 07d0 5F93      		push r21
 2023 07d2 6F93      		push r22
 2024 07d4 7F93      		push r23
 2025 07d6 8F93      		push r24
 2026 07d8 9F93      		push r25
 2027 07da AF93      		push r26
 2028 07dc BF93      		push r27
 2029 07de EF93      		push r30
 2030 07e0 FF93      		push r31
 2031 07e2 DF93      		push r29
 2032 07e4 CF93      		push r28
 2033 07e6 CDB7      		in r28,__SP_L__
 2034 07e8 DEB7      		in r29,__SP_H__
 2035 07ea 2797      		sbiw r28,7
 2036 07ec DEBF      		out __SP_H__, r29
 2037 07ee CDBF      		out __SP_L__, r28
 2038               	/* prologue: Signal */
 2039               	/* frame size = 7 */
2000:main.c        **** 	if(updateLCD())
 2040               		.stabn	68,0,2000,.LM209-.LFBB20
 2041               	.LM209:
 2042 07f0 00D0      		rcall updateLCD
 2043 07f2 8823      		tst r24
 2044 07f4 01F0      		breq .L135
2004:main.c        **** 			frameCount++;
 2045               		.stabn	68,0,2004,.LM210-.LFBB20
 2046               	.LM210:
 2047 07f6 8091 0000 		lds r24,frameCount.2275
 2048 07fa 8F5F      		subi r24,lo8(-(1))
 2049 07fc 8093 0000 		sts frameCount.2275,r24
2005:main.c        **** 			if(frameCount == FRAME_COUNT_TO_DELAY)
 2050               		.stabn	68,0,2005,.LM211-.LFBB20
 2051               	.LM211:
 2052 0800 8230      		cpi r24,lo8(2)
 2053 0802 01F4      		brne .L135
2007:main.c        **** 				frameCount = 0;
 2054               		.stabn	68,0,2007,.LM212-.LFBB20
 2055               	.LM212:
 2056 0804 1092 0000 		sts frameCount.2275,__zero_reg__
2008:main.c        **** 				timer_compareMatchIntSetup(0, OUT_CHANNELA, FALSE);
 2057               		.stabn	68,0,2008,.LM213-.LFBB20
 2058               	.LM213:
 2059 0808 80E0      		ldi r24,lo8(0)
 2060 080a 60E0      		ldi r22,lo8(0)
 2061 080c 40E0      		ldi r20,lo8(0)
 2062 080e 00D0      		rcall timer_compareMatchIntSetup
 2063               	.L135:
2017:main.c        **** 	if((hsyncCount >= T_VD+T_Vlow) && (hsyncCount < T_VD+T_Vlow+V_COUNT))
 2064               		.stabn	68,0,2017,.LM214-.LFBB20
 2065               	.LM214:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 168


 2066 0810 0091 0000 		lds r16,hsyncCount
 2067 0814 1091 0000 		lds r17,(hsyncCount)+1
 2068 0818 0352      		subi r16,lo8(-(-35))
 2069 081a 1040      		sbci r17,hi8(-(-35))
 2070 081c 23E0      		ldi r18,hi8(768)
 2071 081e 0030      		cpi r16,lo8(768)
 2072 0820 1207      		cpc r17,r18
 2073 0822 00F0      		brlo .+2
 2074 0824 00C0      		rjmp .L164
 2075               	.LBB124:
 2076               	.LBB125:
2578:main.c        **** 		setinpuPORT(PB0, PORTB);
 2077               		.stabn	68,0,2578,.LM215-.LFBB20
 2078               	.LM215:
 2079 0826 B898      		cbi 55-0x20,0
 2080 0828 C09A      		sbi 56-0x20,0
 2081               	.LBB126:
 2082               	.LBB127:
 2083               		.stabs	"rowSegBuffer.c",132,0,0,.Ltext22
 2084               	.Ltext22:
 159:rowSegBuffer.c **** 	segPosition = 0;
 2085               		.stabn	68,0,159,.LM216-.LFBB20
 2086               	.LM216:
 2087 082a 1092 0000 		sts segPosition,__zero_reg__
 162:rowSegBuffer.c **** 	rowSegBuffer[segPosition].red_length = 6;
 2088               		.stabn	68,0,162,.LM217-.LFBB20
 2089               	.LM217:
 2090 082e 86E0      		ldi r24,lo8(6)
 2091 0830 8093 0000 		sts rowSegBuffer,r24
 163:rowSegBuffer.c **** 	rowSegBuffer[segPosition].green_blue = (6<<4) | 3;
 2092               		.stabn	68,0,163,.LM218-.LFBB20
 2093               	.LM218:
 2094 0834 83E6      		ldi r24,lo8(99)
 2095 0836 8093 0000 		sts rowSegBuffer+1,r24
 2096               	.LBE127:
 2097               	.LBE126:
 2098               		.stabs	"main.c",132,0,0,.Ltext23
 2099               	.Ltext23:
2601:main.c        **** 	hfm_setup(&colincrementer_hfm, Q_STRETCHTOP, Q_STRETCHDIV);
 2100               		.stabn	68,0,2601,.LM219-.LFBB20
 2101               	.LM219:
 2102 083a 5E01      		movw r10,r28
 2103 083c 0894      		sec
 2104 083e A11C      		adc r10,__zero_reg__
 2105 0840 B11C      		adc r11,__zero_reg__
 2106 0842 C501      		movw r24,r10
 2107 0844 61E0      		ldi r22,lo8(1)
 2108 0846 45E0      		ldi r20,lo8(5)
 2109 0848 00D0      		rcall hfm_setup
 2110               	.LBB128:
2738:main.c        **** 		qRow = (rowNum*ICON_HEIGHT/(V_COUNT)); ///2));
 2111               		.stabn	68,0,2738,.LM220-.LFBB20
 2112               	.LM220:
 2113 084a C801      		movw r24,r16
 2114 084c 24E0      		ldi r18,4
 2115 084e 880F      	1:	lsl r24
 2116 0850 991F      		rol r25
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 169


 2117 0852 2A95      		dec r18
 2118 0854 01F4      		brne 1b
 2119 0856 60E0      		ldi r22,lo8(768)
 2120 0858 73E0      		ldi r23,hi8(768)
 2121 085a 00D0      		rcall __udivmodhi4
 2122 085c E62E      		mov r14,r22
 2123 085e FF24      		clr r15
2723:main.c        **** 			else if(p_selectedSprite != &spriteQ)
 2124               		.stabn	68,0,2723,.LM221-.LFBB20
 2125               	.LM221:
 2126 0860 B0E0      		ldi r27,lo8(spriteQ.2314)
 2127 0862 6B2E      		mov r6,r27
 2128 0864 B0E0      		ldi r27,hi8(spriteQ.2314)
 2129 0866 7B2E      		mov r7,r27
2728:main.c        **** 					if(p_selectedSprite != &spriteSOLID)
 2130               		.stabn	68,0,2728,.LM222-.LFBB20
 2131               	.LM222:
 2132 0868 A0E0      		ldi r26,lo8(spriteSOLID.2317)
 2133 086a CA2E      		mov r12,r26
 2134 086c A0E0      		ldi r26,hi8(spriteSOLID.2317)
 2135 086e DA2E      		mov r13,r26
2672:main.c        **** 				if(p_selectedSprite == &spriteGOOMBA)
 2136               		.stabn	68,0,2672,.LM223-.LFBB20
 2137               	.LM223:
 2138 0870 F0E0      		ldi r31,lo8(spriteGOOMBA.2334)
 2139 0872 4F2E      		mov r4,r31
 2140 0874 F0E0      		ldi r31,hi8(spriteGOOMBA.2334)
 2141 0876 5F2E      		mov r5,r31
2702:main.c        **** 							p_selectedSprite = &spriteBIG;
 2142               		.stabn	68,0,2702,.LM224-.LFBB20
 2143               	.LM224:
 2144 0878 E0E0      		ldi r30,lo8(spriteBIG.2325)
 2145 087a 2E2E      		mov r2,r30
 2146 087c E0E0      		ldi r30,hi8(spriteBIG.2325)
 2147 087e 3E2E      		mov r3,r30
 2148               	.LBB129:
2763:main.c        **** 			if(qCount & 0x01)
 2149               		.stabn	68,0,2763,.LM225-.LFBB20
 2150               	.LM225:
 2151 0880 7FE0      		ldi r23,lo8(15)
 2152 0882 972E      		mov r9,r23
 2153               	.LBE129:
2775:main.c        **** 		addSegfb(Q_SEGLENGTH + hfm_nextOutput(&colincrementer_hfm), data);
 2154               		.stabn	68,0,2775,.LM226-.LFBB20
 2155               	.LM226:
 2156 0884 C501      		movw r24,r10
 2157 0886 BA2C      		mov r11,r10
 2158 0888 A92E      		mov r10,r25
 2159               	.L162:
2646:main.c        **** 		if(!getpinPORT(PB0, PORTB))
 2160               		.stabn	68,0,2646,.LM227-.LFBB20
 2161               	.LM227:
 2162 088a B099      		sbic 54-0x20,0
 2163 088c 00C0      		rjmp .L137
2648:main.c        **** 			if(!buttonPressed)
 2164               		.stabn	68,0,2648,.LM228-.LFBB20
 2165               	.LM228:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 170


 2166 088e 8091 0000 		lds r24,buttonPressed.2339
 2167 0892 9091 0000 		lds r25,(buttonPressed.2339)+1
 2168 0896 0097      		sbiw r24,0
 2169 0898 01F4      		brne .L138
2650:main.c        **** 				buttonPressed = rowNum;
 2170               		.stabn	68,0,2650,.LM229-.LFBB20
 2171               	.LM229:
 2172 089a 1093 0000 		sts (buttonPressed.2339)+1,r17
 2173 089e 0093 0000 		sts buttonPressed.2339,r16
2651:main.c        **** 				if(buttonPressed == 0)
 2174               		.stabn	68,0,2651,.LM230-.LFBB20
 2175               	.LM230:
 2176 08a2 0115      		cp r16,__zero_reg__
 2177 08a4 1105      		cpc r17,__zero_reg__
 2178 08a6 01F4      		brne .L139
2652:main.c        **** 					buttonPressed = 1;
 2179               		.stabn	68,0,2652,.LM231-.LFBB20
 2180               	.LM231:
 2181 08a8 81E0      		ldi r24,lo8(1)
 2182 08aa 90E0      		ldi r25,hi8(1)
 2183 08ac 9093 0000 		sts (buttonPressed.2339)+1,r25
 2184 08b0 8093 0000 		sts buttonPressed.2339,r24
 2185 08b4 00C0      		rjmp .L140
 2186               	.L138:
2654:main.c        **** 			else if((rowNum-buttonPressed) >= 64)
 2187               		.stabn	68,0,2654,.LM232-.LFBB20
 2188               	.LM232:
 2189 08b6 9801      		movw r18,r16
 2190 08b8 281B      		sub r18,r24
 2191 08ba 390B      		sbc r19,r25
 2192 08bc 2034      		cpi r18,64
 2193 08be 3105      		cpc r19,__zero_reg__
 2194 08c0 00F0      		brlo .L137
2655:main.c        **** 				buttonPressed += 0x4000;
 2195               		.stabn	68,0,2655,.LM233-.LFBB20
 2196               	.LM233:
 2197 08c2 8050      		subi r24,lo8(-(16384))
 2198 08c4 904C      		sbci r25,hi8(-(16384))
 2199 08c6 9093 0000 		sts (buttonPressed.2339)+1,r25
 2200 08ca 8093 0000 		sts buttonPressed.2339,r24
 2201               	.L137:
2661:main.c        **** 		if((rowNum == 0) || (buttonPressed&0x8000))
 2202               		.stabn	68,0,2661,.LM234-.LFBB20
 2203               	.LM234:
 2204 08ce 0115      		cp r16,__zero_reg__
 2205 08d0 1105      		cpc r17,__zero_reg__
 2206 08d2 01F0      		breq .L140
 2207               	.L139:
 2208 08d4 8091 0000 		lds r24,buttonPressed.2339
 2209 08d8 9091 0000 		lds r25,(buttonPressed.2339)+1
 2210 08dc 97FF      		sbrs r25,7
 2211 08de 00C0      		rjmp .L141
 2212               	.L140:
2666:main.c        **** 			if(!(buttonPressed&0x8000) && !((p_selectedSprite == &spriteQ) ||
 2213               		.stabn	68,0,2666,.LM235-.LFBB20
 2214               	.LM235:
 2215 08e0 8091 0000 		lds r24,buttonPressed.2339
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 171


 2216 08e4 9091 0000 		lds r25,(buttonPressed.2339)+1
 2217 08e8 97FD      		sbrc r25,7
 2218 08ea 00C0      		rjmp .L142
 2219 08ec 8091 0000 		lds r24,p_selectedSprite.2338
 2220 08f0 9091 0000 		lds r25,(p_selectedSprite.2338)+1
 2221 08f4 20E0      		ldi r18,hi8(spriteQ.2314)
 2222 08f6 8030      		cpi r24,lo8(spriteQ.2314)
 2223 08f8 9207      		cpc r25,r18
 2224 08fa 01F0      		breq .L142
2667:main.c        **** 												(p_selectedSprite == &spriteGOOMBA)))
 2225               		.stabn	68,0,2667,.LM236-.LFBB20
 2226               	.LM236:
 2227 08fc 40E0      		ldi r20,hi8(spriteGOOMBA.2334)
 2228 08fe 8030      		cpi r24,lo8(spriteGOOMBA.2334)
 2229 0900 9407      		cpc r25,r20
 2230 0902 01F0      		breq .L142
2668:main.c        **** 				buttonPressed = FALSE;
 2231               		.stabn	68,0,2668,.LM237-.LFBB20
 2232               	.LM237:
 2233 0904 1092 0000 		sts (buttonPressed.2339)+1,__zero_reg__
 2234 0908 1092 0000 		sts buttonPressed.2339,__zero_reg__
 2235               	.L142:
2670:main.c        **** 			if(buttonPressed)
 2236               		.stabn	68,0,2670,.LM238-.LFBB20
 2237               	.LM238:
 2238 090c 8091 0000 		lds r24,buttonPressed.2339
 2239 0910 9091 0000 		lds r25,(buttonPressed.2339)+1
 2240 0914 0097      		sbiw r24,0
 2241 0916 01F4      		brne .+2
 2242 0918 00C0      		rjmp .L143
2672:main.c        **** 				if(p_selectedSprite == &spriteGOOMBA)
 2243               		.stabn	68,0,2672,.LM239-.LFBB20
 2244               	.LM239:
 2245 091a 2091 0000 		lds r18,p_selectedSprite.2338
 2246 091e 3091 0000 		lds r19,(p_selectedSprite.2338)+1
 2247 0922 40E0      		ldi r20,hi8(spriteGOOMBA.2334)
 2248 0924 2030      		cpi r18,lo8(spriteGOOMBA.2334)
 2249 0926 3407      		cpc r19,r20
 2250 0928 01F4      		brne .L144
2674:main.c        **** 					if(qCount == 1)
 2251               		.stabn	68,0,2674,.LM240-.LFBB20
 2252               	.LM240:
 2253 092a 8091 0000 		lds r24,qCount.2290
 2254 092e 8130      		cpi r24,lo8(1)
 2255 0930 01F4      		brne .L143
2675:main.c        **** 						p_selectedSprite = &spriteDEADGOOMBA;
 2256               		.stabn	68,0,2675,.LM241-.LFBB20
 2257               	.LM241:
 2258 0932 80E0      		ldi r24,lo8(spriteDEADGOOMBA.2320)
 2259 0934 90E0      		ldi r25,hi8(spriteDEADGOOMBA.2320)
 2260 0936 00C0      		rjmp .L166
 2261               	.L144:
2683:main.c        **** 					qCount = 0;
 2262               		.stabn	68,0,2683,.LM242-.LFBB20
 2263               	.LM242:
 2264 0938 1092 0000 		sts qCount.2290,__zero_reg__
2692:main.c        **** 					switch ((buttonPressed-1)%(NUM_ICONS*2))
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 172


 2265               		.stabn	68,0,2692,.LM243-.LFBB20
 2266               	.LM243:
 2267 093c 0197      		sbiw r24,1
 2268 093e 6CE0      		ldi r22,lo8(12)
 2269 0940 70E0      		ldi r23,hi8(12)
 2270 0942 00D0      		rcall __udivmodhi4
 2271 0944 8230      		cpi r24,2
 2272 0946 9105      		cpc r25,__zero_reg__
 2273 0948 01F0      		breq .L148
 2274 094a 8330      		cpi r24,3
 2275 094c 9105      		cpc r25,__zero_reg__
 2276 094e 00F4      		brsh .L151
 2277 0950 0097      		sbiw r24,0
 2278 0952 01F0      		breq .L146
 2279 0954 8130      		cpi r24,1
 2280 0956 9105      		cpc r25,__zero_reg__
 2281 0958 01F4      		brne .L145
 2282 095a 00C0      		rjmp .L173
 2283               	.L151:
 2284 095c 8330      		cpi r24,3
 2285 095e 9105      		cpc r25,__zero_reg__
 2286 0960 01F0      		breq .L149
 2287 0962 8430      		cpi r24,4
 2288 0964 9105      		cpc r25,__zero_reg__
 2289 0966 01F4      		brne .L145
 2290 0968 00C0      		rjmp .L174
 2291               	.L146:
2696:main.c        **** 							p_selectedSprite = &spriteFLOWER;
 2292               		.stabn	68,0,2696,.LM244-.LFBB20
 2293               	.LM244:
 2294 096a 80E0      		ldi r24,lo8(spriteFLOWER.2331)
 2295 096c 90E0      		ldi r25,hi8(spriteFLOWER.2331)
 2296 096e 00C0      		rjmp .L166
 2297               	.L173:
2699:main.c        **** 							p_selectedSprite = &sprite1UP;
 2298               		.stabn	68,0,2699,.LM245-.LFBB20
 2299               	.LM245:
 2300 0970 80E0      		ldi r24,lo8(sprite1UP.2323)
 2301 0972 90E0      		ldi r25,hi8(sprite1UP.2323)
 2302 0974 00C0      		rjmp .L166
 2303               	.L148:
2702:main.c        **** 							p_selectedSprite = &spriteBIG;
 2304               		.stabn	68,0,2702,.LM246-.LFBB20
 2305               	.LM246:
 2306 0976 3092 0000 		sts (p_selectedSprite.2338)+1,r3
 2307 097a 2092 0000 		sts p_selectedSprite.2338,r2
 2308 097e 00C0      		rjmp .L143
 2309               	.L149:
2705:main.c        **** 							p_selectedSprite = &spriteSTAR;
 2310               		.stabn	68,0,2705,.LM247-.LFBB20
 2311               	.LM247:
 2312 0980 80E0      		ldi r24,lo8(spriteSTAR.2328)
 2313 0982 90E0      		ldi r25,hi8(spriteSTAR.2328)
 2314 0984 00C0      		rjmp .L166
 2315               	.L174:
2708:main.c        **** 							p_selectedSprite = &spriteGOOMBA;
 2316               		.stabn	68,0,2708,.LM248-.LFBB20
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 173


 2317               	.LM248:
 2318 0986 5092 0000 		sts (p_selectedSprite.2338)+1,r5
 2319 098a 4092 0000 		sts p_selectedSprite.2338,r4
 2320 098e 00C0      		rjmp .L143
 2321               	.L145:
2711:main.c        **** 							p_selectedSprite = &spriteCOIN;
 2322               		.stabn	68,0,2711,.LM249-.LFBB20
 2323               	.LM249:
 2324 0990 80E0      		ldi r24,lo8(spriteCOIN.2337)
 2325 0992 90E0      		ldi r25,hi8(spriteCOIN.2337)
 2326               	.L166:
 2327 0994 9093 0000 		sts (p_selectedSprite.2338)+1,r25
 2328 0998 8093 0000 		sts p_selectedSprite.2338,r24
 2329               	.L143:
2718:main.c        **** 			if(p_selectedSprite == &spriteCOIN)
 2330               		.stabn	68,0,2718,.LM250-.LFBB20
 2331               	.LM250:
 2332 099c 8091 0000 		lds r24,p_selectedSprite.2338
 2333 09a0 9091 0000 		lds r25,(p_selectedSprite.2338)+1
 2334 09a4 20E0      		ldi r18,hi8(spriteCOIN.2337)
 2335 09a6 8030      		cpi r24,lo8(spriteCOIN.2337)
 2336 09a8 9207      		cpc r25,r18
 2337 09aa 01F4      		brne .L152
2720:main.c        **** 				if(qCount >= 2)
 2338               		.stabn	68,0,2720,.LM251-.LFBB20
 2339               	.LM251:
 2340 09ac 8091 0000 		lds r24,qCount.2290
 2341 09b0 8230      		cpi r24,lo8(2)
 2342 09b2 00F4      		brsh .L167
 2343 09b4 00C0      		rjmp .L153
 2344               	.L152:
2723:main.c        **** 			else if(p_selectedSprite != &spriteQ)
 2345               		.stabn	68,0,2723,.LM252-.LFBB20
 2346               	.LM252:
 2347 09b6 40E0      		ldi r20,hi8(spriteQ.2314)
 2348 09b8 8030      		cpi r24,lo8(spriteQ.2314)
 2349 09ba 9407      		cpc r25,r20
 2350 09bc 01F0      		breq .L153
2725:main.c        **** 				if(qCount >= 4)
 2351               		.stabn	68,0,2725,.LM253-.LFBB20
 2352               	.LM253:
 2353 09be 2091 0000 		lds r18,qCount.2290
 2354 09c2 2430      		cpi r18,lo8(4)
 2355 09c4 00F0      		brlo .L153
2727:main.c        **** 					qCount = 0;
 2356               		.stabn	68,0,2727,.LM254-.LFBB20
 2357               	.LM254:
 2358 09c6 1092 0000 		sts qCount.2290,__zero_reg__
2728:main.c        **** 					if(p_selectedSprite != &spriteSOLID)
 2359               		.stabn	68,0,2728,.LM255-.LFBB20
 2360               	.LM255:
 2361 09ca 20E0      		ldi r18,hi8(spriteSOLID.2317)
 2362 09cc 8030      		cpi r24,lo8(spriteSOLID.2317)
 2363 09ce 9207      		cpc r25,r18
 2364 09d0 01F0      		breq .L154
 2365               	.L167:
2729:main.c        **** 						p_selectedSprite = &spriteSOLID;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 174


 2366               		.stabn	68,0,2729,.LM256-.LFBB20
 2367               	.LM256:
 2368 09d2 D092 0000 		sts (p_selectedSprite.2338)+1,r13
 2369 09d6 C092 0000 		sts p_selectedSprite.2338,r12
 2370 09da 00C0      		rjmp .L153
 2371               	.L154:
2731:main.c        **** 						p_selectedSprite = &spriteQ;
 2372               		.stabn	68,0,2731,.LM257-.LFBB20
 2373               	.LM257:
 2374 09dc 7092 0000 		sts (p_selectedSprite.2338)+1,r7
 2375 09e0 6092 0000 		sts p_selectedSprite.2338,r6
 2376               	.L153:
2735:main.c        **** 			buttonPressed = FALSE;
 2377               		.stabn	68,0,2735,.LM258-.LFBB20
 2378               	.LM258:
 2379 09e4 1092 0000 		sts (buttonPressed.2339)+1,__zero_reg__
 2380 09e8 1092 0000 		sts buttonPressed.2339,__zero_reg__
 2381               	.L141:
2751:main.c        **** 		if(p_selectedSprite == &spriteFLOWER)
 2382               		.stabn	68,0,2751,.LM259-.LFBB20
 2383               	.LM259:
 2384 09ec E091 0000 		lds r30,p_selectedSprite.2338
 2385 09f0 F091 0000 		lds r31,(p_selectedSprite.2338)+1
 2386 09f4 40E0      		ldi r20,hi8(spriteFLOWER.2331)
 2387 09f6 E030      		cpi r30,lo8(spriteFLOWER.2331)
 2388 09f8 F407      		cpc r31,r20
 2389 09fa 01F4      		brne .L155
2753:main.c        **** 			if(qRow<FLOWER_PALETTE1_ROW)
 2390               		.stabn	68,0,2753,.LM260-.LFBB20
 2391               	.LM260:
 2392 09fc 87E0      		ldi r24,lo8(7)
 2393 09fe 8E15      		cp r24,r14
 2394 0a00 00F0      		brlo .L156
2754:main.c        **** 				data = getGimpColorVal(&spriteFLOWER,
 2395               		.stabn	68,0,2754,.LM261-.LFBB20
 2396               	.LM261:
 2397 0a02 6091 0000 		lds r22,spriteFLOWER.2331+6
 2398 0a06 70E0      		ldi r23,lo8(0)
 2399 0a08 6150      		subi r22,lo8(-(-1))
 2400 0a0a 7040      		sbci r23,hi8(-(-1))
 2401 0a0c 8091 0000 		lds r24,qCount.2290
 2402 0a10 90E0      		ldi r25,lo8(0)
 2403 0a12 00D0      		rcall __divmodhi4
 2404 0a14 682F      		mov r22,r24
 2405 0a16 6F5F      		subi r22,lo8(-(1))
 2406 0a18 00C0      		rjmp .L168
 2407               	.L156:
2757:main.c        **** 				data = getGimpColorVal(&spriteFLOWER,0,qRow, qCol);
 2408               		.stabn	68,0,2757,.LM262-.LFBB20
 2409               	.LM262:
 2410 0a1a CF01      		movw r24,r30
 2411 0a1c 60E0      		ldi r22,lo8(0)
 2412 0a1e 00C0      		rjmp .L170
 2413               	.L155:
 2414 0a20 8091 0000 		lds r24,qCount.2290
2759:main.c        **** 		else if(p_selectedSprite == &spriteGOOMBA)
 2415               		.stabn	68,0,2759,.LM263-.LFBB20
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 175


 2416               	.LM263:
 2417 0a24 90E0      		ldi r25,hi8(spriteGOOMBA.2334)
 2418 0a26 E030      		cpi r30,lo8(spriteGOOMBA.2334)
 2419 0a28 F907      		cpc r31,r25
 2420 0a2a 01F4      		brne .L158
 2421               	.LBB130:
2763:main.c        **** 			if(qCount & 0x01)
 2422               		.stabn	68,0,2763,.LM264-.LFBB20
 2423               	.LM264:
 2424 0a2c 80FD      		sbrc r24,0
 2425 0a2e 00C0      		rjmp .L159
 2426 0a30 2F2D      		mov r18,r15
 2427 0a32 00C0      		rjmp .L160
 2428               	.L159:
 2429 0a34 292D      		mov r18,r9
 2430 0a36 2F19      		sub r18,r15
 2431               	.L160:
2766:main.c        **** 			data = getGimpColorVal(&spriteGOOMBA, 0, qRow, gCol);
 2432               		.stabn	68,0,2766,.LM265-.LFBB20
 2433               	.LM265:
 2434 0a38 80E0      		ldi r24,lo8(spriteGOOMBA.2334)
 2435 0a3a 90E0      		ldi r25,hi8(spriteGOOMBA.2334)
 2436 0a3c 60E0      		ldi r22,lo8(0)
 2437 0a3e 4E2D      		mov r20,r14
 2438 0a40 00C0      		rjmp .L169
 2439               	.L158:
 2440               	.LBE130:
2770:main.c        **** 			data = getGimpColorVal(p_selectedSprite, 
 2441               		.stabn	68,0,2770,.LM266-.LFBB20
 2442               	.LM266:
 2443 0a42 6681      		ldd r22,Z+6
 2444 0a44 00D0      		rcall __udivmodqi4
 2445 0a46 692F      		mov r22,r25
 2446               	.L168:
 2447 0a48 CF01      		movw r24,r30
 2448               	.L170:
 2449 0a4a 4E2D      		mov r20,r14
 2450 0a4c 2F2D      		mov r18,r15
 2451               	.L169:
 2452 0a4e 00D0      		rcall getGimpColorVal.2304
 2453 0a50 482F      		mov r20,r24
2773:main.c        **** 		data = gimpPixelValToLColor(data);
 2454               		.stabn	68,0,2773,.LM267-.LFBB20
 2455               	.LM267:
 2456 0a52 90E0      		ldi r25,lo8(0)
 2457 0a54 8073      		andi r24,lo8(48)
 2458 0a56 9070      		andi r25,hi8(48)
 2459 0a58 8032      		cpi r24,32
 2460 0a5a 9105      		cpc r25,__zero_reg__
 2461 0a5c 04F0      		brlt .L161
 2462 0a5e 405F      		subi r20,lo8(-(16))
 2463               	.L161:
2775:main.c        **** 		addSegfb(Q_SEGLENGTH + hfm_nextOutput(&colincrementer_hfm), data);
 2464               		.stabn	68,0,2775,.LM268-.LFBB20
 2465               	.LM268:
 2466 0a60 8B2D      		mov r24,r11
 2467 0a62 9A2D      		mov r25,r10
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 176


 2468 0a64 4F83      		std Y+7,r20
 2469 0a66 00D0      		rcall hfm_nextOutput
 2470 0a68 4F81      		ldd r20,Y+7
 2471 0a6a 242F      		mov r18,r20
 2472 0a6c 30E0      		ldi r19,lo8(0)
 2473 0a6e 90E0      		ldi r25,lo8(0)
 2474 0a70 F901      		movw r30,r18
 2475 0a72 E370      		andi r30,lo8(3)
 2476 0a74 F070      		andi r31,hi8(3)
 2477 0a76 EE0F      		lsl r30
 2478 0a78 FF1F      		rol r31
 2479 0a7a 642F      		mov r22,r20
 2480 0a7c 6170      		andi r22,lo8(1)
 2481 0a7e 6E2B      		or r22,r30
 2482 0a80 4073      		andi r20,lo8(48)
 2483 0a82 4064      		ori r20,lo8(64)
 2484 0a84 2C70      		andi r18,lo8(12)
 2485 0a86 3070      		andi r19,hi8(12)
 2486 0a88 3595      		asr r19
 2487 0a8a 2795      		ror r18
 2488 0a8c 3595      		asr r19
 2489 0a8e 2795      		ror r18
 2490 0a90 422B      		or r20,r18
 2491 0a92 4696      		adiw r24,22
 2492 0a94 00D0      		rcall addSeg
 2493               	.LBE128:
2603:main.c        **** 	for(qCol=0; qCol<Q_WIDTH; qCol++)
 2494               		.stabn	68,0,2603,.LM269-.LFBB20
 2495               	.LM269:
 2496 0a96 F394      		inc r15
 2497 0a98 20E1      		ldi r18,lo8(16)
 2498 0a9a F216      		cp r15,r18
 2499 0a9c 01F0      		breq .+2
 2500 0a9e 00C0      		rjmp .L162
2782:main.c        **** 	if(rowNum >= V_COUNT-1)
 2501               		.stabn	68,0,2782,.LM270-.LFBB20
 2502               	.LM270:
 2503 0aa0 42E0      		ldi r20,hi8(767)
 2504 0aa2 0F3F      		cpi r16,lo8(767)
 2505 0aa4 1407      		cpc r17,r20
 2506 0aa6 01F4      		brne .L163
2784:main.c        **** 		qCount++;
 2507               		.stabn	68,0,2784,.LM271-.LFBB20
 2508               	.LM271:
 2509 0aa8 8091 0000 		lds r24,qCount.2290
 2510 0aac 8F5F      		subi r24,lo8(-(1))
 2511 0aae 8093 0000 		sts qCount.2290,r24
 2512               	.L163:
2806:main.c        **** 	addSegfb(1,_W);
 2513               		.stabn	68,0,2806,.LM272-.LFBB20
 2514               	.LM272:
 2515 0ab2 81E0      		ldi r24,lo8(1)
 2516 0ab4 90E0      		ldi r25,hi8(1)
 2517 0ab6 67E0      		ldi r22,lo8(7)
 2518 0ab8 43E7      		ldi r20,lo8(115)
 2519 0aba 00D0      		rcall addSeg
2809:main.c        **** 	segTerminate();
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 177


 2520               		.stabn	68,0,2809,.LM273-.LFBB20
 2521               	.LM273:
 2522 0abc 00D0      		rcall segTerminate
 2523               	.L164:
 2524               	/* epilogue start */
 2525               	.LBE125:
 2526               	.LBE124:
2029:main.c        **** }
 2527               		.stabn	68,0,2029,.LM274-.LFBB20
 2528               	.LM274:
 2529 0abe 2796      		adiw r28,7
 2530 0ac0 DEBF      		out __SP_H__, r29
 2531 0ac2 CDBF      		out __SP_L__, r28
 2532 0ac4 CF91      		pop r28
 2533 0ac6 DF91      		pop r29
 2534 0ac8 FF91      		pop r31
 2535 0aca EF91      		pop r30
 2536 0acc BF91      		pop r27
 2537 0ace AF91      		pop r26
 2538 0ad0 9F91      		pop r25
 2539 0ad2 8F91      		pop r24
 2540 0ad4 7F91      		pop r23
 2541 0ad6 6F91      		pop r22
 2542 0ad8 5F91      		pop r21
 2543 0ada 4F91      		pop r20
 2544 0adc 3F91      		pop r19
 2545 0ade 2F91      		pop r18
 2546 0ae0 1F91      		pop r17
 2547 0ae2 0F91      		pop r16
 2548 0ae4 FF90      		pop r15
 2549 0ae6 EF90      		pop r14
 2550 0ae8 DF90      		pop r13
 2551 0aea CF90      		pop r12
 2552 0aec BF90      		pop r11
 2553 0aee AF90      		pop r10
 2554 0af0 9F90      		pop r9
 2555 0af2 7F90      		pop r7
 2556 0af4 6F90      		pop r6
 2557 0af6 5F90      		pop r5
 2558 0af8 4F90      		pop r4
 2559 0afa 3F90      		pop r3
 2560 0afc 2F90      		pop r2
 2561 0afe 0F90      		pop r0
 2562 0b00 0FBE      		out __SREG__,r0
 2563 0b02 0F90      		pop r0
 2564 0b04 1F90      		pop __zero_reg__
 2565 0b06 1895      		reti
 2566               		.size	__vector_14, .-__vector_14
 2567               		.stabs	"frameCount:V(3,2)",38,0,1986,frameCount.2275
 2568               		.stabn	192,0,0,.LFBB20-.LFBB20
 2569               		.stabs	"qRow:r(3,2)",64,0,2588,14
 2570               		.stabs	"colincrementer_hfm:(10,2)",128,0,2600,1
 2571               		.stabn	192,0,0,.LBB125-.LFBB20
 2572               		.stabs	"_BLAH_SHROOM_:T(15,1)",128,0,0,0
 2573               		.stabs	"sprite_t:t(15,3)",128,0,25,0
 2574               		.stabs	"data:r(3,2)",64,0,2749,20
 2575               		.stabn	192,0,0,.LBB128-.LFBB20
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 178


 2576               		.stabs	"gCol:r(3,2)",64,0,2761,18
 2577               		.stabn	192,0,0,.LBB129-.LFBB20
 2578               		.stabn	224,0,0,.LBE129-.LFBB20
 2579               		.stabs	"gCol:r(3,2)",64,0,2761,18
 2580               		.stabn	192,0,0,.LBB130-.LFBB20
 2581               		.stabn	224,0,0,.LBE130-.LFBB20
 2582               		.stabn	224,0,0,.LBE128-.LFBB20
 2583               		.stabn	224,0,0,.LBE125-.LFBB20
 2584               		.stabn	224,0,0,.Lscope20-.LFBB20
 2585               	.Lscope20:
 2586               		.stabs	"",36,0,0,.Lscope20-.LFBB20
 2587               		.stabd	78,0,0
 2588               	.global	header
 2589               		.section	.progmem.data,"a",@progbits
 2590               		.type	header, @object
 2591               		.size	header, 36
 2592               	header:
 2593 0000 4C43 4464 		.string	"LCDdirectLVDS59 2013-12-12 00:53:22"
 2593      6972 6563 
 2593      744C 5644 
 2593      5335 3920 
 2593      3230 3133 
 2594               	.global	characters
 2595               		.type	characters, @object
 2596               		.size	characters, 760
 2597               	characters:
 2598 0024 00        		.byte	0
 2599 0025 0C        		.byte	12
 2600 0026 36        		.byte	54
 2601 0027 36        		.byte	54
 2602 0028 0C        		.byte	12
 2603 0029 00        		.byte	0
 2604 002a 1C        		.byte	28
 2605 002b 06        		.byte	6
 2606 002c 18        		.byte	24
 2607 002d 06        		.byte	6
 2608 002e 00        		.byte	0
 2609 002f 00        		.byte	0
 2610 0030 00        		.byte	0
 2611 0031 00        		.byte	0
 2612 0032 00        		.byte	0
 2613 0033 60        		.byte	96
 2614 0034 1E        		.byte	30
 2615 0035 0C        		.byte	12
 2616 0036 1E        		.byte	30
 2617 0037 1E        		.byte	30
 2618 0038 38        		.byte	56
 2619 0039 3F        		.byte	63
 2620 003a 1C        		.byte	28
 2621 003b 3F        		.byte	63
 2622 003c 1E        		.byte	30
 2623 003d 1E        		.byte	30
 2624 003e 00        		.byte	0
 2625 003f 00        		.byte	0
 2626 0040 18        		.byte	24
 2627 0041 00        		.byte	0
 2628 0042 06        		.byte	6
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 179


 2629 0043 1E        		.byte	30
 2630 0044 3E        		.byte	62
 2631 0045 0C        		.byte	12
 2632 0046 3F        		.byte	63
 2633 0047 3C        		.byte	60
 2634 0048 3F        		.byte	63
 2635 0049 7F        		.byte	127
 2636 004a 7F        		.byte	127
 2637 004b 3C        		.byte	60
 2638 004c 33        		.byte	51
 2639 004d 1E        		.byte	30
 2640 004e 78        		.byte	120
 2641 004f 67        		.byte	103
 2642 0050 0F        		.byte	15
 2643 0051 63        		.byte	99
 2644 0052 63        		.byte	99
 2645 0053 1C        		.byte	28
 2646 0054 3F        		.byte	63
 2647 0055 1E        		.byte	30
 2648 0056 3F        		.byte	63
 2649 0057 1E        		.byte	30
 2650 0058 3F        		.byte	63
 2651 0059 33        		.byte	51
 2652 005a 33        		.byte	51
 2653 005b 63        		.byte	99
 2654 005c 63        		.byte	99
 2655 005d 33        		.byte	51
 2656 005e 7F        		.byte	127
 2657 005f 1E        		.byte	30
 2658 0060 03        		.byte	3
 2659 0061 1E        		.byte	30
 2660 0062 08        		.byte	8
 2661 0063 00        		.byte	0
 2662 0064 0C        		.byte	12
 2663 0065 00        		.byte	0
 2664 0066 07        		.byte	7
 2665 0067 00        		.byte	0
 2666 0068 38        		.byte	56
 2667 0069 00        		.byte	0
 2668 006a 1C        		.byte	28
 2669 006b 00        		.byte	0
 2670 006c 07        		.byte	7
 2671 006d 0C        		.byte	12
 2672 006e 18        		.byte	24
 2673 006f 07        		.byte	7
 2674 0070 0E        		.byte	14
 2675 0071 00        		.byte	0
 2676 0072 00        		.byte	0
 2677 0073 00        		.byte	0
 2678 0074 00        		.byte	0
 2679 0075 00        		.byte	0
 2680 0076 00        		.byte	0
 2681 0077 00        		.byte	0
 2682 0078 08        		.byte	8
 2683 0079 00        		.byte	0
 2684 007a 00        		.byte	0
 2685 007b 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 180


 2686 007c 00        		.byte	0
 2687 007d 00        		.byte	0
 2688 007e 00        		.byte	0
 2689 007f 38        		.byte	56
 2690 0080 18        		.byte	24
 2691 0081 07        		.byte	7
 2692 0082 6E        		.byte	110
 2693 0083 00        		.byte	0
 2694 0084 1E        		.byte	30
 2695 0085 36        		.byte	54
 2696 0086 36        		.byte	54
 2697 0087 3E        		.byte	62
 2698 0088 63        		.byte	99
 2699 0089 36        		.byte	54
 2700 008a 06        		.byte	6
 2701 008b 0C        		.byte	12
 2702 008c 0C        		.byte	12
 2703 008d 66        		.byte	102
 2704 008e 0C        		.byte	12
 2705 008f 00        		.byte	0
 2706 0090 00        		.byte	0
 2707 0091 00        		.byte	0
 2708 0092 30        		.byte	48
 2709 0093 33        		.byte	51
 2710 0094 0F        		.byte	15
 2711 0095 33        		.byte	51
 2712 0096 33        		.byte	51
 2713 0097 3C        		.byte	60
 2714 0098 03        		.byte	3
 2715 0099 06        		.byte	6
 2716 009a 33        		.byte	51
 2717 009b 33        		.byte	51
 2718 009c 33        		.byte	51
 2719 009d 00        		.byte	0
 2720 009e 00        		.byte	0
 2721 009f 0C        		.byte	12
 2722 00a0 00        		.byte	0
 2723 00a1 0C        		.byte	12
 2724 00a2 33        		.byte	51
 2725 00a3 63        		.byte	99
 2726 00a4 1E        		.byte	30
 2727 00a5 66        		.byte	102
 2728 00a6 66        		.byte	102
 2729 00a7 36        		.byte	54
 2730 00a8 46        		.byte	70
 2731 00a9 46        		.byte	70
 2732 00aa 66        		.byte	102
 2733 00ab 33        		.byte	51
 2734 00ac 0C        		.byte	12
 2735 00ad 30        		.byte	48
 2736 00ae 66        		.byte	102
 2737 00af 06        		.byte	6
 2738 00b0 77        		.byte	119
 2739 00b1 67        		.byte	103
 2740 00b2 36        		.byte	54
 2741 00b3 66        		.byte	102
 2742 00b4 33        		.byte	51
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 181


 2743 00b5 66        		.byte	102
 2744 00b6 33        		.byte	51
 2745 00b7 2D        		.byte	45
 2746 00b8 33        		.byte	51
 2747 00b9 33        		.byte	51
 2748 00ba 63        		.byte	99
 2749 00bb 63        		.byte	99
 2750 00bc 33        		.byte	51
 2751 00bd 33        		.byte	51
 2752 00be 06        		.byte	6
 2753 00bf 06        		.byte	6
 2754 00c0 18        		.byte	24
 2755 00c1 1C        		.byte	28
 2756 00c2 00        		.byte	0
 2757 00c3 0C        		.byte	12
 2758 00c4 00        		.byte	0
 2759 00c5 06        		.byte	6
 2760 00c6 00        		.byte	0
 2761 00c7 30        		.byte	48
 2762 00c8 00        		.byte	0
 2763 00c9 36        		.byte	54
 2764 00ca 00        		.byte	0
 2765 00cb 06        		.byte	6
 2766 00cc 00        		.byte	0
 2767 00cd 00        		.byte	0
 2768 00ce 06        		.byte	6
 2769 00cf 0C        		.byte	12
 2770 00d0 00        		.byte	0
 2771 00d1 00        		.byte	0
 2772 00d2 00        		.byte	0
 2773 00d3 00        		.byte	0
 2774 00d4 00        		.byte	0
 2775 00d5 00        		.byte	0
 2776 00d6 00        		.byte	0
 2777 00d7 0C        		.byte	12
 2778 00d8 00        		.byte	0
 2779 00d9 00        		.byte	0
 2780 00da 00        		.byte	0
 2781 00db 00        		.byte	0
 2782 00dc 00        		.byte	0
 2783 00dd 00        		.byte	0
 2784 00de 0C        		.byte	12
 2785 00df 18        		.byte	24
 2786 00e0 0C        		.byte	12
 2787 00e1 3B        		.byte	59
 2788 00e2 00        		.byte	0
 2789 00e3 1E        		.byte	30
 2790 00e4 36        		.byte	54
 2791 00e5 7F        		.byte	127
 2792 00e6 03        		.byte	3
 2793 00e7 33        		.byte	51
 2794 00e8 1C        		.byte	28
 2795 00e9 03        		.byte	3
 2796 00ea 06        		.byte	6
 2797 00eb 18        		.byte	24
 2798 00ec 3C        		.byte	60
 2799 00ed 0C        		.byte	12
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 182


 2800 00ee 00        		.byte	0
 2801 00ef 00        		.byte	0
 2802 00f0 00        		.byte	0
 2803 00f1 18        		.byte	24
 2804 00f2 3B        		.byte	59
 2805 00f3 0C        		.byte	12
 2806 00f4 30        		.byte	48
 2807 00f5 30        		.byte	48
 2808 00f6 36        		.byte	54
 2809 00f7 1F        		.byte	31
 2810 00f8 03        		.byte	3
 2811 00f9 30        		.byte	48
 2812 00fa 33        		.byte	51
 2813 00fb 33        		.byte	51
 2814 00fc 0C        		.byte	12
 2815 00fd 0C        		.byte	12
 2816 00fe 06        		.byte	6
 2817 00ff 3F        		.byte	63
 2818 0100 18        		.byte	24
 2819 0101 30        		.byte	48
 2820 0102 7B        		.byte	123
 2821 0103 33        		.byte	51
 2822 0104 66        		.byte	102
 2823 0105 03        		.byte	3
 2824 0106 66        		.byte	102
 2825 0107 16        		.byte	22
 2826 0108 16        		.byte	22
 2827 0109 03        		.byte	3
 2828 010a 33        		.byte	51
 2829 010b 0C        		.byte	12
 2830 010c 30        		.byte	48
 2831 010d 36        		.byte	54
 2832 010e 06        		.byte	6
 2833 010f 7F        		.byte	127
 2834 0110 6F        		.byte	111
 2835 0111 63        		.byte	99
 2836 0112 66        		.byte	102
 2837 0113 33        		.byte	51
 2838 0114 66        		.byte	102
 2839 0115 07        		.byte	7
 2840 0116 0C        		.byte	12
 2841 0117 33        		.byte	51
 2842 0118 33        		.byte	51
 2843 0119 63        		.byte	99
 2844 011a 36        		.byte	54
 2845 011b 33        		.byte	51
 2846 011c 19        		.byte	25
 2847 011d 06        		.byte	6
 2848 011e 0C        		.byte	12
 2849 011f 18        		.byte	24
 2850 0120 36        		.byte	54
 2851 0121 00        		.byte	0
 2852 0122 18        		.byte	24
 2853 0123 1E        		.byte	30
 2854 0124 3E        		.byte	62
 2855 0125 1E        		.byte	30
 2856 0126 30        		.byte	48
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 183


 2857 0127 1E        		.byte	30
 2858 0128 06        		.byte	6
 2859 0129 6E        		.byte	110
 2860 012a 36        		.byte	54
 2861 012b 0E        		.byte	14
 2862 012c 1E        		.byte	30
 2863 012d 66        		.byte	102
 2864 012e 0C        		.byte	12
 2865 012f 37        		.byte	55
 2866 0130 1F        		.byte	31
 2867 0131 1E        		.byte	30
 2868 0132 3B        		.byte	59
 2869 0133 6E        		.byte	110
 2870 0134 1B        		.byte	27
 2871 0135 3E        		.byte	62
 2872 0136 3E        		.byte	62
 2873 0137 33        		.byte	51
 2874 0138 33        		.byte	51
 2875 0139 63        		.byte	99
 2876 013a 63        		.byte	99
 2877 013b 33        		.byte	51
 2878 013c 3F        		.byte	63
 2879 013d 0C        		.byte	12
 2880 013e 18        		.byte	24
 2881 013f 0C        		.byte	12
 2882 0140 00        		.byte	0
 2883 0141 00        		.byte	0
 2884 0142 0C        		.byte	12
 2885 0143 00        		.byte	0
 2886 0144 36        		.byte	54
 2887 0145 1E        		.byte	30
 2888 0146 18        		.byte	24
 2889 0147 6E        		.byte	110
 2890 0148 00        		.byte	0
 2891 0149 06        		.byte	6
 2892 014a 18        		.byte	24
 2893 014b FF        		.byte	-1
 2894 014c 3F        		.byte	63
 2895 014d 00        		.byte	0
 2896 014e 3F        		.byte	63
 2897 014f 00        		.byte	0
 2898 0150 0C        		.byte	12
 2899 0151 3F        		.byte	63
 2900 0152 0C        		.byte	12
 2901 0153 1C        		.byte	28
 2902 0154 1C        		.byte	28
 2903 0155 33        		.byte	51
 2904 0156 30        		.byte	48
 2905 0157 1F        		.byte	31
 2906 0158 18        		.byte	24
 2907 0159 1E        		.byte	30
 2908 015a 3E        		.byte	62
 2909 015b 0C        		.byte	12
 2910 015c 0C        		.byte	12
 2911 015d 03        		.byte	3
 2912 015e 00        		.byte	0
 2913 015f 30        		.byte	48
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 184


 2914 0160 18        		.byte	24
 2915 0161 7B        		.byte	123
 2916 0162 33        		.byte	51
 2917 0163 3E        		.byte	62
 2918 0164 03        		.byte	3
 2919 0165 66        		.byte	102
 2920 0166 1E        		.byte	30
 2921 0167 1E        		.byte	30
 2922 0168 03        		.byte	3
 2923 0169 3F        		.byte	63
 2924 016a 0C        		.byte	12
 2925 016b 30        		.byte	48
 2926 016c 1E        		.byte	30
 2927 016d 06        		.byte	6
 2928 016e 6B        		.byte	107
 2929 016f 7B        		.byte	123
 2930 0170 63        		.byte	99
 2931 0171 3E        		.byte	62
 2932 0172 33        		.byte	51
 2933 0173 3E        		.byte	62
 2934 0174 1C        		.byte	28
 2935 0175 0C        		.byte	12
 2936 0176 33        		.byte	51
 2937 0177 33        		.byte	51
 2938 0178 6B        		.byte	107
 2939 0179 1C        		.byte	28
 2940 017a 1E        		.byte	30
 2941 017b 0C        		.byte	12
 2942 017c 06        		.byte	6
 2943 017d 18        		.byte	24
 2944 017e 18        		.byte	24
 2945 017f 63        		.byte	99
 2946 0180 00        		.byte	0
 2947 0181 00        		.byte	0
 2948 0182 30        		.byte	48
 2949 0183 66        		.byte	102
 2950 0184 33        		.byte	51
 2951 0185 3E        		.byte	62
 2952 0186 33        		.byte	51
 2953 0187 0F        		.byte	15
 2954 0188 33        		.byte	51
 2955 0189 6E        		.byte	110
 2956 018a 0C        		.byte	12
 2957 018b 18        		.byte	24
 2958 018c 36        		.byte	54
 2959 018d 0C        		.byte	12
 2960 018e 7F        		.byte	127
 2961 018f 33        		.byte	51
 2962 0190 33        		.byte	51
 2963 0191 66        		.byte	102
 2964 0192 33        		.byte	51
 2965 0193 36        		.byte	54
 2966 0194 03        		.byte	3
 2967 0195 0C        		.byte	12
 2968 0196 33        		.byte	51
 2969 0197 33        		.byte	51
 2970 0198 63        		.byte	99
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 185


 2971 0199 36        		.byte	54
 2972 019a 33        		.byte	51
 2973 019b 19        		.byte	25
 2974 019c 07        		.byte	7
 2975 019d 00        		.byte	0
 2976 019e 38        		.byte	56
 2977 019f 00        		.byte	0
 2978 01a0 00        		.byte	0
 2979 01a1 0C        		.byte	12
 2980 01a2 00        		.byte	0
 2981 01a3 7F        		.byte	127
 2982 01a4 30        		.byte	48
 2983 01a5 0C        		.byte	12
 2984 01a6 3B        		.byte	59
 2985 01a7 00        		.byte	0
 2986 01a8 06        		.byte	6
 2987 01a9 18        		.byte	24
 2988 01aa 3C        		.byte	60
 2989 01ab 0C        		.byte	12
 2990 01ac 00        		.byte	0
 2991 01ad 00        		.byte	0
 2992 01ae 00        		.byte	0
 2993 01af 06        		.byte	6
 2994 01b0 37        		.byte	55
 2995 01b1 0C        		.byte	12
 2996 01b2 06        		.byte	6
 2997 01b3 30        		.byte	48
 2998 01b4 7F        		.byte	127
 2999 01b5 30        		.byte	48
 3000 01b6 33        		.byte	51
 3001 01b7 0C        		.byte	12
 3002 01b8 33        		.byte	51
 3003 01b9 30        		.byte	48
 3004 01ba 00        		.byte	0
 3005 01bb 00        		.byte	0
 3006 01bc 06        		.byte	6
 3007 01bd 3F        		.byte	63
 3008 01be 18        		.byte	24
 3009 01bf 0C        		.byte	12
 3010 01c0 7B        		.byte	123
 3011 01c1 3F        		.byte	63
 3012 01c2 66        		.byte	102
 3013 01c3 03        		.byte	3
 3014 01c4 66        		.byte	102
 3015 01c5 16        		.byte	22
 3016 01c6 16        		.byte	22
 3017 01c7 73        		.byte	115
 3018 01c8 33        		.byte	51
 3019 01c9 0C        		.byte	12
 3020 01ca 33        		.byte	51
 3021 01cb 36        		.byte	54
 3022 01cc 46        		.byte	70
 3023 01cd 63        		.byte	99
 3024 01ce 73        		.byte	115
 3025 01cf 63        		.byte	99
 3026 01d0 06        		.byte	6
 3027 01d1 3B        		.byte	59
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 186


 3028 01d2 1E        		.byte	30
 3029 01d3 38        		.byte	56
 3030 01d4 0C        		.byte	12
 3031 01d5 33        		.byte	51
 3032 01d6 33        		.byte	51
 3033 01d7 7F        		.byte	127
 3034 01d8 36        		.byte	54
 3035 01d9 0C        		.byte	12
 3036 01da 46        		.byte	70
 3037 01db 06        		.byte	6
 3038 01dc 30        		.byte	48
 3039 01dd 18        		.byte	24
 3040 01de 00        		.byte	0
 3041 01df 00        		.byte	0
 3042 01e0 00        		.byte	0
 3043 01e1 3E        		.byte	62
 3044 01e2 66        		.byte	102
 3045 01e3 03        		.byte	3
 3046 01e4 33        		.byte	51
 3047 01e5 3F        		.byte	63
 3048 01e6 06        		.byte	6
 3049 01e7 33        		.byte	51
 3050 01e8 66        		.byte	102
 3051 01e9 0C        		.byte	12
 3052 01ea 18        		.byte	24
 3053 01eb 1E        		.byte	30
 3054 01ec 0C        		.byte	12
 3055 01ed 6B        		.byte	107
 3056 01ee 33        		.byte	51
 3057 01ef 33        		.byte	51
 3058 01f0 66        		.byte	102
 3059 01f1 33        		.byte	51
 3060 01f2 36        		.byte	54
 3061 01f3 1E        		.byte	30
 3062 01f4 0C        		.byte	12
 3063 01f5 33        		.byte	51
 3064 01f6 33        		.byte	51
 3065 01f7 6B        		.byte	107
 3066 01f8 1C        		.byte	28
 3067 01f9 33        		.byte	51
 3068 01fa 0C        		.byte	12
 3069 01fb 0C        		.byte	12
 3070 01fc 18        		.byte	24
 3071 01fd 0C        		.byte	12
 3072 01fe 00        		.byte	0
 3073 01ff 00        		.byte	0
 3074 0200 00        		.byte	0
 3075 0201 00        		.byte	0
 3076 0202 36        		.byte	54
 3077 0203 1F        		.byte	31
 3078 0204 66        		.byte	102
 3079 0205 33        		.byte	51
 3080 0206 00        		.byte	0
 3081 0207 0C        		.byte	12
 3082 0208 0C        		.byte	12
 3083 0209 66        		.byte	102
 3084 020a 0C        		.byte	12
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 187


 3085 020b 0E        		.byte	14
 3086 020c 00        		.byte	0
 3087 020d 0C        		.byte	12
 3088 020e 03        		.byte	3
 3089 020f 33        		.byte	51
 3090 0210 0C        		.byte	12
 3091 0211 33        		.byte	51
 3092 0212 33        		.byte	51
 3093 0213 30        		.byte	48
 3094 0214 33        		.byte	51
 3095 0215 33        		.byte	51
 3096 0216 06        		.byte	6
 3097 0217 33        		.byte	51
 3098 0218 18        		.byte	24
 3099 0219 0C        		.byte	12
 3100 021a 0E        		.byte	14
 3101 021b 0C        		.byte	12
 3102 021c 00        		.byte	0
 3103 021d 0C        		.byte	12
 3104 021e 00        		.byte	0
 3105 021f 03        		.byte	3
 3106 0220 33        		.byte	51
 3107 0221 66        		.byte	102
 3108 0222 66        		.byte	102
 3109 0223 36        		.byte	54
 3110 0224 46        		.byte	70
 3111 0225 06        		.byte	6
 3112 0226 66        		.byte	102
 3113 0227 33        		.byte	51
 3114 0228 0C        		.byte	12
 3115 0229 33        		.byte	51
 3116 022a 66        		.byte	102
 3117 022b 66        		.byte	102
 3118 022c 63        		.byte	99
 3119 022d 63        		.byte	99
 3120 022e 36        		.byte	54
 3121 022f 06        		.byte	6
 3122 0230 1E        		.byte	30
 3123 0231 36        		.byte	54
 3124 0232 33        		.byte	51
 3125 0233 0C        		.byte	12
 3126 0234 33        		.byte	51
 3127 0235 1E        		.byte	30
 3128 0236 77        		.byte	119
 3129 0237 63        		.byte	99
 3130 0238 0C        		.byte	12
 3131 0239 63        		.byte	99
 3132 023a 06        		.byte	6
 3133 023b 60        		.byte	96
 3134 023c 18        		.byte	24
 3135 023d 00        		.byte	0
 3136 023e 00        		.byte	0
 3137 023f 00        		.byte	0
 3138 0240 33        		.byte	51
 3139 0241 66        		.byte	102
 3140 0242 33        		.byte	51
 3141 0243 33        		.byte	51
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 188


 3142 0244 03        		.byte	3
 3143 0245 06        		.byte	6
 3144 0246 3E        		.byte	62
 3145 0247 66        		.byte	102
 3146 0248 0C        		.byte	12
 3147 0249 18        		.byte	24
 3148 024a 36        		.byte	54
 3149 024b 0C        		.byte	12
 3150 024c 63        		.byte	99
 3151 024d 33        		.byte	51
 3152 024e 33        		.byte	51
 3153 024f 3E        		.byte	62
 3154 0250 3E        		.byte	62
 3155 0251 06        		.byte	6
 3156 0252 30        		.byte	48
 3157 0253 2C        		.byte	44
 3158 0254 33        		.byte	51
 3159 0255 1E        		.byte	30
 3160 0256 7F        		.byte	127
 3161 0257 36        		.byte	54
 3162 0258 3E        		.byte	62
 3163 0259 26        		.byte	38
 3164 025a 0C        		.byte	12
 3165 025b 18        		.byte	24
 3166 025c 0C        		.byte	12
 3167 025d 00        		.byte	0
 3168 025e 00        		.byte	0
 3169 025f 0C        		.byte	12
 3170 0260 00        		.byte	0
 3171 0261 36        		.byte	54
 3172 0262 0C        		.byte	12
 3173 0263 63        		.byte	99
 3174 0264 6E        		.byte	110
 3175 0265 00        		.byte	0
 3176 0266 18        		.byte	24
 3177 0267 06        		.byte	6
 3178 0268 00        		.byte	0
 3179 0269 00        		.byte	0
 3180 026a 0C        		.byte	12
 3181 026b 00        		.byte	0
 3182 026c 0C        		.byte	12
 3183 026d 01        		.byte	1
 3184 026e 1E        		.byte	30
 3185 026f 3F        		.byte	63
 3186 0270 3F        		.byte	63
 3187 0271 1E        		.byte	30
 3188 0272 30        		.byte	48
 3189 0273 1E        		.byte	30
 3190 0274 1E        		.byte	30
 3191 0275 06        		.byte	6
 3192 0276 1E        		.byte	30
 3193 0277 0E        		.byte	14
 3194 0278 0C        		.byte	12
 3195 0279 0C        		.byte	12
 3196 027a 18        		.byte	24
 3197 027b 00        		.byte	0
 3198 027c 06        		.byte	6
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 189


 3199 027d 0C        		.byte	12
 3200 027e 1E        		.byte	30
 3201 027f 33        		.byte	51
 3202 0280 3F        		.byte	63
 3203 0281 3C        		.byte	60
 3204 0282 3F        		.byte	63
 3205 0283 7F        		.byte	127
 3206 0284 0F        		.byte	15
 3207 0285 7C        		.byte	124
 3208 0286 33        		.byte	51
 3209 0287 1E        		.byte	30
 3210 0288 1E        		.byte	30
 3211 0289 67        		.byte	103
 3212 028a 7F        		.byte	127
 3213 028b 63        		.byte	99
 3214 028c 63        		.byte	99
 3215 028d 1C        		.byte	28
 3216 028e 0F        		.byte	15
 3217 028f 38        		.byte	56
 3218 0290 67        		.byte	103
 3219 0291 1E        		.byte	30
 3220 0292 1E        		.byte	30
 3221 0293 3F        		.byte	63
 3222 0294 0C        		.byte	12
 3223 0295 63        		.byte	99
 3224 0296 63        		.byte	99
 3225 0297 1E        		.byte	30
 3226 0298 7F        		.byte	127
 3227 0299 1E        		.byte	30
 3228 029a 40        		.byte	64
 3229 029b 1E        		.byte	30
 3230 029c 00        		.byte	0
 3231 029d 00        		.byte	0
 3232 029e 00        		.byte	0
 3233 029f 6E        		.byte	110
 3234 02a0 3D        		.byte	61
 3235 02a1 1E        		.byte	30
 3236 02a2 6E        		.byte	110
 3237 02a3 1E        		.byte	30
 3238 02a4 0F        		.byte	15
 3239 02a5 30        		.byte	48
 3240 02a6 67        		.byte	103
 3241 02a7 1E        		.byte	30
 3242 02a8 1B        		.byte	27
 3243 02a9 67        		.byte	103
 3244 02aa 1E        		.byte	30
 3245 02ab 63        		.byte	99
 3246 02ac 33        		.byte	51
 3247 02ad 1E        		.byte	30
 3248 02ae 06        		.byte	6
 3249 02af 30        		.byte	48
 3250 02b0 0F        		.byte	15
 3251 02b1 1F        		.byte	31
 3252 02b2 18        		.byte	24
 3253 02b3 6E        		.byte	110
 3254 02b4 0C        		.byte	12
 3255 02b5 36        		.byte	54
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 190


 3256 02b6 63        		.byte	99
 3257 02b7 30        		.byte	48
 3258 02b8 3F        		.byte	63
 3259 02b9 38        		.byte	56
 3260 02ba 18        		.byte	24
 3261 02bb 07        		.byte	7
 3262 02bc 00        		.byte	0
 3263 02bd 00        		.byte	0
 3264 02be 00        		.byte	0
 3265 02bf 00        		.byte	0
 3266 02c0 00        		.byte	0
 3267 02c1 00        		.byte	0
 3268 02c2 00        		.byte	0
 3269 02c3 00        		.byte	0
 3270 02c4 00        		.byte	0
 3271 02c5 00        		.byte	0
 3272 02c6 00        		.byte	0
 3273 02c7 00        		.byte	0
 3274 02c8 00        		.byte	0
 3275 02c9 06        		.byte	6
 3276 02ca 00        		.byte	0
 3277 02cb 00        		.byte	0
 3278 02cc 00        		.byte	0
 3279 02cd 00        		.byte	0
 3280 02ce 00        		.byte	0
 3281 02cf 00        		.byte	0
 3282 02d0 00        		.byte	0
 3283 02d1 00        		.byte	0
 3284 02d2 00        		.byte	0
 3285 02d3 00        		.byte	0
 3286 02d4 00        		.byte	0
 3287 02d5 00        		.byte	0
 3288 02d6 00        		.byte	0
 3289 02d7 00        		.byte	0
 3290 02d8 06        		.byte	6
 3291 02d9 00        		.byte	0
 3292 02da 00        		.byte	0
 3293 02db 00        		.byte	0
 3294 02dc 00        		.byte	0
 3295 02dd 00        		.byte	0
 3296 02de 00        		.byte	0
 3297 02df 00        		.byte	0
 3298 02e0 00        		.byte	0
 3299 02e1 00        		.byte	0
 3300 02e2 00        		.byte	0
 3301 02e3 00        		.byte	0
 3302 02e4 00        		.byte	0
 3303 02e5 00        		.byte	0
 3304 02e6 00        		.byte	0
 3305 02e7 00        		.byte	0
 3306 02e8 00        		.byte	0
 3307 02e9 00        		.byte	0
 3308 02ea 00        		.byte	0
 3309 02eb 00        		.byte	0
 3310 02ec 00        		.byte	0
 3311 02ed 00        		.byte	0
 3312 02ee 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 191


 3313 02ef 00        		.byte	0
 3314 02f0 00        		.byte	0
 3315 02f1 00        		.byte	0
 3316 02f2 00        		.byte	0
 3317 02f3 00        		.byte	0
 3318 02f4 00        		.byte	0
 3319 02f5 00        		.byte	0
 3320 02f6 00        		.byte	0
 3321 02f7 00        		.byte	0
 3322 02f8 00        		.byte	0
 3323 02f9 00        		.byte	0
 3324 02fa 00        		.byte	0
 3325 02fb 00        		.byte	0
 3326 02fc FF        		.byte	-1
 3327 02fd 00        		.byte	0
 3328 02fe 00        		.byte	0
 3329 02ff 00        		.byte	0
 3330 0300 00        		.byte	0
 3331 0301 00        		.byte	0
 3332 0302 00        		.byte	0
 3333 0303 00        		.byte	0
 3334 0304 1F        		.byte	31
 3335 0305 00        		.byte	0
 3336 0306 00        		.byte	0
 3337 0307 0E        		.byte	14
 3338 0308 00        		.byte	0
 3339 0309 00        		.byte	0
 3340 030a 00        		.byte	0
 3341 030b 00        		.byte	0
 3342 030c 00        		.byte	0
 3343 030d 0F        		.byte	15
 3344 030e 78        		.byte	120
 3345 030f 00        		.byte	0
 3346 0310 00        		.byte	0
 3347 0311 00        		.byte	0
 3348 0312 00        		.byte	0
 3349 0313 00        		.byte	0
 3350 0314 00        		.byte	0
 3351 0315 00        		.byte	0
 3352 0316 1F        		.byte	31
 3353 0317 00        		.byte	0
 3354 0318 00        		.byte	0
 3355 0319 00        		.byte	0
 3356 031a 00        		.byte	0
 3357 031b 00        		.byte	0
 3358               	.global	pieceNum
 3359               	.global	pieceNum
 3360               		.section .bss
 3361               		.type	pieceNum, @object
 3362               		.size	pieceNum, 1
 3363               	pieceNum:
 3364 0000 00        		.skip 1,0
 3365               	.global	pieceOrientation
 3366               	.global	pieceOrientation
 3367               		.type	pieceOrientation, @object
 3368               		.size	pieceOrientation, 1
 3369               	pieceOrientation:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 192


 3370 0001 00        		.skip 1,0
 3371               	.global	pieceTopRow
 3372               	.global	pieceTopRow
 3373               		.type	pieceTopRow, @object
 3374               		.size	pieceTopRow, 1
 3375               	pieceTopRow:
 3376 0002 00        		.skip 1,0
 3377               	.global	pieceLeftCol
 3378               	.global	pieceLeftCol
 3379               		.type	pieceLeftCol, @object
 3380               		.size	pieceLeftCol, 1
 3381               	pieceLeftCol:
 3382 0003 00        		.skip 1,0
 3383               	.global	tetColorScheme
 3384               	.global	tetColorScheme
 3385               		.type	tetColorScheme, @object
 3386               		.size	tetColorScheme, 1
 3387               	tetColorScheme:
 3388 0004 00        		.skip 1,0
 3389               	.global	pgm_tetPiece
 3390               		.section	.progmem.data
 3391               		.type	pgm_tetPiece, @object
 3392               		.size	pgm_tetPiece, 56
 3393               	pgm_tetPiece:
 3394 031c F000      		.word	240
 3395 031e 2222      		.word	8738
 3396 0320 F000      		.word	240
 3397 0322 2222      		.word	8738
 3398 0324 600C      		.word	3168
 3399 0326 6402      		.word	612
 3400 0328 600C      		.word	3168
 3401 032a 6402      		.word	612
 3402 032c C006      		.word	1728
 3403 032e 408C      		.word	-29632
 3404 0330 C006      		.word	1728
 3405 0332 408C      		.word	-29632
 3406 0334 E004      		.word	1248
 3407 0336 C404      		.word	1220
 3408 0338 E400      		.word	228
 3409 033a 6404      		.word	1124
 3410 033c E008      		.word	2272
 3411 033e 4C04      		.word	1100
 3412 0340 E200      		.word	226
 3413 0342 4406      		.word	1604
 3414 0344 E002      		.word	736
 3415 0346 440C      		.word	3140
 3416 0348 E800      		.word	232
 3417 034a 4604      		.word	1094
 3418 034c 6006      		.word	1632
 3419 034e 6006      		.word	1632
 3420 0350 6006      		.word	1632
 3421 0352 6006      		.word	1632
 3422               	.global	segPosition
 3423               	.global	segPosition
 3424               		.section .bss
 3425               		.type	segPosition, @object
 3426               		.size	segPosition, 1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 193


 3427               	segPosition:
 3428 0005 00        		.skip 1,0
 3429               	.global	dataEnable
 3430               	.global	dataEnable
 3431               		.type	dataEnable, @object
 3432               		.size	dataEnable, 1
 3433               	dataEnable:
 3434 0006 00        		.skip 1,0
 3435               	.global	vSync
 3436               	.global	vSync
 3437               		.type	vSync, @object
 3438               		.size	vSync, 1
 3439               	vSync:
 3440 0007 00        		.skip 1,0
 3441               	.global	hsyncCount
 3442               	.global	hsyncCount
 3443               		.type	hsyncCount, @object
 3444               		.size	hsyncCount, 2
 3445               	hsyncCount:
 3446 0008 0000      		.skip 2,0
 3447               	.global	frameCount
 3448               	.global	frameCount
 3449               		.type	frameCount, @object
 3450               		.size	frameCount, 1
 3451               	frameCount:
 3452 000a 00        		.skip 1,0
 3453               	.global	pgm_image1
 3454               		.section	.progmem.data
 3455               		.type	pgm_image1, @object
 3456               		.size	pgm_image1, 256
 3457               	pgm_image1:
 3458 0354 C0        		.byte	-64
 3459 0355 C0        		.byte	-64
 3460 0356 C0        		.byte	-64
 3461 0357 C0        		.byte	-64
 3462 0358 C0        		.byte	-64
 3463 0359 00        		.byte	0
 3464 035a 00        		.byte	0
 3465 035b 00        		.byte	0
 3466 035c 00        		.byte	0
 3467 035d 00        		.byte	0
 3468 035e 00        		.byte	0
 3469 035f C0        		.byte	-64
 3470 0360 C0        		.byte	-64
 3471 0361 C0        		.byte	-64
 3472 0362 C0        		.byte	-64
 3473 0363 C0        		.byte	-64
 3474 0364 C0        		.byte	-64
 3475 0365 C0        		.byte	-64
 3476 0366 C0        		.byte	-64
 3477 0367 00        		.byte	0
 3478 0368 00        		.byte	0
 3479 0369 0F        		.byte	15
 3480 036a 0F        		.byte	15
 3481 036b 0F        		.byte	15
 3482 036c 0F        		.byte	15
 3483 036d 0F        		.byte	15
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 194


 3484 036e 0F        		.byte	15
 3485 036f 00        		.byte	0
 3486 0370 00        		.byte	0
 3487 0371 C0        		.byte	-64
 3488 0372 C0        		.byte	-64
 3489 0373 C0        		.byte	-64
 3490 0374 C0        		.byte	-64
 3491 0375 C0        		.byte	-64
 3492 0376 00        		.byte	0
 3493 0377 00        		.byte	0
 3494 0378 0F        		.byte	15
 3495 0379 0F        		.byte	15
 3496 037a 0F        		.byte	15
 3497 037b 0F        		.byte	15
 3498 037c 0F        		.byte	15
 3499 037d 0F        		.byte	15
 3500 037e 0F        		.byte	15
 3501 037f 0F        		.byte	15
 3502 0380 00        		.byte	0
 3503 0381 00        		.byte	0
 3504 0382 C0        		.byte	-64
 3505 0383 C0        		.byte	-64
 3506 0384 C0        		.byte	-64
 3507 0385 00        		.byte	0
 3508 0386 00        		.byte	0
 3509 0387 0F        		.byte	15
 3510 0388 0F        		.byte	15
 3511 0389 0F        		.byte	15
 3512 038a 0F        		.byte	15
 3513 038b 0F        		.byte	15
 3514 038c 0F        		.byte	15
 3515 038d 0F        		.byte	15
 3516 038e 0F        		.byte	15
 3517 038f 0F        		.byte	15
 3518 0390 0F        		.byte	15
 3519 0391 00        		.byte	0
 3520 0392 00        		.byte	0
 3521 0393 C0        		.byte	-64
 3522 0394 C0        		.byte	-64
 3523 0395 00        		.byte	0
 3524 0396 0F        		.byte	15
 3525 0397 0F        		.byte	15
 3526 0398 0F        		.byte	15
 3527 0399 00        		.byte	0
 3528 039a 0F        		.byte	15
 3529 039b 0F        		.byte	15
 3530 039c 0F        		.byte	15
 3531 039d 0F        		.byte	15
 3532 039e 00        		.byte	0
 3533 039f 0F        		.byte	15
 3534 03a0 0F        		.byte	15
 3535 03a1 0F        		.byte	15
 3536 03a2 00        		.byte	0
 3537 03a3 C0        		.byte	-64
 3538 03a4 00        		.byte	0
 3539 03a5 0F        		.byte	15
 3540 03a6 0F        		.byte	15
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 195


 3541 03a7 0F        		.byte	15
 3542 03a8 00        		.byte	0
 3543 03a9 00        		.byte	0
 3544 03aa 00        		.byte	0
 3545 03ab 0F        		.byte	15
 3546 03ac 0F        		.byte	15
 3547 03ad 00        		.byte	0
 3548 03ae 00        		.byte	0
 3549 03af 00        		.byte	0
 3550 03b0 0F        		.byte	15
 3551 03b1 0F        		.byte	15
 3552 03b2 0F        		.byte	15
 3553 03b3 00        		.byte	0
 3554 03b4 00        		.byte	0
 3555 03b5 0F        		.byte	15
 3556 03b6 0F        		.byte	15
 3557 03b7 0F        		.byte	15
 3558 03b8 0F        		.byte	15
 3559 03b9 00        		.byte	0
 3560 03ba 0F        		.byte	15
 3561 03bb 0F        		.byte	15
 3562 03bc 0F        		.byte	15
 3563 03bd 0F        		.byte	15
 3564 03be 00        		.byte	0
 3565 03bf 0F        		.byte	15
 3566 03c0 0F        		.byte	15
 3567 03c1 0F        		.byte	15
 3568 03c2 0F        		.byte	15
 3569 03c3 00        		.byte	0
 3570 03c4 00        		.byte	0
 3571 03c5 0F        		.byte	15
 3572 03c6 0F        		.byte	15
 3573 03c7 0F        		.byte	15
 3574 03c8 0F        		.byte	15
 3575 03c9 0F        		.byte	15
 3576 03ca 0F        		.byte	15
 3577 03cb 0F        		.byte	15
 3578 03cc 0F        		.byte	15
 3579 03cd 0F        		.byte	15
 3580 03ce 0F        		.byte	15
 3581 03cf 0F        		.byte	15
 3582 03d0 0F        		.byte	15
 3583 03d1 0F        		.byte	15
 3584 03d2 0F        		.byte	15
 3585 03d3 00        		.byte	0
 3586 03d4 00        		.byte	0
 3587 03d5 0F        		.byte	15
 3588 03d6 0F        		.byte	15
 3589 03d7 0F        		.byte	15
 3590 03d8 0F        		.byte	15
 3591 03d9 0F        		.byte	15
 3592 03da 0F        		.byte	15
 3593 03db 0F        		.byte	15
 3594 03dc 0F        		.byte	15
 3595 03dd 0F        		.byte	15
 3596 03de 0F        		.byte	15
 3597 03df 0F        		.byte	15
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 196


 3598 03e0 0F        		.byte	15
 3599 03e1 0F        		.byte	15
 3600 03e2 0F        		.byte	15
 3601 03e3 00        		.byte	0
 3602 03e4 00        		.byte	0
 3603 03e5 0F        		.byte	15
 3604 03e6 0F        		.byte	15
 3605 03e7 00        		.byte	0
 3606 03e8 00        		.byte	0
 3607 03e9 0F        		.byte	15
 3608 03ea 0F        		.byte	15
 3609 03eb 0F        		.byte	15
 3610 03ec 0F        		.byte	15
 3611 03ed 0F        		.byte	15
 3612 03ee 0F        		.byte	15
 3613 03ef 00        		.byte	0
 3614 03f0 00        		.byte	0
 3615 03f1 0F        		.byte	15
 3616 03f2 0F        		.byte	15
 3617 03f3 00        		.byte	0
 3618 03f4 00        		.byte	0
 3619 03f5 0F        		.byte	15
 3620 03f6 0F        		.byte	15
 3621 03f7 0F        		.byte	15
 3622 03f8 00        		.byte	0
 3623 03f9 00        		.byte	0
 3624 03fa 0F        		.byte	15
 3625 03fb 0F        		.byte	15
 3626 03fc 0F        		.byte	15
 3627 03fd 0F        		.byte	15
 3628 03fe 00        		.byte	0
 3629 03ff 00        		.byte	0
 3630 0400 0F        		.byte	15
 3631 0401 0F        		.byte	15
 3632 0402 0F        		.byte	15
 3633 0403 00        		.byte	0
 3634 0404 C0        		.byte	-64
 3635 0405 00        		.byte	0
 3636 0406 0F        		.byte	15
 3637 0407 0F        		.byte	15
 3638 0408 0F        		.byte	15
 3639 0409 00        		.byte	0
 3640 040a 00        		.byte	0
 3641 040b 00        		.byte	0
 3642 040c 00        		.byte	0
 3643 040d 00        		.byte	0
 3644 040e 00        		.byte	0
 3645 040f 0F        		.byte	15
 3646 0410 0F        		.byte	15
 3647 0411 0F        		.byte	15
 3648 0412 00        		.byte	0
 3649 0413 C0        		.byte	-64
 3650 0414 C0        		.byte	-64
 3651 0415 00        		.byte	0
 3652 0416 00        		.byte	0
 3653 0417 0F        		.byte	15
 3654 0418 0F        		.byte	15
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 197


 3655 0419 0F        		.byte	15
 3656 041a 0F        		.byte	15
 3657 041b 0F        		.byte	15
 3658 041c 0F        		.byte	15
 3659 041d 0F        		.byte	15
 3660 041e 0F        		.byte	15
 3661 041f 0F        		.byte	15
 3662 0420 0F        		.byte	15
 3663 0421 00        		.byte	0
 3664 0422 00        		.byte	0
 3665 0423 C0        		.byte	-64
 3666 0424 C0        		.byte	-64
 3667 0425 C0        		.byte	-64
 3668 0426 00        		.byte	0
 3669 0427 00        		.byte	0
 3670 0428 0F        		.byte	15
 3671 0429 0F        		.byte	15
 3672 042a 0F        		.byte	15
 3673 042b 0F        		.byte	15
 3674 042c 0F        		.byte	15
 3675 042d 0F        		.byte	15
 3676 042e 0F        		.byte	15
 3677 042f 0F        		.byte	15
 3678 0430 00        		.byte	0
 3679 0431 00        		.byte	0
 3680 0432 C0        		.byte	-64
 3681 0433 C0        		.byte	-64
 3682 0434 C0        		.byte	-64
 3683 0435 C0        		.byte	-64
 3684 0436 C0        		.byte	-64
 3685 0437 00        		.byte	0
 3686 0438 00        		.byte	0
 3687 0439 0F        		.byte	15
 3688 043a 0F        		.byte	15
 3689 043b 0F        		.byte	15
 3690 043c 0F        		.byte	15
 3691 043d 0F        		.byte	15
 3692 043e 0F        		.byte	15
 3693 043f 00        		.byte	0
 3694 0440 00        		.byte	0
 3695 0441 C0        		.byte	-64
 3696 0442 C0        		.byte	-64
 3697 0443 C0        		.byte	-64
 3698 0444 C0        		.byte	-64
 3699 0445 C0        		.byte	-64
 3700 0446 C0        		.byte	-64
 3701 0447 C0        		.byte	-64
 3702 0448 C0        		.byte	-64
 3703 0449 00        		.byte	0
 3704 044a 00        		.byte	0
 3705 044b 00        		.byte	0
 3706 044c 00        		.byte	0
 3707 044d 00        		.byte	0
 3708 044e 00        		.byte	0
 3709 044f C0        		.byte	-64
 3710 0450 C0        		.byte	-64
 3711 0451 C0        		.byte	-64
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 198


 3712 0452 C0        		.byte	-64
 3713 0453 C0        		.byte	-64
 3714               	.global	pgm_image2
 3715               		.type	pgm_image2, @object
 3716               		.size	pgm_image2, 256
 3717               	pgm_image2:
 3718 0454 C0        		.byte	-64
 3719 0455 C0        		.byte	-64
 3720 0456 C0        		.byte	-64
 3721 0457 C0        		.byte	-64
 3722 0458 C0        		.byte	-64
 3723 0459 00        		.byte	0
 3724 045a 00        		.byte	0
 3725 045b 00        		.byte	0
 3726 045c 00        		.byte	0
 3727 045d 00        		.byte	0
 3728 045e 00        		.byte	0
 3729 045f C0        		.byte	-64
 3730 0460 C0        		.byte	-64
 3731 0461 C0        		.byte	-64
 3732 0462 C0        		.byte	-64
 3733 0463 C0        		.byte	-64
 3734 0464 C0        		.byte	-64
 3735 0465 C0        		.byte	-64
 3736 0466 C0        		.byte	-64
 3737 0467 00        		.byte	0
 3738 0468 00        		.byte	0
 3739 0469 0F        		.byte	15
 3740 046a 0F        		.byte	15
 3741 046b 0F        		.byte	15
 3742 046c 0F        		.byte	15
 3743 046d 0F        		.byte	15
 3744 046e 0F        		.byte	15
 3745 046f 00        		.byte	0
 3746 0470 00        		.byte	0
 3747 0471 C0        		.byte	-64
 3748 0472 C0        		.byte	-64
 3749 0473 C0        		.byte	-64
 3750 0474 C0        		.byte	-64
 3751 0475 C0        		.byte	-64
 3752 0476 00        		.byte	0
 3753 0477 00        		.byte	0
 3754 0478 0F        		.byte	15
 3755 0479 0F        		.byte	15
 3756 047a 0F        		.byte	15
 3757 047b 0F        		.byte	15
 3758 047c 0F        		.byte	15
 3759 047d 0F        		.byte	15
 3760 047e 0F        		.byte	15
 3761 047f 0F        		.byte	15
 3762 0480 00        		.byte	0
 3763 0481 00        		.byte	0
 3764 0482 C0        		.byte	-64
 3765 0483 C0        		.byte	-64
 3766 0484 C0        		.byte	-64
 3767 0485 00        		.byte	0
 3768 0486 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 199


 3769 0487 0F        		.byte	15
 3770 0488 0F        		.byte	15
 3771 0489 0F        		.byte	15
 3772 048a 0F        		.byte	15
 3773 048b 0F        		.byte	15
 3774 048c 0F        		.byte	15
 3775 048d 0F        		.byte	15
 3776 048e 0F        		.byte	15
 3777 048f 0F        		.byte	15
 3778 0490 0F        		.byte	15
 3779 0491 00        		.byte	0
 3780 0492 00        		.byte	0
 3781 0493 C0        		.byte	-64
 3782 0494 C0        		.byte	-64
 3783 0495 00        		.byte	0
 3784 0496 0F        		.byte	15
 3785 0497 0F        		.byte	15
 3786 0498 0F        		.byte	15
 3787 0499 00        		.byte	0
 3788 049a 0F        		.byte	15
 3789 049b 0F        		.byte	15
 3790 049c 0F        		.byte	15
 3791 049d 0F        		.byte	15
 3792 049e 0F        		.byte	15
 3793 049f 0F        		.byte	15
 3794 04a0 0F        		.byte	15
 3795 04a1 0F        		.byte	15
 3796 04a2 00        		.byte	0
 3797 04a3 C0        		.byte	-64
 3798 04a4 00        		.byte	0
 3799 04a5 0F        		.byte	15
 3800 04a6 0F        		.byte	15
 3801 04a7 0F        		.byte	15
 3802 04a8 00        		.byte	0
 3803 04a9 00        		.byte	0
 3804 04aa 00        		.byte	0
 3805 04ab 0F        		.byte	15
 3806 04ac 0F        		.byte	15
 3807 04ad 00        		.byte	0
 3808 04ae 0F        		.byte	15
 3809 04af 0F        		.byte	15
 3810 04b0 0F        		.byte	15
 3811 04b1 0F        		.byte	15
 3812 04b2 0F        		.byte	15
 3813 04b3 00        		.byte	0
 3814 04b4 00        		.byte	0
 3815 04b5 0F        		.byte	15
 3816 04b6 0F        		.byte	15
 3817 04b7 0F        		.byte	15
 3818 04b8 0F        		.byte	15
 3819 04b9 00        		.byte	0
 3820 04ba 0F        		.byte	15
 3821 04bb 0F        		.byte	15
 3822 04bc 0F        		.byte	15
 3823 04bd 0F        		.byte	15
 3824 04be 00        		.byte	0
 3825 04bf 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 200


 3826 04c0 0F        		.byte	15
 3827 04c1 0F        		.byte	15
 3828 04c2 0F        		.byte	15
 3829 04c3 00        		.byte	0
 3830 04c4 00        		.byte	0
 3831 04c5 0F        		.byte	15
 3832 04c6 0F        		.byte	15
 3833 04c7 0F        		.byte	15
 3834 04c8 0F        		.byte	15
 3835 04c9 0F        		.byte	15
 3836 04ca 0F        		.byte	15
 3837 04cb 0F        		.byte	15
 3838 04cc 0F        		.byte	15
 3839 04cd 0F        		.byte	15
 3840 04ce 0F        		.byte	15
 3841 04cf 0F        		.byte	15
 3842 04d0 0F        		.byte	15
 3843 04d1 0F        		.byte	15
 3844 04d2 0F        		.byte	15
 3845 04d3 00        		.byte	0
 3846 04d4 00        		.byte	0
 3847 04d5 0F        		.byte	15
 3848 04d6 0F        		.byte	15
 3849 04d7 0F        		.byte	15
 3850 04d8 0F        		.byte	15
 3851 04d9 0F        		.byte	15
 3852 04da 0F        		.byte	15
 3853 04db 0F        		.byte	15
 3854 04dc 0F        		.byte	15
 3855 04dd 0F        		.byte	15
 3856 04de 0F        		.byte	15
 3857 04df 0F        		.byte	15
 3858 04e0 0F        		.byte	15
 3859 04e1 0F        		.byte	15
 3860 04e2 0F        		.byte	15
 3861 04e3 00        		.byte	0
 3862 04e4 00        		.byte	0
 3863 04e5 0F        		.byte	15
 3864 04e6 0F        		.byte	15
 3865 04e7 00        		.byte	0
 3866 04e8 00        		.byte	0
 3867 04e9 0F        		.byte	15
 3868 04ea 0F        		.byte	15
 3869 04eb 0F        		.byte	15
 3870 04ec 0F        		.byte	15
 3871 04ed 0F        		.byte	15
 3872 04ee 0F        		.byte	15
 3873 04ef 00        		.byte	0
 3874 04f0 00        		.byte	0
 3875 04f1 0F        		.byte	15
 3876 04f2 0F        		.byte	15
 3877 04f3 00        		.byte	0
 3878 04f4 00        		.byte	0
 3879 04f5 0F        		.byte	15
 3880 04f6 0F        		.byte	15
 3881 04f7 0F        		.byte	15
 3882 04f8 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 201


 3883 04f9 00        		.byte	0
 3884 04fa 0F        		.byte	15
 3885 04fb 0F        		.byte	15
 3886 04fc 0F        		.byte	15
 3887 04fd 0F        		.byte	15
 3888 04fe 00        		.byte	0
 3889 04ff 00        		.byte	0
 3890 0500 0F        		.byte	15
 3891 0501 0F        		.byte	15
 3892 0502 0F        		.byte	15
 3893 0503 00        		.byte	0
 3894 0504 C0        		.byte	-64
 3895 0505 00        		.byte	0
 3896 0506 0F        		.byte	15
 3897 0507 0F        		.byte	15
 3898 0508 0F        		.byte	15
 3899 0509 00        		.byte	0
 3900 050a 00        		.byte	0
 3901 050b 00        		.byte	0
 3902 050c 00        		.byte	0
 3903 050d 00        		.byte	0
 3904 050e 00        		.byte	0
 3905 050f 0F        		.byte	15
 3906 0510 0F        		.byte	15
 3907 0511 0F        		.byte	15
 3908 0512 00        		.byte	0
 3909 0513 C0        		.byte	-64
 3910 0514 C0        		.byte	-64
 3911 0515 00        		.byte	0
 3912 0516 00        		.byte	0
 3913 0517 0F        		.byte	15
 3914 0518 0F        		.byte	15
 3915 0519 0F        		.byte	15
 3916 051a 00        		.byte	0
 3917 051b 03        		.byte	3
 3918 051c 00        		.byte	0
 3919 051d 03        		.byte	3
 3920 051e 00        		.byte	0
 3921 051f 0F        		.byte	15
 3922 0520 0F        		.byte	15
 3923 0521 00        		.byte	0
 3924 0522 00        		.byte	0
 3925 0523 C0        		.byte	-64
 3926 0524 C0        		.byte	-64
 3927 0525 C0        		.byte	-64
 3928 0526 00        		.byte	0
 3929 0527 00        		.byte	0
 3930 0528 0F        		.byte	15
 3931 0529 0F        		.byte	15
 3932 052a 00        		.byte	0
 3933 052b 03        		.byte	3
 3934 052c 03        		.byte	3
 3935 052d 03        		.byte	3
 3936 052e 00        		.byte	0
 3937 052f 0F        		.byte	15
 3938 0530 00        		.byte	0
 3939 0531 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 202


 3940 0532 C0        		.byte	-64
 3941 0533 C0        		.byte	-64
 3942 0534 C0        		.byte	-64
 3943 0535 C0        		.byte	-64
 3944 0536 C0        		.byte	-64
 3945 0537 00        		.byte	0
 3946 0538 00        		.byte	0
 3947 0539 0F        		.byte	15
 3948 053a 0F        		.byte	15
 3949 053b 00        		.byte	0
 3950 053c 00        		.byte	0
 3951 053d 00        		.byte	0
 3952 053e 0F        		.byte	15
 3953 053f 00        		.byte	0
 3954 0540 00        		.byte	0
 3955 0541 C0        		.byte	-64
 3956 0542 C0        		.byte	-64
 3957 0543 C0        		.byte	-64
 3958 0544 C0        		.byte	-64
 3959 0545 C0        		.byte	-64
 3960 0546 C0        		.byte	-64
 3961 0547 C0        		.byte	-64
 3962 0548 C0        		.byte	-64
 3963 0549 00        		.byte	0
 3964 054a 00        		.byte	0
 3965 054b 00        		.byte	0
 3966 054c 00        		.byte	0
 3967 054d 00        		.byte	0
 3968 054e 00        		.byte	0
 3969 054f C0        		.byte	-64
 3970 0550 C0        		.byte	-64
 3971 0551 C0        		.byte	-64
 3972 0552 C0        		.byte	-64
 3973 0553 C0        		.byte	-64
 3974               		.lcomm frameCount.2275,1
 3975               		.lcomm buttonPressed.2339,2
 3976               		.data
 3977               		.type	p_selectedSprite.2338, @object
 3978               		.size	p_selectedSprite.2338, 2
 3979               	p_selectedSprite.2338:
 3980 0000 0000      		.word	spriteQ.2314
 3981               		.type	spriteCOIN.2337, @object
 3982               		.size	spriteCOIN.2337, 7
 3983               	spriteCOIN.2337:
 3984 0002 0000      		.word	pgm_imageCOIN.2335
 3985 0004 0000      		.word	0
 3986 0006 0000      		.word	pgm_paletteCOIN.2336
 3987 0008 01        		.byte	1
 3988               		.type	spriteGOOMBA.2334, @object
 3989               		.size	spriteGOOMBA.2334, 7
 3990               	spriteGOOMBA.2334:
 3991 0009 0000      		.word	pgm_imageGOOMBA.2332
 3992 000b 0000      		.word	0
 3993 000d 0000      		.word	pgm_paletteGOOMBA.2333
 3994 000f 01        		.byte	1
 3995               		.type	spriteFLOWER.2331, @object
 3996               		.size	spriteFLOWER.2331, 7
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 203


 3997               	spriteFLOWER.2331:
 3998 0010 0000      		.word	pgm_imageFLOWER.2329
 3999 0012 0000      		.word	0
 4000 0014 0000      		.word	pgm_paletteFLOWER.2330
 4001 0016 04        		.byte	4
 4002               		.type	spriteSTAR.2328, @object
 4003               		.size	spriteSTAR.2328, 7
 4004               	spriteSTAR.2328:
 4005 0017 0000      		.word	pgm_imageSTAR.2326
 4006 0019 0000      		.word	0
 4007 001b 0000      		.word	pgm_paletteSTAR.2327
 4008 001d 02        		.byte	2
 4009               		.type	spriteBIG.2325, @object
 4010               		.size	spriteBIG.2325, 7
 4011               	spriteBIG.2325:
 4012 001e 0000      		.word	pgm_imageSHROOM.2321
 4013 0020 0000      		.word	0
 4014 0022 0000      		.word	pgm_paletteBIG.2324
 4015 0024 01        		.byte	1
 4016               		.type	sprite1UP.2323, @object
 4017               		.size	sprite1UP.2323, 7
 4018               	sprite1UP.2323:
 4019 0025 0000      		.word	pgm_imageSHROOM.2321
 4020 0027 0000      		.word	0
 4021 0029 0000      		.word	pgm_palette1UP.2322
 4022 002b 01        		.byte	1
 4023               		.type	spriteDEADGOOMBA.2320, @object
 4024               		.size	spriteDEADGOOMBA.2320, 7
 4025               	spriteDEADGOOMBA.2320:
 4026 002c 0000      		.word	pgm_imageDEADGOOMBA.2318
 4027 002e 0000      		.word	0
 4028 0030 0000      		.word	pgm_paletteDEADGOOMBA.2319
 4029 0032 01        		.byte	1
 4030               		.type	spriteSOLID.2317, @object
 4031               		.size	spriteSOLID.2317, 7
 4032               	spriteSOLID.2317:
 4033 0033 0000      		.word	pgm_imageSOLID.2315
 4034 0035 0000      		.word	0
 4035 0037 0000      		.word	pgm_paletteSOLID.2316
 4036 0039 01        		.byte	1
 4037               		.type	spriteQ.2314, @object
 4038               		.size	spriteQ.2314, 7
 4039               	spriteQ.2314:
 4040 003a 0000      		.word	pgm_imageQ.2312
 4041 003c 0000      		.word	0
 4042 003e 0000      		.word	pgm_paletteQ.2313
 4043 0040 03        		.byte	3
 4044               		.lcomm qCount.2290,1
 4045               		.lcomm last_rbValue.2025,1
 4046               		.lcomm newPieceHitCount.1823,1
 4047               		.lcomm callCount.1822,1
 4048               		.comm tetRow,72,1
 4049               		.comm rowSegBuffer,138,1
 4050               		.comm rowBuffer,64,1
 4051               		.comm pimage,2,1
 4052               		.type	CSWTCH.60, @object
 4053               		.size	CSWTCH.60, 7
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 204


 4054               	CSWTCH.60:
 4055 0041 03        		.byte	3
 4056 0042 07        		.byte	7
 4057 0043 0F        		.byte	15
 4058 0044 0C        		.byte	12
 4059 0045 3C        		.byte	60
 4060 0046 30        		.byte	48
 4061 0047 33        		.byte	51
 4062               		.type	CSWTCH.63, @object
 4063               		.size	CSWTCH.63, 7
 4064               	CSWTCH.63:
 4065 0048 01        		.byte	1
 4066 0049 04        		.byte	4
 4067 004a 10        		.byte	16
 4068 004b 14        		.byte	20
 4069 004c 11        		.byte	17
 4070 004d 05        		.byte	5
 4071 004e 15        		.byte	21
 4072               		.section	.progmem.data
 4073               		.type	pgm_imageCOIN.2335, @object
 4074               		.size	pgm_imageCOIN.2335, 64
 4075               	pgm_imageCOIN.2335:
 4076 0554 00        		.byte	0
 4077 0555 00        		.byte	0
 4078 0556 00        		.byte	0
 4079 0557 00        		.byte	0
 4080 0558 00        		.byte	0
 4081 0559 40        		.byte	64
 4082 055a 01        		.byte	1
 4083 055b 00        		.byte	0
 4084 055c 00        		.byte	0
 4085 055d 50        		.byte	80
 4086 055e 05        		.byte	5
 4087 055f 00        		.byte	0
 4088 0560 00        		.byte	0
 4089 0561 54        		.byte	84
 4090 0562 15        		.byte	21
 4091 0563 00        		.byte	0
 4092 0564 00        		.byte	0
 4093 0565 94        		.byte	-108
 4094 0566 17        		.byte	23
 4095 0567 00        		.byte	0
 4096 0568 00        		.byte	0
 4097 0569 65        		.byte	101
 4098 056a 5D        		.byte	93
 4099 056b 00        		.byte	0
 4100 056c 00        		.byte	0
 4101 056d 65        		.byte	101
 4102 056e 5D        		.byte	93
 4103 056f 00        		.byte	0
 4104 0570 00        		.byte	0
 4105 0571 65        		.byte	101
 4106 0572 5D        		.byte	93
 4107 0573 00        		.byte	0
 4108 0574 00        		.byte	0
 4109 0575 65        		.byte	101
 4110 0576 5D        		.byte	93
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 205


 4111 0577 00        		.byte	0
 4112 0578 00        		.byte	0
 4113 0579 65        		.byte	101
 4114 057a 5D        		.byte	93
 4115 057b 00        		.byte	0
 4116 057c 00        		.byte	0
 4117 057d 65        		.byte	101
 4118 057e 5D        		.byte	93
 4119 057f 00        		.byte	0
 4120 0580 00        		.byte	0
 4121 0581 94        		.byte	-108
 4122 0582 17        		.byte	23
 4123 0583 00        		.byte	0
 4124 0584 00        		.byte	0
 4125 0585 54        		.byte	84
 4126 0586 15        		.byte	21
 4127 0587 00        		.byte	0
 4128 0588 00        		.byte	0
 4129 0589 50        		.byte	80
 4130 058a 05        		.byte	5
 4131 058b 00        		.byte	0
 4132 058c 00        		.byte	0
 4133 058d 40        		.byte	64
 4134 058e 01        		.byte	1
 4135 058f 00        		.byte	0
 4136 0590 00        		.byte	0
 4137 0591 00        		.byte	0
 4138 0592 00        		.byte	0
 4139 0593 00        		.byte	0
 4140               		.type	pgm_paletteCOIN.2336, @object
 4141               		.size	pgm_paletteCOIN.2336, 4
 4142               	pgm_paletteCOIN.2336:
 4143 0594 25        		.byte	37
 4144 0595 07        		.byte	7
 4145 0596 2F        		.byte	47
 4146 0597 02        		.byte	2
 4147               		.type	pgm_imageGOOMBA.2332, @object
 4148               		.size	pgm_imageGOOMBA.2332, 64
 4149               	pgm_imageGOOMBA.2332:
 4150 0598 55        		.byte	85
 4151 0599 05        		.byte	5
 4152 059a 50        		.byte	80
 4153 059b 55        		.byte	85
 4154 059c 55        		.byte	85
 4155 059d 01        		.byte	1
 4156 059e 40        		.byte	64
 4157 059f 55        		.byte	85
 4158 05a0 55        		.byte	85
 4159 05a1 00        		.byte	0
 4160 05a2 00        		.byte	0
 4161 05a3 55        		.byte	85
 4162 05a4 15        		.byte	21
 4163 05a5 00        		.byte	0
 4164 05a6 00        		.byte	0
 4165 05a7 54        		.byte	84
 4166 05a8 C5        		.byte	-59
 4167 05a9 03        		.byte	3
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 206


 4168 05aa C0        		.byte	-64
 4169 05ab 53        		.byte	83
 4170 05ac 01        		.byte	1
 4171 05ad 0E        		.byte	14
 4172 05ae B0        		.byte	-80
 4173 05af 40        		.byte	64
 4174 05b0 01        		.byte	1
 4175 05b1 FE        		.byte	-2
 4176 05b2 BF        		.byte	-65
 4177 05b3 40        		.byte	64
 4178 05b4 00        		.byte	0
 4179 05b5 2E        		.byte	46
 4180 05b6 B8        		.byte	-72
 4181 05b7 00        		.byte	0
 4182 05b8 00        		.byte	0
 4183 05b9 2A        		.byte	42
 4184 05ba A8        		.byte	-88
 4185 05bb 00        		.byte	0
 4186 05bc 00        		.byte	0
 4187 05bd 00        		.byte	0
 4188 05be 00        		.byte	0
 4189 05bf 00        		.byte	0
 4190 05c0 01        		.byte	1
 4191 05c1 A8        		.byte	-88
 4192 05c2 2A        		.byte	42
 4193 05c3 40        		.byte	64
 4194 05c4 55        		.byte	85
 4195 05c5 AA        		.byte	-86
 4196 05c6 AA        		.byte	-86
 4197 05c7 55        		.byte	85
 4198 05c8 55        		.byte	85
 4199 05c9 AA        		.byte	-86
 4200 05ca AA        		.byte	-86
 4201 05cb 5F        		.byte	95
 4202 05cc D5        		.byte	-43
 4203 05cd AB        		.byte	-85
 4204 05ce FA        		.byte	-6
 4205 05cf 7F        		.byte	127
 4206 05d0 D5        		.byte	-43
 4207 05d1 AF        		.byte	-81
 4208 05d2 FE        		.byte	-2
 4209 05d3 7F        		.byte	127
 4210 05d4 55        		.byte	85
 4211 05d5 BF        		.byte	-65
 4212 05d6 FF        		.byte	-1
 4213 05d7 5F        		.byte	95
 4214               		.type	pgm_paletteGOOMBA.2333, @object
 4215               		.size	pgm_paletteGOOMBA.2333, 4
 4216               	pgm_paletteGOOMBA.2333:
 4217 05d8 02        		.byte	2
 4218 05d9 35        		.byte	53
 4219 05da 27        		.byte	39
 4220 05db 00        		.byte	0
 4221               		.type	pgm_imageFLOWER.2329, @object
 4222               		.size	pgm_imageFLOWER.2329, 64
 4223               	pgm_imageFLOWER.2329:
 4224 05dc 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 207


 4225 05dd 55        		.byte	85
 4226 05de 55        		.byte	85
 4227 05df 00        		.byte	0
 4228 05e0 50        		.byte	80
 4229 05e1 55        		.byte	85
 4230 05e2 55        		.byte	85
 4231 05e3 05        		.byte	5
 4232 05e4 54        		.byte	84
 4233 05e5 AA        		.byte	-86
 4234 05e6 AA        		.byte	-86
 4235 05e7 15        		.byte	21
 4236 05e8 A5        		.byte	-91
 4237 05e9 FE        		.byte	-2
 4238 05ea BF        		.byte	-65
 4239 05eb 5A        		.byte	90
 4240 05ec A5        		.byte	-91
 4241 05ed FE        		.byte	-2
 4242 05ee BF        		.byte	-65
 4243 05ef 5A        		.byte	90
 4244 05f0 54        		.byte	84
 4245 05f1 AA        		.byte	-86
 4246 05f2 AA        		.byte	-86
 4247 05f3 15        		.byte	21
 4248 05f4 50        		.byte	80
 4249 05f5 55        		.byte	85
 4250 05f6 55        		.byte	85
 4251 05f7 05        		.byte	5
 4252 05f8 00        		.byte	0
 4253 05f9 55        		.byte	85
 4254 05fa 55        		.byte	85
 4255 05fb 00        		.byte	0
 4256 05fc 00        		.byte	0
 4257 05fd 40        		.byte	64
 4258 05fe 01        		.byte	1
 4259 05ff 00        		.byte	0
 4260 0600 15        		.byte	21
 4261 0601 40        		.byte	64
 4262 0602 01        		.byte	1
 4263 0603 54        		.byte	84
 4264 0604 54        		.byte	84
 4265 0605 40        		.byte	64
 4266 0606 01        		.byte	1
 4267 0607 15        		.byte	21
 4268 0608 54        		.byte	84
 4269 0609 41        		.byte	65
 4270 060a 41        		.byte	65
 4271 060b 15        		.byte	21
 4272 060c 50        		.byte	80
 4273 060d 45        		.byte	69
 4274 060e 51        		.byte	81
 4275 060f 05        		.byte	5
 4276 0610 50        		.byte	80
 4277 0611 45        		.byte	69
 4278 0612 51        		.byte	81
 4279 0613 05        		.byte	5
 4280 0614 40        		.byte	64
 4281 0615 55        		.byte	85
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 208


 4282 0616 55        		.byte	85
 4283 0617 01        		.byte	1
 4284 0618 00        		.byte	0
 4285 0619 50        		.byte	80
 4286 061a 05        		.byte	5
 4287 061b 00        		.byte	0
 4288               		.type	pgm_paletteFLOWER.2330, @object
 4289               		.size	pgm_paletteFLOWER.2330, 16
 4290               	pgm_paletteFLOWER.2330:
 4291 061c 25        		.byte	37
 4292 061d 04        		.byte	4
 4293 061e 00        		.byte	0
 4294 061f 00        		.byte	0
 4295 0620 25        		.byte	37
 4296 0621 2F        		.byte	47
 4297 0622 07        		.byte	7
 4298 0623 04        		.byte	4
 4299 0624 25        		.byte	37
 4300 0625 17        		.byte	23
 4301 0626 02        		.byte	2
 4302 0627 00        		.byte	0
 4303 0628 25        		.byte	37
 4304 0629 07        		.byte	7
 4305 062a 05        		.byte	5
 4306 062b 02        		.byte	2
 4307               		.type	pgm_imageSTAR.2326, @object
 4308               		.size	pgm_imageSTAR.2326, 64
 4309               	pgm_imageSTAR.2326:
 4310 062c 00        		.byte	0
 4311 062d 40        		.byte	64
 4312 062e 01        		.byte	1
 4313 062f 00        		.byte	0
 4314 0630 00        		.byte	0
 4315 0631 40        		.byte	64
 4316 0632 01        		.byte	1
 4317 0633 00        		.byte	0
 4318 0634 00        		.byte	0
 4319 0635 50        		.byte	80
 4320 0636 05        		.byte	5
 4321 0637 00        		.byte	0
 4322 0638 00        		.byte	0
 4323 0639 50        		.byte	80
 4324 063a 05        		.byte	5
 4325 063b 00        		.byte	0
 4326 063c 00        		.byte	0
 4327 063d 54        		.byte	84
 4328 063e 15        		.byte	21
 4329 063f 00        		.byte	0
 4330 0640 54        		.byte	84
 4331 0641 55        		.byte	85
 4332 0642 55        		.byte	85
 4333 0643 15        		.byte	21
 4334 0644 54        		.byte	84
 4335 0645 65        		.byte	101
 4336 0646 59        		.byte	89
 4337 0647 15        		.byte	21
 4338 0648 50        		.byte	80
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 209


 4339 0649 65        		.byte	101
 4340 064a 59        		.byte	89
 4341 064b 05        		.byte	5
 4342 064c 40        		.byte	64
 4343 064d 65        		.byte	101
 4344 064e 59        		.byte	89
 4345 064f 01        		.byte	1
 4346 0650 00        		.byte	0
 4347 0651 55        		.byte	85
 4348 0652 55        		.byte	85
 4349 0653 00        		.byte	0
 4350 0654 00        		.byte	0
 4351 0655 55        		.byte	85
 4352 0656 55        		.byte	85
 4353 0657 00        		.byte	0
 4354 0658 40        		.byte	64
 4355 0659 55        		.byte	85
 4356 065a 55        		.byte	85
 4357 065b 01        		.byte	1
 4358 065c 40        		.byte	64
 4359 065d 55        		.byte	85
 4360 065e 55        		.byte	85
 4361 065f 01        		.byte	1
 4362 0660 40        		.byte	64
 4363 0661 15        		.byte	21
 4364 0662 54        		.byte	84
 4365 0663 01        		.byte	1
 4366 0664 50        		.byte	80
 4367 0665 01        		.byte	1
 4368 0666 40        		.byte	64
 4369 0667 05        		.byte	5
 4370 0668 50        		.byte	80
 4371 0669 00        		.byte	0
 4372 066a 00        		.byte	0
 4373 066b 05        		.byte	5
 4374               		.type	pgm_paletteSTAR.2327, @object
 4375               		.size	pgm_paletteSTAR.2327, 8
 4376               	pgm_paletteSTAR.2327:
 4377 066c 25        		.byte	37
 4378 066d 07        		.byte	7
 4379 066e 02        		.byte	2
 4380 066f 00        		.byte	0
 4381 0670 25        		.byte	37
 4382 0671 02        		.byte	2
 4383 0672 00        		.byte	0
 4384 0673 00        		.byte	0
 4385               		.type	pgm_imageSHROOM.2321, @object
 4386               		.size	pgm_imageSHROOM.2321, 64
 4387               	pgm_imageSHROOM.2321:
 4388 0674 00        		.byte	0
 4389 0675 50        		.byte	80
 4390 0676 05        		.byte	5
 4391 0677 00        		.byte	0
 4392 0678 00        		.byte	0
 4393 0679 54        		.byte	84
 4394 067a 29        		.byte	41
 4395 067b 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 210


 4396 067c 00        		.byte	0
 4397 067d 55        		.byte	85
 4398 067e AA        		.byte	-86
 4399 067f 00        		.byte	0
 4400 0680 40        		.byte	64
 4401 0681 55        		.byte	85
 4402 0682 AA        		.byte	-86
 4403 0683 02        		.byte	2
 4404 0684 50        		.byte	80
 4405 0685 55        		.byte	85
 4406 0686 A9        		.byte	-87
 4407 0687 05        		.byte	5
 4408 0688 94        		.byte	-108
 4409 0689 5A        		.byte	90
 4410 068a 55        		.byte	85
 4411 068b 15        		.byte	21
 4412 068c A4        		.byte	-92
 4413 068d 6A        		.byte	106
 4414 068e 55        		.byte	85
 4415 068f 15        		.byte	21
 4416 0690 A5        		.byte	-91
 4417 0691 6A        		.byte	106
 4418 0692 55        		.byte	85
 4419 0693 5A        		.byte	90
 4420 0694 A5        		.byte	-91
 4421 0695 6A        		.byte	106
 4422 0696 55        		.byte	85
 4423 0697 6A        		.byte	106
 4424 0698 95        		.byte	-107
 4425 0699 5A        		.byte	90
 4426 069a 55        		.byte	85
 4427 069b 69        		.byte	105
 4428 069c 55        		.byte	85
 4429 069d 55        		.byte	85
 4430 069e 55        		.byte	85
 4431 069f 55        		.byte	85
 4432 06a0 A4        		.byte	-92
 4433 06a1 FE        		.byte	-2
 4434 06a2 BF        		.byte	-65
 4435 06a3 1A        		.byte	26
 4436 06a4 00        		.byte	0
 4437 06a5 FF        		.byte	-1
 4438 06a6 FF        		.byte	-1
 4439 06a7 00        		.byte	0
 4440 06a8 00        		.byte	0
 4441 06a9 FF        		.byte	-1
 4442 06aa DF        		.byte	-33
 4443 06ab 00        		.byte	0
 4444 06ac 00        		.byte	0
 4445 06ad FF        		.byte	-1
 4446 06ae DF        		.byte	-33
 4447 06af 00        		.byte	0
 4448 06b0 00        		.byte	0
 4449 06b1 FC        		.byte	-4
 4450 06b2 37        		.byte	55
 4451 06b3 00        		.byte	0
 4452               		.type	pgm_paletteBIG.2324, @object
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 211


 4453               		.size	pgm_paletteBIG.2324, 4
 4454               	pgm_paletteBIG.2324:
 4455 06b4 25        		.byte	37
 4456 06b5 07        		.byte	7
 4457 06b6 02        		.byte	2
 4458 06b7 2F        		.byte	47
 4459               		.type	pgm_palette1UP.2322, @object
 4460               		.size	pgm_palette1UP.2322, 4
 4461               	pgm_palette1UP.2322:
 4462 06b8 25        		.byte	37
 4463 06b9 07        		.byte	7
 4464 06ba 04        		.byte	4
 4465 06bb 2F        		.byte	47
 4466               		.type	pgm_imageDEADGOOMBA.2318, @object
 4467               		.size	pgm_imageDEADGOOMBA.2318, 64
 4468               	pgm_imageDEADGOOMBA.2318:
 4469 06bc 00        		.byte	0
 4470 06bd 00        		.byte	0
 4471 06be 00        		.byte	0
 4472 06bf 00        		.byte	0
 4473 06c0 00        		.byte	0
 4474 06c1 00        		.byte	0
 4475 06c2 00        		.byte	0
 4476 06c3 00        		.byte	0
 4477 06c4 00        		.byte	0
 4478 06c5 00        		.byte	0
 4479 06c6 00        		.byte	0
 4480 06c7 00        		.byte	0
 4481 06c8 00        		.byte	0
 4482 06c9 00        		.byte	0
 4483 06ca 00        		.byte	0
 4484 06cb 00        		.byte	0
 4485 06cc 00        		.byte	0
 4486 06cd 00        		.byte	0
 4487 06ce 00        		.byte	0
 4488 06cf 00        		.byte	0
 4489 06d0 00        		.byte	0
 4490 06d1 00        		.byte	0
 4491 06d2 00        		.byte	0
 4492 06d3 00        		.byte	0
 4493 06d4 00        		.byte	0
 4494 06d5 00        		.byte	0
 4495 06d6 00        		.byte	0
 4496 06d7 00        		.byte	0
 4497 06d8 00        		.byte	0
 4498 06d9 50        		.byte	80
 4499 06da 05        		.byte	5
 4500 06db 00        		.byte	0
 4501 06dc 40        		.byte	64
 4502 06dd 55        		.byte	85
 4503 06de 55        		.byte	85
 4504 06df 01        		.byte	1
 4505 06e0 D4        		.byte	-44
 4506 06e1 5F        		.byte	95
 4507 06e2 F5        		.byte	-11
 4508 06e3 17        		.byte	23
 4509 06e4 A5        		.byte	-91
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 212


 4510 06e5 FA        		.byte	-6
 4511 06e6 AF        		.byte	-81
 4512 06e7 5A        		.byte	90
 4513 06e8 55        		.byte	85
 4514 06e9 55        		.byte	85
 4515 06ea 55        		.byte	85
 4516 06eb 55        		.byte	85
 4517 06ec 80        		.byte	-128
 4518 06ed AA        		.byte	-86
 4519 06ee AA        		.byte	-86
 4520 06ef 02        		.byte	2
 4521 06f0 80        		.byte	-128
 4522 06f1 AA        		.byte	-86
 4523 06f2 AA        		.byte	-86
 4524 06f3 02        		.byte	2
 4525 06f4 F0        		.byte	-16
 4526 06f5 0F        		.byte	15
 4527 06f6 F0        		.byte	-16
 4528 06f7 3F        		.byte	63
 4529 06f8 00        		.byte	0
 4530 06f9 00        		.byte	0
 4531 06fa 00        		.byte	0
 4532 06fb 00        		.byte	0
 4533               		.type	pgm_paletteDEADGOOMBA.2319, @object
 4534               		.size	pgm_paletteDEADGOOMBA.2319, 4
 4535               	pgm_paletteDEADGOOMBA.2319:
 4536 06fc 25        		.byte	37
 4537 06fd 02        		.byte	2
 4538 06fe 27        		.byte	39
 4539 06ff 00        		.byte	0
 4540               		.type	pgm_imageSOLID.2315, @object
 4541               		.size	pgm_imageSOLID.2315, 64
 4542               	pgm_imageSOLID.2315:
 4543 0700 FC        		.byte	-4
 4544 0701 FF        		.byte	-1
 4545 0702 FF        		.byte	-1
 4546 0703 3F        		.byte	63
 4547 0704 57        		.byte	87
 4548 0705 55        		.byte	85
 4549 0706 55        		.byte	85
 4550 0707 D5        		.byte	-43
 4551 0708 77        		.byte	119
 4552 0709 55        		.byte	85
 4553 070a 55        		.byte	85
 4554 070b DD        		.byte	-35
 4555 070c 57        		.byte	87
 4556 070d 55        		.byte	85
 4557 070e 55        		.byte	85
 4558 070f D5        		.byte	-43
 4559 0710 57        		.byte	87
 4560 0711 55        		.byte	85
 4561 0712 55        		.byte	85
 4562 0713 D5        		.byte	-43
 4563 0714 57        		.byte	87
 4564 0715 55        		.byte	85
 4565 0716 55        		.byte	85
 4566 0717 D5        		.byte	-43
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 213


 4567 0718 57        		.byte	87
 4568 0719 55        		.byte	85
 4569 071a 55        		.byte	85
 4570 071b D5        		.byte	-43
 4571 071c 57        		.byte	87
 4572 071d 55        		.byte	85
 4573 071e 55        		.byte	85
 4574 071f D5        		.byte	-43
 4575 0720 57        		.byte	87
 4576 0721 55        		.byte	85
 4577 0722 55        		.byte	85
 4578 0723 D5        		.byte	-43
 4579 0724 57        		.byte	87
 4580 0725 55        		.byte	85
 4581 0726 55        		.byte	85
 4582 0727 D5        		.byte	-43
 4583 0728 57        		.byte	87
 4584 0729 55        		.byte	85
 4585 072a 55        		.byte	85
 4586 072b D5        		.byte	-43
 4587 072c 57        		.byte	87
 4588 072d 55        		.byte	85
 4589 072e 55        		.byte	85
 4590 072f D5        		.byte	-43
 4591 0730 57        		.byte	87
 4592 0731 55        		.byte	85
 4593 0732 55        		.byte	85
 4594 0733 D5        		.byte	-43
 4595 0734 77        		.byte	119
 4596 0735 55        		.byte	85
 4597 0736 55        		.byte	85
 4598 0737 DD        		.byte	-35
 4599 0738 57        		.byte	87
 4600 0739 55        		.byte	85
 4601 073a 55        		.byte	85
 4602 073b D5        		.byte	-43
 4603 073c FC        		.byte	-4
 4604 073d FF        		.byte	-1
 4605 073e FF        		.byte	-1
 4606 073f 3F        		.byte	63
 4607               		.type	pgm_paletteSOLID.2316, @object
 4608               		.size	pgm_paletteSOLID.2316, 4
 4609               	pgm_paletteSOLID.2316:
 4610 0740 25        		.byte	37
 4611 0741 02        		.byte	2
 4612 0742 00        		.byte	0
 4613 0743 00        		.byte	0
 4614               		.type	pgm_imageQ.2312, @object
 4615               		.size	pgm_imageQ.2312, 64
 4616               	pgm_imageQ.2312:
 4617 0744 54        		.byte	84
 4618 0745 55        		.byte	85
 4619 0746 55        		.byte	85
 4620 0747 15        		.byte	21
 4621 0748 A9        		.byte	-87
 4622 0749 AA        		.byte	-86
 4623 074a AA        		.byte	-86
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 214


 4624 074b EA        		.byte	-22
 4625 074c B9        		.byte	-71
 4626 074d AA        		.byte	-86
 4627 074e AA        		.byte	-86
 4628 074f EE        		.byte	-18
 4629 0750 A9        		.byte	-87
 4630 0751 56        		.byte	86
 4631 0752 A5        		.byte	-91
 4632 0753 EA        		.byte	-22
 4633 0754 A9        		.byte	-87
 4634 0755 F5        		.byte	-11
 4635 0756 97        		.byte	-105
 4636 0757 EA        		.byte	-22
 4637 0758 A9        		.byte	-87
 4638 0759 B5        		.byte	-75
 4639 075a D6        		.byte	-42
 4640 075b EA        		.byte	-22
 4641 075c A9        		.byte	-87
 4642 075d B5        		.byte	-75
 4643 075e D6        		.byte	-42
 4644 075f EA        		.byte	-22
 4645 0760 A9        		.byte	-87
 4646 0761 BE        		.byte	-66
 4647 0762 D5        		.byte	-43
 4648 0763 EA        		.byte	-22
 4649 0764 A9        		.byte	-87
 4650 0765 6A        		.byte	106
 4651 0766 FD        		.byte	-3
 4652 0767 EA        		.byte	-22
 4653 0768 A9        		.byte	-87
 4654 0769 6A        		.byte	106
 4655 076a AD        		.byte	-83
 4656 076b EA        		.byte	-22
 4657 076c A9        		.byte	-87
 4658 076d AA        		.byte	-86
 4659 076e AF        		.byte	-81
 4660 076f EA        		.byte	-22
 4661 0770 A9        		.byte	-87
 4662 0771 6A        		.byte	106
 4663 0772 A9        		.byte	-87
 4664 0773 EA        		.byte	-22
 4665 0774 A9        		.byte	-87
 4666 0775 6A        		.byte	106
 4667 0776 AD        		.byte	-83
 4668 0777 EA        		.byte	-22
 4669 0778 B9        		.byte	-71
 4670 0779 AA        		.byte	-86
 4671 077a AF        		.byte	-81
 4672 077b EE        		.byte	-18
 4673 077c A9        		.byte	-87
 4674 077d AA        		.byte	-86
 4675 077e AA        		.byte	-86
 4676 077f EA        		.byte	-22
 4677 0780 FF        		.byte	-1
 4678 0781 FF        		.byte	-1
 4679 0782 FF        		.byte	-1
 4680 0783 FF        		.byte	-1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 215


 4681               		.type	pgm_paletteQ.2313, @object
 4682               		.size	pgm_paletteQ.2313, 12
 4683               	pgm_paletteQ.2313:
 4684 0784 25        		.byte	37
 4685 0785 02        		.byte	2
 4686 0786 07        		.byte	7
 4687 0787 00        		.byte	0
 4688 0788 25        		.byte	37
 4689 0789 02        		.byte	2
 4690 078a 02        		.byte	2
 4691 078b 00        		.byte	0
 4692 078c 25        		.byte	37
 4693 078d 02        		.byte	2
 4694 078e 01        		.byte	1
 4695 078f 00        		.byte	0
 4696               		.stabs	"header:G(0,17)=ar(0,18)=r(0,18);0;0177777;;0;35;(3,2)",32,0,16,0
 4697               		.stabs	"characters:G(0,19)=ar(0,18);0;7;(0,20)=ar(0,18);0;94;(3,2)",32,0,30,0
 4698               		.stabs	"pgm_tetPiece:G(0,21)=ar(0,18);0;6;(0,22)=ar(0,18);0;3;(3,4)",32,0,473,0
 4699               		.stabs	"tetRow:G(0,23)=ar(0,18);0;17;(3,6)",32,0,37,0
 4700               		.stabs	"pieceNum:G(3,2)",32,0,76,0
 4701               		.stabs	"pieceOrientation:G(3,2)",32,0,77,0
 4702               		.stabs	"pieceTopRow:G(3,2)",32,0,79,0
 4703               		.stabs	"pieceLeftCol:G(3,2)",32,0,80,0
 4704               		.stabs	"tetColorScheme:G(3,2)",32,0,399,0
 4705               		.stabs	"rowSegBuffer:G(0,24)=ar(0,18);0;68;(13,2)",32,0,106,0
 4706               		.stabs	"segPosition:G(3,2)",32,0,151,0
 4707               		.stabs	"rowBuffer:G(0,25)=ar(0,18);0;63;(3,2)",32,0,81,0
 4708               		.stabs	"pimage:G(15,2)",32,0,1957,0
 4709               		.stabs	"dataEnable:G(3,2)",32,0,1141,0
 4710               		.stabs	"vSync:G(3,2)",32,0,1142,0
 4711               		.stabs	"hsyncCount:G(3,4)",32,0,1143,0
 4712               		.stabs	"frameCount:G(3,2)",32,0,1148,0
 4713               		.stabs	"pgm_image1:G(0,26)=ar(0,18);0;255;(3,2)",32,0,3930,0
 4714               		.stabs	"pgm_image2:G(0,26)",32,0,3996,0
 4715               		.text
 4716               		.stabs	"",100,0,0,.Letext0
 4717               	.Letext0:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 216


DEFINED SYMBOLS
                            *ABS*:00000000 main.c
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:2      *ABS*:0000003f __SREG__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3      *ABS*:0000003e __SP_H__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4      *ABS*:0000003d __SP_L__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:5      *ABS*:00000000 __tmp_reg__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:6      *ABS*:00000001 __zero_reg__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:120    .text:00000000 getTetBrick
                            *COM*:00000048 tetRow
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:171    .text:00000036 setTetBrick
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:255    .text:000000b2 tetInit
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:325    .text:000000f0 tetUpdate
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4045   .bss:00000010 newPieceHitCount.1823
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3369   .bss:00000001 pieceOrientation
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3381   .bss:00000003 pieceLeftCol
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3375   .bss:00000002 pieceTopRow
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4046   .bss:00000011 callCount.1822
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3363   .bss:00000000 pieceNum
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3393   .progmem.data:0000031c pgm_tetPiece
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:758    .text:00000340 tetBrick_to_fb
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3387   .bss:00000004 tetColorScheme
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4054   .data:00000041 CSWTCH.60
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4064   .data:00000048 CSWTCH.63
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:811    .text:00000370 segClear
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3427   .bss:00000005 segPosition
                            *COM*:0000008a rowSegBuffer
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:842    .text:00000382 segTerminate
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:919    .text:000003da newSeg
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1039   .text:0000045a stretchSeg
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1143   .text:000004b8 addSeg
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1200   .text:000004ee rbpix_to_seg
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4044   .bss:0000000f last_rbValue.2025
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1292   .text:00000554 fb_to_rb
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1349   .text:00000592 pll_enable
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1423   .text:000005b2 lvds_timerInit
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1513   .text:00000600 lcd_Init
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1539   .text:0000060a updateLCD
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3433   .bss:00000006 dataEnable
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3439   .bss:00000007 vSync
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1662   .text:0000064a LoadNext_974
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1698   .text:0000068e Done_974
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1678   .text:00000668 Counter_974
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3445   .bss:00000008 hsyncCount
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1824   .text:0000070c getGimpColorVal.2304
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1911   .text:00000768 init_timer0Hsync
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1951   .text:00000782 main
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3451   .bss:0000000a frameCount
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:1994   .text:000007a2 __vector_14
                             .bss:0000000b frameCount.2275
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4039   .data:0000003a spriteQ.2314
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4032   .data:00000033 spriteSOLID.2317
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3990   .data:00000009 spriteGOOMBA.2334
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4011   .data:0000001e spriteBIG.2325
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3974   .bss:0000000c buttonPressed.2339
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3979   .data:00000000 p_selectedSprite.2338
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3975   .bss:0000000e qCount.2290
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4025   .data:0000002c spriteDEADGOOMBA.2320
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s 			page 217


/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3997   .data:00000010 spriteFLOWER.2331
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4018   .data:00000025 sprite1UP.2323
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4004   .data:00000017 spriteSTAR.2328
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3983   .data:00000002 spriteCOIN.2337
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:2592   .progmem.data:00000000 header
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:2597   .progmem.data:00000024 characters
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3457   .progmem.data:00000354 pgm_image1
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:3717   .progmem.data:00000454 pgm_image2
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4075   .progmem.data:00000554 pgm_imageCOIN.2335
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4142   .progmem.data:00000594 pgm_paletteCOIN.2336
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4149   .progmem.data:00000598 pgm_imageGOOMBA.2332
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4216   .progmem.data:000005d8 pgm_paletteGOOMBA.2333
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4223   .progmem.data:000005dc pgm_imageFLOWER.2329
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4290   .progmem.data:0000061c pgm_paletteFLOWER.2330
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4309   .progmem.data:0000062c pgm_imageSTAR.2326
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4376   .progmem.data:0000066c pgm_paletteSTAR.2327
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4387   .progmem.data:00000674 pgm_imageSHROOM.2321
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4454   .progmem.data:000006b4 pgm_paletteBIG.2324
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4461   .progmem.data:000006b8 pgm_palette1UP.2322
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4468   .progmem.data:000006bc pgm_imageDEADGOOMBA.2318
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4535   .progmem.data:000006fc pgm_paletteDEADGOOMBA.2319
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4542   .progmem.data:00000700 pgm_imageSOLID.2315
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4609   .progmem.data:00000740 pgm_paletteSOLID.2316
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4616   .progmem.data:00000744 pgm_imageQ.2312
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccLMKG9N.s:4683   .progmem.data:00000784 pgm_paletteQ.2313
                            *COM*:00000040 rowBuffer
                            *COM*:00000002 pimage

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
__mulhi3
timer_setWGM
timer_selectDivisor
timer_compareMatchIntSetup
hfm_setup
__udivmodhi4
__divmodhi4
__udivmodqi4
hfm_nextOutput
