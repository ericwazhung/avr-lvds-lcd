GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 1


   1               		.file	"main.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.stabs	"/Users/meh/_avrProjects/LCDdirectLVDS/90-reGitting/",100,0,2,.Ltext0
   8               		.stabs	"main.c",100,0,2,.Ltext0
   9               		.text
  10               	.Ltext0:
  11               		.stabs	"gcc2_compiled.",60,0,0,0
  12               		.stabs	"int:t(0,1)=r(0,1);-32768;32767;",128,0,0,0
  13               		.stabs	"char:t(0,2)=@s8;r(0,2);0;255;",128,0,0,0
  14               		.stabs	"long int:t(0,3)=@s32;r(0,3);020000000000;017777777777;",128,0,0,0
  15               		.stabs	"unsigned int:t(0,4)=r(0,4);0;0177777;",128,0,0,0
  16               		.stabs	"long unsigned int:t(0,5)=@s32;r(0,5);0;037777777777;",128,0,0,0
  17               		.stabs	"long long int:t(0,6)=@s64;r(0,6);01000000000000000000000;0777777777777777777777;",128,0,0,
  18               		.stabs	"long long unsigned int:t(0,7)=@s64;r(0,7);0;01777777777777777777777;",128,0,0,0
  19               		.stabs	"short int:t(0,8)=r(0,8);-32768;32767;",128,0,0,0
  20               		.stabs	"short unsigned int:t(0,9)=r(0,9);0;0177777;",128,0,0,0
  21               		.stabs	"signed char:t(0,10)=@s8;r(0,10);-128;127;",128,0,0,0
  22               		.stabs	"unsigned char:t(0,11)=@s8;r(0,11);0;255;",128,0,0,0
  23               		.stabs	"float:t(0,12)=r(0,1);4;0;",128,0,0,0
  24               		.stabs	"double:t(0,13)=r(0,1);4;0;",128,0,0,0
  25               		.stabs	"long double:t(0,14)=r(0,1);4;0;",128,0,0,0
  26               		.stabs	"short _Fract:t(0,15)=r(0,1);1;0;",128,0,0,0
  27               		.stabs	"_Fract:t(0,16)=r(0,1);2;0;",128,0,0,0
  28               		.stabs	"long _Fract:t(0,17)=r(0,1);4;0;",128,0,0,0
  29               		.stabs	"long long _Fract:t(0,18)=r(0,1);8;0;",128,0,0,0
  30               		.stabs	"unsigned short _Fract:t(0,19)=r(0,1);1;0;",128,0,0,0
  31               		.stabs	"unsigned _Fract:t(0,20)=r(0,1);2;0;",128,0,0,0
  32               		.stabs	"unsigned long _Fract:t(0,21)=r(0,1);4;0;",128,0,0,0
  33               		.stabs	"unsigned long long _Fract:t(0,22)=r(0,1);8;0;",128,0,0,0
  34               		.stabs	"_Sat short _Fract:t(0,23)=r(0,1);1;0;",128,0,0,0
  35               		.stabs	"_Sat _Fract:t(0,24)=r(0,1);2;0;",128,0,0,0
  36               		.stabs	"_Sat long _Fract:t(0,25)=r(0,1);4;0;",128,0,0,0
  37               		.stabs	"_Sat long long _Fract:t(0,26)=r(0,1);8;0;",128,0,0,0
  38               		.stabs	"_Sat unsigned short _Fract:t(0,27)=r(0,1);1;0;",128,0,0,0
  39               		.stabs	"_Sat unsigned _Fract:t(0,28)=r(0,1);2;0;",128,0,0,0
  40               		.stabs	"_Sat unsigned long _Fract:t(0,29)=r(0,1);4;0;",128,0,0,0
  41               		.stabs	"_Sat unsigned long long _Fract:t(0,30)=r(0,1);8;0;",128,0,0,0
  42               		.stabs	"short _Accum:t(0,31)=r(0,1);2;0;",128,0,0,0
  43               		.stabs	"_Accum:t(0,32)=r(0,1);4;0;",128,0,0,0
  44               		.stabs	"long _Accum:t(0,33)=r(0,1);8;0;",128,0,0,0
  45               		.stabs	"long long _Accum:t(0,34)=r(0,1);8;0;",128,0,0,0
  46               		.stabs	"unsigned short _Accum:t(0,35)=r(0,1);2;0;",128,0,0,0
  47               		.stabs	"unsigned _Accum:t(0,36)=r(0,1);4;0;",128,0,0,0
  48               		.stabs	"unsigned long _Accum:t(0,37)=r(0,1);8;0;",128,0,0,0
  49               		.stabs	"unsigned long long _Accum:t(0,38)=r(0,1);8;0;",128,0,0,0
  50               		.stabs	"_Sat short _Accum:t(0,39)=r(0,1);2;0;",128,0,0,0
  51               		.stabs	"_Sat _Accum:t(0,40)=r(0,1);4;0;",128,0,0,0
  52               		.stabs	"_Sat long _Accum:t(0,41)=r(0,1);8;0;",128,0,0,0
  53               		.stabs	"_Sat long long _Accum:t(0,42)=r(0,1);8;0;",128,0,0,0
  54               		.stabs	"_Sat unsigned short _Accum:t(0,43)=r(0,1);2;0;",128,0,0,0
  55               		.stabs	"_Sat unsigned _Accum:t(0,44)=r(0,1);4;0;",128,0,0,0
  56               		.stabs	"_Sat unsigned long _Accum:t(0,45)=r(0,1);8;0;",128,0,0,0
  57               		.stabs	"_Sat unsigned long long _Accum:t(0,46)=r(0,1);8;0;",128,0,0,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 2


  58               		.stabs	"void:t(0,47)=(0,47)",128,0,0,0
  59               		.stabs	"projInfo.h",130,0,0,0
  60               		.stabs	"/opt/local/avr/include/inttypes.h",130,0,0,0
  61               		.stabs	"/opt/local/lib/gcc/avr/4.8.2/include/stdint.h",130,0,0,0
  62               		.stabs	"/opt/local/avr/include/stdint.h",130,0,0,0
  63               		.stabs	"int8_t:t(4,1)=(0,10)",128,0,121,0
  64               		.stabs	"uint8_t:t(4,2)=(0,11)",128,0,122,0
  65               		.stabs	"int16_t:t(4,3)=(0,1)",128,0,123,0
  66               		.stabs	"uint16_t:t(4,4)=(0,4)",128,0,124,0
  67               		.stabs	"int32_t:t(4,5)=(0,3)",128,0,125,0
  68               		.stabs	"uint32_t:t(4,6)=(0,5)",128,0,126,0
  69               		.stabs	"int64_t:t(4,7)=(0,6)",128,0,128,0
  70               		.stabs	"uint64_t:t(4,8)=(0,7)",128,0,129,0
  71               		.stabs	"intptr_t:t(4,9)=(4,3)",128,0,142,0
  72               		.stabs	"uintptr_t:t(4,10)=(4,4)",128,0,147,0
  73               		.stabs	"int_least8_t:t(4,11)=(4,1)",128,0,159,0
  74               		.stabs	"uint_least8_t:t(4,12)=(4,2)",128,0,164,0
  75               		.stabs	"int_least16_t:t(4,13)=(4,3)",128,0,169,0
  76               		.stabs	"uint_least16_t:t(4,14)=(4,4)",128,0,174,0
  77               		.stabs	"int_least32_t:t(4,15)=(4,5)",128,0,179,0
  78               		.stabs	"uint_least32_t:t(4,16)=(4,6)",128,0,184,0
  79               		.stabs	"int_least64_t:t(4,17)=(4,7)",128,0,192,0
  80               		.stabs	"uint_least64_t:t(4,18)=(4,8)",128,0,199,0
  81               		.stabs	"int_fast8_t:t(4,19)=(4,1)",128,0,213,0
  82               		.stabs	"uint_fast8_t:t(4,20)=(4,2)",128,0,218,0
  83               		.stabs	"int_fast16_t:t(4,21)=(4,3)",128,0,223,0
  84               		.stabs	"uint_fast16_t:t(4,22)=(4,4)",128,0,228,0
  85               		.stabs	"int_fast32_t:t(4,23)=(4,5)",128,0,233,0
  86               		.stabs	"uint_fast32_t:t(4,24)=(4,6)",128,0,238,0
  87               		.stabs	"int_fast64_t:t(4,25)=(4,7)",128,0,246,0
  88               		.stabs	"uint_fast64_t:t(4,26)=(4,8)",128,0,253,0
  89               		.stabs	"intmax_t:t(4,27)=(4,7)",128,0,273,0
  90               		.stabs	"uintmax_t:t(4,28)=(4,8)",128,0,278,0
  91               		.stabn	162,0,0,0
  92               		.stabn	162,0,0,0
  93               		.stabs	"int_farptr_t:t(2,1)=(4,5)",128,0,77,0
  94               		.stabs	"uint_farptr_t:t(2,2)=(4,6)",128,0,81,0
  95               		.stabn	162,0,0,0
  96               		.stabn	162,0,0,0
  97               		.stabs	"main.h",130,0,0,0
  98               		.stabs	"/opt/local/avr/include/avr/io.h",130,0,0,0
  99               		.stabs	"/opt/local/avr/include/avr/fuse.h",130,0,0,0
 100               		.stabs	"__fuse_t:t(7,1)=(7,2)=s3low:(0,11),0,8;high:(0,11),8,8;extended:(0,11),16,8;;",128,0,244,0
 101               		.stabn	162,0,0,0
 102               		.stabn	162,0,0,0
 103               		.stabs	"/opt/local/avr/include/stdlib.h",130,0,0,0
 104               		.stabs	"/opt/local/lib/gcc/avr/4.8.2/include/stddef.h",130,0,0,0
 105               		.stabs	"size_t:t(9,1)=(0,4)",128,0,212,0
 106               		.stabs	"wchar_t:t(9,2)=(0,1)",128,0,324,0
 107               		.stabn	162,0,0,0
 108               		.stabs	"div_t:t(8,1)=(8,2)=s4quot:(0,1),0,16;rem:(0,1),16,16;;",128,0,71,0
 109               		.stabs	"ldiv_t:t(8,3)=(8,4)=s8quot:(0,3),0,32;rem:(0,3),32,32;;",128,0,77,0
 110               		.stabs	"__compar_fn_t:t(8,5)=(8,6)=*(8,7)=f(0,1)",128,0,80,0
 111               		.stabn	162,0,0,0
 112               		.stabs	"_commonCode_localized/heartbeat/1.50/heartbeat.h",130,0,0,0
 113               		.stabs	"./_commonCode_localized/hfModulation/1.00/hfModulation.h",130,0,0,0
 114               		.stabs	"hfm_t:t(11,1)=(11,2)=B(11,3)=s4desiredSum:(4,3),0,16;maxPower:(4,2),16,8;power:(4,2),24,8;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 3


 115               		.stabn	162,0,0,0
 116               		.stabn	162,0,0,0
 117               		.stabn	162,0,0,0
 118               		.stabs	"/opt/local/avr/include/avr/pgmspace.h",130,0,0,0
 119               		.stabs	"prog_void:t(12,1)=(12,2)=(12,2)",128,0,349,0
 120               		.stabs	"prog_char:t(12,3)=(12,4)=@s8;r(12,4);0;255;",128,0,350,0
 121               		.stabs	"prog_uchar:t(12,5)=(12,6)=@s8;r(12,6);0;255;",128,0,351,0
 122               		.stabs	"prog_int8_t:t(12,7)=(12,8)=(0,10)",128,0,352,0
 123               		.stabs	"prog_uint8_t:t(12,9)=(12,10)=(0,11)",128,0,353,0
 124               		.stabs	"prog_int16_t:t(12,11)=(12,12)=(0,1)",128,0,354,0
 125               		.stabs	"prog_uint16_t:t(12,13)=(12,14)=(0,4)",128,0,355,0
 126               		.stabs	"prog_int32_t:t(12,15)=(12,16)=(0,3)",128,0,356,0
 127               		.stabs	"prog_uint32_t:t(12,17)=(12,18)=(0,5)",128,0,357,0
 128               		.stabs	"prog_int64_t:t(12,19)=(12,20)=(0,6)",128,0,359,0
 129               		.stabs	"prog_uint64_t:t(12,21)=(12,22)=(0,7)",128,0,360,0
 130               		.stabn	162,0,0,0
 131               		.stabs	"fb_question.c",130,0,0,0
 132               		.stabs	"icons/Question.h",130,0,0,0
 133               		.stabs	"icons/iconPacking.h",130,0,0,0
 134               		.stabs	"_BLAH_MOTION_:T(15,1)=s3startPosition:(15,2)=k(4,2),0,8;motion:(15,3)=*(15,2),8,16;;",128,
 135               		.stabs	"motion_t:t(15,4)=(15,1)",128,0,40,0
 136               		.stabs	"_BLAH_SPRITE_:T(15,5)=s19p_image:(15,6)=*(15,7)=ar(15,8)=r(15,8);0;0177777;;0;63;(15,2),0,
 137               		.stabs	"sprite_t:t(15,11)=(15,5)",128,0,96,0
 138               		.stabs	"icons/spriteMotion.h",130,0,0,0
 139               		.stabs	"_BLAH_STATUS_:T(16,1)=s14position:(16,2)=ar(15,8);0;1;(4,1),0,16;dir:(16,2),16,16;count:(4
 140               		.stabs	"spriteState_t:t(16,5)=(16,1)",128,0,52,0
 141               		.stabn	162,0,0,0
 142               		.stabn	162,0,0,0
 143               		.stabn	162,0,0,0
 144               		.stabn	162,0,0,0
 145               		.stabs	"pll_enable:F(0,47)",36,0,56,pll_enable
 146               	.global	pll_enable
 147               		.type	pll_enable, @function
 148               	pll_enable:
 149               		.stabd	46,0,0
 150               		.stabs	"pll.c",132,0,0,.Ltext1
 151               	.Ltext1:
   1:pll.c         **** /* mehPL:
   2:pll.c         ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:pll.c         ****  *    I'm not too fond of long licenses at the top of the file.
   4:pll.c         ****  *    Please see the bottom.
   5:pll.c         ****  *    Enjoy!
   6:pll.c         ****  */
   7:pll.c         **** 
   8:pll.c         **** 
   9:pll.c         **** 
  10:pll.c         **** 
  11:pll.c         **** 
  12:pll.c         **** 
  13:pll.c         **** 
  14:pll.c         **** 
  15:pll.c         **** 
  16:pll.c         **** #if(defined(__AVR_AT90PWM161__))
  17:pll.c         **** //PWM161 notes:
  18:pll.c         **** // The PWM161 has a PLL Multiplication-Factor which can be adjusted
  19:pll.c         **** //  4-8x the source-clock, with every step between
  20:pll.c         **** //  This could be AWESOME for LVDS, with a multiplcation-factor of 7...?
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 4


  21:pll.c         **** // "When Vcc is below 4.5V, maximum PLL-factor is 6"
  22:pll.c         **** //  we'll see. Best stick with 8 for now, since all the math relies on it.
  23:pll.c         **** //  But look here if it doesn't seem to be syncing...
  24:pll.c         **** #warning "PLL_MULT_FACTOR defaults to 8, which is allegedly too fast for 3.3V"
  25:pll.c         **** #define PLL_MULT_FACTOR	8
  26:pll.c         **** // "PLLF3 is used for debug purpose", its value is always 0
  27:pll.c         **** // The PLLF3:0 bits are used to set the multiplication-factor
  28:pll.c         **** //  They're shifted two bits left
  29:pll.c         **** //  And 2 is added to the value written to these bits to determine the
  30:pll.c         **** //  multiplication-factor...
  31:pll.c         **** #define PLL_MULT_MASK	(0x07<<2)
  32:pll.c         **** 
  33:pll.c         **** #define pll_setMult(factor) \
  34:pll.c         **** 			writeMasked(((factor-2)<<2), PLL_MULT_MASK, PLLCSR)
  35:pll.c         **** 
  36:pll.c         **** 
  37:pll.c         **** // The pll_enable procedure isn't quite so clearly-defined...
  38:pll.c         **** //   there's no step-by-step procedure I've found so far.
  39:pll.c         **** //p271 Table 22-4 says the maximum PLL lock-in-time is 64us, so 100 should
  40:pll.c         **** //be fine.
  41:pll.c         **** 
  42:pll.c         **** #endif
  43:pll.c         **** 
  44:pll.c         **** 
  45:pll.c         **** //pll_enable does just what it says, using instructions from the ATtiny861
  46:pll.c         **** //   manual.
  47:pll.c         **** //   The PLL is used, in all cases, for the FPD-Link signals (generated by
  48:pll.c         **** //   Timer1's PWM). But, it may be prescaled back down to CPU-speeds or
  49:pll.c         **** //   even lower. Also, when PLL_SYSCLK is true, the PLL is actually used to
  50:pll.c         **** //   drive the CPU... I don't fully comprehend how this works, because the
  51:pll.c         **** //   pll_enable can't be called *before* the system boots... Anyways, It
  52:pll.c         **** //   seems to work, regardless, and calling pll_enable() in this mode
  53:pll.c         **** //   doesn't seem to cause any problems.
  54:pll.c         **** 
  55:pll.c         **** 
  56:pll.c         **** void pll_enable(void)
  57:pll.c         **** {
 152               		.stabn	68,0,57,.LM0-.LFBB1
 153               	.LM0:
 154               	.LFBB1:
 155               	/* prologue: function */
 156               	/* frame size = 0 */
 157               	/* stack size = 0 */
 158               	.L__stack_usage = 0
  58:pll.c         **** #if(defined(__AVR_AT90PWM161__))
  59:pll.c         **** 	pll_setMult(PLL_MULT_FACTOR);
  60:pll.c         **** #endif
  61:pll.c         ****    //Stolen from threePinIDer109t:
  62:pll.c         **** 
  63:pll.c         ****    //Set Timer1 to use the "asynchronous clock source" (PLL at 64MHz)
  64:pll.c         ****    // With phase-correct PWM (256 steps up, then back down) and CLKDIV1
  65:pll.c         ****    // this is 64MHz/512=125kHz
  66:pll.c         ****    // The benefit of such high PWM frequency is the low RC values necessary
  67:pll.c         ****    //  for filtering to DC.
  68:pll.c         **** 	// From the ATtiny861 manual:
  69:pll.c         **** 	// "To change Timer/Counter1 to the async mode follow this procedure"
  70:pll.c         ****    // 1: Enable the PLL
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 5


  71:pll.c         ****    setbit(PLLE, PLLCSR);
 159               		.stabn	68,0,71,.LM1-.LFBB1
 160               	.LM1:
 161 0000 89B5      		in r24,0x29
 162 0002 8260      		ori r24,lo8(2)
 163 0004 89BD      		out 0x29,r24
 164               	.LBB144:
 165               	.LBB145:
 166               		.stabs	"/opt/local/avr/include/util/delay.h",132,0,0,.Ltext2
 167               	.Ltext2:
   1:/opt/local/avr/include/util/delay.h **** /* Copyright (c) 2002, Marek Michalkiewicz
   2:/opt/local/avr/include/util/delay.h ****    Copyright (c) 2004,2005,2007 Joerg Wunsch
   3:/opt/local/avr/include/util/delay.h ****    Copyright (c) 2007  Florin-Viorel Petrov
   4:/opt/local/avr/include/util/delay.h ****    All rights reserved.
   5:/opt/local/avr/include/util/delay.h **** 
   6:/opt/local/avr/include/util/delay.h ****    Redistribution and use in source and binary forms, with or without
   7:/opt/local/avr/include/util/delay.h ****    modification, are permitted provided that the following conditions are met:
   8:/opt/local/avr/include/util/delay.h **** 
   9:/opt/local/avr/include/util/delay.h ****    * Redistributions of source code must retain the above copyright
  10:/opt/local/avr/include/util/delay.h ****      notice, this list of conditions and the following disclaimer.
  11:/opt/local/avr/include/util/delay.h **** 
  12:/opt/local/avr/include/util/delay.h ****    * Redistributions in binary form must reproduce the above copyright
  13:/opt/local/avr/include/util/delay.h ****      notice, this list of conditions and the following disclaimer in
  14:/opt/local/avr/include/util/delay.h ****      the documentation and/or other materials provided with the
  15:/opt/local/avr/include/util/delay.h ****      distribution.
  16:/opt/local/avr/include/util/delay.h **** 
  17:/opt/local/avr/include/util/delay.h ****    * Neither the name of the copyright holders nor the names of
  18:/opt/local/avr/include/util/delay.h ****      contributors may be used to endorse or promote products derived
  19:/opt/local/avr/include/util/delay.h ****      from this software without specific prior written permission.
  20:/opt/local/avr/include/util/delay.h **** 
  21:/opt/local/avr/include/util/delay.h ****   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  22:/opt/local/avr/include/util/delay.h ****   AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  23:/opt/local/avr/include/util/delay.h ****   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  24:/opt/local/avr/include/util/delay.h ****   ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
  25:/opt/local/avr/include/util/delay.h ****   LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
  26:/opt/local/avr/include/util/delay.h ****   CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
  27:/opt/local/avr/include/util/delay.h ****   SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
  28:/opt/local/avr/include/util/delay.h ****   INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
  29:/opt/local/avr/include/util/delay.h ****   CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
  30:/opt/local/avr/include/util/delay.h ****   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  31:/opt/local/avr/include/util/delay.h ****   POSSIBILITY OF SUCH DAMAGE. */
  32:/opt/local/avr/include/util/delay.h **** 
  33:/opt/local/avr/include/util/delay.h **** /* $Id: delay.h.in 2385 2013-05-03 13:14:20Z joerg_wunsch $ */
  34:/opt/local/avr/include/util/delay.h **** 
  35:/opt/local/avr/include/util/delay.h **** #ifndef _UTIL_DELAY_H_
  36:/opt/local/avr/include/util/delay.h **** #define _UTIL_DELAY_H_ 1
  37:/opt/local/avr/include/util/delay.h **** 
  38:/opt/local/avr/include/util/delay.h **** #ifndef __HAS_DELAY_CYCLES
  39:/opt/local/avr/include/util/delay.h **** #define __HAS_DELAY_CYCLES 1
  40:/opt/local/avr/include/util/delay.h **** #endif
  41:/opt/local/avr/include/util/delay.h **** 
  42:/opt/local/avr/include/util/delay.h **** #include <inttypes.h>
  43:/opt/local/avr/include/util/delay.h **** #include <util/delay_basic.h>
  44:/opt/local/avr/include/util/delay.h **** #include <math.h>
  45:/opt/local/avr/include/util/delay.h **** 
  46:/opt/local/avr/include/util/delay.h **** /** \file */
  47:/opt/local/avr/include/util/delay.h **** /** \defgroup util_delay <util/delay.h>: Convenience functions for busy-wait delay loops
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 6


  48:/opt/local/avr/include/util/delay.h ****     \code
  49:/opt/local/avr/include/util/delay.h ****     #define F_CPU 1000000UL  // 1 MHz
  50:/opt/local/avr/include/util/delay.h ****     //#define F_CPU 14.7456E6
  51:/opt/local/avr/include/util/delay.h ****     #include <util/delay.h>
  52:/opt/local/avr/include/util/delay.h ****     \endcode
  53:/opt/local/avr/include/util/delay.h **** 
  54:/opt/local/avr/include/util/delay.h ****     \note As an alternative method, it is possible to pass the
  55:/opt/local/avr/include/util/delay.h ****     F_CPU macro down to the compiler from the Makefile.
  56:/opt/local/avr/include/util/delay.h ****     Obviously, in that case, no \c \#define statement should be
  57:/opt/local/avr/include/util/delay.h ****     used.
  58:/opt/local/avr/include/util/delay.h **** 
  59:/opt/local/avr/include/util/delay.h ****     The functions in this header file are wrappers around the basic
  60:/opt/local/avr/include/util/delay.h ****     busy-wait functions from <util/delay_basic.h>.  They are meant as
  61:/opt/local/avr/include/util/delay.h ****     convenience functions where actual time values can be specified
  62:/opt/local/avr/include/util/delay.h ****     rather than a number of cycles to wait for.  The idea behind is
  63:/opt/local/avr/include/util/delay.h ****     that compile-time constant expressions will be eliminated by
  64:/opt/local/avr/include/util/delay.h ****     compiler optimization so floating-point expressions can be used
  65:/opt/local/avr/include/util/delay.h ****     to calculate the number of delay cycles needed based on the CPU
  66:/opt/local/avr/include/util/delay.h ****     frequency passed by the macro F_CPU.
  67:/opt/local/avr/include/util/delay.h **** 
  68:/opt/local/avr/include/util/delay.h ****     \note In order for these functions to work as intended, compiler
  69:/opt/local/avr/include/util/delay.h ****     optimizations <em>must</em> be enabled, and the delay time
  70:/opt/local/avr/include/util/delay.h ****     <em>must</em> be an expression that is a known constant at
  71:/opt/local/avr/include/util/delay.h ****     compile-time.  If these requirements are not met, the resulting
  72:/opt/local/avr/include/util/delay.h ****     delay will be much longer (and basically unpredictable), and
  73:/opt/local/avr/include/util/delay.h ****     applications that otherwise do not use floating-point calculations
  74:/opt/local/avr/include/util/delay.h ****     will experience severe code bloat by the floating-point library
  75:/opt/local/avr/include/util/delay.h ****     routines linked into the application.
  76:/opt/local/avr/include/util/delay.h **** 
  77:/opt/local/avr/include/util/delay.h ****     The functions available allow the specification of microsecond, and
  78:/opt/local/avr/include/util/delay.h ****     millisecond delays directly, using the application-supplied macro
  79:/opt/local/avr/include/util/delay.h ****     F_CPU as the CPU clock frequency (in Hertz).
  80:/opt/local/avr/include/util/delay.h **** 
  81:/opt/local/avr/include/util/delay.h **** */
  82:/opt/local/avr/include/util/delay.h **** 
  83:/opt/local/avr/include/util/delay.h **** #if !defined(__DOXYGEN__)
  84:/opt/local/avr/include/util/delay.h **** static inline void _delay_us(double __us) __attribute__((always_inline));
  85:/opt/local/avr/include/util/delay.h **** static inline void _delay_ms(double __ms) __attribute__((always_inline));
  86:/opt/local/avr/include/util/delay.h **** #endif
  87:/opt/local/avr/include/util/delay.h **** 
  88:/opt/local/avr/include/util/delay.h **** #ifndef F_CPU
  89:/opt/local/avr/include/util/delay.h **** /* prevent compiler error by supplying a default */
  90:/opt/local/avr/include/util/delay.h **** # warning "F_CPU not defined for <util/delay.h>"
  91:/opt/local/avr/include/util/delay.h **** # define F_CPU 1000000UL
  92:/opt/local/avr/include/util/delay.h **** #endif
  93:/opt/local/avr/include/util/delay.h **** 
  94:/opt/local/avr/include/util/delay.h **** #ifndef __OPTIMIZE__
  95:/opt/local/avr/include/util/delay.h **** # warning "Compiler optimizations disabled; functions from <util/delay.h> won't work as designed"
  96:/opt/local/avr/include/util/delay.h **** #endif
  97:/opt/local/avr/include/util/delay.h **** 
  98:/opt/local/avr/include/util/delay.h **** #if __HAS_DELAY_CYCLES && defined(__OPTIMIZE__) && \
  99:/opt/local/avr/include/util/delay.h ****   !defined(__DELAY_BACKWARD_COMPATIBLE__) &&	   \
 100:/opt/local/avr/include/util/delay.h ****   __STDC_HOSTED__
 101:/opt/local/avr/include/util/delay.h **** #  include <math.h>
 102:/opt/local/avr/include/util/delay.h **** #endif
 103:/opt/local/avr/include/util/delay.h **** 
 104:/opt/local/avr/include/util/delay.h **** /**
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 7


 105:/opt/local/avr/include/util/delay.h ****    \ingroup util_delay
 106:/opt/local/avr/include/util/delay.h **** 
 107:/opt/local/avr/include/util/delay.h ****    Perform a delay of \c __ms milliseconds, using _delay_loop_2().
 108:/opt/local/avr/include/util/delay.h **** 
 109:/opt/local/avr/include/util/delay.h ****    The macro F_CPU is supposed to be defined to a
 110:/opt/local/avr/include/util/delay.h ****    constant defining the CPU clock frequency (in Hertz).
 111:/opt/local/avr/include/util/delay.h **** 
 112:/opt/local/avr/include/util/delay.h ****    The maximal possible delay is 262.14 ms / F_CPU in MHz.
 113:/opt/local/avr/include/util/delay.h **** 
 114:/opt/local/avr/include/util/delay.h ****    When the user request delay which exceed the maximum possible one,
 115:/opt/local/avr/include/util/delay.h ****    _delay_ms() provides a decreased resolution functionality. In this
 116:/opt/local/avr/include/util/delay.h ****    mode _delay_ms() will work with a resolution of 1/10 ms, providing
 117:/opt/local/avr/include/util/delay.h ****    delays up to 6.5535 seconds (independent from CPU frequency).  The
 118:/opt/local/avr/include/util/delay.h ****    user will not be informed about decreased resolution.
 119:/opt/local/avr/include/util/delay.h **** 
 120:/opt/local/avr/include/util/delay.h ****    If the avr-gcc toolchain has __builtin_avr_delay_cycles(unsigned long)
 121:/opt/local/avr/include/util/delay.h ****    support, maximal possible delay is 4294967.295 ms/ F_CPU in MHz. For
 122:/opt/local/avr/include/util/delay.h ****    values greater than the maximal possible delay, overflows results in
 123:/opt/local/avr/include/util/delay.h ****    no delay i.e., 0ms.
 124:/opt/local/avr/include/util/delay.h **** 
 125:/opt/local/avr/include/util/delay.h ****    Conversion of __us into clock cycles may not always result in integer.
 126:/opt/local/avr/include/util/delay.h ****    By default, the clock cycles rounded up to next integer. This ensures that
 127:/opt/local/avr/include/util/delay.h ****    the user gets atleast __us microseconds of delay.
 128:/opt/local/avr/include/util/delay.h **** 
 129:/opt/local/avr/include/util/delay.h ****    Alternatively, user can define __DELAY_ROUND_DOWN__ and __DELAY_ROUND_CLOSEST__
 130:/opt/local/avr/include/util/delay.h ****    to round down and round to closest integer.
 131:/opt/local/avr/include/util/delay.h **** 
 132:/opt/local/avr/include/util/delay.h ****    Note: The new implementation of _delay_ms(double __ms) with 
 133:/opt/local/avr/include/util/delay.h ****     __builtin_avr_delay_cycles(unsigned long) support is not backward compatible. 
 134:/opt/local/avr/include/util/delay.h ****    User can define __DELAY_BACKWARD_COMPATIBLE__ to get a backward compatible delay.
 135:/opt/local/avr/include/util/delay.h ****    Also, the backward compatible
 136:/opt/local/avr/include/util/delay.h ****    algorithm will be chosen if the code is compiled in a <em>freestanding
 137:/opt/local/avr/include/util/delay.h ****    environment</em> (GCC option \c -ffreestanding), as the math functions
 138:/opt/local/avr/include/util/delay.h ****    required for rounding are not available to the compiler then.
 139:/opt/local/avr/include/util/delay.h **** 
 140:/opt/local/avr/include/util/delay.h ****  */
 141:/opt/local/avr/include/util/delay.h **** void
 142:/opt/local/avr/include/util/delay.h **** _delay_ms(double __ms)
 143:/opt/local/avr/include/util/delay.h **** {
 144:/opt/local/avr/include/util/delay.h **** 	double __tmp ; 
 145:/opt/local/avr/include/util/delay.h **** #if __HAS_DELAY_CYCLES && defined(__OPTIMIZE__) && \
 146:/opt/local/avr/include/util/delay.h ****   !defined(__DELAY_BACKWARD_COMPATIBLE__) &&	   \
 147:/opt/local/avr/include/util/delay.h ****   __STDC_HOSTED__
 148:/opt/local/avr/include/util/delay.h **** 	uint32_t __ticks_dc;
 149:/opt/local/avr/include/util/delay.h **** 	extern void __builtin_avr_delay_cycles(unsigned long);
 150:/opt/local/avr/include/util/delay.h **** 	__tmp = ((F_CPU) / 1e3) * __ms;
 151:/opt/local/avr/include/util/delay.h **** 
 152:/opt/local/avr/include/util/delay.h **** 	#if defined(__DELAY_ROUND_DOWN__)
 153:/opt/local/avr/include/util/delay.h **** 		__ticks_dc = (uint32_t)fabs(__tmp);
 154:/opt/local/avr/include/util/delay.h **** 
 155:/opt/local/avr/include/util/delay.h **** 	#elif defined(__DELAY_ROUND_CLOSEST__)
 156:/opt/local/avr/include/util/delay.h **** 		__ticks_dc = (uint32_t)(fabs(__tmp)+0.5);
 157:/opt/local/avr/include/util/delay.h **** 
 158:/opt/local/avr/include/util/delay.h **** 	#else
 159:/opt/local/avr/include/util/delay.h **** 		//round up by default
 160:/opt/local/avr/include/util/delay.h **** 		__ticks_dc = (uint32_t)(ceil(fabs(__tmp)));
 161:/opt/local/avr/include/util/delay.h **** 	#endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 8


 162:/opt/local/avr/include/util/delay.h **** 
 163:/opt/local/avr/include/util/delay.h **** 	__builtin_avr_delay_cycles(__ticks_dc);
 164:/opt/local/avr/include/util/delay.h **** 
 165:/opt/local/avr/include/util/delay.h **** #else
 166:/opt/local/avr/include/util/delay.h **** 	uint16_t __ticks;
 167:/opt/local/avr/include/util/delay.h **** 	__tmp = ((F_CPU) / 4e3) * __ms;
 168:/opt/local/avr/include/util/delay.h **** 	if (__tmp < 1.0)
 169:/opt/local/avr/include/util/delay.h **** 		__ticks = 1;
 170:/opt/local/avr/include/util/delay.h **** 	else if (__tmp > 65535)
 171:/opt/local/avr/include/util/delay.h **** 	{
 172:/opt/local/avr/include/util/delay.h **** 		//	__ticks = requested delay in 1/10 ms
 173:/opt/local/avr/include/util/delay.h **** 		__ticks = (uint16_t) (__ms * 10.0);
 174:/opt/local/avr/include/util/delay.h **** 		while(__ticks)
 175:/opt/local/avr/include/util/delay.h **** 		{
 176:/opt/local/avr/include/util/delay.h **** 			// wait 1/10 ms
 177:/opt/local/avr/include/util/delay.h **** 			_delay_loop_2(((F_CPU) / 4e3) / 10);
 178:/opt/local/avr/include/util/delay.h **** 			__ticks --;
 179:/opt/local/avr/include/util/delay.h **** 		}
 180:/opt/local/avr/include/util/delay.h **** 		return;
 181:/opt/local/avr/include/util/delay.h **** 	}
 182:/opt/local/avr/include/util/delay.h **** 	else
 183:/opt/local/avr/include/util/delay.h **** 		__ticks = (uint16_t)__tmp;
 184:/opt/local/avr/include/util/delay.h **** 	_delay_loop_2(__ticks);
 185:/opt/local/avr/include/util/delay.h **** #endif
 186:/opt/local/avr/include/util/delay.h **** }
 187:/opt/local/avr/include/util/delay.h **** 
 188:/opt/local/avr/include/util/delay.h **** /**
 189:/opt/local/avr/include/util/delay.h ****    \ingroup util_delay
 190:/opt/local/avr/include/util/delay.h **** 
 191:/opt/local/avr/include/util/delay.h ****    Perform a delay of \c __us microseconds, using _delay_loop_1().
 192:/opt/local/avr/include/util/delay.h **** 
 193:/opt/local/avr/include/util/delay.h ****    The macro F_CPU is supposed to be defined to a
 194:/opt/local/avr/include/util/delay.h ****    constant defining the CPU clock frequency (in Hertz).
 195:/opt/local/avr/include/util/delay.h **** 
 196:/opt/local/avr/include/util/delay.h ****    The maximal possible delay is 768 us / F_CPU in MHz.
 197:/opt/local/avr/include/util/delay.h **** 
 198:/opt/local/avr/include/util/delay.h ****    If the user requests a delay greater than the maximal possible one,
 199:/opt/local/avr/include/util/delay.h ****    _delay_us() will automatically call _delay_ms() instead.  The user
 200:/opt/local/avr/include/util/delay.h ****    will not be informed about this case.
 201:/opt/local/avr/include/util/delay.h **** 
 202:/opt/local/avr/include/util/delay.h ****    If the avr-gcc toolchain has __builtin_avr_delay_cycles(unsigned long)
 203:/opt/local/avr/include/util/delay.h ****    support, maximal possible delay is 4294967.295 us/ F_CPU in MHz. For
 204:/opt/local/avr/include/util/delay.h ****    values greater than the maximal possible delay, overflow results in
 205:/opt/local/avr/include/util/delay.h ****    no delay i.e., 0us.
 206:/opt/local/avr/include/util/delay.h ****   
 207:/opt/local/avr/include/util/delay.h ****    Conversion of __us into clock cycles may not always result in integer.
 208:/opt/local/avr/include/util/delay.h ****    By default, the clock cycles rounded up to next integer. This ensures that
 209:/opt/local/avr/include/util/delay.h ****    the user gets atleast __us microseconds of delay.
 210:/opt/local/avr/include/util/delay.h **** 
 211:/opt/local/avr/include/util/delay.h ****    Alternatively, user can define __DELAY_ROUND_DOWN__ and __DELAY_ROUND_CLOSEST__
 212:/opt/local/avr/include/util/delay.h ****    to round down and round to closest integer.
 213:/opt/local/avr/include/util/delay.h ****  
 214:/opt/local/avr/include/util/delay.h ****    Note: The new implementation of _delay_us(double __us) with 
 215:/opt/local/avr/include/util/delay.h ****     __builtin_avr_delay_cycles(unsigned long) support is not backward compatible.
 216:/opt/local/avr/include/util/delay.h ****    User can define __DELAY_BACKWARD_COMPATIBLE__ to get a backward compatible delay.
 217:/opt/local/avr/include/util/delay.h ****    Also, the backward compatible
 218:/opt/local/avr/include/util/delay.h ****    algorithm will be chosen if the code is compiled in a <em>freestanding
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 9


 219:/opt/local/avr/include/util/delay.h ****    environment</em> (GCC option \c -ffreestanding), as the math functions
 220:/opt/local/avr/include/util/delay.h ****    required for rounding are not available to the compiler then.
 221:/opt/local/avr/include/util/delay.h **** 
 222:/opt/local/avr/include/util/delay.h ****  */
 223:/opt/local/avr/include/util/delay.h **** void
 224:/opt/local/avr/include/util/delay.h **** _delay_us(double __us)
 225:/opt/local/avr/include/util/delay.h **** {
 226:/opt/local/avr/include/util/delay.h **** 	double __tmp ; 
 227:/opt/local/avr/include/util/delay.h **** #if __HAS_DELAY_CYCLES && defined(__OPTIMIZE__) && \
 228:/opt/local/avr/include/util/delay.h ****   !defined(__DELAY_BACKWARD_COMPATIBLE__) &&	   \
 229:/opt/local/avr/include/util/delay.h ****   __STDC_HOSTED__
 230:/opt/local/avr/include/util/delay.h **** 	uint32_t __ticks_dc;
 231:/opt/local/avr/include/util/delay.h **** 	extern void __builtin_avr_delay_cycles(unsigned long);
 232:/opt/local/avr/include/util/delay.h **** 	__tmp = ((F_CPU) / 1e6) * __us;
 233:/opt/local/avr/include/util/delay.h **** 
 234:/opt/local/avr/include/util/delay.h **** 	#if defined(__DELAY_ROUND_DOWN__)
 235:/opt/local/avr/include/util/delay.h **** 		__ticks_dc = (uint32_t)fabs(__tmp);
 236:/opt/local/avr/include/util/delay.h **** 
 237:/opt/local/avr/include/util/delay.h **** 	#elif defined(__DELAY_ROUND_CLOSEST__)
 238:/opt/local/avr/include/util/delay.h **** 		__ticks_dc = (uint32_t)(fabs(__tmp)+0.5);
 239:/opt/local/avr/include/util/delay.h **** 
 240:/opt/local/avr/include/util/delay.h **** 	#else
 241:/opt/local/avr/include/util/delay.h **** 		//round up by default
 242:/opt/local/avr/include/util/delay.h **** 		__ticks_dc = (uint32_t)(ceil(fabs(__tmp)));
 243:/opt/local/avr/include/util/delay.h **** 	#endif
 244:/opt/local/avr/include/util/delay.h **** 
 245:/opt/local/avr/include/util/delay.h **** 	__builtin_avr_delay_cycles(__ticks_dc);
 168               		.stabn	68,0,245,.LM2-.LFBB1
 169               	.LM2:
 170 0006 8FE8      		ldi r24,lo8(399)
 171 0008 91E0      		ldi r25,hi8(399)
 172 000a 0197      		1: sbiw r24,1
 173 000c 01F4      		brne 1b
 174 000e 00C0      		rjmp .
 175 0010 0000      		nop
 176               	.L2:
 177               	.LBE145:
 178               	.LBE144:
 179               		.stabs	"pll.c",132,0,0,.Ltext3
 180               	.Ltext3:
  72:pll.c         ****    // 2: Wait 100us for the PLL to stabilize
  73:pll.c         ****    // (can't use dmsWait since the timer updating the dmsCount hasn't yet been started!)
  74:pll.c         ****    _delay_us(100);
  75:pll.c         **** //   dmsWait(1);
  76:pll.c         ****    // 3: Poll PLOCK until it is set...
  77:pll.c         ****    while(!getbit(PLOCK, PLLCSR))
 181               		.stabn	68,0,77,.LM3-.LFBB1
 182               	.LM3:
 183 0012 09B4      		in __tmp_reg__,0x29
 184 0014 00FC      		sbrc __tmp_reg__,0
 185 0016 00C0      		rjmp .L5
  78:pll.c         ****    {
  79:pll.c         ****       asm("nop");
 186               		.stabn	68,0,79,.LM4-.LFBB1
 187               	.LM4:
 188               	/* #APP */
 189               	 ;  79 "pll.c" 1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 10


 190 0018 0000      		nop
 191               	 ;  0 "" 2
 192               	/* #NOAPP */
 193 001a 00C0      		rjmp .L2
 194               	.L5:
  80:pll.c         ****    }
  81:pll.c         **** 
  82:pll.c         **** //The PWM161 doesn't have a PCKE bit.
  83:pll.c         **** #if(!defined(__AVR_AT90PWM161__))
  84:pll.c         ****    // 4: Set the PCKE bit to enable async mode
  85:pll.c         ****    setbit(PCKE, PLLCSR);
 195               		.stabn	68,0,85,.LM5-.LFBB1
 196               	.LM5:
 197 001c 89B5      		in r24,0x29
 198 001e 8460      		ori r24,lo8(4)
 199 0020 89BD      		out 0x29,r24
 200 0022 0895      		ret
 201               		.size	pll_enable, .-pll_enable
 202               	.Lscope1:
 203               		.stabs	"",36,0,0,.Lscope1-.LFBB1
 204               		.stabd	78,0,0
 205               		.stabs	"hitSensor_init:F(0,47)",36,0,47,hitSensor_init
 206               	.global	hitSensor_init
 207               		.type	hitSensor_init, @function
 208               	hitSensor_init:
 209               		.stabd	46,0,0
 210               		.stabs	"_hitSensors/bumpSwitch.c",132,0,0,.Ltext4
 211               	.Ltext4:
   1:_hitSensors/bumpSwitch.c **** /* mehPL:
   2:_hitSensors/bumpSwitch.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:_hitSensors/bumpSwitch.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:_hitSensors/bumpSwitch.c ****  *    Please see the bottom.
   5:_hitSensors/bumpSwitch.c ****  *    Enjoy!
   6:_hitSensors/bumpSwitch.c ****  */
   7:_hitSensors/bumpSwitch.c **** 
   8:_hitSensors/bumpSwitch.c **** 
   9:_hitSensors/bumpSwitch.c **** 
  10:_hitSensors/bumpSwitch.c **** 
  11:_hitSensors/bumpSwitch.c **** //a/o v82:
  12:_hitSensors/bumpSwitch.c **** 
  13:_hitSensors/bumpSwitch.c **** //The new idea for a bump-switch/hit-detector is simply a metal ball in a
  14:_hitSensors/bumpSwitch.c **** //cage of pins...
  15:_hitSensors/bumpSwitch.c **** 
  16:_hitSensors/bumpSwitch.c **** // In its resting-state the ball will make contact between two pins
  17:_hitSensors/bumpSwitch.c **** // when bumped sufficiently it will briefly break contact as the ball rolls
  18:_hitSensors/bumpSwitch.c **** // around to find a new resting-position between two contacts.
  19:_hitSensors/bumpSwitch.c **** 
  20:_hitSensors/bumpSwitch.c **** // This has some inherent difficulties:
  21:_hitSensors/bumpSwitch.c **** // *The metal ball may become corroded over time and lose conductiveness...
  22:_hitSensors/bumpSwitch.c **** // * (dirt?)
  23:_hitSensors/bumpSwitch.c **** // *There may be some physical orientations of the "sensor" that make no 
  24:_hitSensors/bumpSwitch.c **** //  contact or require a much harder hit than desired...
  25:_hitSensors/bumpSwitch.c **** // *BOUNCE!!!
  26:_hitSensors/bumpSwitch.c **** 
  27:_hitSensors/bumpSwitch.c **** // so far, this is only used with _interfaces/6bitParallel.c
  28:_hitSensors/bumpSwitch.c **** // Since it's placed on the RGB port, we need to make sure writeColor
  29:_hitSensors/bumpSwitch.c **** // doesn't interfere with the pull-up
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 11


  30:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_PORT_ON_RGB_PORT TRUE
  31:_hitSensors/bumpSwitch.c **** 
  32:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_PIN PA7
  33:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_PORT PORTA
  34:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_PCINT	PCINT7
  35:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_PCIE	PCIE1
  36:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_PCMSK	PCMSK0
  37:_hitSensors/bumpSwitch.c **** #define BUMP_SENSOR_NOTMY_PCMSK	PCMSK1
  38:_hitSensors/bumpSwitch.c **** 
  39:_hitSensors/bumpSwitch.c **** //TODO:
  40:_hitSensors/bumpSwitch.c **** // CHECK: Is interrupt being missed due to most time spent in
  41:_hitSensors/bumpSwitch.c **** // non-interruptable hsync interrupt?
  42:_hitSensors/bumpSwitch.c **** 
  43:_hitSensors/bumpSwitch.c **** 
  44:_hitSensors/bumpSwitch.c **** 
  45:_hitSensors/bumpSwitch.c **** #include "fb_question.h"
  46:_hitSensors/bumpSwitch.c **** 
  47:_hitSensors/bumpSwitch.c **** void hitSensor_init(void)
  48:_hitSensors/bumpSwitch.c **** {
 212               		.stabn	68,0,48,.LM6-.LFBB2
 213               	.LM6:
 214               	.LFBB2:
 215               	/* prologue: function */
 216               	/* frame size = 0 */
 217               	/* stack size = 0 */
 218               	.L__stack_usage = 0
 219               	.LBB146:
  49:_hitSensors/bumpSwitch.c **** 	
  50:_hitSensors/bumpSwitch.c **** 	//Enable the pin as an input, pulled-up
  51:_hitSensors/bumpSwitch.c **** 	setinpuPORT(BUMP_SENSOR_PIN, BUMP_SENSOR_PORT);
 220               		.stabn	68,0,51,.LM7-.LFBB2
 221               	.LM7:
 222 0024 D798      		cbi 0x1a,7
 223 0026 DF9A      		sbi 0x1b,7
 224               	.LBE146:
  52:_hitSensors/bumpSwitch.c **** 
  53:_hitSensors/bumpSwitch.c **** 	//The default PCMSK value is NON-ZERO!
  54:_hitSensors/bumpSwitch.c **** 	//Since the PCINT_vect is (so far) exclusively used for the bump-sensor
  55:_hitSensors/bumpSwitch.c **** 	// disable all the other PCINTs
  56:_hitSensors/bumpSwitch.c **** 	//Enable the corresponding Pin-Change pin...
  57:_hitSensors/bumpSwitch.c **** 	//setbit(BUMP_SENSOR_PCINT, BUMP_SENSOR_PCMSK);
  58:_hitSensors/bumpSwitch.c **** 	BUMP_SENSOR_PCMSK = (1<<BUMP_SENSOR_PCINT);
 225               		.stabn	68,0,58,.LM8-.LFBB2
 226               	.LM8:
 227 0028 80E8      		ldi r24,lo8(-128)
 228 002a 83BD      		out 0x23,r24
  59:_hitSensors/bumpSwitch.c **** 
  60:_hitSensors/bumpSwitch.c **** 	//The other PCMSK register also has defaults with certain pins enabled
  61:_hitSensors/bumpSwitch.c **** 	// and stupidly (?) the PCMSK# doesn't correspond to the PCIE#
  62:_hitSensors/bumpSwitch.c **** 	BUMP_SENSOR_NOTMY_PCMSK = 0;
 229               		.stabn	68,0,62,.LM9-.LFBB2
 230               	.LM9:
 231 002c 12BC      		out 0x22,__zero_reg__
  63:_hitSensors/bumpSwitch.c **** 
  64:_hitSensors/bumpSwitch.c **** 	//Clear the Pin-Change interrupt (probably not necessary)
  65:_hitSensors/bumpSwitch.c **** 	setbit(PCIF, GIFR);
 232               		.stabn	68,0,65,.LM10-.LFBB2
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 12


 233               	.LM10:
 234 002e 8AB7      		in r24,0x3a
 235 0030 8062      		ori r24,lo8(32)
 236 0032 8ABF      		out 0x3a,r24
  66:_hitSensors/bumpSwitch.c **** 
  67:_hitSensors/bumpSwitch.c **** 	//Enable the Pin-Change interrupt
  68:_hitSensors/bumpSwitch.c **** 	// (They are *all* disabled by default)
  69:_hitSensors/bumpSwitch.c **** 	setbit(BUMP_SENSOR_PCIE, GIMSK);
 237               		.stabn	68,0,69,.LM11-.LFBB2
 238               	.LM11:
 239 0034 8BB7      		in r24,0x3b
 240 0036 8062      		ori r24,lo8(32)
 241 0038 8BBF      		out 0x3b,r24
 242 003a 0895      		ret
 243               		.size	hitSensor_init, .-hitSensor_init
 244               	.Lscope2:
 245               		.stabs	"",36,0,0,.Lscope2-.LFBB2
 246               		.stabd	78,0,0
 247               		.stabs	"setColor:F(0,47)",36,0,79,setColor
 248               		.stabs	"red:P(4,2)",64,0,79,26
 249               		.stabs	"green:P(4,2)",64,0,79,19
 250               		.stabs	"blue:P(4,2)",64,0,79,20
 251               		.stabs	"row:P(4,2)",64,0,80,18
 252               		.stabs	"col:P(4,2)",64,0,80,16
 253               	.global	setColor
 254               		.type	setColor, @function
 255               	setColor:
 256               		.stabd	46,0,0
 257               		.stabs	"./_options/frameBuffer.c",132,0,0,.Ltext5
 258               	.Ltext5:
   1:./_options/frameBuffer.c **** /* mehPL:
   2:./_options/frameBuffer.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:./_options/frameBuffer.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:./_options/frameBuffer.c ****  *    Please see the bottom.
   5:./_options/frameBuffer.c ****  *    Enjoy!
   6:./_options/frameBuffer.c ****  */
   7:./_options/frameBuffer.c **** 
   8:./_options/frameBuffer.c **** 
   9:./_options/frameBuffer.c **** 
  10:./_options/frameBuffer.c **** 
  11:./_options/frameBuffer.c **** 
  12:./_options/frameBuffer.c **** // 30 < MAIN_MS < 300
  13:./_options/frameBuffer.c **** #if (MAIN_MS < 30)
  14:./_options/frameBuffer.c **** #error "WTF?"
  15:./_options/frameBuffer.c **** #endif
  16:./_options/frameBuffer.c **** 
  17:./_options/frameBuffer.c **** 
  18:./_options/frameBuffer.c **** 
  19:./_options/frameBuffer.c **** 
  20:./_options/frameBuffer.c **** //Please see writeColor.c
  21:./_options/frameBuffer.c **** 
  22:./_options/frameBuffer.c **** 
  23:./_options/frameBuffer.c **** #if(defined(FB_REFRESH_ON_CHANGE) && FB_REFRESH_ON_CHANGE)
  24:./_options/frameBuffer.c **** extern volatile uint8_t updateFrame;
  25:./_options/frameBuffer.c **** 
  26:./_options/frameBuffer.c **** void restartFrameUpdate(void);
  27:./_options/frameBuffer.c **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 13


  28:./_options/frameBuffer.c **** 
  29:./_options/frameBuffer.c **** //drawPix from program memory
  30:./_options/frameBuffer.c **** //a/0 v60: Again, unused for its original purpose, but tightly intertwined
  31:./_options/frameBuffer.c **** // in old code that's still being (mis)used...
  32:./_options/frameBuffer.c **** #ifndef FB_WIDTH
  33:./_options/frameBuffer.c ****  #define FB_WIDTH 16
  34:./_options/frameBuffer.c ****  #error "This error a/o v80, just noting that FB_WIDTH wasn't previously defined elsewhere..."
  35:./_options/frameBuffer.c **** #endif
  36:./_options/frameBuffer.c **** #ifndef FB_HEIGHT
  37:./_options/frameBuffer.c ****  #define FB_HEIGHT 16
  38:./_options/frameBuffer.c **** #endif
  39:./_options/frameBuffer.c **** 
  40:./_options/frameBuffer.c **** //FB_WIDTH+1 is a hack for displaying the last pixel equal-length...
  41:./_options/frameBuffer.c **** // see writeColor() notes in nonRSB_drawPix()
  42:./_options/frameBuffer.c **** uint8_t frameBuffer[FB_HEIGHT][FB_WIDTH+1];
  43:./_options/frameBuffer.c **** /*	This does NOT init just these elements, but ALL elements
  44:./_options/frameBuffer.c **** 	Which takes up a TON of program-space.
  45:./_options/frameBuffer.c **** 	Moved to frameBufferInit();
  46:./_options/frameBuffer.c **** 	= 
  47:./_options/frameBuffer.c **** { 
  48:./_options/frameBuffer.c **** 	[0 ... FB_HEIGHT-1][FB_WIDTH]=_W
  49:./_options/frameBuffer.c **** };
  50:./_options/frameBuffer.c **** */
  51:./_options/frameBuffer.c **** /*
  52:./_options/frameBuffer.c **** { 
  53:./_options/frameBuffer.c **** 	[0][FB_WIDTH]=_W,
  54:./_options/frameBuffer.c **** 	[1][FB_WIDTH]=_W,
  55:./_options/frameBuffer.c **** 	[2][FB_WIDTH]=_W,
  56:./_options/frameBuffer.c **** 	[3][FB_WIDTH]=_W,
  57:./_options/frameBuffer.c **** 	[4][FB_WIDTH]=_W,
  58:./_options/frameBuffer.c **** 	[5][FB_WIDTH]=_W,
  59:./_options/frameBuffer.c **** 	[6][FB_WIDTH]=_W,
  60:./_options/frameBuffer.c **** 	[7][FB_WIDTH]=_W,
  61:./_options/frameBuffer.c **** 	[8][FB_WIDTH]=_W,
  62:./_options/frameBuffer.c **** 	[9][FB_WIDTH]=_W,
  63:./_options/frameBuffer.c **** 	[10][FB_WIDTH]=_W,
  64:./_options/frameBuffer.c **** 	[11][FB_WIDTH]=_W,
  65:./_options/frameBuffer.c **** 	[12][FB_WIDTH]=_W,
  66:./_options/frameBuffer.c **** 	[13][FB_WIDTH]=_W,
  67:./_options/frameBuffer.c **** 	[14][FB_WIDTH]=_W,
  68:./_options/frameBuffer.c **** 	[15][FB_WIDTH]=_W
  69:./_options/frameBuffer.c **** }
  70:./_options/frameBuffer.c **** */
  71:./_options/frameBuffer.c **** 
  72:./_options/frameBuffer.c **** 
  73:./_options/frameBuffer.c **** //AHHH it wasn't IMAGE_BUFFER that's entangled, but IMAGE_CHANGE
  74:./_options/frameBuffer.c **** // which is even weirder.
  75:./_options/frameBuffer.c **** 
  76:./_options/frameBuffer.c **** //This was #if'd into existence with IMAGE_BUFFER, but since it's only been
  77:./_options/frameBuffer.c **** // used with frameBuffer, and since IMAGE_BUFFER is somewhat entangled with
  78:./_options/frameBuffer.c **** // newer stuff, I'm putting it here and NOT including this file, (yet)
  79:./_options/frameBuffer.c **** void setColor(uint8_t red, uint8_t green, uint8_t blue, 
  80:./_options/frameBuffer.c ****                uint8_t row, uint8_t col)
  81:./_options/frameBuffer.c **** {
 259               		.stabn	68,0,81,.LM12-.LFBB3
 260               	.LM12:
 261               	.LFBB3:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 14


 262 003c 0F93      		push r16
 263               	/* prologue: function */
 264               	/* frame size = 0 */
 265               	/* stack size = 1 */
 266               	.L__stack_usage = 1
 267 003e A82F      		mov r26,r24
 268 0040 362F      		mov r19,r22
  82:./_options/frameBuffer.c ****    red = (red > 3) ? 3 : red;
  83:./_options/frameBuffer.c ****    green = (green > 3) ? 3 : green;
  84:./_options/frameBuffer.c ****    blue = (blue > 3) ? 3 : blue;
  85:./_options/frameBuffer.c **** 
  86:./_options/frameBuffer.c ****    frameBuffer[row][col] = red | ((green)<<2) | ((blue)<<4);
 269               		.stabn	68,0,86,.LM13-.LFBB3
 270               	.LM13:
 271 0042 822F      		mov r24,r18
 272 0044 90E0      		ldi r25,0
 273 0046 61E1      		ldi r22,lo8(17)
 274 0048 70E0      		ldi r23,0
 275 004a 00D0      		rcall __mulhi3
 276 004c FC01      		movw r30,r24
 277 004e E00F      		add r30,r16
 278 0050 F11D      		adc r31,__zero_reg__
 279 0052 E050      		subi r30,lo8(-(frameBuffer))
 280 0054 F040      		sbci r31,hi8(-(frameBuffer))
  84:./_options/frameBuffer.c **** 
 281               		.stabn	68,0,84,.LM14-.LFBB3
 282               	.LM14:
 283 0056 4430      		cpi r20,lo8(4)
 284 0058 00F0      		brlo .L8
 285 005a 43E0      		ldi r20,lo8(3)
 286               	.L8:
 287               		.stabn	68,0,86,.LM15-.LFBB3
 288               	.LM15:
 289 005c 50E0      		ldi r21,0
 290 005e 84E0      		ldi r24,4
 291               		1:
 292 0060 440F      		lsl r20
 293 0062 551F      		rol r21
 294 0064 8A95      		dec r24
 295 0066 01F4      		brne 1b
  82:./_options/frameBuffer.c ****    red = (red > 3) ? 3 : red;
 296               		.stabn	68,0,82,.LM16-.LFBB3
 297               	.LM16:
 298 0068 8A2F      		mov r24,r26
 299 006a A430      		cpi r26,lo8(4)
 300 006c 00F0      		brlo .L9
 301 006e 83E0      		ldi r24,lo8(3)
 302               	.L9:
 303               		.stabn	68,0,86,.LM17-.LFBB3
 304               	.LM17:
 305 0070 482B      		or r20,r24
  83:./_options/frameBuffer.c ****    blue = (blue > 3) ? 3 : blue;
 306               		.stabn	68,0,83,.LM18-.LFBB3
 307               	.LM18:
 308 0072 632F      		mov r22,r19
 309 0074 3430      		cpi r19,lo8(4)
 310 0076 00F0      		brlo .L10
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 15


 311 0078 63E0      		ldi r22,lo8(3)
 312               	.L10:
 313               		.stabn	68,0,86,.LM19-.LFBB3
 314               	.LM19:
 315 007a 660F      		lsl r22
 316 007c 660F      		lsl r22
 317 007e 642B      		or r22,r20
 318 0080 6083      		st Z,r22
 319               	/* epilogue start */
  87:./_options/frameBuffer.c **** }
 320               		.stabn	68,0,87,.LM20-.LFBB3
 321               	.LM20:
 322 0082 0F91      		pop r16
 323 0084 0895      		ret
 324               		.size	setColor, .-setColor
 325               	.Lscope3:
 326               		.stabs	"",36,0,0,.Lscope3-.LFBB3
 327               		.stabd	78,0,0
 328               		.stabs	"frameBufferInit:F(0,47)",36,0,110,frameBufferInit
 329               	.global	frameBufferInit
 330               		.type	frameBufferInit, @function
 331               	frameBufferInit:
 332               		.stabd	46,0,0
  88:./_options/frameBuffer.c **** 
  89:./_options/frameBuffer.c **** 
  90:./_options/frameBuffer.c **** 
  91:./_options/frameBuffer.c **** 
  92:./_options/frameBuffer.c **** //Called as: pgm_readImageByte(pgm_image1, row, col)
  93:./_options/frameBuffer.c **** #define pgm_readImageByte(image, row, col)   \
  94:./_options/frameBuffer.c ****       pgm_read_byte((uint8_t *)(&((image)[(row)*FB_WIDTH+(col)])))
  95:./_options/frameBuffer.c **** 
  96:./_options/frameBuffer.c **** 
  97:./_options/frameBuffer.c **** //a/o v86: I can't recall why I chose white to display at the end of the
  98:./_options/frameBuffer.c **** //row... it may have had to do with the lvds displays and the timing stuff,
  99:./_options/frameBuffer.c **** //so I could actually see where the DE data was ending...(?)
 100:./_options/frameBuffer.c **** // Either way, I'd prefer it to be black in this particular instance, so
 101:./_options/frameBuffer.c **** // FB_END_OF_ROW_COLOR is now predefinable...
 102:./_options/frameBuffer.c **** #ifndef FB_END_OF_ROW_COLOR
 103:./_options/frameBuffer.c **** #define FB_END_OF_ROW_COLOR	_W
 104:./_options/frameBuffer.c **** #endif
 105:./_options/frameBuffer.c **** 
 106:./_options/frameBuffer.c **** // This stuff was located in main() before the while loop...
 107:./_options/frameBuffer.c **** // #if !COLOR_BAR_SCROLL... (which is *nearly every case* including 
 108:./_options/frameBuffer.c **** //  RowSegBuffer, etc)
 109:./_options/frameBuffer.c **** // it's long-since been commented-out...
 110:./_options/frameBuffer.c **** void frameBufferInit(void)
 111:./_options/frameBuffer.c **** {
 333               		.stabn	68,0,111,.LM21-.LFBB4
 334               	.LM21:
 335               	.LFBB4:
 336               	/* prologue: function */
 337               	/* frame size = 0 */
 338               	/* stack size = 0 */
 339               	.L__stack_usage = 0
 340 0086 E0E0      		ldi r30,lo8(frameBuffer+16)
 341 0088 F0E0      		ldi r31,hi8(frameBuffer+16)
 342               	.L13:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 16


 112:./_options/frameBuffer.c **** 	//_W in FB_WIDTH is a hack for equal-length pixels, see frameBuffer's
 113:./_options/frameBuffer.c **** 	//definition, above.
 114:./_options/frameBuffer.c **** 	uint8_t i;
 115:./_options/frameBuffer.c **** 	for(i=0; i<FB_HEIGHT; i++)
 116:./_options/frameBuffer.c **** 		frameBuffer[i][FB_WIDTH] = FB_END_OF_ROW_COLOR;
 343               		.stabn	68,0,116,.LM22-.LFBB4
 344               	.LM22:
 345 008a 1082      		st Z,__zero_reg__
 346 008c 7196      		adiw r30,17
 115:./_options/frameBuffer.c **** 		frameBuffer[i][FB_WIDTH] = FB_END_OF_ROW_COLOR;
 347               		.stabn	68,0,115,.LM23-.LFBB4
 348               	.LM23:
 349 008e 80E0      		ldi r24,hi8(frameBuffer+288)
 350 0090 E030      		cpi r30,lo8(frameBuffer+288)
 351 0092 F807      		cpc r31,r24
 352 0094 01F4      		brne .L13
 353               	/* epilogue start */
 117:./_options/frameBuffer.c **** 
 118:./_options/frameBuffer.c **** 
 119:./_options/frameBuffer.c **** 
 120:./_options/frameBuffer.c **** 	 //uint8_t frameBuffer[16][16];
 121:./_options/frameBuffer.c **** /*   for(r=0; r<FB_HEIGHT; r++)
 122:./_options/frameBuffer.c ****    {
 123:./_options/frameBuffer.c ****       for(c=0; c<FB_WIDTH; c++)
 124:./_options/frameBuffer.c ****       {
 125:./_options/frameBuffer.c ****          uint8_t imagePixel=pgm_readImageByte(pgm_image1, r, c);
 126:./_options/frameBuffer.c **** 
 127:./_options/frameBuffer.c ****          setColor(
 128:./_options/frameBuffer.c ****             (getbit(RED_IMAGEVAL_BIT, imagePixel) ? 0x03 : 0),
 129:./_options/frameBuffer.c ****             (getbit(GREEN_IMAGEVAL_BIT, imagePixel) ? 0x0C : 0),
 130:./_options/frameBuffer.c ****             (getbit(BLUE_IMAGEVAL_BIT, imagePixel) ? 0x30 : 0),
 131:./_options/frameBuffer.c ****             r, c);
 132:./_options/frameBuffer.c **** //         setBlue(
 133:./_options/frameBuffer.c **** //               (
 134:./_options/frameBuffer.c **** //   (getbit(BLUE_IMAGEVAL_BIT, imagePixel) ? (60<<2) : 0) |
 135:./_options/frameBuffer.c **** //   (getbit(GREEN_IMAGEVAL_BIT, imagePixel) ? (1<<GREEN_BLUEVAL_BIT) : 0) |
 136:./_options/frameBuffer.c **** //   (getbit(RED_IMAGEVAL_BIT, imagePixel) ? (1<<RED_BLUEVAL_BIT) : 0)
 137:./_options/frameBuffer.c **** //               ), r, c);
 138:./_options/frameBuffer.c ****       }
 139:./_options/frameBuffer.c ****    }
 140:./_options/frameBuffer.c **** */
 141:./_options/frameBuffer.c **** 
 142:./_options/frameBuffer.c **** }
 354               		.stabn	68,0,142,.LM24-.LFBB4
 355               	.LM24:
 356 0096 0895      		ret
 357               		.size	frameBufferInit, .-frameBufferInit
 358               	.Lscope4:
 359               		.stabs	"",36,0,0,.Lscope4-.LFBB4
 360               		.stabd	78,0,0
 361               		.stabs	"setSpriteSkyColorOverride:F(0,47)",36,0,117,setSpriteSkyColorOverride
 362               		.stabs	"sprite:P(16,3)",64,0,117,24
 363               	.global	setSpriteSkyColorOverride
 364               		.type	setSpriteSkyColorOverride, @function
 365               	setSpriteSkyColorOverride:
 366               		.stabd	46,0,0
 367               		.stabs	"icons/iconPacking.h",132,0,0,.Ltext6
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 17


 368               	.Ltext6:
   1:icons/iconPacking.h **** /* mehPL:
   2:icons/iconPacking.h ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:icons/iconPacking.h ****  *    I'm not too fond of long licenses at the top of the file.
   4:icons/iconPacking.h ****  *    Please see the bottom.
   5:icons/iconPacking.h ****  *    Enjoy!
   6:icons/iconPacking.h ****  */
   7:icons/iconPacking.h **** 
   8:icons/iconPacking.h **** 
   9:icons/iconPacking.h **** 
  10:icons/iconPacking.h **** 
  11:icons/iconPacking.h **** 
  12:icons/iconPacking.h **** 
  13:icons/iconPacking.h **** 
  14:icons/iconPacking.h **** 
  15:icons/iconPacking.h **** 
  16:icons/iconPacking.h **** // This file contains tools for packing an icon/sprite into the least
  17:icons/iconPacking.h **** // memory possible, while allowing the image-data itself to be somewhat
  18:icons/iconPacking.h **** // viewable in the sprites' header files.
  19:icons/iconPacking.h **** // Each sprite contains four color-indices (two bits per pixel)
  20:icons/iconPacking.h **** // These four color-indices are converted into actual displayable colors
  21:icons/iconPacking.h **** // via the sprite's color palette(s).
  22:icons/iconPacking.h **** // a/o v66: * The sprite's mask is completely unused, as I recall.
  23:icons/iconPacking.h **** //          * The color-indices were arbitrary until recently
  24:icons/iconPacking.h **** //            Now some attempt has been made to use certain indices for
  25:icons/iconPacking.h **** //            certain purposes (e.g. index=0 -> Sky)
  26:icons/iconPacking.h **** 
  27:icons/iconPacking.h **** #ifndef __ICONPACKING_H__
  28:icons/iconPacking.h **** #define __ICONPACKING_H__
  29:icons/iconPacking.h **** 
  30:icons/iconPacking.h **** #include "gPixelVal.h"
  31:icons/iconPacking.h **** //#include "spriteMotion.h" //Needed for motion_t, etc...
  32:icons/iconPacking.h **** 									// Also see below...
  33:icons/iconPacking.h **** 
  34:icons/iconPacking.h **** 
  35:icons/iconPacking.h **** 
  36:icons/iconPacking.h **** typedef struct _BLAH_MOTION_
  37:icons/iconPacking.h **** {
  38:icons/iconPacking.h **** 	const uint8_t startPosition;
  39:icons/iconPacking.h **** 	const uint8_t *motion;
  40:icons/iconPacking.h **** } motion_t;
  41:icons/iconPacking.h **** 
  42:icons/iconPacking.h **** 
  43:icons/iconPacking.h **** 
  44:icons/iconPacking.h **** #define rgb2(r,g,b) \
  45:icons/iconPacking.h **** 	      (r | (g<<2) | (b<<4))
  46:icons/iconPacking.h **** 
  47:icons/iconPacking.h **** 
  48:icons/iconPacking.h **** //Actually, this probably won't work right...
  49:icons/iconPacking.h **** // because the rgb values aren't exact like that, right?
  50:icons/iconPacking.h **** // e.g. black = 0,0,0 but it shows as 0,0,60 ish...
  51:icons/iconPacking.h **** // then again, going in reverse like this might work fine...
  52:icons/iconPacking.h **** // due to rounding (seems OK with this color-scheme)
  53:icons/iconPacking.h **** // The idea wasn't so much to be able to input an 8-bit RGB value to get
  54:icons/iconPacking.h **** // a close match (would probably want rounding up for that, not that it'd
  55:icons/iconPacking.h **** // be even close)
  56:icons/iconPacking.h **** // but to be able to read color-values from GIMP when using the 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 18


  57:icons/iconPacking.h **** //  LCDdirectLVDS color-palette... which isn't especially necessary since
  58:icons/iconPacking.h **** //  now the colors are named with 3-based colors.
  59:icons/iconPacking.h **** // (Except that it's somewhat difficult to determine which color is used
  60:icons/iconPacking.h **** //  when indexed... it kinda has to be chosen manually... in Gimp)
  61:icons/iconPacking.h **** // E.G. rgb8(141,157,255) is the sky-color, but not right AT ALL.
  62:icons/iconPacking.h **** //      (comes through as dark green?!)
  63:icons/iconPacking.h **** #define rgb8(r,g,b) \
  64:icons/iconPacking.h **** 	      rgb((((r)*3)/255), (((g)*3)/255), (((b)*3)/255))
  65:icons/iconPacking.h **** 
  66:icons/iconPacking.h **** 
  67:icons/iconPacking.h **** 
  68:icons/iconPacking.h **** 
  69:icons/iconPacking.h **** #define ICON_WIDTH	16
  70:icons/iconPacking.h **** #define ICON_HEIGHT	16
  71:icons/iconPacking.h **** #define ICON_PIXELS	((ICON_WIDTH)*(ICON_HEIGHT))
  72:icons/iconPacking.h **** 
  73:icons/iconPacking.h **** #define ICON_PACKED_BYTES	((ICON_PIXELS)/4)
  74:icons/iconPacking.h **** #define ICON_MASK_BYTES		((ICON_PIXELS)/8)
  75:icons/iconPacking.h **** 
  76:icons/iconPacking.h **** #define PACKED_BYTES_PER_ROW	(ICON_WIDTH/4)
  77:icons/iconPacking.h **** 
  78:icons/iconPacking.h **** #define PIXELS_PER_PACKAGE	4
  79:icons/iconPacking.h **** 
  80:icons/iconPacking.h **** #define PACKED_BITS_PER_PIXEL	(8/PIXELS_PER_PACKAGE)
  81:icons/iconPacking.h **** 
  82:icons/iconPacking.h **** typedef struct _BLAH_SPRITE_
  83:icons/iconPacking.h **** {
  84:icons/iconPacking.h **** 	//const uint8_t * p_image[ICON_PACKED_BYTES];
  85:icons/iconPacking.h **** 	const uint8_t (*p_image)[ICON_PACKED_BYTES];
  86:icons/iconPacking.h **** 	const uint8_t * p_mask;
  87:icons/iconPacking.h **** 	const uint8_t * p_palette;
  88:icons/iconPacking.h **** 	const uint8_t numPalettes;
  89:icons/iconPacking.h **** 	const uint8_t totalCount;	//Number of qCounts and/or steps per cycle
  90:icons/iconPacking.h **** 	const uint8_t * p_hFlip;
  91:icons/iconPacking.h **** 	const __flash motion_t * p_motion;
  92:icons/iconPacking.h **** 	const uint8_t * p_layer;
  93:icons/iconPacking.h **** 	const __flash motion_t * p_camMotion;
  94:icons/iconPacking.h **** 	const uint8_t * p_paletteAdvance;
  95:icons/iconPacking.h **** 	const uint8_t numImages;
  96:icons/iconPacking.h **** }	sprite_t;
  97:icons/iconPacking.h **** 
  98:icons/iconPacking.h **** /*
  99:icons/iconPacking.h **** #define getGimpColorVal(sprite, row, col) \
 100:icons/iconPacking.h **** 		(((pgm_read_byte((uint8_t *)(&((sprite).p_image[ \
 101:icons/iconPacking.h **** 					(row)*PACKED_BYTES_PER_ROW + (col)/PIXELS_PER_PACKAGE])))\
 102:icons/iconPacking.h **** 		  )>>((col)%PIXELS_PER_PACKAGE)*(PACKED_BITS_PER_PIXEL))&0x03)
 103:icons/iconPacking.h **** */
 104:icons/iconPacking.h **** 
 105:icons/iconPacking.h **** /*
 106:icons/iconPacking.h **** #define getGimpColorVal(sprite, palette, row, col) \
 107:icons/iconPacking.h **** 	pgm_read_byte((uint8_t *)(&((sprite).p_palette[ (palette)*4 + \
 108:icons/iconPacking.h **** 		(((pgm_read_byte((uint8_t *)(&((sprite).p_image[ \
 109:icons/iconPacking.h **** 					(row)*PACKED_BYTES_PER_ROW + (col)/PIXELS_PER_PACKAGE])))\
 110:icons/iconPacking.h **** 		  )>>((col)%PIXELS_PER_PACKAGE)*(PACKED_BITS_PER_PIXEL))&0x03) ])))
 111:icons/iconPacking.h **** */
 112:icons/iconPacking.h **** 
 113:icons/iconPacking.h **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 19


 114:icons/iconPacking.h **** const __flash sprite_t *skyOverrideSprite = NULL;
 115:icons/iconPacking.h **** //uint8_t skyOverridePalette;
 116:icons/iconPacking.h **** 
 117:icons/iconPacking.h **** void setSpriteSkyColorOverride(const __flash sprite_t *sprite) //, uint8_t palette)
 118:icons/iconPacking.h **** {
 369               		.stabn	68,0,118,.LM25-.LFBB5
 370               	.LM25:
 371               	.LFBB5:
 372               	/* prologue: function */
 373               	/* frame size = 0 */
 374               	/* stack size = 0 */
 375               	.L__stack_usage = 0
 119:icons/iconPacking.h **** 	skyOverrideSprite = sprite;
 376               		.stabn	68,0,119,.LM26-.LFBB5
 377               	.LM26:
 378 0098 9093 0000 		sts skyOverrideSprite+1,r25
 379 009c 8093 0000 		sts skyOverrideSprite,r24
 380 00a0 0895      		ret
 381               		.size	setSpriteSkyColorOverride, .-setSpriteSkyColorOverride
 382               	.Lscope5:
 383               		.stabs	"",36,0,0,.Lscope5-.LFBB5
 384               		.stabd	78,0,0
 385               		.stabs	"getRawPixelVal:F(4,2)",36,0,124,getRawPixelVal
 386               		.stabs	"sprite:P(16,3)",64,0,124,24
 387               		.stabs	"row:P(4,2)",64,0,124,22
 388               		.stabs	"col:P(4,2)",64,0,125,20
 389               		.stabs	"imageNum:P(4,2)",64,0,125,18
 390               	.global	getRawPixelVal
 391               		.type	getRawPixelVal, @function
 392               	getRawPixelVal:
 393               		.stabd	46,0,0
 120:icons/iconPacking.h **** //	skyOverridePalette = palette;
 121:icons/iconPacking.h **** }
 122:icons/iconPacking.h **** 
 123:icons/iconPacking.h **** 
 124:icons/iconPacking.h **** uint8_t getRawPixelVal(const __flash sprite_t *sprite, uint8_t row, 
 125:icons/iconPacking.h **** 														uint8_t col, uint8_t imageNum)
 126:icons/iconPacking.h **** {
 394               		.stabn	68,0,126,.LM27-.LFBB6
 395               	.LM27:
 396               	.LFBB6:
 397               	/* prologue: function */
 398               	/* frame size = 0 */
 399               	/* stack size = 0 */
 400               	.L__stack_usage = 0
 401               	.LBB147:
 127:icons/iconPacking.h **** 
 128:icons/iconPacking.h **** 	return
 129:icons/iconPacking.h **** 		(((pgm_read_byte((uint8_t *)(&(sprite->p_image[imageNum][ \
 402               		.stabn	68,0,129,.LM28-.LFBB6
 403               	.LM28:
 404 00a2 30E0      		ldi r19,0
 405 00a4 56E0      		ldi r21,6
 406               		1:
 407 00a6 220F      		lsl r18
 408 00a8 331F      		rol r19
 409 00aa 5A95      		dec r21
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 20


 410 00ac 01F4      		brne 1b
 411 00ae FC01      		movw r30,r24
 412 00b0 A591      		lpm r26,Z+
 413 00b2 B591      		lpm r27,Z+
 414 00b4 A20F      		add r26,r18
 415 00b6 B31F      		adc r27,r19
 416 00b8 70E0      		ldi r23,0
 417 00ba 660F      		lsl r22
 418 00bc 771F      		rol r23
 419 00be 660F      		lsl r22
 420 00c0 771F      		rol r23
 421 00c2 842F      		mov r24,r20
 422 00c4 8695      		lsr r24
 423 00c6 8695      		lsr r24
 424 00c8 680F      		add r22,r24
 425 00ca 711D      		adc r23,__zero_reg__
 426 00cc A60F      		add r26,r22
 427 00ce B71F      		adc r27,r23
 428 00d0 FD01      		movw r30,r26
 429               	/* #APP */
 430               	 ;  129 "icons/iconPacking.h" 1
 431 00d2 8491      		lpm r24, Z
 432               		
 433               	 ;  0 "" 2
 434               	/* #NOAPP */
 435               	.LBE147:
 130:icons/iconPacking.h **** 					(row)*PACKED_BYTES_PER_ROW + (col)/PIXELS_PER_PACKAGE])))\
 131:icons/iconPacking.h **** 		  )>>((col)%PIXELS_PER_PACKAGE)*(PACKED_BITS_PER_PIXEL))&0x03);
 436               		.stabn	68,0,131,.LM29-.LFBB6
 437               	.LM29:
 438 00d4 90E0      		ldi r25,0
 439 00d6 4370      		andi r20,lo8(3)
 440 00d8 440F      		lsl r20
 441 00da 00C0      		rjmp 2f
 442               		1:
 443 00dc 9595      		asr r25
 444 00de 8795      		ror r24
 445               		2:
 446 00e0 4A95      		dec r20
 447 00e2 02F4      		brpl 1b
 132:icons/iconPacking.h **** }
 448               		.stabn	68,0,132,.LM30-.LFBB6
 449               	.LM30:
 450 00e4 8370      		andi r24,lo8(3)
 451 00e6 0895      		ret
 452               		.size	getRawPixelVal, .-getRawPixelVal
 453               	.Lscope6:
 454               		.stabs	"",36,0,0,.Lscope6-.LFBB6
 455               		.stabd	78,0,0
 456               		.stabs	"rawPixValToGimpColorVal:F(4,2)",36,0,135,rawPixValToGimpColorVal
 457               		.stabs	"rawPixelVal:P(4,2)",64,0,135,24
 458               		.stabs	"sprite:P(16,3)",64,0,135,22
 459               		.stabs	"palette:P(4,2)",64,0,136,20
 460               	.global	rawPixValToGimpColorVal
 461               		.type	rawPixValToGimpColorVal, @function
 462               	rawPixValToGimpColorVal:
 463               		.stabd	46,0,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 21


 133:icons/iconPacking.h **** 
 134:icons/iconPacking.h **** 
 135:icons/iconPacking.h **** uint8_t rawPixValToGimpColorVal(uint8_t rawPixelVal, const __flash sprite_t *sprite, 
 136:icons/iconPacking.h **** 																			uint8_t palette)
 137:icons/iconPacking.h **** {
 464               		.stabn	68,0,137,.LM31-.LFBB7
 465               	.LM31:
 466               	.LFBB7:
 467               	/* prologue: function */
 468               	/* frame size = 0 */
 469               	/* stack size = 0 */
 470               	.L__stack_usage = 0
 471               	.LBB148:
 138:icons/iconPacking.h **** 	return 
 139:icons/iconPacking.h **** 	pgm_read_byte(
 472               		.stabn	68,0,139,.LM32-.LFBB7
 473               	.LM32:
 474 00e8 6C5F      		subi r22,-4
 475 00ea 7F4F      		sbci r23,-1
 476 00ec 50E0      		ldi r21,0
 477 00ee 440F      		lsl r20
 478 00f0 551F      		rol r21
 479 00f2 440F      		lsl r20
 480 00f4 551F      		rol r21
 481 00f6 480F      		add r20,r24
 482 00f8 511D      		adc r21,__zero_reg__
 483 00fa FB01      		movw r30,r22
 484 00fc 8591      		lpm r24,Z+
 485 00fe 9591      		lpm r25,Z+
 486 0100 840F      		add r24,r20
 487 0102 951F      		adc r25,r21
 488 0104 FC01      		movw r30,r24
 489               	/* #APP */
 490               	 ;  139 "icons/iconPacking.h" 1
 491 0106 8491      		lpm r24, Z
 492               		
 493               	 ;  0 "" 2
 494               	/* #NOAPP */
 495               	.LBE148:
 140:icons/iconPacking.h **** 			(uint8_t *)(&(sprite->p_palette[ (palette)*4 + rawPixelVal ])));
 141:icons/iconPacking.h **** }
 496               		.stabn	68,0,141,.LM33-.LFBB7
 497               	.LM33:
 498 0108 0895      		ret
 499               		.size	rawPixValToGimpColorVal, .-rawPixValToGimpColorVal
 500               	.Lscope7:
 501               		.stabs	"",36,0,0,.Lscope7-.LFBB7
 502               		.stabd	78,0,0
 503               		.stabs	"fbQ_repositionSprite:F(0,47)",36,0,28,fbQ_repositionSprite
 504               		.stabs	"state:P(0,48)=*(16,5)",64,0,28,26
 505               	.global	fbQ_repositionSprite
 506               		.type	fbQ_repositionSprite, @function
 507               	fbQ_repositionSprite:
 508               		.stabd	46,0,0
 509               		.stabs	"icons/spriteMotion.c",132,0,0,.Ltext7
 510               	.Ltext7:
   1:icons/spriteMotion.c **** /* mehPL:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 22


   2:icons/spriteMotion.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:icons/spriteMotion.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:icons/spriteMotion.c ****  *    Please see the bottom.
   5:icons/spriteMotion.c ****  *    Enjoy!
   6:icons/spriteMotion.c ****  */
   7:icons/spriteMotion.c **** 
   8:icons/spriteMotion.c **** 
   9:icons/spriteMotion.c **** 
  10:icons/spriteMotion.c **** 
  11:icons/spriteMotion.c **** #ifndef __SPRITE_MOTION_C__
  12:icons/spriteMotion.c **** #define __SPRITE_MOTION_C__
  13:icons/spriteMotion.c **** 
  14:icons/spriteMotion.c **** //#include "../fb_question.h"
  15:icons/spriteMotion.c **** #include "spriteMotion.h"
  16:icons/spriteMotion.c **** 
  17:icons/spriteMotion.c **** #include "FlowerPowerV.h"	//Needed for flower-specific handling
  18:icons/spriteMotion.c **** 
  19:icons/spriteMotion.c **** 
  20:icons/spriteMotion.c **** //This is in ../fb_question.c
  21:icons/spriteMotion.c **** //It should probably be moved.
  22:icons/spriteMotion.c **** uint8_t getSpritePalette(const __flash sprite_t *p_thisSprite, uint8_t spritePhase,
  23:icons/spriteMotion.c **** 		                                                 uint8_t spriteRow);
  24:icons/spriteMotion.c **** 
  25:icons/spriteMotion.c **** 
  26:icons/spriteMotion.c **** //This can also be used for repositioning the camera...
  27:icons/spriteMotion.c **** //THIS ASSUMES it's only called ONCE per count...
  28:icons/spriteMotion.c **** void fbQ_repositionSprite(spriteState_t *state)
  29:icons/spriteMotion.c **** {
 511               		.stabn	68,0,29,.LM34-.LFBB8
 512               	.LM34:
 513               	.LFBB8:
 514 010a EF92      		push r14
 515 010c FF92      		push r15
 516 010e 0F93      		push r16
 517 0110 1F93      		push r17
 518 0112 CF93      		push r28
 519 0114 DF93      		push r29
 520               	/* prologue: function */
 521               	/* frame size = 0 */
 522               	/* stack size = 6 */
 523               	.L__stack_usage = 6
 524 0116 DC01      		movw r26,r24
 525               	.LBB149:
  30:icons/spriteMotion.c ****    uint8_t axis;
  31:icons/spriteMotion.c **** 
  32:icons/spriteMotion.c ****    for(axis=0; axis<=1; axis++)
  33:icons/spriteMotion.c ****    {
  34:icons/spriteMotion.c ****   
  35:icons/spriteMotion.c **** 	  /* Now handled in initSpriteStates (in fb_question.c)	
  36:icons/spriteMotion.c ****    if(state->count == 0)
  37:icons/spriteMotion.c ****    {
  38:icons/spriteMotion.c ****       //Need to have a starting-point...
  39:icons/spriteMotion.c ****       // Note that origin is lower-left, but nextSpritePosition is
  40:icons/spriteMotion.c ****       // upper-left... (change that, instead?)
  41:icons/spriteMotion.c ****       int8_t startPos = state->motion[axis].startPosition;
  42:icons/spriteMotion.c ****       
  43:icons/spriteMotion.c ****       if(axis == 0)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 23


  44:icons/spriteMotion.c ****          startPos *= -1;
  45:icons/spriteMotion.c **** 
  46:icons/spriteMotion.c ****       state->position[axis] = startPos;
  47:icons/spriteMotion.c ****       state->dir[axis] = 1;
  48:icons/spriteMotion.c ****    }
  49:icons/spriteMotion.c **** 	*/
  50:icons/spriteMotion.c **** 
  51:icons/spriteMotion.c ****    int8_t motion = GET_MOTION(state->motion[axis].motion, state->count);
 526               		.stabn	68,0,51,.LM35-.LFBB8
 527               	.LM35:
 528 0118 1996      		adiw r26,9
 529 011a 0D91      		ld r16,X+
 530 011c 1C91      		ld r17,X
 531 011e 1A97      		sbiw r26,9+1
 532 0120 EC01      		movw r28,r24
 533 0122 20E0      		ldi r18,0
 534 0124 30E0      		ldi r19,0
 535               	.L21:
 536 0126 C901      		movw r24,r18
 537 0128 63E0      		ldi r22,lo8(3)
 538 012a 70E0      		ldi r23,0
 539 012c 00D0      		rcall __mulhi3
 540 012e 800F      		add r24,r16
 541 0130 911F      		adc r25,r17
 542 0132 0196      		adiw r24,1
 543 0134 FC01      		movw r30,r24
 544 0136 E590      		lpm r14,Z+
 545 0138 F590      		lpm r15,Z+
 546 013a AD01      		movw r20,r26
 547 013c 420F      		add r20,r18
 548 013e 531F      		adc r21,r19
 549 0140 E114      		cp r14,__zero_reg__
 550 0142 F104      		cpc r15,__zero_reg__
 551 0144 01F0      		breq .L23
 552               	.LBB150:
 553               		.stabn	68,0,51,.LM36-.LFBB8
 554               	.LM36:
 555 0146 1496      		adiw r26,4
 556 0148 6C91      		ld r22,X
 557 014a 1497      		sbiw r26,4
 558 014c 862F      		mov r24,r22
 559 014e 8695      		lsr r24
 560 0150 8695      		lsr r24
 561 0152 F701      		movw r30,r14
 562 0154 E80F      		add r30,r24
 563 0156 F11D      		adc r31,__zero_reg__
 564               	/* #APP */
 565               	 ;  51 "icons/spriteMotion.c" 1
 566 0158 E491      		lpm r30, Z
 567               		
 568               	 ;  0 "" 2
 569               	/* #NOAPP */
 570               	.LBE150:
 571 015a 8E2F      		mov r24,r30
 572 015c 90E0      		ldi r25,0
 573 015e 6370      		andi r22,lo8(3)
 574 0160 660F      		lsl r22
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 24


 575 0162 00C0      		rjmp 2f
 576               		1:
 577 0164 9595      		asr r25
 578 0166 8795      		ror r24
 579               		2:
 580 0168 6A95      		dec r22
 581 016a 02F4      		brpl 1b
 582 016c 8370      		andi r24,lo8(3)
  52:icons/spriteMotion.c ****    if(motion == DIR_TOGGLE)
 583               		.stabn	68,0,52,.LM37-.LFBB8
 584               	.LM37:
 585 016e 8330      		cpi r24,lo8(3)
 586 0170 01F4      		brne .L18
  53:icons/spriteMotion.c ****    {
  54:icons/spriteMotion.c ****       state->dir[axis] = -state->dir[axis];
 587               		.stabn	68,0,54,.LM38-.LFBB8
 588               	.LM38:
 589 0172 FA01      		movw r30,r20
 590 0174 8281      		ldd r24,Z+2
 591 0176 8195      		neg r24
 592 0178 8283      		std Z+2,r24
 593               	.L23:
  51:icons/spriteMotion.c ****    if(motion == DIR_TOGGLE)
 594               		.stabn	68,0,51,.LM39-.LFBB8
 595               	.LM39:
 596 017a 80E0      		ldi r24,0
 597               	.L18:
  55:icons/spriteMotion.c ****       motion = 0;
  56:icons/spriteMotion.c ****    }
  57:icons/spriteMotion.c **** 
  58:icons/spriteMotion.c ****    motion *= state->dir[axis];
 598               		.stabn	68,0,58,.LM40-.LFBB8
 599               	.LM40:
 600 017c FA01      		movw r30,r20
 601 017e 6281      		ldd r22,Z+2
 602 0180 00D0      		rcall __mulqi3
  59:icons/spriteMotion.c **** 
  60:icons/spriteMotion.c ****    //Considering having LeafX be more like acceleration...?
  61:icons/spriteMotion.c ****    // e.g. motion: 1, 0, 0, DIR_TOGGLE -> motionX = 1 1 1 0(-)
  62:icons/spriteMotion.c ****    //(-= because we want +1 to shift right)
  63:icons/spriteMotion.c ****    if(axis == 0)
 603               		.stabn	68,0,63,.LM41-.LFBB8
 604               	.LM41:
 605 0182 2111      		cpse r18,__zero_reg__
 606 0184 00C0      		rjmp .L19
  64:icons/spriteMotion.c ****       motion *= (-1);
 607               		.stabn	68,0,64,.LM42-.LFBB8
 608               	.LM42:
 609 0186 8195      		neg r24
 610               	.L19:
  65:icons/spriteMotion.c **** 
  66:icons/spriteMotion.c ****    state->position[axis] += motion;
 611               		.stabn	68,0,66,.LM43-.LFBB8
 612               	.LM43:
 613 0188 9881      		ld r25,Y
 614 018a 980F      		add r25,r24
 615 018c 9993      		st Y+,r25
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 25


 616 018e 2F5F      		subi r18,-1
 617 0190 3F4F      		sbci r19,-1
 618               	.LBE149:
  32:icons/spriteMotion.c ****    {
 619               		.stabn	68,0,32,.LM44-.LFBB8
 620               	.LM44:
 621 0192 2230      		cpi r18,2
 622 0194 3105      		cpc r19,__zero_reg__
 623 0196 01F4      		brne .L21
  67:icons/spriteMotion.c ****    }
  68:icons/spriteMotion.c **** 
  69:icons/spriteMotion.c **** 	state->paletteNum += GET_PALETTE_ADVANCE(state->sprite->p_paletteAdvance,
 624               		.stabn	68,0,69,.LM45-.LFBB8
 625               	.LM45:
 626 0198 1D96      		adiw r26,13
 627 019a 8C91      		ld r24,X
 628 019c 1D97      		sbiw r26,13
 629 019e 1B96      		adiw r26,11
 630 01a0 2D91      		ld r18,X+
 631 01a2 3C91      		ld r19,X
 632 01a4 1C97      		sbiw r26,11+1
 633 01a6 F901      		movw r30,r18
 634 01a8 7096      		adiw r30,16
 635 01aa 0590      		lpm r0,Z+
 636 01ac F491      		lpm r31,Z
 637 01ae E02D      		mov r30,r0
 638 01b0 3097      		sbiw r30,0
 639 01b2 01F0      		breq .L24
 640               	.LBB151:
 641               		.stabn	68,0,69,.LM46-.LFBB8
 642               	.LM46:
 643 01b4 1496      		adiw r26,4
 644 01b6 9C91      		ld r25,X
 645 01b8 1497      		sbiw r26,4
 646 01ba 492F      		mov r20,r25
 647 01bc 4695      		lsr r20
 648 01be 4695      		lsr r20
 649 01c0 4695      		lsr r20
 650 01c2 E40F      		add r30,r20
 651 01c4 F11D      		adc r31,__zero_reg__
 652               	/* #APP */
 653               	 ;  69 "icons/spriteMotion.c" 1
 654 01c6 E491      		lpm r30, Z
 655               		
 656               	 ;  0 "" 2
 657               	/* #NOAPP */
 658               	.LBE151:
 659 01c8 F0E0      		ldi r31,0
 660 01ca 9770      		andi r25,lo8(7)
 661 01cc 00C0      		rjmp 2f
 662               		1:
 663 01ce F595      		asr r31
 664 01d0 E795      		ror r30
 665               		2:
 666 01d2 9A95      		dec r25
 667 01d4 02F4      		brpl 1b
 668 01d6 E170      		andi r30,lo8(1)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 26


 669 01d8 00C0      		rjmp .L22
 670               	.L24:
 671               		.stabn	68,0,69,.LM47-.LFBB8
 672               	.LM47:
 673 01da E0E0      		ldi r30,0
 674               	.L22:
 675               		.stabn	68,0,69,.LM48-.LFBB8
 676               	.LM48:
 677 01dc 8E0F      		add r24,r30
 678 01de 1D96      		adiw r26,13
 679 01e0 8C93      		st X,r24
 680 01e2 1D97      		sbiw r26,13
  70:icons/spriteMotion.c **** 																			state->count);
  71:icons/spriteMotion.c **** 	state->paletteNum %= state->sprite->numPalettes;
 681               		.stabn	68,0,71,.LM49-.LFBB8
 682               	.LM49:
 683 01e4 F901      		movw r30,r18
 684 01e6 3696      		adiw r30,6
 685 01e8 6491      		lpm r22,Z
 686 01ea 00D0      		rcall __udivmodqi4
 687 01ec 1D96      		adiw r26,13
 688 01ee 9C93      		st X,r25
 689               	/* epilogue start */
  72:icons/spriteMotion.c **** }
 690               		.stabn	68,0,72,.LM50-.LFBB8
 691               	.LM50:
 692 01f0 DF91      		pop r29
 693 01f2 CF91      		pop r28
 694 01f4 1F91      		pop r17
 695 01f6 0F91      		pop r16
 696 01f8 FF90      		pop r15
 697 01fa EF90      		pop r14
 698 01fc 0895      		ret
 699               		.size	fbQ_repositionSprite, .-fbQ_repositionSprite
 700               	.Lscope8:
 701               		.stabs	"",36,0,0,.Lscope8-.LFBB8
 702               		.stabd	78,0,0
 703               		.stabs	"fbQ_overlaySprite:F(4,2)",36,0,81,fbQ_overlaySprite
 704               		.stabs	"p_theSprite:P(16,3)",64,0,81,14
 705               		.stabs	"state:p(0,48)",160,0,81,4
 706               	.global	fbQ_overlaySprite
 707               		.type	fbQ_overlaySprite, @function
 708               	fbQ_overlaySprite:
 709               		.stabd	46,0,0
  73:icons/spriteMotion.c **** 
  74:icons/spriteMotion.c **** 
  75:icons/spriteMotion.c **** 
  76:icons/spriteMotion.c **** 
  77:icons/spriteMotion.c **** //Draws a sprite on top of whatever's already there, at the position
  78:icons/spriteMotion.c **** //determined by its motionStuff... (repositionSprite() needs to be called
  79:icons/spriteMotion.c **** //prior)
  80:icons/spriteMotion.c **** //Eventually will return the rowNum for REFRESH_ON_CHANGE, etc...
  81:icons/spriteMotion.c **** uint8_t fbQ_overlaySprite(const __flash sprite_t *p_theSprite, spriteState_t *state)     
  82:icons/spriteMotion.c **** 																//int8_t *spritePosition)
  83:icons/spriteMotion.c **** {
 710               		.stabn	68,0,83,.LM51-.LFBB9
 711               	.LM51:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 27


 712               	.LFBB9:
 713 01fe 2F92      		push r2
 714 0200 3F92      		push r3
 715 0202 4F92      		push r4
 716 0204 5F92      		push r5
 717 0206 6F92      		push r6
 718 0208 7F92      		push r7
 719 020a 8F92      		push r8
 720 020c 9F92      		push r9
 721 020e AF92      		push r10
 722 0210 BF92      		push r11
 723 0212 CF92      		push r12
 724 0214 DF92      		push r13
 725 0216 EF92      		push r14
 726 0218 FF92      		push r15
 727 021a 0F93      		push r16
 728 021c 1F93      		push r17
 729 021e CF93      		push r28
 730 0220 DF93      		push r29
 731 0222 00D0      		rcall .
 732 0224 00D0      		rcall .
 733 0226 1F92      		push __zero_reg__
 734 0228 CDB7      		in r28,__SP_L__
 735 022a DEB7      		in r29,__SP_H__
 736               	/* prologue: function */
 737               	/* frame size = 5 */
 738               	/* stack size = 23 */
 739               	.L__stack_usage = 23
 740 022c 7C01      		movw r14,r24
 741 022e 7D83      		std Y+5,r23
 742 0230 6C83      		std Y+4,r22
  84:icons/spriteMotion.c ****    uint8_t imageChangedTillRow=0;
  85:icons/spriteMotion.c **** 
  86:icons/spriteMotion.c ****    //It's too confusing with the camera having its own position, so e.g.
  87:icons/spriteMotion.c ****    //camCol=0, if it were used here, would NOT BE THE SAME as the column in
  88:icons/spriteMotion.c ****    //the "image" in which the camera's first column resides...
  89:icons/spriteMotion.c ****    // frameCol, instead, is the actual frame drawn...
  90:icons/spriteMotion.c ****    //int8_t camRow, camCol;
  91:icons/spriteMotion.c ****    int8_t frameRow, frameCol;
  92:icons/spriteMotion.c **** 
  93:icons/spriteMotion.c ****    //I can't recall how this used to work...
  94:icons/spriteMotion.c **** //   uint8_t paletteForColor = getSpritePalette(p_theSprite, 0, 0);
  95:icons/spriteMotion.c **** 	uint8_t paletteForColor = 0;
  96:icons/spriteMotion.c **** 
  97:icons/spriteMotion.c **** 	int8_t position[2] = {0,0};
  98:icons/spriteMotion.c **** 	uint8_t * hFlip = NULL;
  99:icons/spriteMotion.c **** 	uint8_t count = 0;
 100:icons/spriteMotion.c **** 
 101:icons/spriteMotion.c **** 	//An unchanging sprite, e.g. SOLID in the background of a Reward...
 102:icons/spriteMotion.c **** 	// (when NULL)
 103:icons/spriteMotion.c **** 	if (state != NULL)
 743               		.stabn	68,0,103,.LM52-.LFBB9
 744               	.LM52:
 745 0232 6115      		cp r22,__zero_reg__
 746 0234 7105      		cpc r23,__zero_reg__
 747 0236 01F0      		breq .L37
 104:icons/spriteMotion.c **** 	{
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 28


 105:icons/spriteMotion.c **** 		position[0] = state->position[0];
 748               		.stabn	68,0,105,.LM53-.LFBB9
 749               	.LM53:
 750 0238 FB01      		movw r30,r22
 751 023a 2080      		ld r2,Z
 106:icons/spriteMotion.c **** 		position[1] = state->position[1];
 752               		.stabn	68,0,106,.LM54-.LFBB9
 753               	.LM54:
 754 023c F181      		ldd r31,Z+1
 755 023e F983      		std Y+1,r31
 107:icons/spriteMotion.c **** 		//hFlip = state->sprite->p_hFlip;	//6404
 108:icons/spriteMotion.c **** 		hFlip = state->hFlip;					//6382
 756               		.stabn	68,0,108,.LM55-.LFBB9
 757               	.LM55:
 758 0240 FB01      		movw r30,r22
 759 0242 A780      		ldd r10,Z+7
 760 0244 B084      		ldd r11,Z+8
 109:icons/spriteMotion.c **** 		count = state->count;
 761               		.stabn	68,0,109,.LM56-.LFBB9
 762               	.LM56:
 763 0246 8481      		ldd r24,Z+4
 110:icons/spriteMotion.c **** 		paletteForColor = state->paletteNum;
 764               		.stabn	68,0,110,.LM57-.LFBB9
 765               	.LM57:
 766 0248 5585      		ldd r21,Z+13
 767 024a 00C0      		rjmp .L26
 768               	.L37:
  97:icons/spriteMotion.c **** 	uint8_t * hFlip = NULL;
 769               		.stabn	68,0,97,.LM58-.LFBB9
 770               	.LM58:
 771 024c 1982      		std Y+1,__zero_reg__
 772 024e 212C      		mov r2,__zero_reg__
  99:icons/spriteMotion.c **** 
 773               		.stabn	68,0,99,.LM59-.LFBB9
 774               	.LM59:
 775 0250 80E0      		ldi r24,0
  98:icons/spriteMotion.c **** 	uint8_t count = 0;
 776               		.stabn	68,0,98,.LM60-.LFBB9
 777               	.LM60:
 778 0252 A12C      		mov r10,__zero_reg__
 779 0254 B12C      		mov r11,__zero_reg__
  95:icons/spriteMotion.c **** 
 780               		.stabn	68,0,95,.LM61-.LFBB9
 781               	.LM61:
 782 0256 50E0      		ldi r21,0
 783               	.L26:
 784               	.LBB152:
 785               	.LBB153:
 786               	.LBB154:
 111:icons/spriteMotion.c **** 	}
 112:icons/spriteMotion.c **** 
 113:icons/spriteMotion.c **** 
 114:icons/spriteMotion.c **** 
 115:icons/spriteMotion.c ****    for(frameRow = 0; frameRow<FB_HEIGHT; frameRow++)
 116:icons/spriteMotion.c ****    {
 117:icons/spriteMotion.c ****       int8_t spriteRow =
 118:icons/spriteMotion.c ****          (position[1] - cameraState.position[1]) + frameRow;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 29


 119:icons/spriteMotion.c ****          
 120:icons/spriteMotion.c ****       //The sky's already been drawn...
 121:icons/spriteMotion.c ****       if((spriteRow >= FB_HEIGHT) || (spriteRow < 0))
 122:icons/spriteMotion.c ****          continue;
 123:icons/spriteMotion.c ****         
 124:icons/spriteMotion.c **** 	  	if(p_theSprite == &spriteFLOWER)
 125:icons/spriteMotion.c **** 		{	
 126:icons/spriteMotion.c **** 			if(spriteRow >= 8)
 127:icons/spriteMotion.c **** 				paletteForColor = NUMPALETTES_FLOWER-1;
 128:icons/spriteMotion.c **** 		}
 129:icons/spriteMotion.c **** 
 130:icons/spriteMotion.c ****       //Don't need to do this if the row is not in the sprite...
 131:icons/spriteMotion.c ****       for(frameCol = 0; frameCol<FB_WIDTH; frameCol++)
 132:icons/spriteMotion.c ****       {
 133:icons/spriteMotion.c ****       
 134:icons/spriteMotion.c ****          int8_t spriteCol =
 135:icons/spriteMotion.c ****             (position[0] - cameraState.position[0]) + frameCol;
 136:icons/spriteMotion.c ****             
 137:icons/spriteMotion.c ****          if(GET_FLIP(hFlip, count))
 787               		.stabn	68,0,137,.LM62-.LFBB9
 788               	.LM62:
 789 0258 982F      		mov r25,r24
 790 025a 9695      		lsr r25
 791 025c 9695      		lsr r25
 792 025e 9695      		lsr r25
 793 0260 2501      		movw r4,r10
 794 0262 490E      		add r4,r25
 795 0264 511C      		adc r5,__zero_reg__
 796               	.LBE154:
 797 0266 8770      		andi r24,lo8(7)
 798 0268 8824      		clr r8
 799 026a 8394      		inc r8
 800 026c 912C      		mov r9,__zero_reg__
 801 026e 00C0      		rjmp 2f
 802               		1:
 803 0270 880C      		lsl r8
 804 0272 991C      		rol r9
 805               		2:
 806 0274 8A95      		dec r24
 807 0276 02F4      		brpl 1b
 808 0278 B0E0      		ldi r27,lo8(frameBuffer)
 809 027a CB2E      		mov r12,r27
 810 027c B0E0      		ldi r27,hi8(frameBuffer)
 811 027e DB2E      		mov r13,r27
 812               	.LBE153:
 813               	.LBE152:
 115:icons/spriteMotion.c ****    {
 814               		.stabn	68,0,115,.LM63-.LFBB9
 815               	.LM63:
 816 0280 312C      		mov r3,__zero_reg__
  84:icons/spriteMotion.c **** 
 817               		.stabn	68,0,84,.LM64-.LFBB9
 818               	.LM64:
 819 0282 80E0      		ldi r24,0
 820               	.LBB158:
 821               	.LBB156:
 138:icons/spriteMotion.c ****             spriteCol=(FB_WIDTH-1)-spriteCol;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 30


 139:icons/spriteMotion.c ****             
 140:icons/spriteMotion.c ****          //The sky's already been drawn...
 141:icons/spriteMotion.c ****          if((spriteCol >= FB_WIDTH) || (spriteCol < 0))
 142:icons/spriteMotion.c ****             continue;
 143:icons/spriteMotion.c ****            
 144:icons/spriteMotion.c **** 		  //As it stands, a multi-image sprite is assumed to always
 145:icons/spriteMotion.c **** 		  //cycle-through the images; one with each redraw...
 146:icons/spriteMotion.c ****          uint8_t colorData = getRawPixelVal(p_theSprite, spriteRow,
 147:icons/spriteMotion.c ****                                             spriteCol, 
 148:icons/spriteMotion.c **** 											(state->count)%(p_theSprite->numImages));
 822               		.stabn	68,0,148,.LM65-.LFBB9
 823               	.LM65:
 824 0284 3701      		movw r6,r14
 825 0286 F2E1      		ldi r31,18
 826 0288 6F0E      		add r6,r31
 827 028a 711C      		adc r7,__zero_reg__
 828               	.L36:
 829               	.LBE156:
 117:icons/spriteMotion.c ****          (position[1] - cameraState.position[1]) + frameRow;
 830               		.stabn	68,0,117,.LM66-.LFBB9
 831               	.LM66:
 832 028c 9091 0000 		lds r25,cameraState+1
 833 0290 3981      		ldd r19,Y+1
 834 0292 391B      		sub r19,r25
 835 0294 330D      		add r19,r3
 121:icons/spriteMotion.c ****          continue;
 836               		.stabn	68,0,121,.LM67-.LFBB9
 837               	.LM67:
 838 0296 3031      		cpi r19,lo8(16)
 839 0298 00F0      		brlo .+2
 840 029a 00C0      		rjmp .L27
 124:icons/spriteMotion.c **** 		{	
 841               		.stabn	68,0,124,.LM68-.LFBB9
 842               	.LM68:
 843 029c 80E0      		ldi r24,lo8(spriteFLOWER)
 844 029e E816      		cp r14,r24
 845 02a0 80E0      		ldi r24,hi8(spriteFLOWER)
 846 02a2 F806      		cpc r15,r24
 847 02a4 01F4      		brne .L28
 126:icons/spriteMotion.c **** 				paletteForColor = NUMPALETTES_FLOWER-1;
 848               		.stabn	68,0,126,.LM69-.LFBB9
 849               	.LM69:
 850 02a6 3830      		cpi r19,lo8(8)
 851 02a8 04F0      		brlt .L28
 127:icons/spriteMotion.c **** 		}
 852               		.stabn	68,0,127,.LM70-.LFBB9
 853               	.LM70:
 854 02aa 53E0      		ldi r21,lo8(3)
 855               	.L28:
 856 02ac 00E0      		ldi r16,0
 857 02ae 10E0      		ldi r17,0
 858               	.L34:
 859               	.LBB157:
 134:icons/spriteMotion.c ****             (position[0] - cameraState.position[0]) + frameCol;
 860               		.stabn	68,0,134,.LM71-.LFBB9
 861               	.LM71:
 862 02b0 8091 0000 		lds r24,cameraState
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 31


 863 02b4 422D      		mov r20,r2
 864 02b6 481B      		sub r20,r24
 865 02b8 400F      		add r20,r16
 137:icons/spriteMotion.c ****             spriteCol=(FB_WIDTH-1)-spriteCol;
 866               		.stabn	68,0,137,.LM72-.LFBB9
 867               	.LM72:
 868 02ba A114      		cp r10,__zero_reg__
 869 02bc B104      		cpc r11,__zero_reg__
 870 02be 01F0      		breq .L29
 871               	.LBB155:
 137:icons/spriteMotion.c ****             spriteCol=(FB_WIDTH-1)-spriteCol;
 872               		.stabn	68,0,137,.LM73-.LFBB9
 873               	.LM73:
 874 02c0 F201      		movw r30,r4
 875               	/* #APP */
 876               	 ;  137 "icons/spriteMotion.c" 1
 877 02c2 8491      		lpm r24, Z
 878               		
 879               	 ;  0 "" 2
 880               	/* #NOAPP */
 881               	.LBE155:
 882 02c4 90E0      		ldi r25,0
 883 02c6 8821      		and r24,r8
 884 02c8 9921      		and r25,r9
 885 02ca 892B      		or r24,r25
 886 02cc 01F0      		breq .L29
 138:icons/spriteMotion.c ****             
 887               		.stabn	68,0,138,.LM74-.LFBB9
 888               	.LM74:
 889 02ce FFE0      		ldi r31,lo8(15)
 890 02d0 F41B      		sub r31,r20
 891 02d2 4F2F      		mov r20,r31
 892               	.L29:
 141:icons/spriteMotion.c ****             continue;
 893               		.stabn	68,0,141,.LM75-.LFBB9
 894               	.LM75:
 895 02d4 4031      		cpi r20,lo8(16)
 896 02d6 00F4      		brsh .L31
 146:icons/spriteMotion.c ****                                             spriteCol, 
 897               		.stabn	68,0,146,.LM76-.LFBB9
 898               	.LM76:
 899 02d8 EC81      		ldd r30,Y+4
 900 02da FD81      		ldd r31,Y+5
 901 02dc 8481      		ldd r24,Z+4
 902 02de F301      		movw r30,r6
 903 02e0 6491      		lpm r22,Z
 904 02e2 00D0      		rcall __udivmodqi4
 905 02e4 292F      		mov r18,r25
 906 02e6 632F      		mov r22,r19
 907 02e8 C701      		movw r24,r14
 908 02ea 3B83      		std Y+3,r19
 909 02ec 5A83      		std Y+2,r21
 910 02ee 00D0      		rcall getRawPixelVal
 149:icons/spriteMotion.c ****                                                          
 150:icons/spriteMotion.c ****          //The sky is always, now, as I recall, 0...     
 151:icons/spriteMotion.c ****          // so use it as a mask.
 152:icons/spriteMotion.c ****          if(colorData == 0)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 32


 911               		.stabn	68,0,152,.LM77-.LFBB9
 912               	.LM77:
 913 02f0 3B81      		ldd r19,Y+3
 914 02f2 5A81      		ldd r21,Y+2
 915 02f4 8823      		tst r24
 916 02f6 01F0      		breq .L31
 153:icons/spriteMotion.c ****             continue; 
 154:icons/spriteMotion.c **** 
 155:icons/spriteMotion.c **** 
 156:icons/spriteMotion.c **** 
 157:icons/spriteMotion.c **** 			colorData = rawPixValToGimpColorVal(colorData,
 917               		.stabn	68,0,157,.LM78-.LFBB9
 918               	.LM78:
 919 02f8 452F      		mov r20,r21
 920 02fa B701      		movw r22,r14
 921 02fc 00D0      		rcall rawPixValToGimpColorVal
 158:icons/spriteMotion.c ****                                                 p_theSprite,
 159:icons/spriteMotion.c ****                                                 paletteForColor);
 160:icons/spriteMotion.c ****          colorData = gimpPixelValToLColor(colorData);
 922               		.stabn	68,0,160,.LM79-.LFBB9
 923               	.LM79:
 924 02fe 682F      		mov r22,r24
 925 0300 6073      		andi r22,lo8(48)
 926 0302 70E0      		ldi r23,0
 927 0304 3B81      		ldd r19,Y+3
 928 0306 5A81      		ldd r21,Y+2
 929 0308 6032      		cpi r22,32
 930 030a 7105      		cpc r23,__zero_reg__
 931 030c 04F0      		brlt .L33
 932               		.stabn	68,0,160,.LM80-.LFBB9
 933               	.LM80:
 934 030e 805F      		subi r24,lo8(-(16))
 935               	.L33:
 936 0310 F601      		movw r30,r12
 937 0312 E00F      		add r30,r16
 938 0314 F11F      		adc r31,r17
 161:icons/spriteMotion.c ****          
 162:icons/spriteMotion.c ****          frameBuffer[frameRow][frameCol] = colorData;
 939               		.stabn	68,0,162,.LM81-.LFBB9
 940               	.LM81:
 941 0316 8083      		st Z,r24
 942               	.L31:
 943 0318 0F5F      		subi r16,-1
 944 031a 1F4F      		sbci r17,-1
 945               	.LBE157:
 131:icons/spriteMotion.c ****       {
 946               		.stabn	68,0,131,.LM82-.LFBB9
 947               	.LM82:
 948 031c 0031      		cpi r16,16
 949 031e 1105      		cpc r17,__zero_reg__
 950 0320 01F4      		brne .L34
 163:icons/spriteMotion.c ****          
 164:icons/spriteMotion.c ****          //NEED TO STOP AT THE END OF THE MOTIONARRAY
 165:icons/spriteMotion.c ****       }  
 166:icons/spriteMotion.c ****       
 167:icons/spriteMotion.c ****       //For now we're just going to presume that the framebuffer 
 168:icons/spriteMotion.c ****       // has changed each time...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 33


 169:icons/spriteMotion.c ****       imageChangedTillRow = frameRow;
 951               		.stabn	68,0,169,.LM83-.LFBB9
 952               	.LM83:
 953 0322 832D      		mov r24,r3
 954               	.L27:
 955 0324 3394      		inc r3
 956 0326 F1E1      		ldi r31,17
 957 0328 CF0E      		add r12,r31
 958 032a D11C      		adc r13,__zero_reg__
 959               	.LBE158:
 115:icons/spriteMotion.c ****    {
 960               		.stabn	68,0,115,.LM84-.LFBB9
 961               	.LM84:
 962 032c 90E1      		ldi r25,lo8(16)
 963 032e 3912      		cpse r3,r25
 964 0330 00C0      		rjmp .L36
 965               	/* epilogue start */
 170:icons/spriteMotion.c ****    }  
 171:icons/spriteMotion.c ****    
 172:icons/spriteMotion.c ****    return imageChangedTillRow;
 173:icons/spriteMotion.c ****    
 174:icons/spriteMotion.c **** }  
 966               		.stabn	68,0,174,.LM85-.LFBB9
 967               	.LM85:
 968 0332 0F90      		pop __tmp_reg__
 969 0334 0F90      		pop __tmp_reg__
 970 0336 0F90      		pop __tmp_reg__
 971 0338 0F90      		pop __tmp_reg__
 972 033a 0F90      		pop __tmp_reg__
 973 033c DF91      		pop r29
 974 033e CF91      		pop r28
 975 0340 1F91      		pop r17
 976 0342 0F91      		pop r16
 977 0344 FF90      		pop r15
 978 0346 EF90      		pop r14
 979 0348 DF90      		pop r13
 980 034a CF90      		pop r12
 981 034c BF90      		pop r11
 982 034e AF90      		pop r10
 983 0350 9F90      		pop r9
 984 0352 8F90      		pop r8
 985 0354 7F90      		pop r7
 986 0356 6F90      		pop r6
 987 0358 5F90      		pop r5
 988 035a 4F90      		pop r4
 989 035c 3F90      		pop r3
 990 035e 2F90      		pop r2
 991 0360 0895      		ret
 992               		.size	fbQ_overlaySprite, .-fbQ_overlaySprite
 993               		.stabs	"frameRow:r(4,1)",64,0,91,3
 994               		.stabs	"paletteForColor:r(4,2)",64,0,95,21
 995               		.stabs	"hFlip:r(0,49)=*(4,2)",64,0,98,10
 996               		.stabs	"count:r(4,2)",64,0,99,24
 997               		.stabn	192,0,0,.LFBB9-.LFBB9
 998               		.stabs	"spriteCol:r(4,1)",64,0,134,20
 999               		.stabn	192,0,0,.LBB153-.LFBB9
 1000               		.stabs	"__addr16:r(4,4)",64,0,137,4
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 34


 1001               		.stabn	192,0,0,.LBB154-.LFBB9
 1002               		.stabn	224,0,0,.LBE154-.LFBB9
 1003               		.stabs	"__addr16:r(4,4)",64,0,137,4
 1004               		.stabn	192,0,0,.LBB155-.LFBB9
 1005               		.stabn	224,0,0,.LBE155-.LFBB9
 1006               		.stabn	224,0,0,.LBE153-.LFBB9
 1007               		.stabs	"spriteCol:r(4,1)",64,0,134,20
 1008               		.stabn	192,0,0,.LBB156-.LFBB9
 1009               		.stabn	224,0,0,.LBE156-.LFBB9
 1010               		.stabs	"spriteCol:r(4,1)",64,0,134,20
 1011               		.stabn	192,0,0,.LBB157-.LFBB9
 1012               		.stabn	224,0,0,.LBE157-.LFBB9
 1013               		.stabn	224,0,0,.Lscope9-.LFBB9
 1014               	.Lscope9:
 1015               		.stabs	"",36,0,0,.Lscope9-.LFBB9
 1016               		.stabd	78,0,0
 1017               		.stabs	"initSpriteStates:F(0,47)",36,0,295,initSpriteStates
 1018               		.stabs	"newSprite:P(16,3)",64,0,295,24
 1019               	.global	initSpriteStates
 1020               		.type	initSpriteStates, @function
 1021               	initSpriteStates:
 1022               		.stabd	46,0,0
 1023               		.stabs	"fb_question.c",132,0,0,.Ltext8
 1024               	.Ltext8:
   1:fb_question.c **** /* mehPL:
   2:fb_question.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:fb_question.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:fb_question.c ****  *    Please see the bottom.
   5:fb_question.c ****  *    Enjoy!
   6:fb_question.c ****  */
   7:fb_question.c **** 
   8:fb_question.c **** 
   9:fb_question.c **** 
  10:fb_question.c **** 
  11:fb_question.c **** 
  12:fb_question.c **** 
  13:fb_question.c **** 
  14:fb_question.c **** 
  15:fb_question.c **** 
  16:fb_question.c **** 
  17:fb_question.c **** //fb_question is the good-ol' "Mario" Question-box, using a frameBuffer...
  18:fb_question.c **** //  It was created after seg_question, which was created after a
  19:fb_question.c **** //  frameBuffer-based method. Long convoluted story.
  20:fb_question.c **** 
  21:fb_question.c **** // Essentially, fb_question is the latest (a/o v66) version of the
  22:fb_question.c **** // Mario-Question-Box, which has actually been installed at a somewhat
  23:fb_question.c **** // permanent location for public-interaction. (and Seg_question has since
  24:fb_question.c **** // been put on the back-burner).
  25:fb_question.c **** 
  26:fb_question.c **** // When the question-box is "hit" it displays a random sprite:
  27:fb_question.c **** //  A Coin, 1-up, Biggie, Star, Flower, or possibly a Goomba
  28:fb_question.c **** //  If you *hit* the goomba, it dies.
  29:fb_question.c **** 
  30:fb_question.c **** // As-implemented (in main), the ADC is used as the hit-detector. Connected
  31:fb_question.c **** // to it is a piezo-element. Unfortunately, I'm certain, the
  32:fb_question.c **** // threshold-values, etc. for this "hit-sensor" will have to be configured
  33:fb_question.c **** // for your particular hardware... And, in fact, I've found that it's
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 35


  34:fb_question.c **** // sensitive to electrical noise (e.g. from the backlight inverter) as well
  35:fb_question.c **** // as things like temperature. It's kinda hokey, but it's also in main()
  36:fb_question.c **** // and could easily be converted to a simple momentary-switch.
  37:fb_question.c **** 
  38:fb_question.c **** 
  39:fb_question.c **** 
  40:fb_question.c **** 
  41:fb_question.c **** 
  42:fb_question.c **** 
  43:fb_question.c **** 	//Start at brown, to match the SOLID color
  44:fb_question.c **** #define Q_QSTART	7 //3
  45:fb_question.c **** 
  46:fb_question.c **** //a/o v62-21:
  47:fb_question.c **** // this is stolen from seg_question.c and modified for the framebuffer...
  48:fb_question.c **** 
  49:fb_question.c **** 
  50:fb_question.c **** 
  51:fb_question.c **** //These are not included in NUM_ICONS
  52:fb_question.c ****    #include "icons/Question.h"
  53:fb_question.c ****    #include "icons/Solid.h"
  54:fb_question.c ****    #include "icons/GoombaDead.h"
  55:fb_question.c **** 
  56:fb_question.c ****    //These are included in NUM_ICONS
  57:fb_question.c ****    #include "icons/1up.h"
  58:fb_question.c ****    #include "icons/Biggie.h"
  59:fb_question.c ****    #include "icons/StarV.h"
  60:fb_question.c ****    #include "icons/FlowerPowerV.h"
  61:fb_question.c ****    #include "icons/Goomba.h"
  62:fb_question.c ****    #include "icons/Coin.h"
  63:fb_question.c **** 	#include "icons/Leaf.h"
  64:fb_question.c **** 	#include "icons/Cloud.h"
  65:fb_question.c **** 	#include "icons/Mario.h"
  66:fb_question.c **** 	#include "icons/Luigi.h"
  67:fb_question.c **** 	#include "icons/MarioRuns.h"
  68:fb_question.c **** 	#include "icons/LuigiRuns.h"
  69:fb_question.c **** //a/o v77
  70:fb_question.c **** //APPARENTLY NUM_ICONS is no longer used.
  71:fb_question.c **** //Excluding Solid and Question, etc...
  72:fb_question.c **** //#define NUM_ICONS 6
  73:fb_question.c **** 
  74:fb_question.c **** 
  75:fb_question.c **** //Allow the user to choose another winnings when the question-box is
  76:fb_question.c **** //scrolling down to reveal it... for testing
  77:fb_question.c **** //#define IMMEDIATE TRUE
  78:fb_question.c **** 
  79:fb_question.c **** //This is just a hack for testing BIGGIE with the Leaf tester, which was a
  80:fb_question.c **** //hack in the first place.
  81:fb_question.c **** //#define MOTION_BIGGIE TRUE	//RANDOM_OVERRIDE's gotta be 2
  82:fb_question.c **** //These are from hitDetected()
  83:fb_question.c **** //#define RANDOM_OVERRIDE 8//32//2//Biggie //5//Leaf  //4 //8 //0 //4
  84:fb_question.c **** 
  85:fb_question.c **** //Stalls at the first sprite (initilized in p_selectedSprite, below)
  86:fb_question.c **** //#define STAY_ON_IT	TRUE
  87:fb_question.c **** 
  88:fb_question.c **** //Automatically hit after a few loops in the "Q" box
  89:fb_question.c **** //#define AUTO_HIT	TRUE
  90:fb_question.c **** //#define AUTO_KILL_GOOMBA	TRUE
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 36


  91:fb_question.c **** 
  92:fb_question.c **** //THESE DON'T BELONG HERE
  93:fb_question.c **** // AND they shouldn't be "Q" specific, at all.
  94:fb_question.c **** #define Q_WIDTH   16
  95:fb_question.c **** #define Q_HEIGHT   16
  96:fb_question.c **** #if((Q_WIDTH != FB_WIDTH) || (Q_HEIGHT != FB_HEIGHT))
  97:fb_question.c **** #error "FB dims do not match Icon dims"
  98:fb_question.c **** #endif
  99:fb_question.c **** 
 100:fb_question.c **** //this is just a counter to help throw in some additional randomness...
 101:fb_question.c **** uint8_t callCount = 0;
 102:fb_question.c **** 
 103:fb_question.c **** uint8_t qCount = 0;
 104:fb_question.c **** //sprite_t *p_selectedSprite = &spriteLEAF; //COIN; //GOOMBA; //FLOWER; //&spriteQ;
 105:fb_question.c **** 
 106:fb_question.c **** //a/o v84: nextSprite is hokily used as selectedSprite...
 107:fb_question.c **** // This needs to be changed.
 108:fb_question.c **** //sprite_t *p_nextSprite = &spriteLEAF; //NULL;
 109:fb_question.c **** const __flash sprite_t *p_nowSprite = &spriteLEAF; //NULL;
 110:fb_question.c **** //This indicates whether we're in a "Reward"
 111:fb_question.c **** // e.g. to draw SOLID in the background
 112:fb_question.c **** uint8_t nowIsReward = TRUE;
 113:fb_question.c **** 
 114:fb_question.c **** 
 115:fb_question.c **** void initSpriteStates(const __flash sprite_t *newSprite);
 116:fb_question.c **** 
 117:fb_question.c **** 
 118:fb_question.c **** void fbQuestion_hitDetected(void)
 119:fb_question.c **** {
 120:fb_question.c **** 
 121:fb_question.c **** 	if( (p_nowSprite == &spriteQ)
 122:fb_question.c **** //#if (!defined(IMMEDIATE) || !IMMEDIATE)
 123:fb_question.c **** //	    && (p_nextSprite == NULL)
 124:fb_question.c **** //#endif
 125:fb_question.c **** 	  )
 126:fb_question.c **** 	{
 127:fb_question.c **** 		uint8_t hitReward;
 128:fb_question.c **** 		//Just trying to get some randomness up in hea
 129:fb_question.c **** #if (defined(RANDOM_OVERRIDE))
 130:fb_question.c **** 		hitReward = RANDOM_OVERRIDE;
 131:fb_question.c **** #elif (defined(HSYNC_TIMER_TCNT))
 132:fb_question.c **** 		static uint8_t lastReward;
 133:fb_question.c **** 		
 134:fb_question.c **** 		do
 135:fb_question.c **** 		{
 136:fb_question.c **** 			hitReward = (HSYNC_TIMER_TCNT + callCount + qCount)%12;
 137:fb_question.c **** 			//Don't allow double-goombas
 138:fb_question.c **** 		} while ((lastReward == 4) && (hitReward == 4));
 139:fb_question.c **** 
 140:fb_question.c **** 		lastReward = hitReward;
 141:fb_question.c **** #else
 142:fb_question.c ****  #error "HSYNC_TIMER_TCNT should be available for randomness..."
 143:fb_question.c **** #if 0
 144:fb_question.c **** 		//These guys don't have enough randomness to avoid call-count...
 145:fb_question.c ****  #if (defined(__ADC_H__))
 146:fb_question.c **** 		hitReward = ((adc_getValue()*3+callCount+qCount))%8;
 147:fb_question.c ****  #else
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 37


 148:fb_question.c **** 		hitReward = (callCount+qCount)%8;
 149:fb_question.c ****  #endif
 150:fb_question.c **** #endif
 151:fb_question.c **** #endif
 152:fb_question.c **** 
 153:fb_question.c **** 		switch(hitReward)
 154:fb_question.c **** 		{
 155:fb_question.c **** 			case 0:
 156:fb_question.c **** 				p_nowSprite = &spriteFLOWER;
 157:fb_question.c **** 				break;
 158:fb_question.c **** 			case 1:
 159:fb_question.c **** 				p_nowSprite = &sprite1UP;
 160:fb_question.c **** 				break;
 161:fb_question.c **** 			case 2:
 162:fb_question.c **** 				p_nowSprite = &spriteBIG;
 163:fb_question.c **** 				break;
 164:fb_question.c **** 			case 3:
 165:fb_question.c **** 				p_nowSprite = &spriteSTAR;
 166:fb_question.c **** 				break;
 167:fb_question.c **** 			case 4:
 168:fb_question.c **** 				p_nowSprite = &spriteGOOMBA;
 169:fb_question.c **** 				break;
 170:fb_question.c **** 			case 5:
 171:fb_question.c **** 				p_nowSprite = &spriteLEAF;
 172:fb_question.c **** 				break;
 173:fb_question.c **** 			case 6:
 174:fb_question.c **** 				p_nowSprite = &spriteCLOUD;
 175:fb_question.c **** 				break;
 176:fb_question.c **** 			case 7:
 177:fb_question.c **** 				p_nowSprite = &spriteMARIO;
 178:fb_question.c **** 				break;
 179:fb_question.c **** 			case 8:
 180:fb_question.c **** 				p_nowSprite = &spriteLUIGI;
 181:fb_question.c **** 				break;
 182:fb_question.c **** //			case 9:
 183:fb_question.c **** //				p_nowSprite = &spriteMARIORUNS;
 184:fb_question.c **** 				break;
 185:fb_question.c **** 			default:
 186:fb_question.c **** 				p_nowSprite = &spriteCOIN;
 187:fb_question.c **** 				break;
 188:fb_question.c **** 		}
 189:fb_question.c **** 		//qCount = 0;
 190:fb_question.c **** 		nowIsReward = TRUE;
 191:fb_question.c **** 		initSpriteStates(p_nowSprite);
 192:fb_question.c **** 	}
 193:fb_question.c **** /* This was nice with the old scroll-up method, but with the new method,
 194:fb_question.c ****  * it's too hokey... (can smash it before it's visible)
 195:fb_question.c **** 	else if( (p_nextSprite == &spriteGOOMBA)
 196:fb_question.c **** 		      && (qCount > 4) )
 197:fb_question.c **** 	{
 198:fb_question.c **** 		p_nextSprite = &spriteDEADGOOMBA;
 199:fb_question.c **** 	}
 200:fb_question.c **** */
 201:fb_question.c **** 	//As-is, the last frame (in blue, indicating death) is only visible
 202:fb_question.c **** 	//briefly before scroll-back-to-question starts...
 203:fb_question.c **** 	// so there's no reason to test for KILLABLE
 204:fb_question.c **** 	// since it can't be killed when it's scrolling.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 38


 205:fb_question.c **** 	// There's probably a tiny fraction of a second window where it is
 206:fb_question.c **** 	// possible to hit it when it's blue, and kill it... but it's TINY.
 207:fb_question.c **** 	else if((p_nowSprite == &spriteGOOMBA)
 208:fb_question.c **** 				&& ((qCount > 16) && (qCount < 62)))
 209:fb_question.c **** //				&& (p_nextSprite == NULL) )
 210:fb_question.c **** //			   && ((qCount > 0) && (qCount < 16)) )
 211:fb_question.c **** //			   && (qCount < GOOMBA_KILLABLE_QCOUNT) )
 212:fb_question.c **** 	{
 213:fb_question.c **** 		//qCount = 0;
 214:fb_question.c **** 		nowIsReward = TRUE;
 215:fb_question.c **** 		p_nowSprite = &spriteDEADGOOMBA;
 216:fb_question.c **** 		initSpriteStates(p_nowSprite);
 217:fb_question.c **** 	}
 218:fb_question.c **** 
 219:fb_question.c **** }
 220:fb_question.c **** 
 221:fb_question.c **** //If a spriteRow is outside the icon's dimensions, draws the sky-color
 222:fb_question.c **** //Returns TRUE if a pixel has changed
 223:fb_question.c **** // for redrawing...
 224:fb_question.c **** uint8_t drawSpriteRow(const __flash sprite_t *p_thisSprite, uint8_t spritePhase,
 225:fb_question.c **** 													  int8_t spriteRow, 
 226:fb_question.c **** 													  uint8_t rowToDrawAt);
 227:fb_question.c **** 
 228:fb_question.c **** 
 229:fb_question.c **** 
 230:fb_question.c **** #if(defined(STAY_ON_IT) && STAY_ON_IT)
 231:fb_question.c **** //Check for completion of one sprite, and setup the next...
 232:fb_question.c **** void prepNextSprite(void)
 233:fb_question.c **** {
 234:fb_question.c **** }
 235:fb_question.c **** #else
 236:fb_question.c **** void prepNextSprite(void)
 237:fb_question.c **** {
 238:fb_question.c **** 	//a/o v84:
 239:fb_question.c **** 	// The new plan is to have a defined path...
 240:fb_question.c **** 	// Q -> Hit -> "Reward" -> Solid -> Q
 241:fb_question.c **** 		
 242:fb_question.c **** 	// CURRENTLY: "Hit" is NYI so:
 243:fb_question.c **** 	// Q -> "Reward" -> Solid -> Q
 244:fb_question.c **** 
 245:fb_question.c **** 	// ALSO: Goomba/GoombaDead needs to be reimplemented
 246:fb_question.c **** 
 247:fb_question.c **** 	// Also, we've been using p_nextSprite as the current sprite for some
 248:fb_question.c **** 	// time. It should probably be renamed to selectedSprite, and the old
 249:fb_question.c **** 	// p_selectedSprite should probably be removed entirely.
 250:fb_question.c **** 	// IOW: There's no need for "nextSprite" in the new method.
 251:fb_question.c **** 
 252:fb_question.c **** 	// Q Loops...
 253:fb_question.c **** 	if(p_nowSprite == &spriteQ)
 254:fb_question.c **** 	{
 255:fb_question.c **** 		//Do nothing for Q... until a hit arrives
 256:fb_question.c **** 		// qCount is reset by the caller, so it just loops
 257:fb_question.c **** 		// nowIsReward should already be FALSE
 258:fb_question.c **** 		
 259:fb_question.c **** 		// If AUTO_HIT is true, then "after" Question-box "completes"
 260:fb_question.c **** 		// act like a hit was detected...
 261:fb_question.c **** 	  #if(defined(AUTO_HIT) && AUTO_HIT)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 39


 262:fb_question.c **** 		fbQuestion_hitDetected();
 263:fb_question.c **** 	  #else
 264:fb_question.c **** 		return;
 265:fb_question.c ****      #endif
 266:fb_question.c **** 	}
 267:fb_question.c **** 	// Mario -> MarioRuns
 268:fb_question.c **** 	else if(p_nowSprite == &spriteMARIO)
 269:fb_question.c **** 	{
 270:fb_question.c **** 		nowIsReward = TRUE;
 271:fb_question.c **** 		p_nowSprite = &spriteMARIORUNS;
 272:fb_question.c **** 	}
 273:fb_question.c **** 	// Luigi -> LuigiRuns
 274:fb_question.c **** 	else if(p_nowSprite == &spriteLUIGI)
 275:fb_question.c **** 	{
 276:fb_question.c **** 		nowIsReward = TRUE;
 277:fb_question.c **** 		p_nowSprite = &spriteLUIGIRUNS;
 278:fb_question.c **** 	}
 279:fb_question.c **** 	// Solid -> Q
 280:fb_question.c **** 	else if(p_nowSprite == &spriteSOLID)
 281:fb_question.c **** 	{
 282:fb_question.c **** 		nowIsReward = FALSE;
 283:fb_question.c **** 		p_nowSprite = &spriteQ;
 284:fb_question.c **** 	}
 285:fb_question.c **** 	// "Reward" -> Solid
 286:fb_question.c **** 	else
 287:fb_question.c **** 	{
 288:fb_question.c **** 		nowIsReward = FALSE;
 289:fb_question.c **** 		p_nowSprite = &spriteSOLID;
 290:fb_question.c **** 	}	
 291:fb_question.c **** 
 292:fb_question.c **** 	initSpriteStates(p_nowSprite);
 293:fb_question.c **** }
 294:fb_question.c **** 
 295:fb_question.c **** void initSpriteStates(const __flash sprite_t *newSprite)
 296:fb_question.c **** {
 1025               		.stabn	68,0,296,.LM86-.LFBB10
 1026               	.LM86:
 1027               	.LFBB10:
 1028               	/* prologue: function */
 1029               	/* frame size = 0 */
 1030               	/* stack size = 0 */
 1031               	.L__stack_usage = 0
 297:fb_question.c **** 	qCount = 0;
 1032               		.stabn	68,0,297,.LM87-.LFBB10
 1033               	.LM87:
 1034 0362 1092 0000 		sts qCount,__zero_reg__
 298:fb_question.c **** 	//.count is handled by qCount... but let's init it anyhow.
 299:fb_question.c **** 	
 300:fb_question.c **** 	p_nowSprite = newSprite;
 1035               		.stabn	68,0,300,.LM88-.LFBB10
 1036               	.LM88:
 1037 0366 9093 0000 		sts p_nowSprite+1,r25
 1038 036a 8093 0000 		sts p_nowSprite,r24
 301:fb_question.c **** 	
 302:fb_question.c **** 	
 303:fb_question.c **** 	
 304:fb_question.c **** 	
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 40


 305:fb_question.c **** 	nowSpriteState.sprite = p_nowSprite;
 1039               		.stabn	68,0,305,.LM89-.LFBB10
 1040               	.LM89:
 1041 036e 9093 0000 		sts nowSpriteState+11+1,r25
 1042 0372 8093 0000 		sts nowSpriteState+11,r24
 306:fb_question.c **** 	nowSpriteState.count = 0;
 1043               		.stabn	68,0,306,.LM90-.LFBB10
 1044               	.LM90:
 1045 0376 1092 0000 		sts nowSpriteState+4,__zero_reg__
 307:fb_question.c **** 	nowSpriteState.hFlip = p_nowSprite->p_hFlip;
 1046               		.stabn	68,0,307,.LM91-.LFBB10
 1047               	.LM91:
 1048 037a FC01      		movw r30,r24
 1049 037c 3896      		adiw r30,8
 1050 037e 2591      		lpm r18,Z+
 1051 0380 3591      		lpm r19,Z+
 1052 0382 3093 0000 		sts nowSpriteState+7+1,r19
 1053 0386 2093 0000 		sts nowSpriteState+7,r18
 308:fb_question.c **** 	nowSpriteState.motion = p_nowSprite->p_motion;
 1054               		.stabn	68,0,308,.LM92-.LFBB10
 1055               	.LM92:
 1056 038a FC01      		movw r30,r24
 1057 038c 3A96      		adiw r30,10
 1058 038e 0590      		lpm r0,Z+
 1059 0390 F491      		lpm r31,Z
 1060 0392 E02D      		mov r30,r0
 1061 0394 F093 0000 		sts nowSpriteState+9+1,r31
 1062 0398 E093 0000 		sts nowSpriteState+9,r30
 309:fb_question.c **** 	//Origin is lower-left, but nextSpritePosition is upper-left...
 310:fb_question.c **** 	nowSpriteState.position[0] = -(nowSpriteState.motion[0].startPosition);
 1063               		.stabn	68,0,310,.LM93-.LFBB10
 1064               	.LM93:
 1065 039c 2491      		lpm r18,Z
 1066 039e 2195      		neg r18
 1067 03a0 2093 0000 		sts nowSpriteState,r18
 311:fb_question.c **** 	nowSpriteState.position[1] = nowSpriteState.motion[1].startPosition;
 1068               		.stabn	68,0,311,.LM94-.LFBB10
 1069               	.LM94:
 1070 03a4 3396      		adiw r30,3
 1071 03a6 2491      		lpm r18,Z
 1072 03a8 2093 0000 		sts nowSpriteState+1,r18
 312:fb_question.c **** 	nowSpriteState.dir[0] = 1;
 1073               		.stabn	68,0,312,.LM95-.LFBB10
 1074               	.LM95:
 1075 03ac 41E0      		ldi r20,lo8(1)
 1076 03ae 4093 0000 		sts nowSpriteState+2,r20
 313:fb_question.c **** 	nowSpriteState.dir[1] = 1;
 1077               		.stabn	68,0,313,.LM96-.LFBB10
 1078               	.LM96:
 1079 03b2 4093 0000 		sts nowSpriteState+3,r20
 314:fb_question.c **** 
 315:fb_question.c **** 	nowSpriteState.layer = p_nowSprite->p_layer;
 1080               		.stabn	68,0,315,.LM97-.LFBB10
 1081               	.LM97:
 1082 03b6 FC01      		movw r30,r24
 1083 03b8 3C96      		adiw r30,12
 1084 03ba 2591      		lpm r18,Z+
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 41


 1085 03bc 3591      		lpm r19,Z+
 1086 03be 3093 0000 		sts nowSpriteState+5+1,r19
 1087 03c2 2093 0000 		sts nowSpriteState+5,r18
 316:fb_question.c **** 	nowSpriteState.paletteNum = 0;
 1088               		.stabn	68,0,316,.LM98-.LFBB10
 1089               	.LM98:
 1090 03c6 1092 0000 		sts nowSpriteState+13,__zero_reg__
 317:fb_question.c **** 
 318:fb_question.c **** 
 319:fb_question.c **** 	//No sprite associated with the camera...
 320:fb_question.c **** 	cameraState.sprite = NULL;
 1091               		.stabn	68,0,320,.LM99-.LFBB10
 1092               	.LM99:
 1093 03ca 1092 0000 		sts cameraState+11+1,__zero_reg__
 1094 03ce 1092 0000 		sts cameraState+11,__zero_reg__
 321:fb_question.c **** 	cameraState.count = 0;
 1095               		.stabn	68,0,321,.LM100-.LFBB10
 1096               	.LM100:
 1097 03d2 1092 0000 		sts cameraState+4,__zero_reg__
 322:fb_question.c **** 	cameraState.hFlip = NadaFlip;
 1098               		.stabn	68,0,322,.LM101-.LFBB10
 1099               	.LM101:
 1100 03d6 1092 0000 		sts cameraState+7+1,__zero_reg__
 1101 03da 1092 0000 		sts cameraState+7,__zero_reg__
 323:fb_question.c **** 	cameraState.motion = p_nowSprite->p_camMotion;
 1102               		.stabn	68,0,323,.LM102-.LFBB10
 1103               	.LM102:
 1104 03de FC01      		movw r30,r24
 1105 03e0 3E96      		adiw r30,14
 1106 03e2 0590      		lpm r0,Z+
 1107 03e4 F491      		lpm r31,Z
 1108 03e6 E02D      		mov r30,r0
 1109 03e8 F093 0000 		sts cameraState+9+1,r31
 1110 03ec E093 0000 		sts cameraState+9,r30
 324:fb_question.c **** 	cameraState.position[0] = -(cameraState.motion[0].startPosition);
 1111               		.stabn	68,0,324,.LM103-.LFBB10
 1112               	.LM103:
 1113 03f0 8491      		lpm r24,Z
 1114 03f2 8195      		neg r24
 1115 03f4 8093 0000 		sts cameraState,r24
 325:fb_question.c **** 	cameraState.position[1] = cameraState.motion[1].startPosition;
 1116               		.stabn	68,0,325,.LM104-.LFBB10
 1117               	.LM104:
 1118 03f8 3396      		adiw r30,3
 1119 03fa 8491      		lpm r24,Z
 1120 03fc 8093 0000 		sts cameraState+1,r24
 326:fb_question.c **** 	cameraState.dir[0] = 1;
 1121               		.stabn	68,0,326,.LM105-.LFBB10
 1122               	.LM105:
 1123 0400 4093 0000 		sts cameraState+2,r20
 327:fb_question.c **** 	cameraState.dir[1] = 1;
 1124               		.stabn	68,0,327,.LM106-.LFBB10
 1125               	.LM106:
 1126 0404 4093 0000 		sts cameraState+3,r20
 328:fb_question.c **** 
 329:fb_question.c **** 	cameraState.layer = NadaLayer;
 1127               		.stabn	68,0,329,.LM107-.LFBB10
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 42


 1128               	.LM107:
 1129 0408 1092 0000 		sts cameraState+5+1,__zero_reg__
 1130 040c 1092 0000 		sts cameraState+5,__zero_reg__
 330:fb_question.c **** 	cameraState.paletteNum = 0;
 1131               		.stabn	68,0,330,.LM108-.LFBB10
 1132               	.LM108:
 1133 0410 1092 0000 		sts cameraState+13,__zero_reg__
 1134 0414 0895      		ret
 1135               		.size	initSpriteStates, .-initSpriteStates
 1136               	.Lscope10:
 1137               		.stabs	"",36,0,0,.Lscope10-.LFBB10
 1138               		.stabd	78,0,0
 1139               		.stabs	"fbQuestion_hitDetected:F(0,47)",36,0,118,fbQuestion_hitDetected
 1140               	.global	fbQuestion_hitDetected
 1141               		.type	fbQuestion_hitDetected, @function
 1142               	fbQuestion_hitDetected:
 1143               		.stabd	46,0,0
 119:fb_question.c **** 
 1144               		.stabn	68,0,119,.LM109-.LFBB11
 1145               	.LM109:
 1146               	.LFBB11:
 1147 0416 1F93      		push r17
 1148 0418 CF93      		push r28
 1149 041a DF93      		push r29
 1150               	/* prologue: function */
 1151               	/* frame size = 0 */
 1152               	/* stack size = 3 */
 1153               	.L__stack_usage = 3
 121:fb_question.c **** //#if (!defined(IMMEDIATE) || !IMMEDIATE)
 1154               		.stabn	68,0,121,.LM110-.LFBB11
 1155               	.LM110:
 1156 041c 8091 0000 		lds r24,p_nowSprite
 1157 0420 9091 0000 		lds r25,p_nowSprite+1
 1158 0424 20E0      		ldi r18,hi8(spriteQ)
 1159 0426 8030      		cpi r24,lo8(spriteQ)
 1160 0428 9207      		cpc r25,r18
 1161 042a 01F0      		breq .+2
 1162 042c 00C0      		rjmp .L51
 1163               	.LBB159:
 136:fb_question.c **** 			//Don't allow double-goombas
 1164               		.stabn	68,0,136,.LM111-.LFBB11
 1165               	.LM111:
 1166 042e 2091 0000 		lds r18,callCount
 1167 0432 30E0      		ldi r19,0
 1168 0434 E091 0000 		lds r30,qCount
 1169 0438 F0E0      		ldi r31,0
 138:fb_question.c **** 
 1170               		.stabn	68,0,138,.LM112-.LFBB11
 1171               	.LM112:
 1172 043a 1091 0000 		lds r17,lastReward.2304
 136:fb_question.c **** 			//Don't allow double-goombas
 1173               		.stabn	68,0,136,.LM113-.LFBB11
 1174               	.LM113:
 1175 043e CCE0      		ldi r28,lo8(12)
 1176 0440 D0E0      		ldi r29,0
 1177               	.L65:
 1178 0442 82B7      		in r24,0x32
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 43


 1179 0444 A901      		movw r20,r18
 1180 0446 480F      		add r20,r24
 1181 0448 511D      		adc r21,__zero_reg__
 1182 044a CA01      		movw r24,r20
 1183 044c 8E0F      		add r24,r30
 1184 044e 9F1F      		adc r25,r31
 1185 0450 BE01      		movw r22,r28
 1186 0452 00D0      		rcall __divmodhi4
 1187 0454 482F      		mov r20,r24
 138:fb_question.c **** 
 1188               		.stabn	68,0,138,.LM114-.LFBB11
 1189               	.LM114:
 1190 0456 1430      		cpi r17,lo8(4)
 1191 0458 01F0      		breq .L52
 1192               	.L64:
 140:fb_question.c **** #else
 1193               		.stabn	68,0,140,.LM115-.LFBB11
 1194               	.LM115:
 1195 045a 4093 0000 		sts lastReward.2304,r20
 153:fb_question.c **** 		{
 1196               		.stabn	68,0,153,.LM116-.LFBB11
 1197               	.LM116:
 1198 045e 8930      		cpi r24,9
 1199 0460 9105      		cpc r25,__zero_reg__
 1200 0462 00F4      		brsh .L53
 1201 0464 FC01      		movw r30,r24
 1202 0466 E050      		subi r30,lo8(-(gs(.L55)))
 1203 0468 F040      		sbci r31,hi8(-(gs(.L55)))
 1204 046a 0994      		ijmp
 1205               		.section	.progmem.gcc_sw_table,"ax",@progbits
 1206               		.p2align	1
 1207               	.L55:
 1208 0000 00C0      		rjmp .L54
 1209 0002 00C0      		rjmp .L56
 1210 0004 00C0      		rjmp .L57
 1211 0006 00C0      		rjmp .L58
 1212 0008 00C0      		rjmp .L59
 1213 000a 00C0      		rjmp .L60
 1214 000c 00C0      		rjmp .L61
 1215 000e 00C0      		rjmp .L62
 1216 0010 00C0      		rjmp .L63
 1217               		.text
 1218               	.L52:
 138:fb_question.c **** 
 1219               		.stabn	68,0,138,.LM117-.LFBB11
 1220               	.LM117:
 1221 046c 8430      		cpi r24,lo8(4)
 1222 046e 01F0      		breq .L65
 1223 0470 00C0      		rjmp .L64
 1224               	.L54:
 156:fb_question.c **** 				break;
 1225               		.stabn	68,0,156,.LM118-.LFBB11
 1226               	.LM118:
 1227 0472 80E0      		ldi r24,lo8(spriteFLOWER)
 1228 0474 90E0      		ldi r25,hi8(spriteFLOWER)
 1229 0476 00C0      		rjmp .L68
 1230               	.L56:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 44


 159:fb_question.c **** 				break;
 1231               		.stabn	68,0,159,.LM119-.LFBB11
 1232               	.LM119:
 1233 0478 80E0      		ldi r24,lo8(sprite1UP)
 1234 047a 90E0      		ldi r25,hi8(sprite1UP)
 1235 047c 00C0      		rjmp .L68
 1236               	.L57:
 162:fb_question.c **** 				break;
 1237               		.stabn	68,0,162,.LM120-.LFBB11
 1238               	.LM120:
 1239 047e 80E0      		ldi r24,lo8(spriteBIG)
 1240 0480 90E0      		ldi r25,hi8(spriteBIG)
 1241 0482 00C0      		rjmp .L68
 1242               	.L58:
 165:fb_question.c **** 				break;
 1243               		.stabn	68,0,165,.LM121-.LFBB11
 1244               	.LM121:
 1245 0484 80E0      		ldi r24,lo8(spriteSTAR)
 1246 0486 90E0      		ldi r25,hi8(spriteSTAR)
 1247 0488 00C0      		rjmp .L68
 1248               	.L59:
 168:fb_question.c **** 				break;
 1249               		.stabn	68,0,168,.LM122-.LFBB11
 1250               	.LM122:
 1251 048a 80E0      		ldi r24,lo8(spriteGOOMBA)
 1252 048c 90E0      		ldi r25,hi8(spriteGOOMBA)
 1253 048e 00C0      		rjmp .L68
 1254               	.L60:
 171:fb_question.c **** 				break;
 1255               		.stabn	68,0,171,.LM123-.LFBB11
 1256               	.LM123:
 1257 0490 80E0      		ldi r24,lo8(spriteLEAF)
 1258 0492 90E0      		ldi r25,hi8(spriteLEAF)
 1259 0494 00C0      		rjmp .L68
 1260               	.L61:
 174:fb_question.c **** 				break;
 1261               		.stabn	68,0,174,.LM124-.LFBB11
 1262               	.LM124:
 1263 0496 80E0      		ldi r24,lo8(spriteCLOUD)
 1264 0498 90E0      		ldi r25,hi8(spriteCLOUD)
 1265 049a 00C0      		rjmp .L68
 1266               	.L62:
 177:fb_question.c **** 				break;
 1267               		.stabn	68,0,177,.LM125-.LFBB11
 1268               	.LM125:
 1269 049c 80E0      		ldi r24,lo8(spriteMARIO)
 1270 049e 90E0      		ldi r25,hi8(spriteMARIO)
 1271 04a0 00C0      		rjmp .L68
 1272               	.L63:
 180:fb_question.c **** 				break;
 1273               		.stabn	68,0,180,.LM126-.LFBB11
 1274               	.LM126:
 1275 04a2 80E0      		ldi r24,lo8(spriteLUIGI)
 1276 04a4 90E0      		ldi r25,hi8(spriteLUIGI)
 1277 04a6 00C0      		rjmp .L68
 1278               	.L53:
 186:fb_question.c **** 				break;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 45


 1279               		.stabn	68,0,186,.LM127-.LFBB11
 1280               	.LM127:
 1281 04a8 80E0      		ldi r24,lo8(spriteCOIN)
 1282 04aa 90E0      		ldi r25,hi8(spriteCOIN)
 1283               	.L68:
 1284 04ac 9093 0000 		sts p_nowSprite+1,r25
 1285 04b0 8093 0000 		sts p_nowSprite,r24
 190:fb_question.c **** 		initSpriteStates(p_nowSprite);
 1286               		.stabn	68,0,190,.LM128-.LFBB11
 1287               	.LM128:
 1288 04b4 81E0      		ldi r24,lo8(1)
 1289 04b6 8093 0000 		sts nowIsReward,r24
 191:fb_question.c **** 	}
 1290               		.stabn	68,0,191,.LM129-.LFBB11
 1291               	.LM129:
 1292 04ba 8091 0000 		lds r24,p_nowSprite
 1293 04be 9091 0000 		lds r25,p_nowSprite+1
 1294 04c2 00C0      		rjmp .L69
 1295               	.L51:
 1296               	.LBE159:
 207:fb_question.c **** 				&& ((qCount > 16) && (qCount < 62)))
 1297               		.stabn	68,0,207,.LM130-.LFBB11
 1298               	.LM130:
 1299 04c4 8050      		subi r24,lo8(spriteGOOMBA)
 1300 04c6 9040      		sbci r25,hi8(spriteGOOMBA)
 1301 04c8 01F4      		brne .L50
 208:fb_question.c **** //				&& (p_nextSprite == NULL) )
 1302               		.stabn	68,0,208,.LM131-.LFBB11
 1303               	.LM131:
 1304 04ca 8091 0000 		lds r24,qCount
 1305 04ce 8151      		subi r24,lo8(-(-17))
 1306 04d0 8D32      		cpi r24,lo8(45)
 1307 04d2 00F4      		brsh .L50
 214:fb_question.c **** 		p_nowSprite = &spriteDEADGOOMBA;
 1308               		.stabn	68,0,214,.LM132-.LFBB11
 1309               	.LM132:
 1310 04d4 81E0      		ldi r24,lo8(1)
 1311 04d6 8093 0000 		sts nowIsReward,r24
 215:fb_question.c **** 		initSpriteStates(p_nowSprite);
 1312               		.stabn	68,0,215,.LM133-.LFBB11
 1313               	.LM133:
 1314 04da 80E0      		ldi r24,lo8(spriteDEADGOOMBA)
 1315 04dc 90E0      		ldi r25,hi8(spriteDEADGOOMBA)
 1316 04de 9093 0000 		sts p_nowSprite+1,r25
 1317 04e2 8093 0000 		sts p_nowSprite,r24
 1318               	.L69:
 1319               	/* epilogue start */
 219:fb_question.c **** 
 1320               		.stabn	68,0,219,.LM134-.LFBB11
 1321               	.LM134:
 1322 04e6 DF91      		pop r29
 1323 04e8 CF91      		pop r28
 1324 04ea 1F91      		pop r17
 216:fb_question.c **** 	}
 1325               		.stabn	68,0,216,.LM135-.LFBB11
 1326               	.LM135:
 1327 04ec 00C0      		rjmp initSpriteStates
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 46


 1328               	.L50:
 1329               	/* epilogue start */
 219:fb_question.c **** 
 1330               		.stabn	68,0,219,.LM136-.LFBB11
 1331               	.LM136:
 1332 04ee DF91      		pop r29
 1333 04f0 CF91      		pop r28
 1334 04f2 1F91      		pop r17
 1335 04f4 0895      		ret
 1336               		.size	fbQuestion_hitDetected, .-fbQuestion_hitDetected
 1337               		.stabs	"hitReward:r(4,2)",64,0,127,20
 1338               		.stabs	"lastReward:V(4,2)",40,0,132,lastReward.2304
 1339               		.stabn	192,0,0,.LBB159-.LFBB11
 1340               		.stabn	224,0,0,.LBE159-.LFBB11
 1341               	.Lscope11:
 1342               		.stabs	"",36,0,0,.Lscope11-.LFBB11
 1343               		.stabd	78,0,0
 1344               		.stabs	"__vector_2:F(0,47)",36,0,74,__vector_2
 1345               	.global	__vector_2
 1346               		.type	__vector_2, @function
 1347               	__vector_2:
 1348               		.stabd	46,0,0
 1349               		.stabs	"_hitSensors/bumpSwitch.c",132,0,0,.Ltext9
 1350               	.Ltext9:
  70:_hitSensors/bumpSwitch.c **** 
  71:_hitSensors/bumpSwitch.c **** }
  72:_hitSensors/bumpSwitch.c **** 
  73:_hitSensors/bumpSwitch.c **** 
  74:_hitSensors/bumpSwitch.c **** SIGNAL(PCINT_vect)
  75:_hitSensors/bumpSwitch.c **** {
 1351               		.stabn	68,0,75,.LM137-.LFBB12
 1352               	.LM137:
 1353               	.LFBB12:
 1354 04f6 1F92      		push r1
 1355 04f8 0F92      		push r0
 1356 04fa 0FB6      		in r0,__SREG__
 1357 04fc 0F92      		push r0
 1358 04fe 1124      		clr __zero_reg__
 1359 0500 2F93      		push r18
 1360 0502 3F93      		push r19
 1361 0504 4F93      		push r20
 1362 0506 5F93      		push r21
 1363 0508 6F93      		push r22
 1364 050a 7F93      		push r23
 1365 050c 8F93      		push r24
 1366 050e 9F93      		push r25
 1367 0510 AF93      		push r26
 1368 0512 BF93      		push r27
 1369 0514 EF93      		push r30
 1370 0516 FF93      		push r31
 1371               	/* prologue: Signal */
 1372               	/* frame size = 0 */
 1373               	/* stack size = 15 */
 1374               	.L__stack_usage = 15
  76:_hitSensors/bumpSwitch.c **** 	fbQuestion_hitDetected();	
 1375               		.stabn	68,0,76,.LM138-.LFBB12
 1376               	.LM138:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 47


 1377 0518 00D0      		rcall fbQuestion_hitDetected
  77:_hitSensors/bumpSwitch.c **** 
  78:_hitSensors/bumpSwitch.c **** 	//Not certain this is the best way to handle this...
  79:_hitSensors/bumpSwitch.c **** 	//BOUNCE is INHERENT
  80:_hitSensors/bumpSwitch.c **** 	//So clear the interrupt again, even though it was cleared upon entry of
  81:_hitSensors/bumpSwitch.c **** 	//the interrupt-vector
  82:_hitSensors/bumpSwitch.c **** 	// (Will this prevent reentry to this interrupt if the bounce occurred
  83:_hitSensors/bumpSwitch.c **** 	// before it exitted and sei()ed at the end?
  84:_hitSensors/bumpSwitch.c **** 	setbit(PCIF, GIFR);
 1378               		.stabn	68,0,84,.LM139-.LFBB12
 1379               	.LM139:
 1380 051a 8AB7      		in r24,0x3a
 1381 051c 8062      		ori r24,lo8(32)
 1382 051e 8ABF      		out 0x3a,r24
 1383               	/* epilogue start */
  85:_hitSensors/bumpSwitch.c **** }
 1384               		.stabn	68,0,85,.LM140-.LFBB12
 1385               	.LM140:
 1386 0520 FF91      		pop r31
 1387 0522 EF91      		pop r30
 1388 0524 BF91      		pop r27
 1389 0526 AF91      		pop r26
 1390 0528 9F91      		pop r25
 1391 052a 8F91      		pop r24
 1392 052c 7F91      		pop r23
 1393 052e 6F91      		pop r22
 1394 0530 5F91      		pop r21
 1395 0532 4F91      		pop r20
 1396 0534 3F91      		pop r19
 1397 0536 2F91      		pop r18
 1398 0538 0F90      		pop r0
 1399 053a 0FBE      		out __SREG__,r0
 1400 053c 0F90      		pop r0
 1401 053e 1F90      		pop r1
 1402 0540 1895      		reti
 1403               		.size	__vector_2, .-__vector_2
 1404               	.Lscope12:
 1405               		.stabs	"",36,0,0,.Lscope12-.LFBB12
 1406               		.stabd	78,0,0
 1407               		.stabs	"prepNextSprite:F(0,47)",36,0,236,prepNextSprite
 1408               	.global	prepNextSprite
 1409               		.type	prepNextSprite, @function
 1410               	prepNextSprite:
 1411               		.stabd	46,0,0
 1412               		.stabs	"fb_question.c",132,0,0,.Ltext10
 1413               	.Ltext10:
 237:fb_question.c **** 	//a/o v84:
 1414               		.stabn	68,0,237,.LM141-.LFBB13
 1415               	.LM141:
 1416               	.LFBB13:
 1417               	/* prologue: function */
 1418               	/* frame size = 0 */
 1419               	/* stack size = 0 */
 1420               	.L__stack_usage = 0
 253:fb_question.c **** 	{
 1421               		.stabn	68,0,253,.LM142-.LFBB13
 1422               	.LM142:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 48


 1423 0542 8091 0000 		lds r24,p_nowSprite
 1424 0546 9091 0000 		lds r25,p_nowSprite+1
 1425 054a 20E0      		ldi r18,hi8(spriteQ)
 1426 054c 8030      		cpi r24,lo8(spriteQ)
 1427 054e 9207      		cpc r25,r18
 1428 0550 01F0      		breq .L71
 268:fb_question.c **** 	{
 1429               		.stabn	68,0,268,.LM143-.LFBB13
 1430               	.LM143:
 1431 0552 20E0      		ldi r18,hi8(spriteMARIO)
 1432 0554 8030      		cpi r24,lo8(spriteMARIO)
 1433 0556 9207      		cpc r25,r18
 1434 0558 01F4      		brne .L73
 270:fb_question.c **** 		p_nowSprite = &spriteMARIORUNS;
 1435               		.stabn	68,0,270,.LM144-.LFBB13
 1436               	.LM144:
 1437 055a 81E0      		ldi r24,lo8(1)
 1438 055c 8093 0000 		sts nowIsReward,r24
 271:fb_question.c **** 	}
 1439               		.stabn	68,0,271,.LM145-.LFBB13
 1440               	.LM145:
 1441 0560 80E0      		ldi r24,lo8(spriteMARIORUNS)
 1442 0562 90E0      		ldi r25,hi8(spriteMARIORUNS)
 1443 0564 00C0      		rjmp .L77
 1444               	.L73:
 274:fb_question.c **** 	{
 1445               		.stabn	68,0,274,.LM146-.LFBB13
 1446               	.LM146:
 1447 0566 20E0      		ldi r18,hi8(spriteLUIGI)
 1448 0568 8030      		cpi r24,lo8(spriteLUIGI)
 1449 056a 9207      		cpc r25,r18
 1450 056c 01F4      		brne .L75
 276:fb_question.c **** 		p_nowSprite = &spriteLUIGIRUNS;
 1451               		.stabn	68,0,276,.LM147-.LFBB13
 1452               	.LM147:
 1453 056e 81E0      		ldi r24,lo8(1)
 1454 0570 8093 0000 		sts nowIsReward,r24
 277:fb_question.c **** 	}
 1455               		.stabn	68,0,277,.LM148-.LFBB13
 1456               	.LM148:
 1457 0574 80E0      		ldi r24,lo8(spriteLUIGIRUNS)
 1458 0576 90E0      		ldi r25,hi8(spriteLUIGIRUNS)
 1459 0578 00C0      		rjmp .L77
 1460               	.L75:
 282:fb_question.c **** 		p_nowSprite = &spriteQ;
 1461               		.stabn	68,0,282,.LM149-.LFBB13
 1462               	.LM149:
 1463 057a 1092 0000 		sts nowIsReward,__zero_reg__
 280:fb_question.c **** 	{
 1464               		.stabn	68,0,280,.LM150-.LFBB13
 1465               	.LM150:
 1466 057e 8050      		subi r24,lo8(spriteSOLID)
 1467 0580 9040      		sbci r25,hi8(spriteSOLID)
 1468 0582 01F4      		brne .L76
 283:fb_question.c **** 	}
 1469               		.stabn	68,0,283,.LM151-.LFBB13
 1470               	.LM151:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 49


 1471 0584 80E0      		ldi r24,lo8(spriteQ)
 1472 0586 90E0      		ldi r25,hi8(spriteQ)
 1473 0588 00C0      		rjmp .L77
 1474               	.L76:
 289:fb_question.c **** 	}	
 1475               		.stabn	68,0,289,.LM152-.LFBB13
 1476               	.LM152:
 1477 058a 80E0      		ldi r24,lo8(spriteSOLID)
 1478 058c 90E0      		ldi r25,hi8(spriteSOLID)
 1479               	.L77:
 1480 058e 9093 0000 		sts p_nowSprite+1,r25
 1481 0592 8093 0000 		sts p_nowSprite,r24
 292:fb_question.c **** }
 1482               		.stabn	68,0,292,.LM153-.LFBB13
 1483               	.LM153:
 1484 0596 8091 0000 		lds r24,p_nowSprite
 1485 059a 9091 0000 		lds r25,p_nowSprite+1
 1486 059e 00C0      		rjmp initSpriteStates
 1487               	.L71:
 1488 05a0 0895      		ret
 1489               		.size	prepNextSprite, .-prepNextSprite
 1490               	.Lscope13:
 1491               		.stabs	"",36,0,0,.Lscope13-.LFBB13
 1492               		.stabd	78,0,0
 1493               		.stabs	"fbQ_drawBackground:F(0,47)",36,0,402,fbQ_drawBackground
 1494               		.stabs	"state:P(0,48)",64,0,402,24
 1495               	.global	fbQ_drawBackground
 1496               		.type	fbQ_drawBackground, @function
 1497               	fbQ_drawBackground:
 1498               		.stabd	46,0,0
 331:fb_question.c **** 
 332:fb_question.c **** 
 333:fb_question.c **** 	//This is only used by the SOLID in the background for Reward...
 334:fb_question.c **** 	// So probably never changes...
 335:fb_question.c **** 	//otherSpriteState.hFlip = NadaFlip;
 336:fb_question.c **** 	//otherSpriteState.motion = NadaMotion;
 337:fb_question.c **** 
 338:fb_question.c **** #if 0
 339:fb_question.c **** 		//DEADGOOMBA -> Question-Box (directly)
 340:fb_question.c **** 		if(p_selectedSprite == &spriteDEADGOOMBA)
 341:fb_question.c **** 		{
 342:fb_question.c **** 			if(qCount >= 16)
 343:fb_question.c **** 			{
 344:fb_question.c **** 				qCount = Q_QSTART; //0;
 345:fb_question.c **** 				p_nextSprite = &spriteQ;
 346:fb_question.c **** 			}
 347:fb_question.c **** 		}
 348:fb_question.c **** 		//GOOMBA -> SOLID
 349:fb_question.c **** 		else if(p_selectedSprite == &spriteGOOMBA)
 350:fb_question.c **** 		{
 351:fb_question.c **** 			if(qCount >= GOOMBA_QCOUNT)
 352:fb_question.c **** 			{
 353:fb_question.c **** 				qCount = 0;
 354:fb_question.c **** 				p_nextSprite = &spriteSOLID;
 355:fb_question.c **** 			}
 356:fb_question.c **** 		}
 357:fb_question.c **** 		//COIN -> SOLID
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 50


 358:fb_question.c **** 		else if(p_selectedSprite == &spriteCOIN)
 359:fb_question.c **** 		{
 360:fb_question.c **** 			if(qCount >= 8)
 361:fb_question.c **** 			{
 362:fb_question.c **** 				qCount = 0;
 363:fb_question.c **** 				p_nextSprite = &spriteSOLID;
 364:fb_question.c **** 			}
 365:fb_question.c **** 		}
 366:fb_question.c **** 		//SOLID -> Question-Box
 367:fb_question.c **** 		else if(p_selectedSprite == &spriteSOLID)
 368:fb_question.c **** 		{
 369:fb_question.c **** 			if(qCount >= 8)
 370:fb_question.c **** 			{
 371:fb_question.c **** 				qCount = Q_QSTART; //0;
 372:fb_question.c **** 				p_selectedSprite = &spriteQ;
 373:fb_question.c **** 			}
 374:fb_question.c **** 		}
 375:fb_question.c **** 		//**OTHERS** (NOT Question-Box) -> SOLID
 376:fb_question.c **** 		else if(p_selectedSprite != &spriteQ)
 377:fb_question.c **** 		{
 378:fb_question.c **** 			if(qCount >= 16)
 379:fb_question.c **** 			{
 380:fb_question.c **** 				qCount = 0;
 381:fb_question.c **** 				//if(p_selectedSprite != &spriteSOLID)
 382:fb_question.c **** 				p_nextSprite = &spriteSOLID;
 383:fb_question.c **** 				//else
 384:fb_question.c **** 				//   p_selectedSprite = &spriteQ;
 385:fb_question.c **** 			}
 386:fb_question.c **** 		}
 387:fb_question.c **** #endif //0
 388:fb_question.c **** }
 389:fb_question.c **** #endif //!STAY_ON_IT
 390:fb_question.c **** 
 391:fb_question.c **** 
 392:fb_question.c **** 
 393:fb_question.c **** // NEW MOTION-HANDLING...
 394:fb_question.c **** 
 395:fb_question.c **** 
 396:fb_question.c **** 
 397:fb_question.c **** 
 398:fb_question.c **** 
 399:fb_question.c **** 
 400:fb_question.c **** //This is sort-of Motion-Handling, as well...
 401:fb_question.c **** //Usually the sky...
 402:fb_question.c **** void fbQ_drawBackground(spriteState_t *state)
 403:fb_question.c **** {
 1499               		.stabn	68,0,403,.LM154-.LFBB14
 1500               	.LM154:
 1501               	.LFBB14:
 1502               	/* prologue: function */
 1503               	/* frame size = 0 */
 1504               	/* stack size = 0 */
 1505               	.L__stack_usage = 0
 404:fb_question.c **** 	//I can't recall how this used to work...
 405:fb_question.c **** 	//uint8_t paletteForColor = getSpritePalette(&spriteLEAF, 0, 0);
 406:fb_question.c **** 	uint8_t paletteForColor = state->paletteNum;
 407:fb_question.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 51


 408:fb_question.c **** 
 409:fb_question.c **** 
 410:fb_question.c **** 	//probably should look into skyOverride
 411:fb_question.c **** 	// for now, use the sky-color of the leaf, which is at (0,0)
 412:fb_question.c **** 	//Fill the background with the sky-color...
 413:fb_question.c **** //#define FBQ_SKYCOLOR_OVERRIDE _R
 414:fb_question.c **** #if(defined(FBQ_SKYCOLOR_OVERRIDE))
 415:fb_question.c **** 	uint8_t skyColorData = FBQ_SKYCOLOR_OVERRIDE;
 416:fb_question.c **** #else
 417:fb_question.c **** 	//uint8_t skyColorData = getRawPixelVal(, 0, 0);
 418:fb_question.c **** 
 419:fb_question.c **** 	uint8_t skyColorData = rawPixValToGimpColorVal(0, 
 1506               		.stabn	68,0,419,.LM155-.LFBB14
 1507               	.LM155:
 1508 05a2 FC01      		movw r30,r24
 1509 05a4 6385      		ldd r22,Z+11
 1510 05a6 7485      		ldd r23,Z+12
 1511 05a8 4585      		ldd r20,Z+13
 1512 05aa 80E0      		ldi r24,0
 1513 05ac 00D0      		rcall rawPixValToGimpColorVal
 420:fb_question.c **** 														state->sprite,
 421:fb_question.c **** 														paletteForColor);
 422:fb_question.c **** 	skyColorData = gimpPixelValToLColor(skyColorData);
 1514               		.stabn	68,0,422,.LM156-.LFBB14
 1515               	.LM156:
 1516 05ae 282F      		mov r18,r24
 1517 05b0 2073      		andi r18,lo8(48)
 1518 05b2 30E0      		ldi r19,0
 1519 05b4 2032      		cpi r18,32
 1520 05b6 3105      		cpc r19,__zero_reg__
 1521 05b8 04F0      		brlt .L79
 1522               		.stabn	68,0,422,.LM157-.LFBB14
 1523               	.LM157:
 1524 05ba 805F      		subi r24,lo8(-(16))
 1525               	.L79:
 1526 05bc 40E0      		ldi r20,lo8(frameBuffer)
 1527 05be 50E0      		ldi r21,hi8(frameBuffer)
 1528               	.L80:
 403:fb_question.c **** 	//I can't recall how this used to work...
 1529               		.stabn	68,0,403,.LM158-.LFBB14
 1530               	.LM158:
 1531 05c0 20E0      		ldi r18,0
 1532 05c2 30E0      		ldi r19,0
 1533               	.L83:
 1534 05c4 FA01      		movw r30,r20
 1535 05c6 E20F      		add r30,r18
 1536 05c8 F31F      		adc r31,r19
 423:fb_question.c **** #endif
 424:fb_question.c **** 
 425:fb_question.c **** 
 426:fb_question.c **** 	int8_t camRow, camCol;
 427:fb_question.c **** 
 428:fb_question.c **** 	for(camRow = 0; camRow<FB_HEIGHT; camRow++)
 429:fb_question.c **** 	{
 430:fb_question.c **** 		for(camCol = 0; camCol<FB_WIDTH; camCol++)
 431:fb_question.c **** 		{
 432:fb_question.c **** #if(defined(FBQ_RAINBOW_SKY) && FBQ_RAINBOW_SKY)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 52


 433:fb_question.c **** 			frameBuffer[camRow][camCol] = (camRow+camCol)&0x3f;//skyColorData;
 434:fb_question.c **** #else
 435:fb_question.c **** 			frameBuffer[camRow][camCol] = skyColorData;
 1537               		.stabn	68,0,435,.LM159-.LFBB14
 1538               	.LM159:
 1539 05ca 8083      		st Z,r24
 1540 05cc 2F5F      		subi r18,-1
 1541 05ce 3F4F      		sbci r19,-1
 430:fb_question.c **** 		{
 1542               		.stabn	68,0,430,.LM160-.LFBB14
 1543               	.LM160:
 1544 05d0 2031      		cpi r18,16
 1545 05d2 3105      		cpc r19,__zero_reg__
 1546 05d4 01F4      		brne .L83
 1547 05d6 4F5E      		subi r20,-17
 1548 05d8 5F4F      		sbci r21,-1
 428:fb_question.c **** 	{
 1549               		.stabn	68,0,428,.LM161-.LFBB14
 1550               	.LM161:
 1551 05da F0E0      		ldi r31,hi8(frameBuffer+272)
 1552 05dc 4030      		cpi r20,lo8(frameBuffer+272)
 1553 05de 5F07      		cpc r21,r31
 1554 05e0 01F4      		brne .L80
 1555 05e2 0895      		ret
 1556               		.size	fbQ_drawBackground, .-fbQ_drawBackground
 1557               		.stabs	"skyColorData:r(4,2)",64,0,419,24
 1558               		.stabn	192,0,0,.LFBB14-.LFBB14
 1559               		.stabn	224,0,0,.Lscope14-.LFBB14
 1560               	.Lscope14:
 1561               		.stabs	"",36,0,0,.Lscope14-.LFBB14
 1562               		.stabd	78,0,0
 1563               		.stabs	"fbQuestion_update:F(4,1)",36,0,448,fbQuestion_update
 1564               	.global	fbQuestion_update
 1565               		.type	fbQuestion_update, @function
 1566               	fbQuestion_update:
 1567               		.stabd	46,0,0
 436:fb_question.c **** #endif
 437:fb_question.c **** 
 438:fb_question.c **** 			//Should look into framebuffer-changed stuff, here...
 439:fb_question.c **** 		}
 440:fb_question.c **** 	}
 441:fb_question.c **** }
 442:fb_question.c **** 
 443:fb_question.c **** 
 444:fb_question.c **** 
 445:fb_question.c **** //Returns the last image-row that has changed...
 446:fb_question.c **** // (for refresh-on-change and/or partial-refresh)
 447:fb_question.c **** // otherwise -1 if no change.
 448:fb_question.c **** int8_t fbQuestion_update(void) //uint8_t triggerDetected)
 449:fb_question.c **** {
 1568               		.stabn	68,0,449,.LM162-.LFBB15
 1569               	.LM162:
 1570               	.LFBB15:
 1571 05e4 CF93      		push r28
 1572               	/* prologue: function */
 1573               	/* frame size = 0 */
 1574               	/* stack size = 1 */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 53


 1575               	.L__stack_usage = 1
 450:fb_question.c **** 	//last row that was changed...
 451:fb_question.c **** 	int8_t imageChangedTillRow = -1;
 452:fb_question.c **** 
 453:fb_question.c **** 	//This is just used for helping to throw in some randomness for the next
 454:fb_question.c **** 	//sprite after a hit...
 455:fb_question.c **** 	callCount++;
 1576               		.stabn	68,0,455,.LM163-.LFBB15
 1577               	.LM163:
 1578 05e6 8091 0000 		lds r24,callCount
 1579 05ea 8F5F      		subi r24,lo8(-(1))
 1580 05ec 8093 0000 		sts callCount,r24
 1581               	.LBB160:
 1582               	.LBB161:
 1583               		.stabs	"icons/iconPacking.h",132,0,0,.Ltext11
 1584               	.Ltext11:
 119:icons/iconPacking.h **** //	skyOverridePalette = palette;
 1585               		.stabn	68,0,119,.LM164-.LFBB15
 1586               	.LM164:
 1587 05f0 8091 0000 		lds r24,p_nowSprite
 1588 05f4 9091 0000 		lds r25,p_nowSprite+1
 1589 05f8 9093 0000 		sts skyOverrideSprite+1,r25
 1590 05fc 8093 0000 		sts skyOverrideSprite,r24
 1591               	.LBE161:
 1592               	.LBE160:
 1593               		.stabs	"fb_question.c",132,0,0,.Ltext12
 1594               	.Ltext12:
 456:fb_question.c **** 
 457:fb_question.c **** //   uint8_t qRow;
 458:fb_question.c **** 	
 459:fb_question.c **** 	//Check if it's time to select the next sprite, and do-so according to
 460:fb_question.c **** 	//which sprite we're on and which should follow it.
 461:fb_question.c **** 	//Most of the time, a sprite is followed by SOLID, but there are
 462:fb_question.c **** 	//exceptions...
 463:fb_question.c **** /*
 464:fb_question.c **** 	if(p_nextSprite == NULL)
 465:fb_question.c **** 	{
 466:fb_question.c **** 		prepNextSprite();
 467:fb_question.c **** 	}
 468:fb_question.c **** */
 469:fb_question.c **** 
 470:fb_question.c **** /*
 471:fb_question.c **** 	if(p_nextSprite != NULL)
 472:fb_question.c **** 	{
 473:fb_question.c **** */
 474:fb_question.c **** 		//a/o v84:
 475:fb_question.c **** 		//Is this necessary with motion handling, since the sky is drawn
 476:fb_question.c **** 		//separately???
 477:fb_question.c **** 		setSpriteSkyColorOverride(p_nowSprite);
 478:fb_question.c **** 
 479:fb_question.c **** 		//This isn't right, doesn't transition at all
 480:fb_question.c **** 		// it's just for testing the motion-scheme
 481:fb_question.c **** 		//Testing the new transition-scheme...
 482:fb_question.c **** /*
 483:fb_question.c **** #if(defined(MOTION_BIGGIE) && MOTION_BIGGIE)
 484:fb_question.c **** 		if(p_nextSprite == &spriteBIG)
 485:fb_question.c **** #else
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 54


 486:fb_question.c **** 		if(p_nextSprite == &spriteLEAF)
 487:fb_question.c **** #endif
 488:fb_question.c **** */
 489:fb_question.c **** 		//if(p_selectedSprite == &spriteLEAF) //NoGo
 490:fb_question.c **** 		{
 491:fb_question.c **** #if(defined(AUTO_KILL_GOOMBA) && AUTO_KILL_GOOMBA)
 492:fb_question.c **** 			if( (p_nowSprite == &spriteGOOMBA)
 493:fb_question.c **** 				 && (qCount >= 60) )
 494:fb_question.c **** 				fbQuestion_hitDetected();
 495:fb_question.c **** #endif
 496:fb_question.c **** 
 497:fb_question.c **** 
 498:fb_question.c **** 
 499:fb_question.c **** 			nowSpriteState.count = qCount;
 1595               		.stabn	68,0,499,.LM165-.LFBB15
 1596               	.LM165:
 1597 0600 8091 0000 		lds r24,qCount
 1598 0604 8093 0000 		sts nowSpriteState+4,r24
 500:fb_question.c **** 			cameraState.count = qCount;
 1599               		.stabn	68,0,500,.LM166-.LFBB15
 1600               	.LM166:
 1601 0608 8093 0000 		sts cameraState+4,r24
 501:fb_question.c **** 			//Override for now...
 502:fb_question.c **** 			//otherSpriteState.count=0;
 503:fb_question.c **** 
 504:fb_question.c **** 			fbQ_drawBackground(&nowSpriteState);
 1602               		.stabn	68,0,504,.LM167-.LFBB15
 1603               	.LM167:
 1604 060c 80E0      		ldi r24,lo8(nowSpriteState)
 1605 060e 90E0      		ldi r25,hi8(nowSpriteState)
 1606 0610 00D0      		rcall fbQ_drawBackground
 505:fb_question.c **** 
 506:fb_question.c **** 			fbQ_repositionSprite(&nowSpriteState);
 1607               		.stabn	68,0,506,.LM168-.LFBB15
 1608               	.LM168:
 1609 0612 80E0      		ldi r24,lo8(nowSpriteState)
 1610 0614 90E0      		ldi r25,hi8(nowSpriteState)
 1611 0616 00D0      		rcall fbQ_repositionSprite
 507:fb_question.c **** 			fbQ_repositionSprite(&cameraState);
 1612               		.stabn	68,0,507,.LM169-.LFBB15
 1613               	.LM169:
 1614 0618 80E0      		ldi r24,lo8(cameraState)
 1615 061a 90E0      		ldi r25,hi8(cameraState)
 1616 061c 00D0      		rcall fbQ_repositionSprite
 508:fb_question.c **** 			// "otherSpriteState" needn't be repositioned, it's always
 509:fb_question.c **** 			// SOLID (if used, only during a Reward)
 510:fb_question.c **** 
 511:fb_question.c **** 			if(nowIsReward)
 1617               		.stabn	68,0,511,.LM170-.LFBB15
 1618               	.LM170:
 1619 061e 8091 0000 		lds r24,nowIsReward
 1620 0622 8823      		tst r24
 1621 0624 01F0      		breq .L85
 512:fb_question.c **** 			{
 513:fb_question.c **** 				//0 is foreground, so it should be drawn last
 514:fb_question.c **** 				if(!GET_LAYER(nowSpriteState.layer, nowSpriteState.count))
 1622               		.stabn	68,0,514,.LM171-.LFBB15
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 55


 1623               	.LM171:
 1624 0626 E091 0000 		lds r30,nowSpriteState+5
 1625 062a F091 0000 		lds r31,nowSpriteState+5+1
 1626 062e 3097      		sbiw r30,0
 1627 0630 01F0      		breq .L86
 1628               	.LBB162:
 1629               		.stabn	68,0,514,.LM172-.LFBB15
 1630               	.LM172:
 1631 0632 8091 0000 		lds r24,nowSpriteState+4
 1632 0636 982F      		mov r25,r24
 1633 0638 9695      		lsr r25
 1634 063a 9695      		lsr r25
 1635 063c 9695      		lsr r25
 1636 063e E90F      		add r30,r25
 1637 0640 F11D      		adc r31,__zero_reg__
 1638               	/* #APP */
 1639               	 ;  514 "fb_question.c" 1
 1640 0642 E491      		lpm r30, Z
 1641               		
 1642               	 ;  0 "" 2
 1643               	/* #NOAPP */
 1644               	.LBE162:
 1645 0644 F0E0      		ldi r31,0
 1646 0646 8770      		andi r24,lo8(7)
 1647 0648 00C0      		rjmp 2f
 1648               		1:
 1649 064a F595      		asr r31
 1650 064c E795      		ror r30
 1651               		2:
 1652 064e 8A95      		dec r24
 1653 0650 02F4      		brpl 1b
 1654 0652 E0FD      		sbrc r30,0
 1655 0654 00C0      		rjmp .L87
 1656               	.L86:
 515:fb_question.c **** 				{
 516:fb_question.c **** 					//imageChangedTillRow =
 517:fb_question.c **** 					//fbQ_overlaySprite(p_selectedSprite, selectedSpritePosition);
 518:fb_question.c **** 					fbQ_overlaySprite(&spriteSOLID, NULL); //&otherSpriteState);
 1657               		.stabn	68,0,518,.LM173-.LFBB15
 1658               	.LM173:
 1659 0656 60E0      		ldi r22,0
 1660 0658 70E0      		ldi r23,0
 1661 065a 80E0      		ldi r24,lo8(spriteSOLID)
 1662 065c 90E0      		ldi r25,hi8(spriteSOLID)
 1663 065e 00D0      		rcall fbQ_overlaySprite
 1664 0660 00C0      		rjmp .L85
 1665               	.L87:
 519:fb_question.c **** 
 520:fb_question.c **** 					imageChangedTillRow =
 521:fb_question.c **** 						fbQ_overlaySprite(p_nowSprite, &nowSpriteState);
 522:fb_question.c **** 				}
 523:fb_question.c **** 				else
 524:fb_question.c **** 				{
 525:fb_question.c **** 					imageChangedTillRow =
 526:fb_question.c **** 						fbQ_overlaySprite(p_nowSprite, &nowSpriteState);
 1666               		.stabn	68,0,526,.LM174-.LFBB15
 1667               	.LM174:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 56


 1668 0662 60E0      		ldi r22,lo8(nowSpriteState)
 1669 0664 70E0      		ldi r23,hi8(nowSpriteState)
 1670 0666 8091 0000 		lds r24,p_nowSprite
 1671 066a 9091 0000 		lds r25,p_nowSprite+1
 1672 066e 00D0      		rcall fbQ_overlaySprite
 1673 0670 C82F      		mov r28,r24
 527:fb_question.c **** 				
 528:fb_question.c **** 					//imageChangedTillRow =
 529:fb_question.c **** 					//fbQ_overlaySprite(p_selectedSprite, selectedSpritePosition);
 530:fb_question.c **** 					fbQ_overlaySprite(&spriteSOLID, NULL); //&otherSpriteState);
 1674               		.stabn	68,0,530,.LM175-.LFBB15
 1675               	.LM175:
 1676 0672 60E0      		ldi r22,0
 1677 0674 70E0      		ldi r23,0
 1678 0676 80E0      		ldi r24,lo8(spriteSOLID)
 1679 0678 90E0      		ldi r25,hi8(spriteSOLID)
 1680 067a 00D0      		rcall fbQ_overlaySprite
 1681 067c 00C0      		rjmp .L88
 1682               	.L85:
 531:fb_question.c **** 
 532:fb_question.c **** 				}
 533:fb_question.c **** 			}
 534:fb_question.c **** 			else //Not a reward, so only one sprite is drawn...
 535:fb_question.c **** 			{
 536:fb_question.c **** 				imageChangedTillRow =
 537:fb_question.c **** 					fbQ_overlaySprite(p_nowSprite, &nowSpriteState);
 1683               		.stabn	68,0,537,.LM176-.LFBB15
 1684               	.LM176:
 1685 067e 60E0      		ldi r22,lo8(nowSpriteState)
 1686 0680 70E0      		ldi r23,hi8(nowSpriteState)
 1687 0682 8091 0000 		lds r24,p_nowSprite
 1688 0686 9091 0000 		lds r25,p_nowSprite+1
 1689 068a 00D0      		rcall fbQ_overlaySprite
 1690 068c C82F      		mov r28,r24
 1691               	.L88:
 538:fb_question.c **** 			}
 539:fb_question.c **** 
 540:fb_question.c **** 			qCount++;
 1692               		.stabn	68,0,540,.LM177-.LFBB15
 1693               	.LM177:
 1694 068e 9091 0000 		lds r25,qCount
 1695 0692 9F5F      		subi r25,lo8(-(1))
 1696 0694 9093 0000 		sts qCount,r25
 541:fb_question.c **** 			//Could, e.g., test for a hard-coded value...
 542:fb_question.c **** /*#if(defined(MOTION_BIGGIE) && MOTION_BIGGIE)
 543:fb_question.c **** 			if(qCount >= (sizeof(DefaultY)*4))
 544:fb_question.c **** #else
 545:fb_question.c **** 			if(qCount >= (sizeof(LeafX)*4))
 546:fb_question.c **** #endif
 547:fb_question.c **** */
 548:fb_question.c **** 			if(qCount >= p_nowSprite->totalCount)
 1697               		.stabn	68,0,548,.LM178-.LFBB15
 1698               	.LM178:
 1699 0698 E091 0000 		lds r30,p_nowSprite
 1700 069c F091 0000 		lds r31,p_nowSprite+1
 1701 06a0 3796      		adiw r30,7
 1702 06a2 8491      		lpm r24,Z
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 57


 1703 06a4 9817      		cp r25,r24
 1704 06a6 00F0      		brlo .L89
 549:fb_question.c **** 			{
 550:fb_question.c **** 				qCount = 0;
 1705               		.stabn	68,0,550,.LM179-.LFBB15
 1706               	.LM179:
 1707 06a8 1092 0000 		sts qCount,__zero_reg__
 551:fb_question.c **** 				prepNextSprite();
 1708               		.stabn	68,0,551,.LM180-.LFBB15
 1709               	.LM180:
 1710 06ac 00D0      		rcall prepNextSprite
 1711               	.L89:
 552:fb_question.c **** /*
 553:fb_question.c **** #define LEAF_REPEAT	TRUE
 554:fb_question.c **** #if(!defined(LEAF_REPEAT) || !LEAF_REPEAT)
 555:fb_question.c **** 				p_selectedSprite = p_nextSprite;
 556:fb_question.c **** 				p_nextSprite = NULL;
 557:fb_question.c **** #endif
 558:fb_question.c **** */
 559:fb_question.c **** 			}
 560:fb_question.c **** 			return imageChangedTillRow; 
 561:fb_question.c **** 		}
 562:fb_question.c **** /*
 563:fb_question.c **** 		//Transitioning from the Question-box to the next sprite
 564:fb_question.c **** 		else if(p_selectedSprite == &spriteQ) 
 565:fb_question.c **** 		{
 566:fb_question.c **** 			uint8_t spriteRow;
 567:fb_question.c **** 
 568:fb_question.c **** 			//Draw the top of the next sprite...
 569:fb_question.c **** 			for(qRow=0; qRow<qCount; qRow++)
 570:fb_question.c **** 			{
 571:fb_question.c **** 				spriteRow = qRow - (16 - qCount);
 572:fb_question.c **** 				if(drawSpriteRow(p_nextSprite, qCount, spriteRow, qRow))
 573:fb_question.c **** 					imageChangedTillRow = qRow;
 574:fb_question.c **** 			}
 575:fb_question.c **** 		
 576:fb_question.c **** 			//This is kinda hokey, but should work...
 577:fb_question.c **** 			// rather than displaying the "?" after it's been hit, it should
 578:fb_question.c **** 			// become solid... but in most cases using p_selectedSprite==SOLID
 579:fb_question.c **** 			// results in a transition straight to Q...
 580:fb_question.c **** 			// so rather than changing p_selectedSprite, let's just override
 581:fb_question.c **** 			// it here
 582:fb_question.c **** 			spriteRow = 0;
 583:fb_question.c **** 			for( ; qRow<Q_HEIGHT; qRow++)
 584:fb_question.c **** 			{
 585:fb_question.c **** 				if(drawSpriteRow(&spriteSOLID, qCount, spriteRow, qRow))
 586:fb_question.c **** 					imageChangedTillRow = qRow;
 587:fb_question.c **** 
 588:fb_question.c **** 				spriteRow++;
 589:fb_question.c **** 			}
 590:fb_question.c **** 			
 591:fb_question.c **** 		}
 592:fb_question.c **** 		//Transitioning back from a sprite to the question-box/solid
 593:fb_question.c **** 		else
 594:fb_question.c **** 		{
 595:fb_question.c **** 			uint8_t displayRow;
 596:fb_question.c **** 			uint8_t spriteRow = qCount; 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 58


 597:fb_question.c **** 
 598:fb_question.c **** 			for(displayRow = 0; displayRow < (Q_HEIGHT-qCount); displayRow++)
 599:fb_question.c **** 			{
 600:fb_question.c **** 				if(drawSpriteRow(p_selectedSprite,qCount,spriteRow,displayRow))
 601:fb_question.c **** 					imageChangedTillRow = displayRow;
 602:fb_question.c **** 
 603:fb_question.c **** 									//				displayRow+qCount, displayRow);
 604:fb_question.c **** 				spriteRow++;
 605:fb_question.c **** 			}
 606:fb_question.c **** 	
 607:fb_question.c **** 			spriteRow = 0;
 608:fb_question.c **** 			for( ; displayRow<Q_HEIGHT; displayRow++)
 609:fb_question.c **** 			{
 610:fb_question.c **** 				if(drawSpriteRow(p_nextSprite, qCount, spriteRow, displayRow))
 611:fb_question.c **** 					imageChangedTillRow = displayRow;
 612:fb_question.c **** 
 613:fb_question.c **** 					//				displayRow-(Q_HEIGHT-1-qCount), displayRow);
 614:fb_question.c **** 
 615:fb_question.c **** 				spriteRow++;
 616:fb_question.c **** 			}
 617:fb_question.c **** 		}
 618:fb_question.c **** 
 619:fb_question.c **** 		//a/o v84: This bit's avoided with motionHandling due to return...
 620:fb_question.c **** 		qCount++;
 621:fb_question.c **** 		if(qCount >= Q_HEIGHT)
 622:fb_question.c **** 		{
 623:fb_question.c **** 			qCount = 0;
 624:fb_question.c **** 			p_selectedSprite = p_nextSprite;
 625:fb_question.c **** 			p_nextSprite = NULL;
 626:fb_question.c **** 		}
 627:fb_question.c **** 
 628:fb_question.c **** 	} //end of nextSprite Handling...
 629:fb_question.c **** 	else //we only have a selectedSprite (nextSprite is NULL)
 630:fb_question.c **** 	{
 631:fb_question.c **** 		setSpriteSkyColorOverride(NULL);
 632:fb_question.c **** 
 633:fb_question.c **** 		for(qRow=0; qRow<Q_HEIGHT; qRow++)
 634:fb_question.c **** 		{
 635:fb_question.c **** 			if(drawSpriteRow(p_selectedSprite, qCount, qRow, qRow))
 636:fb_question.c **** 				imageChangedTillRow = qRow; //TRUE;
 637:fb_question.c **** 		}
 638:fb_question.c **** 
 639:fb_question.c **** 		qCount++;
 640:fb_question.c **** 		//the only case where qCount should cycle is spriteQ...
 641:fb_question.c **** 		// its value is %12, so could either reset it at 12, or this.. whatev
 642:fb_question.c **** 		// To avoid a glitch every 21 cycles.
 643:fb_question.c **** 		if(qCount >= ((255 / 12) * 12))
 644:fb_question.c **** 			qCount = 0;
 645:fb_question.c **** 	}
 646:fb_question.c **** */
 647:fb_question.c **** 	return imageChangedTillRow;
 648:fb_question.c **** }
 1712               		.stabn	68,0,648,.LM181-.LFBB15
 1713               	.LM181:
 1714 06ae 8C2F      		mov r24,r28
 1715               	/* epilogue start */
 1716 06b0 CF91      		pop r28
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 59


 1717 06b2 0895      		ret
 1718               		.size	fbQuestion_update, .-fbQuestion_update
 1719               		.stabs	"imageChangedTillRow:r(4,1)",64,0,451,28
 1720               		.stabn	192,0,0,.LFBB15-.LFBB15
 1721               		.stabn	224,0,0,.Lscope15-.LFBB15
 1722               	.Lscope15:
 1723               		.stabs	"",36,0,0,.Lscope15-.LFBB15
 1724               		.stabd	78,0,0
 1725               		.stabs	"getSpritePalette:F(4,2)",36,0,650,getSpritePalette
 1726               		.stabs	"p_thisSprite:P(16,3)",64,0,650,18
 1727               		.stabs	"spritePhase:P(4,2)",64,0,650,24
 1728               		.stabs	"spriteRow:P(4,2)",64,0,651,20
 1729               	.global	getSpritePalette
 1730               		.type	getSpritePalette, @function
 1731               	getSpritePalette:
 1732               		.stabd	46,0,0
 649:fb_question.c **** 
 650:fb_question.c **** uint8_t getSpritePalette(const __flash sprite_t *p_thisSprite, uint8_t spritePhase,
 651:fb_question.c **** 																	uint8_t spriteRow)
 652:fb_question.c **** {
 1733               		.stabn	68,0,652,.LM182-.LFBB16
 1734               	.LM182:
 1735               	.LFBB16:
 1736               	/* prologue: function */
 1737               	/* frame size = 0 */
 1738               	/* stack size = 0 */
 1739               	.L__stack_usage = 0
 1740 06b4 9C01      		movw r18,r24
 1741 06b6 862F      		mov r24,r22
 653:fb_question.c **** 
 654:fb_question.c **** 	uint8_t thePalette;
 655:fb_question.c **** 	
 656:fb_question.c **** 	
 657:fb_question.c **** 	if(p_thisSprite == &spriteFLOWER)
 1742               		.stabn	68,0,657,.LM183-.LFBB16
 1743               	.LM183:
 1744 06b8 90E0      		ldi r25,hi8(spriteFLOWER)
 1745 06ba 2030      		cpi r18,lo8(spriteFLOWER)
 1746 06bc 3907      		cpc r19,r25
 1747 06be 01F4      		brne .L94
 658:fb_question.c **** 	{
 659:fb_question.c **** 		if(spriteRow<FLOWER_PALETTE1_ROW)
 1748               		.stabn	68,0,659,.LM184-.LFBB16
 1749               	.LM184:
 1750 06c0 4830      		cpi r20,lo8(8)
 1751 06c2 00F4      		brsh .L103
 660:fb_question.c **** 			//data = getGimpColorVal(&spriteFLOWER,
 661:fb_question.c **** 			  thePalette = spritePhase%(spriteFLOWER.numPalettes-1) + 1; 
 1752               		.stabn	68,0,661,.LM185-.LFBB16
 1753               	.LM185:
 1754 06c4 962F      		mov r25,r22
 1755 06c6 9170      		andi r25,lo8(1)
 1756 06c8 9F5F      		subi r25,lo8(-(1))
 1757 06ca 00C0      		rjmp .L95
 1758               	.L94:
 662:fb_question.c **** 					 //spriteRow, qCol);
 663:fb_question.c **** 		else
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 60


 664:fb_question.c **** 			thePalette = 0;
 665:fb_question.c **** 			//data = getGimpColorVal(&spriteFLOWER, 0, spriteRow, qCol);
 666:fb_question.c **** 	}
 667:fb_question.c **** 	else if(p_thisSprite == &spriteGOOMBA)
 1759               		.stabn	68,0,667,.LM186-.LFBB16
 1760               	.LM186:
 1761 06cc 90E0      		ldi r25,hi8(spriteGOOMBA)
 1762 06ce 2030      		cpi r18,lo8(spriteGOOMBA)
 1763 06d0 3907      		cpc r19,r25
 1764 06d2 01F4      		brne .L96
 668:fb_question.c **** 	{
 669:fb_question.c **** 		//uint8_t gCol = qCol;
 670:fb_question.c **** 		//Goomba moves by flipping horizontally...
 671:fb_question.c **** 	//	if((spritePhase < 16) && (spritePhase & 0x01))
 672:fb_question.c **** 	//		theCol = 15-qCol;
 673:fb_question.c **** 
 674:fb_question.c **** 		//uint8_t palette; // = qCount * p_thisSprite->numPalettes / 16;
 675:fb_question.c **** 		//if(palette >= p_thisSprite->numPalettes)
 676:fb_question.c **** 		//	palette = p_thisSprite->numPalettes-1;
 677:fb_question.c **** 
 678:fb_question.c **** 			
 679:fb_question.c **** 		switch(spritePhase)
 1765               		.stabn	68,0,679,.LM187-.LFBB16
 1766               	.LM187:
 1767 06d4 90E0      		ldi r25,0
 1768 06d6 8031      		cpi r24,16
 1769 06d8 9105      		cpc r25,__zero_reg__
 1770 06da 00F4      		brsh .L97
 1771 06dc FC01      		movw r30,r24
 1772 06de E050      		subi r30,lo8(-(gs(.L99)))
 1773 06e0 F040      		sbci r31,hi8(-(gs(.L99)))
 1774 06e2 0994      		ijmp
 1775               		.section	.progmem.gcc_sw_table,"ax",@progbits
 1776               		.p2align	1
 1777               	.L99:
 1778 0012 00C0      		rjmp .L103
 1779 0014 00C0      		rjmp .L103
 1780 0016 00C0      		rjmp .L103
 1781 0018 00C0      		rjmp .L103
 1782 001a 00C0      		rjmp .L104
 1783 001c 00C0      		rjmp .L104
 1784 001e 00C0      		rjmp .L104
 1785 0020 00C0      		rjmp .L100
 1786 0022 00C0      		rjmp .L100
 1787 0024 00C0      		rjmp .L100
 1788 0026 00C0      		rjmp .L101
 1789 0028 00C0      		rjmp .L101
 1790 002a 00C0      		rjmp .L101
 1791 002c 00C0      		rjmp .L102
 1792 002e 00C0      		rjmp .L102
 1793 0030 00C0      		rjmp .L102
 1794               		.text
 1795               	.L100:
 680:fb_question.c **** 		{
 681:fb_question.c **** 				case 0:
 682:fb_question.c **** 				case 1:
 683:fb_question.c **** 				case 2:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 61


 684:fb_question.c **** 				case 3:
 685:fb_question.c **** 					thePalette = 0;
 686:fb_question.c **** 					break;
 687:fb_question.c **** 				case 4:
 688:fb_question.c **** 				case 5:
 689:fb_question.c **** 				case 6:
 690:fb_question.c **** 					thePalette = 1;
 691:fb_question.c **** 					break;
 692:fb_question.c **** 				case 7:
 693:fb_question.c **** 				case 8:
 694:fb_question.c **** 				case 9:
 695:fb_question.c **** 					thePalette = 2;
 1796               		.stabn	68,0,695,.LM188-.LFBB16
 1797               	.LM188:
 1798 06e4 92E0      		ldi r25,lo8(2)
 696:fb_question.c **** 					break;
 1799               		.stabn	68,0,696,.LM189-.LFBB16
 1800               	.LM189:
 1801 06e6 00C0      		rjmp .L95
 1802               	.L101:
 697:fb_question.c **** 				case 10:
 698:fb_question.c **** 				case 11:
 699:fb_question.c **** 				case 12:
 700:fb_question.c **** 					thePalette = 3;
 1803               		.stabn	68,0,700,.LM190-.LFBB16
 1804               	.LM190:
 1805 06e8 93E0      		ldi r25,lo8(3)
 701:fb_question.c **** 					break;
 1806               		.stabn	68,0,701,.LM191-.LFBB16
 1807               	.LM191:
 1808 06ea 00C0      		rjmp .L95
 1809               	.L102:
 702:fb_question.c **** 				case 13:
 703:fb_question.c **** 				case 14:
 704:fb_question.c **** 				case 15:
 705:fb_question.c **** 					thePalette = 4;
 1810               		.stabn	68,0,705,.LM192-.LFBB16
 1811               	.LM192:
 1812 06ec 94E0      		ldi r25,lo8(4)
 706:fb_question.c **** 					break;
 1813               		.stabn	68,0,706,.LM193-.LFBB16
 1814               	.LM193:
 1815 06ee 00C0      		rjmp .L95
 1816               	.L97:
 707:fb_question.c **** 				default:
 708:fb_question.c **** 					thePalette = p_thisSprite->numPalettes-1;
 1817               		.stabn	68,0,708,.LM194-.LFBB16
 1818               	.LM194:
 1819 06f0 95E0      		ldi r25,lo8(5)
 1820 06f2 00C0      		rjmp .L95
 1821               	.L96:
 709:fb_question.c **** 		}
 710:fb_question.c **** 
 711:fb_question.c **** 
 712:fb_question.c **** 		//data = getGimpColorVal(&spriteGOOMBA, palette, spriteRow, gCol);
 713:fb_question.c **** 	}
 714:fb_question.c **** 	else
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 62


 715:fb_question.c **** 	{
 716:fb_question.c **** 		//data = getGimpColorVal(p_thisSprite, 
 717:fb_question.c **** 		  thePalette = spritePhase%p_thisSprite->numPalettes;
 1822               		.stabn	68,0,717,.LM195-.LFBB16
 1823               	.LM195:
 1824 06f4 F901      		movw r30,r18
 1825 06f6 3696      		adiw r30,6
 1826 06f8 6491      		lpm r22,Z
 1827 06fa 00D0      		rcall __udivmodqi4
 1828 06fc 00C0      		rjmp .L95
 1829               	.L103:
 664:fb_question.c **** 			//data = getGimpColorVal(&spriteFLOWER, 0, spriteRow, qCol);
 1830               		.stabn	68,0,664,.LM196-.LFBB16
 1831               	.LM196:
 1832 06fe 90E0      		ldi r25,0
 1833 0700 00C0      		rjmp .L95
 1834               	.L104:
 690:fb_question.c **** 					break;
 1835               		.stabn	68,0,690,.LM197-.LFBB16
 1836               	.LM197:
 1837 0702 91E0      		ldi r25,lo8(1)
 1838               	.L95:
 718:fb_question.c **** 						//spriteRow, qCol);
 719:fb_question.c **** 	}
 720:fb_question.c **** 
 721:fb_question.c **** 	return thePalette;
 722:fb_question.c **** }
 1839               		.stabn	68,0,722,.LM198-.LFBB16
 1840               	.LM198:
 1841 0704 892F      		mov r24,r25
 1842 0706 0895      		ret
 1843               		.size	getSpritePalette, .-getSpritePalette
 1844               		.stabs	"thePalette:r(4,2)",64,0,654,25
 1845               		.stabn	192,0,0,.LFBB16-.LFBB16
 1846               		.stabn	224,0,0,.Lscope16-.LFBB16
 1847               	.Lscope16:
 1848               		.stabs	"",36,0,0,.Lscope16-.LFBB16
 1849               		.stabd	78,0,0
 1850               		.stabs	"getSpritePhase:F(4,2)",36,0,728,getSpritePhase
 1851               		.stabs	"p_thisSprite:P(16,3)",64,0,728,18
 1852               		.stabs	"qCount:P(4,2)",64,0,728,24
 1853               		.stabs	"vOffset:P(4,1)",64,0,729,20
 1854               	.global	getSpritePhase
 1855               		.type	getSpritePhase, @function
 1856               	getSpritePhase:
 1857               		.stabd	46,0,0
 723:fb_question.c **** 
 724:fb_question.c **** //This does NOT handle COIN, see getRowPixelValCOIN()...
 725:fb_question.c **** // vOffset is whether the sprite is above the frame-buffer or below...
 726:fb_question.c **** // centered = 0
 727:fb_question.c **** // so, e.g. vOffset = spriteRow - rowToDrawAt
 728:fb_question.c **** uint8_t getSpritePhase(const __flash sprite_t *p_thisSprite, uint8_t qCount, int8_t
 729:fb_question.c **** 		vOffset)
 730:fb_question.c **** {
 1858               		.stabn	68,0,730,.LM199-.LFBB17
 1859               	.LM199:
 1860               	.LFBB17:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 63


 1861               	/* prologue: function */
 1862               	/* frame size = 0 */
 1863               	/* stack size = 0 */
 1864               	.L__stack_usage = 0
 1865 0708 9C01      		movw r18,r24
 1866 070a 862F      		mov r24,r22
 731:fb_question.c **** 	uint8_t spritePhase = qCount;
 732:fb_question.c **** 
 733:fb_question.c **** 	if(p_thisSprite == &spriteQ)
 1867               		.stabn	68,0,733,.LM200-.LFBB17
 1868               	.LM200:
 1869 070c 90E0      		ldi r25,hi8(spriteQ)
 1870 070e 2030      		cpi r18,lo8(spriteQ)
 1871 0710 3907      		cpc r19,r25
 1872 0712 01F4      		brne .L106
 734:fb_question.c **** 	{
 735:fb_question.c **** 		switch(spritePhase%12)
 1873               		.stabn	68,0,735,.LM201-.LFBB17
 1874               	.LM201:
 1875 0714 6CE0      		ldi r22,lo8(12)
 1876 0716 00D0      		rcall __udivmodqi4
 1877 0718 892F      		mov r24,r25
 1878 071a 90E0      		ldi r25,0
 1879 071c 8C30      		cpi r24,12
 1880 071e 9105      		cpc r25,__zero_reg__
 1881 0720 00F4      		brsh .L107
 1882 0722 FC01      		movw r30,r24
 1883 0724 E050      		subi r30,lo8(-(gs(.L109)))
 1884 0726 F040      		sbci r31,hi8(-(gs(.L109)))
 1885 0728 0994      		ijmp
 1886               		.section	.progmem.gcc_sw_table,"ax",@progbits
 1887               		.p2align	1
 1888               	.L109:
 1889 0032 00C0      		rjmp .L108
 1890 0034 00C0      		rjmp .L108
 1891 0036 00C0      		rjmp .L108
 1892 0038 00C0      		rjmp .L112
 1893 003a 00C0      		rjmp .L112
 1894 003c 00C0      		rjmp .L107
 1895 003e 00C0      		rjmp .L107
 1896 0040 00C0      		rjmp .L112
 1897 0042 00C0      		rjmp .L112
 1898 0044 00C0      		rjmp .L108
 1899 0046 00C0      		rjmp .L108
 1900 0048 00C0      		rjmp .L108
 1901               		.text
 1902               	.L108:
 736:fb_question.c **** 		{
 737:fb_question.c **** 			case 0:
 738:fb_question.c **** 			case 1:
 739:fb_question.c **** 			case 2:
 740:fb_question.c **** 
 741:fb_question.c **** 			case 9:
 742:fb_question.c **** 			case 10:
 743:fb_question.c **** 			case 11:
 744:fb_question.c **** 				spritePhase = 0; //yellow background
 1903               		.stabn	68,0,744,.LM202-.LFBB17
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 64


 1904               	.LM202:
 1905 072a 80E0      		ldi r24,0
 1906 072c 0895      		ret
 1907               	.L107:
 745:fb_question.c **** 				break;
 746:fb_question.c **** 			case 3:
 747:fb_question.c **** 			case 4:
 748:fb_question.c **** 
 749:fb_question.c **** 			case 7:
 750:fb_question.c **** 			case 8:
 751:fb_question.c **** 				spritePhase = 1; //red background
 752:fb_question.c **** 				break;
 753:fb_question.c **** 			case 5:
 754:fb_question.c **** 			case 6:
 755:fb_question.c **** 
 756:fb_question.c **** 			default:
 757:fb_question.c **** 				spritePhase = 2; //brown background
 1908               		.stabn	68,0,757,.LM203-.LFBB17
 1909               	.LM203:
 1910 072e 82E0      		ldi r24,lo8(2)
 758:fb_question.c **** 				break;
 1911               		.stabn	68,0,758,.LM204-.LFBB17
 1912               	.LM204:
 1913 0730 0895      		ret
 1914               	.L106:
 759:fb_question.c **** 		}
 760:fb_question.c **** 
 761:fb_question.c **** 	}
 762:fb_question.c **** 	//else if(p_thisSprite == &spriteCOIN) //handled in getRowPixelValCOIN()
 763:fb_question.c **** 	else if(p_thisSprite == &spriteGOOMBA)
 1915               		.stabn	68,0,763,.LM205-.LFBB17
 1916               	.LM205:
 1917 0732 2050      		subi r18,lo8(spriteGOOMBA)
 1918 0734 3040      		sbci r19,hi8(spriteGOOMBA)
 1919 0736 01F4      		brne .L110
 764:fb_question.c **** 	{
 765:fb_question.c **** 		if (vOffset < 0) //(spriteRow < rowToDrawAt)
 1920               		.stabn	68,0,765,.LM206-.LFBB17
 1921               	.LM206:
 1922 0738 47FD      		sbrc r20,7
 1923 073a 00C0      		rjmp .L113
 766:fb_question.c **** 			spritePhase = 0;
 767:fb_question.c **** 		if (vOffset > 0) //(spriteRow > rowToDrawAt)
 1924               		.stabn	68,0,767,.LM207-.LFBB17
 1925               	.LM207:
 1926 073c 4111      		cpse r20,__zero_reg__
 1927 073e 00C0      		rjmp .L114
 1928 0740 00C0      		rjmp .L111
 1929               	.L113:
 766:fb_question.c **** 			spritePhase = 0;
 1930               		.stabn	68,0,766,.LM208-.LFBB17
 1931               	.LM208:
 1932 0742 80E0      		ldi r24,0
 1933               	.L111:
 768:fb_question.c **** 			spritePhase = GOOMBA_QCOUNT;
 769:fb_question.c **** 		else
 770:fb_question.c **** 			spritePhase /=3;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 65


 1934               		.stabn	68,0,770,.LM209-.LFBB17
 1935               	.LM209:
 1936 0744 63E0      		ldi r22,lo8(3)
 1937 0746 00D0      		rcall __udivmodqi4
 1938 0748 0895      		ret
 1939               	.L112:
 751:fb_question.c **** 				break;
 1940               		.stabn	68,0,751,.LM210-.LFBB17
 1941               	.LM210:
 1942 074a 81E0      		ldi r24,lo8(1)
 1943 074c 0895      		ret
 1944               	.L114:
 768:fb_question.c **** 			spritePhase = GOOMBA_QCOUNT;
 1945               		.stabn	68,0,768,.LM211-.LFBB17
 1946               	.LM211:
 1947 074e 80E5      		ldi r24,lo8(80)
 1948               	.L110:
 771:fb_question.c **** 
 772:fb_question.c **** 	}
 773:fb_question.c **** 
 774:fb_question.c **** 	return spritePhase;
 775:fb_question.c **** 
 776:fb_question.c **** }
 1949               		.stabn	68,0,776,.LM212-.LFBB17
 1950               	.LM212:
 1951 0750 0895      		ret
 1952               		.size	getSpritePhase, .-getSpritePhase
 1953               	.Lscope17:
 1954               		.stabs	"",36,0,0,.Lscope17-.LFBB17
 1955               		.stabd	78,0,0
 1956               		.stabs	"lcd_init:F(0,47)",36,0,1022,lcd_init
 1957               	.global	lcd_init
 1958               		.type	lcd_init, @function
 1959               	lcd_init:
 1960               		.stabd	46,0,0
 1961               		.stabs	"_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c",132,0,0,.Ltext13
 1962               	.Ltext13:
   1:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** /* mehPL:
   2:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  *    Please see the bottom.
   5:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  *    Enjoy!
   6:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  */
   7:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
   8:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
   9:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //lcdStuff 0.80ncf-2
  10:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
  11:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.80ncf-2 - Fixing vsync-case which went back to Nada...
  12:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            e.g. for bit-banged parallel-LCD and/or SDRAMthing
  13:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            TODO: Remove other case (for SDRAMthing)
  14:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.80ncf-1 - Adding LCDSTUFF_INCLUDE_NON_DE
  15:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            This is the same as LCDSTUFF_NOT_IN_TIMER, except
  16:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            better-named. This calls DE_DotDelay(), etc. even when in a
  17:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            vertical-blanking-period.
  18:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            This, a/o LCDdirectLVDS81 in order to use a dot-clock that
  19:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            *isn't* timer-based (e.g. bit-banged)
  20:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            ALSO replacing delay_cycs with delay_Dots in relevent
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 66


  21:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            sections
  22:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.80ncf - drawPixSetup function, for large-calculations to occur *before*
  23:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          Hsync (a/o LCDdirectLVDS-80, for non-DE display)
  24:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.70ncf-1 - swapping halves in BLUE_DIAG_BAR so the sync position can be
  25:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //				  seen...
  26:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            Also in BLUE_DIAG_BAR_SCROLL
  27:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            BUT NOT (TODO?) In others...
  28:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.70ncf - a/o LCDdirectLVDS-80, in which we attempt to run a NON LVDS
  29:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //				display...
  30:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          First step was creating new *separate* files for each display's
  31:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          timing parameters...
  32:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          This *discontinues* the need for #define DISPLAY TESTVALS, etc.
  33:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          So, ultimately, TODO: move _displays/ here
  34:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          Until then, disable DISPLAY default, here...
  35:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          ACTUALLY: Apparently just forgot to disable assignment of
  36:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          DE_ACTIVE_DOTS if it's already defined...
  37:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          So, DISPLAY is still set, but not used anywhere...
  38:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.60ncf - continuation of 0.56ncf-2 (which was untested)
  39:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          standardizing function names... updateLCD() -> lcd_update()
  40:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          lcdInit() -> lcd_init()
  41:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          lcd_update() now returns Row Number
  42:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.56ncf-2 - a/o LCDdirectLVDSv73:
  43:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            fixing lcd_init() to reset hsyncCount and dataEnable
  44:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            so it can be used to start a new frame prior to finishing the
  45:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            last
  46:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            NOT TESTED, SEE 0.60
  47:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.56ncf-1 - reuninstating loadRow in lcdUpdate()
  48:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            apparently it's handled in LCDdirectLVDS itself
  49:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            And maybe it's better that way...
  50:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            SO NOW: aside from a few notes about loadRow, this is
  51:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            identical to 0.55ncf-2
  52:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.56ncf - reinstating loadRow in lcdUpdate()
  53:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          a/o LCDdirectLVDS70 for working with the rowBuffer
  54:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          TODOne: How is it that it was removed so long ago... wasn't I
  55:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          using rowSegBuffer then, still...? (see above)
  56:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.55ncf-2 - a/o LCDdirectLVDS67:
  57:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            Adding notes to loadData() re: transitions...
  58:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            TODO: it's still a little unclear...
  59:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.55ncf-1 - adding BLUE_DIAG_SCROLL_FLASH
  60:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.55ncf - drawPix had uint8_t rowNum... switching to uint16_t
  61:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          a/o LCDdirectLVDS-62 (attempting to use DE_BLUE with ChiMei
  62:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          display)
  63:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          Also added BLUE_DIAG_BAR_SCROLL
  64:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.52ncf-1 - Adding notes re: old mental hurdles.
  65:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.52ncf - getting rid of git in this directory...
  66:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.51ncf-git-1ish Adding a few notes remaining from LCDdirectLVDS:
  67:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //						"SCOPING has been removed in LVDS, revisit LCDdirect50"
  68:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.51ncf-git first attempt at using git for uploading to googleCode...
  69:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        this version isn't yet used by any projects
  70:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.50ncf cleanup, colorOverride is unused...
  71:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //				SMILEY -> LCD_SMILEY
  72:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.40ncf-1 loadRow unused... removal untested...
  73:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.40ncf drawPix...
  74:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.30ncf-6 HSYNC_INACTIVE, etc. definable elsewhere
  75:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.30ncf-5 Adding BLUE_VERT_BAR_REVERSED
  76:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.30ncf-4 Adding NOTES: DON'T START WITH BLUE_DIAG_BAR
  77:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.30ncf-3 T_DV and T_Vlow overrideable
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 67


  78:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.30ncf-2 Not sure if I've modified it between... but here: 
  79:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        FRAME_COUNT_TO_DELAY wasn't defined, giving warnings
  80:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.30ncf-1 updateLCD() has return-values for state-switches
  81:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          (VFP, VSync, VBP, DE)
  82:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        ACTUALLY, that's unnecessary... state-transitions can be
  83:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        determined by vSync and dataEnable...
  84:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.30ncf Haven't been keeping these backed up regularly...
  85:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        More toward realtime adjustable timing values
  86:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        V Front Porch now occurs at the beginning of the frame, instead
  87:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        of at the end...
  88:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
  89:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.20ncf More Timing Value experiment preparation... 
  90:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.10ncf-3ish looking into reloading methods for e.g. experimenting with
  91:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          timing values: sdramThing2.0-7
  92:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          How to "move" timing-values around data which needn't be
  93:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          changed...
  94:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.10ncf-andsomemore
  95:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          Added MAKELONG to fix integer overflow warnings
  96:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          Revised it from "... + MAKELONG" to "MAKELONG(...)"
  97:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          (The +MAKELONG version is lost in the ether... if you *really*
  98:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //           want it, there's a localized version in sdramThing2.0-6)
  99:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.10ncf-1ish - Adding HSYNC_COUNT_FRAME_COMPLETE
 100:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //               Removal of LVDS_PRESCALER stuff...
 101:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //0.10ncf - Stolen from LCDdirectLVDS/54-moreColorStuff/main.c
 102:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          Removal of LCDdirectLVDS-specific stuff...
 103:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //				A little bit of rewriting of notes to be more generalized
 104:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          All delay_cyc references replaced with delay_Dots,
 105:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //					math changed accordingly...
 106:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 107:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 108:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // I hereby declare this FPD-Link simulation technique to forever be called
 109:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  PW-BANGing
 110:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 111:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // a/o 0.10ncf-4: (sdramThing2.0v8-28)
 112:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   DON'T START WITH BLUE_DIAG_BAR
 113:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Unless you want to be depressed
 114:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Good Starting Point DE_BLUE
 115:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 116:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 117:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 118:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // GENERAL TIMING NOTES
 119:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // a/o 0.52ncf-1:
 120:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Upon revisiting an ancient display controller project I did 15 years
 121:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   ago, I'm finding myself falling into similar thought-hurdles I had
 122:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   the first go-round with a graphic LCD display... so here're some
 123:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   concepts:
 124:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 125:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Most graphical displays without onboard memory have basically these 
 126:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // same signals:
 127:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 128:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //	Pixel Clock: Each clock-pulse *generally* corresponds to one pixel...
 129:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Whether these clock-pulses are used for drawing actual pixels, or
 130:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   otherwise...
 131:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 132:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Horizontal Sync: Each time the Hsync pin is active, the display starts a
 133:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // 	new row. It syncs up the pixels horizontally, at the left of the
 134:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // 	screen.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 68


 135:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 136:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   (This was one of my biggest mental-hurdles from those old days...
 137:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    aided by the fact that my display's timing-chips had different names
 138:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    for the Pixexl-Clock, Hsync, and Vsync pins.) 
 139:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Hsync is only pulsed *once* at the *beginning* of each row. 
 140:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   It is *not* pulsed with each pixel. It syncs the edge of the
 141:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   pixel-data with the edge of the screen.
 142:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 143:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Vertical Sync: Each time the Vsync pin is active, the display starts a
 144:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // new frame. It syncs the pixel-data with the top of the screen.
 145:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 146:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (Data Enable: This tells the (usually LCD) display that actual pixels
 147:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  are now being transmitted. It's a bit redundant, and some displays,
 148:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  especially older non-TFT displays don't even have it. 
 149:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Some newer TFT displays *only* use Data-Enable, determining the
 150:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  horizontal and vertical positions of the pixels based on the delay
 151:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  between Data-Enable pulses).
 152:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 153:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // I can't recall what the names were on my old display... but they were
 154:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // danged confusing. Especially to someone who'd never messed with graphics
 155:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // prior and had to reverse-engineer the whole thing. 
 156:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Oh yes, here they are: CPX, Frame, and Load. 
 157:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 158:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // As far as these three signals (Pixel Clock, Hsync, and Vsync):
 159:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  The actual timing-requirements may vary from display to display.
 160:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  But, it's pretty-well-established that for most displays these signals
 161:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  remain pretty constant. For example, an Hsync pulse may arrive at a
 162:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  specific rate (the duration of a "row"). Vsync, therefore, remains
 163:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  active for a number of "rows", even though no pixel-data is being sent
 164:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  during this time. And, again, even though no pixel-data is being sent,
 165:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  the Hsync pulse still occurs at the same rate it would if pixels were
 166:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  being drawn.
 167:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 168:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  This, I guess, is a remnant of ancient times, probably something to do
 169:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  with analog TV signals... the durations necessary for the electro-
 170:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  magnets to be moved from one side of the screen to the next, and the
 171:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  time necessary to move them again from top-to-bottom.
 172:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 173:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  In this digital era, it doesn't seem these timings would be necessary,
 174:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  and, in fact, most displays I've gotten working are highly tolerant of
 175:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  timing that doesn't match this rigidity.
 176:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 177:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  E.G. my *ancient* LCD project was designed long before I understood
 178:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  these "standard" timing specifications. As I recall, I don't have any
 179:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  delays between the "Frame" signal indicating the beginning of the next
 180:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  frame and the "Load" signal indicating the beginning of the first row
 181:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  of data. Certainly not several "rows" of Frame (aka Vsync)
 182:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  pulse-active.
 183:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 184:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Further, most of these standardized timings involve "porches", both
 185:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  front and back. The "Horizontal Front Porch" is the time between the
 186:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  end of a row and the Hsync signal. The "Horizontal Back Porch" is the
 187:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  time between the Hsync signal and the beginning of the actual 
 188:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  pixel-data. During these "porches", no pixel-data is sent, and the
 189:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Hsync signal is not active. Again, in the digital era these are pretty
 190:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  much unnecessary, but some displays still rely on them, and most
 191:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  specify timing-values for them.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 69


 192:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 193:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 194:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 195:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //new notes a/o 0.10ncf-3ish:
 196:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // The basic idea is that timing is something that needs to be experimented
 197:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // with, often... so, for cases where LCD timing/drawing data is loaded
 198:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // beforehand (e.g. sdramThing2.0-7), it would be nice not to have to
 199:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // reload *all* the data, only to change the necessary timing data
 200:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 201:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Neglecting the SDRAM for a second, we have essentially:
 202:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (The exact placement is not necessarily in order... e.g. DH_DOTS could
 203:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  be at the end of a row, or at the beginning... VSYNC rows could be at
 204:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  the top, or at the bottom.....)
 205:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (See also notes "Here's how it worked pre-lvds:", which actually are a
 206:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   bit off, e.g. I don't think VSYNC L->H was delayed by DE_TIME after
 207:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Hsync)
 208:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 209:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // H_LOW_DOTS + HD_DOTS + DH_DOTS = "Horizontal Blank Time"
 210:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (This "front/back" thing always confused me...
 211:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  DH_DOTS is *in front of* Hsync as far as *time* is concerned...
 212:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  i.e. looking at a 'scope trace... But something about reading left-to-
 213:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  right causes me to feel like "front" is the furthest to the right
 214:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  which would be *later* in time... weird.
 215:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  
 216:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 217:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        |--|<--H_LOW_DOTS                       "Horiz Front Porch"
 218:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        |  |--|<--HD_DOTS="Horiz Back Porch"    |<---->|<--DH_DOTS
 219:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        |  .  .                                 .      |
 220:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        |<............................................./
 221:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        |  .  .                                 .    
 222:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        v  v  .                                 .      
 223:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     /V _______________________________________________  \ VSYNC Rows
 224:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     /H |__|
 225:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     DE _______________________________________________  /  T_Vlow times)
 226:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              .                                 .
 227:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              .                                 .      "Vsync Back Porch"
 228:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     /V 
 229:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     /H |__|
 230:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     DE _______________________________________________  /  T_VD times)
 231:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              .                                 .         "Vbp should be
 232:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              v                                 v          static"
 233:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              ***********************************
 234:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              *                                 *
 235:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     /V 
 236:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     /H |__|
 237:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     DE ______||______   /
 238:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              *                                 *
 239:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              *<------ DE_ACTIVE_DOTS --------->*        (Repeat V_COUNT
 240:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              *      .                          *         =1024 times)
 241:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                     .   Displayed Pixels
 242:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              *      .                          *
 243:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              *                                 *
 244:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              *                                 *
 245:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     /V 
 246:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     /H |__|
 247:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     DE ______||______   /
 248:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              *                                 *
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 70


 249:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              ***********************************      
 250:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                                                      "Vsync Front Porch"
 251:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     /V 
 252:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     /H |__|
 253:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     DE _______________________________________________  /  T_DV times)
 254:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 255:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 256:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #warning "TODO Maybe: LCDdirectLVDS (which so far is the only version which synced with such low re
 257:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 258:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Front vs. Back porches....
 259:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   If I were to draw a car driving down a street... 
 260:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   I would draw it with its front to the right, driving to the right...
 261:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 262:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       _____/\________     \O/
 263:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   ...|__   _________   __\     |
 264:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      ...\_/         \_/       / \							//
 265:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 266:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   The person is *in front of* the car... which means the car has not yet
 267:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   arrived at the person, but will soon... 
 268:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   (later in time, not *before* in time)
 269:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  This is my logic...
 270:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   So The "Horizontal Front Porch", to me, should be to the RIGHT of the
 271:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Horizontal Sync Pulse...
 272:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   But that ain't how it is (unless I've confused myself into a circle
 273:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   where my logic is actually right, and I just think it's wrong?)
 274:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   
 275:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  By the logic that the front porch occurs *before* the sync pulse,
 276:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   ... I suppose we could think of a person in front of a house... it
 277:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   makes more sense, anyhow, since it's a porch in front of a house, 
 278:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   not person in front of a car.
 279:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   The person's walking into the house, crosses the *front*-porch 
 280:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   *before* enterring the doorway. If he continues walking all the way
 281:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   through the house and out the back-door, he'll be crossing the *back*
 282:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   porch later in time...
 283:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 284:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Right, so the logic makes sense... but for some reason I have to run 
 285:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  through this whole diatribe every time I see the terms.
 286:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Heh, and even after going through it, the damned thing seems backwards.
 287:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (Probably because I drew it with the front-porch to the right side...)
 288:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (AND THEN there's the issue that it seems to me like the front-porch
 289:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   should be to the left of the drawing-area whereas the back-porch
 290:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   should be to the right of it... rather than to the HSYNC pulse)
 291:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 292:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 293:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Anyways, all that drawing was to figure out where to position this
 294:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // in memory, such that it would be the least processing-effort to modify
 295:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // timing values for testing... (because loading the SDRAM's free-running 
 296:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // data takes ~20minutes!)
 297:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 298:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 299:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 300:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Options LTN, IDT, or TESTVALS
 301:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // IDT display *still* doesn't sync... maybe my H/V signals aren't right
 302:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef DISPLAY
 303:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DISPLAY TESTVALS //LTN //TESTVALS //IDT //LTN
 304:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
 305:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 71


 306:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //oldNote:
 307:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // TODO: Between OSCCAL_VAL and FRAME_UPDATE_DELAY
 308:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  it seems the speed (at least for the LTN) isn't so important after all
 309:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  This could be used to my advantage...
 310:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Maybe bump OSCCAL_VAL all the way up, but use a slower "bit-rate"
 311:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Thus, pixels could be skinnier, thus higher-resolution.
 312:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Or more instructions could be used for the same resolution
 313:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   allowing, e.g. sprites from program-memory, without necessitating a
 314:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   large (or any?) frame-buffer...
 315:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 316:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 317:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //This would normally be 0 for the highest-speed frame-refresh possible
 318:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // However, increasing this value can slow the frame-refresh rate
 319:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   if desired
 320:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // e.g. 50000 causes it to refresh ~ every few seconds
 321:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   (durn-near the limit for how long the LCD will retain an image)
 322:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // The benefit being that it doesn't flicker at annoying rates for
 323:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  stationary images
 324:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  worth exploring...
 325:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // This may be highly dependent on the screen capabilities...
 326:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   of course, this sorta thing is undocumented
 327:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   it just has to be experimented with
 328:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Further, it may be quite hard on the Liquid Crystals, since they'd 
 329:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   likely be driven DC... not sure what the long term effects are.
 330:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // This could be a hell of a lot more sophisticated...
 331:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // e.g. refresh after a frameBuffer change
 332:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      refresh based on a seconds-timer
 333:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      ...
 334:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // AS-IS: Does refreshes completely independent of the frame-buffer
 335:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      if it's too slow, some images may be missed completely.
 336:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      This is not true for FRAME_SYNC TRUE (below)
 337:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      (and it's not really useful anymore with FRAME_SYNC)
 338:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // a/o sdramThing2.0, this is not really relevent...
 339:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // 	if the frame needs updating, just stop free-running, right?
 340:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // 	well, doing-so might cause issues, since the LVDS clock will not be
 341:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    running... this is a TBD
 342:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define FRAME_UPDATE_DELAY 0//5000//50000 //2000 //5000 //20000 //50000
 343:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 344:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 345:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //New Idea:
 346:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Disable the Hsync timer interrupt after the frame completes
 347:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  and reenable elsewhere...
 348:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (It seems pixels changing from one shade to another take an
 349:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   intermediate step halfway between)
 350:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (Thus, two updates then a pause might clear that up)
 351:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (Duh... it doesn't clear that up, because the fastest refresh rate
 352:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   is the same...)
 353:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (but it is an interesting effect)
 354:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (Double-Duh... I was using a slow refresh with FRAME_UPDATE_DELAY)
 355:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Reworded: Having several frame refreshes before a pause helps to
 356:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  "solidify" the color changes... especially the sharp changes 
 357:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (e.g. yellow<->black)
 358:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (Side Note: I saw this effect on a regular (NON-LVDS) TFT display 
 359:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   in LCDdirect that was only connected such that R, G, and B were each
 360:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   either full-off or full-on, i.e. all Red bits were connected to a
 361:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   single output pin (full on when 1, full off when 0).
 362:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   I hadn't attributed it to improper refresh synchronization
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 72


 363:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   as the refresh rate was too fast to see... That's a handy way to get
 364:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   intermediate shades/colors without refresh-flicker from pulsing them!)
 365:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  connected with each color 
 366:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  0 means no delay (except FRAME_UPDATE_DELAY) via interrupt disabling
 367:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  If you WANT this effect (for intermediate shades?) 
 368:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   set FRAME_COUNT_TO_DELAY to 1
 369:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Then, each change of color will (apparently) result in a value halfway
 370:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   between the old color and the new color
 371:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Not sure whether it's an electrical problem, but these half-shades 
 372:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   appear dithered, sometimes ugilly, sometimes it's nice. I guess it
 373:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   depends on the goal...
 374:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#define FRAME_COUNT_TO_DELAY 2//7//1//5//2//3
 375:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 376:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 377:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //A/O v13: Using the Samsung LTN display, instead of the IDTech IAXG
 378:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // LTN appears to be content with my pseudo-LVDS scheme.
 379:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // IAXG has never unblanked
 380:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      Even though suitable timings were found with SwitchResX
 381:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      Maybe due to psuedo-LVDS
 382:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            slight timing issues // It probably doesn't work with all cases...
 383:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Definitely with drawPix/Images...(RC oscillator variances?)
 384:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            glitches when switching LVDS states 
 385:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 (thought I had that figured out, originally)
 386:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      The fact the LTN appears to recognize the signalling suggests the
 387:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      IAXG would be worth further exploration...
 388:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //         Unfortunately, the CCFT blew out my inverter
 389:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                        And I must have put it back together incorrectly
 390:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                        (backlight filters out of order or flipped?)
 391:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                        (which actually makes for some very interesting
 392:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                         visuals, but hard to develop with)
 393:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      IAXG: uses DE, V, and H
 394:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //             At low pixel-clock DE is active for fewer pixels...
 395:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              Last Tested: 680 was full-screen
 396:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //             Nice because it increases the frame-rate!
 397:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      LTN:  uses DE only
 398:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 399:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 400:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // The idea is to use FastPWM with the PLL to implement 64-85Mbits/sec
 401:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (the PLL on the Tiny861 supposedly maxes out at 85MHz)
 402:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (Though I am currently running with OSCAL set to the highest frequency
 403:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   and the PLL seems to be syncing at about 128MHz)
 404:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (New Note, a/o sdramThing2.0v5... it's kinda ironic that I was able to
 405:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   run it at 128MHz with nothing more than an AVR and some gates...
 406:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   seeing as how sdramThing has been fidgetty just running at 8MHz
 407:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Anyways, an eventual goal is to run at 133MHz+, using basically
 408:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   nothing more than the SDRAM itself for timing and refreshes...
 409:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   would allow for full resolution and full color-depth)
 410:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 411:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 412:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 413:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 414:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Wiring:
 415:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Many iterations of AVR->Differential "LVDS" circuitry resulted in the
 416:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   simplest of all:
 417:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 418:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Believe it or not, the XOR is a standard TTL LS-series XOR: 74LS86
 419:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     Specifically: TI SN74LS86N from 1980 (the only XOR in my collection)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 73


 420:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   It's spec'd to run from 4.5-5.5V, and its propagation delays and slew
 421:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     rates aren't really spec'd to be good enough for 128MHz pixel clock
 422:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     yet it's working...
 423:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Further, the output voltages are right in the LVDS range,
 424:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     IIRC (last I 'scoped) around 1.5V High and 1.0V Low
 425:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      (Don't forget the LCD has a 100ohm resistor between
 426:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //         RXinN/clk+ and RXinN/clk-)
 427:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 428:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   It's probably best to use two XORs from the same chip for a single
 429:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    LVDS channel, since different chips may have slightly different
 430:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    characteristics. 
 431:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 432:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   The entire circuit, thus, requires TWO 74LS86's 
 433:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    (four XORs apiece, two per LVDS channel, 8-total)
 434:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 435:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 436:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              VCC3V3   VCC3V3
 437:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                |        |                           ______________
 438:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                +---\ \-_                        |  LCD (1 channel
 439:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                     | |    -                      |       of 4)
 440:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                     | | XOR   >------> RXinN/clk-  | ----.
 441:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   AVR, etc.         | |    _-                      |     |
 442:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   3.3V TTL >---+---/ /___-                        |     \ 100
 443:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   output       |                                   |     /
 444:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                |                                   |     \ ohms
 445:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                |                                   |     /
 446:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                `---\ \-_                        |     |
 447:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                     | |    -                      |     |
 448:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                     | | XOR   >------> RXinN/clk+  | ----'
 449:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                     | |    _-                      |
 450:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                +---/ /___-                        |
 451:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                |        |                          |
 452:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //               GND      GND
 453:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 454:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  
 455:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Also used: The TTL 74AHC series...
 456:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    I found some one-gang 74AHC1G32 and 74AHC1G86's on an old iBook
 457:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     motherboard. (An OR and an XOR, respectively). These are spec'd for
 458:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     3.3V operation, and faster. The output voltages appear OK for LVDS
 459:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     (with a 100ohm load in the LCD)
 460:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 461:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  NOTE: Since I only had enough of these 1-gang devices for two LVDS
 462:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     channels, I had to implement Red and Green with the LS 
 463:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     before switching all channels to the LS... Using different chips
 464:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     (specifically, different TYPES of chips) for different channels
 465:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     caused timing issues: Since the AHC is faster, the clock and Blue
 466:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     signals are synchronized, but the red and green signals were shifted
 467:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     a bit or two (resulting in "Black" appearing green)
 468:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 469:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  For other circuits attempted, see oldNotes.txt
 470:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     (and boy there were many, involving voltage dividers, AC coupling,
 471:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      reference voltages, BJT differential amplifiers... I doubt I 
 472:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      documented them all, or even most. Whoda thunk the simplest, 
 473:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      especially under- AND over-spec'd--timing, supply voltage, and
 474:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      output voltage--would be the one...?)
 475:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 476:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // LVDS/FPD-Link timing:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 74


 477:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 478:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            |<--- (LCDdirectLVDS: "pixel") --->|
 479:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Timer1:   |<-- One Timer1 Cycle (OCR1C=6) -->|
 480:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  TCNT:     |  0   1    2    3    4    5    6  |  0   1    2    3    
 481:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            |____.____.____.____               |____.____.____.____
 482:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  RXclk+:   /         |         \    .    .    /         |         \ //
 483:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            |         |            |         |
 484:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // One Pixel: |         |<--- One FPD-Link Pixel Cycle --->|
 485:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            |                                  |
 486:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // "Blue/DVH" |____ ____v____ ____ ____v____ ____|____ ____
 487:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  RXin2:    X B3 X B2 X DE X /V X /H X B5 X B4 X B3 X B2 X ...
 488:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            | ^  ^ | 
 489:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            |         |<--Not Blue-->|         |
 490:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            |                                  |
 491:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // "Green"    |____ ____v____ ____v____ ____ ____|____ ____
 492:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  RXin1:    X G2 X G1 X B1 X B0 X G5 X G4 X G3 X G2 X G1 X ...
 493:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            | ^ ^  |  
 494:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            |         |<------->|-Not Green    |
 495:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 496:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // "Red"      |____ ____v____v____ ____ ____ ____|____ ____
 497:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  RXin0:    X R1 X R0 X G0 X R5 X R4 X R3 X R2 X R1 X R0 X ...
 498:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            | ^^     
 499:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            |         |<-->|-Not Red
 500:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 501:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Of course: The "Not Green/Red" bits above are least-significant-bits
 502:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              and basically have little/no visible effect
 503:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 504:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 505:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Implementations/prospects:
 506:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  * rowBuffer.c (more like row-settings-buffer)
 507:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     calculate a row's worth of pixels before drawing that row
 508:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     (uses packed color settings in a single byte per drawable pixel)
 509:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     64 drawable pixels across, regardless of LVDS speed
 510:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  * For faster pixels: these settings values could be stored 
 511:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     in individual bytes. Gives about 1/3 more pixels at 3x the memory
 512:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     (not implemented)
 513:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  * rowSegBuffer.c
 514:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     also calculates an entire row before drawing it
 515:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     instead of storing pixels, store "segments"
 516:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     i.e. each segment is defined by a color value and a length
 517:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     Number of segments is limited only by memory...
 518:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      e.g. 64 segments per row (max) is 64*3Bytes
 519:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       Three bytes for color, and *really simple* packing for seg-length
 520:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      BUT: at slow LVDS speeds, the resolution of these segments could be
 521:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       as high as one LCD pixel.
 522:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      possibly: at *really* low LVDS speeds we could be 64*2Bytes
 523:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      (with packing)
 524:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      Actually: Using GB_COMBINED gives 2Bytes per segment
 525:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      only adds two clock cycles to each "pixel", so probably worth it
 526:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 527:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   In Any Case: There's not enough RAM for a full frame
 528:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          64 pixels across * 64 pixels down is 4096 bytes
 529:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          So whatever method, we need to precalculate each row before
 530:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          displaying it
 531:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          Could be as simple as loading direct from program memory
 532:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 533:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 75


 534:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Since low-bits are barely visible, their effect is neglected.
 535:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 536:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 537:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE/V/H Timing (LCDdirectLVDS):
 538:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  
 539:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 540:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            |  0   1    2    3    4    5    6       All: set @ 0
 541:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            |____.____.____.____                         OCR1C = 6 
 542:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Clock:    /                   \    .    .    /         Complementary-
 543:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                                             Output Mode
 544:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                                                          required for DT
 545:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Signal:    B3   B2   DE   /V   /H   B5   B4 | B3
 546:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //             ____ ____ ____ ____ ____ ____ ____|____    
 547:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   DE:      X B3 X B2 /    .    .    \ B5 X B4 X B3 X    
 548:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   state2                      |    
 549:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   DE_BLUE: >|    DT=X, OCR=0
 550:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                         Watch the transition!! -------^
 551:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   DE_NORM: >_________/\_________|    DT=2, OCR=4
 552:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   DC_DISABLED:
 553:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   maxBlue: >\____|		DT=0, OCR=5
 554:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //             See below for more blue settings...
 555:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 556:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //             ____ ____      ____      ____ ____|____ 
 557:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H (only): X xx X xx \    /    \    / xx X xx X xx X    
 558:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   state1              | 
 559:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            >______________/\______________|    DT=3, OCR=3
 560:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  DC_DISABLED:
 561:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Not much can be done...
 562:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 563:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //             ____ ____           ____ ____ ____|____ 
 564:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V w/o H:  X xx X xx \    .    /    \ xx X xx X xx X
 565:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   state3              |
 566:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            >___________________/\_________|    DT=4, OCR=4 (+?)
 567:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DC_DISABLED:
 568:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            >___________________/\____|		DT=4, OCR=5
 569:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 570:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //             ____ ____                ____ ____|____ 
 571:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V w/ H:   X xx X xx \    .    .    / xx X xx X xx X
 572:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   state4          | 
 573:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            >__________________________________|    DT=X, OCR=0
 574:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                             TransitionWatch!!! -------^
 575:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                             Shouldn't matter... DT from no-edge
 576:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DC_DISABLED:
 577:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            >\________________________|		DT=0, OCR=1
 578:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 579:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //             ____ ____      ____ ____ ____ ____|____ 
 580:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Nada:     X xx X xx \    /    .    \ xx X xx X xx X    
 581:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   state0                  |     
 582:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            >______________/\_________|    DT=3, OCR=4 (+?)
 583:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DC_DISABLED:
 584:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //            >______________/\____|		DT=3, OCR=5
 585:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 586:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //So far this is the only case I've seen:
 587:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // /Vsync
 588:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef VSYNC_ACTIVE
 589:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define VSYNC_ACTIVE		0
 590:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 76


 591:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef VSYNC_INACTIVE
 592:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define VSYNC_INACTIVE	1
 593:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
 594:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // /Hsync
 595:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef HSYNC_ACTIVE
 596:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define HSYNC_ACTIVE		0
 597:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
 598:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef HSYNC_INACTIVE
 599:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define HSYNC_INACTIVE	1
 600:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
 601:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE (active high)
 602:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef DE_ACTIVE
 603:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DE_ACTIVE			1
 604:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
 605:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef DE_INACTIVE
 606:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DE_INACTIVE		0
 607:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
 608:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 609:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // HERE!
 610:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 611:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 612:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 613:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 614:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Transitions: OLD!!!!! WRONG!!!!
 615:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   (are they? There're several additional transitions, now, for one.)
 616:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  The idea is to reduce the number of instructions between each
 617:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  LVDS "state."
 618:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  These are implemented below in the case:
 619:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    "#else //NOT FULL_INIT_TESTS"
 620:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Since each instruction takes *longer than* a single pixel
 621:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    two instructions would *at best* occur on two consecutive pixels
 622:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    Thus, there's likely to be a transition-glitch
 623:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    (e.g. old OCR value with new DT value)
 624:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Note that the new DT values are implemented at the next corresponding
 625:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    edge after the DT-write instruction completes
 626:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    (for +OC1A/DT1H, when TCNT is reset to 0)
 627:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    (for -OC1A/DT1L, when TCNT passes OCR1A)
 628:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    New OCR values are delayed until the next TCNT reset to 0
 629:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 630:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Initial:
 631:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Nada					DT=2  NADA_OCR = (3<=OCR<(=?)6)
 632:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 633:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Nada	->	H			OCR=2
 634:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H		->	Nada		OCR=NADA_OCR
 635:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  
 636:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Nada	->	V			DT=3
 637:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V		->	V+H		OCR=0
 638:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V+H	->	V			OCR=NADA_OCR
 639:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V		->	Nada		DT=2
 640:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 641:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Nada	->	DE			DT=1
 642:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  DE	->	Nada		DT=2
 643:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 644:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if 0
 645:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (defined(REMOVE_DC) && REMOVE_DC)
 646:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define Nada_init()         { DT1=(3<<4); OCR1A=5; }
 647:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 77


 648:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  //Unused, normally...
 649:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define Vsync_init()       { DT1=(4<<4);  OCR1A=5; }
 650:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define VplusH_init()      { DT1=0;       OCR1A=1; }
 651:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define Hsync_init()       { DT1=(3<<4);  OCR1A=3; }
 652:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define DEonly_init()      { DT1=(2<<4);  OCR1A=4; }
 653:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define DEblue_init()		 { DT1=0;       OCR1A=5; }
 654:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 655:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #else //!REMOVE_DC
 656:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Nada init
 657:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define Nada_init()         { DT1=(3<<4); OCR1A=4; }
 658:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 659:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Unused, normally...
 660:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define Vsync_init()			{ DT1=(4<<4);	OCR1A=4; }
 661:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define VplusH_init()		{ DT1=0;			OCR1A=0; }
 662:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define Hsync_init()			{ DT1=(3<<4);	OCR1A=3; }
 663:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // #define DE_init()				{ DT1=(2<<4);	OCR1A=4; } //...SHOULD BE
 664:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define DEonly_init()			{ DT1=(2<<4);  OCR1A=4; }
 665:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define DEblue_init()			{ DT1=0;       OCR1A=6; }
 666:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#define DE_init()				{ DT1=(1<<4);	OCR1A=2; } //Works with DE_ONLY
 667:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  //#define DE_init()				{ DT1=0;			OCR1A=0xff; }	//DE_BLUE
 668:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif //REMOVE_DC
 669:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
 670:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 671:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#define FULL_INIT_TESTS TRUE
 672:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 673:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Display is DE-Only (doesn't use H/Vsync)
 674:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Shouldn't be necessary to select this if it is,
 675:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // since DE timing is the same either way
 676:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // but I want to test whether a single-bit is being detected
 677:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (e.g. maybe the rise/fall-times of the output aren't fast enough for a
 678:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  single bit, which might explain why the other display didn't work)
 679:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //These are just examples... the project should define them:
 680:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if 0
 681:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (defined(DE_ONLY_DISPLAY) && DE_ONLY_DISPLAY)
 682:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Vsync_fromNada()      Nada_init()
 683:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define VplusH_fromVsync()    Nada_init()
 684:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Vsync_fromVplusH()    Nada_init()
 685:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Nada_fromVsync()      Nada_init()
 686:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Hsync_fromNada()      Nada_init()
 687:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Nada_fromHsync()      Nada_init()
 688:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DEonly_fromNada()     DE_init()
 689:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DEblue_fromDEonly()	DE_init()
 690:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Nada_fromDEblue()		Nada_init()
 691:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #if(DE_BLUE)
 692:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "DE_BLUE is true, but not implemented with DE_ONLY_DISPLAY"
 693:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "...The display should be blank"
 694:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #endif
 695:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Use full initialization of each LVDS state
 696:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (might not be good during transitions, but should guarantee
 697:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  steady-state, in case my transitions aren't correct...)
 698:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (defined(FULL_INIT_TESTS) && FULL_INIT_TESTS)
 699:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Vsync_fromNada()		Vsync_init()
 700:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define VplusH_fromVsync()		VplusH_init()
 701:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Vsync_fromVplusH()		Vsync_init()
 702:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Nada_fromVsync()		Nada_init()
 703:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Hsync_fromNada()		Hsync_init()
 704:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Nada_fromHsync()		Nada_init()
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 78


 705:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DEonly_fromNada()		DEonly_init()
 706:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DEblue_fromDEonly()	DEblue_init()
 707:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Nada_fromDEonly()		Nada_init()
 708:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Nada_fromDEblue()		Nada_init()
 709:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 710:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 711:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #else	//NOT FULL_INIT_TESTS
 712:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#define Vsync_fromNada()   { DT1=(4<<4); }
 713:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Vsync_fromNada()   { DT1=(4<<4); OCR1A=5; } //Leave two bits high
 714:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 																	 //for easy-scoping
 715:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 						//Three would be nicer, but I'm pretty sure OCR=TOP=ON
 716:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define VplusH_fromVsync() { OCR1A=0; }
 717:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#define Vsync_fromVplusH() { OCR1A=4; }
 718:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Vsync_fromVplusH() { OCR1A=5; }				//Extra bits for scoping
 719:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#define Nada_fromVsync()   { DT1=(3<<4); }
 720:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Nada_fromVsync()   { DT1=(3<<4); OCR1A=4; } //scoping...
 721:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Hsync_fromNada()   { OCR1A=3; }
 722:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Nada_fromHsync()   { OCR1A=4; }
 723:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 724:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Nada_fromDEblue()	{ DT1=(3<<4); OCR1A=4; }
 725:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define Nada_fromDEonly()	{ DT1=(3<<4); }
 726:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DEonly_fromNada()	{ DT1=(2<<4); }
 727:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DEblue_fromNada()	{ OCR1A=0xff; }
 728:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DEblue_fromDEonly() { OCR1A=0xff; }
 729:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 730:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif //End Of FULL_INIT_TESTS
 731:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
 732:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 733:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 734:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 735:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // The typical patterns look like this (not at all to scale):
 736:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   ----______------------------------------------------______-- V
 737:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //             ....
 738:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      --_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_--_ H
 739:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //             ....
 740:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      __________-__-__-__-__-__-__-__-__-__-__________________  DE
 741:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 
 742:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //             ^^^^\														//blah
 743:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //             1234 5?
 744:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Pixels are sent during DE High (basically all the CPU will be used here)
 745:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Ideally, 
 746:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  there won't be any glitches when changing from one state to another
 747:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 748:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Init (pre 1):
 749:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    DeadTimerRising=1
 750:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 751:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  The states are:
 752:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   (Not necessarily accurate, just looking into necessary changes)
 753:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   (from Vsync L->H)
 754:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 755:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   1  NothingActive (long, No DE, VporchFrontTimes)
 756:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 757:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   2  Hsync
 758:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 759:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   3  NothingActive (short)
 760:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 761:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   4  DE
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 79


 762:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 763:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   5  NothingActive(?)
 764:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 765:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   7  Repeat 2-5 for each row
 766:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 767:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   8  NothingActive (long, No DE, VporchBackTimes)
 768:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 769:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   9  V w/o H
 770:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 771:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   10 V w/  H
 772:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 773:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   11 Repeat 9-10 for Vsync time...
 774:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 775:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 776:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Here's how it worked pre-lvds:
 777:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // HSYNC, VSYNC, and DE refer to the actual pins
 778:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // In the LVDS setup, there're modes corresponding to each pin-combination
 779:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 780:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Timer Interrupt:
 781:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  loadData:
 782:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   HSYNC active
 783:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   HSYNC Low delay
 784:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   HSYNC inactive
 785:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   if(dataEnable)
 786:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    DE active
 787:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     Send row data
 788:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    DE inactive
 789:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  //Prep for next interrupt
 790:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  switch(hsyncCount++)
 791:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    //Vsync H->L (active)
 792:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    1:
 793:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          dataEnable=FALSE
 794:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          VSYNC active
 795:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    //Vsync L->H (inactive)
 796:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    T_Vlow:
 797:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          VSYNC inactive
 798:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    //Start of frame
 799:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    T_VD +(T_Vlow):
 800:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          dataEnable=TRUE
 801:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    //All rows have been displayed
 802:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    V_COUNT +(T_VD+T_Vlow):
 803:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          dataEnable=FALSE
 804:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    //Frame Complete
 805:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    T_DV +(V_COUNT+T_VD+T_Vlow): 
 806:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          hsyncCount=0
 807:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  if(dataEnable)
 808:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    Use the remaining time to load the next row to memory
 809:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 810:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  So:
 811:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Interrupt0       End
 812:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    |             |  Interrupt1
 813:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    v             v  v
 814:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H |_||_||_|
 815:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE ___________________________________________________ ...
 816:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V |_____________________________________ ...
 817:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       |        ||
 818:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DETIME^--------^|
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 80


 819:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 |
 820:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 VSYNC active
 821:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 dataEnable=FALSE (not necessary?)
 822:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 823:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //InterruptT_Vlow   End
 824:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    |             |
 825:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    v             v
 826:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H |_||_||_|
 827:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE ___________________________________________________ ...
 828:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V _____________| ...
 829:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       |        ||
 830:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DETIME^--------^|
 831:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 |
 832:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 VSYNC inactive
 833:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 834:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 835:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //InterruptT_VD   End  InterruptT_VD+1
 836:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    |             |  |            End
 837:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    v             v  v            v
 838:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H |_||_||_|
 839:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE ____________________||_______||____ ...
 840:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V 
 841:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       |        ||      |        |
 842:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DETIME^--------^|      ^--------^
 843:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 |
 844:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 dataEnable=TRUE
 845:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 846:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //InterruptV_COUNT  End
 847:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    |             |
 848:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    v             v
 849:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H |_||_||_|
 850:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE ___||______________________________________ ...
 851:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V 
 852:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       |        ||      |        |
 853:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DETIME^--------^|      ^--------^
 854:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 |
 855:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 dataEnable=FALSE
 856:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 857:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 858:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // This isn't really a state, it's basically just:
 859:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // if(hsyncCount == NUM_HYSYNCS_PER_FRAME)
 860:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    hsyncCount = 0;
 861:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                    .....................................
 862:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                    .                                   .
 863:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //InterruptT_DV   End .Interrupt0                         .
 864:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    |             | .|                                  .
 865:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    v             v .v                                  .
 866:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H |_||_||_|
 867:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE ___________________________________________________ .
 868:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V |____________________ .
 869:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       |        ||  .   |        |                      .
 870:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DETIME^--------^|  .   ^--------^                      .
 871:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 |  .                                   .
 872:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                 hsyncCount=0 (repeat from Interrupt0)  .
 873:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                    .                                   .
 874:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                    .....................................
 875:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 81


 876:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 877:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 878:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // THESE STATES ARE NO LONGER ACCURATE
 879:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // ESPECIALLY THIS FIRST STATE.
 880:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // V Front Porch originally (and in these drawings) occurred at the end
 881:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // of the frame...
 882:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // More logically, it now starts at the beginning of the frame
 883:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (Also removing this initial "glitch" of a single interrupt with
 884:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  NothingActive)
 885:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 886:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // THESE STATES ARE NO LONGER ACCURATE (a/o 0.30, for certain)
 887:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // NOW to compare with LVDS states:
 888:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 889:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Interrupt0       End
 890:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    |             |  Interrupt1
 891:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    v             v  v
 892:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H |_||_||_|
 893:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE ___________________________________________________ ...
 894:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V |_____________________________________ ...
 895:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    ^ ^          ^   ^ ^
 896:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |          |   | |
 897:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |          |   | +--- V w/o H  \ These two toggle until
 898:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |          |   +----- V w/ H   / next LCD state...
 899:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |          |
 900:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |          +--------- V w/o H > Intermediate change of state
 901:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |
 902:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | +----- NothingActive  \ From Previous State (?)
 903:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    +------- H_Only         /
 904:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 905:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 906:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //InterruptT_Vlow   End
 907:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    |             |
 908:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    v             v
 909:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H |_||_||_|
 910:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE ___________________________________________________ ...
 911:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V _____________| ...
 912:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    ^ ^          ^   ^ ^
 913:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |          |   | |
 914:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |          |   | +--- NothingActive  \ These two toggle until
 915:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |          |   +----- H_Only         / next LCD state...
 916:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |          |
 917:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |          +--------- NothingActive > Intermediate change of state
 918:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |
 919:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | +----- V w/o H   \ From previous state
 920:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    +------- V w/ H    /
 921:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 922:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 923:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //InterruptT_VD   End  InterruptT_VD+1
 924:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    |             |  |            End
 925:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    v             v  v            v
 926:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H |_||_||_|
 927:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE ____________________||_______||____ ...
 928:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V 
 929:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    ^ ^              ^ ^^        ^ 
 930:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |              | ||        |
 931:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |              | ||        +--- NothingActive  \  These four
 932:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |              | |+------------ DE              | cycle until
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 82


 933:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |              | +------------- NothingActive   | next LCD state...
 934:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |              +--------------- H_Only  ^      /
 935:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |                                       |
 936:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | +----- NothingActive  \ From previous   |
 937:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    +------- H_Only         / state           +-This intermediate state
 938:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                                                may not be necessary
 939:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                                                (IAXG01 shows 160 dots!)
 940:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 941:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 942:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 943:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //InterruptV_COUNT  End
 944:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    |             |
 945:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    v             v
 946:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H |_||_||_|
 947:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE ___||______________________________________ ...
 948:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V 
 949:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    ^ ^^        ^    ^ ^
 950:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | ||        |    | |
 951:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | ||        |    | +--- NothingActive \  These two toggle
 952:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | ||        |    +----- H_Only        /  until next LCD state
 953:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | ||        |
 954:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | ||        +---- NothingActive \ 								//blah
 955:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |+------------- DE             |  From previous state
 956:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | +-------------- NothingActive  |
 957:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    +---------------- H_Only        /
 958:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 959:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // This isn't really a state, it's essentially just:
 960:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  if(hsyncCount == NUM_HSYNCS_PER_FRAME)
 961:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    hsyncCount = 0;
 962:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                    .....................................
 963:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                    .                                   .
 964:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //InterruptT_DV   End .Interrupt0                         .
 965:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    |             | .|                                  .
 966:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    v             v .v                                  .
 967:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H |_||_||_|
 968:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE ___________________________________________________ .
 969:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V |____________________ .
 970:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    ^ ^             .                                   .
 971:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | |             .....................................
 972:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    | +--- NothingActive \											//blah
 973:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    +----- H_Only        / From previous state...
 974:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 975:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 976:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 977:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  LVDS State transitions:
 978:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   1 H_Only
 979:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   2 NothingActive
 980:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 981:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   3 V w/o H
 982:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   4 V w/ H
 983:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    
 984:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   (repeat 3,4)
 985:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 986:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   5 V w/o H
 987:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 988:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   6 NothingActive
 989:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   7 H_Only
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 83


 990:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 991:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   (repeat 6,7)
 992:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 993:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   8 NothingActive
 994:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
 995:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   9 H_Only
 996:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  10 NothingActive
 997:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  11 DE
 998:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  12 NothingActive
 999:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
1000:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (repeat 9-12)
1001:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
1002:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  13 H_Only
1003:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  14 NothingActive
1004:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
1005:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (repeat 13-14)
1006:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
1007:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   These should be reviewed to determine which changes are necessary
1008:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   between each state...
1009:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   (the fewer changes, the less likely we'll glitch...?)
1010:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1011:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** uint8_t dataEnable = 0;
1012:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** uint8_t vSync = 0;
1013:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** uint16_t hsyncCount = 0;
1014:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1015:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //frameCount=0 can be used in main to detect whether we've completed a 
1016:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  a frame AND its FRAME_UPDATE_DELAY
1017:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (defined(FRAME_COUNT_TO_DELAY) && (FRAME_COUNT_TO_DELAY != 0))
1018:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #error "FRAME_COUNT_TO_DELAY isn't really an lcdStuff thing anymore, is it?"
1019:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** uint8_t frameCount = 0;
1020:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1021:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1022:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** void lcd_init(void)
1023:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
 1963               		.stabn	68,0,1023,.LM213-.LFBB18
 1964               	.LM213:
 1965               	.LFBB18:
 1966               	/* prologue: function */
 1967               	/* frame size = 0 */
 1968               	/* stack size = 0 */
 1969               	.L__stack_usage = 0
1024:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//Not sure modifying vSync randomly is safe...
1025:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	vSync = 0;
 1970               		.stabn	68,0,1025,.LM214-.LFBB18
 1971               	.LM214:
 1972 0752 1092 0000 		sts vSync,__zero_reg__
1026:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//the rest should be...? assuming it occurs after lcd_update() completes
1027:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// (thus leaving it in NADA-state)
1028:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	hsyncCount = 0;
 1973               		.stabn	68,0,1028,.LM215-.LFBB18
 1974               	.LM215:
 1975 0756 1092 0000 		sts hsyncCount+1,__zero_reg__
 1976 075a 1092 0000 		sts hsyncCount,__zero_reg__
1029:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	dataEnable = FALSE;
 1977               		.stabn	68,0,1029,.LM216-.LFBB18
 1978               	.LM216:
 1979 075e 1092 0000 		sts dataEnable,__zero_reg__
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 84


1030:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  	Nada_init();
 1980               		.stabn	68,0,1030,.LM217-.LFBB18
 1981               	.LM217:
 1982 0762 88B3      		in r24,0x18
 1983 0764 8063      		ori r24,lo8(48)
 1984 0766 88BB      		out 0x18,r24
 1985 0768 8BB3      		in r24,0x1b
 1986 076a 8F7C      		andi r24,lo8(-49)
 1987 076c 8BBB      		out 0x1b,r24
 1988 076e 0895      		ret
 1989               		.size	lcd_init, .-lcd_init
 1990               	.Lscope18:
 1991               		.stabs	"",36,0,0,.Lscope18-.LFBB18
 1992               		.stabd	78,0,0
 1993               		.stabs	"lcd_update:F(4,3)",36,0,1320,lcd_update
 1994               	.global	lcd_update
 1995               		.type	lcd_update, @function
 1996               	lcd_update:
 1997               		.stabd	46,0,0
1031:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1032:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1033:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1034:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define TESTVALS	0
1035:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define LTN 1
1036:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define IDT 2
1037:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1038:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1039:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //TIMING:
1040:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Measurements below (in microseconds) are referring to preLVDS
1041:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  There may be other such old-notes...
1042:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1043:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1044:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        |<--T_Hhigh-->| |<-T_Hlow
1045:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    __   _____________   ____________  3.6V
1046:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // H    |_|             |_|           _  0V
1047:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
1048:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    Data Enable
1049:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       Only active when there's valid pixel data
1050:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       (For a dual-pixel 1024x768 display:
1051:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //         for 512 of the 717 clocks in HSYNC-active)
1052:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       Low during Vsync... (~720us)
1053:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
1054:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1055:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //IDTech display: 136 dots
1056:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //2-136+
1057:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //IDTech, last used: 40
1058:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //LTN Last used 8
1059:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // LTN: 1072<=1344<=1500 clocks per line, 1024DE... Hsync unused
1060:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // SEE Hlow_Delay() notes if this value is large!
1061:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1062:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef H_LOW_DOTS
1063:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (DISPLAY == LTN)
1064:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define H_LOW_DOTS	8
1065:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == IDT)
1066:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define H_LOW_DOTS   40//8//1//40 //30 //2//136
1067:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1068:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define H_LOW_DOTS	100//0 //LTN doesn't use H_LOW (DE-only)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 85


1069:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 							  // And having a value here increases codesize
1070:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1071:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1072:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1073:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //H is set low immediately upon entry of the timer interrupt
1074:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // its low-time is controlled via nops
1075:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (so if HLow is long for a particular display, this might need revising)
1076:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1077:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if((!defined(HLOW_DELAY_OVERRIDE) || !HLOW_DELAY_OVERRIDE) \
1078:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		                                         && !defined(Hlow_Delay))
1079:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define Hlow_Delay() \
1080:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	delay_Dots(H_LOW_DOTS)
1081:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1082:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1083:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1084:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1085:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1086:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //This was found expermentally with SwitchResX
1087:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //IDTech Last Used: 680
1088:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (IDTech had some oddities regarding slow pixel-clocks, where pixels
1089:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  would be repeated, regardless of the pixel-clock, thus, for slow clocks
1090:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  it has the effect of *stretching* the image, thus 680 "pixels" across
1091:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  instead of its 1024 *physical* pixels)
1092:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //LTN last used 1024
1093:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Oddly: For the LTN, this doesn't seem to affect the horizontal
1094:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //        it does, however, affect the vertical(!)
1095:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // If I recall Correctly, this is used only for setting the timer interrupt
1096:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  rate...
1097:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef DE_ACTIVE_DOTS
1098:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (DISPLAY == LTN)
1099:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define DE_ACTIVE_DOTS	1024
1100:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == IDT)
1101:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define DE_ACTIVE_DOTS	680 //1024 //800 //920 //943 //812 //472 //1024
1102:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1103:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define DE_ACTIVE_DOTS	1024
1104:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1105:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1106:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1107:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Horizontal Blank Time: HD_DOTS + H_LOW + DH_DOTS
1108:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  90-320+
1109:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Horizontal Total Time: 1206<=1344<=2047
1110:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // ... but Total = Blank + Pixels, so 90+1024 != 1206
1111:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Excess waits should be thrown in DH (since that's between interrupts)
1112:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //T_HD is the time from H inactivated to DE activated
1113:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //aka H back-porch: 1-160+
1114:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //IDTech Last Used: 50
1115:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //LTN last used 5
1116:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1117:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef HD_DOTS
1118:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (DISPLAY == LTN)
1119:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define HD_DOTS 5
1120:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == IDT)
1121:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define HD_DOTS	50 //5 //0//20//5 //50 //30 //1 //160
1122:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1123:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define HD_DOTS 50//5
1124:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1125:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 86


1126:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1127:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef HD_Delay
1128:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define HD_Delay()	delay_Dots(HD_DOTS)
1129:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1130:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1131:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // I think this was just a mistake. This change to delay_Dots a/o 0.10ncf
1132:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (untested in LCDdirectLVDS)
1133:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //delay_cyc(HD_DOTS)
1134:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1135:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1136:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // This is the number of CPU cycles between DE->L and Horiz->L
1137:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // This is just used in calculating the OCR value...
1138:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // aka H Front Porch: 0-24+
1139:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // IDTech Last Used: 24
1140:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // LTN last used 46
1141:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // 1072-1024-1-1 = 46
1142:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef DH_DOTS
1143:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (DISPLAY == LTN)
1144:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define DH_DOTS	46
1145:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == IDT)
1146:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define DH_DOTS	24 //46 //480//6//12//24 //46 //24 //122//30 //0 //24
1147:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1148:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define DH_DOTS	0//1000//100//46
1149:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1150:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1151:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1152:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       |
1153:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       v
1154:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      T_DH
1155:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      ||    |<-T_DE->|  |  |<--T_HD (Hsync->DE)
1156:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // H   __.  ____________  .___________
1157:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      .|_|  .        .|_|  .
1158:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     _.     .________.     .___________
1159:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE   |_____| 512clk |_____|
1160:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //      ^              ^
1161:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //       \___________   \                        (just avoiding \ warning)
1162:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                   \  |     768 Hsyncs
1163:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                    v v
1164:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     _             _ _ _ _ _ _ _ _ _ _ 
1165:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE   |___________| | | | | | | | | | |______
1166:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
1167:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // one Hsync = T_HD+T_DH+T_Hlow+T_DE = 19.865us
1168:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1169:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //aka V-sync back porch: 7-29-63 "Vbp should be static"
1170:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // IDTech Last Used: 29
1171:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // LTN last used 3
1172:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //LTN Frame: 772<=806<=1000 lines...
1173:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1174:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef T_VD
1175:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (DISPLAY == LTN)
1176:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define T_VD 3
1177:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == IDT)
1178:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define  T_VD 29 //3//29 //7 //29
1179:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1180:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define T_VD 3
1181:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1182:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 87


1183:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1184:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //aka V-sync front porch: 1-3+
1185:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // IDTech Last Used: 3
1186:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // LTN last used 3
1187:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef T_DV
1188:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (DISPLAY == LTN)
1189:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define T_DV 3
1190:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == IDT)
1191:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define T_DV 3//3 //1 //3
1192:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1193:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define T_DV 3
1194:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1195:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1196:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1197:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //1-6+ (1 is used by the first switch-case...)
1198:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // IDTech Last Used: 6
1199:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // LTN Last used 16
1200:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // 772 - 768 - 1 - 1 = 2
1201:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef T_Vlow
1202:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (DISPLAY == LTN)
1203:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define T_Vlow 16
1204:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == IDT)
1205:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define T_Vlow	6 //16//6 //2 //6
1206:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1207:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define T_Vlow 32
1208:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1209:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1210:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1211:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // IDTech Last Used: 768
1212:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifndef V_COUNT
1213:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (DISPLAY == LTN)
1214:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define V_COUNT	768
1215:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == IDT)
1216:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define V_COUNT	768
1217:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif (DISPLAY == TESTVALS)
1218:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // #if (LVDS_PRESCALER == 8)
1219:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #define V_COUNT 768
1220:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // #else
1221:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  #define V_COUNT	(768*2/3)
1222:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // #endif
1223:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1224:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1225:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1226:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                       
1227:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                      |           
1228:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                      V           
1229:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              |<-T_DV>|           |<-T_VD-->|
1230:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              .       .           .         .
1231:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     _____________||__.   124us   .____||___________________
1232:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V           .   ||  |___________|    ||   .
1233:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     _ _ _ _ _ _ _|| _ _ _ _ _ _ _ _ _ ||_ _ _ _ _ _ _ _ _ _ _
1234:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H   | | | | | | ||| | | | | | | | | ||| | | | | | | | | | |
1235:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //              .   ||                   ||   .
1236:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     _ _ _ _ _.   ||       720us       ||   ._ _ _ _ _ _ _ _ _
1237:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE   | | | | |___||___________________||___| | | | | | | | |
1238:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                  ||                   ||
1239:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 88


1240:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                        1
1241:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                        |
1242:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                        v               
1243:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     _________________   ___________________   _____________
1244:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  V                   |_|                   |_|
1245:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  H  |||||||||||||||||||||||||||||||||||||||||||||||||||||||
1246:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE  ||||||||||||||||_____|||||||||||||||||_____||||||||||||
1247:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                          ^
1248:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                          |
1249:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //                          2
1250:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1251:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1252:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1253:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define HSYNC_COUNT_FRAME_COMPLETE  \
1254:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	(T_DV +(V_COUNT+T_VD+T_Vlow) + FRAME_UPDATE_DELAY)
1255:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // T_DV = 3
1256:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // V_COUNT = 768 
1257:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // T_VD = 3
1258:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // T_Vlow = 32
1259:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // FRAME_UPDATE_DELAY = 0
1260:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // TOTAL = 806
1261:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1262:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if(FRAME_UPDATE_DELAY != 0)
1263:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #error "FRAME_UPDATE_DELAY is no longer implemented..."
1264:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1265:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1266:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1267:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#if(HSYNC_COUNT_FRAME_COMPLETE & 0x01)
1268:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // #warning "Total vertical lines might need to be even!"
1269:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  //This should be fixed...
1270:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#endif
1271:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1272:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1273:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DOT_COUNT_PER_HSYNC \
1274:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	(H_LOW_DOTS + HD_DOTS + DE_ACTIVE_DOTS + DH_DOTS)
1275:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // H_LOW_DOTS = 100
1276:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // HD_DOTS = 50 
1277:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DE_ACTIVE_DOTS = 1024
1278:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DH_DOTS = 0
1279:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // TOTAL = 1174
1280:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1281:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1282:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#define MAKELONG (0L)
1283:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1284:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DOT_COUNT_PER_FRAME \
1285:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  ((MAKELONG(HSYNC_COUNT_FRAME_COMPLETE)) * (MAKELONG(DOT_COUNT_PER_HSYNC)))
1286:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // TOTAL = 946,244
1287:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1288:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Hlow_Delay 		H_LOW_DOTS
1289:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //HD_Delay			HD_DOTS	
1290:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //DE_ACTIVE_DOTS
1291:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //DH_DOTS
1292:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1293:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1294:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1295:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** static __inline__ \
1296:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** void loadData(uint16_t rowNum, uint8_t dataEnable) \
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 89


1297:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	  __attribute__((__always_inline__));
1298:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1299:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1300:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1301:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** /*
1302:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** static __inline__ \
1303:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** void loadRow(uint16_t rowNum) \
1304:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	__attribute__((__always_inline__));
1305:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** */
1306:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1307:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Returns TRUE when the frame is complete
1308:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Should send nada (and maybe hsyncs?) thereafter(?)
1309:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // In sdramThing2.0, when this returns TRUE, the SDRAM loading is complete
1310:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // EXCEPT: the final HD_Dots' FR_READ/ACTIVATE commands will point to a
1311:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  non-existent "next" Hsync... these commands need to be rewritten to
1312:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  point to the "first" Hsync. This is handled in sdramThing2.0's code
1313:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Used to be:
1314:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //SIGNAL(TIMER0_COMPA_vect)
1315:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //a/o v0.60: lcd_update() now returns the row-number (0 to V_COUNT-1)
1316:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //           Not *entirely* accurate, as it may be negative during VBLANK
1317:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //           OR returns LCD_FRAMECOMPLETE when that's the case.
1318:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DOES THIS RETURN THE ROW THAT WAS DRAWN OR THE NEXT...?
1319:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define LCD_FRAMECOMPLETE	INT16_MAX
1320:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** int16_t lcd_update(void)
1321:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
 1998               		.stabn	68,0,1321,.LM218-.LFBB19
 1999               	.LM218:
 2000               	.LFBB19:
 2001 0770 CF93      		push r28
 2002 0772 DF93      		push r29
 2003               	/* prologue: function */
 2004               	/* frame size = 0 */
 2005               	/* stack size = 2 */
 2006               	.L__stack_usage = 2
1322:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //	uint8_t frameComplete = FALSE;
1323:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1324:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #warning "this might be off by one, which would explain the weird first row"
1325:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	int16_t rowNum = hsyncCount - T_DV-T_VD-T_Vlow;
 2007               		.stabn	68,0,1325,.LM219-.LFBB19
 2008               	.LM219:
 2009 0774 C091 0000 		lds r28,hsyncCount
 2010 0778 D091 0000 		lds r29,hsyncCount+1
 2011 077c A897      		sbiw r28,40
1326:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//static uint8_t frameCount = 0;
1327:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1328:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if 0 // (defined(SLOW_EVERYTHING_TEST) && SLOW_EVERYTHING_TEST)
1329:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	while(TCNT0L != 7){};
1330:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//This won't work... who knows how many cycles interrupt-entry will be
1331:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//Above should fix that...
1332:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//I think this was just an indicator for scope triggering...
1333:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// not relevent for 
1334:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	setpinPORT(PB2, PORTB);
1335:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	clrpinPORT(PB2, PORTB);
1336:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1337:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1338:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//Hsync and Actually draw the pixels... (when DE is active)
1339:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// This takes a LONG time and will occupy most of the CPU...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 90


1340:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//  ... IN THIS INTERRUPT
1341:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//loadData(((hsyncCount-T_VD-T_Vlow)>>3)&31, dataEnable,colorOverride);
1342:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //	loadData(hsyncCount-T_DV-T_VD-T_Vlow, dataEnable);
1343:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	loadData(rowNum, dataEnable);
 2012               		.stabn	68,0,1343,.LM220-.LFBB19
 2013               	.LM220:
 2014 077e 2091 0000 		lds r18,dataEnable
 2015               	.LBB228:
 2016               	.LBB229:
 2017               	.LBB230:
 2018               	.LBB231:
 2019               		.stabs	"_options/writeColor.c",132,0,0,.Ltext14
 2020               	.Ltext14:
   1:_options/writeColor.c **** /* mehPL:
   2:_options/writeColor.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:_options/writeColor.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:_options/writeColor.c ****  *    Please see the bottom.
   5:_options/writeColor.c ****  *    Enjoy!
   6:_options/writeColor.c ****  */
   7:_options/writeColor.c **** 
   8:_options/writeColor.c **** 
   9:_options/writeColor.c **** 
  10:_options/writeColor.c **** 
  11:_options/writeColor.c **** 
  12:_options/writeColor.c **** 
  13:_options/writeColor.c **** 
  14:_options/writeColor.c **** 
  15:_options/writeColor.c **** 
  16:_options/writeColor.c **** 
  17:_options/writeColor.c **** //writeColor() is a hokey method to draw individual pixels from a buffer,
  18:_options/writeColor.c **** //either a row-buffer or a frame-buffer.
  19:_options/writeColor.c **** // I say "hokey" because the associated drawPix() function has individual
  20:_options/writeColor.c **** // calls to writeColor(), rather than putting them in a for-loop... in
  21:_options/writeColor.c **** // order to save instruction-cycles, and increase resolution...
  22:_options/writeColor.c **** 
  23:_options/writeColor.c **** //As-Implemented
  24:_options/writeColor.c **** //Frame-Buffer:
  25:_options/writeColor.c **** // The pixels' color-data are stored in this buffer, two bits each R,G,B.
  26:_options/writeColor.c **** // Thus, it's easy to write a color-value, but all processing to convert
  27:_options/writeColor.c **** // that color-value into register-settings is done *during* the drawing...
  28:_options/writeColor.c **** // So, it's pretty slow to process each "pixel", and thus each pixel in the
  29:_options/writeColor.c **** // buffer is stretched horizontally across *several* physical LCD pixels
  30:_options/writeColor.c **** //Row-Buffer:
  31:_options/writeColor.c **** // This should be called "Row-Settings-Buffer" or something similar...
  32:_options/writeColor.c **** // The pixels' color-data is stored as packed register-values to be written
  33:_options/writeColor.c **** // at the time of drawing. The buffer itself does *not* consist of raw
  34:_options/writeColor.c **** // color-values, so it is a bit more difficult to explain.
  35:_options/writeColor.c **** // It still takes several instructions to load the registers for each
  36:_options/writeColor.c **** // color, so it still stretches each "pixel" across several LCD pixels.
  37:_options/writeColor.c **** // But it's significantly faster, so the horizontal resolution is higher.
  38:_options/writeColor.c **** 
  39:_options/writeColor.c **** 
  40:_options/writeColor.c **** //For Red and Green (NOT Blue) This enables four shades, instead of three
  41:_options/writeColor.c **** // (including black)
  42:_options/writeColor.c **** // Doing so increases pixel-processing time, thus the pixel-widths
  43:_options/writeColor.c **** // (thus decreasing resolution)
  44:_options/writeColor.c **** // each color takes 9 cycles to process in three-shade mode
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 91


  45:_options/writeColor.c **** // or 12 cycles for red and green, plus 9 for blue in four-shade mode
  46:_options/writeColor.c **** // a/o v59: I don't think this does anything in ROW_SEG_BUFFER
  47:_options/writeColor.c **** #define FOUR_SHADES TRUE
  48:_options/writeColor.c **** 
  49:_options/writeColor.c **** #if(defined(FOUR_SHADES) && FOUR_SHADES)
  50:_options/writeColor.c ****  //a/o v60
  51:_options/writeColor.c ****  //I can't find this anywhere else... Might not be looking hard enough
  52:_options/writeColor.c ****  #define	NUM_COLORS	(4*4*3) //48
  53:_options/writeColor.c **** #else
  54:_options/writeColor.c ****  #define NUM_COLORS (3*3*3) //27
  55:_options/writeColor.c **** #endif
  56:_options/writeColor.c **** 
  57:_options/writeColor.c **** 
  58:_options/writeColor.c **** 
  59:_options/writeColor.c **** #if(!defined(ROW_BUFFER) || !ROW_BUFFER)
  60:_options/writeColor.c ****  #include "_options/frameBuffer.c"
  61:_options/writeColor.c **** #else
  62:_options/writeColor.c ****  #include "_options/rowBuffer.c"
  63:_options/writeColor.c **** 
  64:_options/writeColor.c ****  //FB_WIDTH should probably be renamed...
  65:_options/writeColor.c ****  #define FB_WIDTH (RB_WIDTH)
  66:_options/writeColor.c **** #endif
  67:_options/writeColor.c **** 
  68:_options/writeColor.c **** 
  69:_options/writeColor.c **** 
  70:_options/writeColor.c **** 
  71:_options/writeColor.c **** // LVDS/FPD-Link timing:
  72:_options/writeColor.c **** 
  73:_options/writeColor.c **** //            |<--- (LCDdirectLVDS: "pixel") --->|
  74:_options/writeColor.c **** //  Timer1:   |<-- One Timer1 Cycle (OCR1C=6) -->|
  75:_options/writeColor.c **** //  TCNT:     |  0   1    2    3    4    5    6  |  0   1    2    3    
  76:_options/writeColor.c **** //            |____.____.____.____               |____.____.____.____
  77:_options/writeColor.c **** //  RXclk+:   /         |         \    .    .    /         |         \ //
  78:_options/writeColor.c **** //            |         |            |         |
  79:_options/writeColor.c **** // One Pixel: |         |<--- One FPD-Link Pixel Cycle --->|
  80:_options/writeColor.c **** //            |                                  |
  81:_options/writeColor.c **** // "Blue/DVH" |____ ____v____ ____ ____v____ ____|____ ____
  82:_options/writeColor.c **** //  RXin2:    X B3 X B2 X DE X /V X /H X B5 X B4 X B3 X B2 X ...
  83:_options/writeColor.c **** //            | ^  ^ | 
  84:_options/writeColor.c **** //            |         |<--Not Blue-->|         |
  85:_options/writeColor.c **** //            |                                  |
  86:_options/writeColor.c **** // "Green"    |____ ____v____ ____v____ ____ ____|____ ____
  87:_options/writeColor.c **** //  RXin1:    X G2 X G1 X B1 X B0 X G5 X G4 X G3 X G2 X G1 X ...
  88:_options/writeColor.c **** //            | ^ ^  |  
  89:_options/writeColor.c **** //            |         |<------->|-Not Green    |
  90:_options/writeColor.c **** //
  91:_options/writeColor.c **** // "Red"      |____ ____v____v____ ____ ____ ____|____ ____
  92:_options/writeColor.c **** //  RXin0:    X R1 X R0 X G0 X R5 X R4 X R3 X R2 X R1 X R0 X ...
  93:_options/writeColor.c **** //            | ^^     
  94:_options/writeColor.c **** //            |         |<-->|-Not Red
  95:_options/writeColor.c **** //
  96:_options/writeColor.c **** //   Of course: The Not Green/Red bits above are low-bits and
  97:_options/writeColor.c **** //              basically have little/no visible effect
  98:_options/writeColor.c **** //
  99:_options/writeColor.c **** //
 100:_options/writeColor.c **** 
 101:_options/writeColor.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 92


 102:_options/writeColor.c **** 
 103:_options/writeColor.c **** 
 104:_options/writeColor.c **** //#if(!defined(ROW_SEG_BUFFER) || !ROW_SEG_BUFFER)
 105:_options/writeColor.c **** 
 106:_options/writeColor.c **** 
 107:_options/writeColor.c **** //WRITE_COLOR_CYCS is the number of CPU clock-cycles each call to
 108:_options/writeColor.c **** //writeColor() takes (minus the delay)
 109:_options/writeColor.c **** // This value is determined by the code/optimizer, often by looking into
 110:_options/writeColor.c **** // the .lss file, and/or determined by the number of asm instructions.
 111:_options/writeColor.c **** // It's only used in calculations for determining how much delay to add to
 112:_options/writeColor.c **** // stretch pixels to fill the screen...
 113:_options/writeColor.c **** // Changing the value to something inaccurate doesn't really change the
 114:_options/writeColor.c **** // writeColor() code, at all, it merely affects the associated
 115:_options/writeColor.c **** // stretching-delays.
 116:_options/writeColor.c **** // E.G. If somehow the math works out that the image isn't stretched all
 117:_options/writeColor.c **** // the way across the screen, *shrinking* the number of WRITE_COLOR_CYCS
 118:_options/writeColor.c **** // would cause *increased* WRITE_COLOR_DELAYs, but since the actual number
 119:_options/writeColor.c **** // of cycles taken by writeColor() doesn't change, this has the effect of
 120:_options/writeColor.c **** // merely increasing the delay until the next writeColor.
 121:_options/writeColor.c **** // THIS IS NOT GOOD HABIT
 122:_options/writeColor.c **** // But it is the way it's coded.
 123:_options/writeColor.c **** // Ideally, the math would work out properly, and WRITE_COLOR_CYCS would be
 124:_options/writeColor.c **** // best if it was the *actual* number of cycles it takes to complete a call
 125:_options/writeColor.c **** // to writeColor() (again, minus the delay)
 126:_options/writeColor.c **** // ... as it is used in calculations elsewhere, as well.
 127:_options/writeColor.c **** 
 128:_options/writeColor.c **** 
 129:_options/writeColor.c **** //If writeColor is defined elsewhere, then so must be WRITE_COLOR_CYCS
 130:_options/writeColor.c **** // So don't define it here...
 131:_options/writeColor.c **** // (e.g. for _interfaces/6bitParallel.c for the Sony LCD)
 132:_options/writeColor.c **** #ifndef WRITE_COLOR_CYCS
 133:_options/writeColor.c **** #if(defined(__AVR_AT90PWM161__))
 134:_options/writeColor.c ****  #if(defined(ROW_BUFFER) && ROW_BUFFER)
 135:_options/writeColor.c ****   //This is just an estimate:
 136:_options/writeColor.c ****   //Figured (roughly) from the .lss
 137:_options/writeColor.c ****   #define WRITE_COLOR_CYCS 27//18
 138:_options/writeColor.c ****  #else
 139:_options/writeColor.c ****   #define WRITE_COLOR_CYCS 38//56
 140:_options/writeColor.c ****   //This value determined from .lss
 141:_options/writeColor.c ****   // probably not 100% accurate.
 142:_options/writeColor.c ****   //And kinda surprising it's so much more than the others...
 143:_options/writeColor.c ****   // a/o v71: This has been modified to stretch it better across the
 144:_options/writeColor.c ****   // screen... for FB_TESTING (FB_QUESTION) and may no longer work with
 145:_options/writeColor.c ****   // ROW_BUFFER, etc. 
 146:_options/writeColor.c ****  #endif
 147:_options/writeColor.c **** #else	//ATtiny861
 148:_options/writeColor.c ****  #if(defined(ROW_BUFFER) && ROW_BUFFER)
 149:_options/writeColor.c ****  //THIS IS JUST AN ESTIMATE
 150:_options/writeColor.c ****   #define WRITE_COLOR_CYCS   (13)
 151:_options/writeColor.c ****  #elif(defined(FOUR_SHADES) && FOUR_SHADES)
 152:_options/writeColor.c ****   // Roughly...
 153:_options/writeColor.c ****   #define WRITE_COLOR_CYCS   (12*2+9+3)
 154:_options/writeColor.c ****  #else
 155:_options/writeColor.c ****   // Roughly...
 156:_options/writeColor.c ****   #define WRITE_COLOR_CYCS   (9*3+3)
 157:_options/writeColor.c ****  #endif
 158:_options/writeColor.c **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 93


 159:_options/writeColor.c **** #endif //WRITE_COLOR_CYCS wasn't predefined...
 160:_options/writeColor.c **** 
 161:_options/writeColor.c **** 
 162:_options/writeColor.c **** //If it's already been included elsewhere, then it won't recalculate...
 163:_options/writeColor.c **** // (since everything's #included in such roundabout ways...)
 164:_options/writeColor.c **** #include "writeColorDelay.h"
 165:_options/writeColor.c **** 
 166:_options/writeColor.c **** /*
 167:_options/writeColor.c **** //WRITE_COLOR_DELAY attempts to stretch each pixel such that the total
 168:_options/writeColor.c **** //number of horizontal pixels (e.g. FB_WIDTH) will stretch across the
 169:_options/writeColor.c **** //screen. It takes into account the number of cycles it takes to extract
 170:_options/writeColor.c **** //the color register-values from the buffer, and load them into the
 171:_options/writeColor.c **** //registers. It's entirely plausible it will be negative, if e.g.
 172:_options/writeColor.c **** //FB_WIDTH * WRITE_COLOR_CYCS > DE_CYC
 173:_options/writeColor.c **** //(i.e. you've chosen an FB_WIDTH that's too large for the screen)
 174:_options/writeColor.c **** //The math is loose, e.g.:
 175:_options/writeColor.c **** // WRITE_COLOR_CYCS is, unless done entirely in assembly, usually an
 176:_options/writeColor.c **** //  estimate 
 177:_options/writeColor.c **** // There's no rounding, and integer division...
 178:_options/writeColor.c **** // There's nothing stopping you from setting an FB_WIDTH too large...
 179:_options/writeColor.c **** //So it's likely the resulting image will be skinnier (or wider?) than the
 180:_options/writeColor.c **** // display...
 181:_options/writeColor.c **** //Calcs:
 182:_options/writeColor.c **** // DE_CYC = FB_WIDTH * ( WRITE_COLOR_CYCS + WRITE_COLOR_DELAY )
 183:_options/writeColor.c **** // DE_CYC/FB_WIDTH = WRITE_COLOR_CYCS + WRITE_COLOR_DELAY
 184:_options/writeColor.c **** // WRITE_COLOR_DELAY = DE_CYC/FB_WIDTH - WRITE_COLOR_CYCS
 185:_options/writeColor.c **** // Not sure why -4 is necessary... overhead in delayCyc?
 186:_options/writeColor.c **** #define WRITE_COLOR_DELAY_PRETEST \
 187:_options/writeColor.c **** 	( DOTS_TO_CYC(DE_ACTIVE_DOTS) / FB_WIDTH - WRITE_COLOR_CYCS-4)
 188:_options/writeColor.c **** 
 189:_options/writeColor.c **** #if(WRITE_COLOR_DELAY_PRETEST < 0)
 190:_options/writeColor.c ****  #define WRITE_COLOR_DELAY 0
 191:_options/writeColor.c ****  #warning "WRITE_COLOR_DELAY < 0, your FB_WIDTH is possibly too large for the screen..."
 192:_options/writeColor.c **** // #error "problem here..."
 193:_options/writeColor.c **** #elif(WRITE_COLOR_DELAY_PRETEST >127)
 194:_options/writeColor.c ****  #define WRITE_COLOR_DELAY 127
 195:_options/writeColor.c ****  #warning "WRITE_COLOR_DELAY > 127... Tiny FB_WIDTH? HUGE screen? Have fun!"
 196:_options/writeColor.c **** #else
 197:_options/writeColor.c ****  #define WRITE_COLOR_DELAY (WRITE_COLOR_DELAY_PRETEST)
 198:_options/writeColor.c **** #endif
 199:_options/writeColor.c **** */
 200:_options/writeColor.c **** 
 201:_options/writeColor.c **** 
 202:_options/writeColor.c **** 
 203:_options/writeColor.c **** //load a color-value from the frame/row buffer and write the registers
 204:_options/writeColor.c **** 
 205:_options/writeColor.c **** 
 206:_options/writeColor.c **** 
 207:_options/writeColor.c **** //includeDEinit should be TRUE only *once* at the *beginning* of the
 208:_options/writeColor.c **** //drawPix function...
 209:_options/writeColor.c **** // Setting it FALSE does *not* disable DE
 210:_options/writeColor.c **** 
 211:_options/writeColor.c **** #ifndef writeColor	
 212:_options/writeColor.c **** static __inline__ 
 213:_options/writeColor.c **** void writeColor(uint8_t includeDEinit, uint8_t includeDelay, 
 214:_options/writeColor.c **** 																		uint8_t colorVal) 
 215:_options/writeColor.c **** 	__attribute__((__always_inline__));
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 94


 216:_options/writeColor.c **** 
 217:_options/writeColor.c **** #if(defined(__AVR_AT90PWM161__))
 218:_options/writeColor.c **** //This is all the actual/uncommented writeColor() function, below, does...
 219:_options/writeColor.c **** // the actual one uses assembly to align the color-changes' edges
 220:_options/writeColor.c **** // and assures that each pixel is the same width (even though some
 221:_options/writeColor.c **** // branching is necessary)
 222:_options/writeColor.c **** // But you can actually use this one here for fun
 223:_options/writeColor.c **** // (Actually, it's kinda cool, it makes the FB_QUESTION sprites look even
 224:_options/writeColor.c **** //  more 3D)
 225:_options/writeColor.c **** // a/o v70: The above is true if ROW_BUFFER is NOT TRUE.
 226:_options/writeColor.c **** #if 0
 227:_options/writeColor.c ****  void writeColor(uint8_t includeDelay, uint8_t colorVal)
 228:_options/writeColor.c ****  {
 229:_options/writeColor.c **** 	uint8_t redVal = colorVal & 0x03;
 230:_options/writeColor.c **** 	uint8_t greenVal = (colorVal >> 2) & 0x03;
 231:_options/writeColor.c **** 	uint8_t blueVal = (colorVal >> 4) & 0x03;
 232:_options/writeColor.c **** 
 233:_options/writeColor.c **** 	setRed4(redVal);
 234:_options/writeColor.c **** 	setGreen4(greenVal);
 235:_options/writeColor.c **** 	setBlue4(blueVal);
 236:_options/writeColor.c **** 
 237:_options/writeColor.c **** 	if(includeDelay)
 238:_options/writeColor.c **** 		delay_cyc(WRITE_COLOR_DELAY);		
 239:_options/writeColor.c **** 
 240:_options/writeColor.c ****  }
 241:_options/writeColor.c **** #endif
 242:_options/writeColor.c ****  void writeColor(uint8_t includeDEinit, uint8_t includeDelay, 
 243:_options/writeColor.c **** 		 															uint8_t colorVal)
 244:_options/writeColor.c ****  {
 245:_options/writeColor.c **** 
 246:_options/writeColor.c **** #if(defined(ROW_BUFFER) && ROW_BUFFER)
 247:_options/writeColor.c **** 	//see rowBuffer.c for how this is packed...
 248:_options/writeColor.c **** 	//
 249:_options/writeColor.c ****    // In this case, colorVal is actually settingVal...
 250:_options/writeColor.c ****    // Between LDI, these instructions, and OCR/DT register writes
 251:_options/writeColor.c ****    // this is XX cycles... or XX pixels...
 252:_options/writeColor.c **** 	// a/o v70: XX pixels AT LVDS_PRESCALER=1, right......?
 253:_options/writeColor.c **** 
 254:_options/writeColor.c ****    //                              //ldi (colorVal) (2 cyc)
 255:_options/writeColor.c ****    //Red: (temp)
 256:_options/writeColor.c **** 	uint8_t redAndBlue = (colorVal >> 2);
 257:_options/writeColor.c ****  	//uint8_t ocrd = colorVal >> 2;   //mov, shl, shl
 258:_options/writeColor.c ****    //Green:
 259:_options/writeColor.c **** 	uint8_t greenOCR_val = (colorVal & 0x03) + 3;
 260:_options/writeColor.c ****    //uint8_t dt = colorVal & 0x03; //andi
 261:_options/writeColor.c ****    //Blue:
 262:_options/writeColor.c **** 	uint8_t blueOCR_val = (redAndBlue >> 3) + 4;
 263:_options/writeColor.c ****    //uint8_t ocra = ocrd >> 3;      //mov, shl, shl, shl
 264:_options/writeColor.c ****    //And red...
 265:_options/writeColor.c ****    //ocrd &= 0x07;                  //andi
 266:_options/writeColor.c **** 	uint8_t redOCR_val = redAndBlue & 0x07;
 267:_options/writeColor.c ****                                  //out OCRD, out DT, out OCRA
 268:_options/writeColor.c **** #else //NOT ROW_BUFFER (FRAMEBUFFER)
 269:_options/writeColor.c **** 
 270:_options/writeColor.c **** 	 //This is pieced-together from the ATTiny861's writeColor()
 271:_options/writeColor.c **** 	 // and memory...
 272:_options/writeColor.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 95


 273:_options/writeColor.c **** 	 //The basic idea is to set a color in a specific/non-varying number of
 274:_options/writeColor.c **** 	 //instruction-cycles.
 275:_options/writeColor.c **** 	 // Thus, we can't use "if" statements, etc, without paying attention to
 276:_options/writeColor.c **** 	 // the actual assembly output.
 277:_options/writeColor.c **** 	 // Additionally, it would be nice to know exactly how many cycles the
 278:_options/writeColor.c **** 	 // entire function-call takes, so we can determine the number of pixels
 279:_options/writeColor.c **** 	 // that can fit in a DE-active period... 
 280:_options/writeColor.c **** 	 // (How many writeColor() calls can fit horizontally)
 281:_options/writeColor.c **** 	 // Further still, this function is "always inline"
 282:_options/writeColor.c **** 	 // which means that it will be optimized in each usage...
 283:_options/writeColor.c **** 	 // which means that it might compile differently in different calls
 284:_options/writeColor.c **** 	 // (e.g. if one call has a constant-argument and another has a
 285:_options/writeColor.c **** 	 // variable)
 286:_options/writeColor.c **** 	 // which is another reason to use inline-assembly, to assure it's the
 287:_options/writeColor.c **** 	 // exact same number of clock-cycles each time.
 288:_options/writeColor.c **** 	 // That's reserved for later...
 289:_options/writeColor.c **** 
 290:_options/writeColor.c **** 	 // FURTHER STILL:
 291:_options/writeColor.c **** 	 // the optimizer reorganizes things... duh.
 292:_options/writeColor.c **** 	 // Which means that even though these calculations are listed at the
 293:_options/writeColor.c **** 	 // top of the function...
 294:_options/writeColor.c **** 	 // their actual instructions may not occur until later.
 295:_options/writeColor.c **** 	 // The write to OCR-registers would ideally occur simultaneously
 296:_options/writeColor.c **** 	 // such that the red/green/blue edges would align
 297:_options/writeColor.c **** 	 // Without doing this in ASM, we can't guarantee (and I've seen
 298:_options/writeColor.c **** 	 // first-hand) that it can't happen that one OCR is written, the next
 299:_options/writeColor.c **** 	 // is calculated, *then* the next is written.
 300:_options/writeColor.c **** 
 301:_options/writeColor.c **** 	 //First, unpack the colors:
 302:_options/writeColor.c **** 	 uint8_t redVal = colorVal&0x03;
 303:_options/writeColor.c **** 	 //uint8_t greenVal = (colorVal>>2)&0x03;
 304:_options/writeColor.c **** 	 //uint8_t blueVal = (colorVal>>4)&0x03;
 305:_options/writeColor.c **** 	 //The above is optimized below by combining two of the
 306:_options/writeColor.c **** 	 //blue-shifts... It should be smaller
 307:_options/writeColor.c **** 	 uint8_t bgTemp = colorVal>>2;
 308:_options/writeColor.c **** 	 uint8_t greenVal = bgTemp&0x03;
 309:_options/writeColor.c **** 	 uint8_t blueVal = (bgTemp>>2)&0x03;
 310:_options/writeColor.c **** 
 311:_options/writeColor.c **** 	 //Now prep some variables for the register-values
 312:_options/writeColor.c **** 	 // the actual registers will be written all at once at the end
 313:_options/writeColor.c **** 
 314:_options/writeColor.c **** 	 //see setRed4() and setGreen4()...
 315:_options/writeColor.c **** 	 uint8_t redOCR_val   = (redVal + 2);
 316:_options/writeColor.c **** 	 uint8_t greenOCR_val = (greenVal + 3);
 317:_options/writeColor.c **** 
 318:_options/writeColor.c **** 	 //Blue is more difficult, it requires a test
 319:_options/writeColor.c **** 	 // which, when compiled, would likely result in two branches that take
 320:_options/writeColor.c **** 	 // different numbers of clock-cycles
 321:_options/writeColor.c **** 	 uint8_t blueOCR_val = (blueVal + 4);
 322:_options/writeColor.c **** 
 323:_options/writeColor.c **** 	 // So far, none of the above code has any branches (right?)
 324:_options/writeColor.c **** 	 // So it should be a constant number of clock-cycles
 325:_options/writeColor.c **** 	 // (unless an inline-call has a constant as an argument!)
 326:_options/writeColor.c **** 
 327:_options/writeColor.c **** 	 //The following is nothing more than 
 328:_options/writeColor.c **** 	 // if (blueVal == 3) 
 329:_options/writeColor.c **** 	 //     blueOCR_val=8;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 96


 330:_options/writeColor.c **** 
 331:_options/writeColor.c **** 
 332:_options/writeColor.c **** 	 // This has been modified... was a struggle to realize that "0" is
 333:_options/writeColor.c **** 	 // necessary to avoid %0's being clobbered regardless of whether it was
 334:_options/writeColor.c **** 	 // written...
 335:_options/writeColor.c **** 	 // See lvds161.c -> setBlue4()
 336:_options/writeColor.c **** 	 // 
 337:_options/writeColor.c **** 	 //This is NOT AT ALL optimized:
 338:_options/writeColor.c **** 	 // But it is guaranteed to be exactly 3 cycles *in each branch*
 339:_options/writeColor.c **** __asm__ __volatile__
 340:_options/writeColor.c **** 	(                                                        // cycles
 341:_options/writeColor.c **** 	 "cpi   %1, 3 ; \n\t"				// (blueVal == 3) ?     //    1
 342:_options/writeColor.c **** 	 "brne  nothingToDo_%= ; \n\t"	// N: skip next line    // N:2  Y:1
 343:_options/writeColor.c **** 	 "ldi   %0, 8 ; \n\t"            //   blueOCR_val=8      //   .    1
 344:_options/writeColor.c ****   "nothingToDo_%=: \n\t"            // just a jump-to label //   0    0
 345:_options/writeColor.c ****     : "=r" (blueOCR_val) //blueOCR_val is an output-value, "%0"
 346:_options/writeColor.c **** 	 : "r" (blueVal),		//blueVal is an input-value, "%1"
 347:_options/writeColor.c **** 	   "0" (blueOCR_val)
 348:_options/writeColor.c **** 	);
 349:_options/writeColor.c **** 
 350:_options/writeColor.c **** #endif //ROW_BUFFER vs NOT
 351:_options/writeColor.c **** 
 352:_options/writeColor.c **** 	//Now all the OCR_val variables are set
 353:_options/writeColor.c **** 	// write them to the registers
 354:_options/writeColor.c **** 	// Locking/unlocking of the PSCs can't occur simultaneously,
 355:_options/writeColor.c **** 	// so it's likely there will be a pixel or two of difference between the
 356:_options/writeColor.c **** 	// transition from one value of blue to the next vs red/green's
 357:_options/writeColor.c **** 	// transition
 358:_options/writeColor.c **** 	lockPSC2();
 359:_options/writeColor.c **** 	lockPSC0();
 360:_options/writeColor.c **** //		OCR2RA = blueOCR_val;
 361:_options/writeColor.c **** //		OCR0SA = redOCR_val;
 362:_options/writeColor.c **** //		OCR0SB = greenOCR_val;
 363:_options/writeColor.c **** //"When addressing the I/O Registers as data space using LD and ST
 364:_options/writeColor.c **** // instructions, 0x20 must be added to these addresses"
 365:_options/writeColor.c **** //"For the Extended I/O space from 0x60-0xFF in SRAM, only the ST... and
 366:_options/writeColor.c **** //LD... instructions can be used"
 367:_options/writeColor.c **** // So, rather than using _SFR_IO_ADDR(), use _SFR_MEM_ADDR()
 368:_options/writeColor.c **** 
 369:_options/writeColor.c **** #warning "lock/unlock should probably occur in asm, as well..."
 370:_options/writeColor.c **** 	if(!includeDEinit)
 371:_options/writeColor.c **** 	{
 372:_options/writeColor.c **** 		__asm__ __volatile__
 373:_options/writeColor.c **** 		(
 374:_options/writeColor.c **** 		 "sts %3, %0; \n\t"
 375:_options/writeColor.c **** 		 "sts %4, %1; \n\t"
 376:_options/writeColor.c **** 		 "sts %5, %2; \n\t"
 377:_options/writeColor.c **** 		 :
 378:_options/writeColor.c **** 		 : "r" (blueOCR_val),	//"%0"
 379:_options/writeColor.c **** 		   "r" (redOCR_val),		//"%1"
 380:_options/writeColor.c **** 			"r" (greenOCR_val),	//"%2"
 381:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR2RAL)), //"%3" //0x2e (0x4e)
 382:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR0SAL)), //"%4"	//(0x60)
 383:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR0SBL)) //"%5"  //0x22 (0x42)
 384:_options/writeColor.c **** 
 385:_options/writeColor.c **** 		);
 386:_options/writeColor.c **** 	} else {
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 97


 387:_options/writeColor.c **** 		uint8_t blueOCR_DE_init = 0;
 388:_options/writeColor.c **** 		__asm__ __volatile__
 389:_options/writeColor.c **** 		(
 390:_options/writeColor.c **** 		 "sts %3, %0; \n\t"
 391:_options/writeColor.c **** 		 "sts %4, %1; \n\t"
 392:_options/writeColor.c **** 		 "sts %5, %2; \n\t"
 393:_options/writeColor.c **** 		 "sts %6, %7; \n\t"
 394:_options/writeColor.c **** 		 :
 395:_options/writeColor.c **** 		 : "r" (blueOCR_val),	//"%0"
 396:_options/writeColor.c **** 		   "r" (redOCR_val),		//"%1"
 397:_options/writeColor.c **** 			"r" (greenOCR_val),	//"%2"
 398:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR2RAL)), //"%3" //0x2e (0x4e)
 399:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR0SAL)), //"%4"	//(0x60)
 400:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR0SBL)), //"%5"  //0x22 (0x42)
 401:_options/writeColor.c **** 			"M" (_SFR_MEM_ADDR(OCR2SAL)), //"%6"
 402:_options/writeColor.c **** 			"r" (blueOCR_DE_init)         //"%7" 
 403:_options/writeColor.c **** 
 404:_options/writeColor.c **** 		);
 405:_options/writeColor.c **** 	}
 406:_options/writeColor.c **** 	unlockPSC0();
 407:_options/writeColor.c **** 	unlockPSC2();
 408:_options/writeColor.c **** 
 409:_options/writeColor.c **** 
 410:_options/writeColor.c **** 	//"Attempt to stretch across the full screen"
 411:_options/writeColor.c **** 	// Not sure if/where this is used... 
 412:_options/writeColor.c **** 	if(includeDelay)
 413:_options/writeColor.c **** 		delay_cyc(WRITE_COLOR_DELAY);
 414:_options/writeColor.c ****  }
 415:_options/writeColor.c **** 
 416:_options/writeColor.c **** 
 417:_options/writeColor.c **** //This should probably test for the TINY861, specifically
 418:_options/writeColor.c **** #else //if(!defined(__AVR_AT90PWM161__))
 419:_options/writeColor.c **** #warning "includeDEinit in writeColor() has not yet been implemented on the Tiny861"
 420:_options/writeColor.c **** void writeColor(uint8_t includeDEinit, uint8_t includeDelay, 
 421:_options/writeColor.c **** 																		uint8_t colorVal)
 422:_options/writeColor.c **** {
 423:_options/writeColor.c **** //#warning "I'm absolutely certain this'll need to be revised, probably asm"
 424:_options/writeColor.c ****    //   Red: (+OC1D => RX0+)
 425:_options/writeColor.c ****    //    Off (0/63): OCR1D = 0
 426:_options/writeColor.c ****    //    35/63:      OCR1D = 3
 427:_options/writeColor.c ****    //    63/63:      OCR1D >= 6
 428:_options/writeColor.c **** 
 429:_options/writeColor.c **** /* No Shit: This compiles to a 16-bit test!
 430:_options/writeColor.c ****    switch((uint8_t)(colorVal & (uint8_t)0x03))
 431:_options/writeColor.c ****    {
 432:_options/writeColor.c ****       case (uint8_t)0:
 433:_options/writeColor.c ****          OCR1D = 0;
 434:_options/writeColor.c ****          break;
 435:_options/writeColor.c ****       case (uint8_t)1:
 436:_options/writeColor.c ****          OCR1D = 3;
 437:_options/writeColor.c ****          break;
 438:_options/writeColor.c ****       case (uint8_t)2:
 439:_options/writeColor.c ****       default:
 440:_options/writeColor.c ****          OCR1D = 6;
 441:_options/writeColor.c ****          break;
 442:_options/writeColor.c ****    }
 443:_options/writeColor.c **** */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 98


 444:_options/writeColor.c **** 
 445:_options/writeColor.c **** #if(defined(ROW_BUFFER) && ROW_BUFFER)
 446:_options/writeColor.c ****    // In this case, colorVal is actually settingVal...
 447:_options/writeColor.c ****    // Between LDI, these instructions, and OCR/DT register writes
 448:_options/writeColor.c ****    // this is 14 cycles... or 16 pixels...
 449:_options/writeColor.c **** 	// a/o v70: 16 pixels AT LVDS_PRESCALER=1, right......?
 450:_options/writeColor.c **** 
 451:_options/writeColor.c ****    //                              //ldi (colorVal) (2 cyc)
 452:_options/writeColor.c ****    //Red: (temp)
 453:_options/writeColor.c ****    uint8_t ocrd = colorVal >> 2;   //mov, shl, shl
 454:_options/writeColor.c ****    //Green:
 455:_options/writeColor.c ****    uint8_t dt = colorVal & 0x03; //andi
 456:_options/writeColor.c ****    //Blue:
 457:_options/writeColor.c ****    uint8_t ocra = ocrd >> 3;      //mov, shl, shl, shl
 458:_options/writeColor.c ****    //And red...
 459:_options/writeColor.c ****    ocrd &= 0x07;                  //andi
 460:_options/writeColor.c ****                                  //out OCRD, out DT, out OCRA
 461:_options/writeColor.c **** #else //NOT ROW_BUFFER (FRAMEBUFFER)
 462:_options/writeColor.c **** 
 463:_options/writeColor.c **** //a/o v67: I didn't make very clear notes here, but have been using it for
 464:_options/writeColor.c **** //quite some time. As I recall, the purpose of moving this to asm, instead
 465:_options/writeColor.c **** //of just using switch() statements, is in order to assure that regardless
 466:_options/writeColor.c **** //of the color-value, the same number of instruction-cycles will be
 467:_options/writeColor.c **** //executed... (otherwise, the color-value might affect the width of a
 468:_options/writeColor.c **** //pixel)
 469:_options/writeColor.c **** 
 470:_options/writeColor.c **** //   uint8_t redVal; // = colorVal & 0x03;
 471:_options/writeColor.c ****    uint8_t ocrd;
 472:_options/writeColor.c **** 
 473:_options/writeColor.c **** /*
 474:_options/writeColor.c ****    if(redVal == 0x00)
 475:_options/writeColor.c ****       ocrd = 0;
 476:_options/writeColor.c ****    else if(redVal == 0x01)
 477:_options/writeColor.c ****       ocrd = 3;
 478:_options/writeColor.c ****    else //2, 3
 479:_options/writeColor.c ****       ocrd = 6;
 480:_options/writeColor.c **** */
 481:_options/writeColor.c **** #if(defined(FOUR_SHADES) && FOUR_SHADES)
 482:_options/writeColor.c ****  // "nop; nop; nop;" compiles to just a single nop! 
 483:_options/writeColor.c ****  //"\n\t" or maybe the space is necessary
 484:_options/writeColor.c ****  #define FOUR_SHADES_NOPS "nop ; \n\t nop ; \n\t nop ; \n\t"
 485:_options/writeColor.c **** #else
 486:_options/writeColor.c ****  #define FOUR_SHADES_NOPS "\n\t"
 487:_options/writeColor.c **** #endif
 488:_options/writeColor.c **** 
 489:_options/writeColor.c ****    //Each branch is 9 cycles... (12 with FOUR_SHADES)
 490:_options/writeColor.c **** __asm__ __volatile__
 491:_options/writeColor.c ****    ( "mov    %0, %1    ; \n\t"  // ocrd (redVal) = colorVal           //1
 492:_options/writeColor.c ****      "andi   %0, 0x03  ; \n\t"  // ocrd = ocrd & 0x03                 //1
 493:_options/writeColor.c ****      "brne   red1tst_%=; \n\t"  // if(ocrd != 0x00) jump to red1test  //1`2
 494:_options/writeColor.c ****      "ldi   %0, 0x00   ; \n\t"  // (ocrd==0x00) add some delays       //1 .
 495:_options/writeColor.c ****      "nop            ; \n\t"    //                                    //1 .
 496:_options/writeColor.c ****      "nop            ; \n\t"    //                                    //1 .
 497:_options/writeColor.c ****      "nop            ; \n\t"    //                                    //1 .
 498:_options/writeColor.c ****      FOUR_SHADES_NOPS           //                                    //N .
 499:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"    //   jump to the end                  //2 .
 500:_options/writeColor.c ****                                 // (ocrd_reg = redVal_reg = 0)            .
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 99


 501:_options/writeColor.c ****    "red1tst_%=:"                //"%=" is a unique identifier for this asm.
 502:_options/writeColor.c ****                                 //  invocation, so the label won't be     .
 503:_options/writeColor.c ****                                 //  mistaken from another invocation      .
 504:_options/writeColor.c ****      "cpi   %0, 0x01   ; \n\t"  // if(ocrd-0x01 != 0)               //  1
 505:_options/writeColor.c ****      "brne   red23_%=   ; \n\t" //   jump to red=2,3                //  1`2
 506:_options/writeColor.c ****      FOUR_SHADES_NOPS           //                                  //  N .
 507:_options/writeColor.c ****      "ldi   %0, 0x03   ; \n\t"  // else ocrd = 0x03                 //  1 .
 508:_options/writeColor.c ****      "rjmp   end_%=   ; \n\t"   //      jump to the end             //  2 .
 509:_options/writeColor.c ****    "red23_%=:"                                                      //    .
 510:_options/writeColor.c **** #if (defined(FOUR_SHADES) && FOUR_SHADES)                           //   /.
 511:_options/writeColor.c ****      "cpi   %0, 0x02 ; \n\t"   // if(ocrd-0x02 !=0)               //( . 1
 512:_options/writeColor.c ****      "brne  red3_%=   ; \n\t"  //      jump to red=3              //( . 1`2
 513:_options/writeColor.c ****      "ldi   %0, 0x04 ; \n\t"   // else ocrd=4                     //( . 1 .
 514:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"   //      jump to the end            //( . 2 .
 515:_options/writeColor.c ****    "red3_%=:"                                                     //( .   /
 516:_options/writeColor.c **** #endif                                                            //(  \ /
 517:_options/writeColor.c ****      "ldi   %0, 0x06   ; \n\t"   // ocrd = 0x06                   //    1
 518:_options/writeColor.c ****      "nop            ; \n\t"  // one delay...                     //    1
 519:_options/writeColor.c ****   "end_%=:"
 520:_options/writeColor.c **** 
 521:_options/writeColor.c ****      : "=r" (ocrd)      //Output only "%0"
 522:_options/writeColor.c ****      : "r"  (colorVal)  //colorVal is "%1"
 523:_options/writeColor.c ****      //,  "d0"  (ocrd)     //ocrd is also used for andi, and is %2
 524:_options/writeColor.c ****    );
 525:_options/writeColor.c **** 
 526:_options/writeColor.c **** 
 527:_options/writeColor.c **** //   OCR1D = ocrd;
 528:_options/writeColor.c **** 
 529:_options/writeColor.c **** 
 530:_options/writeColor.c ****    //   Green: (/OC1B => RX1-)          (B1,0 Active, as well as G2,1)
 531:_options/writeColor.c ****    //    Off (6/63): DTL1 = 0
 532:_options/writeColor.c ****    //    38-39/63:      DTL1 = 1
 533:_options/writeColor.c ****    //    62-63/63:      DTL1 = 3
 534:_options/writeColor.c **** /*   switch(colorVal & 0x0C)
 535:_options/writeColor.c ****    {
 536:_options/writeColor.c ****       case 0x00:
 537:_options/writeColor.c ****          DT1 = 0;
 538:_options/writeColor.c ****          break;
 539:_options/writeColor.c ****       case 0x04:
 540:_options/writeColor.c ****          DT1 = 1;
 541:_options/writeColor.c ****          break;
 542:_options/writeColor.c ****       case 0x08:
 543:_options/writeColor.c ****       default:
 544:_options/writeColor.c ****          DT1 = 3;
 545:_options/writeColor.c ****          break;
 546:_options/writeColor.c ****    }
 547:_options/writeColor.c **** */
 548:_options/writeColor.c **** //   uint8_t greenVal = colorVal & 0x0C;
 549:_options/writeColor.c ****    uint8_t dt;
 550:_options/writeColor.c **** /*   if(greenVal == 0x00)
 551:_options/writeColor.c ****       dt=0;
 552:_options/writeColor.c ****    else if(greenVal == 0x04)
 553:_options/writeColor.c ****       dt=1;
 554:_options/writeColor.c ****    else //0x06, 0x0C
 555:_options/writeColor.c ****       dt=3;
 556:_options/writeColor.c **** */
 557:_options/writeColor.c ****    //Each branch is 9 cycles... (12 with FOUR_SHADES)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 100


 558:_options/writeColor.c **** __asm__ __volatile__
 559:_options/writeColor.c ****    ( "mov   %0, %1   ; \n\t"  // dt (greenVal) = colorVal           //1
 560:_options/writeColor.c ****      "andi  %0, 0x0C ; \n\t"  // dt = dt & 0x0C                     //1
 561:_options/writeColor.c ****      "brne  grn4tst_%=; \n\t" // if(dt != 0x00) jump to grn4test    //1`2
 562:_options/writeColor.c ****      "ldi   %0, 0x00 ; \n\t"  // (dt==0x00) add some delays         //1 .
 563:_options/writeColor.c ****      "nop            ; \n\t"  //                                    //1 .
 564:_options/writeColor.c ****      "nop            ; \n\t"  //                                    //1 .
 565:_options/writeColor.c ****      "nop            ; \n\t"  //                                    //1 .
 566:_options/writeColor.c ****      FOUR_SHADES_NOPS         //                                    //N .
 567:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"  //   jump to the end                  //2 .
 568:_options/writeColor.c ****    "grn4tst_%=:"              //"%=" is a unique identifier for this asm.
 569:_options/writeColor.c ****                               //  invocation, so the label won't be     .
 570:_options/writeColor.c ****                               //  mistaken from another invocation      .
 571:_options/writeColor.c ****      "cpi   %0, 0x04 ; \n\t"  // if(dt-0x04 != 0)                   //  1
 572:_options/writeColor.c ****      "brne  grn8C_%= ; \n\t"  //   jump to green=8,C                //  1`2
 573:_options/writeColor.c ****      "ldi   %0, 0x01 ; \n\t"  // else dt = 0x01                     //  1 .
 574:_options/writeColor.c ****      FOUR_SHADES_NOPS         //                                    //  N .
 575:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"  //      jump to the end               //  2 .
 576:_options/writeColor.c ****    "grn8C_%=:"                                                      //    .
 577:_options/writeColor.c **** #if (defined(FOUR_SHADES) && FOUR_SHADES)                           //   /.
 578:_options/writeColor.c ****      "cpi   %0, 0x08 ; \n\t"  // if(dt-0x08 !=0)                  //( . 1
 579:_options/writeColor.c ****      "brne  grn3_%=  ; \n\t"  //    jump to green=3               //( . 1`2
 580:_options/writeColor.c ****      "ldi   %0, 0x02 ; \n\t"  // else dt=2                        //( . 1 .
 581:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"  //      jump to the end             //( . 2 .
 582:_options/writeColor.c ****    "grn3_%=:"                                                     //( .   /
 583:_options/writeColor.c **** #endif                                                            //(  \ /
 584:_options/writeColor.c ****      "ldi   %0, 0x03 ; \n\t"  // dt = 0x03                        //    1
 585:_options/writeColor.c ****      "nop            ; \n\t"  // one delay...                     //    1
 586:_options/writeColor.c ****    "end_%=:"
 587:_options/writeColor.c **** 
 588:_options/writeColor.c ****      : "=r" (dt)      //Output only "%0"
 589:_options/writeColor.c ****      : "r"  (colorVal)  //colorVal is "%1"
 590:_options/writeColor.c ****      //,  "d0"  (ocrd)     //ocrd is also used for andi, and is %2
 591:_options/writeColor.c ****    );
 592:_options/writeColor.c **** 
 593:_options/writeColor.c **** 
 594:_options/writeColor.c **** 
 595:_options/writeColor.c **** //   DT1 = dt;
 596:_options/writeColor.c ****    //   Blue: (+OC1A => RX2+)               (B3,2 Active from here down)
 597:_options/writeColor.c ****    //    Off (15/63):  OCR1A=4
 598:_options/writeColor.c ****    //    47/63:        OCR1A=5
 599:_options/writeColor.c ****    //    63/63:        OCR1A=6
 600:_options/writeColor.c **** /*   switch(colorVal & 0x30)
 601:_options/writeColor.c ****    {
 602:_options/writeColor.c ****       case 0x00:
 603:_options/writeColor.c ****          OCR1A = 4;
 604:_options/writeColor.c ****          break;
 605:_options/writeColor.c ****       case 0x10:
 606:_options/writeColor.c ****          OCR1A = 5;
 607:_options/writeColor.c ****          break;
 608:_options/writeColor.c ****       case 0x20:
 609:_options/writeColor.c ****       default:
 610:_options/writeColor.c ****          OCR1A = 6;
 611:_options/writeColor.c ****          break;
 612:_options/writeColor.c ****    }
 613:_options/writeColor.c **** */
 614:_options/writeColor.c **** //   uint8_t blueVal = colorVal & 0x30;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 101


 615:_options/writeColor.c ****    uint8_t ocra;
 616:_options/writeColor.c **** /*   if(blueVal == 0x00)
 617:_options/writeColor.c ****       ocra=4;
 618:_options/writeColor.c ****    else if(blueVal == 0x10)
 619:_options/writeColor.c ****       ocra=5;
 620:_options/writeColor.c ****    else //0x20, 0x30
 621:_options/writeColor.c ****       ocra=6;
 622:_options/writeColor.c **** */
 623:_options/writeColor.c **** 
 624:_options/writeColor.c ****    //Each branch is 9 cycles...
 625:_options/writeColor.c **** __asm__ __volatile__
 626:_options/writeColor.c ****    ( "mov   %0, %1   ; \n\t"  // ocra (blueVal) = colorVal          //1
 627:_options/writeColor.c ****      "andi  %0, 0x30 ; \n\t"  // ocra = ocra & 0x30                 //1
 628:_options/writeColor.c ****      "brne  blu1tst_%=; \n\t" // if(ocra != 0x00) jump to red1test  //1`2
 629:_options/writeColor.c ****      "ldi   %0, 0x04 ; \n\t"  // (ocra==0x00) add some delays       //1 .
 630:_options/writeColor.c ****      "nop            ; \n\t"  //                                    //1 .
 631:_options/writeColor.c ****      "nop            ; \n\t"  //                                    //1 .
 632:_options/writeColor.c ****      "nop            ; \n\t"  //                                    //1 .
 633:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"  //   jump to the end                  //2 .
 634:_options/writeColor.c ****                               // (ocra_reg = blueVal_reg = 0)            .
 635:_options/writeColor.c ****    "blu1tst_%=:"              //"%=" is a unique identifier for this asm.
 636:_options/writeColor.c ****                               //  invocation, so the label won't be     .
 637:_options/writeColor.c ****                               //  mistaken from another invocation      .
 638:_options/writeColor.c ****      "cpi   %0, 0x10 ; \n\t"  // if(ocra-0x10 != 0)                 //  1
 639:_options/writeColor.c ****      "brne  blu23_%= ; \n\t"  //   jump to red=2,3                  //  1`2
 640:_options/writeColor.c ****      "ldi   %0, 0x05 ; \n\t"  // else ocra = 0x05                   //  1 .
 641:_options/writeColor.c ****      "rjmp  end_%=   ; \n\t"  //      jump to the end               //  2 .
 642:_options/writeColor.c ****    "blu23_%=:"                                                      //    .
 643:_options/writeColor.c ****      "ldi   %0, 0x06 ; \n\t"  // ocra = 0x06                        //    1
 644:_options/writeColor.c ****      "nop            ; \n\t"  // one delay...                       //    1
 645:_options/writeColor.c ****    "end_%=:"
 646:_options/writeColor.c **** 
 647:_options/writeColor.c ****      : "=r" (ocra)      //Output only "%0"
 648:_options/writeColor.c ****      : "r"  (colorVal)  //colorVal is "%1"
 649:_options/writeColor.c ****      //,  "d0"  (ocra)     //ocra is also used for andi, and is %2
 650:_options/writeColor.c ****    );
 651:_options/writeColor.c **** 
 652:_options/writeColor.c **** #endif //SETTING vs. FRAMEBUFFER
 653:_options/writeColor.c **** 
 654:_options/writeColor.c ****    DT1 = dt;
 655:_options/writeColor.c ****    OCR1D = ocrd;
 656:_options/writeColor.c ****    OCR1A = ocra;
 657:_options/writeColor.c **** 
 658:_options/writeColor.c **** 	if(includeDelay)
 659:_options/writeColor.c **** 		//Attempt to stretch across the full screen...
 660:_options/writeColor.c **** 		delay_cyc(WRITE_COLOR_DELAY);
 661:_options/writeColor.c **** }
 662:_options/writeColor.c **** #endif //AT90PWM161 or not...
 663:_options/writeColor.c **** //#endif //!ROW_SEG_BUFFER
 664:_options/writeColor.c **** #endif //writeColor not defined as a macro...
 665:_options/writeColor.c **** 
 666:_options/writeColor.c **** 
 667:_options/writeColor.c **** 
 668:_options/writeColor.c **** 
 669:_options/writeColor.c **** 
 670:_options/writeColor.c **** 
 671:_options/writeColor.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 102


 672:_options/writeColor.c **** 
 673:_options/writeColor.c **** 
 674:_options/writeColor.c **** /*
 675:_options/writeColor.c **** static __inline__ \
 676:_options/writeColor.c **** void writeColor(uint8_t includeDelay, uint8_t colorVal) \
 677:_options/writeColor.c ****      __attribute__((__always_inline__));
 678:_options/writeColor.c **** */
 679:_options/writeColor.c **** 
 680:_options/writeColor.c **** 
 681:_options/writeColor.c **** 
 682:_options/writeColor.c **** //This drawPix was developed before RowSegBuffer
 683:_options/writeColor.c **** // there are two versions included: RowBuffer and FrameBuffer
 684:_options/writeColor.c **** // which function almost identically as far as this function's concerned
 685:_options/writeColor.c **** 
 686:_options/writeColor.c **** // After writeColor()s are called, the remaining is (a/o v60) identical
 687:_options/writeColor.c **** // to rsb_drawPix, as it was a result of an:
 688:_options/writeColor.c **** //#if(!ROW_SEG_BUFFER)
 689:_options/writeColor.c **** // void drawPix(uint8_t rowNum)
 690:_options/writeColor.c **** // {
 691:_options/writeColor.c **** //  	do writeColorStuff...
 692:_options/writeColor.c **** //#else
 693:_options/writeColor.c **** // void drawPix(uint8_t rowNum)
 694:_options/writeColor.c **** // {
 695:_options/writeColor.c **** //		do rowSegBufferStuff...
 696:_options/writeColor.c **** //#endif
 697:_options/writeColor.c **** //    do remaining Stuff...
 698:_options/writeColor.c **** // }
 699:_options/writeColor.c **** 
 700:_options/writeColor.c **** // But nonRSB stuff hasn't been tested in quite some time...
 701:_options/writeColor.c **** 
 702:_options/writeColor.c **** #if(defined(WC_SETUP) && WC_SETUP)
 703:_options/writeColor.c **** uint8_t *wc_color; 
 704:_options/writeColor.c **** 
 705:_options/writeColor.c **** #define drawPixSetup	writeColor_drawPixSetup
 706:_options/writeColor.c **** #endif
 707:_options/writeColor.c **** 
 708:_options/writeColor.c **** 
 709:_options/writeColor.c **** static __inline__
 710:_options/writeColor.c **** uint8_t * writeColor_drawPixSetup(uint16_t rowNum)
 711:_options/writeColor.c **** 	__attribute__((__always_inline__));
 712:_options/writeColor.c **** 
 713:_options/writeColor.c **** uint8_t * writeColor_drawPixSetup(uint16_t rowNum)
 714:_options/writeColor.c **** {
 715:_options/writeColor.c **** 
 716:_options/writeColor.c **** #if(!defined(WC_SETUP) || !WC_SETUP)
 717:_options/writeColor.c **** 	uint8_t *wc_color;
 718:_options/writeColor.c **** #endif
 719:_options/writeColor.c **** 
 720:_options/writeColor.c **** #if(defined(ROW_BUFFER) && ROW_BUFFER)
 721:_options/writeColor.c ****    wc_color = &(rowBuffer[0]);
 722:_options/writeColor.c **** #else
 723:_options/writeColor.c **** 	rowNum = rowNum*FB_HEIGHT / V_COUNT;
 2021               		.stabn	68,0,723,.LM221-.LFBB19
 2022               	.LM221:
 2023 0782 CE01      		movw r24,r28
 2024 0784 34E0      		ldi r19,4
 2025               		1:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 103


 2026 0786 880F      		lsl r24
 2027 0788 991F      		rol r25
 2028 078a 3A95      		dec r19
 2029 078c 01F4      		brne 1b
 2030 078e 60EA      		ldi r22,lo8(-96)
 2031 0790 70E0      		ldi r23,0
 2032 0792 00D0      		rcall __udivmodhi4
 2033 0794 CB01      		movw r24,r22
 724:_options/writeColor.c **** //	rowNum &= 0x0f;
 725:_options/writeColor.c **** 	wc_color = &(frameBuffer[rowNum][0]);
 2034               		.stabn	68,0,725,.LM222-.LFBB19
 2035               	.LM222:
 2036 0796 61E1      		ldi r22,lo8(17)
 2037 0798 70E0      		ldi r23,0
 2038 079a 00D0      		rcall __mulhi3
 2039 079c 8050      		subi r24,lo8(-(frameBuffer))
 2040 079e 9040      		sbci r25,hi8(-(frameBuffer))
 2041 07a0 9093 0000 		sts wc_color+1,r25
 2042 07a4 8093 0000 		sts wc_color,r24
 2043               	.LBE231:
 2044               	.LBE230:
 2045               		.stabs	"_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c",132,0,0,.Ltext15
 2046               	.Ltext15:
1344:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1345:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	hsyncCount++;
1346:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1347:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	switch(hsyncCount)
1348:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	{
1349:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//V Front Porch, begins with initLCD
1350:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1351:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Vsync H->L (Begin V-Sync)
1352:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		case T_DV:
1353:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			dataEnable = FALSE;
1354:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			//clrpinPORT(VSYNC_PIN, VSYNC_PORT);
1355:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			vSync = TRUE;
1356:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			Vsync_fromNada();
1357:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			break;
1358:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Vsync L->H (Begin V Back Porch)
1359:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		case T_Vlow + T_DV:
1360:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//	if(hfm_nextOutput(&modulator))
1361:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//		colorOverride = 0xff;
1362:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//	else
1363:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//		colorOverride = 7;
1364:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			//setpinPORT(VSYNC_PIN, VSYNC_PORT);
1365:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			vSync = FALSE;
1366:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			Nada_fromVsync();
1367:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			break;
1368:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Start of frame (DE active)
1369:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		case T_VD +(T_Vlow + T_DV):
1370:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			dataEnable = TRUE;
1371:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			break;
1372:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// All rows have been displayed
1373:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// Return to V Front Porch
1374:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		case V_COUNT +(T_VD + T_Vlow + T_DV):
1375:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			dataEnable = FALSE;
1376:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//	break;
1377:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Frame complete
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 104


1378:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//case HSYNC_COUNT_FRAME_COMPLETE:
1379:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			//T_DV +(V_COUNT+T_VD+T_Vlow) + FRAME_UPDATE_DELAY:
1380:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			hsyncCount = 0;
1381:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if 0 //(FRAME_COUNT_TO_DELAY != 0)
1382:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			//static uint8_t frameCount = 0;
1383:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			frameCount++;
1384:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			if(frameCount == FRAME_COUNT_TO_DELAY)
1385:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			{
1386:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 				frameCount = 0;
1387:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 				timer_compareMatchIntSetup(0, OUT_CHANNELA, FALSE);
1388:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 				//timer_compareMatchIntDisable(0, OUT_CHANNELA);
1389:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			}
1390:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1391:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			
1392:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#warning "NewNote: WTF, are we relying on loadData to have properly set the mode?"
1393:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Yeah, guess that makes sense... Must be Nada...
1394:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			//frameComplete = TRUE;
1395:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			rowNum = LCD_FRAMECOMPLETE;
1396:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			break;
1397:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		default:
1398:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			break;
1399:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	}
1400:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1401:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1402:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //a/o 0.56ncf-1 (LCDdirectLVDS70)
1403:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // the call to loadRow is handled in the main project... and maybe it's
1404:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // best that way.
1405:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1406:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if 0 //(defined(LOADROW) && LOADROW)
1407:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//Load the next row into the row(seg)buffer
1408:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//data is enabled after T_VD+T_Vlow...
1409:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	if((hsyncCount >= T_VD+T_Vlow) && (hsyncCount < T_VD+T_Vlow+V_COUNT))
1410:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		loadRow(hsyncCount - (T_VD+T_Vlow));
1411:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1412:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1413:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//This note was written long before the above was commented-out...
1414:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//So...?
1415:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// Here is where loadRow used to be called
1416:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// it has been moved to oldNotes.txt, but it would make more sense
1417:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// to look at LCDdirectLVDS <25 or LCDdirect
1418:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// loadRow used the time between DE inactive and the next Hsync
1419:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// to load a row to a row-buffer (as opposed to a frame-buffer)
1420:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// thus, DE could gain more pixels because there would be fewer
1421:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// calculations to determine the memory location to write from
1422:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// This effect has since been minimized
1423:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// BUT loadRow might be necessary for program-memory-based images...
1424:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1425:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	return rowNum; //frameComplete;
1426:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1427:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1428:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1429:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //See LCDdirectLVDS for an example...
1430:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // basically it loads a single row into a buffer for the next dateEnable
1431:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  (either the row-buffer or the row-segment-buffer) 
1432:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // This has been *greatly* reduced, is not at all functional, just
1433:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // to give an idea of loadRow's purpose.
1434:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if 0 //(defined(LOADROW) && LOADROW)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 105


1435:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** void loadRow(uint16_t rowNum)
1436:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
1437:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//e.g....
1438:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	tet_drawRow(rbRowNum, rowBuffer);
1439:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	
1440:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//and...	
1441:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	rowBuffer[i] = fb_to_rb(colorVal);
1442:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	
1443:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//and...
1444:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	if((rbRowNum >= SMILE_TOP_ROW) &&
1445:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			(rbRowNum < (SMILE_HEIGHT+SMILE_TOP_ROW)))
1446:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	{
1447:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			for(i=0; i<FB_WIDTH; i++)
1448:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			{
1449:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****          	temp=pgm_readImageByte(pimage, rbRowNum-SMILE_TOP_ROW, i);
1450:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 				if(!(temp & 0xC0))
1451:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 					rowBuffer[i+SMILE_SHIFT] = fb_to_rb(temp);
1452:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			}
1453:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	}
1454:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1455:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	life_drawRow(rbRowNum, &(rowBuffer[RB_WIDTH-LIFE_WIDTH]));
1456:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1457:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//HORIZONTAL_COLOR_BARS
1458:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	for(i=0; i<RB_WIDTH; i++)
1459:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		rowBuffer[i] = fb_to_rb(rowNum);
1460:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1461:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//Good for syncing to have white on both borders...
1462:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	newSeg(1, 0x06, (6<<4) | 3);
1463:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	
1464:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1465:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif //LOAD_ROW
1466:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1467:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1468:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Including inactive pixel-clocks (timing)
1469:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // DotCount per row...
1470:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  TOTAL_CYC_COUNT was used for the timer-interrupt in LCDdirectLVDS
1471:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  This was DOTS_TO_CYC(DISPLAY_DOT_COUNT) + ROW_CALCULATION_CYCS
1472:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  ROW_CALCULATION_CYCS was 50,000 (!!!)
1473:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   DOTS_TO_CYC(dots), last-used, was dots*7 (LVDS_PRESCALER nullified /8)
1474:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   So, the overall dot-count per row was... 
1475:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     DISPLAY_DOT_COUNT + ROW_CALCULATION_DOTS
1476:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     where ROW_CALCULATION_DOTS = 50,000cyc/7 = 7142 dots
1477:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //     So... the overall dot-count per row was *MUCH* longer than usual
1478:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  Pretty certain there's not nearly enough memory to simulate that
1479:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   (in sdramThing2.0)
1480:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   But It does suggest that it would be worthwhile to try to stretch
1481:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   the rows as much as possible...
1482:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   During this time, NADA is sent normally, (V=H, H=H, DE=L)
1483:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //    Or Vsync (V=L, H=H, DE=L)
1484:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   Maybe something could be simulated with PWM again, if necessary...
1485:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //   (Certainly not at full-speed)
1486:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DISPLAY_DOT_COUNT \
1487:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	(H_LOW_DOTS + HD_DOTS + DE_ACTIVE_DOTS + DH_DOTS)
1488:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1489:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if 0
1490:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1491:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#define T_Hlow_CYC 1//8 //(T_Halow_REAL*3)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 106


1492:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define T_Hlow_CYC DOTS_TO_CYC(H_LOW_DOTS)
1493:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1494:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define T_DE_CYC	DOTS_TO_CYC(DE_ACTIVE_DOTS)
1495:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1496:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#define T_HD_CYC 1//3//(T_HD_REAL*3)
1497:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define T_HD_CYC	DOTS_TO_CYC(HD_DOTS)
1498:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1499:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define T_DH_CYC	DOTS_TO_CYC(DH_DOTS)
1500:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1501:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1502:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1503:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1504:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1505:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** void init_timer0Hsync(void)
1506:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
1507:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//T_HD + T_DH + T_low + T_DE
1508:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// For the original system, 19.865us = 695 dot-clocks
1509:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// We'd need to take advantage of the 16-bit timer
1510:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//  OCR1A may not be written properly (with a temporary high-byte)
1511:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//  ... not sure.
1512:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// TIMER0 DOES NOT HAVE CTC MODE in 16-bit mode
1513:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1514:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // This is a hack, for testing syncability with long row-calculations
1515:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // before actually drawing it... e.g. loading from program memory
1516:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // This value needs to be larger than the calculation time
1517:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // otherwise, it seems, syncing isn't stable
1518:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // BUT THIS IS A HACK, has nothing to do with actual calculation time
1519:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // And for slow LVDS or whatnot, this may be unnecessarily HUGE
1520:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1521:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define DISPLAY_CYC_COUNT	(DOTS_TO_CYC(DISPLAY_DOT_COUNT))
1522:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //	(T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC)
1523:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1524:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //NOTE that with longer ROW_CALCULATION_CYCS, lines can be repeated...
1525:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // apparently an effect of the display, definitely not a code-thing
1526:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // in which case the vertical resolution decreases
1527:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // though, this could be used to advantage... 
1528:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (e.g. more processing time outside the drawing interrupts?)
1529:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // NOTE that if the value is too small and calculations take longer in some
1530:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // lines than others (?), those lines may repeat, or syncing could be off
1531:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (LVDS_PRESCALER == 8)
1532:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  //#define ROW_CALCULATION_DELAY 1//20
1533:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define ROW_CALCULATION_CYCS (50000) //0 //(70000) //(100000)
1534:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #else
1535:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  //#define ROW_CALCULATION_DELAY 9//7//5//2//1//10
1536:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define ROW_CALCULATION_CYCS	(8*DISPLAY_CYC_COUNT)
1537:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1538:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1539:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define TOTAL_CYC_COUNT \
1540:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	(ROW_CALCULATION_CYCS + DISPLAY_CYC_COUNT)
1541:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //	(ROW_CALCULATION_DELAY * (T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC))
1542:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //#define TOTAL_CYC_COUNT 2000
1543:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (TOTAL_CYC_COUNT > 255)
1544:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  //Adding +7 causes it to round up (hopefully)
1545:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define TIMER0_TCNTS ((TOTAL_CYC_COUNT+7)/8)
1546:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define TIMER0_CLKDIV	CLKDIV8
1547:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+7)/8: Timer0 CLKDIV8"
1548:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #if (TIMER0_TCNTS > 255)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 107


1549:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+63)/64: Timer0 CLKDIV64"
1550:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #define TIMER0_TCNTS ((TOTAL_CYC_COUNT+63)/64)
1551:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #define TIMER0_CLKDIV CLKDIV64
1552:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #if (TIMER0_TCNTS > 255)
1553:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	 #warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+255)/256: Timer0 CLKDIV256"
1554:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	 #define TIMER0_TCNTS ((TOTAL_CYC_COUNT+255)/256)
1555:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	 #define TIMER0_CLKDIV CLKDIV256
1556:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	 #if (TIMER0_TCNTS > 255)
1557:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		#warning "TIMER0_TCNTS = (TOTAL_CYC_COUNT+1023)/1024: Timer0 CLKDIV1024"
1558:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		#define TIMER0_TCNTS ((TOTAL_CYC_COUNT+1023)/1024)
1559:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		#define TIMER0_CLKDIV	CLKDIV1024
1560:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	 #endif
1561:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #endif
1562:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #endif
1563:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #if (TIMER0_TCNTS == 0)
1564:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #error "TIMER0_OCRVAL == 0"
1565:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #endif
1566:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #else
1567:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define TIMER0_TCNTS TOTAL_CYC_COUNT
1568:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define TIMER0_CLKDIV CLKDIV1
1569:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1570:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1571:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (defined(SLOW_EVERYTHING_TEST) && SLOW_EVERYTHING_TEST)
1572:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  //For testing, I want to see the pulses with the 'scope
1573:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  // Unless the timer is divisible by 7 the pulses will not align with the
1574:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  // timer overflow...
1575:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  //but shit... it's running at clkdiv8 so each TCNT is 64 bits!
1576:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  // but this shouldn't matter for visualizing, that's only ~10 pixel clocks
1577:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  // and we'll only start visualizing *after* the extra TCNTs...
1578:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  //Since the timer counts from 0 to (and including) OCR1A
1579:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  // Add one to this test...
1580:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #if (((TIMER0_TCNTS + 1) % 7) == 0)
1581:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 1) % 7 == 0"
1582:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS"
1583:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS)
1584:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1585:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 2) % 7) == 0)
1586:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 2) % 7 == 0"
1587:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 1"
1588:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 1)
1589:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1590:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 3) % 7) == 0)
1591:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 3) % 7 == 0"
1592:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 2"
1593:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 2)
1594:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1595:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 4) % 7) == 0)
1596:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 4) % 7 == 0"
1597:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 3"
1598:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 3)
1599:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1600:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 5) % 7) == 0)
1601:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 5) % 7 == 0"
1602:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 4"
1603:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 4)
1604:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1605:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #elif (((TIMER0_TCNTS + 6) % 7) == 0)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 108


1606:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "(TIMER0_TCNTS + 6) % 7 == 0"
1607:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS + 5"
1608:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS + 5)
1609:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1610:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #elif (((TIMER0_TCNTS) % 7) == 0)
1611:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "(TIMER0_TCNTS) % 7 == 0"
1612:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #warning "   so... TIMER0_OCRVAL = TIMER0_TCNTS - 1"
1613:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #define TIMER0_OCRVAL (TIMER0_TCNTS - 1)
1614:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1615:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #else
1616:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #error "WTF?"
1617:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #endif
1618:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #else
1619:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #define TIMER0_OCRVAL (TIMER0_TCNTS-1)
1620:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1621:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1622:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (TIMER0_OCRVAL > 255)
1623:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #error "Despite all my efforts, TIMER0_OCRVAL is *still* > 255!"
1624:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1625:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1626:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    OCR0A = TIMER0_OCRVAL; //T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC;
1627:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	timer_setWGM(0, WGM_CLR_ON_COMPARE);
1628:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    timer_selectDivisor(0, TIMER0_CLKDIV); //CLKDIV1);
1629:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    timer_compareMatchIntEnable(0, OUT_CHANNELA);
1630:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1631:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1632:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #define fullBlue()	DEblue_init()
1633:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1634:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1635:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1636:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //Either use one of the ones here, or define your own...
1637:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // rowNum is the drawable row number on the LCD...
1638:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //static __inline__ void drawPix(uint16_t rowNum);
1639:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1640:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // This should have a uint16 rowNum!
1641:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // But, so far, the only cases which use all 768 rows are LCDdirectLVDS
1642:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // with RowSegBuffer, and sdramThing (how did this uint8_t thing not cause
1643:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // trouble there?!)
1644:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // RowSegBuffer doesn't pay attention to rowNum in drawPix...
1645:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1646:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1647:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** static __inline__ \
1648:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** void drawPix(uint16_t rowNum) \
1649:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	  __attribute__((__always_inline__));
1650:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if 0
1651:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if (!defined(ROW_SEG_BUFFER) || !ROW_SEG_BUFFER)
1652:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //drawPix loads each pixel individually... It doesn't use a for-loop
1653:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // since that would take away from actual pixel-drawing time...
1654:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // I think it's been removed... but here's a (non-functional) example...
1655:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** void drawPix(uint8_t rowNum)
1656:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
1657:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	writeColor(*(color+1));	 
1658:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	writeColor(*(color+2));	 
1659:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	writeColor(*(color+3)); 
1660:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	...
1661:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	writeColor(*(color+61));
1662:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	writeColor(*(color+62));
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 109


1663:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	writeColor(*(color+63));
1664:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// WriteColor writes the pixel *after* the calculations...
1665:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// thus the pixel appears basically after writeColor completes
1666:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// These nops assure the 64th pixel is fully-displayed before exitting
1667:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	asm("nop");
1668:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	...
1669:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	asm("nop");
1670:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1671:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** /*		reg[17] = colorBuffer[rowNum][17];                         
1672:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		writeColor(reg[17]);                         
1673:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		...
1674:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		reg[20] = colorBuffer[rowNum][20];                         
1675:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		writeColor(reg[20]);  
1676:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		
1677:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//REPEATING to fill screen... (delayDots = 342 worked prior to this)
1678:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		reg[0] = colorBuffer[rowNum][0];
1679:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		writeColor(reg[0]);
1680:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		...
1681:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		reg[10] = colorBuffer[rowNum][10];
1682:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		writeColor(reg[10]);
1683:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** */
1684:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Display the rest as black...
1685:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		writeColor(0);
1686:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1687:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #else		//ROW_SEG_BUFFER
1688:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** void drawPix(uint8_t rowNum)
1689:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
1690:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
1691:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	         | (0<<COM1B1) | (1<<COM1B0)
1692:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	         | (1<<PWM1A) | (1<<PWM1B) );
1693:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1694:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** /* This bit was in loadData, just some notes, now...
1695:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1696:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  WTF, how did this work?! Am I not using drawPix?!
1697:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    Yes, but drawPix calls drawSegs, which doesn't have an argument
1698:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    because loadRow takes the row argument elsewhere, drawSegs just
1699:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    draws 'em
1700:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       //#warning "see 'shouldBe' here..."
1701:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       //Should be:
1702:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       rowNum = rowNum*FB_HEIGHT/V_COUNT;
1703:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       //rowNum = rowNum / (768/FB_HEIGHT);
1704:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1705:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	So, rowNum change left-over from the ol' FrameBuffer days had no effect
1706:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	on drawSegs.
1707:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** */
1708:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1709:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1710:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1711:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		drawSegs();
1712:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1713:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1714:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//DE->Nada transition expects fullBlue...
1715:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Also helps to show the edge of the DE timing...
1716:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1717:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//!!! Not sure what the state is at this point...
1718:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// could be any DE+Blue level, or could be NADA...
1719:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// Nada: DT1=3, still leaves one bit for clocking, might be OK
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 110


1720:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****          
1721:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Among the things that don't make sense...
1722:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// This appears to go into affect BEFORE delay_cyc (?)
1723:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// as, without a pull-up resistor on the /OC1B output, 
1724:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// green seems to be floating between the last pixel and the
1725:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// delay_cyc (!)
1726:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Disable complementary-output for Green 
1727:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//  (on /OC1B, where CLK is OC1B)
1728:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// Since Nada, V, and H DT's might be bad for clocking.
1729:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
1730:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****          | (1<<COM1B1) | (0<<COM1B0)
1731:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****          | (1<<PWM1A) | (1<<PWM1B) );
1732:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1733:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		fullBlue();
1734:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1735:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif //0
1736:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1737:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1738:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
1739:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //          G) groovy little spiral...
1740:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
1741:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1742:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if 0 //(defined(CLOCK_INSENSITIVITY_TESTING) && CLOCK_INSENSITIVITY_TESTING)
1743:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEonly_fromNada();
1744:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Enable complementary-output for Green (on /OC1B, where CLK is OC1B)
1745:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
1746:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 				   | (0<<COM1B1) | (1<<COM1B0)
1747:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 					| (1<<PWM1A) | (1<<PWM1B) );
1748:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1749:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1750:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1751:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1752:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1753:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1754:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1755:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1756:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1757:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1758:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** /* These are old tests from above, under if(dataEnable)
1759:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    They should all be implemented in lcdStuff.c, but have not been
1760:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    retested since...
1761:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if(defined(BLUE_DIAG_BAR) && BLUE_DIAG_BAR)
1762:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       uint16_t blueCyc = DOTS_TO_CYC(rowNum);
1763:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       uint16_t notBlueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS)-blueCyc;
1764:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       
1765:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       DEonly_fromNada();
1766:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       delay_cyc(notBlueCyc);
1767:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       DEblue_fromDEonly();
1768:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       delay_cyc(blueCyc);
1769:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1770:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       Nada_fromDEblue();
1771:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif(defined(BLUE_VERT_BAR) && BLUE_VERT_BAR)
1772:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       DEonly_fromNada();
1773:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)/3);
1774:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       DEblue_fromDEonly();
1775:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)*2/3);
1776:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       Nada_fromDEblue();
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 111


1777:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #elif(defined(DE_BLUE) && DE_BLUE)
1778:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       DEblue_fromNada();
1779:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS));
1780:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       Nada_fromDEblue();
1781:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #else  //NOT BLUE_DIAG_BAR, BLUE_VERT_BAR, NOR DE_BLUE
1782:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #if ( defined(COLOR_BAR_SCROLL) && COLOR_BAR_SCROLL)
1783:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       if(rowNum <= 256)
1784:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****          rowNum=0;
1785:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       else
1786:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****          rowNum=1;
1787:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #else //NOT COLOR_BAR_SCROLL... drawPix...
1788:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** */
1789:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1790:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1791:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1792:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //a/o LCDdirectLVDS62:
1793:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // These BLUE_... tests are being reimplemented.
1794:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // They're *quite* handy for initial-testing of an untested display.
1795:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //
1796:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // Realistically, they should probably be less LVDS-specific
1797:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (non-LVDS displays needn't be coded with these transition-specific
1798:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // functions like DEonly_fromNada() or DEblue_fromDEonly(), and certainly
1799:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // needn't be limited to blue/black testing. LVDS displays contain their
1800:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // syncing signals on the same wire as the blue pixel-data, thus these
1801:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // tests...)
1802:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // In the long-run, maybe they should be moved to an lvdsLCD commonCode
1803:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // and the transition-specific code removed from here, but I've yet to
1804:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // explore this.
1805:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // For non-LVDS displays, these should still be pretty good tests, and
1806:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // implementing transition-specific functions shouldn't be too difficult...
1807:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // e.g. "#define DEonly_fromNada()    setpinPORT(DE_PIN, DE_PORT)"
1808:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // or   "#define DEblue_fromDEonly()  BLUE_PORT = 0xff"
1809:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (Actually, transition-specific functions make it faster regardless of
1810:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // the LVDS/non-LVDS nature of the display, as some things are redundant...
1811:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // e.g. if calls to DEonly_fromNada() were replaced with calls to DEonly(),
1812:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // it would require disabling H-sync and V-sync, in addition to enabling DE
1813:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // in every call. When we start getting into worrying about aligning pixels
1814:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // with the edge of the display and making them as skinny as possible, each
1815:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // cpu instruction counts.
1816:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // So, I guess, the only LVDS-specific stuff here is the blue-related
1817:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // transitions (and, more specifically, the fact that there are *only*
1818:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // blue-related transitions, as opposed to red and green)
1819:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1820:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //a/o sdramThing2.0v8 early... appears to be syncing on Blue signal
1821:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // thus we get diagonal data including Hsync (colored in red) along the
1822:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // as a diagonal stripe at the right
1823:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if(defined(BLUE_DIAG_BAR) && BLUE_DIAG_BAR)
1824:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** static __inline__ void drawPix(uint16_t rowNum)
1825:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
1826:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//uint16_t blueCyc = DOTS_TO_CYC(rowNum);
1827:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//uint16_t notBlueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS)-blueCyc;
1828:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		uint16_t notBlueDots = rowNum;
1829:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		uint16_t blueDots = DE_ACTIVE_DOTS - notBlueDots;
1830:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1831:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEonly_fromNada();
1832:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//a/o v0.70-1, swapping blue and not-blue...
1833:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//This is a bit of a hack, since DEblue_fromNada doesn't exist...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 112


1834:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEblue_fromDEonly();
1835:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1836:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(notBlueCyc);
1837:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(notBlueDots);
1838:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(blueDots);
1839:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEonly_fromDEblue();
1840:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(blueCyc);
1841:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(blueDots);
1842:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(notBlueDots);
1843:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		Nada_fromDEonly();
1844:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1845:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1846:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1847:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1848:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //a/o LCDdirectLVDS62: This is the same as above, but scrolls vertically
1849:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // one line per refresh... so it's easy to calculate the refresh-rate
1850:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if(defined(BLUE_DIAG_BAR_SCROLL) && BLUE_DIAG_BAR_SCROLL)
1851:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** static __inline__ void drawPix(uint16_t rowNum)
1852:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
1853:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	static uint16_t rowOffset;
1854:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	if(rowNum == 0)
1855:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		rowOffset++;
1856:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//uint16_t blueCyc = DOTS_TO_CYC(rowNum);
1857:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//uint16_t notBlueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS)-blueCyc;
1858:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		uint16_t notBlueDots = (rowNum + rowOffset)%DE_ACTIVE_DOTS;
1859:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		uint16_t blueDots = DE_ACTIVE_DOTS - notBlueDots;
1860:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1861:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEonly_fromNada();
1862:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEblue_fromDEonly();
1863:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(notBlueCyc);
1864:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(notBlueDots);
1865:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(blueDots);
1866:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEonly_fromDEblue();
1867:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(blueCyc);
1868:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(blueDots);
1869:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(notBlueDots);
1870:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		Nada_fromDEonly();
1871:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1872:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1873:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1874:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1875:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1876:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //a/o LCDdirectLVDS62: This is the same as above, but alternates colors
1877:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //between each frame...
1878:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // (Careful, this one'll cause seizures!)
1879:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if(defined(BLUE_DIAG_SCROLL_FLASH) && BLUE_DIAG_SCROLL_FLASH)
1880:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** static __inline__ void drawPix(uint16_t rowNum)
1881:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
1882:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	static uint16_t rowOffset;
1883:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	if(rowNum == 0)
1884:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		rowOffset++;
1885:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//uint16_t blueCyc = DOTS_TO_CYC(rowNum);
1886:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//uint16_t notBlueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS)-blueCyc;
1887:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		uint16_t blueDots = (rowNum + rowOffset)%DE_ACTIVE_DOTS;
1888:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		uint16_t notBlueDots = DE_ACTIVE_DOTS - blueDots;
1889:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1890:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if(defined(BDSF_ALTERNATE_ROWS) && BDSF_ALTERNATE_ROWS)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 113


1891:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	if(rowNum&0x01)
1892:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #else
1893:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	if(rowOffset&0x01)
1894:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1895:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	{
1896:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEonly_fromNada();
1897:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(notBlueCyc);
1898:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(notBlueDots);
1899:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(notBlueDots);
1900:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEblue_fromDEonly();
1901:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(blueCyc);
1902:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(blueDots);
1903:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(blueDots);
1904:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		Nada_fromDEblue();
1905:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	}
1906:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	else
1907:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	{
1908:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEblue_fromNada();
1909:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(notBlueCyc);
1910:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(notBlueDots);
1911:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(notBlueDots);
1912:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEonly_fromDEblue();
1913:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(blueCyc);
1914:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(blueDots);
1915:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(blueDots);
1916:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		Nada_fromDEonly();
1917:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	}
1918:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1919:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1920:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1921:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1922:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //a/o sdramThing2.0v8-31ish: LooksPromising, but delayed
1923:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // also LVDS bit-shifts causing vertical striping
1924:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if(defined(BLUE_VERT_BAR) && BLUE_VERT_BAR)
1925:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** static __inline__ void drawPix(uint16_t rowNum)
1926:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
1927:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEonly_fromNada();
1928:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)/3);
1929:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS/3);
1930:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS/3);
1931:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEblue_fromDEonly();
1932:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)*2/3);
1933:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS - DE_ACTIVE_DOTS/3);
1934:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS - DE_ACTIVE_DOTS/3);
1935:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		Nada_fromDEblue();
1936:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1937:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1938:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1939:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //a/o sdramThing2.0v8-32 nogo... syncs at end of blue instead of Hsync
1940:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if(defined(BLUE_VERT_BAR_REVERSED) && BLUE_VERT_BAR_REVERSED)
1941:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** static __inline__ void drawPix(uint16_t rowNum)
1942:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
1943:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEblue_fromNada();
1944:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)/3);
1945:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS/3);
1946:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS/3);
1947:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEonly_fromDEblue();
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 114


1948:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS)*2/3);
1949:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS - DE_ACTIVE_DOTS/3);
1950:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS - DE_ACTIVE_DOTS/3);
1951:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		Nada_fromDEonly();
1952:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1953:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1954:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1955:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1956:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if(defined(DE_BLUE) && DE_BLUE)
1957:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** static __inline__ void drawPix(uint16_t rowNum)
1958:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
1959:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEblue_fromNada();
1960:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS));
1961:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS);
1962:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS);
1963:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		Nada_fromDEblue();
1964:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1965:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1966:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1967:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if(defined(BLUE_BORDER) && (BLUE_BORDER!=0))
1968:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** static __inline__ void drawPix(uint16_t rowNum)
1969:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
1970:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEblue_fromNada();
1971:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(BLUE_BORDER);
1972:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEonly_fromDEblue();
1973:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS - BLUE_BORDER*2);
1974:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DEblue_fromDEonly();
1975:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(BLUE_BORDER);
1976:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		Nada_fromDEblue();
1977:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** }
1978:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
1979:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1980:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if 0
1981:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //NOT BLUE_DIAG_BAR, BLUE_VERT_BAR, NOR DE_BLUE
1982:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #if ( defined(COLOR_BAR_SCROLL) && COLOR_BAR_SCROLL)
1983:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		if(rowNum <= 256)
1984:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			rowNum=0;
1985:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		else
1986:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			rowNum=1;
1987:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #else //NOT COLOR_BAR_SCROLL... drawPix...
1988:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//#warning "see 'shouldBe' here..."
1989:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Should be:
1990:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		rowNum = rowNum*FB_HEIGHT/V_COUNT;
1991:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//rowNum = rowNum / (768/FB_HEIGHT);
1992:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #endif
1993:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
1994:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//DEonly_fromNada();
1995:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       drawPix(rowNum);
1996:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Nada_init();
1997:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #warning "THIS ISN'T SAFE"
1998:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		Nada_fromDEonly();
1999:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//Drawing Methods...
2000:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2001:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if 0 //(defined(CLOCK_INSENSITIVITY_TESTING) && CLOCK_INSENSITIVITY_TESTING)
2002:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//!!! Not sure what the state is at this point...
2003:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// could be any DE+Blue level, or could be NADA...
2004:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// Nada: DT1=3, still leaves one bit for clocking, might be OK
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 115


2005:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2006:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       //Disable complementary-output for Green 
2007:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//  (on /OC1B, where CLK is OC1B)
2008:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// Since Nada, V, and H DT's might be bad for clocking.
2009:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
2010:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****                | (1<<COM1B1) | (0<<COM1B0)
2011:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****                | (1<<PWM1A) | (1<<PWM1B) );
2012:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
2013:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2014:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//colorOverride removed in LVDS, revisit LCDdirect50
2015:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
2016:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2017:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2018:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2019:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // AND HERE!!!
2020:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2021:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** // rowNum is only used when DE is active...
2022:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** //  and should be 0 at *drawn row* 0
2023:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** void loadData(uint16_t rowNum, uint8_t dataEnable)
2024:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** {
2025:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2026:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #ifdef drawPixSetup
2027:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	drawPixSetup(rowNum);
2028:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #endif
2029:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2030:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//H Active pulse...
2031:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    if(vSync)
 2047               		.stabn	68,0,2031,.LM223-.LFBB19
 2048               	.LM223:
 2049 07a8 8091 0000 		lds r24,vSync
2032:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    {
2033:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Vsync_fromNada() is called at the end of the last interupt
2034:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       VplusH_fromVsync();
 2050               		.stabn	68,0,2034,.LM224-.LFBB19
 2051               	.LM224:
 2052 07ac C498      		cbi 0x18,4
2031:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    {
 2053               		.stabn	68,0,2031,.LM225-.LFBB19
 2054               	.LM225:
 2055 07ae 8823      		tst r24
 2056 07b0 01F0      		breq .L117
 2057               		.stabn	68,0,2034,.LM226-.LFBB19
 2058               	.LM226:
 2059 07b2 89E0      		ldi r24,lo8(9)
 2060 07b4 90E0      		ldi r25,0
 2061               	.L119:
 2062               	.LBB232:
2035:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       Hlow_Delay();
 2063               		.stabn	68,0,2035,.LM227-.LFBB19
 2064               	.LM227:
 2065               	/* #APP */
 2066               	 ;  2035 "_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c" 1
 2067 07b6 0000      		nop;
 2068               	 ;  0 "" 2
 2069               	/* #NOAPP */
 2070 07b8 C398      		cbi 0x18,3
 2071               	/* #APP */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 116


 2072               	 ;  2035 "_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c" 1
 2073 07ba 0000      		nop;
 2074               	 ;  0 "" 2
 2075               	/* #NOAPP */
 2076 07bc C39A      		sbi 0x18,3
 2077 07be 0197      		sbiw r24,1
 2078 07c0 0097      		sbiw r24,0
 2079 07c2 01F4      		brne .L119
 2080               	.LBE232:
2036:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       Vsync_fromVplusH();
 2081               		.stabn	68,0,2036,.LM228-.LFBB19
 2082               	.LM228:
 2083 07c4 C49A      		sbi 0x18,4
 2084 07c6 87E0      		ldi r24,lo8(7)
 2085 07c8 90E0      		ldi r25,0
 2086               	.L123:
 2087               	.LBB233:
2037:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       HD_Delay();
 2088               		.stabn	68,0,2037,.LM229-.LFBB19
 2089               	.LM229:
 2090               	/* #APP */
 2091               	 ;  2037 "_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c" 1
 2092 07ca 0000      		nop;
 2093               	 ;  0 "" 2
 2094               	/* #NOAPP */
 2095 07cc C398      		cbi 0x18,3
 2096               	/* #APP */
 2097               	 ;  2037 "_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c" 1
 2098 07ce 0000      		nop;
 2099               	 ;  0 "" 2
 2100               	/* #NOAPP */
 2101 07d0 C39A      		sbi 0x18,3
 2102 07d2 0197      		sbiw r24,1
 2103 07d4 0097      		sbiw r24,0
 2104 07d6 01F4      		brne .L123
 2105               	.L126:
 2106               	.LBE233:
2038:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    }
2039:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    else
2040:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    {
2041:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       Hsync_fromNada();
2042:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       Hlow_Delay();
2043:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       Nada_fromHsync();
2044:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       HD_Delay();
2045:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    }
2046:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2047:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    if(dataEnable)
 2107               		.stabn	68,0,2047,.LM230-.LFBB19
 2108               	.LM230:
 2109 07d8 2223      		tst r18
 2110 07da 01F4      		brne .+2
 2111 07dc 00C0      		rjmp .L178
 2112               	.LBB234:
 2113               	.LBB235:
 2114               	.LBB236:
 2115               		.stabs	"_options/writeColor.c",132,0,0,.Ltext16
 2116               	.Ltext16:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 117


 726:_options/writeColor.c **** #endif
 727:_options/writeColor.c **** 
 728:_options/writeColor.c **** 	return wc_color;
 729:_options/writeColor.c **** }
 730:_options/writeColor.c **** 
 731:_options/writeColor.c **** 
 732:_options/writeColor.c **** static __inline__ void nonRSB_drawPix(uint16_t rowNum)
 733:_options/writeColor.c **** {
 734:_options/writeColor.c ****    //uint8_t *setting = &(settingBuffer[rowNum][0]);
 735:_options/writeColor.c **** 
 736:_options/writeColor.c **** 	//A pointer to the first color (pixel) in the row...
 737:_options/writeColor.c **** 
 738:_options/writeColor.c **** 	//a/o v80
 739:_options/writeColor.c **** 	//Stupid optimizer... just having these assigned at the beginning of the
 740:_options/writeColor.c **** 	//function doesn't make them occur in that order.
 741:_options/writeColor.c **** 	//In fact, the first writeColor... maybe I'm mistaken.
 742:_options/writeColor.c **** #if(defined(WC_SETUP) && WC_SETUP)
 743:_options/writeColor.c **** 	uint8_t * color = wc_color;
 2117               		.stabn	68,0,743,.LM231-.LFBB19
 2118               	.LM231:
 2119 07de E091 0000 		lds r30,wc_color
 2120 07e2 F091 0000 		lds r31,wc_color+1
 2121               	.LBB237:
 2122               	.LBB238:
 2123               		.stabs	"./_interfaces/6bitParallel.c",132,0,0,.Ltext17
 2124               	.Ltext17:
   1:./_interfaces/6bitParallel.c **** /* mehPL:
   2:./_interfaces/6bitParallel.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:./_interfaces/6bitParallel.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:./_interfaces/6bitParallel.c ****  *    Please see the bottom.
   5:./_interfaces/6bitParallel.c ****  *    Enjoy!
   6:./_interfaces/6bitParallel.c ****  */
   7:./_interfaces/6bitParallel.c **** 
   8:./_interfaces/6bitParallel.c **** 
   9:./_interfaces/6bitParallel.c **** 
  10:./_interfaces/6bitParallel.c **** 
  11:./_interfaces/6bitParallel.c **** // a/o v80, this is a first-attempt at running a parallel-interfaced LCD
  12:./_interfaces/6bitParallel.c **** // (specifically, the Sony ACX)
  13:./_interfaces/6bitParallel.c **** //
  14:./_interfaces/6bitParallel.c **** // The display is 9-bits (3-bits per R/G/B)
  15:./_interfaces/6bitParallel.c **** // But since this project has been 2-bits per R/G/B for so long, it'd be
  16:./_interfaces/6bitParallel.c **** // easiest to only use two. Also, since it only requires one port, later
  17:./_interfaces/6bitParallel.c **** // attempts with FrameBuffer, etc. will only require one instruction (one
  18:./_interfaces/6bitParallel.c **** // PORT = frameBuffer[row][col]) to handle all color-bits.
  19:./_interfaces/6bitParallel.c **** 
  20:./_interfaces/6bitParallel.c **** // From the <= v79 scheme, this is essentially a replacement for lvds.c
  21:./_interfaces/6bitParallel.c **** // Other changes will have to be made elsewhere (e.g. writeColor.c)
  22:./_interfaces/6bitParallel.c **** 
  23:./_interfaces/6bitParallel.c **** // This file pieced-together from lvds161.c as a template, since it's
  24:./_interfaces/6bitParallel.c **** // basically stripped-down to the essentials (lvds.c is much wordier, and a
  25:./_interfaces/6bitParallel.c **** // good place to look for info)
  26:./_interfaces/6bitParallel.c **** 
  27:./_interfaces/6bitParallel.c **** // Also, not exactly sure what to do about port-selection, since it might
  28:./_interfaces/6bitParallel.c **** // make sense to change the pinout based on the particular chip, etc.
  29:./_interfaces/6bitParallel.c **** 
  30:./_interfaces/6bitParallel.c **** // So, for now, this is for the ATtiny861
  31:./_interfaces/6bitParallel.c **** //  (since I have so many)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 118


  32:./_interfaces/6bitParallel.c **** //  AND overrides the pinout shown in pinout.h
  33:./_interfaces/6bitParallel.c **** //
  34:./_interfaces/6bitParallel.c **** //                           ATtiny861
  35:./_interfaces/6bitParallel.c **** //                          ____________________
  36:./_interfaces/6bitParallel.c **** //                         |         |_|        |
  37:./_interfaces/6bitParallel.c **** //                  MOSI --|  1 PB0      PA0 20 |--   Red0
  38:./_interfaces/6bitParallel.c **** //           Heart  MISO --|  2 PB1      PA1 19 |--   Red1
  39:./_interfaces/6bitParallel.c **** //                  SCK  --|  3 PB2      PA2 18 |--   Green0
  40:./_interfaces/6bitParallel.c **** //  MCK    (OC1B)  --------|  4 PB3      PA3 17 |--   Green1
  41:./_interfaces/6bitParallel.c **** //                   VCC --|  5 VCC     AGND 16 |-- (GND)
  42:./_interfaces/6bitParallel.c **** //                   GND --|  6 GND     AVCC 15 |-- (VCC)
  43:./_interfaces/6bitParallel.c **** //               Hsync   --|  7 PB4      PA4 14 |--   Blue0
  44:./_interfaces/6bitParallel.c **** //               Vsync   --|  8 PB5      PA5 13 |--   Blue1  
  45:./_interfaces/6bitParallel.c **** //               S/D     --|  9 PB6      PA6 12 |-- 
  46:./_interfaces/6bitParallel.c **** //                /Reset --| 10 PB7      PA7 11 |-- PCINT7: NEW BUMP SENSOR
  47:./_interfaces/6bitParallel.c **** //                         |____________________|   (when implemented)
  48:./_interfaces/6bitParallel.c **** //
  49:./_interfaces/6bitParallel.c **** // NEW BUMP SENSOR:
  50:./_interfaces/6bitParallel.c **** // a/o v82: TODO: This note should probably be elsewhere...
  51:./_interfaces/6bitParallel.c **** // Heart cannot be used multiplexed with the new bump-sensor idea... so we
  52:./_interfaces/6bitParallel.c **** // need another pin, one with an interrupt... Not many to choose from.
  53:./_interfaces/6bitParallel.c **** // Also, it can't be shared with any other pins, since it's mostly active
  54:./_interfaces/6bitParallel.c **** // and only inactive briefly when bumped.
  55:./_interfaces/6bitParallel.c **** //
  56:./_interfaces/6bitParallel.c **** // As-Implemented, PORTA is the only port with available pins
  57:./_interfaces/6bitParallel.c **** // But the entire port is written during each writeColor() call...
  58:./_interfaces/6bitParallel.c **** // TODO: It might be wise to switch S/D to PORTA(?) Since it needn't change
  59:./_interfaces/6bitParallel.c **** // often (as-implemented, it's unused entirely)
  60:./_interfaces/6bitParallel.c **** // 
  61:./_interfaces/6bitParallel.c **** // The problem is enabling/disabling the internal pull-ups might cause an
  62:./_interfaces/6bitParallel.c **** // interrupt to be detected... if e.g. PA7 was used for the bump-sensor
  63:./_interfaces/6bitParallel.c **** //
  64:./_interfaces/6bitParallel.c **** // But I think that's what I'mma do.
  65:./_interfaces/6bitParallel.c **** 
  66:./_interfaces/6bitParallel.c **** 
  67:./_interfaces/6bitParallel.c **** #ifndef __6BITPARALLEL_C__
  68:./_interfaces/6bitParallel.c **** #define __6BITPARALLEL_C__
  69:./_interfaces/6bitParallel.c **** 
  70:./_interfaces/6bitParallel.c **** #include _BITHANDLING_HEADER_
  71:./_interfaces/6bitParallel.c **** #ifndef __AVR_ATtiny861__
  72:./_interfaces/6bitParallel.c **** #error "This currently only works with the ATTiny861... It's mostly just a pinout issue... of NYIis
  73:./_interfaces/6bitParallel.c **** #endif
  74:./_interfaces/6bitParallel.c **** 
  75:./_interfaces/6bitParallel.c **** #if (!defined(LCDINTERFACE_BITBANGED_DOTCLOCK) || \
  76:./_interfaces/6bitParallel.c **** 		!LCDINTERFACE_BITBANGED_DOTCLOCK)
  77:./_interfaces/6bitParallel.c ****  #include "delay_cyc.h"
  78:./_interfaces/6bitParallel.c **** #else //LCDINTERFACE_BITBANGED_DOTCLOCK. Use delayDots instead of delayCyc
  79:./_interfaces/6bitParallel.c ****  //Indicate to lcdStuff that it needs to include dot-delays DURING
  80:./_interfaces/6bitParallel.c ****  //v-blanking in order to write the pixel-clock
  81:./_interfaces/6bitParallel.c ****  // (as opposed to its being handled via PWM cycling between the HSync 
  82:./_interfaces/6bitParallel.c ****  //  timer interrupts)
  83:./_interfaces/6bitParallel.c ****  #define LCDSTUFF_INCLUDE_NON_DE TRUE
  84:./_interfaces/6bitParallel.c **** #endif
  85:./_interfaces/6bitParallel.c **** 
  86:./_interfaces/6bitParallel.c **** 
  87:./_interfaces/6bitParallel.c **** 
  88:./_interfaces/6bitParallel.c **** // TODO: Figure out: Is there a particular interface that would be best for
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 119


  89:./_interfaces/6bitParallel.c **** // handling the unused LSB of each color...? 
  90:./_interfaces/6bitParallel.c **** // (maybe such that the colors on this display match those on an LVDS one?)
  91:./_interfaces/6bitParallel.c **** // For now: Assuming that e.g. R0/R1 -> uC:Red0 R2 -> uC:Red1
  92:./_interfaces/6bitParallel.c **** //a/o a while ago (this being v86):
  93:./_interfaces/6bitParallel.c **** // This has been explored, and must be better-noted somewhere, by now...
  94:./_interfaces/6bitParallel.c **** // Essentially, as I recall, it's best to combine R0 and R2 on Red1 and R1
  95:./_interfaces/6bitParallel.c **** // on Red0, the color-scheme is similar to that of LVDS, and relatively
  96:./_interfaces/6bitParallel.c **** // linear. Again, I think that's already noted somewhere (maybe
  97:./_interfaces/6bitParallel.c **** // writeColor?)
  98:./_interfaces/6bitParallel.c **** 
  99:./_interfaces/6bitParallel.c **** // MCK is handled by OC1B (matches LVDS's clock signal)
 100:./_interfaces/6bitParallel.c **** // THESE SHOULD NOT BE CHANGED without also looking into the
 101:./_interfaces/6bitParallel.c **** // setbit(PWM1B...) portion of _init()
 102:./_interfaces/6bitParallel.c **** #define MCK_OCR		OCR1B
 103:./_interfaces/6bitParallel.c **** // These will probably only be used for initialization:
 104:./_interfaces/6bitParallel.c **** //a/o a while ago (this being v86): That's not true, MCK is bit-banged...
 105:./_interfaces/6bitParallel.c **** #define MCK_PIN		PB3
 106:./_interfaces/6bitParallel.c **** #define MCK_PORT		PORTB
 107:./_interfaces/6bitParallel.c **** 
 108:./_interfaces/6bitParallel.c **** // Hsync is on PB4, and is active-low
 109:./_interfaces/6bitParallel.c **** #define HSYNC_PIN		PB4
 110:./_interfaces/6bitParallel.c **** #define HSYNC_PORT	PORTB
 111:./_interfaces/6bitParallel.c **** // Vsync is on PB5, and is active-low
 112:./_interfaces/6bitParallel.c **** #define VSYNC_PIN		PB5
 113:./_interfaces/6bitParallel.c **** #define VSYNC_PORT	PORTB
 114:./_interfaces/6bitParallel.c **** 
 115:./_interfaces/6bitParallel.c **** //This is just for handling writeMasked's when writing BOTH Hsync and Vsync
 116:./_interfaces/6bitParallel.c **** // (e.g. for _init() macros)
 117:./_interfaces/6bitParallel.c **** //And, as-implemented, requires that Hsync and Vsync be on the same port
 118:./_interfaces/6bitParallel.c **** #define HV_MASK		( (1<<(HSYNC_PIN)) | (1<<(VSYNC_PIN)) )
 119:./_interfaces/6bitParallel.c **** #define HV_PORT		HSYNC_PORT
 120:./_interfaces/6bitParallel.c **** #define HSYNC_ACTIVE		(0<<(HSYNC_PIN))
 121:./_interfaces/6bitParallel.c **** #define HSYNC_INACTIVE	(1<<(HSYNC_PIN))
 122:./_interfaces/6bitParallel.c **** #define VSYNC_ACTIVE		(0<<(VSYNC_PIN))
 123:./_interfaces/6bitParallel.c **** #define VSYNC_INACTIVE	(1<<(VSYNC_PIN))
 124:./_interfaces/6bitParallel.c **** 
 125:./_interfaces/6bitParallel.c **** // S/D is on PB6
 126:./_interfaces/6bitParallel.c **** // S/D is oddly-named, it's active-low
 127:./_interfaces/6bitParallel.c **** // More logically it'd be called DisplayEnable and be active-high
 128:./_interfaces/6bitParallel.c **** //(and it's relatively unused/unimplemented)
 129:./_interfaces/6bitParallel.c **** #define SD_PIN			PB6
 130:./_interfaces/6bitParallel.c **** #define SD_PORT		PORTB
 131:./_interfaces/6bitParallel.c **** 
 132:./_interfaces/6bitParallel.c **** // PORTA is used for R/G/B data
 133:./_interfaces/6bitParallel.c **** // PA0 Red0
 134:./_interfaces/6bitParallel.c **** // PA1 Red1
 135:./_interfaces/6bitParallel.c **** // PA2 Green0
 136:./_interfaces/6bitParallel.c **** // PA3 Green1
 137:./_interfaces/6bitParallel.c **** // PA4 Blue0
 138:./_interfaces/6bitParallel.c **** // PA5 Blue1
 139:./_interfaces/6bitParallel.c **** // PA6 (unused)
 140:./_interfaces/6bitParallel.c **** // PA7 (unused)	//Now used by bump-sensor/switch
 141:./_interfaces/6bitParallel.c **** #define RGB_PORT	PORTA
 142:./_interfaces/6bitParallel.c **** 
 143:./_interfaces/6bitParallel.c **** 
 144:./_interfaces/6bitParallel.c **** 
 145:./_interfaces/6bitParallel.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 120


 146:./_interfaces/6bitParallel.c **** 
 147:./_interfaces/6bitParallel.c **** #define RED_SHIFT		0
 148:./_interfaces/6bitParallel.c **** #define GREEN_SHIFT	2
 149:./_interfaces/6bitParallel.c **** #define BLUE_SHIFT	4
 150:./_interfaces/6bitParallel.c **** 
 151:./_interfaces/6bitParallel.c **** #define RED_MASK		(0x03<<(RED_SHIFT))
 152:./_interfaces/6bitParallel.c **** #define GREEN_MASK 	(0x03<<(GREEN_SHIFT))
 153:./_interfaces/6bitParallel.c **** #define BLUE_MASK 	(0x03<<(BLUE_SHIFT))
 154:./_interfaces/6bitParallel.c **** 
 155:./_interfaces/6bitParallel.c **** 
 156:./_interfaces/6bitParallel.c **** //TODO: This cause writeColor to leave bits 7 and 6 on the RGB_PORT
 157:./_interfaces/6bitParallel.c **** // HIGH... (e.g. for inputs with pull-ups...)
 158:./_interfaces/6bitParallel.c **** // This isn't well-implemented, and shouldn't be necessary since
 159:./_interfaces/6bitParallel.c **** // BUMP_SWITCH is supposed to be #included before this file...
 160:./_interfaces/6bitParallel.c **** // but that doesn't seem to be working, so this is an override.
 161:./_interfaces/6bitParallel.c **** // This adds an ori instruction in writeColor, so it increases the number
 162:./_interfaces/6bitParallel.c **** // of cycles which is important to consider if not using bitbanged MCK...
 163:./_interfaces/6bitParallel.c **** // Then again, non-bitbanged MCK has been pretty much abandoned.
 164:./_interfaces/6bitParallel.c **** #define OTHER_BITS_HIGH TRUE
 165:./_interfaces/6bitParallel.c **** 
 166:./_interfaces/6bitParallel.c **** 
 167:./_interfaces/6bitParallel.c **** 
 168:./_interfaces/6bitParallel.c **** 
 169:./_interfaces/6bitParallel.c **** 
 170:./_interfaces/6bitParallel.c **** //Now, on to the actual functions/macros needed by all _interface/ code:
 171:./_interfaces/6bitParallel.c **** 
 172:./_interfaces/6bitParallel.c **** 
 173:./_interfaces/6bitParallel.c **** #define setRed4(val) \
 174:./_interfaces/6bitParallel.c **** 	writeMasked( ((val)<<(RED_SHIFT)), RED_MASK, RGB_PORT )
 175:./_interfaces/6bitParallel.c **** 
 176:./_interfaces/6bitParallel.c **** 
 177:./_interfaces/6bitParallel.c **** #define setGreen4(val) \
 178:./_interfaces/6bitParallel.c **** 	writeMasked( ((val)<<(GREEN_SHIFT)), GREEN_MASK, RGB_PORT )
 179:./_interfaces/6bitParallel.c **** 
 180:./_interfaces/6bitParallel.c **** 
 181:./_interfaces/6bitParallel.c **** #define setBlue4(val) \
 182:./_interfaces/6bitParallel.c **** 	writeMasked( ((val)<<(BLUE_SHIFT)), BLUE_MASK, RGB_PORT )
 183:./_interfaces/6bitParallel.c **** 
 184:./_interfaces/6bitParallel.c **** 
 185:./_interfaces/6bitParallel.c **** 
 186:./_interfaces/6bitParallel.c **** 
 187:./_interfaces/6bitParallel.c **** #if (defined(REMOVE_DC) && REMOVE_DC)
 188:./_interfaces/6bitParallel.c ****  #error "REMOVE_DC hasn't been tested since lcdStuff, or long prior"
 189:./_interfaces/6bitParallel.c ****  #error "Further, it's completely irrelevent for a parallel-interface."
 190:./_interfaces/6bitParallel.c **** #endif
 191:./_interfaces/6bitParallel.c **** 
 192:./_interfaces/6bitParallel.c **** 
 193:./_interfaces/6bitParallel.c **** 
 194:./_interfaces/6bitParallel.c **** //FOR NOW: Assuming that color-data is ignored except where necessary
 195:./_interfaces/6bitParallel.c **** #define Nada_init()		\
 196:./_interfaces/6bitParallel.c **** { \
 197:./_interfaces/6bitParallel.c **** 	writeMasked( (HSYNC_INACTIVE | VSYNC_INACTIVE), HV_MASK, HV_PORT ); \
 198:./_interfaces/6bitParallel.c **** 	setBlue4(0); \
 199:./_interfaces/6bitParallel.c **** }
 200:./_interfaces/6bitParallel.c **** #define Vsync_init()    \
 201:./_interfaces/6bitParallel.c **** 	writeMasked( (HSYNC_INACTIVE | VSYNC_ACTIVE), HV_MASK, HV_PORT )
 202:./_interfaces/6bitParallel.c **** #define VplusH_init()   \
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 121


 203:./_interfaces/6bitParallel.c **** 	writeMasked( (HSYNC_ACTIVE | VSYNC_ACTIVE), HV_MASK, HV_PORT )
 204:./_interfaces/6bitParallel.c **** #define Hsync_init()    \
 205:./_interfaces/6bitParallel.c **** 	writeMasked( (HSYNC_ACTIVE | VSYNC_INACTIVE), HV_MASK, HV_PORT )
 206:./_interfaces/6bitParallel.c **** //This display doesn't use DE ("Data-Enable") to indicate where the
 207:./_interfaces/6bitParallel.c **** //pixel-data starts, but these are still used by lcdStuff...
 208:./_interfaces/6bitParallel.c **** // DEonly/DEblue_init() don't handle red/green, since it was designed for
 209:./_interfaces/6bitParallel.c **** // FPD-link displays.
 210:./_interfaces/6bitParallel.c **** #define DEonly_init()   \
 211:./_interfaces/6bitParallel.c **** { \
 212:./_interfaces/6bitParallel.c **** 	writeMasked( (HSYNC_INACTIVE | VSYNC_INACTIVE), HV_MASK, HV_PORT ); \
 213:./_interfaces/6bitParallel.c **** 	setBlue4(0); \
 214:./_interfaces/6bitParallel.c **** }
 215:./_interfaces/6bitParallel.c **** #define DEblue_init()   \
 216:./_interfaces/6bitParallel.c **** { \
 217:./_interfaces/6bitParallel.c **** 	writeMasked( (HSYNC_INACTIVE | VSYNC_INACTIVE), HV_MASK, HV_PORT ); \
 218:./_interfaces/6bitParallel.c **** 	setBlue4(3); \
 219:./_interfaces/6bitParallel.c **** }
 220:./_interfaces/6bitParallel.c **** 
 221:./_interfaces/6bitParallel.c **** 
 222:./_interfaces/6bitParallel.c **** 
 223:./_interfaces/6bitParallel.c **** 
 224:./_interfaces/6bitParallel.c **** 
 225:./_interfaces/6bitParallel.c **** #if (defined(DE_ONLY_DISPLAY) && DE_ONLY_DISPLAY)
 226:./_interfaces/6bitParallel.c ****  #error "DE_ONLY_DISPLAY is not implemented with this interface"
 227:./_interfaces/6bitParallel.c ****  #error " But don't be discouraged... an actual LCD that's DE-Only"
 228:./_interfaces/6bitParallel.c ****  #error " should work fine WITHOUT DE_ONLY_DISPLAY set true"
 229:./_interfaces/6bitParallel.c ****  #error " Really, DE_ONLY_DISPLAY was just a test... see lvds.c"
 230:./_interfaces/6bitParallel.c **** #elif (defined(FULL_INIT_TESTS) && FULL_INIT_TESTS)
 231:./_interfaces/6bitParallel.c **** //#error"OK"
 232:./_interfaces/6bitParallel.c ****  #define Vsync_fromNada()      Vsync_init()
 233:./_interfaces/6bitParallel.c ****  #define VplusH_fromVsync()      VplusH_init()
 234:./_interfaces/6bitParallel.c ****  #define Vsync_fromVplusH()      Vsync_init()
 235:./_interfaces/6bitParallel.c ****  #define Nada_fromVsync()      Nada_init()
 236:./_interfaces/6bitParallel.c ****  #define Hsync_fromNada()      Hsync_init()
 237:./_interfaces/6bitParallel.c ****  #define Nada_fromHsync()      Nada_init()
 238:./_interfaces/6bitParallel.c ****  #define DEonly_fromNada()      DEonly_init()
 239:./_interfaces/6bitParallel.c ****  #define DEblue_fromDEonly()   DEblue_init()
 240:./_interfaces/6bitParallel.c ****  #define Nada_fromDEonly()      Nada_init()
 241:./_interfaces/6bitParallel.c ****  #define Nada_fromDEblue()      Nada_init()
 242:./_interfaces/6bitParallel.c ****  #define DEonly_fromDEblue()   DEonly_init()
 243:./_interfaces/6bitParallel.c **** #else   //NOT FULL_INIT_TESTS
 244:./_interfaces/6bitParallel.c **** //These are the minimal changes necessary, for high-speed processing...
 245:./_interfaces/6bitParallel.c ****  #define Vsync_fromNada()   clrpinPORT(VSYNC_PIN, VSYNC_PORT) 
 246:./_interfaces/6bitParallel.c ****  #define VplusH_fromVsync() clrpinPORT(HSYNC_PIN, HSYNC_PORT)
 247:./_interfaces/6bitParallel.c ****  #define Vsync_fromVplusH() setpinPORT(HSYNC_PIN, HSYNC_PORT)//Vsync_init()
 248:./_interfaces/6bitParallel.c ****  #define Nada_fromVsync()   setpinPORT(VSYNC_PIN, VSYNC_PORT)
 249:./_interfaces/6bitParallel.c ****  #define Hsync_fromNada()   clrpinPORT(HSYNC_PIN, HSYNC_PORT)
 250:./_interfaces/6bitParallel.c ****  #define Nada_fromHsync()   setpinPORT(HSYNC_PIN, HSYNC_PORT)
 251:./_interfaces/6bitParallel.c ****  #define Nada_fromDEblue()  Nada_init()
 252:./_interfaces/6bitParallel.c ****  #define Nada_fromDEonly()  setBlue4(0)
 253:./_interfaces/6bitParallel.c ****  #define DEonly_fromNada()  
 254:./_interfaces/6bitParallel.c ****  #define DEblue_fromNada()  setBlue4(3)
 255:./_interfaces/6bitParallel.c ****  #define DEblue_fromDEonly() setBlue4(3)
 256:./_interfaces/6bitParallel.c ****  #define DEonly_fromDEblue() setBlue4(0)
 257:./_interfaces/6bitParallel.c **** 
 258:./_interfaces/6bitParallel.c **** #endif
 259:./_interfaces/6bitParallel.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 122


 260:./_interfaces/6bitParallel.c **** 
 261:./_interfaces/6bitParallel.c **** 
 262:./_interfaces/6bitParallel.c **** #define fullBlue()   DEblue_init()
 263:./_interfaces/6bitParallel.c **** // So far, there's no "noBlue()" like there is (now) for red/green
 264:./_interfaces/6bitParallel.c **** // it gets confusing since doing-so would also affect the timing signals
 265:./_interfaces/6bitParallel.c **** // (in FPD-Link... since this was originally designed for that)
 266:./_interfaces/6bitParallel.c **** // But, that means noBlue() is never called anywhere anyways, so doesn't
 267:./_interfaces/6bitParallel.c **** // matter...
 268:./_interfaces/6bitParallel.c **** // If something like it is necessary in your project, use setBlue4(0), no?
 269:./_interfaces/6bitParallel.c **** 
 270:./_interfaces/6bitParallel.c **** #define noRed()   setRed4(0)
 271:./_interfaces/6bitParallel.c **** #define fullRed() setRed4(3)
 272:./_interfaces/6bitParallel.c **** #define noGreen()   setGreen4(0)
 273:./_interfaces/6bitParallel.c **** #define fullGreen() setGreen4(3)
 274:./_interfaces/6bitParallel.c **** //These are unnecessary for parallel-displays, but the macro is called...
 275:./_interfaces/6bitParallel.c **** #define lvds_disableGreen_MakeClockInsensitiveToDT()
 276:./_interfaces/6bitParallel.c **** #define lvds_enableGreen_MakeClockSensitiveToDT()
 277:./_interfaces/6bitParallel.c **** 
 278:./_interfaces/6bitParallel.c **** #if (defined(SLOW_EVERYTHING_TEST) && SLOW_EVERYTHING_TEST)
 279:./_interfaces/6bitParallel.c ****  #error "SLOW_EVERYTHING_TEST is true, but hasn't been implemented for parallel LCDs..."
 280:./_interfaces/6bitParallel.c **** #endif
 281:./_interfaces/6bitParallel.c **** 
 282:./_interfaces/6bitParallel.c **** 
 283:./_interfaces/6bitParallel.c **** 
 284:./_interfaces/6bitParallel.c **** //This is temporary, for compatibility with lvds.c...
 285:./_interfaces/6bitParallel.c **** #define lvds_timerInit()	lcdInterface_init()
 286:./_interfaces/6bitParallel.c **** 
 287:./_interfaces/6bitParallel.c **** 
 288:./_interfaces/6bitParallel.c **** static __inline__
 289:./_interfaces/6bitParallel.c **** void lcdInterface_init(void)
 290:./_interfaces/6bitParallel.c **** 	__attribute__((__always_inline__));
 291:./_interfaces/6bitParallel.c **** 
 292:./_interfaces/6bitParallel.c **** 
 293:./_interfaces/6bitParallel.c **** static __inline__
 294:./_interfaces/6bitParallel.c **** void lcdInterface_pwmDotClockInit(uint8_t onOff)
 295:./_interfaces/6bitParallel.c **** 	__attribute__((__always_inline__));
 296:./_interfaces/6bitParallel.c **** 
 297:./_interfaces/6bitParallel.c **** 
 298:./_interfaces/6bitParallel.c **** //a/o a while ago (this being v86):
 299:./_interfaces/6bitParallel.c **** // since MCK is now bit-banged, pwmDotClock is only used between
 300:./_interfaces/6bitParallel.c **** // screen-refreshes
 301:./_interfaces/6bitParallel.c **** 
 302:./_interfaces/6bitParallel.c **** //onOff is TRUE for ON, FALSE for OFF (should be 0 or 1, nothing else)
 303:./_interfaces/6bitParallel.c **** void lcdInterface_pwmDotClockInit(uint8_t onOff)
 304:./_interfaces/6bitParallel.c **** {
 305:./_interfaces/6bitParallel.c **** 	//Timer1 is used for the MCK (pixel/dot-clock)
 306:./_interfaces/6bitParallel.c **** 	//FOR NOW: Assuming we're using a 16MHz system-clock
 307:./_interfaces/6bitParallel.c **** 	// The dot-clock is supposed to be <= 4.2MHz, so let's go for 4MHz
 308:./_interfaces/6bitParallel.c **** 	//
 309:./_interfaces/6bitParallel.c **** 	// 16MHz/4MHz = 4
 310:./_interfaces/6bitParallel.c **** 	// So set the timer to count from 0 to 3 and reset
 311:./_interfaces/6bitParallel.c **** 	OCR1C = 3;
 312:./_interfaces/6bitParallel.c **** 
 313:./_interfaces/6bitParallel.c **** 	// And we want the toggling to be centered:
 314:./_interfaces/6bitParallel.c **** 	// TODO: Which phase is this, and how do we align it with data-changes?
 315:./_interfaces/6bitParallel.c **** 	// As I recall, the change occurs after TCNT leaves the OCR value
 316:./_interfaces/6bitParallel.c **** 	// (except for OCRVal == 0)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 123


 317:./_interfaces/6bitParallel.c **** 	// so an OCR-value of 1 causes:
 318:./_interfaces/6bitParallel.c **** 	// TCNT    0   1   2   3   0 ....
 319:./_interfaces/6bitParallel.c **** 	//      ___         _______
 320:./_interfaces/6bitParallel.c **** 	//         |_______|       |___
 321:./_interfaces/6bitParallel.c **** 	MCK_OCR = 1;
 322:./_interfaces/6bitParallel.c **** 
 323:./_interfaces/6bitParallel.c **** 	//Set the Timer1 clock prescaler... (No prescaler == /1)
 324:./_interfaces/6bitParallel.c **** 	writeMasked((1<<CS10),
 325:./_interfaces/6bitParallel.c **** 			            ((1<<CS13) | (1<<CS12) | (1<<CS11) | (1<<CS10)),
 326:./_interfaces/6bitParallel.c **** 							            TCCR1B);
 327:./_interfaces/6bitParallel.c **** 	//Set the DeadTime prescaler (no prescaling, same speed as TCNT1)...
 328:./_interfaces/6bitParallel.c **** 	// Allegedly this is prescaled from the PCK (or CK)
 329:./_interfaces/6bitParallel.c **** 	//    NOT from the Timer1 prescaler...
 330:./_interfaces/6bitParallel.c **** 	writeMasked(0,
 331:./_interfaces/6bitParallel.c **** 			            ((1<<DTPS11) | (1<<DTPS10)),
 332:./_interfaces/6bitParallel.c **** 							            TCCR1B);
 333:./_interfaces/6bitParallel.c **** 
 334:./_interfaces/6bitParallel.c **** 
 335:./_interfaces/6bitParallel.c **** 	writeMasked(((0<<WGM11) | (0<<WGM10)), //FastPWM (combined with above)
 336:./_interfaces/6bitParallel.c **** 	            ((1<<WGM11) | (1<<WGM10)), // (affects all PWM channels)
 337:./_interfaces/6bitParallel.c **** 	            TCCR1D);
 338:./_interfaces/6bitParallel.c **** 
 339:./_interfaces/6bitParallel.c **** 	//Forgot this... it was enableGreenMakeClockInsensitive-ish
 340:./_interfaces/6bitParallel.c **** 	// from lvds.c
 341:./_interfaces/6bitParallel.c **** 	writeMasked((onOff<<COM1B1) | (0<<COM1B0),
 342:./_interfaces/6bitParallel.c **** 					(1<<COM1B1) | (1<<COM1B0),
 343:./_interfaces/6bitParallel.c **** 					TCCR1A);
 344:./_interfaces/6bitParallel.c **** 	
 345:./_interfaces/6bitParallel.c **** 		
 346:./_interfaces/6bitParallel.c **** 	writebit(PWM1B, TCCR1A, onOff);  //Enable PWM on OC1B for CLOCK
 347:./_interfaces/6bitParallel.c **** 
 348:./_interfaces/6bitParallel.c **** }
 349:./_interfaces/6bitParallel.c **** 
 350:./_interfaces/6bitParallel.c **** 
 351:./_interfaces/6bitParallel.c **** void lcdInterface_init(void)
 352:./_interfaces/6bitParallel.c **** {
 353:./_interfaces/6bitParallel.c **** 	//Why wasn't this in lvds161?
 354:./_interfaces/6bitParallel.c ****   #if(defined(OSCCAL_VAL))
 355:./_interfaces/6bitParallel.c **** 	OSCCAL = OSCCAL_VAL;
 356:./_interfaces/6bitParallel.c ****   #elif(defined(LVDS_MAXIMIZE_OSCCAL) && LVDS_MAXIMIZE_OSCCAL)
 357:./_interfaces/6bitParallel.c **** 	#warning "LVDS_MAXIMIZE_OSCCAL is defined, without LVDS, should be OK"
 358:./_interfaces/6bitParallel.c ****    OSCCAL = OSCCAL_VAL;
 359:./_interfaces/6bitParallel.c ****   #endif
 360:./_interfaces/6bitParallel.c **** 
 361:./_interfaces/6bitParallel.c ****   #if(defined(LVDS_USE_PLL) && LVDS_USE_PLL)
 362:./_interfaces/6bitParallel.c **** 	#error "LVDS_USE_PLL is defined, without LVDS... and parallel doesn't yet implement PLL"
 363:./_interfaces/6bitParallel.c **** 	//There's more to it than just this... also need to consider the
 364:./_interfaces/6bitParallel.c **** 	//prescaler, etc...
 365:./_interfaces/6bitParallel.c ****    pll_enable();
 366:./_interfaces/6bitParallel.c ****   #endif
 367:./_interfaces/6bitParallel.c **** 
 368:./_interfaces/6bitParallel.c **** 
 369:./_interfaces/6bitParallel.c ****   //Use PWM for MCK...
 370:./_interfaces/6bitParallel.c ****   #if (!defined(LCDINTERFACE_BITBANGED_DOTCLOCK) || \
 371:./_interfaces/6bitParallel.c **** 		  !LCDINTERFACE_BITBANGED_DOTCLOCK)
 372:./_interfaces/6bitParallel.c **** 	lcdInterface_pwmDotClockInit(TRUE);
 373:./_interfaces/6bitParallel.c ****   #endif //NOT: LCDINTERFACE_BITBANGED_DOTCLOCK (e.g. use PWM for MCK)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 124


 374:./_interfaces/6bitParallel.c ****  //Otherwise we're bit-banging MCK
 375:./_interfaces/6bitParallel.c **** 
 376:./_interfaces/6bitParallel.c **** 	setoutPORT(MCK_PIN, MCK_PORT); //+OC1B Clock (OC1B, not inverted)
 377:./_interfaces/6bitParallel.c **** 
 378:./_interfaces/6bitParallel.c **** 	//Set the other pins as outputs, as well...
 379:./_interfaces/6bitParallel.c **** 	setoutPORT(HSYNC_PIN, HSYNC_PORT);
 380:./_interfaces/6bitParallel.c **** 	setoutPORT(VSYNC_PIN, VSYNC_PORT);
 381:./_interfaces/6bitParallel.c **** 	setoutPORT(SD_PIN, SD_PORT);
 382:./_interfaces/6bitParallel.c **** 
 383:./_interfaces/6bitParallel.c **** 	setPORToutMasked(RGB_PORT, (RED_MASK | GREEN_MASK | BLUE_MASK));
 384:./_interfaces/6bitParallel.c **** 
 385:./_interfaces/6bitParallel.c **** #warning "The ShutDown pin is completely unimplemented, but for now it seems to work..."
 386:./_interfaces/6bitParallel.c **** 	setpinPORT(SD_PIN, SD_PORT);
 387:./_interfaces/6bitParallel.c **** 
 388:./_interfaces/6bitParallel.c **** 
 389:./_interfaces/6bitParallel.c **** 
 390:./_interfaces/6bitParallel.c **** 	Nada_init();
 391:./_interfaces/6bitParallel.c **** 	noGreen();
 392:./_interfaces/6bitParallel.c **** 	noRed();
 393:./_interfaces/6bitParallel.c **** }
 394:./_interfaces/6bitParallel.c **** 
 395:./_interfaces/6bitParallel.c **** 
 396:./_interfaces/6bitParallel.c **** 
 397:./_interfaces/6bitParallel.c **** 
 398:./_interfaces/6bitParallel.c **** #if(defined(FRAMEBUFFER_TESTING) && FRAMEBUFFER_TESTING)
 399:./_interfaces/6bitParallel.c **** //#error "OK2"
 400:./_interfaces/6bitParallel.c **** //This is for compatibility with _options/writeColor.c, if it's used
 401:./_interfaces/6bitParallel.c **** // (e.g. for frameBuffer and possibly later for rowBuffer/rowSegBuffer?)
 402:./_interfaces/6bitParallel.c **** //Since it's inline, it won't be compiled unless it's used.
 403:./_interfaces/6bitParallel.c **** 
 404:./_interfaces/6bitParallel.c **** //writeColor.c will declare/define writeColor() unless it's already defined
 405:./_interfaces/6bitParallel.c **** // so do-so here.
 406:./_interfaces/6bitParallel.c **** #define writeColor	parallelLCD_writeColor
 407:./_interfaces/6bitParallel.c **** 
 408:./_interfaces/6bitParallel.c **** 
 409:./_interfaces/6bitParallel.c **** 
 410:./_interfaces/6bitParallel.c **** 
 411:./_interfaces/6bitParallel.c **** #if (!defined(LCDINTERFACE_BITBANGED_DOTCLOCK) || \
 412:./_interfaces/6bitParallel.c **** 		!LCDINTERFACE_BITBANGED_DOTCLOCK)
 413:./_interfaces/6bitParallel.c ****  //parallelLCD_writeColor() uses only one instruction when not bit-banged
 414:./_interfaces/6bitParallel.c ****  // (PORT=color)
 415:./_interfaces/6bitParallel.c ****  #define WRITE_COLOR_CYCS 1
 416:./_interfaces/6bitParallel.c **** 
 417:./_interfaces/6bitParallel.c ****  //Calculate WRITE_COLOR_DELAY...
 418:./_interfaces/6bitParallel.c ****  #include "_options/writeColorDelay.h"
 419:./_interfaces/6bitParallel.c **** 
 420:./_interfaces/6bitParallel.c **** #else //LCDINTERFACE_BITBANGED_DOTCLOCK
 421:./_interfaces/6bitParallel.c **** 
 422:./_interfaces/6bitParallel.c ****  //parallelLCD_writeColor() uses four instructions when bit-banged, for now
 423:./_interfaces/6bitParallel.c ****  // The idea is write the port-value with MCK high, bring MCK low, bring it
 424:./_interfaces/6bitParallel.c ****  // high. There's probably no reason it has to be four cycles, except to
 425:./_interfaces/6bitParallel.c ****  // try not to exceed 4MHz when running at 16MHz F_CPU
 426:./_interfaces/6bitParallel.c **** // #define WRITE_COLOR_CYCS 5
 427:./_interfaces/6bitParallel.c **** // The above shouldn't be necesssary, right...? We need delay_Dots...
 428:./_interfaces/6bitParallel.c ****  //We use this to stretch each writeColor() call to fill the screen...
 429:./_interfaces/6bitParallel.c ****  // -1 takes into account that one dot is already drawn in each call to 
 430:./_interfaces/6bitParallel.c ****  // writeColor (when bitbanged).
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 125


 431:./_interfaces/6bitParallel.c ****  #if(!defined(VISIBLE_ROW_DOTS))
 432:./_interfaces/6bitParallel.c ****   #define WRITE_COLOR_DOT_DELAY	((DE_ACTIVE_DOTS/FB_WIDTH)-1)
 433:./_interfaces/6bitParallel.c ****  #else
 434:./_interfaces/6bitParallel.c ****   //In this case, some of the dots in the row may be (e.g.) covered by the
 435:./_interfaces/6bitParallel.c ****   //project's housing...
 436:./_interfaces/6bitParallel.c ****   //The display itself probably requires the same timing regardless, but
 437:./_interfaces/6bitParallel.c ****   //we'd like the framebuffer to be completely visible (so therefore shrunk
 438:./_interfaces/6bitParallel.c ****   //to fit in the visible dots)
 439:./_interfaces/6bitParallel.c ****   //TODO: There'll need to be extra Black drawn at the end of the row...
 440:./_interfaces/6bitParallel.c ****   #define WRITE_COLOR_DOT_DELAY  ((VISIBLE_ROW_DOTS/FB_WIDTH)-1)
 441:./_interfaces/6bitParallel.c ****  #endif
 442:./_interfaces/6bitParallel.c ****  //This is a hack... prevent writeColorDelay.h from being included in
 443:./_interfaces/6bitParallel.c ****  //writeColor.c...
 444:./_interfaces/6bitParallel.c **** 
 445:./_interfaces/6bitParallel.c **** //a/o v86: This apparently can't be working, since "H__" is "H_"
 446:./_interfaces/6bitParallel.c **** // but the code's been functioning for quite some time.
 447:./_interfaces/6bitParallel.c **** #warning "WTF?! This ain't right... but it's been working... writeColorDelay.h is still being inclu
 448:./_interfaces/6bitParallel.c **** 
 449:./_interfaces/6bitParallel.c ****  #define __WRITECOLORDELAY_H_
 450:./_interfaces/6bitParallel.c **** 
 451:./_interfaces/6bitParallel.c **** 
 452:./_interfaces/6bitParallel.c ****  #define delay_OneDot() \
 453:./_interfaces/6bitParallel.c ****  { \
 454:./_interfaces/6bitParallel.c **** 	 asm("nop;"); \
 455:./_interfaces/6bitParallel.c **** 	 clrpinPORT(MCK_PIN, MCK_PORT); \
 456:./_interfaces/6bitParallel.c **** 	 asm("nop;"); \
 457:./_interfaces/6bitParallel.c **** 	 setpinPORT(MCK_PIN, MCK_PORT); \
 458:./_interfaces/6bitParallel.c ****  }
 459:./_interfaces/6bitParallel.c **** 
 460:./_interfaces/6bitParallel.c ****  #define delay_Dots(numDots) \
 461:./_interfaces/6bitParallel.c ****  { \
 462:./_interfaces/6bitParallel.c **** 	 uint16_t i; \
 463:./_interfaces/6bitParallel.c **** 	 for(i=0; i<numDots; i++) \
 464:./_interfaces/6bitParallel.c **** 	 { \
 465:./_interfaces/6bitParallel.c **** 		 delay_OneDot(); \
 466:./_interfaces/6bitParallel.c **** 	 } \
 467:./_interfaces/6bitParallel.c ****  }
 468:./_interfaces/6bitParallel.c **** 
 469:./_interfaces/6bitParallel.c **** #endif
 470:./_interfaces/6bitParallel.c **** 
 471:./_interfaces/6bitParallel.c **** 
 472:./_interfaces/6bitParallel.c **** 
 473:./_interfaces/6bitParallel.c **** static __inline__
 474:./_interfaces/6bitParallel.c **** void parallelLCD_writeColor(uint8_t includeDEinit, uint8_t includeDelay,
 475:./_interfaces/6bitParallel.c **** 																		uint8_t colorVal)
 476:./_interfaces/6bitParallel.c **** 	__attribute__((__always_inline__));
 477:./_interfaces/6bitParallel.c **** 
 478:./_interfaces/6bitParallel.c **** 
 479:./_interfaces/6bitParallel.c **** void parallelLCD_writeColor(uint8_t includeDEinit, uint8_t includeDelay,
 480:./_interfaces/6bitParallel.c **** 																		uint8_t colorVal)
 481:./_interfaces/6bitParallel.c **** {
 482:./_interfaces/6bitParallel.c **** #if(defined(ROW_BUFFER) && ROW_BUFFER)
 483:./_interfaces/6bitParallel.c ****  #error "parallelLCD_writeColor() has not yet implemented ROW_BUFFER"
 484:./_interfaces/6bitParallel.c **** #endif
 485:./_interfaces/6bitParallel.c **** 
 486:./_interfaces/6bitParallel.c **** 	//colorVal is stored as a 6bit value, just as its written to the port
 487:./_interfaces/6bitParallel.c **** 	// Brilliant, I tell you!
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 126


 488:./_interfaces/6bitParallel.c **** 
 489:./_interfaces/6bitParallel.c **** 	//The parallel LCD interface doesn't (yet?) have DE
 490:./_interfaces/6bitParallel.c **** 	// (The Sony display doesn't have DE at all, so it doesn't need to be
 491:./_interfaces/6bitParallel.c **** 	// implemented at all)
 492:./_interfaces/6bitParallel.c **** 	//if(includeDEinit)
 493:./_interfaces/6bitParallel.c **** 	//{
 494:./_interfaces/6bitParallel.c **** 	//
 495:./_interfaces/6bitParallel.c **** 	//}
 496:./_interfaces/6bitParallel.c **** 
 497:./_interfaces/6bitParallel.c **** 	//The remaining two bits on the port are unused, so we don't have to
 498:./_interfaces/6bitParallel.c **** 	//worry about masking:
 499:./_interfaces/6bitParallel.c **** //WTF... this looks right, order of inclusions in main.c... WTF.
 500:./_interfaces/6bitParallel.c **** //#if (defined(BUMP_SENSOR_PORT_ON_RGB_PORT) && BUMP_SENSOR_PORT_ON_RGB_PORT)
 501:./_interfaces/6bitParallel.c **** //#error "OK"
 502:./_interfaces/6bitParallel.c **** #if(defined(OTHER_BITS_HIGH) && OTHER_BITS_HIGH)
 503:./_interfaces/6bitParallel.c **** 	RGB_PORT = colorVal | ((1<<7) | (1<<6));
 2125               		.stabn	68,0,503,.LM232-.LFBB19
 2126               	.LM232:
 2127 07e6 8081      		ld r24,Z
 2128 07e8 806C      		ori r24,lo8(-64)
 2129 07ea 8BBB      		out 0x1b,r24
 504:./_interfaces/6bitParallel.c **** #else
 505:./_interfaces/6bitParallel.c **** 	RGB_PORT = colorVal;
 506:./_interfaces/6bitParallel.c **** #endif
 507:./_interfaces/6bitParallel.c **** 
 508:./_interfaces/6bitParallel.c **** #if (defined(LCDINTERFACE_BITBANGED_DOTCLOCK) && \
 509:./_interfaces/6bitParallel.c **** 		LCDINTERFACE_BITBANGED_DOTCLOCK)
 510:./_interfaces/6bitParallel.c **** 	//THIS ASSUMES: F_CPU <= 16Mhz -> F_MCK <= 4MHz
 511:./_interfaces/6bitParallel.c **** 	// This probably isn't particularly accurate...
 512:./_interfaces/6bitParallel.c **** 	// e.g. it's 5 cycles, actually, since MCK and Data can't be written at
 513:./_interfaces/6bitParallel.c **** 	// the same instruction (unless MCK was on the same port)
 514:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2130               		.stabn	68,0,514,.LM233-.LFBB19
 2131               	.LM233:
 2132               	/* #APP */
 2133               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2134 07ec 0000      		nop;
 2135               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2136               		.stabn	68,0,515,.LM234-.LFBB19
 2137               	.LM234:
 2138               	/* #NOAPP */
 2139 07ee C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2140               		.stabn	68,0,516,.LM235-.LFBB19
 2141               	.LM235:
 2142               	/* #APP */
 2143               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2144 07f0 0000      		nop;
 2145               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2146               		.stabn	68,0,517,.LM236-.LFBB19
 2147               	.LM236:
 2148               	/* #NOAPP */
 2149 07f2 C39A      		sbi 0x18,3
 2150 07f4 8DE0      		ldi r24,lo8(13)
 2151 07f6 90E0      		ldi r25,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 127


 2152 07f8 00C0      		rjmp .L129
 2153               	.L117:
 2154               	.LBE238:
 2155               	.LBE237:
 2156               	.LBE236:
 2157               	.LBE235:
 2158               	.LBE234:
 2159               		.stabs	"_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c",132,0,0,.Ltext18
 2160               	.Ltext18:
2041:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       Hlow_Delay();
 2161               		.stabn	68,0,2041,.LM237-.LFBB19
 2162               	.LM237:
 2163 07fa 89E0      		ldi r24,lo8(9)
 2164 07fc 90E0      		ldi r25,0
 2165               	.L125:
 2166               	.LBB290:
2042:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       Nada_fromHsync();
 2167               		.stabn	68,0,2042,.LM238-.LFBB19
 2168               	.LM238:
 2169               	/* #APP */
 2170               	 ;  2042 "_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c" 1
 2171 07fe 0000      		nop;
 2172               	 ;  0 "" 2
 2173               	/* #NOAPP */
 2174 0800 C398      		cbi 0x18,3
 2175               	/* #APP */
 2176               	 ;  2042 "_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c" 1
 2177 0802 0000      		nop;
 2178               	 ;  0 "" 2
 2179               	/* #NOAPP */
 2180 0804 C39A      		sbi 0x18,3
 2181 0806 0197      		sbiw r24,1
 2182 0808 0097      		sbiw r24,0
 2183 080a 01F4      		brne .L125
 2184               	.LBE290:
2043:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****       HD_Delay();
 2185               		.stabn	68,0,2043,.LM239-.LFBB19
 2186               	.LM239:
 2187 080c C49A      		sbi 0x18,4
 2188 080e 87E0      		ldi r24,lo8(7)
 2189 0810 90E0      		ldi r25,0
 2190               	.L127:
 2191               	.LBB291:
2044:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    }
 2192               		.stabn	68,0,2044,.LM240-.LFBB19
 2193               	.LM240:
 2194               	/* #APP */
 2195               	 ;  2044 "_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c" 1
 2196 0812 0000      		nop;
 2197               	 ;  0 "" 2
 2198               	/* #NOAPP */
 2199 0814 C398      		cbi 0x18,3
 2200               	/* #APP */
 2201               	 ;  2044 "_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c" 1
 2202 0816 0000      		nop;
 2203               	 ;  0 "" 2
 2204               	/* #NOAPP */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 128


 2205 0818 C39A      		sbi 0x18,3
 2206 081a 0197      		sbiw r24,1
 2207 081c 0097      		sbiw r24,0
 2208 081e 01F4      		brne .L127
 2209 0820 00C0      		rjmp .L126
 2210               	.L129:
 2211               	.LBE291:
 2212               	.LBB292:
 2213               	.LBB289:
 2214               	.LBB288:
 2215               	.LBB239:
 2216               		.stabs	"_options/writeColor.c",132,0,0,.Ltext19
 2217               	.Ltext19:
 744:_options/writeColor.c **** #else
 745:_options/writeColor.c **** 	uint8_t * color = writeColor_drawPixSetup(rowNum);
 746:_options/writeColor.c **** #endif
 747:_options/writeColor.c **** 
 748:_options/writeColor.c **** 	//a/o v67:
 749:_options/writeColor.c **** 	// WTF... this didn't work without DEonly_init();
 750:_options/writeColor.c **** 	// despite the fact that writeColor() on the 161 sets DE?!
 751:_options/writeColor.c **** 	// AND it worked on the Tiny861 without this?!
 752:_options/writeColor.c **** 	// No... writeColor doesn't change one register, which needs to be set
 753:_options/writeColor.c **** 	// for blue...
 754:_options/writeColor.c **** 	//DEonly_init();
 755:_options/writeColor.c **** 	// This should now be handled in writeColor(TRUE...)
 756:_options/writeColor.c **** 	// And since Tiny861 didn't have it anyhow, it shouldn't matter that
 757:_options/writeColor.c **** 	// Tiny861's writeColor ignores the TRUE...
 758:_options/writeColor.c **** //	writeColor(TRUE,FALSE, _W);
 759:_options/writeColor.c **** 	//lockPSC2();
 760:_options/writeColor.c **** 	//OCR2SA=1;	//WTF, 0 doesn't work?!
 761:_options/writeColor.c **** 	//OCR2RA=4;
 762:_options/writeColor.c **** 	//unlockPSC2();
 763:_options/writeColor.c ****    /*
 764:_options/writeColor.c ****       DEonly_fromNada();
 765:_options/writeColor.c ****       //Enable complementary-output for Green (on /OC1B, where CLK is OC1B)
 766:_options/writeColor.c ****       TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
 767:_options/writeColor.c ****                | (0<<COM1B1) | (1<<COM1B0)
 768:_options/writeColor.c ****                | (1<<PWM1A) | (1<<PWM1B) );
 769:_options/writeColor.c ****    */
 770:_options/writeColor.c ****       //The Greenish-bar on the left is due to the time it takes to execute
 771:_options/writeColor.c ****       // the first writeColor (since its value is only written at the END)
 772:_options/writeColor.c ****       // Thus the greenish-bar is about one write-color wide...
 773:_options/writeColor.c **** 
 774:_options/writeColor.c ****    //Judging by some weird experiences re v21/22,
 775:_options/writeColor.c ****    // it's not entirely likely this will be predictable
 776:_options/writeColor.c ****    // it may try to recalculate the Z register between writeBlues...
 777:_options/writeColor.c ****    // hopefully not, for now. I should probably assemblify this
 778:_options/writeColor.c **** //      writeColor(FALSE,FALSE, *(color+0));
 779:_options/writeColor.c **** 	//a/o v71, see a/o v67, plus new notes... TRUE is handy!
 780:_options/writeColor.c ****       writeColor(TRUE,FALSE, *(color+0));
 781:_options/writeColor.c **** 
 782:_options/writeColor.c **** 		lvds_enableGreen_MakeClockSensitiveToDT();
 783:_options/writeColor.c **** 
 784:_options/writeColor.c **** 		//Because includeDelay is FALSE, above, do it here...
 785:_options/writeColor.c **** 		// The intention being to get enableGreen as soon after the
 786:_options/writeColor.c **** 		// register-settings as possible.
 787:_options/writeColor.c **** #if (defined(LCDINTERFACE_BITBANGED_DOTCLOCK) && \
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 129


 788:_options/writeColor.c **** 		LCDINTERFACE_BITBANGED_DOTCLOCK)
 789:_options/writeColor.c **** 		delay_Dots(WRITE_COLOR_DOT_DELAY);
 2218               		.stabn	68,0,789,.LM241-.LFBB19
 2219               	.LM241:
 2220               	/* #APP */
 2221               	 ;  789 "_options/writeColor.c" 1
 2222 0822 0000      		nop;
 2223               	 ;  0 "" 2
 2224               	/* #NOAPP */
 2225 0824 C398      		cbi 0x18,3
 2226               	/* #APP */
 2227               	 ;  789 "_options/writeColor.c" 1
 2228 0826 0000      		nop;
 2229               	 ;  0 "" 2
 2230               	/* #NOAPP */
 2231 0828 C39A      		sbi 0x18,3
 2232 082a 0197      		sbiw r24,1
 2233 082c 0097      		sbiw r24,0
 2234 082e 01F4      		brne .L129
 2235               	.LBE239:
 2236               	.LBB240:
 2237               	.LBB241:
 2238               		.stabs	"./_interfaces/6bitParallel.c",132,0,0,.Ltext20
 2239               	.Ltext20:
 503:./_interfaces/6bitParallel.c **** #else
 2240               		.stabn	68,0,503,.LM242-.LFBB19
 2241               	.LM242:
 2242 0830 8181      		ldd r24,Z+1
 2243 0832 806C      		ori r24,lo8(-64)
 2244 0834 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2245               		.stabn	68,0,514,.LM243-.LFBB19
 2246               	.LM243:
 2247               	/* #APP */
 2248               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2249 0836 0000      		nop;
 2250               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2251               		.stabn	68,0,515,.LM244-.LFBB19
 2252               	.LM244:
 2253               	/* #NOAPP */
 2254 0838 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2255               		.stabn	68,0,516,.LM245-.LFBB19
 2256               	.LM245:
 2257               	/* #APP */
 2258               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2259 083a 0000      		nop;
 2260               	 ;  0 "" 2
 2261               		.stabn	68,0,517,.LM246-.LFBB19
 2262               	.LM246:
 2263               	/* #NOAPP */
 2264 083c C39A      		sbi 0x18,3
 2265 083e 8DE0      		ldi r24,lo8(13)
 2266 0840 90E0      		ldi r25,0
 2267               	.L131:
 2268               	.LBB242:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 130


 518:./_interfaces/6bitParallel.c **** #endif
 519:./_interfaces/6bitParallel.c **** 
 520:./_interfaces/6bitParallel.c **** 	//For stretching across the display...
 521:./_interfaces/6bitParallel.c **** 	if(includeDelay)
 522:./_interfaces/6bitParallel.c **** 	{
 523:./_interfaces/6bitParallel.c **** #if (defined(LCDINTERFACE_BITBANGED_DOTCLOCK) && \
 524:./_interfaces/6bitParallel.c **** 		LCDINTERFACE_BITBANGED_DOTCLOCK)
 525:./_interfaces/6bitParallel.c ****  //#error "Wait, we need delay_dots!"
 526:./_interfaces/6bitParallel.c **** 		//One dot has been written, with clrpinPORT, above...
 527:./_interfaces/6bitParallel.c **** 		delay_Dots(WRITE_COLOR_DOT_DELAY);
 2269               		.stabn	68,0,527,.LM247-.LFBB19
 2270               	.LM247:
 2271               	/* #APP */
 2272               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2273 0842 0000      		nop;
 2274               	 ;  0 "" 2
 2275               	/* #NOAPP */
 2276 0844 C398      		cbi 0x18,3
 2277               	/* #APP */
 2278               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2279 0846 0000      		nop;
 2280               	 ;  0 "" 2
 2281               	/* #NOAPP */
 2282 0848 C39A      		sbi 0x18,3
 2283 084a 0197      		sbiw r24,1
 2284 084c 0097      		sbiw r24,0
 2285 084e 01F4      		brne .L131
 2286               	.LBE242:
 2287               	.LBE241:
 2288               	.LBE240:
 2289               	.LBB243:
 2290               	.LBB244:
 503:./_interfaces/6bitParallel.c **** #else
 2291               		.stabn	68,0,503,.LM248-.LFBB19
 2292               	.LM248:
 2293 0850 8281      		ldd r24,Z+2
 2294 0852 806C      		ori r24,lo8(-64)
 2295 0854 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2296               		.stabn	68,0,514,.LM249-.LFBB19
 2297               	.LM249:
 2298               	/* #APP */
 2299               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2300 0856 0000      		nop;
 2301               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2302               		.stabn	68,0,515,.LM250-.LFBB19
 2303               	.LM250:
 2304               	/* #NOAPP */
 2305 0858 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2306               		.stabn	68,0,516,.LM251-.LFBB19
 2307               	.LM251:
 2308               	/* #APP */
 2309               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2310 085a 0000      		nop;
 2311               	 ;  0 "" 2
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 131


 517:./_interfaces/6bitParallel.c **** #endif
 2312               		.stabn	68,0,517,.LM252-.LFBB19
 2313               	.LM252:
 2314               	/* #NOAPP */
 2315 085c C39A      		sbi 0x18,3
 2316 085e 8DE0      		ldi r24,lo8(13)
 2317 0860 90E0      		ldi r25,0
 2318               	.L133:
 2319               	.LBB245:
 2320               		.stabn	68,0,527,.LM253-.LFBB19
 2321               	.LM253:
 2322               	/* #APP */
 2323               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2324 0862 0000      		nop;
 2325               	 ;  0 "" 2
 2326               	/* #NOAPP */
 2327 0864 C398      		cbi 0x18,3
 2328               	/* #APP */
 2329               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2330 0866 0000      		nop;
 2331               	 ;  0 "" 2
 2332               	/* #NOAPP */
 2333 0868 C39A      		sbi 0x18,3
 2334 086a 0197      		sbiw r24,1
 2335 086c 0097      		sbiw r24,0
 2336 086e 01F4      		brne .L133
 2337               	.LBE245:
 2338               	.LBE244:
 2339               	.LBE243:
 2340               	.LBB246:
 2341               	.LBB247:
 503:./_interfaces/6bitParallel.c **** #else
 2342               		.stabn	68,0,503,.LM254-.LFBB19
 2343               	.LM254:
 2344 0870 8381      		ldd r24,Z+3
 2345 0872 806C      		ori r24,lo8(-64)
 2346 0874 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2347               		.stabn	68,0,514,.LM255-.LFBB19
 2348               	.LM255:
 2349               	/* #APP */
 2350               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2351 0876 0000      		nop;
 2352               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2353               		.stabn	68,0,515,.LM256-.LFBB19
 2354               	.LM256:
 2355               	/* #NOAPP */
 2356 0878 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2357               		.stabn	68,0,516,.LM257-.LFBB19
 2358               	.LM257:
 2359               	/* #APP */
 2360               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2361 087a 0000      		nop;
 2362               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 132


 2363               		.stabn	68,0,517,.LM258-.LFBB19
 2364               	.LM258:
 2365               	/* #NOAPP */
 2366 087c C39A      		sbi 0x18,3
 2367 087e 8DE0      		ldi r24,lo8(13)
 2368 0880 90E0      		ldi r25,0
 2369               	.L135:
 2370               	.LBB248:
 2371               		.stabn	68,0,527,.LM259-.LFBB19
 2372               	.LM259:
 2373               	/* #APP */
 2374               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2375 0882 0000      		nop;
 2376               	 ;  0 "" 2
 2377               	/* #NOAPP */
 2378 0884 C398      		cbi 0x18,3
 2379               	/* #APP */
 2380               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2381 0886 0000      		nop;
 2382               	 ;  0 "" 2
 2383               	/* #NOAPP */
 2384 0888 C39A      		sbi 0x18,3
 2385 088a 0197      		sbiw r24,1
 2386 088c 0097      		sbiw r24,0
 2387 088e 01F4      		brne .L135
 2388               	.LBE248:
 2389               	.LBE247:
 2390               	.LBE246:
 2391               	.LBB249:
 2392               	.LBB250:
 503:./_interfaces/6bitParallel.c **** #else
 2393               		.stabn	68,0,503,.LM260-.LFBB19
 2394               	.LM260:
 2395 0890 8481      		ldd r24,Z+4
 2396 0892 806C      		ori r24,lo8(-64)
 2397 0894 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2398               		.stabn	68,0,514,.LM261-.LFBB19
 2399               	.LM261:
 2400               	/* #APP */
 2401               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2402 0896 0000      		nop;
 2403               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2404               		.stabn	68,0,515,.LM262-.LFBB19
 2405               	.LM262:
 2406               	/* #NOAPP */
 2407 0898 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2408               		.stabn	68,0,516,.LM263-.LFBB19
 2409               	.LM263:
 2410               	/* #APP */
 2411               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2412 089a 0000      		nop;
 2413               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 2414               		.stabn	68,0,517,.LM264-.LFBB19
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 133


 2415               	.LM264:
 2416               	/* #NOAPP */
 2417 089c C39A      		sbi 0x18,3
 2418 089e 8DE0      		ldi r24,lo8(13)
 2419 08a0 90E0      		ldi r25,0
 2420               	.L137:
 2421               	.LBB251:
 2422               		.stabn	68,0,527,.LM265-.LFBB19
 2423               	.LM265:
 2424               	/* #APP */
 2425               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2426 08a2 0000      		nop;
 2427               	 ;  0 "" 2
 2428               	/* #NOAPP */
 2429 08a4 C398      		cbi 0x18,3
 2430               	/* #APP */
 2431               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2432 08a6 0000      		nop;
 2433               	 ;  0 "" 2
 2434               	/* #NOAPP */
 2435 08a8 C39A      		sbi 0x18,3
 2436 08aa 0197      		sbiw r24,1
 2437 08ac 0097      		sbiw r24,0
 2438 08ae 01F4      		brne .L137
 2439               	.LBE251:
 2440               	.LBE250:
 2441               	.LBE249:
 2442               	.LBB252:
 2443               	.LBB253:
 503:./_interfaces/6bitParallel.c **** #else
 2444               		.stabn	68,0,503,.LM266-.LFBB19
 2445               	.LM266:
 2446 08b0 8581      		ldd r24,Z+5
 2447 08b2 806C      		ori r24,lo8(-64)
 2448 08b4 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2449               		.stabn	68,0,514,.LM267-.LFBB19
 2450               	.LM267:
 2451               	/* #APP */
 2452               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2453 08b6 0000      		nop;
 2454               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2455               		.stabn	68,0,515,.LM268-.LFBB19
 2456               	.LM268:
 2457               	/* #NOAPP */
 2458 08b8 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2459               		.stabn	68,0,516,.LM269-.LFBB19
 2460               	.LM269:
 2461               	/* #APP */
 2462               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2463 08ba 0000      		nop;
 2464               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 2465               		.stabn	68,0,517,.LM270-.LFBB19
 2466               	.LM270:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 134


 2467               	/* #NOAPP */
 2468 08bc C39A      		sbi 0x18,3
 2469 08be 8DE0      		ldi r24,lo8(13)
 2470 08c0 90E0      		ldi r25,0
 2471               	.L139:
 2472               	.LBB254:
 2473               		.stabn	68,0,527,.LM271-.LFBB19
 2474               	.LM271:
 2475               	/* #APP */
 2476               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2477 08c2 0000      		nop;
 2478               	 ;  0 "" 2
 2479               	/* #NOAPP */
 2480 08c4 C398      		cbi 0x18,3
 2481               	/* #APP */
 2482               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2483 08c6 0000      		nop;
 2484               	 ;  0 "" 2
 2485               	/* #NOAPP */
 2486 08c8 C39A      		sbi 0x18,3
 2487 08ca 0197      		sbiw r24,1
 2488 08cc 0097      		sbiw r24,0
 2489 08ce 01F4      		brne .L139
 2490               	.LBE254:
 2491               	.LBE253:
 2492               	.LBE252:
 2493               	.LBB255:
 2494               	.LBB256:
 503:./_interfaces/6bitParallel.c **** #else
 2495               		.stabn	68,0,503,.LM272-.LFBB19
 2496               	.LM272:
 2497 08d0 8681      		ldd r24,Z+6
 2498 08d2 806C      		ori r24,lo8(-64)
 2499 08d4 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2500               		.stabn	68,0,514,.LM273-.LFBB19
 2501               	.LM273:
 2502               	/* #APP */
 2503               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2504 08d6 0000      		nop;
 2505               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2506               		.stabn	68,0,515,.LM274-.LFBB19
 2507               	.LM274:
 2508               	/* #NOAPP */
 2509 08d8 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2510               		.stabn	68,0,516,.LM275-.LFBB19
 2511               	.LM275:
 2512               	/* #APP */
 2513               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2514 08da 0000      		nop;
 2515               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 2516               		.stabn	68,0,517,.LM276-.LFBB19
 2517               	.LM276:
 2518               	/* #NOAPP */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 135


 2519 08dc C39A      		sbi 0x18,3
 2520 08de 8DE0      		ldi r24,lo8(13)
 2521 08e0 90E0      		ldi r25,0
 2522               	.L141:
 2523               	.LBB257:
 2524               		.stabn	68,0,527,.LM277-.LFBB19
 2525               	.LM277:
 2526               	/* #APP */
 2527               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2528 08e2 0000      		nop;
 2529               	 ;  0 "" 2
 2530               	/* #NOAPP */
 2531 08e4 C398      		cbi 0x18,3
 2532               	/* #APP */
 2533               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2534 08e6 0000      		nop;
 2535               	 ;  0 "" 2
 2536               	/* #NOAPP */
 2537 08e8 C39A      		sbi 0x18,3
 2538 08ea 0197      		sbiw r24,1
 2539 08ec 0097      		sbiw r24,0
 2540 08ee 01F4      		brne .L141
 2541               	.LBE257:
 2542               	.LBE256:
 2543               	.LBE255:
 2544               	.LBB258:
 2545               	.LBB259:
 503:./_interfaces/6bitParallel.c **** #else
 2546               		.stabn	68,0,503,.LM278-.LFBB19
 2547               	.LM278:
 2548 08f0 8781      		ldd r24,Z+7
 2549 08f2 806C      		ori r24,lo8(-64)
 2550 08f4 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2551               		.stabn	68,0,514,.LM279-.LFBB19
 2552               	.LM279:
 2553               	/* #APP */
 2554               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2555 08f6 0000      		nop;
 2556               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2557               		.stabn	68,0,515,.LM280-.LFBB19
 2558               	.LM280:
 2559               	/* #NOAPP */
 2560 08f8 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2561               		.stabn	68,0,516,.LM281-.LFBB19
 2562               	.LM281:
 2563               	/* #APP */
 2564               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2565 08fa 0000      		nop;
 2566               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 2567               		.stabn	68,0,517,.LM282-.LFBB19
 2568               	.LM282:
 2569               	/* #NOAPP */
 2570 08fc C39A      		sbi 0x18,3
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 136


 2571 08fe 8DE0      		ldi r24,lo8(13)
 2572 0900 90E0      		ldi r25,0
 2573               	.L143:
 2574               	.LBB260:
 2575               		.stabn	68,0,527,.LM283-.LFBB19
 2576               	.LM283:
 2577               	/* #APP */
 2578               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2579 0902 0000      		nop;
 2580               	 ;  0 "" 2
 2581               	/* #NOAPP */
 2582 0904 C398      		cbi 0x18,3
 2583               	/* #APP */
 2584               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2585 0906 0000      		nop;
 2586               	 ;  0 "" 2
 2587               	/* #NOAPP */
 2588 0908 C39A      		sbi 0x18,3
 2589 090a 0197      		sbiw r24,1
 2590 090c 0097      		sbiw r24,0
 2591 090e 01F4      		brne .L143
 2592               	.LBE260:
 2593               	.LBE259:
 2594               	.LBE258:
 2595               	.LBB261:
 2596               	.LBB262:
 503:./_interfaces/6bitParallel.c **** #else
 2597               		.stabn	68,0,503,.LM284-.LFBB19
 2598               	.LM284:
 2599 0910 8085      		ldd r24,Z+8
 2600 0912 806C      		ori r24,lo8(-64)
 2601 0914 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2602               		.stabn	68,0,514,.LM285-.LFBB19
 2603               	.LM285:
 2604               	/* #APP */
 2605               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2606 0916 0000      		nop;
 2607               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2608               		.stabn	68,0,515,.LM286-.LFBB19
 2609               	.LM286:
 2610               	/* #NOAPP */
 2611 0918 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2612               		.stabn	68,0,516,.LM287-.LFBB19
 2613               	.LM287:
 2614               	/* #APP */
 2615               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2616 091a 0000      		nop;
 2617               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 2618               		.stabn	68,0,517,.LM288-.LFBB19
 2619               	.LM288:
 2620               	/* #NOAPP */
 2621 091c C39A      		sbi 0x18,3
 2622 091e 8DE0      		ldi r24,lo8(13)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 137


 2623 0920 90E0      		ldi r25,0
 2624               	.L145:
 2625               	.LBB263:
 2626               		.stabn	68,0,527,.LM289-.LFBB19
 2627               	.LM289:
 2628               	/* #APP */
 2629               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2630 0922 0000      		nop;
 2631               	 ;  0 "" 2
 2632               	/* #NOAPP */
 2633 0924 C398      		cbi 0x18,3
 2634               	/* #APP */
 2635               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2636 0926 0000      		nop;
 2637               	 ;  0 "" 2
 2638               	/* #NOAPP */
 2639 0928 C39A      		sbi 0x18,3
 2640 092a 0197      		sbiw r24,1
 2641 092c 0097      		sbiw r24,0
 2642 092e 01F4      		brne .L145
 2643               	.LBE263:
 2644               	.LBE262:
 2645               	.LBE261:
 2646               	.LBB264:
 2647               	.LBB265:
 503:./_interfaces/6bitParallel.c **** #else
 2648               		.stabn	68,0,503,.LM290-.LFBB19
 2649               	.LM290:
 2650 0930 8185      		ldd r24,Z+9
 2651 0932 806C      		ori r24,lo8(-64)
 2652 0934 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2653               		.stabn	68,0,514,.LM291-.LFBB19
 2654               	.LM291:
 2655               	/* #APP */
 2656               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2657 0936 0000      		nop;
 2658               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2659               		.stabn	68,0,515,.LM292-.LFBB19
 2660               	.LM292:
 2661               	/* #NOAPP */
 2662 0938 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2663               		.stabn	68,0,516,.LM293-.LFBB19
 2664               	.LM293:
 2665               	/* #APP */
 2666               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2667 093a 0000      		nop;
 2668               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 2669               		.stabn	68,0,517,.LM294-.LFBB19
 2670               	.LM294:
 2671               	/* #NOAPP */
 2672 093c C39A      		sbi 0x18,3
 2673 093e 8DE0      		ldi r24,lo8(13)
 2674 0940 90E0      		ldi r25,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 138


 2675               	.L147:
 2676               	.LBB266:
 2677               		.stabn	68,0,527,.LM295-.LFBB19
 2678               	.LM295:
 2679               	/* #APP */
 2680               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2681 0942 0000      		nop;
 2682               	 ;  0 "" 2
 2683               	/* #NOAPP */
 2684 0944 C398      		cbi 0x18,3
 2685               	/* #APP */
 2686               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2687 0946 0000      		nop;
 2688               	 ;  0 "" 2
 2689               	/* #NOAPP */
 2690 0948 C39A      		sbi 0x18,3
 2691 094a 0197      		sbiw r24,1
 2692 094c 0097      		sbiw r24,0
 2693 094e 01F4      		brne .L147
 2694               	.LBE266:
 2695               	.LBE265:
 2696               	.LBE264:
 2697               	.LBB267:
 2698               	.LBB268:
 503:./_interfaces/6bitParallel.c **** #else
 2699               		.stabn	68,0,503,.LM296-.LFBB19
 2700               	.LM296:
 2701 0950 8285      		ldd r24,Z+10
 2702 0952 806C      		ori r24,lo8(-64)
 2703 0954 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2704               		.stabn	68,0,514,.LM297-.LFBB19
 2705               	.LM297:
 2706               	/* #APP */
 2707               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2708 0956 0000      		nop;
 2709               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2710               		.stabn	68,0,515,.LM298-.LFBB19
 2711               	.LM298:
 2712               	/* #NOAPP */
 2713 0958 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2714               		.stabn	68,0,516,.LM299-.LFBB19
 2715               	.LM299:
 2716               	/* #APP */
 2717               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2718 095a 0000      		nop;
 2719               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 2720               		.stabn	68,0,517,.LM300-.LFBB19
 2721               	.LM300:
 2722               	/* #NOAPP */
 2723 095c C39A      		sbi 0x18,3
 2724 095e 8DE0      		ldi r24,lo8(13)
 2725 0960 90E0      		ldi r25,0
 2726               	.L149:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 139


 2727               	.LBB269:
 2728               		.stabn	68,0,527,.LM301-.LFBB19
 2729               	.LM301:
 2730               	/* #APP */
 2731               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2732 0962 0000      		nop;
 2733               	 ;  0 "" 2
 2734               	/* #NOAPP */
 2735 0964 C398      		cbi 0x18,3
 2736               	/* #APP */
 2737               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2738 0966 0000      		nop;
 2739               	 ;  0 "" 2
 2740               	/* #NOAPP */
 2741 0968 C39A      		sbi 0x18,3
 2742 096a 0197      		sbiw r24,1
 2743 096c 0097      		sbiw r24,0
 2744 096e 01F4      		brne .L149
 2745               	.LBE269:
 2746               	.LBE268:
 2747               	.LBE267:
 2748               	.LBB270:
 2749               	.LBB271:
 503:./_interfaces/6bitParallel.c **** #else
 2750               		.stabn	68,0,503,.LM302-.LFBB19
 2751               	.LM302:
 2752 0970 8385      		ldd r24,Z+11
 2753 0972 806C      		ori r24,lo8(-64)
 2754 0974 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2755               		.stabn	68,0,514,.LM303-.LFBB19
 2756               	.LM303:
 2757               	/* #APP */
 2758               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2759 0976 0000      		nop;
 2760               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2761               		.stabn	68,0,515,.LM304-.LFBB19
 2762               	.LM304:
 2763               	/* #NOAPP */
 2764 0978 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2765               		.stabn	68,0,516,.LM305-.LFBB19
 2766               	.LM305:
 2767               	/* #APP */
 2768               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2769 097a 0000      		nop;
 2770               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 2771               		.stabn	68,0,517,.LM306-.LFBB19
 2772               	.LM306:
 2773               	/* #NOAPP */
 2774 097c C39A      		sbi 0x18,3
 2775 097e 8DE0      		ldi r24,lo8(13)
 2776 0980 90E0      		ldi r25,0
 2777               	.L151:
 2778               	.LBB272:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 140


 2779               		.stabn	68,0,527,.LM307-.LFBB19
 2780               	.LM307:
 2781               	/* #APP */
 2782               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2783 0982 0000      		nop;
 2784               	 ;  0 "" 2
 2785               	/* #NOAPP */
 2786 0984 C398      		cbi 0x18,3
 2787               	/* #APP */
 2788               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2789 0986 0000      		nop;
 2790               	 ;  0 "" 2
 2791               	/* #NOAPP */
 2792 0988 C39A      		sbi 0x18,3
 2793 098a 0197      		sbiw r24,1
 2794 098c 0097      		sbiw r24,0
 2795 098e 01F4      		brne .L151
 2796               	.LBE272:
 2797               	.LBE271:
 2798               	.LBE270:
 2799               	.LBB273:
 2800               	.LBB274:
 503:./_interfaces/6bitParallel.c **** #else
 2801               		.stabn	68,0,503,.LM308-.LFBB19
 2802               	.LM308:
 2803 0990 8485      		ldd r24,Z+12
 2804 0992 806C      		ori r24,lo8(-64)
 2805 0994 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2806               		.stabn	68,0,514,.LM309-.LFBB19
 2807               	.LM309:
 2808               	/* #APP */
 2809               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2810 0996 0000      		nop;
 2811               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2812               		.stabn	68,0,515,.LM310-.LFBB19
 2813               	.LM310:
 2814               	/* #NOAPP */
 2815 0998 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2816               		.stabn	68,0,516,.LM311-.LFBB19
 2817               	.LM311:
 2818               	/* #APP */
 2819               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2820 099a 0000      		nop;
 2821               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 2822               		.stabn	68,0,517,.LM312-.LFBB19
 2823               	.LM312:
 2824               	/* #NOAPP */
 2825 099c C39A      		sbi 0x18,3
 2826 099e 8DE0      		ldi r24,lo8(13)
 2827 09a0 90E0      		ldi r25,0
 2828               	.L153:
 2829               	.LBB275:
 2830               		.stabn	68,0,527,.LM313-.LFBB19
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 141


 2831               	.LM313:
 2832               	/* #APP */
 2833               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2834 09a2 0000      		nop;
 2835               	 ;  0 "" 2
 2836               	/* #NOAPP */
 2837 09a4 C398      		cbi 0x18,3
 2838               	/* #APP */
 2839               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2840 09a6 0000      		nop;
 2841               	 ;  0 "" 2
 2842               	/* #NOAPP */
 2843 09a8 C39A      		sbi 0x18,3
 2844 09aa 0197      		sbiw r24,1
 2845 09ac 0097      		sbiw r24,0
 2846 09ae 01F4      		brne .L153
 2847               	.LBE275:
 2848               	.LBE274:
 2849               	.LBE273:
 2850               	.LBB276:
 2851               	.LBB277:
 503:./_interfaces/6bitParallel.c **** #else
 2852               		.stabn	68,0,503,.LM314-.LFBB19
 2853               	.LM314:
 2854 09b0 8585      		ldd r24,Z+13
 2855 09b2 806C      		ori r24,lo8(-64)
 2856 09b4 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2857               		.stabn	68,0,514,.LM315-.LFBB19
 2858               	.LM315:
 2859               	/* #APP */
 2860               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2861 09b6 0000      		nop;
 2862               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2863               		.stabn	68,0,515,.LM316-.LFBB19
 2864               	.LM316:
 2865               	/* #NOAPP */
 2866 09b8 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2867               		.stabn	68,0,516,.LM317-.LFBB19
 2868               	.LM317:
 2869               	/* #APP */
 2870               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2871 09ba 0000      		nop;
 2872               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 2873               		.stabn	68,0,517,.LM318-.LFBB19
 2874               	.LM318:
 2875               	/* #NOAPP */
 2876 09bc C39A      		sbi 0x18,3
 2877 09be 8DE0      		ldi r24,lo8(13)
 2878 09c0 90E0      		ldi r25,0
 2879               	.L155:
 2880               	.LBB278:
 2881               		.stabn	68,0,527,.LM319-.LFBB19
 2882               	.LM319:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 142


 2883               	/* #APP */
 2884               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2885 09c2 0000      		nop;
 2886               	 ;  0 "" 2
 2887               	/* #NOAPP */
 2888 09c4 C398      		cbi 0x18,3
 2889               	/* #APP */
 2890               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2891 09c6 0000      		nop;
 2892               	 ;  0 "" 2
 2893               	/* #NOAPP */
 2894 09c8 C39A      		sbi 0x18,3
 2895 09ca 0197      		sbiw r24,1
 2896 09cc 0097      		sbiw r24,0
 2897 09ce 01F4      		brne .L155
 2898               	.LBE278:
 2899               	.LBE277:
 2900               	.LBE276:
 2901               	.LBB279:
 2902               	.LBB280:
 503:./_interfaces/6bitParallel.c **** #else
 2903               		.stabn	68,0,503,.LM320-.LFBB19
 2904               	.LM320:
 2905 09d0 8685      		ldd r24,Z+14
 2906 09d2 806C      		ori r24,lo8(-64)
 2907 09d4 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2908               		.stabn	68,0,514,.LM321-.LFBB19
 2909               	.LM321:
 2910               	/* #APP */
 2911               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2912 09d6 0000      		nop;
 2913               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2914               		.stabn	68,0,515,.LM322-.LFBB19
 2915               	.LM322:
 2916               	/* #NOAPP */
 2917 09d8 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2918               		.stabn	68,0,516,.LM323-.LFBB19
 2919               	.LM323:
 2920               	/* #APP */
 2921               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2922 09da 0000      		nop;
 2923               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 2924               		.stabn	68,0,517,.LM324-.LFBB19
 2925               	.LM324:
 2926               	/* #NOAPP */
 2927 09dc C39A      		sbi 0x18,3
 2928 09de 8DE0      		ldi r24,lo8(13)
 2929 09e0 90E0      		ldi r25,0
 2930               	.L157:
 2931               	.LBB281:
 2932               		.stabn	68,0,527,.LM325-.LFBB19
 2933               	.LM325:
 2934               	/* #APP */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 143


 2935               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2936 09e2 0000      		nop;
 2937               	 ;  0 "" 2
 2938               	/* #NOAPP */
 2939 09e4 C398      		cbi 0x18,3
 2940               	/* #APP */
 2941               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2942 09e6 0000      		nop;
 2943               	 ;  0 "" 2
 2944               	/* #NOAPP */
 2945 09e8 C39A      		sbi 0x18,3
 2946 09ea 0197      		sbiw r24,1
 2947 09ec 0097      		sbiw r24,0
 2948 09ee 01F4      		brne .L157
 2949               	.LBE281:
 2950               	.LBE280:
 2951               	.LBE279:
 2952               	.LBB282:
 2953               	.LBB283:
 503:./_interfaces/6bitParallel.c **** #else
 2954               		.stabn	68,0,503,.LM326-.LFBB19
 2955               	.LM326:
 2956 09f0 8785      		ldd r24,Z+15
 2957 09f2 806C      		ori r24,lo8(-64)
 2958 09f4 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 2959               		.stabn	68,0,514,.LM327-.LFBB19
 2960               	.LM327:
 2961               	/* #APP */
 2962               	 ;  514 "./_interfaces/6bitParallel.c" 1
 2963 09f6 0000      		nop;
 2964               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 2965               		.stabn	68,0,515,.LM328-.LFBB19
 2966               	.LM328:
 2967               	/* #NOAPP */
 2968 09f8 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 2969               		.stabn	68,0,516,.LM329-.LFBB19
 2970               	.LM329:
 2971               	/* #APP */
 2972               	 ;  516 "./_interfaces/6bitParallel.c" 1
 2973 09fa 0000      		nop;
 2974               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 2975               		.stabn	68,0,517,.LM330-.LFBB19
 2976               	.LM330:
 2977               	/* #NOAPP */
 2978 09fc C39A      		sbi 0x18,3
 2979 09fe 8DE0      		ldi r24,lo8(13)
 2980 0a00 90E0      		ldi r25,0
 2981               	.L159:
 2982               	.LBB284:
 2983               		.stabn	68,0,527,.LM331-.LFBB19
 2984               	.LM331:
 2985               	/* #APP */
 2986               	 ;  527 "./_interfaces/6bitParallel.c" 1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 144


 2987 0a02 0000      		nop;
 2988               	 ;  0 "" 2
 2989               	/* #NOAPP */
 2990 0a04 C398      		cbi 0x18,3
 2991               	/* #APP */
 2992               	 ;  527 "./_interfaces/6bitParallel.c" 1
 2993 0a06 0000      		nop;
 2994               	 ;  0 "" 2
 2995               	/* #NOAPP */
 2996 0a08 C39A      		sbi 0x18,3
 2997 0a0a 0197      		sbiw r24,1
 2998 0a0c 0097      		sbiw r24,0
 2999 0a0e 01F4      		brne .L159
 3000               	.LBE284:
 3001               	.LBE283:
 3002               	.LBE282:
 3003               	.LBB285:
 3004               	.LBB286:
 503:./_interfaces/6bitParallel.c **** #else
 3005               		.stabn	68,0,503,.LM332-.LFBB19
 3006               	.LM332:
 3007 0a10 8089      		ldd r24,Z+16
 3008 0a12 806C      		ori r24,lo8(-64)
 3009 0a14 8BBB      		out 0x1b,r24
 514:./_interfaces/6bitParallel.c **** 	clrpinPORT(MCK_PIN, MCK_PORT);
 3010               		.stabn	68,0,514,.LM333-.LFBB19
 3011               	.LM333:
 3012               	/* #APP */
 3013               	 ;  514 "./_interfaces/6bitParallel.c" 1
 3014 0a16 0000      		nop;
 3015               	 ;  0 "" 2
 515:./_interfaces/6bitParallel.c **** 	asm("nop;");
 3016               		.stabn	68,0,515,.LM334-.LFBB19
 3017               	.LM334:
 3018               	/* #NOAPP */
 3019 0a18 C398      		cbi 0x18,3
 516:./_interfaces/6bitParallel.c **** 	setpinPORT(MCK_PIN, MCK_PORT);
 3020               		.stabn	68,0,516,.LM335-.LFBB19
 3021               	.LM335:
 3022               	/* #APP */
 3023               	 ;  516 "./_interfaces/6bitParallel.c" 1
 3024 0a1a 0000      		nop;
 3025               	 ;  0 "" 2
 517:./_interfaces/6bitParallel.c **** #endif
 3026               		.stabn	68,0,517,.LM336-.LFBB19
 3027               	.LM336:
 3028               	/* #NOAPP */
 3029 0a1c C39A      		sbi 0x18,3
 3030 0a1e 80E1      		ldi r24,lo8(16)
 3031 0a20 90E0      		ldi r25,0
 3032               	.L161:
 3033               	.LBE286:
 3034               	.LBE285:
 3035               	.LBB287:
 3036               		.stabs	"_options/writeColor.c",132,0,0,.Ltext21
 3037               	.Ltext21:
 790:_options/writeColor.c **** #else
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 145


 791:_options/writeColor.c **** 		delay_cyc(WRITE_COLOR_DELAY);
 792:_options/writeColor.c **** #endif
 793:_options/writeColor.c **** 
 794:_options/writeColor.c ****       //Moving this here not only removes (most of) the green bar
 795:_options/writeColor.c ****       // but also seems to make the pixel edges significantly sharper
 796:_options/writeColor.c ****       // (v29 has ~1/8in of noise, v30 has ~1pixel noise at the right edge)
 797:_options/writeColor.c **** //      TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
 798:_options/writeColor.c **** //               | (0<<COM1B1) | (1<<COM1B0)
 799:_options/writeColor.c **** //               | (1<<PWM1A) | (1<<PWM1B) );
 800:_options/writeColor.c **** 
 801:_options/writeColor.c **** 
 802:_options/writeColor.c **** #if ( (defined(FRAMEBUFFER_TESTING) && FRAMEBUFFER_TESTING) || \
 803:_options/writeColor.c ****       (defined(ROWBUFFER_TESTING) && ROWBUFFER_TESTING) )
 804:_options/writeColor.c **** 		//fb_writeColorCalls is pretty much identical to the below cases...
 805:_options/writeColor.c **** 		// but automatically includes the proper number of calls to
 806:_options/writeColor.c **** 		// writeColor based on FB_WIDTH
 807:_options/writeColor.c **** 		//Can't yet create an autoGenerated form via make...
 808:_options/writeColor.c **** 		// since FB_WIDTH is not available to make.
 809:_options/writeColor.c **** 		#include "fb_writeColorCalls.c"
 810:_options/writeColor.c **** 		//again, including fb_writeColorCalls.c, here is the equivalent of:
 811:_options/writeColor.c **** 		//writeColor(FALSE,TRUE, *(color+1));
 812:_options/writeColor.c **** 		//writeColor(FALSE,TRUE, *(color+2));
 813:_options/writeColor.c **** 		// ...
 814:_options/writeColor.c **** 		// the appropriate number of times.
 815:_options/writeColor.c **** #else
 816:_options/writeColor.c **** #error "This is just a reminder that all the ugly still exists and could probably easily be replace
 817:_options/writeColor.c **** 		//Keeping this for the various special cases that have yet to be
 818:_options/writeColor.c **** 		//reimplemented...
 819:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+1));    
 820:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+2));    
 821:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+3)); 
 822:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+4));    
 823:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+5));                
 824:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+6));  
 825:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+7));                         
 826:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+8));                         
 827:_options/writeColor.c **** 		writeColor(FALSE,TRUE, *(color+9));                         
 828:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+10));                         
 829:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+11));                         
 830:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+12));                         
 831:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+13));                         
 832:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+14));                         
 833:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+15));   
 834:_options/writeColor.c **** #define COLORS_WRITTEN   16      
 835:_options/writeColor.c **** #if ( (defined(COLOR_BAR_SCROLL) && COLOR_BAR_SCROLL) \
 836:_options/writeColor.c ****    || (defined(ROW_BUFFER) && (ROW_BUFFER)) )
 837:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+16));
 838:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+17));
 839:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+18));
 840:_options/writeColor.c ****       writeColor(FALSE,TRUE, *(color+19));
 841:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+20));
 842:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+21));
 843:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+22));
 844:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+23));
 845:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+24));
 846:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+25));
 847:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+26));
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 146


 848:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+27));
 849:_options/writeColor.c **** #define COLORS_WRITTEN   28
 850:_options/writeColor.c **** #if (defined(ROW_BUFFER) && (ROW_BUFFER))
 851:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+28));
 852:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+29));
 853:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+30));
 854:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+31));
 855:_options/writeColor.c **** //Some sort of syncing problem after 32... (?)
 856:_options/writeColor.c **** 
 857:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+32));
 858:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+33));
 859:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+34));
 860:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+35));
 861:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+36));
 862:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+37));
 863:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+38));
 864:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+39));
 865:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+40));
 866:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+41));
 867:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+42));
 868:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+43));
 869:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+44));
 870:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+45));
 871:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+46));
 872:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+47));
 873:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+48));
 874:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+49));
 875:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+50));
 876:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+51));
 877:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+52));
 878:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+53));
 879:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+54));
 880:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+55));
 881:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+56));
 882:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+57));
 883:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+58));
 884:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+59));
 885:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+60));
 886:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+61));
 887:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+62));
 888:_options/writeColor.c **** writeColor(FALSE,TRUE, *(color+63));
 889:_options/writeColor.c **** // WriteColor writes the pixel *after* the calculations...
 890:_options/writeColor.c **** // thus the pixel appears basically after writeColor completes
 891:_options/writeColor.c **** // These nops assure the 64th pixel is fully-displayed before exitting
 892:_options/writeColor.c **** // (Not sure how the other following instructions apply to this)
 893:_options/writeColor.c **** // The number of nops was found experimentally...
 894:_options/writeColor.c **** //a/o v71 (in which this isn't even executed, due to #if...)
 895:_options/writeColor.c **** // See below...
 896:_options/writeColor.c **** asm("nop");
 897:_options/writeColor.c **** asm("nop");
 898:_options/writeColor.c **** asm("nop");
 899:_options/writeColor.c **** asm("nop");
 900:_options/writeColor.c **** asm("nop");
 901:_options/writeColor.c **** asm("nop");
 902:_options/writeColor.c **** asm("nop");
 903:_options/writeColor.c **** asm("nop");
 904:_options/writeColor.c **** //count "0" below, as well..
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 147


 905:_options/writeColor.c **** #define COLORS_WRITTEN 65
 906:_options/writeColor.c **** #endif //ROW_BUFFER
 907:_options/writeColor.c **** #else
 908:_options/writeColor.c **** //   writeColor(0);
 909:_options/writeColor.c **** #endif //COLOR_BARS || ROW_BUFFER
 910:_options/writeColor.c **** #endif //FRAMEBUFFER_TESTING or not...
 911:_options/writeColor.c **** 
 912:_options/writeColor.c **** /*      reg[17] = colorBuffer[rowNum][17];                         
 913:_options/writeColor.c ****       writeColor(reg[17]);                         
 914:_options/writeColor.c ****       ...
 915:_options/writeColor.c ****       reg[20] = colorBuffer[rowNum][20];                         
 916:_options/writeColor.c ****       writeColor(reg[20]);  
 917:_options/writeColor.c ****       
 918:_options/writeColor.c ****       //REPEATING to fill screen... (delayDots = 342 worked prior to this)
 919:_options/writeColor.c ****       reg[0] = colorBuffer[rowNum][0];
 920:_options/writeColor.c ****       writeColor(reg[0]);
 921:_options/writeColor.c ****       ...
 922:_options/writeColor.c ****       reg[10] = colorBuffer[rowNum][10];
 923:_options/writeColor.c ****       writeColor(reg[10]);
 924:_options/writeColor.c **** */
 925:_options/writeColor.c **** 
 926:_options/writeColor.c **** 		//a/o v71, see note above regarding nops...
 927:_options/writeColor.c **** 		// since writeColor() NOW actually *sets* the registers at the *end*
 928:_options/writeColor.c **** 		// of the calculations, but *before* the WRITE_COLOR_DELAY...
 929:_options/writeColor.c **** 		// The last pixel is cut-short again, even *with* the delay
 930:_options/writeColor.c **** 		// Having a bit of difficulty wrapping my head around *why*
 931:_options/writeColor.c **** 		// since we're using writeColor, here, to set _W = WHITE
 932:_options/writeColor.c **** 		// Probably because _W is a constant, and therefore doesn't require
 933:_options/writeColor.c **** 		// loading from SRAM, extraction, etc...
 934:_options/writeColor.c **** 		//
 935:_options/writeColor.c **** 		// E.G.:
 936:_options/writeColor.c **** 		// calc set delay (csd)
 937:_options/writeColor.c **** 		//
 938:_options/writeColor.c **** 		//  c1  s1 d1  c2  s2 d2  c3  s3 d3 cW sW (dW = FALSE)
 939:_options/writeColor.c **** 		// |---|--#---|---|--#---|---|--#---|-|--#...
 940:_options/writeColor.c **** 		//        \---------/\---------/\-------/\---
 941:_options/writeColor.c **** 		//         Pixel 1    Pixel 2    Pixel 3   WHITE  ... visible "pixel"
 942:_options/writeColor.c **** 		//          11pix      11pix       9pix           ... screen pixels
 943:_options/writeColor.c **** 		//
 944:_options/writeColor.c **** 		// Not sure how to accomodate this... maybe just load _W in a sram
 945:_options/writeColor.c **** 		// location...?
 946:_options/writeColor.c ****       //Display the rest as black... (now white)
 947:_options/writeColor.c ****       //writeColor(FALSE,FALSE, _W);
 948:_options/writeColor.c **** 		//a/o v86: I can't recall why I chose white, maybe just for
 949:_options/writeColor.c **** 		//visibility...
 950:_options/writeColor.c **** 		//Since we're working with VISIBLE_ROW_DOTS in this version, and want
 951:_options/writeColor.c **** 		//the remaining dots to be black, we'll see where this goes...
 952:_options/writeColor.c **** #if(!defined(FRAMEBUFFER_TESTING) || !FRAMEBUFFER_TESTING)
 953:_options/writeColor.c ****  #error "nonRSB_drawPix now requires the row-buffer to be FB_WIDTH+1 long"
 954:_options/writeColor.c **** #endif
 955:_options/writeColor.c **** 		//This could probably be optimized a bit... maybe just using *one*
 956:_options/writeColor.c **** 		//SRAM location, instead of using one at the end of each row...
 957:_options/writeColor.c **** 		// but this should be pretty much guaranteed to be the same length
 958:_options/writeColor.c **** 		// since it uses the same convention.
 959:_options/writeColor.c **** 		// Looks close to right, but it could be an illusion ;)
 960:_options/writeColor.c **** 		writeColor(FALSE,FALSE, *(color+FB_WIDTH));
 961:_options/writeColor.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 148


 962:_options/writeColor.c **** 		//Do it as quickly as possible.
 963:_options/writeColor.c **** 		// (No, this cuts off the last pixel...)
 964:_options/writeColor.c **** 		//OCR1D = 0;	//Red Off
 965:_options/writeColor.c **** 		//DT1 = 0;		//Green Off
 966:_options/writeColor.c **** 		//OCR1A = 4;  //Blue Off
 967:_options/writeColor.c **** 
 968:_options/writeColor.c **** 		//writeColor(0xff);
 969:_options/writeColor.c ****         //delay_Dots(500);//142); //Don't want to disable DE too early...   
 970:_options/writeColor.c ****       //900 leaves a buffer for various calculations while also showing
 971:_options/writeColor.c ****       // a blue bar at the right-side...
 972:_options/writeColor.c ****       //LTN Last Used 900
 973:_options/writeColor.c ****       // -68 is from 900's intent, IIRC
 974:_options/writeColor.c ****       //  seems arbitrary, but its value (especially if too small)
 975:_options/writeColor.c ****       // causes blank lines... (?!)
 976:_options/writeColor.c ****       // -60 makes more sense for a delay (was the original post-900)
 977:_options/writeColor.c ****       //  (outside DOTS_TO_CYC because it's for cycles used for calcs...
 978:_options/writeColor.c ****       // -68 worked for LVDS_PRE=2
 979:_options/writeColor.c ****       // -60 for 1
 980:_options/writeColor.c ****       // 4 doesn't work... blue-lines
 981:_options/writeColor.c **** 
 982:_options/writeColor.c **** //a/o v60
 983:_options/writeColor.c **** //From Here Down, everything has only been tested recently with rowSegBuf
 984:_options/writeColor.c **** // I did a nice #if-#else scheme which makes this redundant
 985:_options/writeColor.c **** // with what's in rsb_drawPix()...
 986:_options/writeColor.c **** 
 987:_options/writeColor.c **** // a/o v59-12ish... ROW_COMPLETION_DELAY uses were already commented-out
 988:_options/writeColor.c **** // BUT WHY WAS IT REMOVED?! Seems to help, now.
 989:_options/writeColor.c **** // 
 990:_options/writeColor.c **** //   Some Experimenting has led to the conclusion:
 991:_options/writeColor.c **** //   DE's active-duration needn't be exact. In fact, it can be *way* off
 992:_options/writeColor.c **** //     White is shown between the end of drawSegs, and cyan is shown after
 993:_options/writeColor.c **** //   ROW_COMPLETION_DELAY (which, for now, is constant, regardless of how
 994:_options/writeColor.c **** //    many pixels were drawn)
 995:_options/writeColor.c **** //   Almost immediately after the ROW_COMPLETION_DELAY (when it turns cyan)
 996:_options/writeColor.c **** //    DE is disabled
 997:_options/writeColor.c **** //    Yet the remainder of the screen still fills with cyan.
 998:_options/writeColor.c **** //   THUS: Disabling DE before the end of the screen appears to have the
 999:_options/writeColor.c **** //    effect of either not being acknowledged, or of repeating the last
1000:_options/writeColor.c **** //    color (untested)
1001:_options/writeColor.c **** //   Also, DE durations that are *longer* than the screen, seem to be 
1002:_options/writeColor.c **** //    absorbed by nonexistent pixels to the left...
1003:_options/writeColor.c **** //    (setting ROW_COMPLETION_DELAY==65535 unreasonably high,
1004:_options/writeColor.c **** //         just shows white at the right side, and still syncs)
1005:_options/writeColor.c **** //   Now, the original problem was that there seemed to be some carry-over
1006:_options/writeColor.c **** //   which maybe due to DEs that are EXTRAORDINARILY long?
1007:_options/writeColor.c **** //   NO!
1008:_options/writeColor.c **** //   Actually, it appears to be due to DEs that are TOO SHORT (?)
1009:_options/writeColor.c **** //      (setting ROW_COMPLETION_DELAY to 0 causes the problem again)
1010:_options/writeColor.c **** //   Doesn't appear to be *entirely* scientific, as using SEG_SINE
1011:_options/writeColor.c **** //    would suggest that these (now cyan) bars would appear at the troughs
1012:_options/writeColor.c **** //    in the diagonal-color-stripes at the top...
1013:_options/writeColor.c **** //    they seem, instead to be somewhat random, though maybe more common
1014:_options/writeColor.c **** //      at those locations.
1015:_options/writeColor.c **** //   But Wait! Setting ROW_COMPLETION_DELAY to 1 fixes it again.
1016:_options/writeColor.c **** //    realistically, that should be nothing more than a single nop; no?
1017:_options/writeColor.c **** //    (Maybe not, with a few cycles to entry, and minimum execution times)
1018:_options/writeColor.c **** //    a handful of nops does the trick, as well.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 149


1019:_options/writeColor.c **** //    So is it a problem with too short a DE, or is it a matter of
1020:_options/writeColor.c **** //    e.g. the last segment drawn is setting new values that might only
1021:_options/writeColor.c **** //    be *completely transmitted* after a full PWM cycle...
1022:_options/writeColor.c **** //    So maybe somehow that last transaction is being interrupted
1023:_options/writeColor.c **** //     by the TCCR1A settings, or new values...
1024:_options/writeColor.c **** //    Plausible.
1025:_options/writeColor.c **** //
1026:_options/writeColor.c **** // FURTHER. Lest it be revisited. It was noted elsewhere that I thought
1027:_options/writeColor.c **** // this display was NOT DE-Only. In fact, the datasheet specifically says
1028:_options/writeColor.c **** // "DE-Only Mode"
1029:_options/writeColor.c **** 
1030:_options/writeColor.c **** 
1031:_options/writeColor.c **** 
1032:_options/writeColor.c **** 
1033:_options/writeColor.c **** /*#define ROW_COMPLETION_DELAY \
1034:_options/writeColor.c ****       (DOTS_TO_CYC(DE_ACTIVE_DOTS) -60  \
1035:_options/writeColor.c ****        - WRITE_COLOR_CYCS * COLORS_WRITTEN)
1036:_options/writeColor.c **** */
1037:_options/writeColor.c **** //I think -60 was an arbitrary value just chosen to compensate for
1038:_options/writeColor.c **** //calculations/instructions...
1039:_options/writeColor.c **** // -90 has been found to be right at the edge of the screen, now...
1040:_options/writeColor.c **** // ish. maybe it's not accurate since delay_loop_2 is four instructions per
1041:_options/writeColor.c **** // loop...?
1042:_options/writeColor.c **** #if (!defined(LCDINTERFACE_BITBANGED_DOTCLOCK) || \
1043:_options/writeColor.c **** 		!LCDINTERFACE_BITBANGED_DOTCLOCK)
1044:_options/writeColor.c ****  #define ROW_COMPLETION_DELAY \
1045:_options/writeColor.c ****       (DOTS_TO_CYC(DE_ACTIVE_DOTS) - 90  \
1046:_options/writeColor.c ****        - (WRITE_COLOR_CYCS + WRITE_COLOR_DELAY) * COLORS_WRITTEN)
1047:_options/writeColor.c **** //#define ROW_COMPLETION_DELAY 512 //1 //65535//512
1048:_options/writeColor.c **** 
1049:_options/writeColor.c **** 
1050:_options/writeColor.c **** 
1051:_options/writeColor.c **** 
1052:_options/writeColor.c **** //#error "should add SEG_STRETCH here..."
1053:_options/writeColor.c ****  #if (ROW_COMPLETION_DELAY > 0)
1054:_options/writeColor.c **** //      delay_cyc(DOTS_TO_CYC(DE_ACTIVE_DOTS) -60 // - 68)// - 60
1055:_options/writeColor.c **** //            - WRITE_COLOR_CYCS*COLORS_WRITTEN);
1056:_options/writeColor.c **** 		delay_cyc(ROW_COMPLETION_DELAY);
1057:_options/writeColor.c ****  #else
1058:_options/writeColor.c ****   #warning "ROW_COMPLETION_DELAY <= 0, so not used."
1059:_options/writeColor.c ****  #endif
1060:_options/writeColor.c **** #else //LCDINTERFACE_BITBANGED_DOTCLOCK (Bitbanged MCK, usually)
1061:_options/writeColor.c ****  #define ROW_COMPLETION_DOTS \
1062:_options/writeColor.c **** 		(DE_ACTIVE_DOTS - ((WRITE_COLOR_DOT_DELAY+1) * COLORS_WRITTEN))
1063:_options/writeColor.c **** 
1064:_options/writeColor.c ****  #if (ROW_COMPLETION_DOTS > 0)
1065:_options/writeColor.c **** 		delay_Dots(ROW_COMPLETION_DOTS);
 3038               		.stabn	68,0,1065,.LM337-.LFBB19
 3039               	.LM337:
 3040               	/* #APP */
 3041               	 ;  1065 "_options/writeColor.c" 1
 3042 0a22 0000      		nop;
 3043               	 ;  0 "" 2
 3044               	/* #NOAPP */
 3045 0a24 C398      		cbi 0x18,3
 3046               	/* #APP */
 3047               	 ;  1065 "_options/writeColor.c" 1
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 150


 3048 0a26 0000      		nop;
 3049               	 ;  0 "" 2
 3050               	/* #NOAPP */
 3051 0a28 C39A      		sbi 0x18,3
 3052 0a2a 0197      		sbiw r24,1
 3053 0a2c 0097      		sbiw r24,0
 3054 0a2e 01F4      		brne .L161
 3055               	.LBE287:
1066:_options/writeColor.c ****  #elif (ROW_COMPLETION_DOTS < 0)
1067:_options/writeColor.c ****   #warning "ROW_COMPLETION_DOTS < 0, so not used."
1068:_options/writeColor.c ****  #endif
1069:_options/writeColor.c **** #endif
1070:_options/writeColor.c **** 		//a/o v62: (Original notes removed)
1071:_options/writeColor.c **** 		//OCR1D controls RED... >=6 is full-red
1072:_options/writeColor.c **** 		// Setting this here indicates where the drawing has completed
1073:_options/writeColor.c **** 		// This is handy for determining timing, stretching, etc...
1074:_options/writeColor.c **** 		//OCR1D = 6; //0;
1075:_options/writeColor.c **** 		//fullRed();
1076:_options/writeColor.c **** 		// Now that we're using WHITE, use noRed instead
1077:_options/writeColor.c **** 		noRed();
 3056               		.stabn	68,0,1077,.LM338-.LFBB19
 3057               	.LM338:
 3058 0a30 8BB3      		in r24,0x1b
 3059 0a32 8C7F      		andi r24,lo8(-4)
 3060 0a34 8BBB      		out 0x1b,r24
1078:_options/writeColor.c **** 
1079:_options/writeColor.c ****       //DE->Nada transition expects fullBlue...
1080:_options/writeColor.c ****       //Also helps to show the edge of the DE timing...
1081:_options/writeColor.c **** 
1082:_options/writeColor.c ****       //!!! Not sure what the state is at this point...
1083:_options/writeColor.c ****       // could be any DE+Blue level, or could be NADA...
1084:_options/writeColor.c ****       // Nada: DT1=3, still leaves one bit for clocking, might be OK
1085:_options/writeColor.c ****          
1086:_options/writeColor.c ****       //Among the things that don't make sense...
1087:_options/writeColor.c ****       // This appears to go into affect BEFORE delay_cyc (?)
1088:_options/writeColor.c ****       // as, without a pull-up resistor on the /OC1B output, 
1089:_options/writeColor.c ****       // green seems to be floating between the last pixel and the
1090:_options/writeColor.c ****       // delay_cyc (!)
1091:_options/writeColor.c ****       //Disable complementary-output for Green 
1092:_options/writeColor.c ****       //  (on /OC1B, where CLK is OC1B)
1093:_options/writeColor.c ****       // Since Nada, V, and H DT's might be bad for clocking.
1094:_options/writeColor.c **** //		TCCR1A = ( (0<<COM1A1) | (1<<COM1A0)
1095:_options/writeColor.c **** //         | (1<<COM1B1) | (0<<COM1B0)
1096:_options/writeColor.c **** //         | (1<<PWM1A) | (1<<PWM1B) );
1097:_options/writeColor.c **** 
1098:_options/writeColor.c **** 		lvds_disableGreen_MakeClockInsensitiveToDT();
1099:_options/writeColor.c **** 
1100:_options/writeColor.c ****       //fullBlue();
1101:_options/writeColor.c ****       //Nada_fromDEonly();
1102:_options/writeColor.c **** 		Nada_init();
 3061               		.stabn	68,0,1102,.LM339-.LFBB19
 3062               	.LM339:
 3063 0a36 88B3      		in r24,0x18
 3064 0a38 8063      		ori r24,lo8(48)
 3065 0a3a 88BB      		out 0x18,r24
 3066 0a3c 8BB3      		in r24,0x1b
 3067 0a3e 8F7C      		andi r24,lo8(-49)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 151


 3068 0a40 8BBB      		out 0x1b,r24
 3069               	.L163:
 3070               	.LBE288:
 3071               	.LBE289:
 3072               	.LBE292:
 3073               		.stabs	"_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c",132,0,0,.Ltext22
 3074               	.Ltext22:
 3075               		.stabn	68,0,2047,.LM340-.LFBB19
 3076               	.LM340:
 3077 0a42 80E1      		ldi r24,lo8(16)
 3078 0a44 90E0      		ldi r25,0
 3079 0a46 00C0      		rjmp .L162
 3080               	.L178:
 3081 0a48 80EF      		ldi r24,lo8(-16)
 3082 0a4a 90E0      		ldi r25,0
 3083               	.L164:
 3084               	.LBB293:
2048:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****    {
2049:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//No DE_fromNada() in here, either...
2050:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		drawPix(rowNum);
2051:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//#error "No Nada here?!"
2052:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Apparently it's in the drawPix functions themselves!
2053:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// Don't forget it if implementing your own!
2054:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	}
2055:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if ( (defined(LCDSTUFF_NOT_IN_TIMER) && LCDSTUFF_NOT_IN_TIMER) \
2056:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		|| (defined(LCDSTUFF_INCLUDE_NON_DE) && LCDSTUFF_INCLUDE_NON_DE) )
2057:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	else //Not DE (e.g. Vsync, etc)
2058:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	{
2059:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Need to load the timing info anyhow...
2060:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// undrawn rows are supposed to be the same number of pixel clocks
2061:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// (Though, that's probably not necessary, judging by the flexibility
2062:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//  this display has demonstrated with LVDSdirect...)
2063:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//delay_Dots(DE_ACTIVE_DOTS);
2064:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//a/o v0.80: trying to figure out why DE_DotDelay() is necessary
2065:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//rather than just using delay_Dots()
2066:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// sdramThing3.0 uses write_Dots(), but writeDots has an argument
2067:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// which takes into account the current mode, in order to position
2068:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// the dots in memory properly...
2069:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// So, delay_Dots() (if it even exists in sdramThing?) wouldn't work,
2070:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// because it wouldn't take into account page-boundaries, etc.
2071:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		
2072:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// DE_DotDelay() Does NOT change the current *mode* (e.g. hsync/vsync
2073:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// /DE/Nada...)
2074:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		DE_DotDelay(DE_ACTIVE_DOTS);
 3085               		.stabn	68,0,2074,.LM341-.LFBB19
 3086               	.LM341:
 3087               	/* #APP */
 3088               	 ;  2074 "_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c" 1
 3089 0a4c 0000      		nop;
 3090               	 ;  0 "" 2
 3091               	/* #NOAPP */
 3092 0a4e C398      		cbi 0x18,3
 3093               	/* #APP */
 3094               	 ;  2074 "_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c" 1
 3095 0a50 0000      		nop;
 3096               	 ;  0 "" 2
 3097               	/* #NOAPP */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 152


 3098 0a52 C39A      		sbi 0x18,3
 3099 0a54 0197      		sbiw r24,1
 3100 0a56 0097      		sbiw r24,0
 3101 0a58 01F4      		brne .L164
 3102 0a5a 00C0      		rjmp .L163
 3103               	.L162:
 3104               	.LBE293:
 3105               	.LBB294:
2075:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2076:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  //This test in order to keep compatibility with the old method, which
2077:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  //isn't right (see notes) But worked. (DE-Only display...)
2078:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  // This whole section should be eliminated, until the else-case
2079:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #if (!defined(LCDSTUFF_INCLUDE_NON_DE) || !LCDSTUFF_INCLUDE_NON_DE)
2080:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//a/o v0.80: This probably isn't even necessary... Besides being
2081:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//WRONG.
2082:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2083:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Well, the output data might not necessarily have been /blue/
2084:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// but at least with the sdramThing2.0's Nada_fromDEblue() method
2085:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// this should be fine (if not a tad overkill)
2086:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		Nada_fromDEblue();
2087:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Nada_init();
2088:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Actually, shouldn't it already be Nada, from before?
2089:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// Wait a minute, none of this is right... right?
2090:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		// Shouldn't Vsync be active still?
2091:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #else //LCDSTUF_INCLUDE_NON_DE (e.g. LCDdirectLVDSv81 with parallel LCD
2092:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//The mode should be correct after exitting the vsync tests and
2093:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//handling hsync, so there should be no need to do this:
2094:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//if(vsync)
2095:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//	Vsync_from
2096:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****  #endif
2097:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	}
2098:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
2099:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//For writing to SDRAM, etc... (not usging timer)
2100:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// DISPLAY_DOT_COUNT is the total number of dots per row
2101:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// (in LVDSdirect, calculations would also occur after this...
2102:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//  but that's not relevent here, now...)
2103:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// DISPLAY_DOT_COUNT = (H_LOW_DOTS + HD_DOTS + DE_ACTIVE_DOTS + DH_DOTS)
2104:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// H_LOW_DOTS was handled earlier via Hlow_delay()
2105:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// HD_DOTS via HD_Delay()
2106:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// DE_ACTIVE_DOTS in if (and else) above...
2107:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// DH_DOTS was the down-time between timer-interrupts
2108:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// But since we're not using timer interrupts, they need to be handled
2109:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// explicitly...
2110:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// (Note that with Timer Interrupts, and more importantly PWM-driving, 
2111:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//  timing wasn't nearly so precise:
2112:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//   calculation-time, etc, affected the number of cycles until the next
2113:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//   delay, etc... e.g. Interrupt occurs, if/else for Vsync/Hsync
2114:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//   So the actual Hsync/Vsync signals wouldn't be sent until the if
2115:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//   statements were processed...
2116:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//  If anything, this should show that the display is a lot less 
2117:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//   sensitive to exact/stable timing than this method will provide
2118:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//   However, it might mean that some delays might need to be increased)
2119:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	// Actually: After loadData was run, the timer interrupt would load
2120:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//  the next mode, as appropriate, which would take effect immediately
2121:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//  e.g. loadData -> Vsync_fromNada();
2122:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//  So then, DH_DOTS would actually occur *after* Vsync_fromNada()
2123:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//   meaning Vsync would be active during that time...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 153


2124:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//   But, these sorts of things (in the switch statement) only occur
2125:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//   on non-drawing-lines right? More cause to believe the timing isn't
2126:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//   excruciatingly sensitive...
2127:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//   (Those cases occurred *without* DE-timing-mimicking implemented
2128:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//    in this #if... so ... there.)
2129:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	
2130:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	//delay_Dots(DH_DOTS);
2131:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #ifdef DH_Delay
2132:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	DH_Delay();
2133:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c ****   #else
2134:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	delay_Dots(DH_DOTS);
 3106               		.stabn	68,0,2134,.LM342-.LFBB19
 3107               	.LM342:
 3108               	/* #APP */
 3109               	 ;  2134 "_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c" 1
 3110 0a5c 0000      		nop;
 3111               	 ;  0 "" 2
 3112               	/* #NOAPP */
 3113 0a5e C398      		cbi 0x18,3
 3114               	/* #APP */
 3115               	 ;  2134 "_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c" 1
 3116 0a60 0000      		nop;
 3117               	 ;  0 "" 2
 3118               	/* #NOAPP */
 3119 0a62 C39A      		sbi 0x18,3
 3120 0a64 0197      		sbiw r24,1
 3121 0a66 0097      		sbiw r24,0
 3122 0a68 01F4      		brne .L162
 3123               	.LBE294:
 3124               	.LBE229:
 3125               	.LBE228:
1345:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 3126               		.stabn	68,0,1345,.LM343-.LFBB19
 3127               	.LM343:
 3128 0a6a 2091 0000 		lds r18,hsyncCount
 3129 0a6e 3091 0000 		lds r19,hsyncCount+1
 3130 0a72 2F5F      		subi r18,-1
 3131 0a74 3F4F      		sbci r19,-1
 3132 0a76 3093 0000 		sts hsyncCount+1,r19
 3133 0a7a 2093 0000 		sts hsyncCount,r18
1347:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	{
 3134               		.stabn	68,0,1347,.LM344-.LFBB19
 3135               	.LM344:
 3136 0a7e 2432      		cpi r18,36
 3137 0a80 3105      		cpc r19,__zero_reg__
 3138 0a82 01F0      		breq .L167
 3139 0a84 00F4      		brsh .L168
 3140 0a86 2431      		cpi r18,20
 3141 0a88 3105      		cpc r19,__zero_reg__
 3142 0a8a 01F4      		brne .L166
1353:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			//clrpinPORT(VSYNC_PIN, VSYNC_PORT);
 3143               		.stabn	68,0,1353,.LM345-.LFBB19
 3144               	.LM345:
 3145 0a8c 1092 0000 		sts dataEnable,__zero_reg__
1355:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			Vsync_fromNada();
 3146               		.stabn	68,0,1355,.LM346-.LFBB19
 3147               	.LM346:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 154


 3148 0a90 81E0      		ldi r24,lo8(1)
 3149 0a92 8093 0000 		sts vSync,r24
1356:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			break;
 3150               		.stabn	68,0,1356,.LM347-.LFBB19
 3151               	.LM347:
 3152 0a96 C598      		cbi 0x18,5
1357:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Vsync L->H (Begin V Back Porch)
 3153               		.stabn	68,0,1357,.LM348-.LFBB19
 3154               	.LM348:
 3155 0a98 00C0      		rjmp .L166
 3156               	.L168:
1347:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 	{
 3157               		.stabn	68,0,1347,.LM349-.LFBB19
 3158               	.LM349:
 3159 0a9a 2832      		cpi r18,40
 3160 0a9c 3105      		cpc r19,__zero_reg__
 3161 0a9e 01F0      		breq .L170
 3162 0aa0 283C      		cpi r18,-56
 3163 0aa2 3105      		cpc r19,__zero_reg__
 3164 0aa4 01F4      		brne .L166
1375:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//	break;
 3165               		.stabn	68,0,1375,.LM350-.LFBB19
 3166               	.LM350:
 3167 0aa6 1092 0000 		sts dataEnable,__zero_reg__
1380:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** #if 0 //(FRAME_COUNT_TO_DELAY != 0)
 3168               		.stabn	68,0,1380,.LM351-.LFBB19
 3169               	.LM351:
 3170 0aaa 1092 0000 		sts hsyncCount+1,__zero_reg__
 3171 0aae 1092 0000 		sts hsyncCount,__zero_reg__
1395:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			break;
 3172               		.stabn	68,0,1395,.LM352-.LFBB19
 3173               	.LM352:
 3174 0ab2 CFEF      		ldi r28,lo8(-1)
 3175 0ab4 DFE7      		ldi r29,lo8(127)
1396:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		default:
 3176               		.stabn	68,0,1396,.LM353-.LFBB19
 3177               	.LM353:
 3178 0ab6 00C0      		rjmp .L166
 3179               	.L167:
1365:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			Nada_fromVsync();
 3180               		.stabn	68,0,1365,.LM354-.LFBB19
 3181               	.LM354:
 3182 0ab8 1092 0000 		sts vSync,__zero_reg__
1366:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			break;
 3183               		.stabn	68,0,1366,.LM355-.LFBB19
 3184               	.LM355:
 3185 0abc C59A      		sbi 0x18,5
1367:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 		//Start of frame (DE active)
 3186               		.stabn	68,0,1367,.LM356-.LFBB19
 3187               	.LM356:
 3188 0abe 00C0      		rjmp .L166
 3189               	.L170:
1370:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 			break;
 3190               		.stabn	68,0,1370,.LM357-.LFBB19
 3191               	.LM357:
 3192 0ac0 81E0      		ldi r24,lo8(1)
 3193 0ac2 8093 0000 		sts dataEnable,r24
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 155


 3194               	.L166:
1426:_commonCode_localized/lcdStuff/0.80ncf/lcdStuff.c **** 
 3195               		.stabn	68,0,1426,.LM358-.LFBB19
 3196               	.LM358:
 3197 0ac6 CE01      		movw r24,r28
 3198               	/* epilogue start */
 3199 0ac8 DF91      		pop r29
 3200 0aca CF91      		pop r28
 3201 0acc 0895      		ret
 3202               		.size	lcd_update, .-lcd_update
 3203               		.stabs	"rowNum:r(4,3)",64,0,1325,28
 3204               		.stabn	192,0,0,.LFBB19-.LFBB19
 3205               		.stabs	"color:r(0,49)",64,0,743,30
 3206               		.stabn	192,0,0,.LBB236-.LFBB19
 3207               		.stabn	224,0,0,.LBE236-.LFBB19
 3208               		.stabs	"color:r(0,49)",64,0,743,30
 3209               		.stabn	192,0,0,.LBB288-.LFBB19
 3210               		.stabn	224,0,0,.LBE288-.LFBB19
 3211               		.stabn	224,0,0,.Lscope19-.LFBB19
 3212               	.Lscope19:
 3213               		.stabs	"",36,0,0,.Lscope19-.LFBB19
 3214               		.stabd	78,0,0
 3215               		.stabs	"restartFrameUpdate:F(0,47)",36,0,406,restartFrameUpdate
 3216               	.global	restartFrameUpdate
 3217               		.type	restartFrameUpdate, @function
 3218               	restartFrameUpdate:
 3219               		.stabd	46,0,0
 3220               		.stabs	"main.c",132,0,0,.Ltext23
 3221               	.Ltext23:
   1:main.c        **** /* mehPL:
   2:main.c        ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:main.c        ****  *    I'm not too fond of long licenses at the top of the file.
   4:main.c        ****  *    Please see the bottom.
   5:main.c        ****  *    Enjoy!
   6:main.c        ****  */
   7:main.c        **** 
   8:main.c        **** 
   9:main.c        **** 
  10:main.c        **** 
  11:main.c        **** 
  12:main.c        **** 
  13:main.c        **** // Please see mainConfig.h!
  14:main.c        **** 
  15:main.c        **** 
  16:main.c        **** //The order of these #includes is *very specific*
  17:main.c        **** // please see the associated files (especially lcdStuff, lcdDefines, and
  18:main.c        **** // lvds)
  19:main.c        **** 
  20:main.c        **** 
  21:main.c        **** //This file contains code for *many* options, chosen by mainConfig.h
  22:main.c        **** // (and possibly makefile)
  23:main.c        **** 
  24:main.c        **** 
  25:main.c        **** 
  26:main.c        **** #include "projInfo.h"   //Don't include in main.h 'cause that's included in other .c's?
  27:main.c        **** #include "main.h"
  28:main.c        **** #include <util/delay.h> //For delay_us in pll_enable
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 156


  29:main.c        **** #include <avr/pgmspace.h>
  30:main.c        **** #include _TIMERCOMMON_HEADER_
  31:main.c        **** //#include "../../../_commonCode/charBitmap/0.10/charBitmap.h"
  32:main.c        **** #include "fbColors.h"
  33:main.c        **** 
  34:main.c        **** 
  35:main.c        **** 
  36:main.c        **** 
  37:main.c        **** 
  38:main.c        **** #include "mainConfig.h"
  39:main.c        **** 
  40:main.c        **** 
  41:main.c        **** //This is hokey, just trying to free up space
  42:main.c        **** // Frankly, these should only be included as-needed
  43:main.c        **** #if (!defined(FB_QUESTION) || !FB_QUESTION)
  44:main.c        **** //These two saved 800Bytes
  45:main.c        **** // But that's probably just charBitmap, because sineTable is compiled via
  46:main.c        **** // the makefile.
  47:main.c        **** // Yeahp.
  48:main.c        **** #include _SINETABLE_HEADER_
  49:main.c        **** #include _CHARBITMAP_HEADER_
  50:main.c        **** #endif
  51:main.c        **** 
  52:main.c        **** 
  53:main.c        **** 
  54:main.c        **** #include "delay_cyc.h"
  55:main.c        **** 
  56:main.c        **** 
  57:main.c        **** //This should be handled in mainConfig, now...
  58:main.c        **** #if (!defined(FB_REFRESH_ON_CHANGE) || !FB_REFRESH_ON_CHANGE)
  59:main.c        ****  #define FB_REFRESH_ON_CHANGE_COUNT	TRUE
  60:main.c        **** #else
  61:main.c        ****  #ifndef FB_REFRESH_ON_CHANGE_COUNT
  62:main.c        ****   #define FB_REFRESH_ON_CHANGE_COUNT	5
  63:main.c        ****  #endif
  64:main.c        **** #endif
  65:main.c        **** 
  66:main.c        **** 
  67:main.c        **** 
  68:main.c        **** #if (defined(ROW_SEG_BUFFER) && ROW_SEG_BUFFER)
  69:main.c        **** 	 #include "rowSegBuffer.h"
  70:main.c        **** #endif
  71:main.c        **** 
  72:main.c        **** //a/o v70: this should be handled by writeColor.c now
  73:main.c        **** //Nope, can't be removed yet...
  74:main.c        **** //#define ROW_BUFFER FALSE
  75:main.c        **** //#define LOADROW TRUE
  76:main.c        **** //#if (defined(ROW_BUFFER) && ROW_BUFFER)
  77:main.c        **** //#error
  78:main.c        **** //#include "rowBuffer.c"
  79:main.c        **** //#endif
  80:main.c        **** 
  81:main.c        **** #if (defined(SEG_TET) && SEG_TET)
  82:main.c        ****  #include "_options/tetStuff.c"
  83:main.c        **** #endif
  84:main.c        **** 
  85:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 157


  86:main.c        **** #if (defined(BLUE_ADC) && BLUE_ADC)
  87:main.c        ****  #include _ADC_HEADER_
  88:main.c        **** #endif
  89:main.c        **** 
  90:main.c        **** #if (defined(PIEZO_HIT_DETECTION) && PIEZO_HIT_DETECTION)
  91:main.c        **** //#if (defined(FB_QUESTION) && FB_QUESTION)
  92:main.c        ****  #include _PIEZOHITDETECTOR_CFILE_
  93:main.c        **** #endif
  94:main.c        **** 
  95:main.c        **** #define OSCCAL_VAL	0xff//0xDB//0xDC//0xE0//0//0xff//0x20//0xff //0x00
  96:main.c        **** #include "delay_cyc.c"
  97:main.c        **** #include "lcdDefines.h"
  98:main.c        **** #include "pll.c"
  99:main.c        **** 
 100:main.c        **** 
 101:main.c        **** 
 102:main.c        **** 
 103:main.c        **** 
 104:main.c        **** #if(defined(FB_SMILEY) && FB_SMILEY)
 105:main.c        ****  #define FB_WIDTH 16
 106:main.c        ****  #define FB_HEIGHT 16
 107:main.c        **** #elif (defined(FB_QUESTION) && FB_QUESTION)
 108:main.c        ****  #define FB_WIDTH 16
 109:main.c        ****  #define FB_HEIGHT 16
 110:main.c        **** #elif (defined(FB_TETRIS) && FB_TETRIS)
 111:main.c        ****  #define FB_WIDTH	24
 112:main.c        ****  #define FB_HEIGHT 24
 113:main.c        **** #elif (defined(FB_HEXCOLOR) && FB_HEXCOLOR)
 114:main.c        ****  #define FB_WIDTH 16
 115:main.c        ****  #define FB_HEIGHT 16
 116:main.c        **** #endif
 117:main.c        **** 
 118:main.c        **** #if (defined(FB_QUESTION) && FB_QUESTION)
 119:main.c        ****  #if (defined(BUMP_SWITCH) && BUMP_SWITCH)
 120:main.c        ****   //#error "OK1"
 121:main.c        ****   #include "_hitSensors/bumpSwitch.c"
 122:main.c        ****  #endif
 123:main.c        **** #endif
 124:main.c        **** 
 125:main.c        **** #include _LCD_INTERFACE_CFILE_
 126:main.c        **** /*
 127:main.c        **** #if (defined(__AVR_AT90PWM161__))
 128:main.c        ****  #include "_interfaces/lvds161.c"
 129:main.c        **** #else
 130:main.c        ****  #include "_interfaces/lvds.c"
 131:main.c        **** #endif
 132:main.c        **** */
 133:main.c        **** 
 134:main.c        **** 
 135:main.c        **** #if(defined(FB_SMILEY) && FB_SMILEY)
 136:main.c        ****  #define fb_updater()	smileyUpdate()
 137:main.c        **** #elif (defined(FB_QUESTION) && FB_QUESTION)
 138:main.c        ****  #include "fb_question.h"
 139:main.c        ****  #define fb_updater()	fbQuestion_update()
 140:main.c        **** #elif (defined(FB_TETRIS) && FB_TETRIS)
 141:main.c        **** //These are just rough estimates...
 142:main.c        ****  #include "_options/tetStuff.c"
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 158


 143:main.c        ****  #define fb_updater()	tetUpdate()
 144:main.c        **** #elif (defined(FB_HEXCOLOR) && FB_HEXCOLOR)
 145:main.c        ****  #include "_options/hexColor.c"
 146:main.c        ****  #define fb_updater()	hexColor_update()
 147:main.c        **** #endif
 148:main.c        **** 
 149:main.c        **** uint8_t isNewFrame(void);
 150:main.c        **** 
 151:main.c        **** #if ( (defined(FRAMEBUFFER_TESTING) && FRAMEBUFFER_TESTING) || \
 152:main.c        **** 		(defined(ROWBUFFER_TESTING) && ROWBUFFER_TESTING) )
 153:main.c        ****  #include "_options/writeColor.c"
 154:main.c        **** #endif
 155:main.c        **** 
 156:main.c        **** #if (defined(FB_QUESTION) && FB_QUESTION)
 157:main.c        ****  #include "fb_question.c"
 158:main.c        **** #endif
 159:main.c        **** 
 160:main.c        **** // a/o v59:
 161:main.c        **** //PSEGS are the "pixel segments" addressable in RowSegmentBuffer
 162:main.c        **** // e.g. one could load a single row-segment NUM_PSEGS long, and it would 
 163:main.c        **** // reach from one edge of the screen to the other
 164:main.c        **** // or any number <=NUM_SEGMENTS of row segments whose lengths all add up to
 165:main.c        **** // <=NUM_PSEGS. (It's possible to extend beyond NUM_PSEGS, which would draw
 166:main.c        **** // beyond the edge of the screen, but it may affect the screen's ability 
 167:main.c        **** // to sync properly)
 168:main.c        **** // This value isn't exactly adjustable, it's a characteristic of the
 169:main.c        **** // ratio of the pixel-clock and the system-clock, along with the number of
 170:main.c        **** // system clock cycles used to draw each pixel.
 171:main.c        **** // This value was determined by experimentation with the very specific 
 172:main.c        **** // configuration currently in use, though it could probably be calculated 
 173:main.c        **** // from other #defines elsewhere.
 174:main.c        **** // (and probably *should* be, at some point, especially with 
 175:main.c        **** //  experimentations with PLLSYSCLK, LVDS_PRESCALER, SLOW_LVDS, etc...)
 176:main.c        **** // For now, changing this doesn't really do anything except scale some 
 177:main.c        **** // drawings horizontally (E.G. SEG_RACER)
 178:main.c        **** //These notes were determined long ago when developing SEG_RACER:
 179:main.c        **** // Wasn't sure where 357 came from... and now I'm wondering where the
 180:main.c        **** // notes I wrote regarding it disappeared to...
 181:main.c        **** // Anyhow, from line 72, if ROW_SEG_BUFFER && !LVDS_PRESCALER
 182:main.c        **** // "ROW_SEG_BUFFER uses 20cyc/pixel" (doesn't match the math I've 
 183:main.c        **** // elsewhere) 1024/20*7 = 358.4... so maybe that's something to do with it
 184:main.c        **** // TODO: If it was 21cyc/pixel, wouldn't we have perfect alignment with
 185:main.c        **** //       color-transitions and segment widths?
 186:main.c        **** //#define NUM_PSEGS	(1024/3+16) //357
 187:main.c        **** 
 188:main.c        **** #if (LVDS_PRESCALER == 1)
 189:main.c        ****  #warning "LVDS_PRESCALER == 1 is used extensively a/o v62 to indicate that	we're testing v62... th
 190:main.c        ****  //Let's see if this math can be figured out...
 191:main.c        ****  //
 192:main.c        ****  // Hah, right??? I completely forgot about SQUARE_SEGMENTS in all this
 193:main.c        ****  // Assuming they're always square, for now.
 194:main.c        ****  //
 195:main.c        ****  // H_PIXELS (DE_ACTIVE_DOTS)		1024             pixels
 196:main.c        ****  
 197:main.c        ****  // LVDS_PRESCALER					(1,2,4,8...)     pll_cyc/lvds_bit
 198:main.c        ****  //    PLLCYC_PER_LVDSBIT        LVDS_PRESCALER
 199:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 159


 200:main.c        ****  // LVDS_BITS_PER_PIXEL				7                lvds_bits/pixel
 201:main.c        ****  // PLL_SYSCLK
 202:main.c        ****  //    TRUE:  PLLCYC_PER_CPUCYC  4                pll_cyc/cpu_cyc
 203:main.c        ****  //    FALSE: PLLCYC_PER_CPUCYC  8                pll_cyc/cpu_cyc
 204:main.c        ****  // DRAWSEG_CPU_CYCS_PER_PSEG		20               cpu_cyc/pseg
 205:main.c        ****  //
 206:main.c        ****  // PIXELS_PER_PSEG = 1pseg * CPUCYCS_PER_PSEG   -> cpu_cycs
 207:main.c        ****  //                         * PLLCYC_PER_CPUCYC  -> pll_cycs
 208:main.c        ****  //                         / PLLCYC_PER_LVDSBIT -> lvds_bits
 209:main.c        ****  //                         / LVDSBITS_PER_PIXEL -> pixels
 210:main.c        ****  //   This is where dimensional-analysis always bites me in the ass...
 211:main.c        ****  //   my units are now PIXELS_PER_PSEG = pix/pseg = pix
 212:main.c        ****  //   I THINK (and this is an epiphany after years of recurring troubles
 213:main.c        ****  //   here) it's possible to, instead, note that 1pseg came from *nowhere*
 214:main.c        ****  //   so should be 1pseg/1pseg * <all the dimensional-analysis stuff>
 215:main.c        ****  //   Then:
 216:main.c        ****  //   (Note, in most cases PIXELS_PER_PSEG will be small, and here
 217:main.c        ****  //   fractions are highly important...)
 218:main.c        ****  #define CPUCYC_PER_PSEG	(DRAWSEG_CPU_CYCS_PER_PSEG)
 219:main.c        ****  #if(defined(PLL_SYSCLK) && PLL_SYSCLK)
 220:main.c        ****   #define PLLCYC_PER_CPUCYC	4
 221:main.c        ****  #else
 222:main.c        ****   #define PLLCYC_PER_CPUCYC	8
 223:main.c        ****  #endif
 224:main.c        ****  #define PLLCYC_PER_LVDSBIT	(LVDS_PRESCALER)
 225:main.c        ****  #define LVDSBITS_PER_PIXEL	7
 226:main.c        **** 
 227:main.c        ****  #define PIXELS_PER_PSEG_F ( MAKEFLOAT( CPUCYC_PER_PSEG   ) \
 228:main.c        **** 		 							* MAKEFLOAT( PLLCYC_PER_CPUCYC  ) \
 229:main.c        **** 		 							/ MAKEFLOAT( PLLCYC_PER_LVDSBIT ) \
 230:main.c        **** 		 							/ MAKEFLOAT( LVDSBITS_PER_PIXEL ) )
 231:main.c        ****  // NUM_PSEGS = H_PIXELS / PIXELS_PER_PSEG
 232:main.c        ****  #define NUM_PSEGS_F (MAKEFLOAT(DE_ACTIVE_DOTS) / PIXELS_PER_PSEG_F)
 233:main.c        ****  // And here, we're leaving NUM_PSEGS_F as a float so it can be used in 
 234:main.c        ****  // macro-comparisons, if necessary...
 235:main.c        ****  // (I don't think MAKELONG or any other such macro could handle this
 236:main.c        ****  // casting... it may be redundant since most uses would be assignments in
 237:main.c        ****  // integers, but if math is used, we don't want floating-point math to be
 238:main.c        ****  // run on it in real-time calculations...)
 239:main.c        ****  #define NUM_PSEGS ((uint16_t)(NUM_PSEGS_F))
 240:main.c        ****  // As a hand-job test: Using old values (when 357 was determined)
 241:main.c        ****  // DE_ACTIVE_DOTS = 1024
 242:main.c        ****  // CPUCYCS_PER_PSEG = 20
 243:main.c        ****  // PLLCYC_PER_CPUCYC = 8
 244:main.c        ****  // PLLCYC_PER_LVDSBIT =8
 245:main.c        ****  // LVDSBITS_PER_PIXEL =7
 246:main.c        ****  // 1024 / (20 * 8 / 8 / 7) = 358.4
 247:main.c        ****  // (The old NUM_PSEGS = 1024/3+16 = 357.333)
 248:main.c        ****  // (As an aside, if CPUCYCS_PER_PSEG = 21: 1024/(21*8/8/7)=341.333 
 249:main.c        ****  //    == exactly three pixels per pseg)
 250:main.c        **** #else
 251:main.c        ****  #warning "NUM_PSEGS is hardcoded, but should be calculated by many factors, such as LVDS_PRESCALER
 252:main.c        ****  #define NUM_PSEGS (1024/3+16)
 253:main.c        **** #endif
 254:main.c        **** 
 255:main.c        **** //Yes, I know #including C files is bad-practice...
 256:main.c        **** // and yes, this has to be here... for now.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 160


 257:main.c        **** #if(defined(SEG_RACER) && SEG_RACER)
 258:main.c        ****  #include "seg_racer.c"
 259:main.c        **** #endif
 260:main.c        **** 
 261:main.c        **** 
 262:main.c        **** 
 263:main.c        **** 
 264:main.c        **** 
 265:main.c        **** // a/o v60, this note is OLD, and actually is the whole point behind
 266:main.c        **** // ROW_SEG_BUFFER's current implementation.
 267:main.c        **** // TODO: Between OSCCAL_VAL and FRAME_UPDATE_DELAY
 268:main.c        **** //  it seems the speed (at least for the LTN) isn't so important after all
 269:main.c        **** //  This could be used to my advantage...
 270:main.c        **** //  Maybe bump OSCCAL_VAL all the way up, but use a slower "bit-rate"
 271:main.c        **** //  Thus, pixels could be skinnier, thus higher-resolution.
 272:main.c        **** //   Or more instructions could be used for the same resolution
 273:main.c        **** //   allowing, e.g. sprites from program-memory, without necessitating a
 274:main.c        **** //   large (or any?) frame-buffer...
 275:main.c        **** 
 276:main.c        **** 
 277:main.c        **** //This used to be handled by TOOFAST_TEST, but now can be configured here
 278:main.c        **** // 0xff sets the processor to run as fast as possible 
 279:main.c        **** //  (~16MHz? ~128MHz bit-rate)
 280:main.c        **** // 0x00 sets it as slow as possible (~4MHz, ~32MHz bit-rate)
 281:main.c        **** //  good for testing whether odd colors
 282:main.c        **** //  or bad syncing is due to bits being shifted, etc. 
 283:main.c        **** //  Maybe due to slow "LVDS" conversion chips, or whatnot.
 284:main.c        **** //   This seems to be the case right now... 0xff: black is appearing green
 285:main.c        **** //   There should be *some* green in it, but not this much.
 286:main.c        **** //   Likely due to different propagation delays between my under-driven
 287:main.c        **** //    74LS86's (running red and green), from 3.3V!
 288:main.c        **** //    and the happier and newer 74AHC XOR and OR currently driving the
 289:main.c        **** //    clock and DVH/Blue signals
 290:main.c        **** //  Highly dependent on the screen itself, some may not run at all with
 291:main.c        **** //  such slow bitrates... heck, some may not run at all even at the fastest
 292:main.c        **** // If SLOW_EVERYTHING_TEST is true, this value is overridden
 293:main.c        **** // LTN last used 0x20
 294:main.c        **** // a/o v59:
 295:main.c        **** // 0xD8 is the lowest value that syncs reliably, a few glitches from time
 296:main.c        **** // to time.
 297:main.c        **** // The effect of lower values isn't *quite* what I was expecting, but
 298:main.c        **** // definitely suggests that using ROW_SEG_BUFFER at this bit/refresh-rate
 299:main.c        **** // is dang-near right at the minimum required for this display.
 300:main.c        **** // This might be why the other (same model) display didn't work, but its
 301:main.c        **** // flakeyness at 0xff appeared different than this one's at lower OSCCALs
 302:main.c        **** // --Later note... actually retrying the "flakey" display with the same
 303:main.c        **** //   configuration. Actually, yes, the problem looks dang-near identical to
 304:main.c        **** //   the "reliable" display's being run at OSCCAL_VALs lower than 0xD8
 305:main.c        **** //   Both displays are of the same manufacturer/model.
 306:main.c        **** //    "reliable" has the chip: LXD91810 VS252AG
 307:main.c        **** //    "flakey"   has the chip: LXD91810 VS242AC
 308:main.c        **** //   The only bit I don't get is that I'm dang-near certain I had both
 309:main.c        **** //   displays working at one point, and from the same code...
 310:main.c        **** //   but this OSCCAL value is the maximum, and the only other way to speed
 311:main.c        **** //   up the bit-rate changes the resolution; which I haven't done
 312:main.c        **** //   for quite some time.
 313:main.c        **** //   Also different about this test than when I originally determined it
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 161


 314:main.c        **** //   "flakey": I've since switched the 74LS00 and LS32 out for LS86's
 315:main.c        **** //   (These are wired such that one chip is responsible for the + side of
 316:main.c        **** //    every LVDS signal, and one chip is responsible for the - side.
 317:main.c        **** //    The best-practice, probably, would be to have the + and - sides of
 318:main.c        **** //    an LVDS signal on the same chip. It's also plausible that my test was
 319:main.c        **** //    so long ago that it was on the old board which had this configuration
 320:main.c        **** //    but I doubt that, since that board was so hokily-implemented (with
 321:main.c        **** //    chip-clips and grabbers all over the place) that I can't imagine it
 322:main.c        **** //    was ever running again after all those months of disuse. Though...
 323:main.c        **** //    if that *was* the case... it could also be that I'm using a different
 324:main.c        **** //    ATtiny861... in which case, maybe the RC oscillator and/or PLL aren't
 325:main.c        **** //    capable of running as fast... 
 326:main.c        **** //    Not that I have a ton of these things lying around (three total, in
 327:main.c        **** //    various projects already)
 328:main.c        **** //    BUT the end-result may be that I just happen to have the one display
 329:main.c        **** //    and ATtiny861 on the planet that will work together. That'd be lame.)
 330:main.c        **** //#define OSCCAL_VAL	0xff//0xDB//0xDC//0xE0//0//0xff//0x20//0xff //0x00
 331:main.c        **** //This has been moved to the top...
 332:main.c        **** 
 333:main.c        **** 
 334:main.c        **** 
 335:main.c        **** 
 336:main.c        **** //a/o v60: These are old experiments...
 337:main.c        **** // they *are useful* for testing new displays...
 338:main.c        **** // but I can't recall off-hand how to use them instead of (or with?)
 339:main.c        **** // rowSegBuffer...
 340:main.c        **** // They're defined and better-described in lcdStuff.c...
 341:main.c        **** //These three are mutually-exclusive (BLUE_VERT_BAR overrides DE_BLUE)
 342:main.c        **** // (BLUE_DIAG_BAR overrides both...)
 343:main.c        **** //#define BLUE_DIAG_BAR TRUE
 344:main.c        **** //A single black bar, followed by a single blue bar... ~1/3 and 2/3's width
 345:main.c        **** //#define BLUE_VERT_BAR TRUE
 346:main.c        **** //#define DE_BLUE TRUE
 347:main.c        **** // OLD NOTE:
 348:main.c        **** // NONE SELECTED DOESN'T SYNC!!! DE not detected???
 349:main.c        **** 
 350:main.c        **** 
 351:main.c        **** 
 352:main.c        **** // Default is drawPix, from program memory...
 353:main.c        **** // a/o v60: drawPix() has since become the de-facto function for drawing
 354:main.c        **** // a row of pixels, regardless of the method.
 355:main.c        **** // It's defined as necessary...
 356:main.c        **** 
 357:main.c        **** 
 358:main.c        **** 
 359:main.c        **** //This is where COLOR_BAR_SCROLL and PIXEL_SCROLL were, in part.
 360:main.c        **** 
 361:main.c        **** 
 362:main.c        **** 
 363:main.c        **** 
 364:main.c        **** 
 365:main.c        **** 
 366:main.c        **** //#include "lvds.c"
 367:main.c        **** 
 368:main.c        **** 
 369:main.c        **** 
 370:main.c        **** #if(defined(LOADROW) && LOADROW)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 162


 371:main.c        **** static __inline__ \
 372:main.c        **** void loadRow(uint16_t rowNum) \
 373:main.c        **** 	__attribute__((__always_inline__));
 374:main.c        **** #endif
 375:main.c        **** 
 376:main.c        **** #if(defined(PARTIAL_REFRESH) && PARTIAL_REFRESH)
 377:main.c        **** #define FULL_REFRESH	UINT16_MAX
 378:main.c        **** uint16_t stopRefreshAtRow = FULL_REFRESH;
 379:main.c        **** #endif
 380:main.c        **** 
 381:main.c        **** //The endOfFrameHandler() function might e.g. cause the timer-interrupt to
 382:main.c        **** //be disabled until it's time to redraw a new frame
 383:main.c        **** // Since we're working with TFT displays, there is inherent "memory" of the
 384:main.c        **** // last-written frame, so we needn't refresh at the maximum rate possible
 385:main.c        **** // For some displays (e.g. the LTN) the act of refreshing is visible, so
 386:main.c        **** // unless the image changes (or the pixels have faded) it would be best
 387:main.c        **** // *not* to refresh
 388:main.c        **** static __inline__
 389:main.c        **** void endOfFrameHandler(void)
 390:main.c        **** 	__attribute__((__always_inline__));
 391:main.c        **** 
 392:main.c        **** #if(!defined(PWM_TESTING) || !PWM_TESTING)
 393:main.c        ****  #include _LCDSTUFF_CFILE_
 394:main.c        ****  //#include "../../../_commonCode/lcdStuff/0.50ncf/lcdStuff.c"
 395:main.c        **** 
 396:main.c        **** 	//If REFRESH_ON_CHANGE != TRUE, then FB_REFRESH_ON_CHANGE_COUNT = TRUE
 397:main.c        **** 	// and goes unchanged...
 398:main.c        **** 
 399:main.c        **** 	//updateFrame is decremented in main.c each time the frame is completed
 400:main.c        **** 	// it's reset to FB_REFRESH_ON_CHANGE in _options/frameBuffer.c
 401:main.c        **** 	// (via restartFrameUpdate())
 402:main.c        ****  volatile uint8_t updateFrame = FB_REFRESH_ON_CHANGE_COUNT; //TRUE;
 403:main.c        ****  volatile uint8_t frameCount = 0;
 404:main.c        **** 
 405:main.c        **** 
 406:main.c        ****  void restartFrameUpdate(void)
 407:main.c        ****  {
 3222               		.stabn	68,0,407,.LM359-.LFBB20
 3223               	.LM359:
 3224               	.LFBB20:
 3225               	/* prologue: function */
 3226               	/* frame size = 0 */
 3227               	/* stack size = 0 */
 3228               	.L__stack_usage = 0
 408:main.c        **** 	updateFrame = FB_REFRESH_ON_CHANGE_COUNT;
 3229               		.stabn	68,0,408,.LM360-.LFBB20
 3230               	.LM360:
 3231 0ace 81E0      		ldi r24,lo8(1)
 3232 0ad0 8093 0000 		sts updateFrame,r24
 3233               	.LBB295:
 3234               	.LBB296:
 3235               		.stabs	"./_interfaces/6bitParallel.c",132,0,0,.Ltext24
 3236               	.Ltext24:
 311:./_interfaces/6bitParallel.c **** 
 3237               		.stabn	68,0,311,.LM361-.LFBB20
 3238               	.LM361:
 3239 0ad4 93E0      		ldi r25,lo8(3)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 163


 3240 0ad6 9BBD      		out 0x2b,r25
 321:./_interfaces/6bitParallel.c **** 
 3241               		.stabn	68,0,321,.LM362-.LFBB20
 3242               	.LM362:
 3243 0ad8 8CBD      		out 0x2c,r24
 324:./_interfaces/6bitParallel.c **** 			            ((1<<CS13) | (1<<CS12) | (1<<CS11) | (1<<CS10)),
 3244               		.stabn	68,0,324,.LM363-.LFBB20
 3245               	.LM363:
 3246 0ada 8FB5      		in r24,0x2f
 3247 0adc 807F      		andi r24,lo8(-16)
 3248 0ade 8160      		ori r24,lo8(1)
 3249 0ae0 8FBD      		out 0x2f,r24
 330:./_interfaces/6bitParallel.c **** 			            ((1<<DTPS11) | (1<<DTPS10)),
 3250               		.stabn	68,0,330,.LM364-.LFBB20
 3251               	.LM364:
 3252 0ae2 8FB5      		in r24,0x2f
 3253 0ae4 8F7C      		andi r24,lo8(-49)
 3254 0ae6 8FBD      		out 0x2f,r24
 335:./_interfaces/6bitParallel.c **** 	            ((1<<WGM11) | (1<<WGM10)), // (affects all PWM channels)
 3255               		.stabn	68,0,335,.LM365-.LFBB20
 3256               	.LM365:
 3257 0ae8 86B5      		in r24,0x26
 3258 0aea 8C7F      		andi r24,lo8(-4)
 3259 0aec 86BD      		out 0x26,r24
 341:./_interfaces/6bitParallel.c **** 					(1<<COM1B1) | (1<<COM1B0),
 3260               		.stabn	68,0,341,.LM366-.LFBB20
 3261               	.LM366:
 3262 0aee 80B7      		in r24,0x30
 3263 0af0 8F7C      		andi r24,lo8(-49)
 3264 0af2 80BF      		out 0x30,r24
 346:./_interfaces/6bitParallel.c **** 
 3265               		.stabn	68,0,346,.LM367-.LFBB20
 3266               	.LM367:
 3267 0af4 80B7      		in r24,0x30
 3268 0af6 8E7F      		andi r24,lo8(-2)
 3269 0af8 80BF      		out 0x30,r24
 3270 0afa 0895      		ret
 3271               	.LBE296:
 3272               	.LBE295:
 3273               		.size	restartFrameUpdate, .-restartFrameUpdate
 3274               	.Lscope20:
 3275               		.stabs	"",36,0,0,.Lscope20-.LFBB20
 3276               		.stabd	78,0,0
 3277               		.stabs	"frameBufferUpdate:F(0,47)",36,0,223,frameBufferUpdate
 3278               	.global	frameBufferUpdate
 3279               		.type	frameBufferUpdate, @function
 3280               	frameBufferUpdate:
 3281               		.stabd	46,0,0
 3282               		.stabs	"./_options/frameBuffer.c",132,0,0,.Ltext25
 3283               	.Ltext25:
 143:./_options/frameBuffer.c **** 
 144:./_options/frameBuffer.c **** 
 145:./_options/frameBuffer.c **** //#include "_options/smiley.c"
 146:./_options/frameBuffer.c **** 
 147:./_options/frameBuffer.c **** 
 148:./_options/frameBuffer.c **** static __inline__
 149:./_options/frameBuffer.c **** void frameBufferChange(uint8_t *bufferChanged, 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 164


 150:./_options/frameBuffer.c **** 							uint8_t row, uint8_t col, uint8_t color)
 151:./_options/frameBuffer.c **** 	__attribute__((__always_inline__));
 152:./_options/frameBuffer.c **** 
 153:./_options/frameBuffer.c **** 
 154:./_options/frameBuffer.c **** //This isn't especially necessary to write to the frameBuffer
 155:./_options/frameBuffer.c **** // ...since it's global, it could be done directly
 156:./_options/frameBuffer.c **** // but this allows for testing whether a change occurs
 157:./_options/frameBuffer.c **** // in case it's desired to only refresh when that happens.
 158:./_options/frameBuffer.c **** //Since it's always-inline, it should optimize-out a few things, e.g. the
 159:./_options/frameBuffer.c **** //NULL-test, and even the write to bufferChanged, if it is null.
 160:./_options/frameBuffer.c **** // so it should be pretty quick.
 161:./_options/frameBuffer.c **** // It does NOT have a return-value, instead it only modifies bufferChanged
 162:./_options/frameBuffer.c **** // IF there is a change, so e.g. it could be run in a for-loop
 163:./_options/frameBuffer.c **** // and the end-value of bufferChanged will either be FALSE if no change, or
 164:./_options/frameBuffer.c **** // TRUE if there was a change in any of the loops.
 165:./_options/frameBuffer.c **** void frameBufferChange(uint8_t *bufferChanged, 
 166:./_options/frameBuffer.c **** 							uint8_t row, uint8_t col, uint8_t color)
 167:./_options/frameBuffer.c **** {
 168:./_options/frameBuffer.c **** 	if(frameBuffer[(row)][(col)] != (color))
 169:./_options/frameBuffer.c **** 	{
 170:./_options/frameBuffer.c **** 		frameBuffer[(row)][(col)] = (color);
 171:./_options/frameBuffer.c **** 		
 172:./_options/frameBuffer.c **** 		if(bufferChanged != NULL)
 173:./_options/frameBuffer.c **** 			*bufferChanged = TRUE;
 174:./_options/frameBuffer.c **** 	}
 175:./_options/frameBuffer.c **** }
 176:./_options/frameBuffer.c **** 
 177:./_options/frameBuffer.c **** #define frameBufferSet(row, col, color) \
 178:./_options/frameBuffer.c **** 				frameBufferChange(NULL, (row), (col), (color))
 179:./_options/frameBuffer.c **** 
 180:./_options/frameBuffer.c **** 
 181:./_options/frameBuffer.c **** #if(defined(FB_SMILEY) && FB_SMILEY)
 182:./_options/frameBuffer.c **** #include "_options/smiley.c"
 183:./_options/frameBuffer.c **** #endif
 184:./_options/frameBuffer.c **** 
 185:./_options/frameBuffer.c **** 
 186:./_options/frameBuffer.c **** 
 187:./_options/frameBuffer.c ****  #if(defined(FB_REFRESH_ON_CHANGE) && FB_REFRESH_ON_CHANGE)
 188:./_options/frameBuffer.c **** //This is sorta handled in heartbeat... and maybe it'd make sense to use
 189:./_options/frameBuffer.c **** //its timer-stuff instead, in a general sense... something to consider
 190:./_options/frameBuffer.c **** #if(defined(_HEART_DMS_) && _HEART_DMS_)
 191:./_options/frameBuffer.c ****  #define fb_timer_t			dms4day_t
 192:./_options/frameBuffer.c ****  #define fb_getTime()		dmsGetTime()
 193:./_options/frameBuffer.c ****  #define fb_isItTime(a,b)	dmsIsItTimeV2((a),(b),FALSE)
 194:./_options/frameBuffer.c **** #elif(defined(_HEART_TCNTER_) && _HEART_TCNTER_)
 195:./_options/frameBuffer.c ****  #define fb_timer_t			myTcnter_t
 196:./_options/frameBuffer.c ****  #define fb_getTime()		tcnter_get()
 197:./_options/frameBuffer.c ****  #define fb_isItTime(a,b)	tcnter_isItTimeV2((a),(b),FALSE)
 198:./_options/frameBuffer.c **** #else
 199:./_options/frameBuffer.c **** #error "Need timer-functions for REFRESH_ON_CHANGE"
 200:./_options/frameBuffer.c **** #endif
 201:./_options/frameBuffer.c **** #endif
 202:./_options/frameBuffer.c **** 
 203:./_options/frameBuffer.c **** 
 204:./_options/frameBuffer.c **** 
 205:./_options/frameBuffer.c **** // This code was in main...
 206:./_options/frameBuffer.c **** // This isn't generalized enough to justify this function-name
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 165


 207:./_options/frameBuffer.c **** // just not ready to delete it completely
 208:./_options/frameBuffer.c **** // Returns TRUE if there's a change to the frameBuffer image
 209:./_options/frameBuffer.c **** // (so a refresh can be scheduled, if so desired)
 210:./_options/frameBuffer.c **** // a/o v71: This is called in the main loop
 211:./_options/frameBuffer.c **** // 	w/ REFRESH_ON_CHANGE:
 212:./_options/frameBuffer.c **** //        * The fb_updater() function (e.g. tet_update) is only called
 213:./_options/frameBuffer.c **** //          after the frame-refresh is complete
 214:./_options/frameBuffer.c **** //          (if there are several refreshes, it waits until they're all
 215:./_options/frameBuffer.c **** //          done)
 216:./_options/frameBuffer.c **** //          It *also* waits for a delay *after the refreshes* before
 217:./_options/frameBuffer.c **** //          fb_updater() is called... (this may be a little redundant?)
 218:./_options/frameBuffer.c **** //    w/o:
 219:./_options/frameBuffer.c **** //        * The fb_updater() function is called at the beginning of a new
 220:./_options/frameBuffer.c **** //          frame (once) to attempt to only update the framebuffer at a
 221:./_options/frameBuffer.c **** //          time when it won't refresh the screen with only half of the
 222:./_options/frameBuffer.c **** //          framebuffer itself updated.
 223:./_options/frameBuffer.c **** void frameBufferUpdate(void)
 224:./_options/frameBuffer.c **** {
 3284               		.stabn	68,0,224,.LM368-.LFBB21
 3285               	.LM368:
 3286               	.LFBB21:
 3287               	/* prologue: function */
 3288               	/* frame size = 0 */
 3289               	/* stack size = 0 */
 3290               	.L__stack_usage = 0
 225:./_options/frameBuffer.c ****  #if(defined(FB_REFRESH_ON_CHANGE) && FB_REFRESH_ON_CHANGE)
 226:./_options/frameBuffer.c **** //      static uint8_t lastUpdated = FALSE;
 227:./_options/frameBuffer.c ****       static fb_timer_t fbLastUpdateTime = 0;
 228:./_options/frameBuffer.c **** 
 229:./_options/frameBuffer.c ****       //Because the dmsTimer is running somewhat arbitarily, this "200ms"
 230:./_options/frameBuffer.c ****       // isn't particularly accurate...
 231:./_options/frameBuffer.c ****       if(updateFrame)
 3291               		.stabn	68,0,231,.LM369-.LFBB21
 3292               	.LM369:
 3293 0afc 8091 0000 		lds r24,updateFrame
 3294 0b00 8823      		tst r24
 3295 0b02 01F0      		breq .L181
 232:./_options/frameBuffer.c **** 		{
 233:./_options/frameBuffer.c ****          fbLastUpdateTime = fb_getTime();
 3296               		.stabn	68,0,233,.LM370-.LFBB21
 3297               	.LM370:
 3298 0b04 00D0      		rcall tcnter_get
 3299 0b06 6093 0000 		sts fbLastUpdateTime.2108,r22
 3300 0b0a 7093 0000 		sts fbLastUpdateTime.2108+1,r23
 3301 0b0e 8093 0000 		sts fbLastUpdateTime.2108+2,r24
 3302 0b12 9093 0000 		sts fbLastUpdateTime.2108+3,r25
 234:./_options/frameBuffer.c **** 			return;
 3303               		.stabn	68,0,234,.LM371-.LFBB21
 3304               	.LM371:
 3305 0b16 0895      		ret
 3306               	.L181:
 3307               	.LBB300:
 3308               	.LBB301:
 3309               		.stabs	"./_commonCode_localized/tcnter/0.30/tcnter.h",132,0,0,.Ltext26
 3310               	.Ltext26:
   1:./_commonCode_localized/tcnter/0.30/tcnter.h **** /* mehPL:
   2:./_commonCode_localized/tcnter/0.30/tcnter.h ****  *    This is Open Source, but NOT GPL. I call it mehPL.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 166


   3:./_commonCode_localized/tcnter/0.30/tcnter.h ****  *    I'm not too fond of long licenses at the top of the file.
   4:./_commonCode_localized/tcnter/0.30/tcnter.h ****  *    Please see the bottom.
   5:./_commonCode_localized/tcnter/0.30/tcnter.h ****  *    Enjoy!
   6:./_commonCode_localized/tcnter/0.30/tcnter.h ****  */
   7:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
   8:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
   9:./_commonCode_localized/tcnter/0.30/tcnter.h **** //tcnter 0.30-6
  10:./_commonCode_localized/tcnter/0.30/tcnter.h **** // Similar functionality to dmsTimer
  11:./_commonCode_localized/tcnter/0.30/tcnter.h **** //   Doesn't require interrupts
  12:./_commonCode_localized/tcnter/0.30/tcnter.h **** //   MUCH higher resolution-potential (e.g. for bit-rate generation)
  13:./_commonCode_localized/tcnter/0.30/tcnter.h **** //      limited only by the tcnter_update() call rate(?)
  14:./_commonCode_localized/tcnter/0.30/tcnter.h **** // TODO: Make some, if not all, functions inline.
  15:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       CONSIDER: if timing is highly critical, it may make sense
  16:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                 to call update() with every get()
  17:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                 THOUGH: this would add a lot of calculations...
  18:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       CONSIDER2: could myTcnter_t be smaller, and use wraparound math?
  19:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                 e.g.  if(get() >= next) NOGO ? next=3, get=254
  20:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                 e.g.2 if(get() - next >= 0) ... same
  21:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                  wasn't there a way to do this?
  22:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                       if(get() - last >= next - last) ?
  23:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                             next=3, get=254, last=253
  24:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                          get()-last = 254-253 = 1
  25:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                          next-last = 3-253 = 6
  26:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                  Promotion issues may occur, watch casts.
  27:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                  See cTools/unsignedSubtraction.c
  28:./_commonCode_localized/tcnter/0.30/tcnter.h **** //                             next=5, get=7, last=6
  29:./_commonCode_localized/tcnter/0.30/tcnter.h **** //					Create "wrappableTimeCompare()" macro?
  30:./_commonCode_localized/tcnter/0.30/tcnter.h **** //             Also usable in dms, etc...
  31:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30-6 adding TCNT_UPDATE_ONCE_PER_OVERFLOW:
  32:./_commonCode_localized/tcnter/0.30/tcnter.h **** //			and tcnter_overflowUpdate()
  33:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       ...
  34:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       LCDdirectLVDS77 attempts to call tcnter_update() only once per
  35:./_commonCode_localized/tcnter/0.30/tcnter.h **** //			timer-overflow (in the interrupt)
  36:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       So it's quite likely that each tcnter_update() occurs at or around
  37:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       the same TCNT value. (which might explain why the heart isn't
  38:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       fading).
  39:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30-5 Checking if TCNTER_MS is <= 0
  40:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30-4 TCNTER_INITS_TIMER is configured by default IF timerCommon is not
  41:./_commonCode_localized/tcnter/0.30/tcnter.h **** //			included in the makefile before tcnter is...
  42:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       This is a bit hokey... (what if timerCommon is included *after*?)
  43:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       TODO: Figure this out.
  44:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30-3 PWM161 wasn't handled...
  45:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30-2 8V2, not V28
  46:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       Adding tcnter_wait(tcnts)
  47:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30-1 moving TCNTER_AVRTIMER_CLKDIV to tcnter.h so it can be used by
  48:./_commonCode_localized/tcnter/0.30/tcnter.h **** //			e.g. heartbeat to calculate timings...
  49:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.30  tcnter on an AVR will most-likely use a timer, e.g. timer0
  50:./_commonCode_localized/tcnter/0.30/tcnter.h **** //      so should set some defaults, not have to explicitly include
  51:./_commonCode_localized/tcnter/0.30/tcnter.h **** //      timerCommon in the project's makefile, etc.
  52:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.21  per dmsTimer1.14, a/o heartbeat1.50...
  53:./_commonCode_localized/tcnter/0.30/tcnter.h **** //      isItTime functions have an option to NOT worry about
  54:./_commonCode_localized/tcnter/0.30/tcnter.h **** //      cumulative-error...
  55:./_commonCode_localized/tcnter/0.30/tcnter.h **** //      Also, they've been made inline, so now included in the header-file
  56:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-10 Replacing tests' makefiles with those that refer to tcnter
  57:./_commonCode_localized/tcnter/0.30/tcnter.h **** //        properly... a/o/ala anaButtons 0.50
  58:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-9 adding this TODO: Apparently math doesn't work with
  59:./_commonCode_localized/tcnter/0.30/tcnter.h **** //			tcnter_source_t = uint16_t???
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 167


  60:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       And looking into it...
  61:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-8 a/o polled_uar/0.40/avrTest...
  62:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       adding some Usage notes...
  63:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-7 adding isItTime (non 8-bit)
  64:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-6 adding to COM_HEADERS when INLINED
  65:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-5 Renaming Globals to tcnter_*... nastiness
  66:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       see puar notes...
  67:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-4 tcnter8_t -> tcnter_isItTime8(startTime, delta)
  68:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       HANDY: When inlined, if(tcnter_isItTime()) results in
  69:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       an if statement from inside tcnter_isItTime, which is used
  70:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       *in place of* the if surrounding tcnter_isItTime()
  71:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       Inlining optimization is great!
  72:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-3 myTcnter_t is stupid -> tcnter_t
  73:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-2 adding _SPECIALHEADER_FOR_TCNTER_
  74:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       e.g. TCNTER OVERFLOW VAL = _DMS_OCR_VAL_ requires dmsTimer.h
  75:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       so CFLAGS+=-D'_SPECIALHEADER_FOR_TCNTER_=_DMSTIMER_HEADER_'
  76:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20-1 inlining...
  77:./_commonCode_localized/tcnter/0.30/tcnter.h **** //				SEE NOTES in .c before using inlining
  78:./_commonCode_localized/tcnter/0.30/tcnter.h **** //          and experiment and stuff
  79:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.20 TCNTER_SOURCE_MAX renamed to TCNTER_SOURCE_OVERFLOW_VAL
  80:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10-3 fixing names in test (to match 0.10-1 changes)
  81:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       experimenting with test
  82:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10-2 Need <avr/io.h> when TCNT, etc. is used...
  83:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10-1 (forgot to backup first version?)
  84:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       renaming all tcnt and whatnot to tcnter
  85:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10 First version, stolen and modified from polled_uar 0.10-6
  86:./_commonCode_localized/tcnter/0.30/tcnter.h **** //
  87:./_commonCode_localized/tcnter/0.30/tcnter.h **** //---------
  88:./_commonCode_localized/tcnter/0.30/tcnter.h **** //polled_uar 0.10-6:
  89:./_commonCode_localized/tcnter/0.30/tcnter.h **** //   Doesn't use interrupts (no lag-times, etc.)
  90:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10-4 
  91:./_commonCode_localized/tcnter/0.30/tcnter.h **** //       Looking into running-tcnt
  92:./_commonCode_localized/tcnter/0.30/tcnter.h **** //				myTcnter and nextTcnter now implemented
  93:./_commonCode_localized/tcnter/0.30/tcnter.h **** //          Fixes potential issues with multi-TCNTs per update
  94:./_commonCode_localized/tcnter/0.30/tcnter.h **** //            Aiding cumulative-error fixing
  95:./_commonCode_localized/tcnter/0.30/tcnter.h **** //            (Next time was dependent on the time of the current update)
  96:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10-3 test app using makefile...
  97:./_commonCode_localized/tcnter/0.30/tcnter.h **** //			cleanup
  98:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10-1 More mods, test app
  99:./_commonCode_localized/tcnter/0.30/tcnter.h **** //0.10 First Version stolen and modified heavily from usi_uart 0.22-3
 100:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 101:./_commonCode_localized/tcnter/0.30/tcnter.h **** #ifndef __TCNTER_H__
 102:./_commonCode_localized/tcnter/0.30/tcnter.h **** #define __TCNTER_H__
 103:./_commonCode_localized/tcnter/0.30/tcnter.h **** //This shouldn't be necessary... (or its necessity removed soon)
 104:./_commonCode_localized/tcnter/0.30/tcnter.h **** //#include <avr/io.h>
 105:./_commonCode_localized/tcnter/0.30/tcnter.h **** #include <stdint.h>
 106:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 107:./_commonCode_localized/tcnter/0.30/tcnter.h **** #ifdef __AVR_ARCH__
 108:./_commonCode_localized/tcnter/0.30/tcnter.h ****  //This is only necessary if TCNT0 (etc.) is used
 109:./_commonCode_localized/tcnter/0.30/tcnter.h ****  // according to the project makefile
 110:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #include <avr/io.h>
 111:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 112:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 113:./_commonCode_localized/tcnter/0.30/tcnter.h **** //This is for, e.g. where TCNTER_SOURCE_OVERFLOW_VAL = _DMS_OCR_VAL_
 114:./_commonCode_localized/tcnter/0.30/tcnter.h **** // Then tcnter needs to be aware of the definition of _DMS_OCR_VAL_
 115:./_commonCode_localized/tcnter/0.30/tcnter.h **** #ifdef _SPECIALHEADER_FOR_TCNTER_
 116:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #include _SPECIALHEADER_FOR_TCNTER_
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 168


 117:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 118:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 119:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 120:./_commonCode_localized/tcnter/0.30/tcnter.h **** #if (defined(TCNTER_INITS_TIMER) && TCNTER_INITS_TIMER)
 121:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #include _TIMERCOMMON_HEADER_
 122:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 123:./_commonCode_localized/tcnter/0.30/tcnter.h ****  //Moved here so it can be referenced elsewhere for determining timings...
 124:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #ifndef TCNTER_AVRTIMER_CLKDIV
 125:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #ifdef __AVR_AT90PWM161__
 126:./_commonCode_localized/tcnter/0.30/tcnter.h **** 	// This is the only option on the PWM161
 127:./_commonCode_localized/tcnter/0.30/tcnter.h ****    #define TCNTER_AVRTIMER_CLKDIV CLKDIV1
 128:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #else
 129:./_commonCode_localized/tcnter/0.30/tcnter.h ****    //This choice is arbitrary...
 130:./_commonCode_localized/tcnter/0.30/tcnter.h ****    // According to timerCommon, it exists in most typical systems
 131:./_commonCode_localized/tcnter/0.30/tcnter.h ****    // The only exception I've run into so far is AT90PWM161, which ONLY has
 132:./_commonCode_localized/tcnter/0.30/tcnter.h ****    // CLKDIV1, which wouldn't work too well since tcnter_update() would
 133:./_commonCode_localized/tcnter/0.30/tcnter.h ****    // have to run every 255 clock cycles (or 65535?)
 134:./_commonCode_localized/tcnter/0.30/tcnter.h ****    // LCDdirectLVDS69 uses the timer for dms... so it must work, ish.
 135:./_commonCode_localized/tcnter/0.30/tcnter.h ****    #define TCNTER_AVRTIMER_CLKDIV CLKDIV64
 136:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #endif
 137:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #endif
 138:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 139:./_commonCode_localized/tcnter/0.30/tcnter.h ****  //These can be used by other code...
 140:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #define TCNTS_PER_SECOND  (F_CPU/(1<<TCNTER_AVRTIMER_CLKDIV))
 141:./_commonCode_localized/tcnter/0.30/tcnter.h ****  //At FCPU = 16MHz, TCNTER_MS is 250...
 142:./_commonCode_localized/tcnter/0.30/tcnter.h **** #else
 143:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #warning "TCNTER_INITS_TIMER is NOT TRUE. This can happen a number of ways, the weirdest being tha
 144:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #warning "If you get weird errors, did you check that TCNTER_SEC, etc. have been set for your proj
 145:./_commonCode_localized/tcnter/0.30/tcnter.h **** #warning "Check: TCNTER_SOURCE_VAR, TCNTER_SOURCE_OVERFLOW_VAL, and TCNTS_PER_SECOND, also _SPECIAL
 146:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 147:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 148:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 149:./_commonCode_localized/tcnter/0.30/tcnter.h **** #if((TCNTS_PER_SECOND/1000) > 0)
 150:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #define TCNTS_PER_MS		(TCNTS_PER_SECOND/1000)
 151:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #define TCNTER_MS			(TCNTS_PER_MS)
 152:./_commonCode_localized/tcnter/0.30/tcnter.h **** #else
 153:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #warning "TCNTS_PER_MS <= 0, so TCNTER_MS is disabled"
 154:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 155:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 156:./_commonCode_localized/tcnter/0.30/tcnter.h **** #define TCNTER_SEC			(TCNTS_PER_SECOND)
 157:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 158:./_commonCode_localized/tcnter/0.30/tcnter.h **** #if((TCNTS_PER_SECOND/10000) > 0)
 159:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #define TCNTER_DMS			(TCNTS_PER_SECOND/10000)
 160:./_commonCode_localized/tcnter/0.30/tcnter.h **** #else
 161:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #warning "TCNTER_DMS <= 0, so disabled"
 162:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 163:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 164:./_commonCode_localized/tcnter/0.30/tcnter.h **** /*
 165:./_commonCode_localized/tcnter/0.30/tcnter.h **** // This'd be nice to change...
 166:./_commonCode_localized/tcnter/0.30/tcnter.h **** #if (!defined(PU_PC_DEBUG) || !PU_PC_DEBUG)
 167:./_commonCode_localized/tcnter/0.30/tcnter.h **** // #include "../../bithandling/0.94/bithandling.h"
 168:./_commonCode_localized/tcnter/0.30/tcnter.h **** #else
 169:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #include <stdio.h>
 170:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 171:./_commonCode_localized/tcnter/0.30/tcnter.h **** */
 172:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 173:./_commonCode_localized/tcnter/0.30/tcnter.h **** //DON'T CHANGE THIS WITHOUT CHANGING both!
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 169


 174:./_commonCode_localized/tcnter/0.30/tcnter.h **** #if ( (!defined(tcnter_source_t) && defined(tcnter_compare_t)) \
 175:./_commonCode_localized/tcnter/0.30/tcnter.h ****     ||(!defined(tcnter_compare_t) && defined(tcnter_source_t)) )
 176:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #error "tcnter_source_t and tcnter_compare_t must *both* be overridden"
 177:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 178:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 179:./_commonCode_localized/tcnter/0.30/tcnter.h **** #ifndef tcnter_source_t
 180:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #ifdef __AVR_AT90PWM161__
 181:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #define tcnter_source_t	uint16_t
 182:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #else
 183:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #define tcnter_source_t   uint8_t
 184:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #endif
 185:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 186:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 187:./_commonCode_localized/tcnter/0.30/tcnter.h **** #ifndef tcnter_compare_t
 188:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #ifdef __AVR_AT90PWM161__
 189:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #define tcnter_compare_t  int32_t
 190:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #else
 191:./_commonCode_localized/tcnter/0.30/tcnter.h ****   #define tcnter_compare_t  int16_t
 192:./_commonCode_localized/tcnter/0.30/tcnter.h ****  #endif
 193:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 194:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 195:./_commonCode_localized/tcnter/0.30/tcnter.h **** //This is a stupid name...
 196:./_commonCode_localized/tcnter/0.30/tcnter.h **** #define myTcnter_t  uint32_t
 197:./_commonCode_localized/tcnter/0.30/tcnter.h **** //This makes more sense...
 198:./_commonCode_localized/tcnter/0.30/tcnter.h **** // But I think I did it that way because I might later want to make this
 199:./_commonCode_localized/tcnter/0.30/tcnter.h **** // an internal structure, in case I want multiple tcnters...
 200:./_commonCode_localized/tcnter/0.30/tcnter.h **** // (e.g. like xyt, or hfm, etc...)
 201:./_commonCode_localized/tcnter/0.30/tcnter.h **** // seems less likely in this case...
 202:./_commonCode_localized/tcnter/0.30/tcnter.h **** #define tcnter_t uint32_t
 203:./_commonCode_localized/tcnter/0.30/tcnter.h **** #define tcnter8_t uint8_t
 204:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 205:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 206:./_commonCode_localized/tcnter/0.30/tcnter.h **** //********** TCNTER Prototypes **********//
 207:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 208:./_commonCode_localized/tcnter/0.30/tcnter.h **** //These are the functions that are used in main code...
 209:./_commonCode_localized/tcnter/0.30/tcnter.h **** // General initialization...
 210:./_commonCode_localized/tcnter/0.30/tcnter.h **** void tcnter_init(void);
 211:./_commonCode_localized/tcnter/0.30/tcnter.h **** // To be called in the main loop...
 212:./_commonCode_localized/tcnter/0.30/tcnter.h **** // (Handles reading the TCNT deltas and adding to myTcnter, etc)
 213:./_commonCode_localized/tcnter/0.30/tcnter.h **** // this should be called MORE OFTEN than overflows
 214:./_commonCode_localized/tcnter/0.30/tcnter.h **** // If using an overflow-interrupt as the only reliable source of updates
 215:./_commonCode_localized/tcnter/0.30/tcnter.h **** // then use tcnter_overflowUpdate() (other tcnter_updates can also be
 216:./_commonCode_localized/tcnter/0.30/tcnter.h **** // called)
 217:./_commonCode_localized/tcnter/0.30/tcnter.h **** void tcnter_update(void);
 218:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 219:./_commonCode_localized/tcnter/0.30/tcnter.h **** #if(defined(TCNT_UPDATE_ONCE_PER_OVERFLOW) && \
 220:./_commonCode_localized/tcnter/0.30/tcnter.h **** 		      TCNT_UPDATE_ONCE_PER_OVERFLOW)
 221:./_commonCode_localized/tcnter/0.30/tcnter.h **** void tcnter_overflowUpdate(void);
 222:./_commonCode_localized/tcnter/0.30/tcnter.h **** #endif
 223:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 224:./_commonCode_localized/tcnter/0.30/tcnter.h **** // Get the current value of myTcnter
 225:./_commonCode_localized/tcnter/0.30/tcnter.h **** tcnter_t tcnter_get(void);
 226:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 227:./_commonCode_localized/tcnter/0.30/tcnter.h **** void tcnter_wait(myTcnter_t tcnts);
 228:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 229:./_commonCode_localized/tcnter/0.30/tcnter.h **** //Of course, this is only safe if it's called often enough...
 230:./_commonCode_localized/tcnter/0.30/tcnter.h **** // and deltaTime is small enough...
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 170


 231:./_commonCode_localized/tcnter/0.30/tcnter.h **** // and tcnterUpdate is called often enough, as well (?)
 232:./_commonCode_localized/tcnter/0.30/tcnter.h **** //uint8_t tcnter_isItTime8(tcnter8_t *startTime, tcnter8_t deltaTime);
 233:./_commonCode_localized/tcnter/0.30/tcnter.h **** //uint8_t tcnter_isItTime(tcnter_t *startTime, tcnter_t deltaTime);
 234:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 235:./_commonCode_localized/tcnter/0.30/tcnter.h **** // dmsTimer has these inlined, and lists them in the header file
 236:./_commonCode_localized/tcnter/0.30/tcnter.h **** // (I guess it makes sense, they're small enough to always inline, and that
 237:./_commonCode_localized/tcnter/0.30/tcnter.h **** // won't happen if they're in the C file...)
 238:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 239:./_commonCode_localized/tcnter/0.30/tcnter.h **** // For now, the notes are still in the C file.
 240:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 241:./_commonCode_localized/tcnter/0.30/tcnter.h **** // a/o V2: dontAllowCumulation should optimize-out into a smaller function
 242:./_commonCode_localized/tcnter/0.30/tcnter.h **** //         (if FALSE)
 243:./_commonCode_localized/tcnter/0.30/tcnter.h **** extern volatile tcnter_t tcnter_myTcnter;
 244:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 245:./_commonCode_localized/tcnter/0.30/tcnter.h **** static __inline__
 246:./_commonCode_localized/tcnter/0.30/tcnter.h **** uint8_t tcnter_isItTime8V2(tcnter8_t *startTime, tcnter8_t deltaTime,
 247:./_commonCode_localized/tcnter/0.30/tcnter.h **** 										uint8_t dontAllowCumulation)
 248:./_commonCode_localized/tcnter/0.30/tcnter.h **** {
 249:./_commonCode_localized/tcnter/0.30/tcnter.h ****    tcnter8_t thisDelta = (uint8_t)tcnter_myTcnter - (uint8_t)(*startTime);
 250:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 251:./_commonCode_localized/tcnter/0.30/tcnter.h ****    if(thisDelta >= deltaTime)
 252:./_commonCode_localized/tcnter/0.30/tcnter.h ****    {
 253:./_commonCode_localized/tcnter/0.30/tcnter.h **** 		if(dontAllowCumulation)
 254:./_commonCode_localized/tcnter/0.30/tcnter.h ****       	*startTime = (uint8_t)tcnter_myTcnter - (thisDelta - deltaTime);
 255:./_commonCode_localized/tcnter/0.30/tcnter.h ****       else
 256:./_commonCode_localized/tcnter/0.30/tcnter.h **** 			*startTime = (uint8_t)tcnter_myTcnter;
 257:./_commonCode_localized/tcnter/0.30/tcnter.h **** 		return TRUE;
 258:./_commonCode_localized/tcnter/0.30/tcnter.h ****    }
 259:./_commonCode_localized/tcnter/0.30/tcnter.h ****    else
 260:./_commonCode_localized/tcnter/0.30/tcnter.h ****       return FALSE;
 261:./_commonCode_localized/tcnter/0.30/tcnter.h **** }
 262:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 263:./_commonCode_localized/tcnter/0.30/tcnter.h **** static __inline__
 264:./_commonCode_localized/tcnter/0.30/tcnter.h **** uint8_t tcnter_isItTimeV2(tcnter_t *startTime, tcnter_t deltaTime,
 265:./_commonCode_localized/tcnter/0.30/tcnter.h **** 										uint8_t dontAllowCumulation)
 266:./_commonCode_localized/tcnter/0.30/tcnter.h **** {
 267:./_commonCode_localized/tcnter/0.30/tcnter.h ****    tcnter_t thisDelta = tcnter_myTcnter - *startTime;
 3311               		.stabn	68,0,267,.LM372-.LFBB21
 3312               	.LM372:
 3313 0b18 8091 0000 		lds r24,tcnter_myTcnter
 3314 0b1c 9091 0000 		lds r25,tcnter_myTcnter+1
 3315 0b20 A091 0000 		lds r26,tcnter_myTcnter+2
 3316 0b24 B091 0000 		lds r27,tcnter_myTcnter+3
 3317 0b28 4091 0000 		lds r20,fbLastUpdateTime.2108
 3318 0b2c 5091 0000 		lds r21,fbLastUpdateTime.2108+1
 3319 0b30 6091 0000 		lds r22,fbLastUpdateTime.2108+2
 3320 0b34 7091 0000 		lds r23,fbLastUpdateTime.2108+3
 3321 0b38 841B      		sub r24,r20
 3322 0b3a 950B      		sbc r25,r21
 3323 0b3c A60B      		sbc r26,r22
 3324 0b3e B70B      		sbc r27,r23
 268:./_commonCode_localized/tcnter/0.30/tcnter.h **** 
 269:./_commonCode_localized/tcnter/0.30/tcnter.h ****    if(thisDelta >= deltaTime)
 3325               		.stabn	68,0,269,.LM373-.LFBB21
 3326               	.LM373:
 3327 0b40 8034      		cpi r24,64
 3328 0b42 9D40      		sbci r25,13
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 171


 3329 0b44 A340      		sbci r26,3
 3330 0b46 B105      		cpc r27,__zero_reg__
 3331 0b48 00F0      		brlo .L180
 270:./_commonCode_localized/tcnter/0.30/tcnter.h ****    {
 271:./_commonCode_localized/tcnter/0.30/tcnter.h **** 		if(dontAllowCumulation)
 272:./_commonCode_localized/tcnter/0.30/tcnter.h ****       	*startTime = tcnter_myTcnter - (thisDelta - deltaTime);
 273:./_commonCode_localized/tcnter/0.30/tcnter.h ****       else
 274:./_commonCode_localized/tcnter/0.30/tcnter.h **** 			*startTime = tcnter_myTcnter;
 3332               		.stabn	68,0,274,.LM374-.LFBB21
 3333               	.LM374:
 3334 0b4a 8091 0000 		lds r24,tcnter_myTcnter
 3335 0b4e 9091 0000 		lds r25,tcnter_myTcnter+1
 3336 0b52 A091 0000 		lds r26,tcnter_myTcnter+2
 3337 0b56 B091 0000 		lds r27,tcnter_myTcnter+3
 3338 0b5a 8093 0000 		sts fbLastUpdateTime.2108,r24
 3339 0b5e 9093 0000 		sts fbLastUpdateTime.2108+1,r25
 3340 0b62 A093 0000 		sts fbLastUpdateTime.2108+2,r26
 3341 0b66 B093 0000 		sts fbLastUpdateTime.2108+3,r27
 3342               	.LBE301:
 3343               	.LBE300:
 3344               	.LBB302:
 3345               		.stabs	"./_options/frameBuffer.c",132,0,0,.Ltext27
 3346               	.Ltext27:
 235:./_options/frameBuffer.c **** 		}
 236:./_options/frameBuffer.c **** 
 237:./_options/frameBuffer.c **** 		// Since lastUpdateTime is updated each time this function is called
 238:./_options/frameBuffer.c **** 		// with updateFrame != 0, this test will fail until 100ms after the
 239:./_options/frameBuffer.c **** 		// last refresh.
 240:./_options/frameBuffer.c **** 		// (a/o v71 this has changed, it was in an else, and this else-case
 241:./_options/frameBuffer.c **** 		// handled multiple-refresh. That should now be handled in
 242:./_options/frameBuffer.c **** 		// endOfFrameHandler())
 243:./_options/frameBuffer.c ****       if(fb_isItTime(&fbLastUpdateTime, FB_REFRESH_ON_CHANGE_DELAY))
 244:./_options/frameBuffer.c ****       {
 245:./_options/frameBuffer.c **** 			int16_t fb_changedTillRow = fb_updater();
 3347               		.stabn	68,0,245,.LM375-.LFBB21
 3348               	.LM375:
 3349 0b6a 00D0      		rcall fbQuestion_update
 246:./_options/frameBuffer.c **** 			//call fb_updater()
 247:./_options/frameBuffer.c **** 			// and ONLY REFRESH if there's been a change to the frameBuffer
 248:./_options/frameBuffer.c ****       	if(fb_changedTillRow != -1)
 3350               		.stabn	68,0,248,.LM376-.LFBB21
 3351               	.LM376:
 3352 0b6c 8F3F      		cpi r24,lo8(-1)
 3353 0b6e 01F0      		breq .L180
 249:./_options/frameBuffer.c ****          {
 250:./_options/frameBuffer.c **** #if(defined(PARTIAL_REFRESH) && PARTIAL_REFRESH)
 251:./_options/frameBuffer.c **** 				extern uint16_t stopRefreshAtRow;
 252:./_options/frameBuffer.c **** 				//This must be +1 to account for the length of the last pixel
 253:./_options/frameBuffer.c **** 				// possibly 2 to help clear out ghosting
 254:./_options/frameBuffer.c **** 				stopRefreshAtRow = (fb_changedTillRow+2) * V_COUNT / FB_HEIGHT;	
 255:./_options/frameBuffer.c **** #endif
 256:./_options/frameBuffer.c **** 				restartFrameUpdate();
 3354               		.stabn	68,0,256,.LM377-.LFBB21
 3355               	.LM377:
 3356 0b70 00C0      		rjmp restartFrameUpdate
 3357               	.L180:
 3358 0b72 0895      		ret
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 172


 3359               	.LBE302:
 3360               		.size	frameBufferUpdate, .-frameBufferUpdate
 3361               		.stabs	"fbLastUpdateTime:V(4,6)",38,0,227,fbLastUpdateTime.2108
 3362               		.stabn	192,0,0,.LFBB21-.LFBB21
 3363               		.stabn	224,0,0,.Lscope21-.LFBB21
 3364               	.Lscope21:
 3365               		.stabs	"",36,0,0,.Lscope21-.LFBB21
 3366               		.stabd	78,0,0
 3367               		.stabs	"__vector_14:F(0,47)",36,0,422,__vector_14
 3368               	.global	__vector_14
 3369               		.type	__vector_14, @function
 3370               	__vector_14:
 3371               		.stabd	46,0,0
 3372               		.stabs	"main.c",132,0,0,.Ltext28
 3373               	.Ltext28:
 409:main.c        **** 
 410:main.c        **** 	//The sony display seems to dislike not having a dot-clock...
 411:main.c        **** 	// This is an experiment...
 412:main.c        ****   #if (defined(LCDINTERFACE_BITBANGED_DOTCLOCK_PWM) && \
 413:main.c        **** 		  LCDINTERFACE_BITBANGED_DOTCLOCK_PWM)
 414:main.c        **** 	lcdInterface_pwmDotClockInit(FALSE);
 415:main.c        ****   #endif
 416:main.c        ****  }
 417:main.c        **** 
 418:main.c        ****  //Nearly everything display-related happens in this interrupt
 419:main.c        ****  // It even calls the functions that load (and calculate!) the data for the
 420:main.c        ****  // next row.
 421:main.c        ****  // So basically, the entire project is running via timer-interrupt.
 422:main.c        ****  SIGNAL(HSYNC_TIMER_INTERRUPT_VECT) //TIMER0_COMPA_vect)
 423:main.c        ****  {
 3374               		.stabn	68,0,423,.LM378-.LFBB22
 3375               	.LM378:
 3376               	.LFBB22:
 3377 0b74 1F92      		push r1
 3378 0b76 0F92      		push r0
 3379 0b78 0FB6      		in r0,__SREG__
 3380 0b7a 0F92      		push r0
 3381 0b7c 1124      		clr __zero_reg__
 3382 0b7e 2F93      		push r18
 3383 0b80 3F93      		push r19
 3384 0b82 4F93      		push r20
 3385 0b84 5F93      		push r21
 3386 0b86 6F93      		push r22
 3387 0b88 7F93      		push r23
 3388 0b8a 8F93      		push r24
 3389 0b8c 9F93      		push r25
 3390 0b8e AF93      		push r26
 3391 0b90 BF93      		push r27
 3392 0b92 EF93      		push r30
 3393 0b94 FF93      		push r31
 3394               	/* prologue: Signal */
 3395               	/* frame size = 0 */
 3396               	/* stack size = 15 */
 3397               	.L__stack_usage = 15
 424:main.c        **** #if(defined(_DMS_EXTERNALUPDATE_) && _DMS_EXTERNALUPDATE_)
 425:main.c        **** 	 dms_update();
 426:main.c        **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 173


 427:main.c        **** 
 428:main.c        **** 		//Since HEART_TCNTER_UPDATES_AND_INIT is not true (could test here)
 429:main.c        **** 		// we need to do it manually...
 430:main.c        **** 		// (because the tcnter uses the hsyncTimer)
 431:main.c        **** #if(!defined(HEART_TCNTER_UPDATES_AND_INIT) || \
 432:main.c        **** 		!HEART_TCNTER_UPDATES_AND_INIT)
 433:main.c        **** #if(defined(_HEART_TCNTER_) && _HEART_TCNTER_)
 434:main.c        **** 	 tcnter_overflowUpdate();
 3398               		.stabn	68,0,434,.LM379-.LFBB22
 3399               	.LM379:
 3400 0b96 00D0      		rcall tcnter_overflowUpdate
 435:main.c        **** #endif
 436:main.c        **** #endif
 437:main.c        **** 
 438:main.c        **** 	 if(!updateFrame)
 3401               		.stabn	68,0,438,.LM380-.LFBB22
 3402               	.LM380:
 3403 0b98 8091 0000 		lds r24,updateFrame
 3404 0b9c 8823      		tst r24
 3405 0b9e 01F0      		breq .L188
 439:main.c        **** 		 return;
 440:main.c        **** 
 441:main.c        ****  //	static uint8_t frameCount = 0;
 442:main.c        **** 
 443:main.c        **** 	//Could insert a delay of sorts for scopability...
 444:main.c        **** 	// (otherwise there's not much guarantee that register-assignments
 445:main.c        **** 	//  later will align with the LVDS frame... though ALIGN should help)
 446:main.c        **** 	// see scopeHsync.c
 447:main.c        **** 
 448:main.c        **** 	//So here's the deal:
 449:main.c        **** 	// This handles a single row of pixel/timing data (Hblanks included)
 450:main.c        **** 	// lcd_update()             (from lcdStuff.c) 
 451:main.c        **** 	//  --> loadData()         (from lcdStuff.c)
 452:main.c        **** 	//        HSync
 453:main.c        **** 	//        H-Back-Porch
 454:main.c        **** 	//        --> drawPix()    (drawPix() may be here or elsewhere)
 455:main.c        **** 	//        (H-Front-Porch)
 456:main.c        **** 	//
 457:main.c        **** 	// drawPix is only called for drawn-rows (where DE is active, NOT for
 458:main.c        **** 	// Vblank rows)
 459:main.c        **** 	// H-Front-Porch is handled in the time between completion of this
 460:main.c        **** 	// interrupt and the next interrupt...
 461:main.c        **** 
 462:main.c        **** 
 463:main.c        **** 	int16_t rowNum = lcd_update();
 3406               		.stabn	68,0,463,.LM381-.LFBB22
 3407               	.LM381:
 3408 0ba0 00D0      		rcall lcd_update
 464:main.c        **** 
 465:main.c        **** 	if(rowNum == LCD_FRAMECOMPLETE)
 3409               		.stabn	68,0,465,.LM382-.LFBB22
 3410               	.LM382:
 3411 0ba2 8F3F      		cpi r24,-1
 3412 0ba4 9F47      		sbci r25,127
 3413 0ba6 01F4      		brne .L188
 466:main.c        **** 	{
 467:main.c        **** 		frameCount++;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 174


 3414               		.stabn	68,0,467,.LM383-.LFBB22
 3415               	.LM383:
 3416 0ba8 8091 0000 		lds r24,frameCount
 3417 0bac 8F5F      		subi r24,lo8(-(1))
 3418 0bae 8093 0000 		sts frameCount,r24
 3419               	.LBB303:
 3420               	.LBB304:
 468:main.c        **** 		//lcd_update() returns TRUE when the frame is complete
 469:main.c        **** 		// which can be used for whatever purposes 
 470:main.c        **** 		// (e.g. FRAME_COUNT_TO_DELAY)
 471:main.c        **** 
 472:main.c        **** 		endOfFrameHandler();
 473:main.c        **** 	}
 474:main.c        **** 
 475:main.c        **** #if(defined(PARTIAL_REFRESH) && PARTIAL_REFRESH)
 476:main.c        **** 	else if(rowNum >= (int16_t)stopRefreshAtRow)
 477:main.c        **** 	{
 478:main.c        **** 		lcd_init();
 479:main.c        **** 		frameCount++;
 480:main.c        **** 		endOfFrameHandler();
 481:main.c        **** 	}
 482:main.c        **** #endif
 483:main.c        **** 
 484:main.c        ****  #if(defined(LOADROW) && LOADROW)
 485:main.c        **** 	//a/o v70: All the following notes are old, and should probably be
 486:main.c        **** 	//removed...
 487:main.c        **** 	//  Historically: lcd_update() handled calling loadRow
 488:main.c        **** 	//  That'd been removed, then readded, then removed
 489:main.c        **** 	//  as, somewhere inbetween it was moved here and forgotten
 490:main.c        **** 	//  This makes the most sense, as it's more project-specific
 491:main.c        **** 	//
 492:main.c        **** 	//Load the next row into the row(seg)buffer
 493:main.c        **** 	//data is enabled after T_VD+T_Vlow...
 494:main.c        **** 	//a/o v60: Rereading this is confusing...
 495:main.c        **** 	// Basically, there's no reason to call loadRow for display-lines
 496:main.c        **** 	// which don't display data (e.g. V-Sync)
 497:main.c        **** #warning "This test could probably be replaced with rowNum..."
 498:main.c        **** 
 499:main.c        **** 	if((hsyncCount >= T_VD+T_Vlow) && (hsyncCount < T_VD+T_Vlow+V_COUNT))
 500:main.c        **** 		loadRow(hsyncCount - (T_VD+T_Vlow));
 501:main.c        ****  #endif
 502:main.c        **** 	// a/o v60: This is a funny old note... I can't recall a time when
 503:main.c        **** 	// loadRow was written, then removed, then added again. Weird:
 504:main.c        **** 	// Here is where loadRow used to be called
 505:main.c        **** 	// it has been moved to oldNotes.txt, but it would make more sense
 506:main.c        **** 	// to look at LCDdirectLVDS <25 or LCDdirect
 507:main.c        **** 	// loadRow used the time between DE inactive and the next Hsync
 508:main.c        **** 	// to load a row to a row-buffer (as opposed to a frame-buffer)
 509:main.c        **** 	// thus, DE could gain more pixels because there would be fewer
 510:main.c        **** 	// calculations to determine the memory location to write from
 511:main.c        **** 	// This effect has since been minimized
 512:main.c        **** 	// BUT loadRow might be necessary for program-memory-based images...
 513:main.c        **** 
 514:main.c        **** 
 515:main.c        **** 	//THIS IS A HACK
 516:main.c        **** 	//tcnter_update();
 517:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 175


 518:main.c        ****  }
 519:main.c        **** #endif //!PWM_TESTING
 520:main.c        **** 
 521:main.c        **** 
 522:main.c        **** #if(defined(SEG_HFM) && SEG_HFM)
 523:main.c        **** 	#include "seg_hfm.c"
 524:main.c        **** #endif
 525:main.c        **** 
 526:main.c        **** #if(defined(SEG_QUESTION) && SEG_QUESTION)
 527:main.c        **** 	#include "seg_question.c"
 528:main.c        **** #endif
 529:main.c        **** 
 530:main.c        **** #if(defined(SEG_SINE) && SEG_SINE)
 531:main.c        **** 	#include "seg_sine.c"
 532:main.c        **** #endif
 533:main.c        **** 
 534:main.c        **** #if(defined(LOADROW) && LOADROW)
 535:main.c        **** void loadRow(uint16_t rowNum)
 536:main.c        **** {
 537:main.c        **** 
 538:main.c        **** 
 539:main.c        **** #if(defined(ROW_SEG_BUFFER) && ROW_SEG_BUFFER)
 540:main.c        ****  #if (defined(SEG_RACER) && SEG_RACER)
 541:main.c        **** 	racer_loadRow(rowNum);
 542:main.c        ****  #elif (defined(SEG_HFM) && SEG_HFM)
 543:main.c        ****  	segHFM_loadRow(rowNum);
 544:main.c        ****  #elif (defined(SEG_QUESTION) && SEG_QUESTION)
 545:main.c        ****  	segQuestion_loadRow(rowNum);
 546:main.c        ****  #elif (defined(SEG_SINE) && SEG_SINE)
 547:main.c        ****  	segSine_loadRow(rowNum);
 548:main.c        ****  #elif (defined(SEG_LINE) && SEG_LINE)
 549:main.c        **** 	//Left here for an example...
 550:main.c        **** 	// Draws a diagonal line 
 551:main.c        **** 	//OLD NOTE:
 552:main.c        **** 	//syncing issues due to recursion overflowing the stack???
 553:main.c        **** 	// Apparently was
 554:main.c        **** 	   
 555:main.c        **** 	//Isn't BLAH = 1 necessary so we don't get a row with no data?
 556:main.c        **** 	// *looks* like it's working, but I dunno...
 557:main.c        **** 	#define BLAH 0
 558:main.c        **** 
 559:main.c        **** 	segClear();
 560:main.c        **** 	newSeg(3,0x06, (6<<4) | 3);									//W
 561:main.c        **** 	newSeg((rowNum&0xff) | BLAH, 0x06, (4<<4) | 0);				//R
 562:main.c        **** 	newSeg(1,0x06, (6<<4) | 3);									//W
 563:main.c        **** 	newSeg((255-(rowNum&0xff)) | BLAH, 0x06, (4<<4) | 0 );	//R
 564:main.c        **** 	newSeg(3,0x06, (6<<4) | 3);									//W
 565:main.c        **** 	segTerminate();
 566:main.c        **** 
 567:main.c        ****  #elif (defined(SEG_TET) && SEG_TET)
 568:main.c        **** 	//This isn't particularly functional, anymore
 569:main.c        **** 	// it used to be an intermediate stage between rowBuffer and 
 570:main.c        **** 	//  rowSegBuffer... Left here for an example of how it could be done...
 571:main.c        **** 	//ACTUALLY, a/o v60ish it has been reinstated...
 572:main.c        **** 	// and, in fact, a/o v62, this may become a great early-test for new
 573:main.c        **** 	// displays, as the necessary resolution is low, which would allow for
 574:main.c        **** 	// higher refresh-rates (which some displays may need)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 176


 575:main.c        **** 	// (There are certainly other ways to make things more suitable for new
 576:main.c        **** 	// displays... these'll be explored in later code-revisions, probably)
 577:main.c        **** 
 578:main.c        ****   //SEG_STRETCH is the number of PSEGS that each row-buffer pixel is
 579:main.c        ****   //stretched-across. In this case (SEG_TET) (or any case where *only* the
 580:main.c        ****   //rowbuffer is used to fill the screen), the value of SEG_STRETCH should
 581:main.c        ****   //probably be varied dependent on NUM_PSEGS (which should be dependent on
 582:main.c        ****   //LVDS_PRESCALER and a few other factors) in order to stretch the
 583:main.c        ****   //row-buffer acreoss the entire screen. But I think most of these things
 584:main.c        ****   //are so-far hard-coded...
 585:main.c        ****   // Further, it's entirely possible (in a not-implemented-here case) to
 586:main.c        ****   // have the row-buffer occupy only a certain portion of the screen and
 587:main.c        ****   // modify the remaining psegs directly via other means... (I had this
 588:main.c        ****   // once, when displaying Tetris, Life, and a few others on the same
 589:main.c        ****   // screen, I think, right?)
 590:main.c        ****   //Anyhow, a/o a while back, SEG_TET is the only case using SEG_STRETCH 
 591:main.c        **** //  #if(!defined(SEG_STRETCH))
 592:main.c        **** // And a/o v62 Trying to bump the frame-rate up so the ChiMei display will
 593:main.c        **** // work, using LVDS_PRESCALER, this might help... again hardcoded where
 594:main.c        **** // ideally the thing would calculate itself... Though it's also handy to
 595:main.c        **** // have it hard-coded as it allows for testing the display's immunity (or
 596:main.c        **** // lack thereof) for long/short DEs
 597:main.c        **** #if(LVDS_PRESCALER == 1)
 598:main.c        ****  #define SEG_STRETCH 1
 599:main.c        **** #else
 600:main.c        ****  #define SEG_STRETCH 5 //(((NUM_PSEGS-6)+RB_WIDTH-1)/RB_WIDTH)
 601:main.c        **** #endif
 602:main.c        **** 	//3-5 = white + cyan
 603:main.c        **** 	//6 = letters alternating with above
 604:main.c        **** 	//7-9 = ditto, stretched
 605:main.c        **** 
 606:main.c        **** #define TET_VSTRETCH	16
 607:main.c        **** 	if(rowNum == 0)
 608:main.c        **** 	{
 609:main.c        **** 		//Probably not best to put this here, as we're still in the interrupt
 610:main.c        **** 		// extra-long calculations might cause syncing issues with displays
 611:main.c        **** 		// that require rows to be a constant time
 612:main.c        **** 		tetUpdate();
 613:main.c        **** 	}
 614:main.c        **** 	if(rowNum % TET_VSTRETCH == 0)
 615:main.c        **** 	{
 616:main.c        **** 		uint8_t i;
 617:main.c        **** 		for(i=0; i<RB_WIDTH; i++)
 618:main.c        **** 			rowBuffer[i] = fb_to_rb(_K);
 619:main.c        **** 		//	rowBuffer[i] = fb_to_rb((i+rowNum/TET_VSTRETCH)&0x3f);
 620:main.c        **** 		
 621:main.c        **** 		tet_drawRow(rowNum/TET_VSTRETCH, rowBuffer);
 622:main.c        **** 	}
 623:main.c        **** 	segClear();
 624:main.c        **** 
 625:main.c        **** 	//Good for syncing to have white on both borders...
 626:main.c        **** 	newSeg(3, 0x06, (6<<4) | 3);
 627:main.c        **** 	
 628:main.c        **** 	uint16_t i;
 629:main.c        **** 	//TET_OVERLAY alternates rows between the TETRIS board and
 630:main.c        **** 	// an rgb "gradient" The only purpose is to test the idea of
 631:main.c        **** 	// using the high vertical-resolution to essentially increase the
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 177


 632:main.c        **** 	// number of colors available to a low-resolution image
 633:main.c        **** 	// sort of like "dithering" in the ol' days of 256 colors in Windows
 634:main.c        **** 	// but easy to implement in this case with very little overhead 
 635:main.c        **** 	// row-by-row
 636:main.c        **** 	// The effect, from a ways back, looks like the colors are blended
 637:main.c        **** 	// (like the Text and Game-board are translucent)
 638:main.c        **** #define TET_OVERLAY TRUE
 639:main.c        **** 
 640:main.c        **** 	//TET_GRADIENT takes that a step further and attempts to create a
 641:main.c        **** 	// gradient between each color in that rgb-gradient.
 642:main.c        **** 	// It's not as pretty as I'd hoped... though it makes sense...
 643:main.c        **** 	// first we're alternating between TET's color and the background color
 644:main.c        **** 	// then the background color is (roughly) alternating between a couple
 645:main.c        **** 	// colors, several rows between...
 646:main.c        **** 	// so if a color is stretched 16 rows vertically, that only leaves 8
 647:main.c        **** 	// rows for the color-gradient... might work better over more gradual
 648:main.c        **** 	// color-changes
 649:main.c        **** #define TET_GRADIENT TRUE
 650:main.c        **** 
 651:main.c        **** #if (defined(TET_OVERLAY) && TET_OVERLAY)
 652:main.c        **** 	if(rowNum & 0x01)
 653:main.c        **** 	{
 654:main.c        **** #endif
 655:main.c        **** 	for(i=0; i<RB_WIDTH; i++)
 656:main.c        **** 	{
 657:main.c        **** 		//i+1 because we don't want to overwrite the white border...
 658:main.c        **** 		rbpix_to_seg(rowBuffer[i], i+1, SEG_STRETCH);
 659:main.c        **** 	}
 660:main.c        **** 
 661:main.c        **** #if (defined(TET_OVERLAY) && TET_OVERLAY)
 662:main.c        **** 	}
 663:main.c        **** 	else
 664:main.c        **** 	{
 665:main.c        **** 		#define ROWS_PER 64//(V_COUNT/NUM_COLORS)
 666:main.c        **** 
 667:main.c        **** 		uint8_t fbColor;
 668:main.c        **** 
 669:main.c        **** #if (defined(TET_GRADIENT) && TET_GRADIENT)
 670:main.c        **** 		static hfm_t hfmGradient;
 671:main.c        **** 		if(rowNum%ROWS_PER == 0)
 672:main.c        **** 			hfm_setup(&hfmGradient, 0, ROWS_PER/2-4);
 673:main.c        **** 
 674:main.c        **** 		//It's worth it to experiment with changing the range of the 
 675:main.c        **** 		// hfmGradient, ('-4' above and '+4' below).
 676:main.c        **** 		// to try to avoid one or two stray spikes
 677:main.c        **** 		// (e.g. power = 1, maxPower = 15, there'll be one bright row
 678:main.c        **** 		//  and 14 dark, it sticks out like a sore-thumb)
 679:main.c        **** 		//  These values are experimental, and entirely dependent on the
 680:main.c        **** 		//  values used...
 681:main.c        **** 
 682:main.c        **** 		hfm_setPower(&hfmGradient, (rowNum/2)%(ROWS_PER/2)+4);
 683:main.c        **** 
 684:main.c        **** 		if(hfm_nextOutput(&hfmGradient))
 685:main.c        **** 			fbColor = rgbGradient(ROWS_PER-1 - rowNum/(ROWS_PER)+16-1);
 686:main.c        **** 		else
 687:main.c        **** #endif	//TET_GRADIENT
 688:main.c        **** 			fbColor = rgbGradient(ROWS_PER-1 - rowNum/(ROWS_PER)+16);
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 178


 689:main.c        **** 
 690:main.c        **** 		addSegfb(RB_WIDTH*SEG_STRETCH, (fbColor));
 691:main.c        **** 		//newSeg(SEG_STRETCH, fb_to_seg((rowNum*64/768)&0x3f));
 692:main.c        **** 
 693:main.c        **** 	}
 694:main.c        **** #endif	//TET_OVERLAY
 695:main.c        **** 	//white...
 696:main.c        **** 	newSeg(3, 0x06, (6<<4) | 3);
 697:main.c        **** 	segTerminate();
 698:main.c        ****  #elif (defined(SEG_GRADIENT) && SEG_GRADIENT)
 699:main.c        **** 	static hfm_t hfmGradient;
 700:main.c        **** #define ROWS_PER	(255)	//(V_COUNT/3) == 256
 701:main.c        **** 
 702:main.c        **** 	if(rowNum%ROWS_PER == 0)
 703:main.c        **** 		hfm_setup(&hfmGradient, 0, ROWS_PER);
 704:main.c        **** 
 705:main.c        **** 	uint8_t color;
 706:main.c        **** 
 707:main.c        **** 	uint16_t power;
 708:main.c        **** 
 709:main.c        **** 	if(rowNum < ROWS_PER/16)
 710:main.c        **** 		rowNum = 0;
 711:main.c        **** 	else
 712:main.c        **** 		rowNum -= ROWS_PER/16;
 713:main.c        **** 
 714:main.c        **** 	//Since there are four shades, there will be three gradients...
 715:main.c        **** 	if(rowNum < ROWS_PER)
 716:main.c        **** 	{
 717:main.c        **** 		//The ROWS_PER/16 stuff is to help alleviate sharp color-spikes
 718:main.c        **** 		// which occur early-on... see the explanation in SEG_TET.
 719:main.c        **** 		color = 0;
 720:main.c        **** 		//hfm_setPower(&hfmGradient, 
 721:main.c        **** 		power = (rowNum); // + ROWS_PER/16);
 722:main.c        **** 	}
 723:main.c        **** 	else if(rowNum < ROWS_PER*2)
 724:main.c        **** 	{
 725:main.c        **** 		color = 1;
 726:main.c        **** 		//hfm_setPower(&hfmGradient, 
 727:main.c        **** 		power = rowNum-(ROWS_PER); // + ROWS_PER/16;
 728:main.c        **** 	}
 729:main.c        **** 	else
 730:main.c        **** 	{
 731:main.c        **** 		color = 2;
 732:main.c        **** 		//hfm_setPower(&hfmGradient, 
 733:main.c        **** 		power = rowNum-(ROWS_PER*2); // + ROWS_PER/16;
 734:main.c        **** 	}
 735:main.c        **** 
 736:main.c        **** 
 737:main.c        **** 	if(power < ROWS_PER/16)
 738:main.c        **** 		power = 0;
 739:main.c        **** 
 740:main.c        **** 	hfm_setPower(&hfmGradient, (power <= 255) ? power : 255);
 741:main.c        **** 
 742:main.c        **** 	if(hfm_nextOutput(&hfmGradient))
 743:main.c        **** 		color++;
 744:main.c        **** 
 745:main.c        **** 	color |= color<<2 | color<<4;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 179


 746:main.c        **** 
 747:main.c        **** 	segClear();
 748:main.c        **** 	addSegfb(3, _W);
 749:main.c        **** 	addSegfb(NUM_PSEGS-6, color); 
 750:main.c        **** 	addSegfb(3, _W);
 751:main.c        **** 	segTerminate();
 752:main.c        ****  #elif(defined(SEG_GRADIENT2) && SEG_GRADIENT2)
 753:main.c        ****    #error "Heh, never did implement this..."
 754:main.c        ****  #else
 755:main.c        **** 	#error "Gotta select a SEG_... option, or create your own"
 756:main.c        ****  #endif //SEG_ selection
 757:main.c        **** #elif (defined(ROW_BUFFER) && (ROW_BUFFER))
 758:main.c        **** 
 759:main.c        **** //This is a *really* simple test for ROW_BUFFER
 760:main.c        **** // It just cycles through the colors in diagonal stripes...
 761:main.c        **** // Technically each color should be 16 pixels high, but it appears to be
 762:main.c        **** // coming through much taller. Certainly this is display-specific
 763:main.c        **** // timing-related issues... (This display is known to repeat rows when not
 764:main.c        **** // syncing correctly)
 765:main.c        **** // First-guess is ROW_CALCULATION_CYCS isn't right, but higher values is
 766:main.c        **** // causing syncing problems.
 767:main.c        **** // TODO, I guess.
 768:main.c        **** 	uint16_t col;
 769:main.c        **** 	for(col=0; col<RB_WIDTH; col++)
 770:main.c        **** 		rowBuffer[col] = fb_to_rb((col+rowNum)&0x3f);
 771:main.c        **** 		//rowBuffer[col] = fb_to_rb((col+rowNum/16)&0x3f);
 772:main.c        **** 
 773:main.c        **** #endif //ROW_SEG_BUFFER
 774:main.c        **** }
 775:main.c        **** #endif //LOAD_ROW
 776:main.c        **** 
 777:main.c        **** #include "hsyncTimerStuff.c"
 778:main.c        **** 
 779:main.c        **** 
 780:main.c        **** #if (!defined(EXTERNAL_DRAWPIX) || !EXTERNAL_DRAWPIX)
 781:main.c        **** #if (defined(ROW_SEG_BUFFER) && ROW_SEG_BUFFER)
 782:main.c        **** void drawPix(uint16_t rowNum)
 783:main.c        **** {
 784:main.c        **** 	//Note that rowNum isn't really used here...
 785:main.c        **** 	// and it's only a uint8_t!
 786:main.c        **** 	rsb_drawPix(rowNum);
 787:main.c        **** }
 788:main.c        **** 
 789:main.c        **** #elif (defined(BLUE_ADC) && BLUE_ADC)
 790:main.c        **** //This is pretty much identical to most of the BLUE_TESTING in lcdStuff.c
 791:main.c        **** // with a slight twist...
 792:main.c        **** static __inline__ void drawPix(uint16_t rowNum)
 793:main.c        **** {
 794:main.c        ****       //uint16_t blueCyc = DOTS_TO_CYC(rowNum);
 795:main.c        ****       //uint16_t notBlueCyc = DOTS_TO_CYC(DE_ACTIVE_DOTS)-blueCyc;
 796:main.c        **** 		adc_startConversion();
 797:main.c        **** 		while(adc_isBusy())
 798:main.c        **** 			asm("nop;");
 799:main.c        **** 
 800:main.c        ****       uint16_t blueDots = adc_getValue();
 801:main.c        ****       uint16_t notBlueDots = DE_ACTIVE_DOTS - blueDots;
 802:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 180


 803:main.c        ****       DEonly_fromNada();
 804:main.c        ****       //delay_cyc(notBlueCyc);
 805:main.c        ****       //delay_Dots(notBlueDots);
 806:main.c        ****       DE_DotDelay(notBlueDots);
 807:main.c        ****       DEblue_fromDEonly();
 808:main.c        ****       //delay_cyc(blueCyc);
 809:main.c        ****       //delay_Dots(blueDots);
 810:main.c        ****       DE_DotDelay(blueDots);
 811:main.c        ****       Nada_fromDEblue();
 812:main.c        **** }
 813:main.c        **** 
 814:main.c        **** #elif (defined(BLUE_AND_COLORS) && BLUE_AND_COLORS)
 815:main.c        **** // This draws four colors on the screen, black, red, blue, and cyan
 816:main.c        **** // in order to test the other colors (red and green)
 817:main.c        **** static __inline__ void drawPix(uint16_t rowNum)
 818:main.c        **** {
 819:main.c        **** 	//DE_ACTIVE_DELAYABLE attempts to take into account the overhead of
 820:main.c        **** 	//DE_DotDelay, setColors(), etc...
 821:main.c        **** 	//It's entirely arbitrary, and dependent on CPU speed (PLL_SYSCLK)
 822:main.c        **** 	// and many other factors...
 823:main.c        **** #if(defined(PLL_SYSCLK) && PLL_SYSCLK)
 824:main.c        ****  #define DE_ACTIVE_DELAYABLE	(DE_ACTIVE_DOTS-100)
 825:main.c        **** 		//Attempting to stretch the diagonal from corner-to-corner...
 826:main.c        **** 		uint16_t blueDots = (uint32_t)DE_ACTIVE_DELAYABLE * (uint32_t)rowNum
 827:main.c        **** 		  										/ V_COUNT;
 828:main.c        **** #else
 829:main.c        **** 		//Because, I guess, the math is too long without PLL_SYSCLK
 830:main.c        **** 		// since it's not syncing
 831:main.c        ****  #define DE_ACTIVE_DELAYABLE	(DE_ACTIVE_DOTS-200)
 832:main.c        **** 		uint16_t blueDots = rowNum;
 833:main.c        **** #endif
 834:main.c        **** 		uint16_t notBlueDots = DE_ACTIVE_DELAYABLE - blueDots;
 835:main.c        **** 
 836:main.c        **** 		uint16_t halfNotBlueDots = notBlueDots/2;
 837:main.c        **** 
 838:main.c        **** 		uint16_t halfBlueDots = blueDots/2;
 839:main.c        **** 
 840:main.c        **** 
 841:main.c        **** 		//fullRed(), noRed(), fullGreen(), and noGreen()
 842:main.c        **** 		// function differently than the DEblue...() functions.
 843:main.c        **** 		// Since "blue" is shared with the timing-signals,
 844:main.c        **** 		// changing a blue-value requires keeping in mind the previous and
 845:main.c        **** 		// next states of the timing (usually DE-active in all cases, but not
 846:main.c        **** 		// always).
 847:main.c        **** 		// Changing of the "red" and "green" signals is easier, since
 848:main.c        **** 		// doing-so doesn't affect anything else.
 849:main.c        **** 
 850:main.c        **** 		DEonly_fromNada();
 851:main.c        **** 
 852:main.c        **** 		//Black
 853:main.c        **** 		DE_DotDelay(halfNotBlueDots);
 854:main.c        **** 		
 855:main.c        **** 		//Red
 856:main.c        **** 		fullRed();
 857:main.c        **** 		DE_DotDelay(halfNotBlueDots);
 858:main.c        **** 
 859:main.c        **** 		//Blue
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 181


 860:main.c        **** 		noRed();
 861:main.c        **** 		DEblue_fromDEonly();
 862:main.c        **** 		
 863:main.c        **** 		DE_DotDelay(halfBlueDots);
 864:main.c        **** 
 865:main.c        **** 		//Cyan
 866:main.c        **** 		fullGreen();
 867:main.c        **** 		
 868:main.c        **** 		DE_DotDelay(halfBlueDots);
 869:main.c        **** 
 870:main.c        **** 		noGreen();
 871:main.c        **** 		Nada_fromDEblue();
 872:main.c        **** }
 873:main.c        **** #elif (defined(BLUE_ALLSHADES) && BLUE_ALLSHADES)
 874:main.c        **** //This is an attempt at showing all available shades of blue
 875:main.c        **** // Originally it was determined that 11 shades could be shown
 876:main.c        **** // but there seems to be some trouble with using wrap-around values
 877:main.c        **** // (e.g. when reset occurs before set in the count)
 878:main.c        **** // It works fine when it's the *only* shade shown, but if shown with other
 879:main.c        **** // shades on the screen, it causes syncing problems
 880:main.c        **** // So, it's been determined that there are basically four discernable
 881:main.c        **** // shades of blue which are usable with the PWM161
 882:main.c        **** //
 883:main.c        **** // The original idea: BLUE_ALLSHADES=TRUE, ALLSHADES_GRADIENT=FALSE
 884:main.c        **** //  would fade the screen from black to bright blue
 885:main.c        **** //  (it makes use of the wraparound-values)
 886:main.c        **** // Then ALLSHADES_GRADIENT would display them all on the screen at once
 887:main.c        **** // 
 888:main.c        **** // It's since been somewhat hacked, to disable the unstable wrap-around
 889:main.c        **** // values...
 890:main.c        **** // Then ALLSHADES_AND_COLORS was added, to show all usable colors
 891:main.c        **** // This's gotten a bit bloated, and would probably be better-implemented as
 892:main.c        **** // several different BLUE_WHATEVERs
 893:main.c        **** static __inline__ void drawPix(uint16_t rowNum)
 894:main.c        **** {
 895:main.c        **** #define BLUESHADES_MAX 11
 896:main.c        **** 		
 897:main.c        **** #if(!defined(ALLSHADES_GRADIENT) || !ALLSHADES_GRADIENT)
 898:main.c        ****  #define DOTSPERSHADE (DE_ACTIVE_DOTS) ///BLUESHADES_MAX)
 899:main.c        **** 		static uint8_t frameCount = 0;
 900:main.c        **** 		static uint8_t shadeNum = 0;
 901:main.c        **** 
 902:main.c        **** 		if(rowNum == 0)
 903:main.c        **** 			frameCount++;
 904:main.c        **** 
 905:main.c        **** 		if(frameCount == 60)
 906:main.c        **** 		{
 907:main.c        **** 			frameCount = 0;
 908:main.c        **** 			shadeNum++;
 909:main.c        **** 			if(shadeNum >= BLUESHADES_MAX)
 910:main.c        **** 				shadeNum = 0;
 911:main.c        **** 		}
 912:main.c        **** #else
 913:main.c        ****  #if(defined(ALLSHADES_AND_COLORS) && ALLSHADES_AND_COLORS)
 914:main.c        **** 		setRed4(4*rowNum/V_COUNT);
 915:main.c        **** 		setGreen4((16*rowNum/V_COUNT)%4);
 916:main.c        **** 		/*
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 182


 917:main.c        **** 		//K, R, G, Y
 918:main.c        **** 		if(rowNum < V_COUNT/4)
 919:main.c        **** 		{
 920:main.c        **** 			noRed();
 921:main.c        **** 			noGreen();
 922:main.c        **** 		}
 923:main.c        **** 		else if(rowNum < 2*V_COUNT/4)
 924:main.c        **** 		{
 925:main.c        **** 			fullRed();
 926:main.c        **** 			noGreen();
 927:main.c        **** 		}
 928:main.c        **** 		else if(rowNum < 3*V_COUNT/4)
 929:main.c        **** 		{
 930:main.c        **** 			fullGreen();
 931:main.c        **** 			noRed();
 932:main.c        **** 		}
 933:main.c        **** 		else
 934:main.c        **** 		{
 935:main.c        **** 			fullGreen();
 936:main.c        **** 			fullRed();
 937:main.c        **** 		}
 938:main.c        **** 		*/
 939:main.c        ****  #endif
 940:main.c        ****  //Add a little bit of extra delay for calculations...
 941:main.c        ****  #define START_SHADE 0//10 //5 //10
 942:main.c        ****  #define END_SHADE   10//0 //7 //10 //0
 943:main.c        **** 
 944:main.c        ****  #define SHADE_DIR_SIGN ((END_SHADE > START_SHADE) ? +1 : -1)
 945:main.c        ****  #define NUM_SHADES  (((SHADE_DIR_SIGN > 0) ? (END_SHADE-START_SHADE) \
 946:main.c        **** 			 :(START_SHADE-END_SHADE))+1)
 947:main.c        **** 
 948:main.c        **** // Weird... with +0, syncing is way-off (such that the red/green doesn't
 949:main.c        **** // come through *at all*
 950:main.c        **** // and so-forth.
 951:main.c        ****  #define DOTSPERSHADE (DE_ACTIVE_DOTS/(NUM_SHADES+15))
 952:main.c        **** 		int8_t shadeNum;
 953:main.c        **** 
 954:main.c        **** 		DEonly_init();
 955:main.c        **** 
 956:main.c        **** 		for(shadeNum=START_SHADE; shadeNum != (END_SHADE+SHADE_DIR_SIGN);
 957:main.c        **** 				shadeNum+=SHADE_DIR_SIGN)
 958:main.c        **** 		{
 959:main.c        **** 
 960:main.c        **** #endif
 961:main.c        **** 		uint8_t ocr2sa_val;
 962:main.c        **** 		uint8_t ocr2ra_val;
 963:main.c        **** 
 964:main.c        **** 		//Black
 965:main.c        **** //		DE_DotDelay(DOTSPERSHADE);
 966:main.c        **** 
 967:main.c        **** 		//The commented-out cases are those that require wrapping
 968:main.c        **** 		// (e.g. "set" occurs *after* "reset")
 969:main.c        **** 		// They don't seem to work too well, when switching back and forth
 970:main.c        **** /*		switch(shadeNum)
 971:main.c        **** 		{
 972:main.c        **** 			//Black	//these're from DEonly_init();
 973:main.c        **** 			case 0:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 183


 974:main.c        **** 				ocr2sa_val = 1;
 975:main.c        **** 				ocr2ra_val = 4;
 976:main.c        **** 				break;
 977:main.c        **** 			case 1:
 978:main.c        **** 				//4:
 979:main.c        **** 				ocr2sa_val = 0;
 980:main.c        **** 				ocr2ra_val = 4;	
 981:main.c        **** 				break;
 982:main.c        **** //			case 2:
 983:main.c        **** //				//12:
 984:main.c        **** //				ocr2sa_val = 6;
 985:main.c        **** //				ocr2ra_val = 4;	
 986:main.c        **** //				break;
 987:main.c        **** //			case 3:
 988:main.c        **** //				//28:
 989:main.c        **** //				ocr2sa_val = 5;
 990:main.c        **** //				ocr2ra_val = 4;	
 991:main.c        **** //				break;
 992:main.c        **** 			case 2:
 993:main.c        **** 				//32:
 994:main.c        **** 				ocr2sa_val = 1;
 995:main.c        **** 				ocr2ra_val = 5;	
 996:main.c        **** 				break;
 997:main.c        **** 			case 3:
 998:main.c        **** 				//36:
 999:main.c        **** 				ocr2sa_val = 0;
1000:main.c        **** 				ocr2ra_val = 5;	
1001:main.c        **** 				break;
1002:main.c        **** //			case 6:
1003:main.c        **** //				//44:
1004:main.c        **** //				ocr2sa_val = 6;
1005:main.c        **** //				ocr2ra_val = 5;	
1006:main.c        **** //				break;
1007:main.c        **** 			case 4:
1008:main.c        **** 				//48:
1009:main.c        **** 				ocr2sa_val = 1;
1010:main.c        **** 				ocr2ra_val = 6;	
1011:main.c        **** 				break;
1012:main.c        **** 			case 5:
1013:main.c        **** 				//52:
1014:main.c        **** 				ocr2sa_val = 0;
1015:main.c        **** 				ocr2ra_val = 6;	
1016:main.c        **** 				break;
1017:main.c        **** //			case 9:
1018:main.c        **** //				//56:
1019:main.c        **** //				ocr2sa_val = 1;
1020:main.c        **** //				ocr2ra_val = 0;	
1021:main.c        **** //				break;
1022:main.c        **** 			default:
1023:main.c        **** 				//60:
1024:main.c        **** 				ocr2sa_val = 0;
1025:main.c        **** 				ocr2ra_val = 8;	//7 dun woik... all-low
1026:main.c        **** 				break;
1027:main.c        **** 		}
1028:main.c        **** 
1029:main.c        **** 		//DEonly_fromNada();
1030:main.c        **** 	
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 184


1031:main.c        **** 		//setbit(PLOCK2, PCNF2);
1032:main.c        **** 
1033:main.c        **** 		lockPSC2();
1034:main.c        **** 		OCR2SAL = ocr2sa_val;
1035:main.c        **** 		OCR2RAL = ocr2ra_val;
1036:main.c        **** 		unlockPSC2();
1037:main.c        **** 		//clrbit(PLOCK2, PCNF2);
1038:main.c        **** */
1039:main.c        **** 		uint8_t newShade = shadeNum; //rowNum*64/V_COUNT) % NUM_SHADES;
1040:main.c        **** 
1041:main.c        **** 		if(newShade <= 3)			//0, 1, 2, 3
1042:main.c        **** 			newShade = newShade;
1043:main.c        **** 		else if(newShade <= 6)   //4->2, 5->1, 6->0
1044:main.c        **** 			newShade = (6-newShade);
1045:main.c        **** 		else
1046:main.c        **** 			newShade = 3;
1047:main.c        **** 
1048:main.c        **** 		setBlue4(newShade);
1049:main.c        **** 
1050:main.c        **** 		DE_DotDelay(DOTSPERSHADE);
1051:main.c        **** 
1052:main.c        **** #if(defined(ALLSHADES_GRADIENT) && ALLSHADES_GRADIENT)
1053:main.c        **** 		}
1054:main.c        ****  #if(defined(ALLSHADES_AND_COLORS) && ALLSHADES_AND_COLORS)
1055:main.c        **** 		setRed4(0); //4*rowNum/V_COUNT);
1056:main.c        **** 		setGreen4(0); //(16*rowNum/V_COUNT)%4);
1057:main.c        ****  #endif
1058:main.c        **** #endif
1059:main.c        **** 		Nada_init(); //fromDEblue();
1060:main.c        **** }
1061:main.c        **** 
1062:main.c        **** #elif (defined(PWM_TESTING) && PWM_TESTING)
1063:main.c        **** 	//No drawPix necessary...
1064:main.c        **** 
1065:main.c        **** #else
1066:main.c        **** #if 0
1067:main.c        **** #define drawPix nonRSB_drawPix
1068:main.c        **** #else
1069:main.c        **** //#include "_options/writeColor.c"
1070:main.c        **** //#include "nonRSB_drawPix.c"
1071:main.c        **** static __inline__ void drawPix(uint16_t rowNum)
1072:main.c        **** {
1073:main.c        **** 	//a/o v70, it's in use again for ROW_BUFFER.
1074:main.c        **** 	//a/o v67, this is used by FRAMEBUFFER_TESTING...
1075:main.c        **** 	//Old:
1076:main.c        **** 	//This hasn't been used in quite some time... 
1077:main.c        **** 	// it may not work at all anymore.
1078:main.c        **** 	nonRSB_drawPix(rowNum);
1079:main.c        **** }
1080:main.c        **** #endif
1081:main.c        **** #endif
1082:main.c        **** #endif
1083:main.c        **** 
1084:main.c        **** 
1085:main.c        **** uint8_t isNewFrame(void)
1086:main.c        **** {
1087:main.c        **** 	uint8_t newFrame = FALSE;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 185


1088:main.c        **** 
1089:main.c        **** 	static uint8_t lastFrameCount = 0;
1090:main.c        **** #define FRAME_COUNT_LIMIT 0x03
1091:main.c        **** 	uint8_t thisFrameCount = frameCount&FRAME_COUNT_LIMIT;
1092:main.c        **** 
1093:main.c        **** //		if(( (thisFrameCount==0) && (lastFrameCount==FRAME_COUNT_LIMIT) ))
1094:main.c        **** 	if(thisFrameCount != lastFrameCount)
1095:main.c        **** 		newFrame = TRUE;
1096:main.c        **** 
1097:main.c        **** 	lastFrameCount = thisFrameCount;
1098:main.c        **** 
1099:main.c        **** 	return newFrame;
1100:main.c        **** }
1101:main.c        **** 
1102:main.c        **** 
1103:main.c        **** 
1104:main.c        **** #if(defined(FB_REFRESH_ON_CHANGE) && FB_REFRESH_ON_CHANGE)
1105:main.c        **** //For FB_QUESTION, FB_SMILEY, etc. it might be nice to only refresh when 
1106:main.c        **** // the actual image changes...
1107:main.c        **** // This is revisited from _unusedIdeas/frameCountToDelay.c
1108:main.c        **** void endOfFrameHandler(void)
1109:main.c        **** {
1110:main.c        **** 	//The original plan was to stop the timer, but now that is used by
1111:main.c        **** 	//dmsTimer... so instead:
1112:main.c        **** 	if(updateFrame)
 3421               		.stabn	68,0,1112,.LM384-.LFBB22
 3422               	.LM384:
 3423 0bb2 8091 0000 		lds r24,updateFrame
 3424 0bb6 8823      		tst r24
 3425 0bb8 01F0      		breq .L192
1113:main.c        **** 		updateFrame--; //= FALSE;
 3426               		.stabn	68,0,1113,.LM385-.LFBB22
 3427               	.LM385:
 3428 0bba 8091 0000 		lds r24,updateFrame
 3429 0bbe 8150      		subi r24,lo8(-(-1))
 3430 0bc0 8093 0000 		sts updateFrame,r24
 3431               	.L192:
1114:main.c        **** 
1115:main.c        **** 	//The sony display seems to dislike not having a dot-clock...
1116:main.c        **** 	// This is an experiment...
1117:main.c        ****   #if (defined(LCDINTERFACE_BITBANGED_DOTCLOCK_PWM) && \
1118:main.c        **** 		  LCDINTERFACE_BITBANGED_DOTCLOCK_PWM)
1119:main.c        **** 	if(!updateFrame)
 3432               		.stabn	68,0,1119,.LM386-.LFBB22
 3433               	.LM386:
 3434 0bc4 8091 0000 		lds r24,updateFrame
 3435 0bc8 8111      		cpse r24,__zero_reg__
 3436 0bca 00C0      		rjmp .L188
 3437               	.LBB305:
 3438               	.LBB306:
 3439               		.stabs	"./_interfaces/6bitParallel.c",132,0,0,.Ltext29
 3440               	.Ltext29:
 311:./_interfaces/6bitParallel.c **** 
 3441               		.stabn	68,0,311,.LM387-.LFBB22
 3442               	.LM387:
 3443 0bcc 83E0      		ldi r24,lo8(3)
 3444 0bce 8BBD      		out 0x2b,r24
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 186


 321:./_interfaces/6bitParallel.c **** 
 3445               		.stabn	68,0,321,.LM388-.LFBB22
 3446               	.LM388:
 3447 0bd0 81E0      		ldi r24,lo8(1)
 3448 0bd2 8CBD      		out 0x2c,r24
 324:./_interfaces/6bitParallel.c **** 			            ((1<<CS13) | (1<<CS12) | (1<<CS11) | (1<<CS10)),
 3449               		.stabn	68,0,324,.LM389-.LFBB22
 3450               	.LM389:
 3451 0bd4 8FB5      		in r24,0x2f
 3452 0bd6 807F      		andi r24,lo8(-16)
 3453 0bd8 8160      		ori r24,lo8(1)
 3454 0bda 8FBD      		out 0x2f,r24
 330:./_interfaces/6bitParallel.c **** 			            ((1<<DTPS11) | (1<<DTPS10)),
 3455               		.stabn	68,0,330,.LM390-.LFBB22
 3456               	.LM390:
 3457 0bdc 8FB5      		in r24,0x2f
 3458 0bde 8F7C      		andi r24,lo8(-49)
 3459 0be0 8FBD      		out 0x2f,r24
 335:./_interfaces/6bitParallel.c **** 	            ((1<<WGM11) | (1<<WGM10)), // (affects all PWM channels)
 3460               		.stabn	68,0,335,.LM391-.LFBB22
 3461               	.LM391:
 3462 0be2 86B5      		in r24,0x26
 3463 0be4 8C7F      		andi r24,lo8(-4)
 3464 0be6 86BD      		out 0x26,r24
 341:./_interfaces/6bitParallel.c **** 					(1<<COM1B1) | (1<<COM1B0),
 3465               		.stabn	68,0,341,.LM392-.LFBB22
 3466               	.LM392:
 3467 0be8 80B7      		in r24,0x30
 3468 0bea 8F7C      		andi r24,lo8(-49)
 3469 0bec 8062      		ori r24,lo8(32)
 3470 0bee 80BF      		out 0x30,r24
 346:./_interfaces/6bitParallel.c **** 
 3471               		.stabn	68,0,346,.LM393-.LFBB22
 3472               	.LM393:
 3473 0bf0 80B7      		in r24,0x30
 3474 0bf2 8160      		ori r24,lo8(1)
 3475 0bf4 80BF      		out 0x30,r24
 3476               	.L188:
 3477               	/* epilogue start */
 3478               	.LBE306:
 3479               	.LBE305:
 3480               	.LBE304:
 3481               	.LBE303:
 3482               		.stabs	"main.c",132,0,0,.Ltext30
 3483               	.Ltext30:
 518:main.c        **** #endif //!PWM_TESTING
 3484               		.stabn	68,0,518,.LM394-.LFBB22
 3485               	.LM394:
 3486 0bf6 FF91      		pop r31
 3487 0bf8 EF91      		pop r30
 3488 0bfa BF91      		pop r27
 3489 0bfc AF91      		pop r26
 3490 0bfe 9F91      		pop r25
 3491 0c00 8F91      		pop r24
 3492 0c02 7F91      		pop r23
 3493 0c04 6F91      		pop r22
 3494 0c06 5F91      		pop r21
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 187


 3495 0c08 4F91      		pop r20
 3496 0c0a 3F91      		pop r19
 3497 0c0c 2F91      		pop r18
 3498 0c0e 0F90      		pop r0
 3499 0c10 0FBE      		out __SREG__,r0
 3500 0c12 0F90      		pop r0
 3501 0c14 1F90      		pop r1
 3502 0c16 1895      		reti
 3503               		.size	__vector_14, .-__vector_14
 3504               	.Lscope22:
 3505               		.stabs	"",36,0,0,.Lscope22-.LFBB22
 3506               		.stabd	78,0,0
 3507               		.stabs	"init_hsyncTimer:F(0,47)",36,0,25,init_hsyncTimer
 3508               	.global	init_hsyncTimer
 3509               		.type	init_hsyncTimer, @function
 3510               	init_hsyncTimer:
 3511               		.stabd	46,0,0
 3512               		.stabs	"hsyncTimerStuff.c",132,0,0,.Ltext31
 3513               	.Ltext31:
   1:hsyncTimerStuff.c **** /* mehPL:
   2:hsyncTimerStuff.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:hsyncTimerStuff.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:hsyncTimerStuff.c ****  *    Please see the bottom.
   5:hsyncTimerStuff.c ****  *    Enjoy!
   6:hsyncTimerStuff.c ****  */
   7:hsyncTimerStuff.c **** 
   8:hsyncTimerStuff.c **** 
   9:hsyncTimerStuff.c **** 
  10:hsyncTimerStuff.c **** 
  11:hsyncTimerStuff.c **** 
  12:hsyncTimerStuff.c **** 
  13:hsyncTimerStuff.c **** 
  14:hsyncTimerStuff.c **** 
  15:hsyncTimerStuff.c **** 
  16:hsyncTimerStuff.c **** 
  17:hsyncTimerStuff.c **** //hsyncTimer is used for timing each LCD row.
  18:hsyncTimerStuff.c **** // Please see hsyncTimerStuff.h for implementation notes.
  19:hsyncTimerStuff.c **** 
  20:hsyncTimerStuff.c **** #include "hsyncTimerStuff.h"
  21:hsyncTimerStuff.c **** 
  22:hsyncTimerStuff.c **** //Testing with values returned by hsyncTimerCalculator
  23:hsyncTimerStuff.c **** //#define HSYNC_TIMER_OCRVAL	65
  24:hsyncTimerStuff.c **** 
  25:hsyncTimerStuff.c **** void init_hsyncTimer(void)
  26:hsyncTimerStuff.c **** {
 3514               		.stabn	68,0,26,.LM395-.LFBB23
 3515               	.LM395:
 3516               	.LFBB23:
 3517               	/* prologue: function */
 3518               	/* frame size = 0 */
 3519               	/* stack size = 0 */
 3520               	.L__stack_usage = 0
  27:hsyncTimerStuff.c ****    HSYNC_TIMER_OCR = HSYNC_TIMER_OCRVAL; 
 3521               		.stabn	68,0,27,.LM396-.LFBB23
 3522               	.LM396:
 3523 0c18 87E8      		ldi r24,lo8(-121)
 3524 0c1a 83BB      		out 0x13,r24
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 188


  28:hsyncTimerStuff.c **** 							//T_Hlow_CYC + T_HD_CYC + T_DE_CYC + T_DH_CYC;
  29:hsyncTimerStuff.c ****    timer_setWGM(HSYNC_TIMER_NUM, WGM_CLR_ON_COMPARE);
 3525               		.stabn	68,0,29,.LM397-.LFBB23
 3526               	.LM397:
 3527 0c1c 62E0      		ldi r22,lo8(2)
 3528 0c1e 80E0      		ldi r24,0
 3529 0c20 00D0      		rcall timer_setWGM
  30:hsyncTimerStuff.c ****    timer_selectDivisor(HSYNC_TIMER_NUM, HSYNC_TIMER_CLKDIV); //CLKDIV1);
 3530               		.stabn	68,0,30,.LM398-.LFBB23
 3531               	.LM398:
 3532 0c22 63E0      		ldi r22,lo8(3)
 3533 0c24 80E0      		ldi r24,0
 3534 0c26 00D0      		rcall timer_selectDivisor
  31:hsyncTimerStuff.c ****    timer_compareMatchIntEnable(HSYNC_TIMER_NUM, OUT_CHANNELA);
 3535               		.stabn	68,0,31,.LM399-.LFBB23
 3536               	.LM399:
 3537 0c28 41E0      		ldi r20,lo8(1)
 3538 0c2a 60E0      		ldi r22,0
 3539 0c2c 80E0      		ldi r24,0
 3540 0c2e 00C0      		rjmp timer_compareMatchIntSetup
 3541               		.size	init_hsyncTimer, .-init_hsyncTimer
 3542               	.Lscope23:
 3543               		.stabs	"",36,0,0,.Lscope23-.LFBB23
 3544               		.stabd	78,0,0
 3545               		.stabs	"isNewFrame:F(4,2)",36,0,1085,isNewFrame
 3546               	.global	isNewFrame
 3547               		.type	isNewFrame, @function
 3548               	isNewFrame:
 3549               		.stabd	46,0,0
 3550               		.stabs	"main.c",132,0,0,.Ltext32
 3551               	.Ltext32:
1086:main.c        **** 	uint8_t newFrame = FALSE;
 3552               		.stabn	68,0,1086,.LM400-.LFBB24
 3553               	.LM400:
 3554               	.LFBB24:
 3555               	/* prologue: function */
 3556               	/* frame size = 0 */
 3557               	/* stack size = 0 */
 3558               	.L__stack_usage = 0
1091:main.c        **** 
 3559               		.stabn	68,0,1091,.LM401-.LFBB24
 3560               	.LM401:
 3561 0c30 9091 0000 		lds r25,frameCount
 3562 0c34 9370      		andi r25,lo8(3)
1094:main.c        **** 		newFrame = TRUE;
 3563               		.stabn	68,0,1094,.LM402-.LFBB24
 3564               	.LM402:
 3565 0c36 81E0      		ldi r24,lo8(1)
 3566 0c38 2091 0000 		lds r18,lastFrameCount.2465
 3567 0c3c 9213      		cpse r25,r18
 3568 0c3e 00C0      		rjmp .L198
 3569 0c40 80E0      		ldi r24,0
 3570               	.L198:
1097:main.c        **** 
 3571               		.stabn	68,0,1097,.LM403-.LFBB24
 3572               	.LM403:
 3573 0c42 9093 0000 		sts lastFrameCount.2465,r25
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 189


1100:main.c        **** 
 3574               		.stabn	68,0,1100,.LM404-.LFBB24
 3575               	.LM404:
 3576 0c46 0895      		ret
 3577               		.size	isNewFrame, .-isNewFrame
 3578               		.stabs	"lastFrameCount:V(4,2)",38,0,1089,lastFrameCount.2465
 3579               		.stabs	"thisFrameCount:r(4,2)",64,0,1091,25
 3580               		.stabn	192,0,0,.LFBB24-.LFBB24
 3581               		.stabn	224,0,0,.Lscope24-.LFBB24
 3582               	.Lscope24:
 3583               		.stabs	"",36,0,0,.Lscope24-.LFBB24
 3584               		.stabd	78,0,0
 3585               		.section	.text.startup,"ax",@progbits
 3586               		.stabs	"main:F(0,1)",36,0,1136,main
 3587               	.global	main
 3588               		.type	main, @function
 3589               	main:
 3590               		.stabd	46,0,0
1120:main.c        **** 		lcdInterface_pwmDotClockInit(TRUE);
1121:main.c        ****   #endif
1122:main.c        **** }
1123:main.c        **** #else
1124:main.c        **** //See the declaration, above...
1125:main.c        **** void endOfFrameHandler(void)
1126:main.c        **** {
1127:main.c        **** }
1128:main.c        **** #endif
1129:main.c        **** 
1130:main.c        **** //#define TEST__FLASH TRUE
1131:main.c        **** 
1132:main.c        **** #if(defined(TEST__FLASH) && TEST__FLASH)
1133:main.c        ****  #include "test__flash.c"
1134:main.c        **** #endif
1135:main.c        **** 
1136:main.c        **** int main(void)
1137:main.c        **** {
 3591               		.stabn	68,0,1137,.LM405-.LFBB25
 3592               	.LM405:
 3593               	.LFBB25:
 3594               	/* prologue: function */
 3595               	/* frame size = 0 */
 3596               	/* stack size = 0 */
 3597               	.L__stack_usage = 0
1138:main.c        **** // a/o FB_TETRIS, testing...
1139:main.c        **** 	//WTF... this ain't showin' up when FB_WIDTH=24...?!
1140:main.c        **** 
1141:main.c        **** #if(defined(FRAMEBUFFER_TESTING) && FRAMEBUFFER_TESTING)
1142:main.c        **** 	frameBufferInit();
 3598               		.stabn	68,0,1142,.LM406-.LFBB25
 3599               	.LM406:
 3600 0000 00D0      		rcall frameBufferInit
 3601 0002 20E0      		ldi r18,lo8(frameBuffer)
 3602 0004 30E0      		ldi r19,hi8(frameBuffer)
1143:main.c        **** 	uint8_t i, j;
1144:main.c        **** 	for(i=0; i<FB_HEIGHT; i++)
 3603               		.stabn	68,0,1144,.LM407-.LFBB25
 3604               	.LM407:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 190


 3605 0006 40E0      		ldi r20,0
 3606               	.L200:
1137:main.c        **** // a/o FB_TETRIS, testing...
 3607               		.stabn	68,0,1137,.LM408-.LFBB25
 3608               	.LM408:
 3609 0008 80E0      		ldi r24,0
 3610 000a 90E0      		ldi r25,0
 3611               	.L203:
 3612 000c F901      		movw r30,r18
 3613 000e E80F      		add r30,r24
 3614 0010 F91F      		adc r31,r25
 3615 0012 542F      		mov r21,r20
 3616 0014 580F      		add r21,r24
1145:main.c        **** 		for(j=0; j<FB_WIDTH; j++)
1146:main.c        **** 			frameBuffer[i][j] = i+j;
 3617               		.stabn	68,0,1146,.LM409-.LFBB25
 3618               	.LM409:
 3619 0016 5083      		st Z,r21
 3620 0018 0196      		adiw r24,1
1145:main.c        **** 		for(j=0; j<FB_WIDTH; j++)
 3621               		.stabn	68,0,1145,.LM410-.LFBB25
 3622               	.LM410:
 3623 001a 8031      		cpi r24,16
 3624 001c 9105      		cpc r25,__zero_reg__
 3625 001e 01F4      		brne .L203
1144:main.c        **** 		for(j=0; j<FB_WIDTH; j++)
 3626               		.stabn	68,0,1144,.LM411-.LFBB25
 3627               	.LM411:
 3628 0020 4F5F      		subi r20,lo8(-(1))
 3629 0022 2F5E      		subi r18,-17
 3630 0024 3F4F      		sbci r19,-1
 3631 0026 4031      		cpi r20,lo8(16)
 3632 0028 01F4      		brne .L200
1147:main.c        **** #endif
1148:main.c        **** 
1149:main.c        **** #if(defined(SEG_RACER) && SEG_RACER)
1150:main.c        **** 	racer_init();
1151:main.c        **** #endif
1152:main.c        **** 
1153:main.c        **** #if (defined(BLUE_ADC) && BLUE_ADC)
1154:main.c        **** 	adc_takeInput(6);
1155:main.c        **** 	adc_init();
1156:main.c        **** 	adc_select(6);
1157:main.c        **** #endif
1158:main.c        **** 
1159:main.c        **** 
1160:main.c        **** #if (defined(PIEZO_HIT_DETECTION) && PIEZO_HIT_DETECTION)
1161:main.c        **** //#if (defined(FB_QUESTION) && FB_QUESTION)
1162:main.c        **** 	//This is identical to the BLUE_ADC case, above, but the adc is used
1163:main.c        **** 	//differently... and I'm trying to do some cleanup, which is more messy
1164:main.c        **** 	//here, because of it. Wee!
1165:main.c        **** 
1166:main.c        **** 	//Actually, it runs adc_startConversion() at the end, so it's no longer
1167:main.c        **** 	//*identical*
1168:main.c        **** 	phd_init();
1169:main.c        **** #endif
1170:main.c        **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 191


1171:main.c        **** #if((defined(SEG_TET) && SEG_TET) || (defined(FB_TETRIS) && FB_TETRIS))
1172:main.c        **** 	tetInit(3);
1173:main.c        **** #endif
1174:main.c        **** 
1175:main.c        **** #if(defined(_DMS_EXTERNALUPDATE_) && _DMS_EXTERNALUPDATE_)
1176:main.c        **** 	//These values could probably be calculated...
1177:main.c        **** 	// (as long as OSCCAL_VAL isn't changed)
1178:main.c        **** 	// But I'm going on the fact, it's refreshing about 8Hz
1179:main.c        **** 	// and there's roughly 768 rows (HSYNC interrupts)
1180:main.c        **** 	// (of course, there's vsync rows, too)
1181:main.c        **** 	// so... that's about .000125s per HSYNC interrupt
1182:main.c        **** 	// or 8000 interrupts per second
1183:main.c        **** 	// Which is roughly 1dms per interrupt...
1184:main.c        **** 	init_dmsExternalUpdate(1,1);
1185:main.c        **** #endif
1186:main.c        **** 
1187:main.c        **** 
1188:main.c        **** 
1189:main.c        **** #if(!defined(PWM_TESTING) || !PWM_TESTING)
1190:main.c        **** 	init_hsyncTimer();
 3633               		.stabn	68,0,1190,.LM412-.LFBB25
 3634               	.LM412:
 3635 002a 00D0      		rcall init_hsyncTimer
1191:main.c        **** #endif
1192:main.c        **** 
1193:main.c        **** 	//This starts pretty late... watch out for WDT
1194:main.c        **** 	init_heartBeat();
 3636               		.stabn	68,0,1194,.LM413-.LFBB25
 3637               	.LM413:
 3638 002c 00D0      		rcall init_heartBeat
1195:main.c        **** 
1196:main.c        **** 	setHeartRate(0);
 3639               		.stabn	68,0,1196,.LM414-.LFBB25
 3640               	.LM414:
 3641 002e 80E0      		ldi r24,0
 3642 0030 00D0      		rcall setHeartRate
 3643               	.LBB307:
 3644               	.LBB308:
 3645               		.stabs	"./_interfaces/6bitParallel.c",132,0,0,.Ltext33
 3646               	.Ltext33:
 376:./_interfaces/6bitParallel.c **** 
 3647               		.stabn	68,0,376,.LM415-.LFBB25
 3648               	.LM415:
 3649 0032 BB9A      		sbi 0x17,3
 379:./_interfaces/6bitParallel.c **** 	setoutPORT(VSYNC_PIN, VSYNC_PORT);
 3650               		.stabn	68,0,379,.LM416-.LFBB25
 3651               	.LM416:
 3652 0034 BC9A      		sbi 0x17,4
 380:./_interfaces/6bitParallel.c **** 	setoutPORT(SD_PIN, SD_PORT);
 3653               		.stabn	68,0,380,.LM417-.LFBB25
 3654               	.LM417:
 3655 0036 BD9A      		sbi 0x17,5
 381:./_interfaces/6bitParallel.c **** 
 3656               		.stabn	68,0,381,.LM418-.LFBB25
 3657               	.LM418:
 3658 0038 BE9A      		sbi 0x17,6
 383:./_interfaces/6bitParallel.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 192


 3659               		.stabn	68,0,383,.LM419-.LFBB25
 3660               	.LM419:
 3661 003a 8AB3      		in r24,0x1a
 3662 003c 8F63      		ori r24,lo8(63)
 3663 003e 8ABB      		out 0x1a,r24
 386:./_interfaces/6bitParallel.c **** 
 3664               		.stabn	68,0,386,.LM420-.LFBB25
 3665               	.LM420:
 3666 0040 C69A      		sbi 0x18,6
 390:./_interfaces/6bitParallel.c **** 	noGreen();
 3667               		.stabn	68,0,390,.LM421-.LFBB25
 3668               	.LM421:
 3669 0042 88B3      		in r24,0x18
 3670 0044 8063      		ori r24,lo8(48)
 3671 0046 88BB      		out 0x18,r24
 3672 0048 8BB3      		in r24,0x1b
 3673 004a 8F7C      		andi r24,lo8(-49)
 3674 004c 8BBB      		out 0x1b,r24
 391:./_interfaces/6bitParallel.c **** 	noRed();
 3675               		.stabn	68,0,391,.LM422-.LFBB25
 3676               	.LM422:
 3677 004e 8BB3      		in r24,0x1b
 3678 0050 837F      		andi r24,lo8(-13)
 3679 0052 8BBB      		out 0x1b,r24
 392:./_interfaces/6bitParallel.c **** }
 3680               		.stabn	68,0,392,.LM423-.LFBB25
 3681               	.LM423:
 3682 0054 8BB3      		in r24,0x1b
 3683 0056 8C7F      		andi r24,lo8(-4)
 3684 0058 8BBB      		out 0x1b,r24
 3685               	.LBE308:
 3686               	.LBE307:
 3687               		.stabs	"main.c",132,0,0,.Ltext34
 3688               	.Ltext34:
1197:main.c        **** 
1198:main.c        **** 
1199:main.c        **** 
1200:main.c        **** 
1201:main.c        **** #if(defined(TEST__FLASH) && TEST__FLASH)
1202:main.c        **** 	test__flash();
1203:main.c        **** #endif
1204:main.c        **** 
1205:main.c        **** 
1206:main.c        **** 
1207:main.c        **** 
1208:main.c        **** 
1209:main.c        **** 
1210:main.c        **** 	lvds_timerInit();
1211:main.c        **** 
1212:main.c        **** 
1213:main.c        **** #if (defined(FB_QUESTION) && FB_QUESTION)
1214:main.c        ****  #if (defined(BUMP_SWITCH) && BUMP_SWITCH)
1215:main.c        **** 	hitSensor_init();
 3689               		.stabn	68,0,1215,.LM424-.LFBB25
 3690               	.LM424:
 3691 005a 00D0      		rcall hitSensor_init
 3692               	.L204:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 193


1216:main.c        ****  #endif
1217:main.c        **** #endif
1218:main.c        **** 
1219:main.c        **** 
1220:main.c        **** 	while(1)
1221:main.c        **** 	{
1222:main.c        **** #if(defined(FB_QUESTION) && FB_QUESTION)
1223:main.c        **** //THIS PROBABLY SHOULD BE REVISED...
1224:main.c        **** //_hitSensors/bumpSwitch.c handles it differently...
1225:main.c        **** #if (!defined(BUMP_SWITCH) || !BUMP_SWITCH)
1226:main.c        **** 
1227:main.c        **** #if(!defined(__HEART_REMOVED__) || !(__HEART_REMOVED__))
1228:main.c        **** #if (defined(PIEZO_HIT_DETECTION) && PIEZO_HIT_DETECTION)
1229:main.c        **** 		if(phd_update())				
1230:main.c        **** #else
1231:main.c        **** 		if(!heartPinInputPoll())
1232:main.c        **** #endif
1233:main.c        **** 			fbQuestion_hitDetected();
1234:main.c        **** #endif
1235:main.c        **** #endif
1236:main.c        **** 
1237:main.c        **** #endif
1238:main.c        **** 
1239:main.c        **** //#if( (defined(FB_QUESTION) && FB_QUESTION) 
1240:main.c        **** //	  ||	(defined(FB_SMILEY) && FB_SMILEY) )
1241:main.c        **** #if( defined(FRAMEBUFFER_TESTING) && (FRAMEBUFFER_TESTING))
1242:main.c        **** 		frameBufferUpdate();
 3693               		.stabn	68,0,1242,.LM425-.LFBB25
 3694               	.LM425:
 3695 005c 00D0      		rcall frameBufferUpdate
1243:main.c        **** #endif
1244:main.c        **** 
1245:main.c        **** 		heartUpdate();
 3696               		.stabn	68,0,1245,.LM426-.LFBB25
 3697               	.LM426:
 3698 005e 00D0      		rcall heartUpdate
 3699 0060 00C0      		rjmp .L204
 3700               		.size	main, .-main
 3701               		.stabs	"i:r(4,2)",64,0,1143,20
 3702               		.stabn	192,0,0,.LFBB25-.LFBB25
 3703               		.stabn	224,0,0,.Lscope25-.LFBB25
 3704               	.Lscope25:
 3705               		.stabs	"",36,0,0,.Lscope25-.LFBB25
 3706               		.stabd	78,0,0
 3707               		.local	lastFrameCount.2465
 3708               		.comm	lastFrameCount.2465,1,1
 3709               		.local	lastReward.2304
 3710               		.comm	lastReward.2304,1,1
 3711               		.local	fbLastUpdateTime.2108
 3712               		.comm	fbLastUpdateTime.2108,4,1
 3713               	.global	frameCount
 3714               		.section .bss
 3715               		.type	frameCount, @object
 3716               		.size	frameCount, 1
 3717               	frameCount:
 3718 0000 00        		.zero	1
 3719               	.global	updateFrame
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 194


 3720               		.data
 3721               		.type	updateFrame, @object
 3722               		.size	updateFrame, 1
 3723               	updateFrame:
 3724 0000 01        		.byte	1
 3725               	.global	hsyncCount
 3726               		.section .bss
 3727               		.type	hsyncCount, @object
 3728               		.size	hsyncCount, 2
 3729               	hsyncCount:
 3730 0001 0000      		.zero	2
 3731               	.global	vSync
 3732               		.type	vSync, @object
 3733               		.size	vSync, 1
 3734               	vSync:
 3735 0003 00        		.zero	1
 3736               	.global	dataEnable
 3737               		.type	dataEnable, @object
 3738               		.size	dataEnable, 1
 3739               	dataEnable:
 3740 0004 00        		.zero	1
 3741               	.global	nowIsReward
 3742               		.data
 3743               		.type	nowIsReward, @object
 3744               		.size	nowIsReward, 1
 3745               	nowIsReward:
 3746 0001 01        		.byte	1
 3747               	.global	p_nowSprite
 3748               		.type	p_nowSprite, @object
 3749               		.size	p_nowSprite, 2
 3750               	p_nowSprite:
 3751 0002 0000      		.word	spriteLEAF
 3752               	.global	qCount
 3753               		.section .bss
 3754               		.type	qCount, @object
 3755               		.size	qCount, 1
 3756               	qCount:
 3757 0005 00        		.zero	1
 3758               	.global	callCount
 3759               		.type	callCount, @object
 3760               		.size	callCount, 1
 3761               	callCount:
 3762 0006 00        		.zero	1
 3763               	.global	spriteLUIGIRUNS
 3764               		.section	.progmem.data,"a",@progbits
 3765               		.type	spriteLUIGIRUNS, @object
 3766               		.size	spriteLUIGIRUNS, 19
 3767               	spriteLUIGIRUNS:
 3768 0000 0000      		.word	pgm_imageMARIORUNS
 3769 0002 0000      		.word	0
 3770 0004 0000      		.word	pgm_paletteLUIGI
 3771 0006 01        		.byte	1
 3772 0007 18        		.byte	24
 3773 0008 0000      		.word	LuigiRunsFlip
 3774 000a 0000      		.word	LuigiRunsMotion
 3775 000c 0000      		.word	DefaultLayer+2
 3776 000e 0000      		.word	MarioRunsCamMotion
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 195


 3777 0010 0000      		.word	0
 3778 0012 03        		.byte	3
 3779               	.global	LuigiRunsFlip
 3780               		.type	LuigiRunsFlip, @object
 3781               		.size	LuigiRunsFlip, 3
 3782               	LuigiRunsFlip:
 3783 0013 FF        		.byte	-1
 3784 0014 FF        		.byte	-1
 3785 0015 FF        		.byte	-1
 3786               	.global	LuigiRunsMotion
 3787               		.type	LuigiRunsMotion, @object
 3788               		.size	LuigiRunsMotion, 6
 3789               	LuigiRunsMotion:
 3790 0016 00        		.byte	0
 3791 0017 0000      		.word	LuigiRunsX
 3792 0019 10        		.byte	16
 3793 001a 0000      		.word	DefaultY+4
 3794               	.global	LuigiRunsX
 3795               		.type	LuigiRunsX, @object
 3796               		.size	LuigiRunsX, 6
 3797               	LuigiRunsX:
 3798 001c AB        		.byte	-85
 3799 001d AA        		.byte	-86
 3800 001e 02        		.byte	2
 3801 001f 00        		.byte	0
 3802 0020 00        		.byte	0
 3803 0021 00        		.byte	0
 3804               	.global	spriteMARIORUNS
 3805               		.type	spriteMARIORUNS, @object
 3806               		.size	spriteMARIORUNS, 19
 3807               	spriteMARIORUNS:
 3808 0022 0000      		.word	pgm_imageMARIORUNS
 3809 0024 0000      		.word	0
 3810 0026 0000      		.word	pgm_paletteMARIO
 3811 0028 01        		.byte	1
 3812 0029 18        		.byte	24
 3813 002a 0000      		.word	0
 3814 002c 0000      		.word	MarioRunsMotion
 3815 002e 0000      		.word	DefaultLayer+2
 3816 0030 0000      		.word	MarioRunsCamMotion
 3817 0032 0000      		.word	0
 3818 0034 03        		.byte	3
 3819               	.global	MarioRunsCamMotion
 3820               		.type	MarioRunsCamMotion, @object
 3821               		.size	MarioRunsCamMotion, 6
 3822               	MarioRunsCamMotion:
 3823 0035 00        		.byte	0
 3824 0036 0000      		.word	0
 3825 0038 10        		.byte	16
 3826 0039 0000      		.word	DefaultCamY+4
 3827               	.global	MarioRunsMotion
 3828               		.type	MarioRunsMotion, @object
 3829               		.size	MarioRunsMotion, 6
 3830               	MarioRunsMotion:
 3831 003b 00        		.byte	0
 3832 003c 0000      		.word	MarioRunsX
 3833 003e 10        		.byte	16
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 196


 3834 003f 0000      		.word	DefaultY+4
 3835               	.global	MarioRunsX
 3836               		.type	MarioRunsX, @object
 3837               		.size	MarioRunsX, 6
 3838               	MarioRunsX:
 3839 0041 AA        		.byte	-86
 3840 0042 AA        		.byte	-86
 3841 0043 00        		.byte	0
 3842 0044 00        		.byte	0
 3843 0045 00        		.byte	0
 3844 0046 00        		.byte	0
 3845               		.type	pgm_imageMARIORUNS, @object
 3846               		.size	pgm_imageMARIORUNS, 192
 3847               	pgm_imageMARIORUNS:
 3848 0047 00        		.byte	0
 3849 0048 00        		.byte	0
 3850 0049 00        		.byte	0
 3851 004a 00        		.byte	0
 3852 004b 00        		.byte	0
 3853 004c A8        		.byte	-88
 3854 004d 0A        		.byte	10
 3855 004e 00        		.byte	0
 3856 004f 00        		.byte	0
 3857 0050 AA        		.byte	-86
 3858 0051 AA        		.byte	-86
 3859 0052 02        		.byte	2
 3860 0053 00        		.byte	0
 3861 0054 D5        		.byte	-43
 3862 0055 37        		.byte	55
 3863 0056 00        		.byte	0
 3864 0057 40        		.byte	64
 3865 0058 F7        		.byte	-9
 3866 0059 F7        		.byte	-9
 3867 005a 03        		.byte	3
 3868 005b 40        		.byte	64
 3869 005c D7        		.byte	-41
 3870 005d DF        		.byte	-33
 3871 005e 0F        		.byte	15
 3872 005f 40        		.byte	64
 3873 0060 FD        		.byte	-3
 3874 0061 57        		.byte	87
 3875 0062 01        		.byte	1
 3876 0063 00        		.byte	0
 3877 0064 FC        		.byte	-4
 3878 0065 FF        		.byte	-1
 3879 0066 00        		.byte	0
 3880 0067 00        		.byte	0
 3881 0068 55        		.byte	85
 3882 0069 C6        		.byte	-58
 3883 006a 00        		.byte	0
 3884 006b C0        		.byte	-64
 3885 006c 55        		.byte	85
 3886 006d F5        		.byte	-11
 3887 006e 03        		.byte	3
 3888 006f F0        		.byte	-16
 3889 0070 56        		.byte	86
 3890 0071 F5        		.byte	-11
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 197


 3891 0072 00        		.byte	0
 3892 0073 50        		.byte	80
 3893 0074 AA        		.byte	-86
 3894 0075 2A        		.byte	42
 3895 0076 00        		.byte	0
 3896 0077 90        		.byte	-112
 3897 0078 AA        		.byte	-86
 3898 0079 2A        		.byte	42
 3899 007a 00        		.byte	0
 3900 007b 94        		.byte	-108
 3901 007c 8A        		.byte	-118
 3902 007d 0A        		.byte	10
 3903 007e 00        		.byte	0
 3904 007f 04        		.byte	4
 3905 0080 50        		.byte	80
 3906 0081 01        		.byte	1
 3907 0082 00        		.byte	0
 3908 0083 00        		.byte	0
 3909 0084 50        		.byte	80
 3910 0085 05        		.byte	5
 3911 0086 00        		.byte	0
 3912 0087 00        		.byte	0
 3913 0088 A8        		.byte	-88
 3914 0089 0A        		.byte	10
 3915 008a 00        		.byte	0
 3916 008b 00        		.byte	0
 3917 008c AA        		.byte	-86
 3918 008d AA        		.byte	-86
 3919 008e 02        		.byte	2
 3920 008f 00        		.byte	0
 3921 0090 D5        		.byte	-43
 3922 0091 37        		.byte	55
 3923 0092 00        		.byte	0
 3924 0093 40        		.byte	64
 3925 0094 F7        		.byte	-9
 3926 0095 F7        		.byte	-9
 3927 0096 03        		.byte	3
 3928 0097 40        		.byte	64
 3929 0098 D7        		.byte	-41
 3930 0099 DF        		.byte	-33
 3931 009a 0F        		.byte	15
 3932 009b 40        		.byte	64
 3933 009c FD        		.byte	-3
 3934 009d 57        		.byte	87
 3935 009e 01        		.byte	1
 3936 009f 00        		.byte	0
 3937 00a0 FC        		.byte	-4
 3938 00a1 FF        		.byte	-1
 3939 00a2 00        		.byte	0
 3940 00a3 50        		.byte	80
 3941 00a4 A5        		.byte	-91
 3942 00a5 05        		.byte	5
 3943 00a6 00        		.byte	0
 3944 00a7 5F        		.byte	95
 3945 00a8 A5        		.byte	-91
 3946 00a9 56        		.byte	86
 3947 00aa 3F        		.byte	63
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 198


 3948 00ab 3F        		.byte	63
 3949 00ac E5        		.byte	-27
 3950 00ad 6A        		.byte	106
 3951 00ae 3D        		.byte	61
 3952 00af 0F        		.byte	15
 3953 00b0 AA        		.byte	-86
 3954 00b1 2A        		.byte	42
 3955 00b2 04        		.byte	4
 3956 00b3 80        		.byte	-128
 3957 00b4 AA        		.byte	-86
 3958 00b5 AA        		.byte	-86
 3959 00b6 05        		.byte	5
 3960 00b7 A0        		.byte	-96
 3961 00b8 AA        		.byte	-86
 3962 00b9 AA        		.byte	-86
 3963 00ba 05        		.byte	5
 3964 00bb 94        		.byte	-108
 3965 00bc 0A        		.byte	10
 3966 00bd A8        		.byte	-88
 3967 00be 05        		.byte	5
 3968 00bf 54        		.byte	84
 3969 00c0 00        		.byte	0
 3970 00c1 00        		.byte	0
 3971 00c2 00        		.byte	0
 3972 00c3 50        		.byte	80
 3973 00c4 01        		.byte	1
 3974 00c5 00        		.byte	0
 3975 00c6 00        		.byte	0
 3976 00c7 00        		.byte	0
 3977 00c8 A8        		.byte	-88
 3978 00c9 0A        		.byte	10
 3979 00ca 00        		.byte	0
 3980 00cb 00        		.byte	0
 3981 00cc AA        		.byte	-86
 3982 00cd AA        		.byte	-86
 3983 00ce 02        		.byte	2
 3984 00cf 00        		.byte	0
 3985 00d0 D5        		.byte	-43
 3986 00d1 37        		.byte	55
 3987 00d2 00        		.byte	0
 3988 00d3 40        		.byte	64
 3989 00d4 F7        		.byte	-9
 3990 00d5 F7        		.byte	-9
 3991 00d6 03        		.byte	3
 3992 00d7 40        		.byte	64
 3993 00d8 D7        		.byte	-41
 3994 00d9 DF        		.byte	-33
 3995 00da 0F        		.byte	15
 3996 00db 40        		.byte	64
 3997 00dc FD        		.byte	-3
 3998 00dd 57        		.byte	87
 3999 00de 01        		.byte	1
 4000 00df 00        		.byte	0
 4001 00e0 FC        		.byte	-4
 4002 00e1 FF        		.byte	-1
 4003 00e2 00        		.byte	0
 4004 00e3 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 199


 4005 00e4 65        		.byte	101
 4006 00e5 05        		.byte	5
 4007 00e6 00        		.byte	0
 4008 00e7 40        		.byte	64
 4009 00e8 95        		.byte	-107
 4010 00e9 16        		.byte	22
 4011 00ea 00        		.byte	0
 4012 00eb 40        		.byte	64
 4013 00ec A5        		.byte	-91
 4014 00ed EB        		.byte	-21
 4015 00ee 00        		.byte	0
 4016 00ef 40        		.byte	64
 4017 00f0 95        		.byte	-107
 4018 00f1 AA        		.byte	-86
 4019 00f2 00        		.byte	0
 4020 00f3 80        		.byte	-128
 4021 00f4 F5        		.byte	-11
 4022 00f5 AB        		.byte	-85
 4023 00f6 00        		.byte	0
 4024 00f7 00        		.byte	0
 4025 00f8 F6        		.byte	-10
 4026 00f9 2A        		.byte	42
 4027 00fa 00        		.byte	0
 4028 00fb 00        		.byte	0
 4029 00fc A8        		.byte	-88
 4030 00fd 15        		.byte	21
 4031 00fe 00        		.byte	0
 4032 00ff 00        		.byte	0
 4033 0100 54        		.byte	84
 4034 0101 55        		.byte	85
 4035 0102 00        		.byte	0
 4036 0103 00        		.byte	0
 4037 0104 54        		.byte	84
 4038 0105 01        		.byte	1
 4039 0106 00        		.byte	0
 4040               	.global	spriteLUIGI
 4041               		.type	spriteLUIGI, @object
 4042               		.size	spriteLUIGI, 19
 4043               	spriteLUIGI:
 4044 0107 0000      		.word	pgm_imageMARIO
 4045 0109 0000      		.word	0
 4046 010b 0000      		.word	pgm_paletteLUIGI
 4047 010d 01        		.byte	1
 4048 010e 10        		.byte	16
 4049 010f 0000      		.word	0
 4050 0111 0000      		.word	DefaultMotion
 4051 0113 0000      		.word	DefaultLayer
 4052 0115 0000      		.word	DefaultCamMotion
 4053 0117 0000      		.word	0
 4054 0119 01        		.byte	1
 4055               		.type	pgm_paletteLUIGI, @object
 4056               		.size	pgm_paletteLUIGI, 4
 4057               	pgm_paletteLUIGI:
 4058 011a 25        		.byte	37
 4059 011b 04        		.byte	4
 4060 011c 3F        		.byte	63
 4061 011d 07        		.byte	7
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 200


 4062               	.global	spriteMARIO
 4063               		.type	spriteMARIO, @object
 4064               		.size	spriteMARIO, 19
 4065               	spriteMARIO:
 4066 011e 0000      		.word	pgm_imageMARIO
 4067 0120 0000      		.word	0
 4068 0122 0000      		.word	pgm_paletteMARIO
 4069 0124 01        		.byte	1
 4070 0125 10        		.byte	16
 4071 0126 0000      		.word	0
 4072 0128 0000      		.word	DefaultMotion
 4073 012a 0000      		.word	DefaultLayer
 4074 012c 0000      		.word	DefaultCamMotion
 4075 012e 0000      		.word	0
 4076 0130 01        		.byte	1
 4077               		.type	pgm_paletteMARIO, @object
 4078               		.size	pgm_paletteMARIO, 4
 4079               	pgm_paletteMARIO:
 4080 0131 25        		.byte	37
 4081 0132 05        		.byte	5
 4082 0133 02        		.byte	2
 4083 0134 07        		.byte	7
 4084               		.type	pgm_imageMARIO, @object
 4085               		.size	pgm_imageMARIO, 64
 4086               	pgm_imageMARIO:
 4087 0135 00        		.byte	0
 4088 0136 A8        		.byte	-88
 4089 0137 0A        		.byte	10
 4090 0138 00        		.byte	0
 4091 0139 00        		.byte	0
 4092 013a AA        		.byte	-86
 4093 013b AA        		.byte	-86
 4094 013c 02        		.byte	2
 4095 013d 00        		.byte	0
 4096 013e D5        		.byte	-43
 4097 013f 37        		.byte	55
 4098 0140 00        		.byte	0
 4099 0141 40        		.byte	64
 4100 0142 F7        		.byte	-9
 4101 0143 F7        		.byte	-9
 4102 0144 03        		.byte	3
 4103 0145 40        		.byte	64
 4104 0146 D7        		.byte	-41
 4105 0147 DF        		.byte	-33
 4106 0148 0F        		.byte	15
 4107 0149 40        		.byte	64
 4108 014a FD        		.byte	-3
 4109 014b 57        		.byte	87
 4110 014c 01        		.byte	1
 4111 014d 00        		.byte	0
 4112 014e FC        		.byte	-4
 4113 014f FF        		.byte	-1
 4114 0150 00        		.byte	0
 4115 0151 00        		.byte	0
 4116 0152 65        		.byte	101
 4117 0153 05        		.byte	5
 4118 0154 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 201


 4119 0155 40        		.byte	64
 4120 0156 65        		.byte	101
 4121 0157 59        		.byte	89
 4122 0158 01        		.byte	1
 4123 0159 50        		.byte	80
 4124 015a A5        		.byte	-91
 4125 015b 5A        		.byte	90
 4126 015c 05        		.byte	5
 4127 015d F0        		.byte	-16
 4128 015e B9        		.byte	-71
 4129 015f 6E        		.byte	110
 4130 0160 0F        		.byte	15
 4131 0161 F0        		.byte	-16
 4132 0162 AB        		.byte	-85
 4133 0163 EA        		.byte	-22
 4134 0164 0F        		.byte	15
 4135 0165 F0        		.byte	-16
 4136 0166 AA        		.byte	-86
 4137 0167 AA        		.byte	-86
 4138 0168 0F        		.byte	15
 4139 0169 00        		.byte	0
 4140 016a 2A        		.byte	42
 4141 016b A8        		.byte	-88
 4142 016c 00        		.byte	0
 4143 016d 40        		.byte	64
 4144 016e 05        		.byte	5
 4145 016f 50        		.byte	80
 4146 0170 01        		.byte	1
 4147 0171 50        		.byte	80
 4148 0172 05        		.byte	5
 4149 0173 50        		.byte	80
 4150 0174 05        		.byte	5
 4151               	.global	spriteCLOUD
 4152               		.type	spriteCLOUD, @object
 4153               		.size	spriteCLOUD, 19
 4154               	spriteCLOUD:
 4155 0175 0000      		.word	pgm_imageCLOUD
 4156 0177 0000      		.word	0
 4157 0179 0000      		.word	pgm_paletteCLOUD
 4158 017b 01        		.byte	1
 4159 017c 28        		.byte	40
 4160 017d 0000      		.word	0
 4161 017f 0000      		.word	DefaultMotion
 4162 0181 0000      		.word	DefaultLayer
 4163 0183 0000      		.word	DefaultCamMotion
 4164 0185 0000      		.word	0
 4165 0187 01        		.byte	1
 4166               		.type	pgm_paletteCLOUD, @object
 4167               		.size	pgm_paletteCLOUD, 4
 4168               	pgm_paletteCLOUD:
 4169 0188 25        		.byte	37
 4170 0189 2F        		.byte	47
 4171 018a 00        		.byte	0
 4172 018b 00        		.byte	0
 4173               		.type	pgm_imageCLOUD, @object
 4174               		.size	pgm_imageCLOUD, 64
 4175               	pgm_imageCLOUD:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 202


 4176 018c 80        		.byte	-128
 4177 018d AA        		.byte	-86
 4178 018e AA        		.byte	-86
 4179 018f 02        		.byte	2
 4180 0190 60        		.byte	96
 4181 0191 55        		.byte	85
 4182 0192 55        		.byte	85
 4183 0193 09        		.byte	9
 4184 0194 58        		.byte	88
 4185 0195 55        		.byte	85
 4186 0196 55        		.byte	85
 4187 0197 25        		.byte	37
 4188 0198 58        		.byte	88
 4189 0199 55        		.byte	85
 4190 019a 55        		.byte	85
 4191 019b 25        		.byte	37
 4192 019c 58        		.byte	88
 4193 019d 55        		.byte	85
 4194 019e 55        		.byte	85
 4195 019f 25        		.byte	37
 4196 01a0 56        		.byte	86
 4197 01a1 55        		.byte	85
 4198 01a2 55        		.byte	85
 4199 01a3 95        		.byte	-107
 4200 01a4 56        		.byte	86
 4201 01a5 65        		.byte	101
 4202 01a6 59        		.byte	89
 4203 01a7 95        		.byte	-107
 4204 01a8 56        		.byte	86
 4205 01a9 65        		.byte	101
 4206 01aa 59        		.byte	89
 4207 01ab 95        		.byte	-107
 4208 01ac 56        		.byte	86
 4209 01ad 65        		.byte	101
 4210 01ae 59        		.byte	89
 4211 01af 95        		.byte	-107
 4212 01b0 56        		.byte	86
 4213 01b1 55        		.byte	85
 4214 01b2 55        		.byte	85
 4215 01b3 95        		.byte	-107
 4216 01b4 66        		.byte	102
 4217 01b5 55        		.byte	85
 4218 01b6 55        		.byte	85
 4219 01b7 99        		.byte	-103
 4220 01b8 58        		.byte	88
 4221 01b9 59        		.byte	89
 4222 01ba 65        		.byte	101
 4223 01bb 25        		.byte	37
 4224 01bc 58        		.byte	88
 4225 01bd A5        		.byte	-91
 4226 01be 5A        		.byte	90
 4227 01bf 25        		.byte	37
 4228 01c0 58        		.byte	88
 4229 01c1 55        		.byte	85
 4230 01c2 55        		.byte	85
 4231 01c3 25        		.byte	37
 4232 01c4 60        		.byte	96
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 203


 4233 01c5 95        		.byte	-107
 4234 01c6 56        		.byte	86
 4235 01c7 09        		.byte	9
 4236 01c8 80        		.byte	-128
 4237 01c9 2A        		.byte	42
 4238 01ca A8        		.byte	-88
 4239 01cb 02        		.byte	2
 4240               	.global	spriteLEAF
 4241               		.type	spriteLEAF, @object
 4242               		.size	spriteLEAF, 19
 4243               	spriteLEAF:
 4244 01cc 0000      		.word	pgm_imageLEAF
 4245 01ce 0000      		.word	0
 4246 01d0 0000      		.word	pgm_paletteLEAF
 4247 01d2 01        		.byte	1
 4248 01d3 30        		.byte	48
 4249 01d4 0000      		.word	LeafFlip
 4250 01d6 0000      		.word	LeafMotion
 4251 01d8 0000      		.word	LeafLayer
 4252 01da 0000      		.word	LeafCamMotion
 4253 01dc 0000      		.word	0
 4254 01de 01        		.byte	1
 4255               	.global	LeafCamMotion
 4256               		.type	LeafCamMotion, @object
 4257               		.size	LeafCamMotion, 6
 4258               	LeafCamMotion:
 4259 01df 00        		.byte	0
 4260 01e0 0000      		.word	0
 4261 01e2 00        		.byte	0
 4262 01e3 0000      		.word	LeafCamY
 4263               	.global	LeafCamY
 4264               		.type	LeafCamY, @object
 4265               		.size	LeafCamY, 12
 4266               	LeafCamY:
 4267 01e5 55        		.byte	85
 4268 01e6 55        		.byte	85
 4269 01e7 55        		.byte	85
 4270 01e8 55        		.byte	85
 4271 01e9 57        		.byte	87
 4272 01ea 55        		.byte	85
 4273 01eb 55        		.byte	85
 4274 01ec 44        		.byte	68
 4275 01ed 44        		.byte	68
 4276 01ee 04        		.byte	4
 4277 01ef 00        		.byte	0
 4278 01f0 00        		.byte	0
 4279               	.global	LeafMotion
 4280               		.type	LeafMotion, @object
 4281               		.size	LeafMotion, 6
 4282               	LeafMotion:
 4283 01f1 00        		.byte	0
 4284 01f2 0000      		.word	LeafX
 4285 01f4 F0        		.byte	-16
 4286 01f5 0000      		.word	LeafY
 4287               	.global	LeafY
 4288               		.type	LeafY, @object
 4289               		.size	LeafY, 12
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 204


 4290               	LeafY:
 4291 01f7 AA        		.byte	-86
 4292 01f8 AA        		.byte	-86
 4293 01f9 AA        		.byte	-86
 4294 01fa AA        		.byte	-86
 4295 01fb 57        		.byte	87
 4296 01fc 55        		.byte	85
 4297 01fd 55        		.byte	85
 4298 01fe 55        		.byte	85
 4299 01ff 55        		.byte	85
 4300 0200 55        		.byte	85
 4301 0201 55        		.byte	85
 4302 0202 55        		.byte	85
 4303               	.global	LeafX
 4304               		.type	LeafX, @object
 4305               		.size	LeafX, 12
 4306               	LeafX:
 4307 0203 00        		.byte	0
 4308 0204 00        		.byte	0
 4309 0205 00        		.byte	0
 4310 0206 00        		.byte	0
 4311 0207 EA        		.byte	-22
 4312 0208 AA        		.byte	-86
 4313 0209 EA        		.byte	-22
 4314 020a AA        		.byte	-86
 4315 020b EA        		.byte	-22
 4316 020c AA        		.byte	-86
 4317 020d EA        		.byte	-22
 4318 020e AA        		.byte	-86
 4319               	.global	LeafLayer
 4320               		.type	LeafLayer, @object
 4321               		.size	LeafLayer, 6
 4322               	LeafLayer:
 4323 020f FF        		.byte	-1
 4324 0210 FF        		.byte	-1
 4325 0211 00        		.byte	0
 4326 0212 00        		.byte	0
 4327 0213 00        		.byte	0
 4328 0214 00        		.byte	0
 4329               	.global	LeafFlip
 4330               		.type	LeafFlip, @object
 4331               		.size	LeafFlip, 6
 4332               	LeafFlip:
 4333 0215 00        		.byte	0
 4334 0216 00        		.byte	0
 4335 0217 F8        		.byte	-8
 4336 0218 07        		.byte	7
 4337 0219 F8        		.byte	-8
 4338 021a 07        		.byte	7
 4339               		.type	pgm_paletteLEAF, @object
 4340               		.size	pgm_paletteLEAF, 4
 4341               	pgm_paletteLEAF:
 4342 021b 25        		.byte	37
 4343 021c 02        		.byte	2
 4344 021d 00        		.byte	0
 4345 021e 00        		.byte	0
 4346               		.type	pgm_imageLEAF, @object
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 205


 4347               		.size	pgm_imageLEAF, 64
 4348               	pgm_imageLEAF:
 4349 021f 00        		.byte	0
 4350 0220 00        		.byte	0
 4351 0221 00        		.byte	0
 4352 0222 00        		.byte	0
 4353 0223 00        		.byte	0
 4354 0224 00        		.byte	0
 4355 0225 00        		.byte	0
 4356 0226 A0        		.byte	-96
 4357 0227 00        		.byte	0
 4358 0228 00        		.byte	0
 4359 0229 00        		.byte	0
 4360 022a 98        		.byte	-104
 4361 022b 00        		.byte	0
 4362 022c 00        		.byte	0
 4363 022d 00        		.byte	0
 4364 022e 98        		.byte	-104
 4365 022f 00        		.byte	0
 4366 0230 00        		.byte	0
 4367 0231 A8        		.byte	-88
 4368 0232 A6        		.byte	-90
 4369 0233 00        		.byte	0
 4370 0234 80        		.byte	-128
 4371 0235 56        		.byte	86
 4372 0236 2A        		.byte	42
 4373 0237 00        		.byte	0
 4374 0238 68        		.byte	104
 4375 0239 A5        		.byte	-91
 4376 023a 95        		.byte	-107
 4377 023b 00        		.byte	0
 4378 023c 56        		.byte	86
 4379 023d 6A        		.byte	106
 4380 023e 95        		.byte	-107
 4381 023f 80        		.byte	-128
 4382 0240 A9        		.byte	-87
 4383 0241 65        		.byte	101
 4384 0242 95        		.byte	-107
 4385 0243 A0        		.byte	-96
 4386 0244 66        		.byte	102
 4387 0245 65        		.byte	101
 4388 0246 25        		.byte	37
 4389 0247 6A        		.byte	106
 4390 0248 65        		.byte	101
 4391 0249 59        		.byte	89
 4392 024a 25        		.byte	37
 4393 024b 56        		.byte	86
 4394 024c 59        		.byte	89
 4395 024d 55        		.byte	85
 4396 024e 09        		.byte	9
 4397 024f 68        		.byte	104
 4398 0250 55        		.byte	85
 4399 0251 55        		.byte	85
 4400 0252 02        		.byte	2
 4401 0253 A0        		.byte	-96
 4402 0254 56        		.byte	86
 4403 0255 A5        		.byte	-91
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 206


 4404 0256 02        		.byte	2
 4405 0257 00        		.byte	0
 4406 0258 AA        		.byte	-86
 4407 0259 2A        		.byte	42
 4408 025a 00        		.byte	0
 4409 025b 00        		.byte	0
 4410 025c 00        		.byte	0
 4411 025d 00        		.byte	0
 4412 025e 00        		.byte	0
 4413               	.global	spriteCOIN
 4414               		.type	spriteCOIN, @object
 4415               		.size	spriteCOIN, 19
 4416               	spriteCOIN:
 4417 025f 0000      		.word	pgm_imageCOIN
 4418 0261 0000      		.word	0
 4419 0263 0000      		.word	pgm_paletteCOIN
 4420 0265 01        		.byte	1
 4421 0266 28        		.byte	40
 4422 0267 0000      		.word	0
 4423 0269 0000      		.word	CoinMotion
 4424 026b 0000      		.word	DefaultLayer
 4425 026d 0000      		.word	DefaultCamMotion
 4426 026f 0000      		.word	0
 4427 0271 04        		.byte	4
 4428               	.global	CoinMotion
 4429               		.type	CoinMotion, @object
 4430               		.size	CoinMotion, 6
 4431               	CoinMotion:
 4432 0272 00        		.byte	0
 4433 0273 0000      		.word	0
 4434 0275 F0        		.byte	-16
 4435 0276 0000      		.word	CoinY
 4436               	.global	CoinY
 4437               		.type	CoinY, @object
 4438               		.size	CoinY, 10
 4439               	CoinY:
 4440 0278 AA        		.byte	-86
 4441 0279 AA        		.byte	-86
 4442 027a AA        		.byte	-86
 4443 027b AA        		.byte	-86
 4444 027c 55        		.byte	85
 4445 027d AA        		.byte	-86
 4446 027e AA        		.byte	-86
 4447 027f AA        		.byte	-86
 4448 0280 AA        		.byte	-86
 4449 0281 AA        		.byte	-86
 4450               		.type	pgm_paletteCOIN, @object
 4451               		.size	pgm_paletteCOIN, 4
 4452               	pgm_paletteCOIN:
 4453 0282 25        		.byte	37
 4454 0283 02        		.byte	2
 4455 0284 07        		.byte	7
 4456 0285 2F        		.byte	47
 4457               		.type	pgm_imageCOIN, @object
 4458               		.size	pgm_imageCOIN, 256
 4459               	pgm_imageCOIN:
 4460 0286 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 207


 4461 0287 00        		.byte	0
 4462 0288 00        		.byte	0
 4463 0289 00        		.byte	0
 4464 028a 00        		.byte	0
 4465 028b 80        		.byte	-128
 4466 028c 02        		.byte	2
 4467 028d 00        		.byte	0
 4468 028e 00        		.byte	0
 4469 028f A0        		.byte	-96
 4470 0290 0A        		.byte	10
 4471 0291 00        		.byte	0
 4472 0292 00        		.byte	0
 4473 0293 A8        		.byte	-88
 4474 0294 2A        		.byte	42
 4475 0295 00        		.byte	0
 4476 0296 00        		.byte	0
 4477 0297 E8        		.byte	-24
 4478 0298 29        		.byte	41
 4479 0299 00        		.byte	0
 4480 029a 00        		.byte	0
 4481 029b BA        		.byte	-70
 4482 029c A6        		.byte	-90
 4483 029d 00        		.byte	0
 4484 029e 00        		.byte	0
 4485 029f BA        		.byte	-70
 4486 02a0 A6        		.byte	-90
 4487 02a1 00        		.byte	0
 4488 02a2 00        		.byte	0
 4489 02a3 BA        		.byte	-70
 4490 02a4 A6        		.byte	-90
 4491 02a5 00        		.byte	0
 4492 02a6 00        		.byte	0
 4493 02a7 BA        		.byte	-70
 4494 02a8 A6        		.byte	-90
 4495 02a9 00        		.byte	0
 4496 02aa 00        		.byte	0
 4497 02ab BA        		.byte	-70
 4498 02ac A6        		.byte	-90
 4499 02ad 00        		.byte	0
 4500 02ae 00        		.byte	0
 4501 02af BA        		.byte	-70
 4502 02b0 A6        		.byte	-90
 4503 02b1 00        		.byte	0
 4504 02b2 00        		.byte	0
 4505 02b3 E8        		.byte	-24
 4506 02b4 29        		.byte	41
 4507 02b5 00        		.byte	0
 4508 02b6 00        		.byte	0
 4509 02b7 A8        		.byte	-88
 4510 02b8 2A        		.byte	42
 4511 02b9 00        		.byte	0
 4512 02ba 00        		.byte	0
 4513 02bb A0        		.byte	-96
 4514 02bc 0A        		.byte	10
 4515 02bd 00        		.byte	0
 4516 02be 00        		.byte	0
 4517 02bf 80        		.byte	-128
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 208


 4518 02c0 02        		.byte	2
 4519 02c1 00        		.byte	0
 4520 02c2 00        		.byte	0
 4521 02c3 00        		.byte	0
 4522 02c4 00        		.byte	0
 4523 02c5 00        		.byte	0
 4524 02c6 00        		.byte	0
 4525 02c7 00        		.byte	0
 4526 02c8 00        		.byte	0
 4527 02c9 00        		.byte	0
 4528 02ca 00        		.byte	0
 4529 02cb 80        		.byte	-128
 4530 02cc 01        		.byte	1
 4531 02cd 00        		.byte	0
 4532 02ce 00        		.byte	0
 4533 02cf 80        		.byte	-128
 4534 02d0 01        		.byte	1
 4535 02d1 00        		.byte	0
 4536 02d2 00        		.byte	0
 4537 02d3 60        		.byte	96
 4538 02d4 05        		.byte	5
 4539 02d5 00        		.byte	0
 4540 02d6 00        		.byte	0
 4541 02d7 60        		.byte	96
 4542 02d8 05        		.byte	5
 4543 02d9 00        		.byte	0
 4544 02da 00        		.byte	0
 4545 02db 60        		.byte	96
 4546 02dc 05        		.byte	5
 4547 02dd 00        		.byte	0
 4548 02de 00        		.byte	0
 4549 02df 60        		.byte	96
 4550 02e0 05        		.byte	5
 4551 02e1 00        		.byte	0
 4552 02e2 00        		.byte	0
 4553 02e3 70        		.byte	112
 4554 02e4 05        		.byte	5
 4555 02e5 00        		.byte	0
 4556 02e6 00        		.byte	0
 4557 02e7 70        		.byte	112
 4558 02e8 05        		.byte	5
 4559 02e9 00        		.byte	0
 4560 02ea 00        		.byte	0
 4561 02eb 60        		.byte	96
 4562 02ec 05        		.byte	5
 4563 02ed 00        		.byte	0
 4564 02ee 00        		.byte	0
 4565 02ef 60        		.byte	96
 4566 02f0 05        		.byte	5
 4567 02f1 00        		.byte	0
 4568 02f2 00        		.byte	0
 4569 02f3 60        		.byte	96
 4570 02f4 05        		.byte	5
 4571 02f5 00        		.byte	0
 4572 02f6 00        		.byte	0
 4573 02f7 60        		.byte	96
 4574 02f8 05        		.byte	5
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 209


 4575 02f9 00        		.byte	0
 4576 02fa 00        		.byte	0
 4577 02fb 80        		.byte	-128
 4578 02fc 01        		.byte	1
 4579 02fd 00        		.byte	0
 4580 02fe 00        		.byte	0
 4581 02ff 80        		.byte	-128
 4582 0300 01        		.byte	1
 4583 0301 00        		.byte	0
 4584 0302 00        		.byte	0
 4585 0303 00        		.byte	0
 4586 0304 00        		.byte	0
 4587 0305 00        		.byte	0
 4588 0306 00        		.byte	0
 4589 0307 00        		.byte	0
 4590 0308 00        		.byte	0
 4591 0309 00        		.byte	0
 4592 030a 00        		.byte	0
 4593 030b 80        		.byte	-128
 4594 030c 00        		.byte	0
 4595 030d 00        		.byte	0
 4596 030e 00        		.byte	0
 4597 030f 80        		.byte	-128
 4598 0310 00        		.byte	0
 4599 0311 00        		.byte	0
 4600 0312 00        		.byte	0
 4601 0313 80        		.byte	-128
 4602 0314 00        		.byte	0
 4603 0315 00        		.byte	0
 4604 0316 00        		.byte	0
 4605 0317 80        		.byte	-128
 4606 0318 00        		.byte	0
 4607 0319 00        		.byte	0
 4608 031a 00        		.byte	0
 4609 031b 80        		.byte	-128
 4610 031c 00        		.byte	0
 4611 031d 00        		.byte	0
 4612 031e 00        		.byte	0
 4613 031f 80        		.byte	-128
 4614 0320 00        		.byte	0
 4615 0321 00        		.byte	0
 4616 0322 00        		.byte	0
 4617 0323 C0        		.byte	-64
 4618 0324 00        		.byte	0
 4619 0325 00        		.byte	0
 4620 0326 00        		.byte	0
 4621 0327 C0        		.byte	-64
 4622 0328 00        		.byte	0
 4623 0329 00        		.byte	0
 4624 032a 00        		.byte	0
 4625 032b 80        		.byte	-128
 4626 032c 00        		.byte	0
 4627 032d 00        		.byte	0
 4628 032e 00        		.byte	0
 4629 032f 80        		.byte	-128
 4630 0330 00        		.byte	0
 4631 0331 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 210


 4632 0332 00        		.byte	0
 4633 0333 80        		.byte	-128
 4634 0334 00        		.byte	0
 4635 0335 00        		.byte	0
 4636 0336 00        		.byte	0
 4637 0337 80        		.byte	-128
 4638 0338 00        		.byte	0
 4639 0339 00        		.byte	0
 4640 033a 00        		.byte	0
 4641 033b 80        		.byte	-128
 4642 033c 00        		.byte	0
 4643 033d 00        		.byte	0
 4644 033e 00        		.byte	0
 4645 033f 80        		.byte	-128
 4646 0340 00        		.byte	0
 4647 0341 00        		.byte	0
 4648 0342 00        		.byte	0
 4649 0343 00        		.byte	0
 4650 0344 00        		.byte	0
 4651 0345 00        		.byte	0
 4652 0346 00        		.byte	0
 4653 0347 00        		.byte	0
 4654 0348 00        		.byte	0
 4655 0349 00        		.byte	0
 4656 034a 00        		.byte	0
 4657 034b C0        		.byte	-64
 4658 034c 01        		.byte	1
 4659 034d 00        		.byte	0
 4660 034e 00        		.byte	0
 4661 034f C0        		.byte	-64
 4662 0350 01        		.byte	1
 4663 0351 00        		.byte	0
 4664 0352 00        		.byte	0
 4665 0353 F0        		.byte	-16
 4666 0354 07        		.byte	7
 4667 0355 00        		.byte	0
 4668 0356 00        		.byte	0
 4669 0357 F0        		.byte	-16
 4670 0358 07        		.byte	7
 4671 0359 00        		.byte	0
 4672 035a 00        		.byte	0
 4673 035b F0        		.byte	-16
 4674 035c 07        		.byte	7
 4675 035d 00        		.byte	0
 4676 035e 00        		.byte	0
 4677 035f F0        		.byte	-16
 4678 0360 07        		.byte	7
 4679 0361 00        		.byte	0
 4680 0362 00        		.byte	0
 4681 0363 F0        		.byte	-16
 4682 0364 07        		.byte	7
 4683 0365 00        		.byte	0
 4684 0366 00        		.byte	0
 4685 0367 F0        		.byte	-16
 4686 0368 07        		.byte	7
 4687 0369 00        		.byte	0
 4688 036a 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 211


 4689 036b F0        		.byte	-16
 4690 036c 07        		.byte	7
 4691 036d 00        		.byte	0
 4692 036e 00        		.byte	0
 4693 036f F0        		.byte	-16
 4694 0370 07        		.byte	7
 4695 0371 00        		.byte	0
 4696 0372 00        		.byte	0
 4697 0373 F0        		.byte	-16
 4698 0374 07        		.byte	7
 4699 0375 00        		.byte	0
 4700 0376 00        		.byte	0
 4701 0377 F0        		.byte	-16
 4702 0378 07        		.byte	7
 4703 0379 00        		.byte	0
 4704 037a 00        		.byte	0
 4705 037b C0        		.byte	-64
 4706 037c 01        		.byte	1
 4707 037d 00        		.byte	0
 4708 037e 00        		.byte	0
 4709 037f C0        		.byte	-64
 4710 0380 01        		.byte	1
 4711 0381 00        		.byte	0
 4712 0382 00        		.byte	0
 4713 0383 00        		.byte	0
 4714 0384 00        		.byte	0
 4715 0385 00        		.byte	0
 4716               	.global	spriteGOOMBA
 4717               		.type	spriteGOOMBA, @object
 4718               		.size	spriteGOOMBA, 19
 4719               	spriteGOOMBA:
 4720 0386 0000      		.word	pgm_imageGOOMBA
 4721 0388 0000      		.word	0
 4722 038a 0000      		.word	pgm_paletteGOOMBA
 4723 038c 06        		.byte	6
 4724 038d 50        		.byte	80
 4725 038e 0000      		.word	GoombaFlip
 4726 0390 0000      		.word	GoombaMotion
 4727 0392 0000      		.word	GoombaLayer
 4728 0394 0000      		.word	GoombaCamMotion
 4729 0396 0000      		.word	GoombaPA
 4730 0398 01        		.byte	1
 4731               	.global	GoombaPA
 4732               		.type	GoombaPA, @object
 4733               		.size	GoombaPA, 10
 4734               	GoombaPA:
 4735 0399 00        		.byte	0
 4736 039a 00        		.byte	0
 4737 039b 01        		.byte	1
 4738 039c 00        		.byte	0
 4739 039d 04        		.byte	4
 4740 039e 10        		.byte	16
 4741 039f 80        		.byte	-128
 4742 03a0 00        		.byte	0
 4743 03a1 01        		.byte	1
 4744 03a2 00        		.byte	0
 4745               	.global	GoombaLayer
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 212


 4746               		.type	GoombaLayer, @object
 4747               		.size	GoombaLayer, 10
 4748               	GoombaLayer:
 4749 03a3 FF        		.byte	-1
 4750 03a4 FF        		.byte	-1
 4751 03a5 00        		.byte	0
 4752 03a6 00        		.byte	0
 4753 03a7 00        		.byte	0
 4754 03a8 00        		.byte	0
 4755 03a9 00        		.byte	0
 4756 03aa 00        		.byte	0
 4757 03ab 00        		.byte	0
 4758 03ac 00        		.byte	0
 4759               	.global	GoombaCamMotion
 4760               		.type	GoombaCamMotion, @object
 4761               		.size	GoombaCamMotion, 6
 4762               	GoombaCamMotion:
 4763 03ad 00        		.byte	0
 4764 03ae 0000      		.word	0
 4765 03b0 00        		.byte	0
 4766 03b1 0000      		.word	GoombaCamY
 4767               	.global	GoombaCamY
 4768               		.type	GoombaCamY, @object
 4769               		.size	GoombaCamY, 20
 4770               	GoombaCamY:
 4771 03b3 55        		.byte	85
 4772 03b4 55        		.byte	85
 4773 03b5 55        		.byte	85
 4774 03b6 55        		.byte	85
 4775 03b7 00        		.byte	0
 4776 03b8 00        		.byte	0
 4777 03b9 03        		.byte	3
 4778 03ba 00        		.byte	0
 4779 03bb 00        		.byte	0
 4780 03bc 00        		.byte	0
 4781 03bd 00        		.byte	0
 4782 03be 00        		.byte	0
 4783 03bf 00        		.byte	0
 4784 03c0 00        		.byte	0
 4785 03c1 00        		.byte	0
 4786 03c2 00        		.byte	0
 4787 03c3 55        		.byte	85
 4788 03c4 55        		.byte	85
 4789 03c5 55        		.byte	85
 4790 03c6 55        		.byte	85
 4791               	.global	GoombaMotion
 4792               		.type	GoombaMotion, @object
 4793               		.size	GoombaMotion, 6
 4794               	GoombaMotion:
 4795 03c7 00        		.byte	0
 4796 03c8 0000      		.word	0
 4797 03ca F0        		.byte	-16
 4798 03cb 0000      		.word	GoombaY
 4799               	.global	GoombaY
 4800               		.type	GoombaY, @object
 4801               		.size	GoombaY, 20
 4802               	GoombaY:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 213


 4803 03cd AA        		.byte	-86
 4804 03ce AA        		.byte	-86
 4805 03cf AA        		.byte	-86
 4806 03d0 AA        		.byte	-86
 4807 03d1 00        		.byte	0
 4808 03d2 00        		.byte	0
 4809 03d3 00        		.byte	0
 4810 03d4 00        		.byte	0
 4811 03d5 00        		.byte	0
 4812 03d6 00        		.byte	0
 4813 03d7 00        		.byte	0
 4814 03d8 00        		.byte	0
 4815 03d9 00        		.byte	0
 4816 03da 00        		.byte	0
 4817 03db 00        		.byte	0
 4818 03dc 00        		.byte	0
 4819 03dd 00        		.byte	0
 4820 03de 00        		.byte	0
 4821 03df 00        		.byte	0
 4822 03e0 00        		.byte	0
 4823               	.global	GoombaFlip
 4824               		.type	GoombaFlip, @object
 4825               		.size	GoombaFlip, 10
 4826               	GoombaFlip:
 4827 03e1 AA        		.byte	-86
 4828 03e2 AA        		.byte	-86
 4829 03e3 AA        		.byte	-86
 4830 03e4 AA        		.byte	-86
 4831 03e5 AA        		.byte	-86
 4832 03e6 AA        		.byte	-86
 4833 03e7 AA        		.byte	-86
 4834 03e8 AA        		.byte	-86
 4835 03e9 FF        		.byte	-1
 4836 03ea FF        		.byte	-1
 4837               		.type	pgm_paletteGOOMBA, @object
 4838               		.size	pgm_paletteGOOMBA, 24
 4839               	pgm_paletteGOOMBA:
 4840 03eb 25        		.byte	37
 4841 03ec 02        		.byte	2
 4842 03ed 27        		.byte	39
 4843 03ee 00        		.byte	0
 4844 03ef 08        		.byte	8
 4845 03f0 02        		.byte	2
 4846 03f1 27        		.byte	39
 4847 03f2 00        		.byte	0
 4848 03f3 0E        		.byte	14
 4849 03f4 02        		.byte	2
 4850 03f5 27        		.byte	39
 4851 03f6 00        		.byte	0
 4852 03f7 0A        		.byte	10
 4853 03f8 02        		.byte	2
 4854 03f9 27        		.byte	39
 4855 03fa 00        		.byte	0
 4856 03fb 03        		.byte	3
 4857 03fc 01        		.byte	1
 4858 03fd 26        		.byte	38
 4859 03fe 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 214


 4860 03ff 00        		.byte	0
 4861 0400 20        		.byte	32
 4862 0401 01        		.byte	1
 4863 0402 20        		.byte	32
 4864               		.type	pgm_imageGOOMBA, @object
 4865               		.size	pgm_imageGOOMBA, 64
 4866               	pgm_imageGOOMBA:
 4867 0403 00        		.byte	0
 4868 0404 50        		.byte	80
 4869 0405 05        		.byte	5
 4870 0406 00        		.byte	0
 4871 0407 00        		.byte	0
 4872 0408 54        		.byte	84
 4873 0409 15        		.byte	21
 4874 040a 00        		.byte	0
 4875 040b 00        		.byte	0
 4876 040c 55        		.byte	85
 4877 040d 55        		.byte	85
 4878 040e 00        		.byte	0
 4879 040f 40        		.byte	64
 4880 0410 55        		.byte	85
 4881 0411 55        		.byte	85
 4882 0412 01        		.byte	1
 4883 0413 D0        		.byte	-48
 4884 0414 57        		.byte	87
 4885 0415 D5        		.byte	-43
 4886 0416 07        		.byte	7
 4887 0417 54        		.byte	84
 4888 0418 5E        		.byte	94
 4889 0419 B5        		.byte	-75
 4890 041a 15        		.byte	21
 4891 041b 54        		.byte	84
 4892 041c FE        		.byte	-2
 4893 041d BF        		.byte	-65
 4894 041e 15        		.byte	21
 4895 041f 55        		.byte	85
 4896 0420 6E        		.byte	110
 4897 0421 B9        		.byte	-71
 4898 0422 55        		.byte	85
 4899 0423 55        		.byte	85
 4900 0424 6A        		.byte	106
 4901 0425 A9        		.byte	-87
 4902 0426 55        		.byte	85
 4903 0427 55        		.byte	85
 4904 0428 55        		.byte	85
 4905 0429 55        		.byte	85
 4906 042a 55        		.byte	85
 4907 042b 54        		.byte	84
 4908 042c A9        		.byte	-87
 4909 042d 6A        		.byte	106
 4910 042e 15        		.byte	21
 4911 042f 00        		.byte	0
 4912 0430 AA        		.byte	-86
 4913 0431 AA        		.byte	-86
 4914 0432 00        		.byte	0
 4915 0433 00        		.byte	0
 4916 0434 AA        		.byte	-86
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 215


 4917 0435 AA        		.byte	-86
 4918 0436 0F        		.byte	15
 4919 0437 C0        		.byte	-64
 4920 0438 AB        		.byte	-85
 4921 0439 FA        		.byte	-6
 4922 043a 3F        		.byte	63
 4923 043b C0        		.byte	-64
 4924 043c AF        		.byte	-81
 4925 043d FE        		.byte	-2
 4926 043e 3F        		.byte	63
 4927 043f 00        		.byte	0
 4928 0440 BF        		.byte	-65
 4929 0441 FF        		.byte	-1
 4930 0442 0F        		.byte	15
 4931               	.global	spriteSTAR
 4932               		.type	spriteSTAR, @object
 4933               		.size	spriteSTAR, 19
 4934               	spriteSTAR:
 4935 0443 0000      		.word	pgm_imageSTAR
 4936 0445 0000      		.word	0
 4937 0447 0000      		.word	pgm_paletteSTAR
 4938 0449 02        		.byte	2
 4939 044a 28        		.byte	40
 4940 044b 0000      		.word	0
 4941 044d 0000      		.word	DefaultMotion
 4942 044f 0000      		.word	DefaultLayer
 4943 0451 0000      		.word	DefaultCamMotion
 4944 0453 0000      		.word	FlowerPA
 4945 0455 01        		.byte	1
 4946               		.type	pgm_paletteSTAR, @object
 4947               		.size	pgm_paletteSTAR, 8
 4948               	pgm_paletteSTAR:
 4949 0456 25        		.byte	37
 4950 0457 07        		.byte	7
 4951 0458 02        		.byte	2
 4952 0459 00        		.byte	0
 4953 045a 25        		.byte	37
 4954 045b 02        		.byte	2
 4955 045c 00        		.byte	0
 4956 045d 00        		.byte	0
 4957               		.type	pgm_imageSTAR, @object
 4958               		.size	pgm_imageSTAR, 64
 4959               	pgm_imageSTAR:
 4960 045e 00        		.byte	0
 4961 045f 40        		.byte	64
 4962 0460 01        		.byte	1
 4963 0461 00        		.byte	0
 4964 0462 00        		.byte	0
 4965 0463 40        		.byte	64
 4966 0464 01        		.byte	1
 4967 0465 00        		.byte	0
 4968 0466 00        		.byte	0
 4969 0467 50        		.byte	80
 4970 0468 05        		.byte	5
 4971 0469 00        		.byte	0
 4972 046a 00        		.byte	0
 4973 046b 50        		.byte	80
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 216


 4974 046c 05        		.byte	5
 4975 046d 00        		.byte	0
 4976 046e 00        		.byte	0
 4977 046f 54        		.byte	84
 4978 0470 15        		.byte	21
 4979 0471 00        		.byte	0
 4980 0472 54        		.byte	84
 4981 0473 55        		.byte	85
 4982 0474 55        		.byte	85
 4983 0475 15        		.byte	21
 4984 0476 54        		.byte	84
 4985 0477 65        		.byte	101
 4986 0478 59        		.byte	89
 4987 0479 15        		.byte	21
 4988 047a 50        		.byte	80
 4989 047b 65        		.byte	101
 4990 047c 59        		.byte	89
 4991 047d 05        		.byte	5
 4992 047e 40        		.byte	64
 4993 047f 65        		.byte	101
 4994 0480 59        		.byte	89
 4995 0481 01        		.byte	1
 4996 0482 00        		.byte	0
 4997 0483 55        		.byte	85
 4998 0484 55        		.byte	85
 4999 0485 00        		.byte	0
 5000 0486 00        		.byte	0
 5001 0487 55        		.byte	85
 5002 0488 55        		.byte	85
 5003 0489 00        		.byte	0
 5004 048a 40        		.byte	64
 5005 048b 55        		.byte	85
 5006 048c 55        		.byte	85
 5007 048d 01        		.byte	1
 5008 048e 40        		.byte	64
 5009 048f 55        		.byte	85
 5010 0490 55        		.byte	85
 5011 0491 01        		.byte	1
 5012 0492 40        		.byte	64
 5013 0493 15        		.byte	21
 5014 0494 54        		.byte	84
 5015 0495 01        		.byte	1
 5016 0496 50        		.byte	80
 5017 0497 01        		.byte	1
 5018 0498 40        		.byte	64
 5019 0499 05        		.byte	5
 5020 049a 50        		.byte	80
 5021 049b 00        		.byte	0
 5022 049c 00        		.byte	0
 5023 049d 05        		.byte	5
 5024               	.global	spriteBIG
 5025               		.type	spriteBIG, @object
 5026               		.size	spriteBIG, 19
 5027               	spriteBIG:
 5028 049e 0000      		.word	pgm_imageSHROOM
 5029 04a0 0000      		.word	0
 5030 04a2 0000      		.word	pgm_paletteBIG
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 217


 5031 04a4 01        		.byte	1
 5032 04a5 28        		.byte	40
 5033 04a6 0000      		.word	0
 5034 04a8 0000      		.word	DefaultMotion
 5035 04aa 0000      		.word	DefaultLayer
 5036 04ac 0000      		.word	DefaultCamMotion
 5037 04ae 0000      		.word	0
 5038 04b0 01        		.byte	1
 5039               		.type	pgm_paletteBIG, @object
 5040               		.size	pgm_paletteBIG, 4
 5041               	pgm_paletteBIG:
 5042 04b1 25        		.byte	37
 5043 04b2 07        		.byte	7
 5044 04b3 02        		.byte	2
 5045 04b4 2F        		.byte	47
 5046               	.global	sprite1UP
 5047               		.type	sprite1UP, @object
 5048               		.size	sprite1UP, 19
 5049               	sprite1UP:
 5050 04b5 0000      		.word	pgm_imageSHROOM
 5051 04b7 0000      		.word	0
 5052 04b9 0000      		.word	pgm_palette1UP
 5053 04bb 01        		.byte	1
 5054 04bc 28        		.byte	40
 5055 04bd 0000      		.word	0
 5056 04bf 0000      		.word	DefaultMotion
 5057 04c1 0000      		.word	DefaultLayer
 5058 04c3 0000      		.word	DefaultCamMotion
 5059 04c5 0000      		.word	0
 5060 04c7 01        		.byte	1
 5061               		.type	pgm_palette1UP, @object
 5062               		.size	pgm_palette1UP, 4
 5063               	pgm_palette1UP:
 5064 04c8 25        		.byte	37
 5065 04c9 07        		.byte	7
 5066 04ca 04        		.byte	4
 5067 04cb 2F        		.byte	47
 5068               		.type	pgm_imageSHROOM, @object
 5069               		.size	pgm_imageSHROOM, 64
 5070               	pgm_imageSHROOM:
 5071 04cc 00        		.byte	0
 5072 04cd 50        		.byte	80
 5073 04ce 05        		.byte	5
 5074 04cf 00        		.byte	0
 5075 04d0 00        		.byte	0
 5076 04d1 54        		.byte	84
 5077 04d2 29        		.byte	41
 5078 04d3 00        		.byte	0
 5079 04d4 00        		.byte	0
 5080 04d5 55        		.byte	85
 5081 04d6 AA        		.byte	-86
 5082 04d7 00        		.byte	0
 5083 04d8 40        		.byte	64
 5084 04d9 55        		.byte	85
 5085 04da AA        		.byte	-86
 5086 04db 02        		.byte	2
 5087 04dc 50        		.byte	80
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 218


 5088 04dd 55        		.byte	85
 5089 04de A9        		.byte	-87
 5090 04df 05        		.byte	5
 5091 04e0 94        		.byte	-108
 5092 04e1 5A        		.byte	90
 5093 04e2 55        		.byte	85
 5094 04e3 15        		.byte	21
 5095 04e4 A4        		.byte	-92
 5096 04e5 6A        		.byte	106
 5097 04e6 55        		.byte	85
 5098 04e7 15        		.byte	21
 5099 04e8 A5        		.byte	-91
 5100 04e9 6A        		.byte	106
 5101 04ea 55        		.byte	85
 5102 04eb 5A        		.byte	90
 5103 04ec A5        		.byte	-91
 5104 04ed 6A        		.byte	106
 5105 04ee 55        		.byte	85
 5106 04ef 6A        		.byte	106
 5107 04f0 95        		.byte	-107
 5108 04f1 5A        		.byte	90
 5109 04f2 55        		.byte	85
 5110 04f3 69        		.byte	105
 5111 04f4 55        		.byte	85
 5112 04f5 55        		.byte	85
 5113 04f6 55        		.byte	85
 5114 04f7 55        		.byte	85
 5115 04f8 A4        		.byte	-92
 5116 04f9 FE        		.byte	-2
 5117 04fa BF        		.byte	-65
 5118 04fb 1A        		.byte	26
 5119 04fc 00        		.byte	0
 5120 04fd FF        		.byte	-1
 5121 04fe FF        		.byte	-1
 5122 04ff 00        		.byte	0
 5123 0500 00        		.byte	0
 5124 0501 FF        		.byte	-1
 5125 0502 DF        		.byte	-33
 5126 0503 00        		.byte	0
 5127 0504 00        		.byte	0
 5128 0505 FF        		.byte	-1
 5129 0506 DF        		.byte	-33
 5130 0507 00        		.byte	0
 5131 0508 00        		.byte	0
 5132 0509 FC        		.byte	-4
 5133 050a 37        		.byte	55
 5134 050b 00        		.byte	0
 5135               	.global	spriteDEADGOOMBA
 5136               		.type	spriteDEADGOOMBA, @object
 5137               		.size	spriteDEADGOOMBA, 19
 5138               	spriteDEADGOOMBA:
 5139 050c 0000      		.word	pgm_imageDEADGOOMBA
 5140 050e 0000      		.word	0
 5141 0510 0000      		.word	pgm_paletteDEADGOOMBA
 5142 0512 01        		.byte	1
 5143 0513 14        		.byte	20
 5144 0514 0000      		.word	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 219


 5145 0516 0000      		.word	DeadGoombaMotion
 5146 0518 0000      		.word	0
 5147 051a 0000      		.word	DeadGoombaCamMotion
 5148 051c 0000      		.word	0
 5149 051e 01        		.byte	1
 5150               	.global	DeadGoombaCamMotion
 5151               		.type	DeadGoombaCamMotion, @object
 5152               		.size	DeadGoombaCamMotion, 6
 5153               	DeadGoombaCamMotion:
 5154 051f 00        		.byte	0
 5155 0520 0000      		.word	0
 5156 0522 10        		.byte	16
 5157 0523 0000      		.word	DeadGoombaCamY
 5158               	.global	DeadGoombaCamY
 5159               		.type	DeadGoombaCamY, @object
 5160               		.size	DeadGoombaCamY, 5
 5161               	DeadGoombaCamY:
 5162 0525 03        		.byte	3
 5163 0526 55        		.byte	85
 5164 0527 55        		.byte	85
 5165 0528 55        		.byte	85
 5166 0529 55        		.byte	85
 5167               	.global	DeadGoombaMotion
 5168               		.type	DeadGoombaMotion, @object
 5169               		.size	DeadGoombaMotion, 6
 5170               	DeadGoombaMotion:
 5171 052a 00        		.byte	0
 5172 052b 0000      		.word	0
 5173 052d 10        		.byte	16
 5174 052e 0000      		.word	0
 5175               		.type	pgm_paletteDEADGOOMBA, @object
 5176               		.size	pgm_paletteDEADGOOMBA, 4
 5177               	pgm_paletteDEADGOOMBA:
 5178 0530 25        		.byte	37
 5179 0531 02        		.byte	2
 5180 0532 27        		.byte	39
 5181 0533 00        		.byte	0
 5182               		.type	pgm_imageDEADGOOMBA, @object
 5183               		.size	pgm_imageDEADGOOMBA, 64
 5184               	pgm_imageDEADGOOMBA:
 5185 0534 00        		.byte	0
 5186 0535 00        		.byte	0
 5187 0536 00        		.byte	0
 5188 0537 00        		.byte	0
 5189 0538 00        		.byte	0
 5190 0539 00        		.byte	0
 5191 053a 00        		.byte	0
 5192 053b 00        		.byte	0
 5193 053c 00        		.byte	0
 5194 053d 00        		.byte	0
 5195 053e 00        		.byte	0
 5196 053f 00        		.byte	0
 5197 0540 00        		.byte	0
 5198 0541 00        		.byte	0
 5199 0542 00        		.byte	0
 5200 0543 00        		.byte	0
 5201 0544 00        		.byte	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 220


 5202 0545 00        		.byte	0
 5203 0546 00        		.byte	0
 5204 0547 00        		.byte	0
 5205 0548 00        		.byte	0
 5206 0549 00        		.byte	0
 5207 054a 00        		.byte	0
 5208 054b 00        		.byte	0
 5209 054c 00        		.byte	0
 5210 054d 00        		.byte	0
 5211 054e 00        		.byte	0
 5212 054f 00        		.byte	0
 5213 0550 00        		.byte	0
 5214 0551 50        		.byte	80
 5215 0552 05        		.byte	5
 5216 0553 00        		.byte	0
 5217 0554 40        		.byte	64
 5218 0555 55        		.byte	85
 5219 0556 55        		.byte	85
 5220 0557 01        		.byte	1
 5221 0558 D4        		.byte	-44
 5222 0559 5F        		.byte	95
 5223 055a F5        		.byte	-11
 5224 055b 17        		.byte	23
 5225 055c A5        		.byte	-91
 5226 055d FA        		.byte	-6
 5227 055e AF        		.byte	-81
 5228 055f 5A        		.byte	90
 5229 0560 55        		.byte	85
 5230 0561 55        		.byte	85
 5231 0562 55        		.byte	85
 5232 0563 55        		.byte	85
 5233 0564 80        		.byte	-128
 5234 0565 AA        		.byte	-86
 5235 0566 AA        		.byte	-86
 5236 0567 02        		.byte	2
 5237 0568 80        		.byte	-128
 5238 0569 AA        		.byte	-86
 5239 056a AA        		.byte	-86
 5240 056b 02        		.byte	2
 5241 056c F0        		.byte	-16
 5242 056d 0F        		.byte	15
 5243 056e F0        		.byte	-16
 5244 056f 3F        		.byte	63
 5245 0570 00        		.byte	0
 5246 0571 00        		.byte	0
 5247 0572 00        		.byte	0
 5248 0573 00        		.byte	0
 5249               	.global	spriteSOLID
 5250               		.type	spriteSOLID, @object
 5251               		.size	spriteSOLID, 19
 5252               	spriteSOLID:
 5253 0574 0000      		.word	pgm_imageSOLID
 5254 0576 0000      		.word	0
 5255 0578 0000      		.word	pgm_paletteSOLID
 5256 057a 01        		.byte	1
 5257 057b 08        		.byte	8
 5258 057c 0000      		.word	0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 221


 5259 057e 0000      		.word	NadaMotion
 5260 0580 0000      		.word	0
 5261 0582 0000      		.word	NadaMotion
 5262 0584 0000      		.word	0
 5263 0586 01        		.byte	1
 5264               		.type	pgm_paletteSOLID, @object
 5265               		.size	pgm_paletteSOLID, 4
 5266               	pgm_paletteSOLID:
 5267 0587 25        		.byte	37
 5268 0588 02        		.byte	2
 5269 0589 00        		.byte	0
 5270 058a 00        		.byte	0
 5271               		.type	pgm_imageSOLID, @object
 5272               		.size	pgm_imageSOLID, 64
 5273               	pgm_imageSOLID:
 5274 058b FC        		.byte	-4
 5275 058c FF        		.byte	-1
 5276 058d FF        		.byte	-1
 5277 058e 3F        		.byte	63
 5278 058f 57        		.byte	87
 5279 0590 55        		.byte	85
 5280 0591 55        		.byte	85
 5281 0592 D5        		.byte	-43
 5282 0593 77        		.byte	119
 5283 0594 55        		.byte	85
 5284 0595 55        		.byte	85
 5285 0596 DD        		.byte	-35
 5286 0597 57        		.byte	87
 5287 0598 55        		.byte	85
 5288 0599 55        		.byte	85
 5289 059a D5        		.byte	-43
 5290 059b 57        		.byte	87
 5291 059c 55        		.byte	85
 5292 059d 55        		.byte	85
 5293 059e D5        		.byte	-43
 5294 059f 57        		.byte	87
 5295 05a0 55        		.byte	85
 5296 05a1 55        		.byte	85
 5297 05a2 D5        		.byte	-43
 5298 05a3 57        		.byte	87
 5299 05a4 55        		.byte	85
 5300 05a5 55        		.byte	85
 5301 05a6 D5        		.byte	-43
 5302 05a7 57        		.byte	87
 5303 05a8 55        		.byte	85
 5304 05a9 55        		.byte	85
 5305 05aa D5        		.byte	-43
 5306 05ab 57        		.byte	87
 5307 05ac 55        		.byte	85
 5308 05ad 55        		.byte	85
 5309 05ae D5        		.byte	-43
 5310 05af 57        		.byte	87
 5311 05b0 55        		.byte	85
 5312 05b1 55        		.byte	85
 5313 05b2 D5        		.byte	-43
 5314 05b3 57        		.byte	87
 5315 05b4 55        		.byte	85
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 222


 5316 05b5 55        		.byte	85
 5317 05b6 D5        		.byte	-43
 5318 05b7 57        		.byte	87
 5319 05b8 55        		.byte	85
 5320 05b9 55        		.byte	85
 5321 05ba D5        		.byte	-43
 5322 05bb 57        		.byte	87
 5323 05bc 55        		.byte	85
 5324 05bd 55        		.byte	85
 5325 05be D5        		.byte	-43
 5326 05bf 77        		.byte	119
 5327 05c0 55        		.byte	85
 5328 05c1 55        		.byte	85
 5329 05c2 DD        		.byte	-35
 5330 05c3 57        		.byte	87
 5331 05c4 55        		.byte	85
 5332 05c5 55        		.byte	85
 5333 05c6 D5        		.byte	-43
 5334 05c7 FC        		.byte	-4
 5335 05c8 FF        		.byte	-1
 5336 05c9 FF        		.byte	-1
 5337 05ca 3F        		.byte	63
 5338               	.global	spriteQ
 5339               		.type	spriteQ, @object
 5340               		.size	spriteQ, 19
 5341               	spriteQ:
 5342 05cb 0000      		.word	pgm_imageQ
 5343 05cd 0000      		.word	0
 5344 05cf 0000      		.word	pgm_paletteQ
 5345 05d1 04        		.byte	4
 5346 05d2 3C        		.byte	60
 5347 05d3 0000      		.word	0
 5348 05d5 0000      		.word	NadaMotion
 5349 05d7 0000      		.word	0
 5350 05d9 0000      		.word	NadaMotion
 5351 05db 0000      		.word	QPaletteAdvance
 5352 05dd 01        		.byte	1
 5353               	.global	QPaletteAdvance
 5354               		.type	QPaletteAdvance, @object
 5355               		.size	QPaletteAdvance, 8
 5356               	QPaletteAdvance:
 5357 05de A8        		.byte	-88
 5358 05df 82        		.byte	-126
 5359 05e0 2A        		.byte	42
 5360 05e1 A8        		.byte	-88
 5361 05e2 82        		.byte	-126
 5362 05e3 2A        		.byte	42
 5363 05e4 A8        		.byte	-88
 5364 05e5 02        		.byte	2
 5365               		.type	pgm_paletteQ, @object
 5366               		.size	pgm_paletteQ, 16
 5367               	pgm_paletteQ:
 5368 05e6 25        		.byte	37
 5369 05e7 02        		.byte	2
 5370 05e8 07        		.byte	7
 5371 05e9 00        		.byte	0
 5372 05ea 25        		.byte	37
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 223


 5373 05eb 02        		.byte	2
 5374 05ec 02        		.byte	2
 5375 05ed 00        		.byte	0
 5376 05ee 25        		.byte	37
 5377 05ef 02        		.byte	2
 5378 05f0 01        		.byte	1
 5379 05f1 00        		.byte	0
 5380 05f2 25        		.byte	37
 5381 05f3 02        		.byte	2
 5382 05f4 02        		.byte	2
 5383 05f5 00        		.byte	0
 5384               		.type	pgm_imageQ, @object
 5385               		.size	pgm_imageQ, 64
 5386               	pgm_imageQ:
 5387 05f6 54        		.byte	84
 5388 05f7 55        		.byte	85
 5389 05f8 55        		.byte	85
 5390 05f9 15        		.byte	21
 5391 05fa A9        		.byte	-87
 5392 05fb AA        		.byte	-86
 5393 05fc AA        		.byte	-86
 5394 05fd EA        		.byte	-22
 5395 05fe B9        		.byte	-71
 5396 05ff AA        		.byte	-86
 5397 0600 AA        		.byte	-86
 5398 0601 EE        		.byte	-18
 5399 0602 A9        		.byte	-87
 5400 0603 56        		.byte	86
 5401 0604 A5        		.byte	-91
 5402 0605 EA        		.byte	-22
 5403 0606 A9        		.byte	-87
 5404 0607 F5        		.byte	-11
 5405 0608 97        		.byte	-105
 5406 0609 EA        		.byte	-22
 5407 060a A9        		.byte	-87
 5408 060b B5        		.byte	-75
 5409 060c D6        		.byte	-42
 5410 060d EA        		.byte	-22
 5411 060e A9        		.byte	-87
 5412 060f B5        		.byte	-75
 5413 0610 D6        		.byte	-42
 5414 0611 EA        		.byte	-22
 5415 0612 A9        		.byte	-87
 5416 0613 BE        		.byte	-66
 5417 0614 D5        		.byte	-43
 5418 0615 EA        		.byte	-22
 5419 0616 A9        		.byte	-87
 5420 0617 6A        		.byte	106
 5421 0618 FD        		.byte	-3
 5422 0619 EA        		.byte	-22
 5423 061a A9        		.byte	-87
 5424 061b 6A        		.byte	106
 5425 061c AD        		.byte	-83
 5426 061d EA        		.byte	-22
 5427 061e A9        		.byte	-87
 5428 061f AA        		.byte	-86
 5429 0620 AF        		.byte	-81
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 224


 5430 0621 EA        		.byte	-22
 5431 0622 A9        		.byte	-87
 5432 0623 6A        		.byte	106
 5433 0624 A9        		.byte	-87
 5434 0625 EA        		.byte	-22
 5435 0626 A9        		.byte	-87
 5436 0627 6A        		.byte	106
 5437 0628 AD        		.byte	-83
 5438 0629 EA        		.byte	-22
 5439 062a B9        		.byte	-71
 5440 062b AA        		.byte	-86
 5441 062c AF        		.byte	-81
 5442 062d EE        		.byte	-18
 5443 062e A9        		.byte	-87
 5444 062f AA        		.byte	-86
 5445 0630 AA        		.byte	-86
 5446 0631 EA        		.byte	-22
 5447 0632 FF        		.byte	-1
 5448 0633 FF        		.byte	-1
 5449 0634 FF        		.byte	-1
 5450 0635 FF        		.byte	-1
 5451               	.global	spriteFLOWER
 5452               		.type	spriteFLOWER, @object
 5453               		.size	spriteFLOWER, 19
 5454               	spriteFLOWER:
 5455 0636 0000      		.word	pgm_imageFLOWER
 5456 0638 0000      		.word	0
 5457 063a 0000      		.word	pgm_paletteFLOWER
 5458 063c 03        		.byte	3
 5459 063d 28        		.byte	40
 5460 063e 0000      		.word	0
 5461 0640 0000      		.word	DefaultMotion
 5462 0642 0000      		.word	DefaultLayer
 5463 0644 0000      		.word	DefaultCamMotion
 5464 0646 0000      		.word	FlowerPA
 5465 0648 01        		.byte	1
 5466               	.global	FlowerPA
 5467               		.type	FlowerPA, @object
 5468               		.size	FlowerPA, 5
 5469               	FlowerPA:
 5470 0649 FF        		.byte	-1
 5471 064a FF        		.byte	-1
 5472 064b FF        		.byte	-1
 5473 064c FF        		.byte	-1
 5474 064d FF        		.byte	-1
 5475               		.type	pgm_paletteFLOWER, @object
 5476               		.size	pgm_paletteFLOWER, 16
 5477               	pgm_paletteFLOWER:
 5478 064e 25        		.byte	37
 5479 064f 2F        		.byte	47
 5480 0650 07        		.byte	7
 5481 0651 04        		.byte	4
 5482 0652 25        		.byte	37
 5483 0653 17        		.byte	23
 5484 0654 02        		.byte	2
 5485 0655 00        		.byte	0
 5486 0656 25        		.byte	37
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 225


 5487 0657 07        		.byte	7
 5488 0658 05        		.byte	5
 5489 0659 02        		.byte	2
 5490 065a 25        		.byte	37
 5491 065b 04        		.byte	4
 5492 065c 00        		.byte	0
 5493 065d 00        		.byte	0
 5494               		.type	pgm_imageFLOWER, @object
 5495               		.size	pgm_imageFLOWER, 64
 5496               	pgm_imageFLOWER:
 5497 065e 00        		.byte	0
 5498 065f 55        		.byte	85
 5499 0660 55        		.byte	85
 5500 0661 00        		.byte	0
 5501 0662 50        		.byte	80
 5502 0663 55        		.byte	85
 5503 0664 55        		.byte	85
 5504 0665 05        		.byte	5
 5505 0666 54        		.byte	84
 5506 0667 AA        		.byte	-86
 5507 0668 AA        		.byte	-86
 5508 0669 15        		.byte	21
 5509 066a A5        		.byte	-91
 5510 066b FE        		.byte	-2
 5511 066c BF        		.byte	-65
 5512 066d 5A        		.byte	90
 5513 066e A5        		.byte	-91
 5514 066f FE        		.byte	-2
 5515 0670 BF        		.byte	-65
 5516 0671 5A        		.byte	90
 5517 0672 54        		.byte	84
 5518 0673 AA        		.byte	-86
 5519 0674 AA        		.byte	-86
 5520 0675 15        		.byte	21
 5521 0676 50        		.byte	80
 5522 0677 55        		.byte	85
 5523 0678 55        		.byte	85
 5524 0679 05        		.byte	5
 5525 067a 00        		.byte	0
 5526 067b 55        		.byte	85
 5527 067c 55        		.byte	85
 5528 067d 00        		.byte	0
 5529 067e 00        		.byte	0
 5530 067f 40        		.byte	64
 5531 0680 01        		.byte	1
 5532 0681 00        		.byte	0
 5533 0682 15        		.byte	21
 5534 0683 40        		.byte	64
 5535 0684 01        		.byte	1
 5536 0685 54        		.byte	84
 5537 0686 54        		.byte	84
 5538 0687 40        		.byte	64
 5539 0688 01        		.byte	1
 5540 0689 15        		.byte	21
 5541 068a 54        		.byte	84
 5542 068b 41        		.byte	65
 5543 068c 41        		.byte	65
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 226


 5544 068d 15        		.byte	21
 5545 068e 50        		.byte	80
 5546 068f 45        		.byte	69
 5547 0690 51        		.byte	81
 5548 0691 05        		.byte	5
 5549 0692 50        		.byte	80
 5550 0693 45        		.byte	69
 5551 0694 51        		.byte	81
 5552 0695 05        		.byte	5
 5553 0696 40        		.byte	64
 5554 0697 55        		.byte	85
 5555 0698 55        		.byte	85
 5556 0699 01        		.byte	1
 5557 069a 00        		.byte	0
 5558 069b 50        		.byte	80
 5559 069c 05        		.byte	5
 5560 069d 00        		.byte	0
 5561               	.global	DefaultCamMotion
 5562               		.type	DefaultCamMotion, @object
 5563               		.size	DefaultCamMotion, 6
 5564               	DefaultCamMotion:
 5565 069e 00        		.byte	0
 5566 069f 0000      		.word	0
 5567 06a1 00        		.byte	0
 5568 06a2 0000      		.word	DefaultCamY
 5569               	.global	DefaultCamY
 5570               		.type	DefaultCamY, @object
 5571               		.size	DefaultCamY, 10
 5572               	DefaultCamY:
 5573 06a4 55        		.byte	85
 5574 06a5 55        		.byte	85
 5575 06a6 55        		.byte	85
 5576 06a7 55        		.byte	85
 5577 06a8 00        		.byte	0
 5578 06a9 03        		.byte	3
 5579 06aa 55        		.byte	85
 5580 06ab 55        		.byte	85
 5581 06ac 55        		.byte	85
 5582 06ad 55        		.byte	85
 5583               	.global	DefaultLayer
 5584               		.type	DefaultLayer, @object
 5585               		.size	DefaultLayer, 5
 5586               	DefaultLayer:
 5587 06ae FF        		.byte	-1
 5588 06af FF        		.byte	-1
 5589 06b0 00        		.byte	0
 5590 06b1 00        		.byte	0
 5591 06b2 00        		.byte	0
 5592               	.global	DefaultMotion
 5593               		.type	DefaultMotion, @object
 5594               		.size	DefaultMotion, 6
 5595               	DefaultMotion:
 5596 06b3 00        		.byte	0
 5597 06b4 0000      		.word	0
 5598 06b6 F0        		.byte	-16
 5599 06b7 0000      		.word	DefaultY
 5600               	.global	DefaultY
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 227


 5601               		.type	DefaultY, @object
 5602               		.size	DefaultY, 10
 5603               	DefaultY:
 5604 06b9 AA        		.byte	-86
 5605 06ba AA        		.byte	-86
 5606 06bb AA        		.byte	-86
 5607 06bc AA        		.byte	-86
 5608 06bd 00        		.byte	0
 5609 06be 00        		.byte	0
 5610 06bf 00        		.byte	0
 5611 06c0 00        		.byte	0
 5612 06c1 00        		.byte	0
 5613 06c2 00        		.byte	0
 5614               	.global	NadaMotion
 5615               		.type	NadaMotion, @object
 5616               		.size	NadaMotion, 6
 5617               	NadaMotion:
 5618 06c3 0000 0000 		.zero	6
 5618      0000 
 5619               		.comm	cameraState,14,1
 5620               		.comm	nowSpriteState,14,1
 5621               	.global	skyOverrideSprite
 5622               		.section .bss
 5623               		.type	skyOverrideSprite, @object
 5624               		.size	skyOverrideSprite, 2
 5625               	skyOverrideSprite:
 5626 0007 0000      		.zero	2
 5627               		.comm	wc_color,2,1
 5628               		.comm	frameBuffer,272,1
 5629               	.global	header
 5630               		.section	.progmem.data,"a",@progbits
 5631               		.type	header, @object
 5632               		.size	header, 36
 5633               	header:
 5634 06c9 4C43 4464 		.string	"LCDdirectLVDS90 2014-07-09 08:15:26"
 5634      6972 6563 
 5634      744C 5644 
 5634      5339 3020 
 5634      3230 3134 
 5635               		.stabs	"pgm_imageFLOWER:S(0,50)=ar(15,8);0;0;(15,7)",38,0,48,pgm_imageFLOWER
 5636               		.stabs	"pgm_paletteFLOWER:S(0,51)=ar(15,8);0;15;(15,2)",38,0,68,pgm_paletteFLOWER
 5637               		.stabs	"pgm_imageQ:S(0,50)",38,0,46,pgm_imageQ
 5638               		.stabs	"pgm_paletteQ:S(0,51)",38,0,58,pgm_paletteQ
 5639               		.stabs	"pgm_imageSOLID:S(0,50)",38,0,44,pgm_imageSOLID
 5640               		.stabs	"pgm_paletteSOLID:S(0,52)=ar(15,8);0;3;(15,2)",38,0,56,pgm_paletteSOLID
 5641               		.stabs	"pgm_imageDEADGOOMBA:S(0,50)",38,0,42,pgm_imageDEADGOOMBA
 5642               		.stabs	"pgm_paletteDEADGOOMBA:S(0,52)",38,0,54,pgm_paletteDEADGOOMBA
 5643               		.stabs	"pgm_imageSHROOM:S(0,50)",38,0,45,pgm_imageSHROOM
 5644               		.stabs	"pgm_palette1UP:S(0,52)",38,0,59,pgm_palette1UP
 5645               		.stabs	"pgm_paletteBIG:S(0,52)",38,0,32,pgm_paletteBIG
 5646               		.stabs	"pgm_imageSTAR:S(0,50)",38,0,48,pgm_imageSTAR
 5647               		.stabs	"pgm_paletteSTAR:S(0,53)=ar(15,8);0;7;(15,2)",38,0,60,pgm_paletteSTAR
 5648               		.stabs	"pgm_imageGOOMBA:S(0,50)",38,0,43,pgm_imageGOOMBA
 5649               		.stabs	"pgm_paletteGOOMBA:S(0,54)=ar(15,8);0;23;(15,2)",38,0,61,pgm_paletteGOOMBA
 5650               		.stabs	"pgm_imageCOIN:S(0,55)=ar(15,8);0;3;(15,7)",38,0,100,pgm_imageCOIN
 5651               		.stabs	"pgm_paletteCOIN:S(0,52)",38,0,126,pgm_paletteCOIN
 5652               		.stabs	"pgm_imageLEAF:S(0,50)",38,0,33,pgm_imageLEAF
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 228


 5653               		.stabs	"pgm_paletteLEAF:S(0,52)",38,0,40,pgm_paletteLEAF
 5654               		.stabs	"pgm_imageCLOUD:S(0,50)",38,0,40,pgm_imageCLOUD
 5655               		.stabs	"pgm_paletteCLOUD:S(0,52)",38,0,48,pgm_paletteCLOUD
 5656               		.stabs	"pgm_imageMARIO:S(0,50)",38,0,44,pgm_imageMARIO
 5657               		.stabs	"pgm_paletteMARIO:S(0,52)",38,0,51,pgm_paletteMARIO
 5658               		.stabs	"pgm_paletteLUIGI:S(0,52)",38,0,19,pgm_paletteLUIGI
 5659               		.stabs	"pgm_imageMARIORUNS:S(0,56)=ar(15,8);0;2;(15,7)",38,0,78,pgm_imageMARIORUNS
 5660               		.stabs	"header:G(0,57)=ar(15,8);0;35;(15,2)",32,0,12,0
 5661               		.stabs	"updateFrame:G(0,58)=B(4,2)",32,0,402,0
 5662               		.stabs	"frameBuffer:G(0,59)=ar(15,8);0;15;(0,60)=ar(15,8);0;16;(4,2)",32,0,42,0
 5663               		.stabs	"wc_color:G(0,49)",32,0,703,0
 5664               		.stabs	"skyOverrideSprite:G(16,3)",32,0,114,0
 5665               		.stabs	"nowSpriteState:G(16,5)",32,0,64,0
 5666               		.stabs	"cameraState:G(16,5)",32,0,68,0
 5667               		.stabs	"NadaMotion:G(0,61)=ar(15,8);0;1;(15,10)",32,0,177,0
 5668               		.stabs	"DefaultY:G(0,62)=ar(15,8);0;9;(15,2)",32,0,71,0
 5669               		.stabs	"DefaultMotion:G(0,61)",32,0,88,0
 5670               		.stabs	"DefaultLayer:G(0,63)=ar(15,8);0;4;(15,2)",32,0,90,0
 5671               		.stabs	"DefaultCamY:G(0,62)",32,0,102,0
 5672               		.stabs	"DefaultCamMotion:G(0,61)",32,0,119,0
 5673               		.stabs	"FlowerPA:G(0,63)",32,0,77,0
 5674               		.stabs	"spriteFLOWER:G(16,4)",32,0,90,0
 5675               		.stabs	"QPaletteAdvance:G(0,53)",32,0,103,0
 5676               		.stabs	"spriteQ:G(16,4)",32,0,118,0
 5677               		.stabs	"spriteSOLID:G(16,4)",32,0,59,0
 5678               		.stabs	"DeadGoombaMotion:G(0,61)",32,0,77,0
 5679               		.stabs	"DeadGoombaCamY:G(0,63)",32,0,79,0
 5680               		.stabs	"DeadGoombaCamMotion:G(0,61)",32,0,90,0
 5681               		.stabs	"spriteDEADGOOMBA:G(16,4)",32,0,93,0
 5682               		.stabs	"sprite1UP:G(16,4)",32,0,62,0
 5683               		.stabs	"spriteBIG:G(16,4)",32,0,35,0
 5684               		.stabs	"spriteSTAR:G(16,4)",32,0,80,0
 5685               		.stabs	"GoombaFlip:G(0,62)",32,0,125,0
 5686               		.stabs	"GoombaY:G(0,64)=ar(15,8);0;19;(15,2)",32,0,144,0
 5687               		.stabs	"GoombaMotion:G(0,61)",32,0,170,0
 5688               		.stabs	"GoombaCamY:G(0,64)",32,0,173,0
 5689               		.stabs	"GoombaCamMotion:G(0,61)",32,0,199,0
 5690               		.stabs	"GoombaLayer:G(0,62)",32,0,202,0
 5691               		.stabs	"GoombaPA:G(0,62)",32,0,276,0
 5692               		.stabs	"spriteGOOMBA:G(16,4)",32,0,300,0
 5693               		.stabs	"CoinY:G(0,62)",32,0,137,0
 5694               		.stabs	"CoinMotion:G(0,61)",32,0,162,0
 5695               		.stabs	"spriteCOIN:G(16,4)",32,0,178,0
 5696               		.stabs	"LeafFlip:G(0,65)=ar(15,8);0;5;(15,2)",32,0,58,0
 5697               		.stabs	"LeafLayer:G(0,65)",32,0,71,0
 5698               		.stabs	"LeafX:G(0,66)=ar(15,8);0;11;(15,2)",32,0,88,0
 5699               		.stabs	"LeafY:G(0,66)",32,0,107,0
 5700               		.stabs	"LeafMotion:G(0,61)",32,0,128,0
 5701               		.stabs	"LeafCamY:G(0,66)",32,0,131,0
 5702               		.stabs	"LeafCamMotion:G(0,61)",32,0,151,0
 5703               		.stabs	"spriteLEAF:G(16,4)",32,0,154,0
 5704               		.stabs	"spriteCLOUD:G(16,4)",32,0,56,0
 5705               		.stabs	"spriteMARIO:G(16,4)",32,0,67,0
 5706               		.stabs	"spriteLUIGI:G(16,4)",32,0,27,0
 5707               		.stabs	"MarioRunsX:G(0,65)",32,0,91,0
 5708               		.stabs	"MarioRunsMotion:G(0,61)",32,0,107,0
 5709               		.stabs	"MarioRunsCamMotion:G(0,61)",32,0,110,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 229


 5710               		.stabs	"spriteMARIORUNS:G(16,4)",32,0,114,0
 5711               		.stabs	"LuigiRunsX:G(0,65)",32,0,25,0
 5712               		.stabs	"LuigiRunsMotion:G(0,61)",32,0,41,0
 5713               		.stabs	"LuigiRunsFlip:G(0,67)=ar(15,8);0;2;(15,2)",32,0,46,0
 5714               		.stabs	"spriteLUIGIRUNS:G(16,4)",32,0,54,0
 5715               		.stabs	"callCount:G(4,2)",32,0,101,0
 5716               		.stabs	"qCount:G(4,2)",32,0,103,0
 5717               		.stabs	"p_nowSprite:G(16,3)",32,0,109,0
 5718               		.stabs	"nowIsReward:G(4,2)",32,0,112,0
 5719               		.stabs	"dataEnable:G(4,2)",32,0,1011,0
 5720               		.stabs	"vSync:G(4,2)",32,0,1012,0
 5721               		.stabs	"hsyncCount:G(4,4)",32,0,1013,0
 5722               		.stabs	"frameCount:G(0,58)",32,0,403,0
 5723               		.text
 5724               		.stabs	"",100,0,0,.Letext0
 5725               	.Letext0:
 5726               		.ident	"GCC: (GNU) 4.8.2"
 5727               	.global __do_copy_data
 5728               	.global __do_clear_bss
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 230


DEFINED SYMBOLS
                            *ABS*:00000000 main.c
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:2      *ABS*:0000003e __SP_H__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3      *ABS*:0000003d __SP_L__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4      *ABS*:0000003f __SREG__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5      *ABS*:00000000 __tmp_reg__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:6      *ABS*:00000001 __zero_reg__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:148    .text:00000000 pll_enable
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:208    .text:00000024 hitSensor_init
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:255    .text:0000003c setColor
                            *COM*:00000110 frameBuffer
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:331    .text:00000086 frameBufferInit
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:365    .text:00000098 setSpriteSkyColorOverride
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5625   .bss:00000007 skyOverrideSprite
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:392    .text:000000a2 getRawPixelVal
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:462    .text:000000e8 rawPixValToGimpColorVal
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:507    .text:0000010a fbQ_repositionSprite
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:708    .text:000001fe fbQ_overlaySprite
                            *COM*:0000000e cameraState
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5454   .progmem.data:00000636 spriteFLOWER
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:1021   .text:00000362 initSpriteStates
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3756   .bss:00000005 qCount
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3750   .data:00000002 p_nowSprite
                            *COM*:0000000e nowSpriteState
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:1142   .text:00000416 fbQuestion_hitDetected
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5341   .progmem.data:000005cb spriteQ
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3761   .bss:00000006 callCount
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3708   .bss:0000000a lastReward.2304
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5049   .progmem.data:000004b5 sprite1UP
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5027   .progmem.data:0000049e spriteBIG
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4934   .progmem.data:00000443 spriteSTAR
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4719   .progmem.data:00000386 spriteGOOMBA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4243   .progmem.data:000001cc spriteLEAF
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4154   .progmem.data:00000175 spriteCLOUD
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4065   .progmem.data:0000011e spriteMARIO
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4043   .progmem.data:00000107 spriteLUIGI
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4416   .progmem.data:0000025f spriteCOIN
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3745   .data:00000001 nowIsReward
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5138   .progmem.data:0000050c spriteDEADGOOMBA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:1347   .text:000004f6 __vector_2
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:1410   .text:00000542 prepNextSprite
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3807   .progmem.data:00000022 spriteMARIORUNS
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3767   .progmem.data:00000000 spriteLUIGIRUNS
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5252   .progmem.data:00000574 spriteSOLID
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:1497   .text:000005a2 fbQ_drawBackground
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:1566   .text:000005e4 fbQuestion_update
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:1731   .text:000006b4 getSpritePalette
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:1856   .text:00000708 getSpritePhase
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:1959   .text:00000752 lcd_init
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3734   .bss:00000003 vSync
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3729   .bss:00000001 hsyncCount
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3739   .bss:00000004 dataEnable
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:1996   .text:00000770 lcd_update
                            *COM*:00000002 wc_color
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3218   .text:00000ace restartFrameUpdate
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3723   .data:00000000 updateFrame
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3280   .text:00000afc frameBufferUpdate
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 231


/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3710   .bss:0000000b fbLastUpdateTime.2108
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3370   .text:00000b74 __vector_14
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3717   .bss:00000000 frameCount
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3510   .text:00000c18 init_hsyncTimer
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3548   .text:00000c30 isNewFrame
                             .bss:00000009 lastFrameCount.2465
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3589   .text.startup:00000000 main
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3847   .progmem.data:00000047 pgm_imageMARIORUNS
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4057   .progmem.data:0000011a pgm_paletteLUIGI
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3782   .progmem.data:00000013 LuigiRunsFlip
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3789   .progmem.data:00000016 LuigiRunsMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5586   .progmem.data:000006ae DefaultLayer
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3822   .progmem.data:00000035 MarioRunsCamMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3797   .progmem.data:0000001c LuigiRunsX
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5603   .progmem.data:000006b9 DefaultY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4079   .progmem.data:00000131 pgm_paletteMARIO
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3830   .progmem.data:0000003b MarioRunsMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5572   .progmem.data:000006a4 DefaultCamY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:3838   .progmem.data:00000041 MarioRunsX
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4086   .progmem.data:00000135 pgm_imageMARIO
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5595   .progmem.data:000006b3 DefaultMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5564   .progmem.data:0000069e DefaultCamMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4175   .progmem.data:0000018c pgm_imageCLOUD
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4168   .progmem.data:00000188 pgm_paletteCLOUD
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4348   .progmem.data:0000021f pgm_imageLEAF
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4341   .progmem.data:0000021b pgm_paletteLEAF
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4332   .progmem.data:00000215 LeafFlip
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4282   .progmem.data:000001f1 LeafMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4322   .progmem.data:0000020f LeafLayer
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4258   .progmem.data:000001df LeafCamMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4266   .progmem.data:000001e5 LeafCamY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4306   .progmem.data:00000203 LeafX
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4290   .progmem.data:000001f7 LeafY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4459   .progmem.data:00000286 pgm_imageCOIN
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4452   .progmem.data:00000282 pgm_paletteCOIN
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4431   .progmem.data:00000272 CoinMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4439   .progmem.data:00000278 CoinY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4866   .progmem.data:00000403 pgm_imageGOOMBA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4839   .progmem.data:000003eb pgm_paletteGOOMBA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4826   .progmem.data:000003e1 GoombaFlip
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4794   .progmem.data:000003c7 GoombaMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4748   .progmem.data:000003a3 GoombaLayer
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4762   .progmem.data:000003ad GoombaCamMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4734   .progmem.data:00000399 GoombaPA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4770   .progmem.data:000003b3 GoombaCamY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4802   .progmem.data:000003cd GoombaY
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4959   .progmem.data:0000045e pgm_imageSTAR
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:4948   .progmem.data:00000456 pgm_paletteSTAR
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5469   .progmem.data:00000649 FlowerPA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5070   .progmem.data:000004cc pgm_imageSHROOM
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5041   .progmem.data:000004b1 pgm_paletteBIG
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5063   .progmem.data:000004c8 pgm_palette1UP
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5184   .progmem.data:00000534 pgm_imageDEADGOOMBA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5177   .progmem.data:00000530 pgm_paletteDEADGOOMBA
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5170   .progmem.data:0000052a DeadGoombaMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5153   .progmem.data:0000051f DeadGoombaCamMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5161   .progmem.data:00000525 DeadGoombaCamY
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s 			page 232


/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5273   .progmem.data:0000058b pgm_imageSOLID
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5266   .progmem.data:00000587 pgm_paletteSOLID
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5617   .progmem.data:000006c3 NadaMotion
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5386   .progmem.data:000005f6 pgm_imageQ
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5367   .progmem.data:000005e6 pgm_paletteQ
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5356   .progmem.data:000005de QPaletteAdvance
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5496   .progmem.data:0000065e pgm_imageFLOWER
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5477   .progmem.data:0000064e pgm_paletteFLOWER
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccc7cXbf.s:5633   .progmem.data:000006c9 header

UNDEFINED SYMBOLS
__mulhi3
__mulqi3
__udivmodqi4
__divmodhi4
__udivmodhi4
tcnter_get
tcnter_myTcnter
tcnter_overflowUpdate
timer_setWGM
timer_selectDivisor
timer_compareMatchIntSetup
init_heartBeat
setHeartRate
heartUpdate
__do_copy_data
__do_clear_bss
