GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 1


   1               		.file	"heartbeat.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.stabs	"/Users/meh/_avrProjects/LCDdirectLVDS/67-pwm161/",100,0,2,.Ltext0
   8               		.stabs	"../../../_commonCode/heartbeat/1.30/heartbeat.c",100,0,2,.Ltext0
   9               		.text
  10               	.Ltext0:
  11               		.stabs	"gcc2_compiled.",60,0,0,0
  12               		.stabs	"int:t(0,1)=r(0,1);-32768;32767;",128,0,0,0
  13               		.stabs	"char:t(0,2)=@s8;r(0,2);0;255;",128,0,0,0
  14               		.stabs	"long int:t(0,3)=@s32;r(0,3);020000000000;017777777777;",128,0,0,0
  15               		.stabs	"unsigned int:t(0,4)=r(0,4);0;0177777;",128,0,0,0
  16               		.stabs	"long unsigned int:t(0,5)=@s32;r(0,5);0;037777777777;",128,0,0,0
  17               		.stabs	"long long int:t(0,6)=@s64;r(0,6);01000000000000000000000;0777777777777777777777;",128,0,0,
  18               		.stabs	"long long unsigned int:t(0,7)=@s64;r(0,7);0;01777777777777777777777;",128,0,0,0
  19               		.stabs	"short int:t(0,8)=r(0,8);-32768;32767;",128,0,0,0
  20               		.stabs	"short unsigned int:t(0,9)=r(0,9);0;0177777;",128,0,0,0
  21               		.stabs	"signed char:t(0,10)=@s8;r(0,10);-128;127;",128,0,0,0
  22               		.stabs	"unsigned char:t(0,11)=@s8;r(0,11);0;255;",128,0,0,0
  23               		.stabs	"float:t(0,12)=r(0,1);4;0;",128,0,0,0
  24               		.stabs	"double:t(0,13)=r(0,1);4;0;",128,0,0,0
  25               		.stabs	"long double:t(0,14)=r(0,1);4;0;",128,0,0,0
  26               		.stabs	"short _Fract:t(0,15)=r(0,1);1;0;",128,0,0,0
  27               		.stabs	"_Fract:t(0,16)=r(0,1);2;0;",128,0,0,0
  28               		.stabs	"long _Fract:t(0,17)=r(0,1);4;0;",128,0,0,0
  29               		.stabs	"long long _Fract:t(0,18)=r(0,1);8;0;",128,0,0,0
  30               		.stabs	"unsigned short _Fract:t(0,19)=r(0,1);1;0;",128,0,0,0
  31               		.stabs	"unsigned _Fract:t(0,20)=r(0,1);2;0;",128,0,0,0
  32               		.stabs	"unsigned long _Fract:t(0,21)=r(0,1);4;0;",128,0,0,0
  33               		.stabs	"unsigned long long _Fract:t(0,22)=r(0,1);8;0;",128,0,0,0
  34               		.stabs	"_Sat short _Fract:t(0,23)=r(0,1);1;0;",128,0,0,0
  35               		.stabs	"_Sat _Fract:t(0,24)=r(0,1);2;0;",128,0,0,0
  36               		.stabs	"_Sat long _Fract:t(0,25)=r(0,1);4;0;",128,0,0,0
  37               		.stabs	"_Sat long long _Fract:t(0,26)=r(0,1);8;0;",128,0,0,0
  38               		.stabs	"_Sat unsigned short _Fract:t(0,27)=r(0,1);1;0;",128,0,0,0
  39               		.stabs	"_Sat unsigned _Fract:t(0,28)=r(0,1);2;0;",128,0,0,0
  40               		.stabs	"_Sat unsigned long _Fract:t(0,29)=r(0,1);4;0;",128,0,0,0
  41               		.stabs	"_Sat unsigned long long _Fract:t(0,30)=r(0,1);8;0;",128,0,0,0
  42               		.stabs	"short _Accum:t(0,31)=r(0,1);2;0;",128,0,0,0
  43               		.stabs	"_Accum:t(0,32)=r(0,1);4;0;",128,0,0,0
  44               		.stabs	"long _Accum:t(0,33)=r(0,1);8;0;",128,0,0,0
  45               		.stabs	"long long _Accum:t(0,34)=r(0,1);8;0;",128,0,0,0
  46               		.stabs	"unsigned short _Accum:t(0,35)=r(0,1);2;0;",128,0,0,0
  47               		.stabs	"unsigned _Accum:t(0,36)=r(0,1);4;0;",128,0,0,0
  48               		.stabs	"unsigned long _Accum:t(0,37)=r(0,1);8;0;",128,0,0,0
  49               		.stabs	"unsigned long long _Accum:t(0,38)=r(0,1);8;0;",128,0,0,0
  50               		.stabs	"_Sat short _Accum:t(0,39)=r(0,1);2;0;",128,0,0,0
  51               		.stabs	"_Sat _Accum:t(0,40)=r(0,1);4;0;",128,0,0,0
  52               		.stabs	"_Sat long _Accum:t(0,41)=r(0,1);8;0;",128,0,0,0
  53               		.stabs	"_Sat long long _Accum:t(0,42)=r(0,1);8;0;",128,0,0,0
  54               		.stabs	"_Sat unsigned short _Accum:t(0,43)=r(0,1);2;0;",128,0,0,0
  55               		.stabs	"_Sat unsigned _Accum:t(0,44)=r(0,1);4;0;",128,0,0,0
  56               		.stabs	"_Sat unsigned long _Accum:t(0,45)=r(0,1);8;0;",128,0,0,0
  57               		.stabs	"_Sat unsigned long long _Accum:t(0,46)=r(0,1);8;0;",128,0,0,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 2


  58               		.stabs	"void:t(0,47)=(0,47)",128,0,0,0
  59               		.stabs	"../../../_commonCode/heartbeat/1.30/heartbeat.h",130,0,0,0
  60               		.stabs	"/opt/local/avr/include/avr/io.h",130,0,0,0
  61               		.stabs	"/opt/local/avr/include/avr/sfr_defs.h",130,0,0,0
  62               		.stabs	"/opt/local/avr/include/inttypes.h",130,0,0,0
  63               		.stabs	"/opt/local/lib/gcc/avr/4.8.2/include/stdint.h",130,0,0,0
  64               		.stabs	"/opt/local/avr/include/stdint.h",130,0,0,0
  65               		.stabs	"int8_t:t(6,1)=(0,10)",128,0,121,0
  66               		.stabs	"uint8_t:t(6,2)=(0,11)",128,0,122,0
  67               		.stabs	"int16_t:t(6,3)=(0,1)",128,0,123,0
  68               		.stabs	"uint16_t:t(6,4)=(0,4)",128,0,124,0
  69               		.stabs	"int32_t:t(6,5)=(0,3)",128,0,125,0
  70               		.stabs	"uint32_t:t(6,6)=(0,5)",128,0,126,0
  71               		.stabs	"int64_t:t(6,7)=(0,6)",128,0,128,0
  72               		.stabs	"uint64_t:t(6,8)=(0,7)",128,0,129,0
  73               		.stabs	"intptr_t:t(6,9)=(6,3)",128,0,142,0
  74               		.stabs	"uintptr_t:t(6,10)=(6,4)",128,0,147,0
  75               		.stabs	"int_least8_t:t(6,11)=(6,1)",128,0,159,0
  76               		.stabs	"uint_least8_t:t(6,12)=(6,2)",128,0,164,0
  77               		.stabs	"int_least16_t:t(6,13)=(6,3)",128,0,169,0
  78               		.stabs	"uint_least16_t:t(6,14)=(6,4)",128,0,174,0
  79               		.stabs	"int_least32_t:t(6,15)=(6,5)",128,0,179,0
  80               		.stabs	"uint_least32_t:t(6,16)=(6,6)",128,0,184,0
  81               		.stabs	"int_least64_t:t(6,17)=(6,7)",128,0,192,0
  82               		.stabs	"uint_least64_t:t(6,18)=(6,8)",128,0,199,0
  83               		.stabs	"int_fast8_t:t(6,19)=(6,1)",128,0,213,0
  84               		.stabs	"uint_fast8_t:t(6,20)=(6,2)",128,0,218,0
  85               		.stabs	"int_fast16_t:t(6,21)=(6,3)",128,0,223,0
  86               		.stabs	"uint_fast16_t:t(6,22)=(6,4)",128,0,228,0
  87               		.stabs	"int_fast32_t:t(6,23)=(6,5)",128,0,233,0
  88               		.stabs	"uint_fast32_t:t(6,24)=(6,6)",128,0,238,0
  89               		.stabs	"int_fast64_t:t(6,25)=(6,7)",128,0,246,0
  90               		.stabs	"uint_fast64_t:t(6,26)=(6,8)",128,0,253,0
  91               		.stabs	"intmax_t:t(6,27)=(6,7)",128,0,273,0
  92               		.stabs	"uintmax_t:t(6,28)=(6,8)",128,0,278,0
  93               		.stabn	162,0,0,0
  94               		.stabn	162,0,0,0
  95               		.stabs	"int_farptr_t:t(4,1)=(6,5)",128,0,77,0
  96               		.stabs	"uint_farptr_t:t(4,2)=(6,6)",128,0,81,0
  97               		.stabn	162,0,0,0
  98               		.stabn	162,0,0,0
  99               		.stabs	"/opt/local/avr/include/avr/fuse.h",130,0,0,0
 100               		.stabs	"__fuse_t:t(7,1)=(7,2)=s3low:(0,11),0,8;high:(0,11),8,8;extended:(0,11),16,8;;",128,0,244,0
 101               		.stabn	162,0,0,0
 102               		.stabn	162,0,0,0
 103               		.stabs	"../../../_commonCode/heartbeat/1.30/../../../_commonCode/hfModulation/1.00/hfModulation.h"
 104               		.stabs	"hfm_t:t(8,1)=(8,2)=B(8,3)=s4desiredSum:(6,3),0,16;maxPower:(6,2),16,8;power:(6,2),24,8;;",
 105               		.stabn	162,0,0,0
 106               		.stabn	162,0,0,0
 107               		.stabs	"setHeartRate:F(0,47)",36,0,46,setHeartRate
 108               		.stabs	"rate:P(6,2)",64,0,46,24
 109               	.global	setHeartRate
 110               		.type	setHeartRate, @function
 111               	setHeartRate:
 112               		.stabd	46,0,0
   1:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //heartbeat 1.20
   2:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #include "heartbeat.h"
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 3


   3:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
   4:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
   5:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //100% = 255, 0% = 0...
   6:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //volatile uint8_t  newDesired = 0;
   7:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
   8:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //Could be uint8 for dms and uint16 for nondms
   9:../../../_commonCode/heartbeat/1.30/heartbeat.c **** uint16_t heartStepTime = HEARTSTEPTIME;
  10:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  11:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  12:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //volatile uint8_t  heartSet = HEARTDONTSET;
  13:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  14:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (!defined(HEARTPIN_HARDCODED) || !HEARTPIN_HARDCODED)
  15:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //#define LED_DIRECT_HIGH
  16:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //#define LED_INVERTED
  17:../../../_commonCode/heartbeat/1.30/heartbeat.c **** uint8_t ledConnection;
  18:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  19:../../../_commonCode/heartbeat/1.30/heartbeat.c **** volatile uint8_t*	heartPIN;
  20:../../../_commonCode/heartbeat/1.30/heartbeat.c **** uint8_t heartBeatPin;
  21:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
  22:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  23:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //shift the update-period by heartRate to increase the rate
  24:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // this is a right-shift for calculation efficiency
  25:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // so rates are 0, 1, 2, 3 -> PERIOD, PERIOD/2, PERIOD/4, PERIOD/8...
  26:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //uint8_t heartRate = 0;
  27:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  28:../../../_commonCode/heartbeat/1.30/heartbeat.c **** hfm_t heartModulator;
  29:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  30:../../../_commonCode/heartbeat/1.30/heartbeat.c **** /*
  31:../../../_commonCode/heartbeat/1.30/heartbeat.c **** void heartMode(uint8_t mode)
  32:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {
  33:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	switch(mode)
  34:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
  35:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		case HEART_2X:
  36:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			heartRate = 1;
  37:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			break;
  38:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		case HEART_4X:
  39:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			heartRate 
  40:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
  41:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
  42:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	heartSet = mode;
  43:../../../_commonCode/heartbeat/1.30/heartbeat.c **** }
  44:../../../_commonCode/heartbeat/1.30/heartbeat.c **** */
  45:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  46:../../../_commonCode/heartbeat/1.30/heartbeat.c **** void setHeartRate(uint8_t rate)
  47:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {
 113               		.stabn	68,0,47,.LM0-.LFBB1
 114               	.LM0:
 115               	.LFBB1:
 116               	/* prologue: function */
 117               	/* frame size = 0 */
 118               	/* stack size = 0 */
 119               	.L__stack_usage = 0
  48:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	heartRate = rate;
  49:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
  50:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	if(rate == 0)
 120               		.stabn	68,0,50,.LM1-.LFBB1
 121               	.LM1:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 4


 122 0000 8111      		cpse r24,__zero_reg__
 123 0002 00C0      		rjmp .L2
  51:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		rate = 1;
 124               		.stabn	68,0,51,.LM2-.LFBB1
 125               	.LM2:
 126 0004 81E0      		ldi r24,lo8(1)
 127               	.L2:
  52:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		
  53:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	#if (_HEART_DMS_)
  54:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  55:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #warning "Relevant Everywhere: dms6sec_t used in heartbeat, yet a full cycle is 8 seconds, and neve
  56:../../../_commonCode/heartbeat/1.30/heartbeat.c ****     heartStepTime = (HEARTSTEPTIME/rate);
  57:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	#else
  58:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	 heartStepTime = (HEART_ITERATIONCOUNT/rate);
 128               		.stabn	68,0,58,.LM3-.LFBB1
 129               	.LM3:
 130 0006 682F      		mov r22,r24
 131 0008 70E0      		ldi r23,0
 132 000a 80E9      		ldi r24,lo8(-112)
 133 000c 91E0      		ldi r25,lo8(1)
 134 000e 0E94 0000 		call __divmodhi4
 135 0012 7093 0000 		sts heartStepTime+1,r23
 136 0016 6093 0000 		sts heartStepTime,r22
 137 001a 0895      		ret
 138               		.size	setHeartRate, .-setHeartRate
 139               	.Lscope1:
 140               		.stabs	"",36,0,0,.Lscope1-.LFBB1
 141               		.stabd	78,0,0
 142               		.stabs	"getHeartRate:F(6,2)",36,0,64,getHeartRate
 143               	.global	getHeartRate
 144               		.type	getHeartRate, @function
 145               	getHeartRate:
 146               		.stabd	46,0,0
  59:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	#endif
  60:../../../_commonCode/heartbeat/1.30/heartbeat.c **** }
  61:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  62:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (!defined(HEART_GETRATE_UNUSED) || !HEART_GETRATE_UNUSED)
  63:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //This function takes about 20 bytes
  64:../../../_commonCode/heartbeat/1.30/heartbeat.c **** uint8_t getHeartRate(void)
  65:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {
 147               		.stabn	68,0,65,.LM4-.LFBB2
 148               	.LM4:
 149               	.LFBB2:
 150               	/* prologue: function */
 151               	/* frame size = 0 */
 152               	/* stack size = 0 */
 153               	.L__stack_usage = 0
  66:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	#if (_HEART_DMS_)
  67:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	 return HEARTSTEPTIME/heartStepTime;
  68:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	#else
  69:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	 return HEART_ITERATIONCOUNT/heartStepTime;
 154               		.stabn	68,0,69,.LM5-.LFBB2
 155               	.LM5:
 156 001c 6091 0000 		lds r22,heartStepTime
 157 0020 7091 0000 		lds r23,heartStepTime+1
 158 0024 80E9      		ldi r24,lo8(-112)
 159 0026 91E0      		ldi r25,lo8(1)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 5


 160 0028 0E94 0000 		call __udivmodhi4
 161 002c 862F      		mov r24,r22
  70:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	#endif
  71:../../../_commonCode/heartbeat/1.30/heartbeat.c **** }
 162               		.stabn	68,0,71,.LM6-.LFBB2
 163               	.LM6:
 164 002e 0895      		ret
 165               		.size	getHeartRate, .-getHeartRate
 166               	.Lscope2:
 167               		.stabs	"",36,0,0,.Lscope2-.LFBB2
 168               		.stabd	78,0,0
 169               		.stabs	"heartClear:F(0,47)",36,0,82,heartClear
 170               	.global	heartClear
 171               		.type	heartClear, @function
 172               	heartClear:
 173               		.stabd	46,0,0
  72:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
  73:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  74:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (!defined(DMS_WAITFN_UNUSED) || !DMS_WAITFN_UNUSED)
  75:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // This only saves 4 bytes...
  76:../../../_commonCode/heartbeat/1.30/heartbeat.c **** void heartupdate(void)
  77:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {
  78:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	heartUpdate();
  79:../../../_commonCode/heartbeat/1.30/heartbeat.c **** }
  80:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
  81:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  82:../../../_commonCode/heartbeat/1.30/heartbeat.c **** void heartClear(void)
  83:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {
 174               		.stabn	68,0,83,.LM7-.LFBB3
 175               	.LM7:
 176               	.LFBB3:
 177               	/* prologue: function */
 178               	/* frame size = 0 */
 179               	/* stack size = 0 */
 180               	.L__stack_usage = 0
  84:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	hfm_setPower(&heartModulator, 0);
 181               		.stabn	68,0,84,.LM8-.LFBB3
 182               	.LM8:
 183 0030 60E0      		ldi r22,0
 184 0032 80E0      		ldi r24,lo8(heartModulator)
 185 0034 90E0      		ldi r25,hi8(heartModulator)
 186 0036 0C94 0000 		jmp hfm_setPower
 187               		.size	heartClear, .-heartClear
 188               	.Lscope3:
 189               		.stabs	"",36,0,0,.Lscope3-.LFBB3
 190               		.stabd	78,0,0
 191               		.stabs	"init_heartBeat:F(0,47)",36,0,108,init_heartBeat
 192               	.global	init_heartBeat
 193               		.type	init_heartBeat, @function
 194               	init_heartBeat:
 195               		.stabd	46,0,0
  85:../../../_commonCode/heartbeat/1.30/heartbeat.c **** }
  86:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  87:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  88:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (!defined(HEARTPIN_HARDCODED) || !HEARTPIN_HARDCODED)
  89:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //THIS USES THE WDT NOW!
  90:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // AFTER init_heartBeat, the wdt must be reset often enough!!! this can be accomplished via heartUp
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 6


  91:../../../_commonCode/heartbeat/1.30/heartbeat.c **** void init_heartBeat(volatile uint8_t* pin, uint8_t pinName, uint8_t ledConnectionType)
  92:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {
  93:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	heartDDR = ddr;
  94:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	heartPIN = pin;
  95:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	heartBeatPin = pinName;
  96:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	ledConnection = ledConnectionType;
  97:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
  98:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	setoutVar(heartBeatPin, heartPIN);
  99:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	setout(PD6, DDRD);
 100:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 101:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Set the port first, so there's not a short 
 102:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//(there may be an instant of floating on the input of an inverter)
 103:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//PORT = L
 104:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	clrpinVar(heartBeatPin, heartPIN);
 105:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//DDR = H,out
 106:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	setoutVar(heartBeatPin, heartPIN);
 107:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #else
 108:../../../_commonCode/heartbeat/1.30/heartbeat.c **** void init_heartBeat(void)
 109:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {
 196               		.stabn	68,0,109,.LM9-.LFBB4
 197               	.LM9:
 198               	.LFBB4:
 199               	/* prologue: function */
 200               	/* frame size = 0 */
 201               	/* stack size = 0 */
 202               	.L__stack_usage = 0
 110:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	clrpinPORT(HEART_PINNUM, HEART_PINPORT);
 203               		.stabn	68,0,110,.LM10-.LFBB4
 204               	.LM10:
 205 003a 2E98      		cbi 0x5,6
 111:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	setoutPORT(HEART_PINNUM, HEART_PINPORT);
 206               		.stabn	68,0,111,.LM11-.LFBB4
 207               	.LM11:
 208 003c 269A      		sbi 0x4,6
 112:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
 113:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 114:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 115:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 116:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	hfm_setPower(&heartModulator, 0);
 117:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	hfm_setup(&heartModulator, 0, HEART_MAXBRIGHT);
 209               		.stabn	68,0,117,.LM12-.LFBB4
 210               	.LM12:
 211 003e 4FEF      		ldi r20,lo8(-1)
 212 0040 60E0      		ldi r22,0
 213 0042 80E0      		ldi r24,lo8(heartModulator)
 214 0044 90E0      		ldi r25,hi8(heartModulator)
 215 0046 0E94 0000 		call hfm_setup
 216               	.LBB4:
 217               	.LBB5:
  58:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	#endif
 218               		.stabn	68,0,58,.LM13-.LFBB4
 219               	.LM13:
 220 004a 80E9      		ldi r24,lo8(-112)
 221 004c 91E0      		ldi r25,lo8(1)
 222 004e 9093 0000 		sts heartStepTime+1,r25
 223 0052 8093 0000 		sts heartStepTime,r24
 224 0056 0895      		ret
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 7


 225               	.LBE5:
 226               	.LBE4:
 227               		.size	init_heartBeat, .-init_heartBeat
 228               	.Lscope4:
 229               		.stabs	"",36,0,0,.Lscope4-.LFBB4
 230               		.stabd	78,0,0
 231               		.stabs	"set_heartBlink:F(0,47)",36,0,242,set_heartBlink
 232               		.stabs	"count:P(6,2)",64,0,242,24
 233               	.global	set_heartBlink
 234               		.type	set_heartBlink, @function
 235               	set_heartBlink:
 236               		.stabd	46,0,0
 118:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 119:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	setHeartRate(0);
 120:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 121:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (_HEART_DMS_)
 122:../../../_commonCode/heartbeat/1.30/heartbeat.c ****  #if (defined(_DMS_EXTERNALUPDATE_) && _DMS_EXTERNALUPDATE_)
 123:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//dmsTimer should be initialized elsewhere based on the rate of dmsUpdate calls...
 124:../../../_commonCode/heartbeat/1.30/heartbeat.c ****  #else 
 125:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	init_dmsTimer();
 126:../../../_commonCode/heartbeat/1.30/heartbeat.c ****  #endif
 127:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 128:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
 129:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 130:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 131:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (!defined(_WDT_DISABLE_) || !_WDT_DISABLE_)
 132:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	// IF the reset occurred, the WDTimer is reset to 16ms!
 133:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	// IF wdt_reset() isn't called before then, it will get stuck resetting!
 134:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//!!!! This can happen even if the WDT is NEVER ENABLED
 135:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	// esp. if the bit is set during a brown-out...
 136:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	wdt_reset();
 137:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	// So also disable it (and reenable it if we want it)
 138:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	wdt_disable();
 139:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 140:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Check if there was a watchdog reset...
 141:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	// IF the reset occurred, the WDTimer is reset to 16ms!
 142:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	// IF wdt_reset() isn't called before then, it will get stuck resetting!
 143:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//!!!! This can happen even if the WDT is NEVER ENABLED
 144:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	// esp. if the bit is set during a brown-out...
 145:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Could also check ! Power-On, and/or brownout... 
 146:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	if(getbit(WDRF, MCUStatReg))
 147:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 148:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		setHeartRate(32);
 149:../../../_commonCode/heartbeat/1.30/heartbeat.c **** /*
 150:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		
 151:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		//HALT HERE FOR DEBUGGING!!!
 152:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		// INDICATE it on the HeartBeat!
 153:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #warning "watchdog should NOT hang the system when distributed... this is DEBUGGING ONLY"
 154:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		while(1)
 155:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		{
 156:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			heartUpdate();
 157:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		}
 158:../../../_commonCode/heartbeat/1.30/heartbeat.c **** */
 159:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
 160:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	if(!getbit(PORF, MCUStatReg))
 161:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 162:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		//It seems unusual that a brown-out wouldn't occur on power-up... takes time to charge caps, etc.
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 8


 163:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		//only check this if PowerOnReset was already cleared from a previous run
 164:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		if(getbit(BORF, MCUStatReg))
 165:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		{
 166:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			setHeartRate(16);
 167:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		}
 168:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
 169:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Clear the reset flags so we can see next time...
 170:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	MCUSR = 0x0f;
 171:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	MCUStatReg = 0;
 172:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 173:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//It's kinda handy to have the WDT run for a while so we can tell it crashed...
 174:../../../_commonCode/heartbeat/1.30/heartbeat.c ****  #if defined(_WDTO_USER_)
 175:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	wdt_enable(_WDTO_USER_);
 176:../../../_commonCode/heartbeat/1.30/heartbeat.c ****  #else
 177:../../../_commonCode/heartbeat/1.30/heartbeat.c ****   #if defined(WDTO_4S)
 178:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	wdt_enable(WDTO_4S);
 179:../../../_commonCode/heartbeat/1.30/heartbeat.c ****   #else
 180:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	wdt_enable(WDTO_1S);
 181:../../../_commonCode/heartbeat/1.30/heartbeat.c ****   #endif
 182:../../../_commonCode/heartbeat/1.30/heartbeat.c ****  #endif
 183:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #else
 184:../../../_commonCode/heartbeat/1.30/heartbeat.c ****  #warning "WDT DISABLED"
 185:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
 186:../../../_commonCode/heartbeat/1.30/heartbeat.c **** }
 187:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 188:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //Increment or decrement the heart brightness as appropriate
 189:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // this is called periodically by heartUpdate...
 190:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // This function takes about 32 bytes
 191:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // and inlining it saved 6, wee!
 192:../../../_commonCode/heartbeat/1.30/heartbeat.c **** static __inline__ uint8_t getNextDesired(void)
 193:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {
 194:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Don't set abs(direction) > 1 or we'll have wraparound errors!
 195:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	static int8_t direction = +1;
 196:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	int16_t desired;
 197:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 198:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 199:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //Somehow it seems the program gets stuck with the heartbeat at half-brightness...
 200:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //So main is still running, but the heart isn't incrementing!
 201:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // So do the watchdog reset here...
 202:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 203:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //!!! Check This with WDT...
 204:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //#warning "at what heart_reset() rate will getNextDesired never be called?"
 205:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (!defined(_WDT_DISABLE_) || !_WDT_DISABLE_)
 206:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Woot! Saved two bytes!
 207:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	wdt_reset();
 208:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
 209:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 210:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	desired = (uint8_t)(heartModulator.power);
 211:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 212:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	desired += direction;
 213:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 214:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Slightly slower not to have these internal to above, but also safer...
 215:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 216:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	if(desired >= HEART_MAXBRIGHT)
 217:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 218:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		desired = HEART_MAXBRIGHT;
 219:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		direction = -1;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 9


 220:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}	
 221:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 222:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	if(desired <= 0)
 223:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 224:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		desired = 0;
 225:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		direction = +1;
 226:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
 227:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 228:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	return (uint8_t)desired;
 229:../../../_commonCode/heartbeat/1.30/heartbeat.c **** }
 230:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 231:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (!defined(HEART_BLINK_UNUSED) || !HEART_BLINK_UNUSED)
 232:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //Used for error-indication...
 233:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // when 0, the heart fades as usual
 234:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // when non-zero the heart blinks as follows:
 235:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //  say heartBlink is 0xXY, it will blink Y times first, then X times
 236:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //  then repeat...
 237:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // (actually, I think that's backwards, a remnant of times past... I think
 238:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // it's now X times first, then Y...)
 239:../../../_commonCode/heartbeat/1.30/heartbeat.c **** uint8_t heartBlink = 0;
 240:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //#define TOGGLETIME	(250*DMS_MS)
 241:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 242:../../../_commonCode/heartbeat/1.30/heartbeat.c **** void set_heartBlink(uint8_t count)
 243:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {
 237               		.stabn	68,0,243,.LM14-.LFBB5
 238               	.LM14:
 239               	.LFBB5:
 240               	/* prologue: function */
 241               	/* frame size = 0 */
 242               	/* stack size = 0 */
 243               	.L__stack_usage = 0
 244:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	heartBlink = count;
 244               		.stabn	68,0,244,.LM15-.LFBB5
 245               	.LM15:
 246 0058 8093 0000 		sts heartBlink,r24
 247 005c 0895      		ret
 248               		.size	set_heartBlink, .-set_heartBlink
 249               	.Lscope5:
 250               		.stabs	"",36,0,0,.Lscope5-.LFBB5
 251               		.stabd	78,0,0
 252               		.stabs	"blinkHeart:F(6,2)",36,0,258,blinkHeart
 253               		.stabs	"currentTime:P(6,6)",64,0,258,22
 254               	.global	blinkHeart
 255               		.type	blinkHeart, @function
 256               	blinkHeart:
 257               		.stabd	46,0,0
 245:../../../_commonCode/heartbeat/1.30/heartbeat.c **** }
 246:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 247:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //Called by heartUpdate... used internally, only
 248:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (_HEART_DMS_)
 249:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #define TOGGLETIME   (250*DMS_MS)
 250:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //This function takes about 288 bytes
 251:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #warning "This may get cut, if the blink-rate is longer than 6sec!"
 252:../../../_commonCode/heartbeat/1.30/heartbeat.c **** uint8_t blinkHeart(dms6sec_t currentTime)
 253:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {
 254:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	static dms6sec_t lastToggleTime = 0;
 255:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #else
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 10


 256:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #define TOGGLETIME   (2500)
 257:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 258:../../../_commonCode/heartbeat/1.30/heartbeat.c **** uint8_t blinkHeart(uint32_t currentTime)
 259:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {
 258               		.stabn	68,0,259,.LM16-.LFBB6
 259               	.LM16:
 260               	.LFBB6:
 261 005e CF92      		push r12
 262 0060 DF92      		push r13
 263 0062 EF92      		push r14
 264 0064 FF92      		push r15
 265 0066 0F93      		push r16
 266 0068 1F93      		push r17
 267               	/* prologue: function */
 268               	/* frame size = 0 */
 269               	/* stack size = 6 */
 270               	.L__stack_usage = 6
 260:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	static uint32_t lastToggleTime = 0;
 261:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
 262:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 263:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	static uint8_t toggleCount = 0;
 264:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 265:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//This is not THE high nibble
 266:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	// This is True or False depending on 
 267:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//  whether thisNibble is the high nibble
 268:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	static uint8_t highNibble = 0;
 269:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 270:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 271:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	uint8_t thisNibble = heartBlink;
 271               		.stabn	68,0,271,.LM17-.LFBB6
 272               	.LM17:
 273 006a 3091 0000 		lds r19,heartBlink
 272:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 273:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//If both nibbles are filled, process them as specified
 274:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	if((heartBlink & 0xf0) && (heartBlink & 0x0f))
 274               		.stabn	68,0,274,.LM18-.LFBB6
 275               	.LM18:
 276 006e 432F      		mov r20,r19
 277 0070 407F      		andi r20,lo8(-16)
 278 0072 232F      		mov r18,r19
 279 0074 2F70      		andi r18,lo8(15)
 280 0076 4423      		tst r20
 281 0078 01F0      		breq .L10
 282               		.stabn	68,0,274,.LM19-.LFBB6
 283               	.LM19:
 284 007a 2111      		cpse r18,__zero_reg__
 285 007c 00C0      		rjmp .L11
 275:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{	//Fall through and toggle...
 276:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
 277:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Otherwise just process the one that's filled
 278:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	// to avoid long delays and hopefully make it easier to determine which
 279:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	// nibble is filled...
 280:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	else if(heartBlink & 0x0f)
 281:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		highNibble = 0;
 282:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	else if(heartBlink & 0xf0)
 283:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		highNibble = 1;
 286               		.stabn	68,0,283,.LM20-.LFBB6
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 11


 287               	.LM20:
 288 007e 41E0      		ldi r20,lo8(1)
 289 0080 4093 0000 		sts highNibble.1533,r20
 290 0084 00C0      		rjmp .L11
 291               	.L10:
 280:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		highNibble = 0;
 292               		.stabn	68,0,280,.LM21-.LFBB6
 293               	.LM21:
 294 0086 2111      		cpse r18,__zero_reg__
 281:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	else if(heartBlink & 0xf0)
 295               		.stabn	68,0,281,.LM22-.LFBB6
 296               	.LM22:
 297 0088 1092 0000 		sts highNibble.1533,__zero_reg__
 298               	.L11:
 284:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 285:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Fill the appropriate nibble for blinking...
 286:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	if(highNibble)
 299               		.stabn	68,0,286,.LM23-.LFBB6
 300               	.LM23:
 301 008c 4091 0000 		lds r20,highNibble.1533
 302 0090 4423      		tst r20
 303 0092 01F0      		breq .L13
 287:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		thisNibble = (thisNibble & 0xf0) >> 4;
 304               		.stabn	68,0,287,.LM24-.LFBB6
 305               	.LM24:
 306 0094 E32F      		mov r30,r19
 307 0096 E295      		swap r30
 308 0098 EF70      		andi r30,lo8(15)
 309 009a 00C0      		rjmp .L14
 310               	.L13:
 288:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	else
 289:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		thisNibble = (thisNibble & 0x0f);
 311               		.stabn	68,0,289,.LM25-.LFBB6
 312               	.LM25:
 313 009c E22F      		mov r30,r18
 314               	.L14:
 290:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 291:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Blink the proper number of times
 292:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	if((toggleCount>>1) < thisNibble)
 315               		.stabn	68,0,292,.LM26-.LFBB6
 316               	.LM26:
 317 009e 5091 0000 		lds r21,toggleCount.1532
 318 00a2 F52F      		mov r31,r21
 319 00a4 F695      		lsr r31
 320 00a6 0091 0000 		lds r16,lastToggleTime.1531
 321 00aa 1091 0000 		lds r17,lastToggleTime.1531+1
 322 00ae 2091 0000 		lds r18,lastToggleTime.1531+2
 323 00b2 3091 0000 		lds r19,lastToggleTime.1531+3
 293:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 294:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		if(currentTime - lastToggleTime > TOGGLETIME)
 324               		.stabn	68,0,294,.LM27-.LFBB6
 325               	.LM27:
 326 00b6 6B01      		movw r12,r22
 327 00b8 7C01      		movw r14,r24
 328 00ba C01A      		sub r12,r16
 329 00bc D10A      		sbc r13,r17
 330 00be E20A      		sbc r14,r18
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 12


 331 00c0 F30A      		sbc r15,r19
 292:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 332               		.stabn	68,0,292,.LM28-.LFBB6
 333               	.LM28:
 334 00c2 FE17      		cp r31,r30
 335 00c4 00F4      		brsh .L15
 336               		.stabn	68,0,294,.LM29-.LFBB6
 337               	.LM29:
 338 00c6 45EC      		ldi r20,-59
 339 00c8 C416      		cp r12,r20
 340 00ca 49E0      		ldi r20,9
 341 00cc D406      		cpc r13,r20
 342 00ce E104      		cpc r14,__zero_reg__
 343 00d0 F104      		cpc r15,__zero_reg__
 344 00d2 00F0      		brlo .L16
 295:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		{
 296:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			lastToggleTime = currentTime;
 345               		.stabn	68,0,296,.LM30-.LFBB6
 346               	.LM30:
 347 00d4 6093 0000 		sts lastToggleTime.1531,r22
 348 00d8 7093 0000 		sts lastToggleTime.1531+1,r23
 349 00dc 8093 0000 		sts lastToggleTime.1531+2,r24
 350 00e0 9093 0000 		sts lastToggleTime.1531+3,r25
 297:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			toggleCount++;
 351               		.stabn	68,0,297,.LM31-.LFBB6
 352               	.LM31:
 353 00e4 5F5F      		subi r21,lo8(-(1))
 354 00e6 5093 0000 		sts toggleCount.1532,r21
 355 00ea 00C0      		rjmp .L16
 356               	.L15:
 298:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		}
 299:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
 300:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Wait for a while
 301:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #warning "There may be some integer promotion issues here..."
 302:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	else if(currentTime - lastToggleTime > 
 303:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 						(((uint32_t)(TOGGLETIME * 8))<<(highNibble)))
 357               		.stabn	68,0,303,.LM32-.LFBB6
 358               	.LM32:
 359 00ec 00E2      		ldi r16,lo8(32)
 360 00ee 1EE4      		ldi r17,lo8(78)
 361 00f0 20E0      		ldi r18,0
 362 00f2 30E0      		ldi r19,0
 363 00f4 042E      		mov r0,r20
 364 00f6 00C0      		rjmp 2f
 365               		1:
 366 00f8 000F      		lsl r16
 367 00fa 111F      		rol r17
 368 00fc 221F      		rol r18
 369 00fe 331F      		rol r19
 370               		2:
 371 0100 0A94      		dec r0
 372 0102 02F4      		brpl 1b
 302:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 						(((uint32_t)(TOGGLETIME * 8))<<(highNibble)))
 373               		.stabn	68,0,302,.LM33-.LFBB6
 374               	.LM33:
 375 0104 0C15      		cp r16,r12
 376 0106 1D05      		cpc r17,r13
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 13


 377 0108 2E05      		cpc r18,r14
 378 010a 3F05      		cpc r19,r15
 379 010c 00F4      		brsh .L16
 304:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 305:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		toggleCount = 0;
 380               		.stabn	68,0,305,.LM34-.LFBB6
 381               	.LM34:
 382 010e 1092 0000 		sts toggleCount.1532,__zero_reg__
 306:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		lastToggleTime = currentTime;
 383               		.stabn	68,0,306,.LM35-.LFBB6
 384               	.LM35:
 385 0112 6093 0000 		sts lastToggleTime.1531,r22
 386 0116 7093 0000 		sts lastToggleTime.1531+1,r23
 387 011a 8093 0000 		sts lastToggleTime.1531+2,r24
 388 011e 9093 0000 		sts lastToggleTime.1531+3,r25
 307:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		//Only valid if both nibbles are filled (see above)
 308:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		highNibble = !highNibble;
 389               		.stabn	68,0,308,.LM36-.LFBB6
 390               	.LM36:
 391 0122 81E0      		ldi r24,lo8(1)
 392 0124 4111      		cpse r20,__zero_reg__
 393 0126 80E0      		ldi r24,0
 394               	.L17:
 395 0128 8093 0000 		sts highNibble.1533,r24
 396               	.L16:
 309:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
 310:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 311:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//(actually, the new value, at this point... but will be the last soon)
 312:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	return !getbit(0, toggleCount);
 397               		.stabn	68,0,312,.LM37-.LFBB6
 398               	.LM37:
 399 012c 8091 0000 		lds r24,toggleCount.1532
 400 0130 8095      		com r24
 313:../../../_commonCode/heartbeat/1.30/heartbeat.c **** }
 401               		.stabn	68,0,313,.LM38-.LFBB6
 402               	.LM38:
 403 0132 8170      		andi r24,lo8(1)
 404               	/* epilogue start */
 405 0134 1F91      		pop r17
 406 0136 0F91      		pop r16
 407 0138 FF90      		pop r15
 408 013a EF90      		pop r14
 409 013c DF90      		pop r13
 410 013e CF90      		pop r12
 411 0140 0895      		ret
 412               		.size	blinkHeart, .-blinkHeart
 413               		.stabs	"lastToggleTime:V(6,6)",38,0,260,lastToggleTime.1531
 414               		.stabs	"toggleCount:V(6,2)",38,0,263,toggleCount.1532
 415               		.stabs	"highNibble:V(6,2)",38,0,268,highNibble.1533
 416               		.stabn	192,0,0,.LFBB6-.LFBB6
 417               		.stabn	224,0,0,.Lscope6-.LFBB6
 418               	.Lscope6:
 419               		.stabs	"",36,0,0,.Lscope6-.LFBB6
 420               		.stabd	78,0,0
 421               		.stabs	"heartUpdate:F(6,2)",36,0,318,heartUpdate
 422               	.global	heartUpdate
 423               		.type	heartUpdate, @function
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 14


 424               	heartUpdate:
 425               		.stabd	46,0,0
 314:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
 315:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 316:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //This function takes about 186 bytes
 317:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // Really?! Or is hfm not compiled if it's not used?
 318:../../../_commonCode/heartbeat/1.30/heartbeat.c **** uint8_t heartUpdate(void)
 319:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {	
 426               		.stabn	68,0,319,.LM39-.LFBB7
 427               	.LM39:
 428               	.LFBB7:
 429 0142 0F93      		push r16
 430 0144 1F93      		push r17
 431               	/* prologue: function */
 432               	/* frame size = 0 */
 433               	/* stack size = 2 */
 434               	.L__stack_usage = 2
 320:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	static uint32_t lastTime = 0;
 321:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 322:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (_HEART_DMS_)
 323:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	static dms6sec_t lastTime = 0;
 324:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 325:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	uint32_t currentTime;
 326:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	dms6sec_t currentTime;
 327:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 328:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	currentTime = dmsGetTime();
 329:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	currentTime = dmsGet6sec();
 330:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 331:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//HEARTSTEPTIME isn't 100% accurate, especially if this isn't accessed often enough...
 332:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//heartStepTime is in dms...
 333:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	if((currentTime - lastTime) > ((dms6sec_t)heartStepTime))
 334:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	{
 335:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #else
 336:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	static uint32_t lastTime = 0;
 337:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 338:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	static uint32_t currentTime = 0;
 339:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	currentTime++;
 435               		.stabn	68,0,339,.LM40-.LFBB7
 436               	.LM40:
 437 0146 8091 0000 		lds r24,currentTime.1539
 438 014a 9091 0000 		lds r25,currentTime.1539+1
 439 014e A091 0000 		lds r26,currentTime.1539+2
 440 0152 B091 0000 		lds r27,currentTime.1539+3
 441 0156 0196      		adiw r24,1
 442 0158 A11D      		adc r26,__zero_reg__
 443 015a B11D      		adc r27,__zero_reg__
 444 015c 8093 0000 		sts currentTime.1539,r24
 445 0160 9093 0000 		sts currentTime.1539+1,r25
 446 0164 A093 0000 		sts currentTime.1539+2,r26
 447 0168 B093 0000 		sts currentTime.1539+3,r27
 340:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 341:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	if(currentTime - lastTime > (HEART_ITERATIONCOUNT>>heartRate))
 342:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//heartStepTime is number of updates, no corelation with actual seconds..
 343:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //#warning "heartStepTime without dms is untested"
 344:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
 345:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 346:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	if((currentTime - lastTime) > heartStepTime)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 15


 448               		.stabn	68,0,346,.LM41-.LFBB7
 449               	.LM41:
 450 016c 4091 0000 		lds r20,lastTime.1538
 451 0170 5091 0000 		lds r21,lastTime.1538+1
 452 0174 6091 0000 		lds r22,lastTime.1538+2
 453 0178 7091 0000 		lds r23,lastTime.1538+3
 454 017c 8C01      		movw r16,r24
 455 017e 9D01      		movw r18,r26
 456 0180 041B      		sub r16,r20
 457 0182 150B      		sbc r17,r21
 458 0184 260B      		sbc r18,r22
 459 0186 370B      		sbc r19,r23
 460 0188 4091 0000 		lds r20,heartStepTime
 461 018c 5091 0000 		lds r21,heartStepTime+1
 462 0190 60E0      		ldi r22,0
 463 0192 70E0      		ldi r23,0
 464 0194 4017      		cp r20,r16
 465 0196 5107      		cpc r21,r17
 466 0198 6207      		cpc r22,r18
 467 019a 7307      		cpc r23,r19
 468 019c 00F4      		brsh .L29
 347:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 348:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		lastTime = currentTime;
 469               		.stabn	68,0,348,.LM42-.LFBB7
 470               	.LM42:
 471 019e 8093 0000 		sts lastTime.1538,r24
 472 01a2 9093 0000 		sts lastTime.1538+1,r25
 473 01a6 A093 0000 		sts lastTime.1538+2,r26
 474 01aa B093 0000 		sts lastTime.1538+3,r27
 475               	.LBB8:
 476               	.LBB9:
 210:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 477               		.stabn	68,0,210,.LM43-.LFBB7
 478               	.LM43:
 479 01ae 8091 0000 		lds r24,heartModulator+3
 212:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 480               		.stabn	68,0,212,.LM44-.LFBB7
 481               	.LM44:
 482 01b2 6091 0000 		lds r22,direction.1522
 483 01b6 7727      		clr r23
 484 01b8 67FD      		sbrc r22,7
 485 01ba 7095      		com r23
 486 01bc 680F      		add r22,r24
 487 01be 711D      		adc r23,__zero_reg__
 216:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 488               		.stabn	68,0,216,.LM45-.LFBB7
 489               	.LM45:
 490 01c0 6F3F      		cpi r22,-1
 491 01c2 7105      		cpc r23,__zero_reg__
 492 01c4 04F0      		brlt .L30
 219:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}	
 493               		.stabn	68,0,219,.LM46-.LFBB7
 494               	.LM46:
 495 01c6 8FEF      		ldi r24,lo8(-1)
 496 01c8 8093 0000 		sts direction.1522,r24
 218:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		direction = -1;
 497               		.stabn	68,0,218,.LM47-.LFBB7
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 16


 498               	.LM47:
 499 01cc 6FEF      		ldi r22,lo8(-1)
 500 01ce 70E0      		ldi r23,0
 501 01d0 00C0      		rjmp .L31
 502               	.L30:
 222:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 503               		.stabn	68,0,222,.LM48-.LFBB7
 504               	.LM48:
 505 01d2 1616      		cp __zero_reg__,r22
 506 01d4 1706      		cpc __zero_reg__,r23
 507 01d6 04F0      		brlt .L31
 225:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
 508               		.stabn	68,0,225,.LM49-.LFBB7
 509               	.LM49:
 510 01d8 81E0      		ldi r24,lo8(1)
 511 01da 8093 0000 		sts direction.1522,r24
 224:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		direction = +1;
 512               		.stabn	68,0,224,.LM50-.LFBB7
 513               	.LM50:
 514 01de 60E0      		ldi r22,0
 515 01e0 70E0      		ldi r23,0
 516               	.L31:
 517               	.LBE9:
 518               	.LBE8:
 349:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 350:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		hfm_setPower(&heartModulator, getNextDesired());
 519               		.stabn	68,0,350,.LM51-.LFBB7
 520               	.LM51:
 521 01e2 80E0      		ldi r24,lo8(heartModulator)
 522 01e4 90E0      		ldi r25,hi8(heartModulator)
 523 01e6 0E94 0000 		call hfm_setPower
 524               	.L29:
 351:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
 352:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 353:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 354:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //		Without inverter, LED tied high:
 355:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //			LED-ON		(DDR = H-out,	PORT = L)
 356:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //			LED-OFF/IN	(DDR = L-in,	PORT = H-pull-up)
 357:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //				(If IN is tied LOW, the LED will be ON)
 358:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //		With inverter, LED tied high, no resistors:
 359:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //			LED-OFF		(DDR = H-out,	PORT = L)
 360:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //			LED-ON/IN	(DDR = L-in,	PORT = H-pull-up)
 361:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //				(If IN is tied LOW, the LED will be OFF)
 362:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//determine whether the LED should be on or off based on the HFM
 363:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	// return TRUE if the pin is available as an input
 364:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	uint8_t ledVal;
 365:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 366:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (!defined(HEART_BLINK_UNUSED) || !HEART_BLINK_UNUSED)
 367:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	if(heartBlink)
 525               		.stabn	68,0,367,.LM52-.LFBB7
 526               	.LM52:
 527 01ea 8091 0000 		lds r24,heartBlink
 528 01ee 8823      		tst r24
 529 01f0 01F0      		breq .L32
 368:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		ledVal = blinkHeart(currentTime);
 530               		.stabn	68,0,368,.LM53-.LFBB7
 531               	.LM53:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 17


 532 01f2 6091 0000 		lds r22,currentTime.1539
 533 01f6 7091 0000 		lds r23,currentTime.1539+1
 534 01fa 8091 0000 		lds r24,currentTime.1539+2
 535 01fe 9091 0000 		lds r25,currentTime.1539+3
 536 0202 0E94 0000 		call blinkHeart
 537 0206 00C0      		rjmp .L33
 538               	.L32:
 369:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		//ledVal = blinkHeart((dms6sec_t)currentTime);
 370:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	else
 371:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
 372:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		ledVal = hfm_nextOutput(&heartModulator);
 539               		.stabn	68,0,372,.LM54-.LFBB7
 540               	.LM54:
 541 0208 80E0      		ldi r24,lo8(heartModulator)
 542 020a 90E0      		ldi r25,hi8(heartModulator)
 543 020c 0E94 0000 		call hfm_nextOutput
 544               	.L33:
 373:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 374:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	if(ledVal)
 545               		.stabn	68,0,374,.LM55-.LFBB7
 546               	.LM55:
 547 0210 8823      		tst r24
 548 0212 01F0      		breq .L34
 375:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 376:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (!defined(HEARTPIN_HARDCODED) || !HEARTPIN_HARDCODED)
 377:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		if(ledConnection == LED_DIRECT_HIGH)
 378:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		{
 379:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			//Set the direction first, so there's not a short short with the input switch
 380:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			//DDR = L,in
 381:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			setinVar(heartBeatPin, heartPIN);
 382:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			//PORT = H,pull-up
 383:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			setpuVar(heartBeatPin, heartPIN);
 384:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		}
 385:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		else if(ledConnection == LED_INVERTED)
 386:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		{
 387:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			//Shouldn't be necessary, but might as well...
 388:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			setoutVar(heartBeatPin, heartPIN);
 389:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 			setpinVar(heartBeatPin, heartPIN);
 390:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		}
 391:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #else
 392:../../../_commonCode/heartbeat/1.30/heartbeat.c ****  #if (HEART_LEDCONNECTION == LED_DIRECT_HIGH)
 393:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		setinPORT(HEART_PINNUM, HEART_PINPORT);
 549               		.stabn	68,0,393,.LM56-.LFBB7
 550               	.LM56:
 551 0214 2698      		cbi 0x4,6
 394:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		setpuPORT(HEART_PINNUM, HEART_PINPORT);
 552               		.stabn	68,0,394,.LM57-.LFBB7
 553               	.LM57:
 554 0216 2E9A      		sbi 0x5,6
 395:../../../_commonCode/heartbeat/1.30/heartbeat.c ****  #elif (HEART_LEDCONNECTION == LED_INVERTED)
 396:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		setoutPORT(HEART_PINNUM, HEART_PINPORT);
 397:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		setpinPORT(HEART_PINNUM, HEART_PINPORT);
 398:../../../_commonCode/heartbeat/1.30/heartbeat.c ****  #else
 399:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	#error "Not Handled..."
 400:../../../_commonCode/heartbeat/1.30/heartbeat.c ****  #endif
 401:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
 402:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		return TRUE;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 18


 555               		.stabn	68,0,402,.LM58-.LFBB7
 556               	.LM58:
 557 0218 81E0      		ldi r24,lo8(1)
 558 021a 00C0      		rjmp .L35
 559               	.L34:
 403:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
 404:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	else
 405:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 406:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (!defined(HEARTPIN_HARDCODED) || !HEARTPIN_HARDCODED)
 407:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		//This should be the same for either case...
 408:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		
 409:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		//Set the port first, so there's not a short 
 410:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		//(there may be an instant of floating on the input of an inverter)
 411:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		//PORT = L
 412:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		clrpinVar(heartBeatPin, heartPIN);
 413:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		//DDR = H,out
 414:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		setoutVar(heartBeatPin, heartPIN);
 415:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #else
 416:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		clrpinPORT(HEART_PINNUM, HEART_PINPORT);
 560               		.stabn	68,0,416,.LM59-.LFBB7
 561               	.LM59:
 562 021c 2E98      		cbi 0x5,6
 417:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		setoutPORT(HEART_PINNUM, HEART_PINPORT);
 563               		.stabn	68,0,417,.LM60-.LFBB7
 564               	.LM60:
 565 021e 269A      		sbi 0x4,6
 418:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
 419:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		return FALSE;
 566               		.stabn	68,0,419,.LM61-.LFBB7
 567               	.LM61:
 568 0220 80E0      		ldi r24,0
 569               	.L35:
 570               	/* epilogue start */
 420:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
 421:../../../_commonCode/heartbeat/1.30/heartbeat.c **** }
 571               		.stabn	68,0,421,.LM62-.LFBB7
 572               	.LM62:
 573 0222 1F91      		pop r17
 574 0224 0F91      		pop r16
 575 0226 0895      		ret
 576               		.size	heartUpdate, .-heartUpdate
 577               		.stabs	"lastTime:V(6,6)",38,0,336,lastTime.1538
 578               		.stabs	"currentTime:V(6,6)",38,0,338,currentTime.1539
 579               		.stabs	"ledVal:r(6,2)",64,0,364,24
 580               		.stabn	192,0,0,.LFBB7-.LFBB7
 581               		.stabn	224,0,0,.Lscope7-.LFBB7
 582               	.Lscope7:
 583               		.stabs	"",36,0,0,.Lscope7-.LFBB7
 584               		.stabd	78,0,0
 585               		.stabs	"heartupdate:F(0,47)",36,0,76,heartupdate
 586               	.global	heartupdate
 587               		.type	heartupdate, @function
 588               	heartupdate:
 589               		.stabd	46,0,0
  77:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	heartUpdate();
 590               		.stabn	68,0,77,.LM63-.LFBB8
 591               	.LM63:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 19


 592               	.LFBB8:
 593               	/* prologue: function */
 594               	/* frame size = 0 */
 595               	/* stack size = 0 */
 596               	.L__stack_usage = 0
  78:../../../_commonCode/heartbeat/1.30/heartbeat.c **** }
 597               		.stabn	68,0,78,.LM64-.LFBB8
 598               	.LM64:
 599 0228 0C94 0000 		jmp heartUpdate
 600               		.size	heartupdate, .-heartupdate
 601               	.Lscope8:
 602               		.stabs	"",36,0,0,.Lscope8-.LFBB8
 603               		.stabd	78,0,0
 604               		.stabs	"heartPinInputPoll:F(6,2)",36,0,434,heartPinInputPoll
 605               	.global	heartPinInputPoll
 606               		.type	heartPinInputPoll, @function
 607               	heartPinInputPoll:
 608               		.stabd	46,0,0
 422:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 423:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (!defined(HEART_INPUTPOLLING_UNUSED) || !HEART_INPUTPOLLING_UNUSED)
 424:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // This value's arbitrary... works with tabletBluetoother 3...
 425:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // This function takes about 20 bytes
 426:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // HEART_PULLUP_DELAY was originally 3, but doesn't seem to be enough for
 427:../../../_commonCode/heartbeat/1.30/heartbeat.c **** // the pwm161 running with CLKDIV8 disabled.
 428:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #ifndef HEART_PULLUP_DELAY
 429:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #define HEART_PULLUP_DELAY 255
 430:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #warning "HEART_PULLUP_DELAY is unset, defaulting to a large value"
 431:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #warning " You can add CFLAGS += -D'HEART_PULLUP_DELAY=<value>' to your makefile"
 432:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
 433:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 434:../../../_commonCode/heartbeat/1.30/heartbeat.c **** uint8_t heartPinInputPoll(void)
 435:../../../_commonCode/heartbeat/1.30/heartbeat.c **** {
 609               		.stabn	68,0,435,.LM65-.LFBB9
 610               	.LM65:
 611               	.LFBB9:
 612               	/* prologue: function */
 613               	/* frame size = 0 */
 614               	/* stack size = 0 */
 615               	.L__stack_usage = 0
 436:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	uint8_t pinState;
 437:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	
 438:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #if (!defined(HEARTPIN_HARDCODED) || !HEARTPIN_HARDCODED)
 439:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Make the pin an input, pulled-up
 440:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//OLD:Set the pullup first so it doesn't take so long to raise...
 441:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Set input first so we don't short the output (PORT=H,pu) to ground
 442:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	setinVar(heartBeatPin, heartPIN);
 443:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//PORT = H, pull-up
 444:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	setpuVar(heartBeatPin, heartPIN);
 445:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 446:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Insert a delay to allow the pull-up to rise...
 447:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	uint8_t delay; 
 448:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	for(delay = 0; delay < HEART_PULLUP_DELAY; delay++)
 449:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{  
 450:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	   //Necessary or this'll be optimised-out
 451:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	   asm("nop;");
 452:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
 453:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 20


 454:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	pinState = getpinVar(heartBeatPin, heartPIN);
 455:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #else
 456:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	setinPORT(HEART_PINNUM, HEART_PINPORT);
 616               		.stabn	68,0,456,.LM66-.LFBB9
 617               	.LM66:
 618 022c 2698      		cbi 0x4,6
 457:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	setpuPORT(HEART_PINNUM, HEART_PINPORT);
 619               		.stabn	68,0,457,.LM67-.LFBB9
 620               	.LM67:
 621 022e 2E9A      		sbi 0x5,6
 622 0230 8FEF      		ldi r24,lo8(-1)
 623               	.L39:
 458:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 459:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Insert a delay to allow the pull-up to rise...
 460:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	uint8_t delay;
 461:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	for(delay = 0; delay < HEART_PULLUP_DELAY; delay++)
 462:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 463:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		//Necessary or this'll be optimised-out
 464:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 		asm("nop;");
 624               		.stabn	68,0,464,.LM68-.LFBB9
 625               	.LM68:
 626               	/* #APP */
 627               	 ;  464 "../../../_commonCode/heartbeat/1.30/heartbeat.c" 1
 628 0232 0000      		nop;
 629               	 ;  0 "" 2
 630               	/* #NOAPP */
 631 0234 8150      		subi r24,lo8(-(-1))
 461:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	{
 632               		.stabn	68,0,461,.LM69-.LFBB9
 633               	.LM69:
 634 0236 01F4      		brne .L39
 465:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	}
 466:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 467:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	pinState = getpinPORT(HEART_PINNUM, HEART_PINPORT);
 635               		.stabn	68,0,467,.LM70-.LFBB9
 636               	.LM70:
 637 0238 83B1      		in r24,0x3
 468:../../../_commonCode/heartbeat/1.30/heartbeat.c **** #endif
 469:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 470:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Leave the pinstate to be updated with next heartUpdate
 471:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	// to assure valid/safe values of PORT and DDR...
 472:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	//Return the pin to the heartbeat
 473:../../../_commonCode/heartbeat/1.30/heartbeat.c **** //	setoutVar(heartBeatPin, heartPIN);
 474:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 
 475:../../../_commonCode/heartbeat/1.30/heartbeat.c **** 	return pinState;
 476:../../../_commonCode/heartbeat/1.30/heartbeat.c **** }
 638               		.stabn	68,0,476,.LM71-.LFBB9
 639               	.LM71:
 640 023a 86FB      		bst r24,6
 641 023c 8827      		clr r24
 642 023e 80F9      		bld r24,0
 643 0240 0895      		ret
 644               		.size	heartPinInputPoll, .-heartPinInputPoll
 645               	.Lscope9:
 646               		.stabs	"",36,0,0,.Lscope9-.LFBB9
 647               		.stabd	78,0,0
 648               		.data
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 21


 649               		.type	direction.1522, @object
 650               		.size	direction.1522, 1
 651               	direction.1522:
 652 0000 01        		.byte	1
 653               		.local	lastTime.1538
 654               		.comm	lastTime.1538,4,1
 655               		.local	currentTime.1539
 656               		.comm	currentTime.1539,4,1
 657               		.local	lastToggleTime.1531
 658               		.comm	lastToggleTime.1531,4,1
 659               		.local	toggleCount.1532
 660               		.comm	toggleCount.1532,1,1
 661               		.local	highNibble.1533
 662               		.comm	highNibble.1533,1,1
 663               	.global	heartBlink
 664               		.section .bss
 665               		.type	heartBlink, @object
 666               		.size	heartBlink, 1
 667               	heartBlink:
 668 0000 00        		.zero	1
 669               		.comm	heartModulator,4,1
 670               	.global	heartStepTime
 671               		.data
 672               		.type	heartStepTime, @object
 673               		.size	heartStepTime, 2
 674               	heartStepTime:
 675 0001 9C00      		.word	156
 676               		.stabs	"heartStepTime:G(6,4)",32,0,9,0
 677               		.stabs	"heartModulator:G(8,1)",32,0,28,0
 678               		.stabs	"heartBlink:G(6,2)",32,0,239,0
 679               		.text
 680               		.stabs	"",100,0,0,.Letext0
 681               	.Letext0:
 682               		.ident	"GCC: (GNU) 4.8.2"
 683               	.global __do_copy_data
 684               	.global __do_clear_bss
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s 			page 22


DEFINED SYMBOLS
                            *ABS*:00000000 heartbeat.c
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:2      *ABS*:0000003e __SP_H__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:3      *ABS*:0000003d __SP_L__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:4      *ABS*:0000003f __SREG__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:5      *ABS*:00000000 __tmp_reg__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:6      *ABS*:00000001 __zero_reg__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:111    .text:00000000 setHeartRate
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:674    .data:00000001 heartStepTime
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:145    .text:0000001c getHeartRate
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:172    .text:00000030 heartClear
                            *COM*:00000004 heartModulator
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:194    .text:0000003a init_heartBeat
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:235    .text:00000058 set_heartBlink
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:667    .bss:00000000 heartBlink
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:256    .text:0000005e blinkHeart
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:660    .bss:0000000e highNibble.1533
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:658    .bss:0000000d toggleCount.1532
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:656    .bss:00000009 lastToggleTime.1531
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:424    .text:00000142 heartUpdate
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:654    .bss:00000005 currentTime.1539
                             .bss:00000001 lastTime.1538
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:651    .data:00000000 direction.1522
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:588    .text:00000228 heartupdate
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccBGFLBz.s:607    .text:0000022c heartPinInputPoll

UNDEFINED SYMBOLS
__divmodhi4
__udivmodhi4
hfm_setPower
hfm_setup
hfm_nextOutput
__do_copy_data
__do_clear_bss
