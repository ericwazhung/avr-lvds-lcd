GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 1


   1               		.file	"heartbeat.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.stabs	"/Users/meh/_avrProjects/LCDdirectLVDS/68-backToLTN/",100,0,2,.Ltext0
   8               		.stabs	"_commonCode_localized/heartbeat/1.30/heartbeat.c",100,0,2,.Ltext0
   9               		.text
  10               	.Ltext0:
  11               		.stabs	"gcc2_compiled.",60,0,0,0
  12               		.stabs	"int:t(0,1)=r(0,1);-32768;32767;",128,0,0,0
  13               		.stabs	"char:t(0,2)=@s8;r(0,2);0;255;",128,0,0,0
  14               		.stabs	"long int:t(0,3)=@s32;r(0,3);020000000000;017777777777;",128,0,0,0
  15               		.stabs	"unsigned int:t(0,4)=r(0,4);0;0177777;",128,0,0,0
  16               		.stabs	"long unsigned int:t(0,5)=@s32;r(0,5);0;037777777777;",128,0,0,0
  17               		.stabs	"long long int:t(0,6)=@s64;r(0,6);01000000000000000000000;0777777777777777777777;",128,0,0,
  18               		.stabs	"long long unsigned int:t(0,7)=@s64;r(0,7);0;01777777777777777777777;",128,0,0,0
  19               		.stabs	"short int:t(0,8)=r(0,8);-32768;32767;",128,0,0,0
  20               		.stabs	"short unsigned int:t(0,9)=r(0,9);0;0177777;",128,0,0,0
  21               		.stabs	"signed char:t(0,10)=@s8;r(0,10);-128;127;",128,0,0,0
  22               		.stabs	"unsigned char:t(0,11)=@s8;r(0,11);0;255;",128,0,0,0
  23               		.stabs	"float:t(0,12)=r(0,1);4;0;",128,0,0,0
  24               		.stabs	"double:t(0,13)=r(0,1);4;0;",128,0,0,0
  25               		.stabs	"long double:t(0,14)=r(0,1);4;0;",128,0,0,0
  26               		.stabs	"short _Fract:t(0,15)=r(0,1);1;0;",128,0,0,0
  27               		.stabs	"_Fract:t(0,16)=r(0,1);2;0;",128,0,0,0
  28               		.stabs	"long _Fract:t(0,17)=r(0,1);4;0;",128,0,0,0
  29               		.stabs	"long long _Fract:t(0,18)=r(0,1);8;0;",128,0,0,0
  30               		.stabs	"unsigned short _Fract:t(0,19)=r(0,1);1;0;",128,0,0,0
  31               		.stabs	"unsigned _Fract:t(0,20)=r(0,1);2;0;",128,0,0,0
  32               		.stabs	"unsigned long _Fract:t(0,21)=r(0,1);4;0;",128,0,0,0
  33               		.stabs	"unsigned long long _Fract:t(0,22)=r(0,1);8;0;",128,0,0,0
  34               		.stabs	"_Sat short _Fract:t(0,23)=r(0,1);1;0;",128,0,0,0
  35               		.stabs	"_Sat _Fract:t(0,24)=r(0,1);2;0;",128,0,0,0
  36               		.stabs	"_Sat long _Fract:t(0,25)=r(0,1);4;0;",128,0,0,0
  37               		.stabs	"_Sat long long _Fract:t(0,26)=r(0,1);8;0;",128,0,0,0
  38               		.stabs	"_Sat unsigned short _Fract:t(0,27)=r(0,1);1;0;",128,0,0,0
  39               		.stabs	"_Sat unsigned _Fract:t(0,28)=r(0,1);2;0;",128,0,0,0
  40               		.stabs	"_Sat unsigned long _Fract:t(0,29)=r(0,1);4;0;",128,0,0,0
  41               		.stabs	"_Sat unsigned long long _Fract:t(0,30)=r(0,1);8;0;",128,0,0,0
  42               		.stabs	"short _Accum:t(0,31)=r(0,1);2;0;",128,0,0,0
  43               		.stabs	"_Accum:t(0,32)=r(0,1);4;0;",128,0,0,0
  44               		.stabs	"long _Accum:t(0,33)=r(0,1);8;0;",128,0,0,0
  45               		.stabs	"long long _Accum:t(0,34)=r(0,1);8;0;",128,0,0,0
  46               		.stabs	"unsigned short _Accum:t(0,35)=r(0,1);2;0;",128,0,0,0
  47               		.stabs	"unsigned _Accum:t(0,36)=r(0,1);4;0;",128,0,0,0
  48               		.stabs	"unsigned long _Accum:t(0,37)=r(0,1);8;0;",128,0,0,0
  49               		.stabs	"unsigned long long _Accum:t(0,38)=r(0,1);8;0;",128,0,0,0
  50               		.stabs	"_Sat short _Accum:t(0,39)=r(0,1);2;0;",128,0,0,0
  51               		.stabs	"_Sat _Accum:t(0,40)=r(0,1);4;0;",128,0,0,0
  52               		.stabs	"_Sat long _Accum:t(0,41)=r(0,1);8;0;",128,0,0,0
  53               		.stabs	"_Sat long long _Accum:t(0,42)=r(0,1);8;0;",128,0,0,0
  54               		.stabs	"_Sat unsigned short _Accum:t(0,43)=r(0,1);2;0;",128,0,0,0
  55               		.stabs	"_Sat unsigned _Accum:t(0,44)=r(0,1);4;0;",128,0,0,0
  56               		.stabs	"_Sat unsigned long _Accum:t(0,45)=r(0,1);8;0;",128,0,0,0
  57               		.stabs	"_Sat unsigned long long _Accum:t(0,46)=r(0,1);8;0;",128,0,0,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 2


  58               		.stabs	"void:t(0,47)=(0,47)",128,0,0,0
  59               		.stabs	"_commonCode_localized/heartbeat/1.30/heartbeat.h",130,0,0,0
  60               		.stabs	"/opt/local/avr/include/avr/io.h",130,0,0,0
  61               		.stabs	"/opt/local/avr/include/avr/sfr_defs.h",130,0,0,0
  62               		.stabs	"/opt/local/avr/include/inttypes.h",130,0,0,0
  63               		.stabs	"/opt/local/lib/gcc/avr/4.8.2/include/stdint.h",130,0,0,0
  64               		.stabs	"/opt/local/avr/include/stdint.h",130,0,0,0
  65               		.stabs	"int8_t:t(6,1)=(0,10)",128,0,121,0
  66               		.stabs	"uint8_t:t(6,2)=(0,11)",128,0,122,0
  67               		.stabs	"int16_t:t(6,3)=(0,1)",128,0,123,0
  68               		.stabs	"uint16_t:t(6,4)=(0,4)",128,0,124,0
  69               		.stabs	"int32_t:t(6,5)=(0,3)",128,0,125,0
  70               		.stabs	"uint32_t:t(6,6)=(0,5)",128,0,126,0
  71               		.stabs	"int64_t:t(6,7)=(0,6)",128,0,128,0
  72               		.stabs	"uint64_t:t(6,8)=(0,7)",128,0,129,0
  73               		.stabs	"intptr_t:t(6,9)=(6,3)",128,0,142,0
  74               		.stabs	"uintptr_t:t(6,10)=(6,4)",128,0,147,0
  75               		.stabs	"int_least8_t:t(6,11)=(6,1)",128,0,159,0
  76               		.stabs	"uint_least8_t:t(6,12)=(6,2)",128,0,164,0
  77               		.stabs	"int_least16_t:t(6,13)=(6,3)",128,0,169,0
  78               		.stabs	"uint_least16_t:t(6,14)=(6,4)",128,0,174,0
  79               		.stabs	"int_least32_t:t(6,15)=(6,5)",128,0,179,0
  80               		.stabs	"uint_least32_t:t(6,16)=(6,6)",128,0,184,0
  81               		.stabs	"int_least64_t:t(6,17)=(6,7)",128,0,192,0
  82               		.stabs	"uint_least64_t:t(6,18)=(6,8)",128,0,199,0
  83               		.stabs	"int_fast8_t:t(6,19)=(6,1)",128,0,213,0
  84               		.stabs	"uint_fast8_t:t(6,20)=(6,2)",128,0,218,0
  85               		.stabs	"int_fast16_t:t(6,21)=(6,3)",128,0,223,0
  86               		.stabs	"uint_fast16_t:t(6,22)=(6,4)",128,0,228,0
  87               		.stabs	"int_fast32_t:t(6,23)=(6,5)",128,0,233,0
  88               		.stabs	"uint_fast32_t:t(6,24)=(6,6)",128,0,238,0
  89               		.stabs	"int_fast64_t:t(6,25)=(6,7)",128,0,246,0
  90               		.stabs	"uint_fast64_t:t(6,26)=(6,8)",128,0,253,0
  91               		.stabs	"intmax_t:t(6,27)=(6,7)",128,0,273,0
  92               		.stabs	"uintmax_t:t(6,28)=(6,8)",128,0,278,0
  93               		.stabn	162,0,0,0
  94               		.stabn	162,0,0,0
  95               		.stabs	"int_farptr_t:t(4,1)=(6,5)",128,0,77,0
  96               		.stabs	"uint_farptr_t:t(4,2)=(6,6)",128,0,81,0
  97               		.stabn	162,0,0,0
  98               		.stabn	162,0,0,0
  99               		.stabs	"/opt/local/avr/include/avr/fuse.h",130,0,0,0
 100               		.stabs	"__fuse_t:t(7,1)=(7,2)=s3low:(0,11),0,8;high:(0,11),8,8;extended:(0,11),16,8;;",128,0,244,0
 101               		.stabn	162,0,0,0
 102               		.stabn	162,0,0,0
 103               		.stabs	"./_commonCode_localized/hfModulation/1.00/hfModulation.h",130,0,0,0
 104               		.stabs	"hfm_t:t(8,1)=(8,2)=B(8,3)=s4desiredSum:(6,3),0,16;maxPower:(6,2),16,8;power:(6,2),24,8;;",
 105               		.stabn	162,0,0,0
 106               		.stabs	"./_commonCode_localized/dmsTimer/1.13/dmsTimer.h",130,0,0,0
 107               		.stabs	"./_commonCode_localized/xyTracker/3.05/xyTracker.h",130,0,0,0
 108               		.stabs	"./_commonCode_localized/coordStuff/0.90/coordStuff.h",130,0,0,0
 109               		.stabs	"coord_t:t(11,1)=(6,5)",128,0,31,0
 110               		.stabs	"ucoord_t:t(11,2)=(6,6)",128,0,38,0
 111               		.stabn	162,0,0,0
 112               		.stabs	"_XYTSTRUCTRECORD:T(10,1)=s21runningSum:(11,2),0,32;incrementBase:(11,1),32,32;rise:(11,2),
 113               		.stabs	"xyt_t:t(10,2)=(10,3)=B(10,1)",128,0,171,0
 114               		.stabn	162,0,0,0
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 3


 115               		.stabs	"dms6sec_t:t(9,1)=(6,4)",128,0,111,0
 116               		.stabs	"dms4day_t:t(9,2)=(6,6)",128,0,113,0
 117               		.stabs	"dmsMax_t:t(9,3)=(6,6)",128,0,114,0
 118               		.stabn	162,0,0,0
 119               		.stabn	162,0,0,0
 120               		.stabs	"setHeartRate:F(0,47)",36,0,56,setHeartRate
 121               		.stabs	"rate:P(6,2)",64,0,56,24
 122               	.global	setHeartRate
 123               		.type	setHeartRate, @function
 124               	setHeartRate:
 125               		.stabd	46,0,0
   1:_commonCode_localized/heartbeat/1.30/heartbeat.c **** /* mehPL:
   2:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  *    I'm not too fond of long licenses at the top of the file.
   4:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  *    Please see the bottom.
   5:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  *    Enjoy!
   6:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  */
   7:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
   8:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
   9:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  10:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  11:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //heartbeat 1.20
  12:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #include "heartbeat.h"
  13:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  14:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  15:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //100% = 255, 0% = 0...
  16:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //volatile uint8_t  newDesired = 0;
  17:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  18:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //Could be uint8 for dms and uint16 for nondms
  19:_commonCode_localized/heartbeat/1.30/heartbeat.c **** uint16_t heartStepTime = HEARTSTEPTIME;
  20:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  21:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  22:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //volatile uint8_t  heartSet = HEARTDONTSET;
  23:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  24:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (!defined(HEARTPIN_HARDCODED) || !HEARTPIN_HARDCODED)
  25:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //#define LED_DIRECT_HIGH
  26:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //#define LED_INVERTED
  27:_commonCode_localized/heartbeat/1.30/heartbeat.c **** uint8_t ledConnection;
  28:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  29:_commonCode_localized/heartbeat/1.30/heartbeat.c **** volatile uint8_t*	heartPIN;
  30:_commonCode_localized/heartbeat/1.30/heartbeat.c **** uint8_t heartBeatPin;
  31:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
  32:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  33:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //shift the update-period by heartRate to increase the rate
  34:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // this is a right-shift for calculation efficiency
  35:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // so rates are 0, 1, 2, 3 -> PERIOD, PERIOD/2, PERIOD/4, PERIOD/8...
  36:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //uint8_t heartRate = 0;
  37:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  38:_commonCode_localized/heartbeat/1.30/heartbeat.c **** hfm_t heartModulator;
  39:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  40:_commonCode_localized/heartbeat/1.30/heartbeat.c **** /*
  41:_commonCode_localized/heartbeat/1.30/heartbeat.c **** void heartMode(uint8_t mode)
  42:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {
  43:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	switch(mode)
  44:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
  45:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		case HEART_2X:
  46:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			heartRate = 1;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 4


  47:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			break;
  48:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		case HEART_4X:
  49:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			heartRate 
  50:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
  51:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
  52:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	heartSet = mode;
  53:_commonCode_localized/heartbeat/1.30/heartbeat.c **** }
  54:_commonCode_localized/heartbeat/1.30/heartbeat.c **** */
  55:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  56:_commonCode_localized/heartbeat/1.30/heartbeat.c **** void setHeartRate(uint8_t rate)
  57:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {
 126               		.stabn	68,0,57,.LM0-.LFBB1
 127               	.LM0:
 128               	.LFBB1:
 129               	/* prologue: function */
 130               	/* frame size = 0 */
 131               	/* stack size = 0 */
 132               	.L__stack_usage = 0
  58:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	heartRate = rate;
  59:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
  60:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	if(rate == 0)
 133               		.stabn	68,0,60,.LM1-.LFBB1
 134               	.LM1:
 135 0000 8111      		cpse r24,__zero_reg__
 136 0002 00C0      		rjmp .L2
  61:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		rate = 1;
 137               		.stabn	68,0,61,.LM2-.LFBB1
 138               	.LM2:
 139 0004 81E0      		ldi r24,lo8(1)
 140               	.L2:
  62:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		
  63:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	#if (_HEART_DMS_)
  64:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  65:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #warning "Relevant Everywhere: dms6sec_t used in heartbeat, yet a full cycle is 8 seconds, and neve
  66:_commonCode_localized/heartbeat/1.30/heartbeat.c ****     heartStepTime = (HEARTSTEPTIME/rate);
 141               		.stabn	68,0,66,.LM3-.LFBB1
 142               	.LM3:
 143 0006 682F      		mov r22,r24
 144 0008 70E0      		ldi r23,0
 145 000a 8CE9      		ldi r24,lo8(-100)
 146 000c 90E0      		ldi r25,0
 147 000e 0E94 0000 		call __divmodhi4
 148 0012 7093 0000 		sts heartStepTime+1,r23
 149 0016 6093 0000 		sts heartStepTime,r22
 150 001a 0895      		ret
 151               		.size	setHeartRate, .-setHeartRate
 152               	.Lscope1:
 153               		.stabs	"",36,0,0,.Lscope1-.LFBB1
 154               		.stabd	78,0,0
 155               		.stabs	"getHeartRate:F(6,2)",36,0,74,getHeartRate
 156               	.global	getHeartRate
 157               		.type	getHeartRate, @function
 158               	getHeartRate:
 159               		.stabd	46,0,0
  67:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	#else
  68:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	 heartStepTime = (HEART_ITERATIONCOUNT/rate);
  69:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	#endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 5


  70:_commonCode_localized/heartbeat/1.30/heartbeat.c **** }
  71:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  72:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (!defined(HEART_GETRATE_UNUSED) || !HEART_GETRATE_UNUSED)
  73:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //This function takes about 20 bytes
  74:_commonCode_localized/heartbeat/1.30/heartbeat.c **** uint8_t getHeartRate(void)
  75:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {
 160               		.stabn	68,0,75,.LM4-.LFBB2
 161               	.LM4:
 162               	.LFBB2:
 163               	/* prologue: function */
 164               	/* frame size = 0 */
 165               	/* stack size = 0 */
 166               	.L__stack_usage = 0
  76:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	#if (_HEART_DMS_)
  77:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	 return HEARTSTEPTIME/heartStepTime;
 167               		.stabn	68,0,77,.LM5-.LFBB2
 168               	.LM5:
 169 001c 6091 0000 		lds r22,heartStepTime
 170 0020 7091 0000 		lds r23,heartStepTime+1
 171 0024 8CE9      		ldi r24,lo8(-100)
 172 0026 90E0      		ldi r25,0
 173 0028 0E94 0000 		call __udivmodhi4
 174 002c 862F      		mov r24,r22
  78:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	#else
  79:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	 return HEART_ITERATIONCOUNT/heartStepTime;
  80:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	#endif
  81:_commonCode_localized/heartbeat/1.30/heartbeat.c **** }
 175               		.stabn	68,0,81,.LM6-.LFBB2
 176               	.LM6:
 177 002e 0895      		ret
 178               		.size	getHeartRate, .-getHeartRate
 179               	.Lscope2:
 180               		.stabs	"",36,0,0,.Lscope2-.LFBB2
 181               		.stabd	78,0,0
 182               		.stabs	"heartClear:F(0,47)",36,0,92,heartClear
 183               	.global	heartClear
 184               		.type	heartClear, @function
 185               	heartClear:
 186               		.stabd	46,0,0
  82:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
  83:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  84:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (!defined(DMS_WAITFN_UNUSED) || !DMS_WAITFN_UNUSED)
  85:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // This only saves 4 bytes...
  86:_commonCode_localized/heartbeat/1.30/heartbeat.c **** void heartupdate(void)
  87:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {
  88:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	heartUpdate();
  89:_commonCode_localized/heartbeat/1.30/heartbeat.c **** }
  90:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
  91:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  92:_commonCode_localized/heartbeat/1.30/heartbeat.c **** void heartClear(void)
  93:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {
 187               		.stabn	68,0,93,.LM7-.LFBB3
 188               	.LM7:
 189               	.LFBB3:
 190               	/* prologue: function */
 191               	/* frame size = 0 */
 192               	/* stack size = 0 */
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 6


 193               	.L__stack_usage = 0
  94:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	hfm_setPower(&heartModulator, 0);
 194               		.stabn	68,0,94,.LM8-.LFBB3
 195               	.LM8:
 196 0030 60E0      		ldi r22,0
 197 0032 80E0      		ldi r24,lo8(heartModulator)
 198 0034 90E0      		ldi r25,hi8(heartModulator)
 199 0036 0C94 0000 		jmp hfm_setPower
 200               		.size	heartClear, .-heartClear
 201               	.Lscope3:
 202               		.stabs	"",36,0,0,.Lscope3-.LFBB3
 203               		.stabd	78,0,0
 204               		.stabs	"init_heartBeat:F(0,47)",36,0,118,init_heartBeat
 205               	.global	init_heartBeat
 206               		.type	init_heartBeat, @function
 207               	init_heartBeat:
 208               		.stabd	46,0,0
  95:_commonCode_localized/heartbeat/1.30/heartbeat.c **** }
  96:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  97:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
  98:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (!defined(HEARTPIN_HARDCODED) || !HEARTPIN_HARDCODED)
  99:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //THIS USES THE WDT NOW!
 100:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // AFTER init_heartBeat, the wdt must be reset often enough!!! this can be accomplished via heartUp
 101:_commonCode_localized/heartbeat/1.30/heartbeat.c **** void init_heartBeat(volatile uint8_t* pin, uint8_t pinName, uint8_t ledConnectionType)
 102:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {
 103:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	heartDDR = ddr;
 104:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	heartPIN = pin;
 105:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	heartBeatPin = pinName;
 106:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	ledConnection = ledConnectionType;
 107:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 108:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	setoutVar(heartBeatPin, heartPIN);
 109:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	setout(PD6, DDRD);
 110:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 111:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Set the port first, so there's not a short 
 112:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//(there may be an instant of floating on the input of an inverter)
 113:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//PORT = L
 114:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	clrpinVar(heartBeatPin, heartPIN);
 115:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//DDR = H,out
 116:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	setoutVar(heartBeatPin, heartPIN);
 117:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #else
 118:_commonCode_localized/heartbeat/1.30/heartbeat.c **** void init_heartBeat(void)
 119:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {
 209               		.stabn	68,0,119,.LM9-.LFBB4
 210               	.LM9:
 211               	.LFBB4:
 212               	/* prologue: function */
 213               	/* frame size = 0 */
 214               	/* stack size = 0 */
 215               	.L__stack_usage = 0
 120:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	clrpinPORT(HEART_PINNUM, HEART_PINPORT);
 216               		.stabn	68,0,120,.LM10-.LFBB4
 217               	.LM10:
 218 003a 2E98      		cbi 0x5,6
 121:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	setoutPORT(HEART_PINNUM, HEART_PINPORT);
 219               		.stabn	68,0,121,.LM11-.LFBB4
 220               	.LM11:
 221 003c 269A      		sbi 0x4,6
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 7


 122:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
 123:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 124:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 125:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 126:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	hfm_setPower(&heartModulator, 0);
 127:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	hfm_setup(&heartModulator, 0, HEART_MAXBRIGHT);
 222               		.stabn	68,0,127,.LM12-.LFBB4
 223               	.LM12:
 224 003e 4FEF      		ldi r20,lo8(-1)
 225 0040 60E0      		ldi r22,0
 226 0042 80E0      		ldi r24,lo8(heartModulator)
 227 0044 90E0      		ldi r25,hi8(heartModulator)
 228 0046 0E94 0000 		call hfm_setup
 229               	.LBB6:
 230               	.LBB7:
  66:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	#else
 231               		.stabn	68,0,66,.LM13-.LFBB4
 232               	.LM13:
 233 004a 8CE9      		ldi r24,lo8(-100)
 234 004c 90E0      		ldi r25,0
 235 004e 9093 0000 		sts heartStepTime+1,r25
 236 0052 8093 0000 		sts heartStepTime,r24
 237 0056 0895      		ret
 238               	.LBE7:
 239               	.LBE6:
 240               		.size	init_heartBeat, .-init_heartBeat
 241               	.Lscope4:
 242               		.stabs	"",36,0,0,.Lscope4-.LFBB4
 243               		.stabd	78,0,0
 244               		.stabs	"set_heartBlink:F(0,47)",36,0,252,set_heartBlink
 245               		.stabs	"count:P(6,2)",64,0,252,24
 246               	.global	set_heartBlink
 247               		.type	set_heartBlink, @function
 248               	set_heartBlink:
 249               		.stabd	46,0,0
 128:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 129:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	setHeartRate(0);
 130:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 131:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (_HEART_DMS_)
 132:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  #if (defined(_DMS_EXTERNALUPDATE_) && _DMS_EXTERNALUPDATE_)
 133:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//dmsTimer should be initialized elsewhere based on the rate of dmsUpdate calls...
 134:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  #else 
 135:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	init_dmsTimer();
 136:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  #endif
 137:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 138:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
 139:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 140:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 141:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (!defined(_WDT_DISABLE_) || !_WDT_DISABLE_)
 142:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	// IF the reset occurred, the WDTimer is reset to 16ms!
 143:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	// IF wdt_reset() isn't called before then, it will get stuck resetting!
 144:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//!!!! This can happen even if the WDT is NEVER ENABLED
 145:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	// esp. if the bit is set during a brown-out...
 146:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	wdt_reset();
 147:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	// So also disable it (and reenable it if we want it)
 148:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	wdt_disable();
 149:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 8


 150:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Check if there was a watchdog reset...
 151:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	// IF the reset occurred, the WDTimer is reset to 16ms!
 152:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	// IF wdt_reset() isn't called before then, it will get stuck resetting!
 153:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//!!!! This can happen even if the WDT is NEVER ENABLED
 154:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	// esp. if the bit is set during a brown-out...
 155:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Could also check ! Power-On, and/or brownout... 
 156:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	if(getbit(WDRF, MCUStatReg))
 157:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 158:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		setHeartRate(32);
 159:_commonCode_localized/heartbeat/1.30/heartbeat.c **** /*
 160:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		
 161:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		//HALT HERE FOR DEBUGGING!!!
 162:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		// INDICATE it on the HeartBeat!
 163:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #warning "watchdog should NOT hang the system when distributed... this is DEBUGGING ONLY"
 164:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		while(1)
 165:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		{
 166:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			heartUpdate();
 167:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		}
 168:_commonCode_localized/heartbeat/1.30/heartbeat.c **** */
 169:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
 170:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	if(!getbit(PORF, MCUStatReg))
 171:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 172:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		//It seems unusual that a brown-out wouldn't occur on power-up... takes time to charge caps, etc.
 173:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		//only check this if PowerOnReset was already cleared from a previous run
 174:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		if(getbit(BORF, MCUStatReg))
 175:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		{
 176:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			setHeartRate(16);
 177:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		}
 178:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
 179:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Clear the reset flags so we can see next time...
 180:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	MCUSR = 0x0f;
 181:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	MCUStatReg = 0;
 182:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 183:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//It's kinda handy to have the WDT run for a while so we can tell it crashed...
 184:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  #if defined(_WDTO_USER_)
 185:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	wdt_enable(_WDTO_USER_);
 186:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  #else
 187:_commonCode_localized/heartbeat/1.30/heartbeat.c ****   #if defined(WDTO_4S)
 188:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	wdt_enable(WDTO_4S);
 189:_commonCode_localized/heartbeat/1.30/heartbeat.c ****   #else
 190:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	wdt_enable(WDTO_1S);
 191:_commonCode_localized/heartbeat/1.30/heartbeat.c ****   #endif
 192:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  #endif
 193:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #else
 194:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  #warning "WDT DISABLED"
 195:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
 196:_commonCode_localized/heartbeat/1.30/heartbeat.c **** }
 197:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 198:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //Increment or decrement the heart brightness as appropriate
 199:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // this is called periodically by heartUpdate...
 200:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // This function takes about 32 bytes
 201:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // and inlining it saved 6, wee!
 202:_commonCode_localized/heartbeat/1.30/heartbeat.c **** static __inline__ uint8_t getNextDesired(void)
 203:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {
 204:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Don't set abs(direction) > 1 or we'll have wraparound errors!
 205:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	static int8_t direction = +1;
 206:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	int16_t desired;
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 9


 207:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 208:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 209:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //Somehow it seems the program gets stuck with the heartbeat at half-brightness...
 210:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //So main is still running, but the heart isn't incrementing!
 211:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // So do the watchdog reset here...
 212:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 213:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //!!! Check This with WDT...
 214:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //#warning "at what heart_reset() rate will getNextDesired never be called?"
 215:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (!defined(_WDT_DISABLE_) || !_WDT_DISABLE_)
 216:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Woot! Saved two bytes!
 217:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	wdt_reset();
 218:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
 219:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 220:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	desired = (uint8_t)(heartModulator.power);
 221:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 222:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	desired += direction;
 223:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 224:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Slightly slower not to have these internal to above, but also safer...
 225:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 226:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	if(desired >= HEART_MAXBRIGHT)
 227:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 228:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		desired = HEART_MAXBRIGHT;
 229:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		direction = -1;
 230:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}	
 231:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 232:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	if(desired <= 0)
 233:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 234:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		desired = 0;
 235:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		direction = +1;
 236:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
 237:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 238:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	return (uint8_t)desired;
 239:_commonCode_localized/heartbeat/1.30/heartbeat.c **** }
 240:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 241:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (!defined(HEART_BLINK_UNUSED) || !HEART_BLINK_UNUSED)
 242:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //Used for error-indication...
 243:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // when 0, the heart fades as usual
 244:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // when non-zero the heart blinks as follows:
 245:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //  say heartBlink is 0xXY, it will blink Y times first, then X times
 246:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //  then repeat...
 247:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // (actually, I think that's backwards, a remnant of times past... I think
 248:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // it's now X times first, then Y...)
 249:_commonCode_localized/heartbeat/1.30/heartbeat.c **** uint8_t heartBlink = 0;
 250:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //#define TOGGLETIME	(250*DMS_MS)
 251:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 252:_commonCode_localized/heartbeat/1.30/heartbeat.c **** void set_heartBlink(uint8_t count)
 253:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {
 250               		.stabn	68,0,253,.LM14-.LFBB5
 251               	.LM14:
 252               	.LFBB5:
 253               	/* prologue: function */
 254               	/* frame size = 0 */
 255               	/* stack size = 0 */
 256               	.L__stack_usage = 0
 254:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	heartBlink = count;
 257               		.stabn	68,0,254,.LM15-.LFBB5
 258               	.LM15:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 10


 259 0058 8093 0000 		sts heartBlink,r24
 260 005c 0895      		ret
 261               		.size	set_heartBlink, .-set_heartBlink
 262               	.Lscope5:
 263               		.stabs	"",36,0,0,.Lscope5-.LFBB5
 264               		.stabd	78,0,0
 265               		.stabs	"blinkHeart:F(6,2)",36,0,262,blinkHeart
 266               		.stabs	"currentTime:P(9,1)",64,0,262,24
 267               	.global	blinkHeart
 268               		.type	blinkHeart, @function
 269               	blinkHeart:
 270               		.stabd	46,0,0
 255:_commonCode_localized/heartbeat/1.30/heartbeat.c **** }
 256:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 257:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //Called by heartUpdate... used internally, only
 258:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (_HEART_DMS_)
 259:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #define TOGGLETIME   (250*DMS_MS)
 260:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //This function takes about 288 bytes
 261:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #warning "This may get cut, if the blink-rate is longer than 6sec!"
 262:_commonCode_localized/heartbeat/1.30/heartbeat.c **** uint8_t blinkHeart(dms6sec_t currentTime)
 263:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {
 271               		.stabn	68,0,263,.LM16-.LFBB6
 272               	.LM16:
 273               	.LFBB6:
 274 005e 0F93      		push r16
 275 0060 1F93      		push r17
 276               	/* prologue: function */
 277               	/* frame size = 0 */
 278               	/* stack size = 2 */
 279               	.L__stack_usage = 2
 264:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	static dms6sec_t lastToggleTime = 0;
 265:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #else
 266:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #define TOGGLETIME   (2500)
 267:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 268:_commonCode_localized/heartbeat/1.30/heartbeat.c **** uint8_t blinkHeart(uint32_t currentTime)
 269:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {
 270:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	static uint32_t lastToggleTime = 0;
 271:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
 272:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 273:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	static uint8_t toggleCount = 0;
 274:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 275:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//This is not THE high nibble
 276:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	// This is True or False depending on 
 277:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//  whether thisNibble is the high nibble
 278:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	static uint8_t highNibble = 0;
 279:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 280:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 281:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	uint8_t thisNibble = heartBlink;
 280               		.stabn	68,0,281,.LM17-.LFBB6
 281               	.LM17:
 282 0062 3091 0000 		lds r19,heartBlink
 282:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 283:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//If both nibbles are filled, process them as specified
 284:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	if((heartBlink & 0xf0) && (heartBlink & 0x0f))
 283               		.stabn	68,0,284,.LM18-.LFBB6
 284               	.LM18:
 285 0066 432F      		mov r20,r19
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 11


 286 0068 407F      		andi r20,lo8(-16)
 287 006a 232F      		mov r18,r19
 288 006c 2F70      		andi r18,lo8(15)
 289 006e 4423      		tst r20
 290 0070 01F0      		breq .L10
 291               		.stabn	68,0,284,.LM19-.LFBB6
 292               	.LM19:
 293 0072 2111      		cpse r18,__zero_reg__
 294 0074 00C0      		rjmp .L11
 285:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{	//Fall through and toggle...
 286:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
 287:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Otherwise just process the one that's filled
 288:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	// to avoid long delays and hopefully make it easier to determine which
 289:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	// nibble is filled...
 290:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	else if(heartBlink & 0x0f)
 291:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		highNibble = 0;
 292:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	else if(heartBlink & 0xf0)
 293:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		highNibble = 1;
 295               		.stabn	68,0,293,.LM20-.LFBB6
 296               	.LM20:
 297 0076 41E0      		ldi r20,lo8(1)
 298 0078 4093 0000 		sts highNibble.1610,r20
 299 007c 00C0      		rjmp .L11
 300               	.L10:
 290:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		highNibble = 0;
 301               		.stabn	68,0,290,.LM21-.LFBB6
 302               	.LM21:
 303 007e 2111      		cpse r18,__zero_reg__
 291:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	else if(heartBlink & 0xf0)
 304               		.stabn	68,0,291,.LM22-.LFBB6
 305               	.LM22:
 306 0080 1092 0000 		sts highNibble.1610,__zero_reg__
 307               	.L11:
 294:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 295:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Fill the appropriate nibble for blinking...
 296:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	if(highNibble)
 308               		.stabn	68,0,296,.LM23-.LFBB6
 309               	.LM23:
 310 0084 E091 0000 		lds r30,highNibble.1610
 311 0088 EE23      		tst r30
 312 008a 01F0      		breq .L13
 297:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		thisNibble = (thisNibble & 0xf0) >> 4;
 313               		.stabn	68,0,297,.LM24-.LFBB6
 314               	.LM24:
 315 008c 532F      		mov r21,r19
 316 008e 5295      		swap r21
 317 0090 5F70      		andi r21,lo8(15)
 318 0092 00C0      		rjmp .L14
 319               	.L13:
 298:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	else
 299:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		thisNibble = (thisNibble & 0x0f);
 320               		.stabn	68,0,299,.LM25-.LFBB6
 321               	.LM25:
 322 0094 522F      		mov r21,r18
 323               	.L14:
 300:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 301:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Blink the proper number of times
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 12


 302:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	if((toggleCount>>1) < thisNibble)
 324               		.stabn	68,0,302,.LM26-.LFBB6
 325               	.LM26:
 326 0096 4091 0000 		lds r20,toggleCount.1609
 327 009a 642F      		mov r22,r20
 328 009c 6695      		lsr r22
 329 009e 2091 0000 		lds r18,lastToggleTime.1608
 330 00a2 3091 0000 		lds r19,lastToggleTime.1608+1
 331 00a6 6517      		cp r22,r21
 332 00a8 00F4      		brsh .L15
 303:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 304:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		if(currentTime - lastToggleTime > TOGGLETIME)
 333               		.stabn	68,0,304,.LM27-.LFBB6
 334               	.LM27:
 335 00aa BC01      		movw r22,r24
 336 00ac 621B      		sub r22,r18
 337 00ae 730B      		sbc r23,r19
 338 00b0 9B01      		movw r18,r22
 339 00b2 253C      		cpi r18,-59
 340 00b4 3940      		sbci r19,9
 341 00b6 00F0      		brlo .L16
 305:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		{
 306:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			lastToggleTime = currentTime;
 342               		.stabn	68,0,306,.LM28-.LFBB6
 343               	.LM28:
 344 00b8 9093 0000 		sts lastToggleTime.1608+1,r25
 345 00bc 8093 0000 		sts lastToggleTime.1608,r24
 307:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			toggleCount++;
 346               		.stabn	68,0,307,.LM29-.LFBB6
 347               	.LM29:
 348 00c0 4F5F      		subi r20,lo8(-(1))
 349 00c2 4093 0000 		sts toggleCount.1609,r20
 350 00c6 00C0      		rjmp .L16
 351               	.L15:
 308:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		}
 309:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
 310:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Wait for a while
 311:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #warning "There may be some integer promotion issues here..."
 312:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	else if(currentTime - lastToggleTime > 
 352               		.stabn	68,0,312,.LM30-.LFBB6
 353               	.LM30:
 354 00c8 8C01      		movw r16,r24
 355 00ca 021B      		sub r16,r18
 356 00cc 130B      		sbc r17,r19
 357 00ce 20E0      		ldi r18,0
 358 00d0 30E0      		ldi r19,0
 313:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 						(((uint32_t)(TOGGLETIME * 8))<<(highNibble)))
 359               		.stabn	68,0,313,.LM31-.LFBB6
 360               	.LM31:
 361 00d2 40E2      		ldi r20,lo8(32)
 362 00d4 5EE4      		ldi r21,lo8(78)
 363 00d6 60E0      		ldi r22,0
 364 00d8 70E0      		ldi r23,0
 365 00da 0E2E      		mov r0,r30
 366 00dc 00C0      		rjmp 2f
 367               		1:
 368 00de 440F      		lsl r20
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 13


 369 00e0 551F      		rol r21
 370 00e2 661F      		rol r22
 371 00e4 771F      		rol r23
 372               		2:
 373 00e6 0A94      		dec r0
 374 00e8 02F4      		brpl 1b
 312:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 						(((uint32_t)(TOGGLETIME * 8))<<(highNibble)))
 375               		.stabn	68,0,312,.LM32-.LFBB6
 376               	.LM32:
 377 00ea 4017      		cp r20,r16
 378 00ec 5107      		cpc r21,r17
 379 00ee 6207      		cpc r22,r18
 380 00f0 7307      		cpc r23,r19
 381 00f2 00F4      		brsh .L16
 314:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 315:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		toggleCount = 0;
 382               		.stabn	68,0,315,.LM33-.LFBB6
 383               	.LM33:
 384 00f4 1092 0000 		sts toggleCount.1609,__zero_reg__
 316:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		lastToggleTime = currentTime;
 385               		.stabn	68,0,316,.LM34-.LFBB6
 386               	.LM34:
 387 00f8 9093 0000 		sts lastToggleTime.1608+1,r25
 388 00fc 8093 0000 		sts lastToggleTime.1608,r24
 317:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		//Only valid if both nibbles are filled (see above)
 318:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		highNibble = !highNibble;
 389               		.stabn	68,0,318,.LM35-.LFBB6
 390               	.LM35:
 391 0100 81E0      		ldi r24,lo8(1)
 392 0102 E111      		cpse r30,__zero_reg__
 393 0104 80E0      		ldi r24,0
 394               	.L17:
 395 0106 8093 0000 		sts highNibble.1610,r24
 396               	.L16:
 319:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
 320:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 321:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//(actually, the new value, at this point... but will be the last soon)
 322:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	return !getbit(0, toggleCount);
 397               		.stabn	68,0,322,.LM36-.LFBB6
 398               	.LM36:
 399 010a 8091 0000 		lds r24,toggleCount.1609
 400 010e 8095      		com r24
 323:_commonCode_localized/heartbeat/1.30/heartbeat.c **** }
 401               		.stabn	68,0,323,.LM37-.LFBB6
 402               	.LM37:
 403 0110 8170      		andi r24,lo8(1)
 404               	/* epilogue start */
 405 0112 1F91      		pop r17
 406 0114 0F91      		pop r16
 407 0116 0895      		ret
 408               		.size	blinkHeart, .-blinkHeart
 409               		.stabs	"lastToggleTime:V(9,1)",38,0,264,lastToggleTime.1608
 410               		.stabs	"toggleCount:V(6,2)",38,0,273,toggleCount.1609
 411               		.stabs	"highNibble:V(6,2)",38,0,278,highNibble.1610
 412               		.stabn	192,0,0,.LFBB6-.LFBB6
 413               		.stabn	224,0,0,.Lscope6-.LFBB6
 414               	.Lscope6:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 14


 415               		.stabs	"",36,0,0,.Lscope6-.LFBB6
 416               		.stabd	78,0,0
 417               		.stabs	"heartUpdate:F(6,2)",36,0,328,heartUpdate
 418               	.global	heartUpdate
 419               		.type	heartUpdate, @function
 420               	heartUpdate:
 421               		.stabd	46,0,0
 324:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
 325:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 326:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //This function takes about 186 bytes
 327:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // Really?! Or is hfm not compiled if it's not used?
 328:_commonCode_localized/heartbeat/1.30/heartbeat.c **** uint8_t heartUpdate(void)
 329:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {	
 422               		.stabn	68,0,329,.LM38-.LFBB7
 423               	.LM38:
 424               	.LFBB7:
 425 0118 CF92      		push r12
 426 011a DF92      		push r13
 427 011c EF92      		push r14
 428 011e FF92      		push r15
 429               	/* prologue: function */
 430               	/* frame size = 0 */
 431               	/* stack size = 4 */
 432               	.L__stack_usage = 4
 433               	.LBB12:
 434               	.LBB13:
 435               		.stabs	"./_commonCode_localized/dmsTimer/1.13/dmsExternal.h",132,0,0,.Ltext1
 436               	.Ltext1:
   1:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** /* mehPL:
   2:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h ****  *    This is Open Source, but NOT GPL. I call it mehPL.
   3:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h ****  *    I'm not too fond of long licenses at the top of the file.
   4:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h ****  *    Please see the bottom.
   5:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h ****  *    Enjoy!
   6:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h ****  */
   7:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
   8:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
   9:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  10:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  11:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** #ifndef __DMS_EXTERNAL_H__
  12:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** #define __DMS_EXTERNAL_H__
  13:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** extern volatile uint32_t dmsCount;	//deci-milliseconds
  14:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  15:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** #if (!defined(DMS_FRAC_UNUSED) || !DMS_FRAC_UNUSED)
  16:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** extern volatile uint8_t dmsFrac;
  17:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** #endif
  18:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  19:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //These WERE specific to externalUpdate, 
  20:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** // however they can also be used for dmsFrac with timer0 interrupt
  21:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** // (Along with dmsFrac, below)
  22:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** // Also with nonAVR code, where us is read directly...
  23:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //   these defaults are changed in init functions
  24:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //   (defaults correspond to us-reading)
  25:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** // a/o 1.12: Apparently these were a remnant of pre-xyt times...
  26:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //           Though, as stated above, they are usable by dmsFrac
  27:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //           So remove them if dmsFrac is disabled!
  28:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** #if (!defined(DMS_FRAC_UNUSED) || !DMS_FRAC_UNUSED)
  29:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** extern uint8_t dmsNumUpdates; 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 15


  30:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** extern uint8_t dmsIncrementSize;
  31:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** #endif
  32:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  33:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //Fractional part of the last-read dmsTime...
  34:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** // This'll likely be handled differently in different cases
  35:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** // for now it's only implemented in NON-AVR code or AVR code based on
  36:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** // timer interrupt 0 (untested)
  37:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //volatile uint8_t dmsFrac = 0;
  38:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  39:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  40:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //DMS timer is updated spurradically by an externally-defined source...
  41:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** extern xyt_t dmsLine;
  42:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  43:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //__inline__ prefix might be unnecessary since the prototype includes it
  44:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** __inline__ \
  45:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** void init_dmsExternalUpdate(uint32_t numUpdates, uint32_t incrementSize)
  46:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** {
  47:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** #if (!defined(DMS_FRAC_UNUSED) || !DMS_FRAC_UNUSED)
  48:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  49:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //This is the result of 1.12-1:
  50:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** // which was developed with FRAC_UNUSED...
  51:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** // an easy option would be to step back to 1.12
  52:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** // OR replace dmsNumUpdates and dmsIncrementSize with uint32_t's.
  53:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** // Alternatively (memory limited?) do some divisions here...
  54:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** #error "DMS_FRAC was unused a/o the creation of this version"
  55:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** #error "numUpdates and/or incrementSize > UINT8_MAX will be destroyed!"
  56:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** #error "It's an easy fix, see notes in this file"
  57:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  58:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	dmsIncrementSize = incrementSize;
  59:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	//one less than the actual count since it counts from 0...
  60:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	dmsNumUpdates = numUpdates;
  61:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** #endif
  62:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  63:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //#warning "xyt requires incrementSize < numUpdates!"
  64:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	xyt_init(&dmsLine, incrementSize, numUpdates);
  65:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** }
  66:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  67:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //__inline__ prefix might be unnecessary since the prototype includes it
  68:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** __inline__ \
  69:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** void dms_update(void)
  70:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** {
  71:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //	static uint8_t counter = 0;
  72:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //	static dms4day_t lastTime;
  73:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  74:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //	lastTime = dmsCount;
  75:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  76:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	dmsCount=xyt_nextOutput(&dmsLine);	
  77:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h ****   #if (!defined(DMS_FRAC_UNUSED) || !DMS_FRAC_UNUSED)
  78:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	dmsFrac =xyt_remainder(&dmsLine);
  79:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h ****   #endif
  80:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //	if(dmsCount != lastTime)
  81:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //		dmsFrac=0;
  82:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	//???What happens with odd fractions...
  83:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	// e.g. 2/5, would give frac=1,2 in one case, and just 1 in the next
  84:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //	else
  85:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** //		dmsFrac++;
  86:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** /*
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 16


  87:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	//counter++;
  88:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
  89:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	// '>' Just in case update is called before init...
  90:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	//@@@ Could use an xyT here?
  91:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	//    e.g. numUpdates=4, incSize=3
  92:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	//    would work better with dmsGetFrac...
  93:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	if(counter >= dmsNumUpdates)
  94:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	{
  95:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 		counter = 0;
  96:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 		dmsCount+=dmsIncrementSize;
  97:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	}
  98:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	else
  99:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 		counter++;
 100:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
 101:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	dmsFrac = counter;
 102:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** */
 103:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** }
 104:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 
 105:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** __inline__ \
 106:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** dms4day_t dmsGetTime(void)
 107:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** {
 108:./_commonCode_localized/dmsTimer/1.13/dmsExternal.h **** 	return dmsCount;
 437               		.stabn	68,0,108,.LM39-.LFBB7
 438               	.LM39:
 439 0120 C090 0000 		lds r12,dmsCount
 440 0124 D090 0000 		lds r13,dmsCount+1
 441 0128 E090 0000 		lds r14,dmsCount+2
 442 012c F090 0000 		lds r15,dmsCount+3
 443               	.LBE13:
 444               	.LBE12:
 445               		.stabs	"_commonCode_localized/heartbeat/1.30/heartbeat.c",132,0,0,.Ltext2
 446               	.Ltext2:
 330:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	static uint32_t lastTime = 0;
 331:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 332:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (_HEART_DMS_)
 333:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	static dms6sec_t lastTime = 0;
 334:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 335:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	uint32_t currentTime;
 336:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	dms6sec_t currentTime;
 337:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 338:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	currentTime = dmsGetTime();
 339:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	currentTime = dmsGet6sec();
 340:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 341:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//HEARTSTEPTIME isn't 100% accurate, especially if this isn't accessed often enough...
 342:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//heartStepTime is in dms...
 343:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	if((currentTime - lastTime) > ((dms6sec_t)heartStepTime))
 344:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	{
 345:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #else
 346:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	static uint32_t lastTime = 0;
 347:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 348:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	static uint32_t currentTime = 0;
 349:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	currentTime++;
 350:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 351:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	if(currentTime - lastTime > (HEART_ITERATIONCOUNT>>heartRate))
 352:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//heartStepTime is number of updates, no corelation with actual seconds..
 353:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //#warning "heartStepTime without dms is untested"
 354:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 17


 355:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 356:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	if((currentTime - lastTime) > heartStepTime)
 447               		.stabn	68,0,356,.LM40-.LFBB7
 448               	.LM40:
 449 0130 8091 0000 		lds r24,lastTime.1615
 450 0134 9091 0000 		lds r25,lastTime.1615+1
 451 0138 9601      		movw r18,r12
 452 013a 281B      		sub r18,r24
 453 013c 390B      		sbc r19,r25
 454 013e 8091 0000 		lds r24,heartStepTime
 455 0142 9091 0000 		lds r25,heartStepTime+1
 456 0146 8217      		cp r24,r18
 457 0148 9307      		cpc r25,r19
 458 014a 00F4      		brsh .L29
 357:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 358:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		lastTime = currentTime;
 459               		.stabn	68,0,358,.LM41-.LFBB7
 460               	.LM41:
 461 014c D092 0000 		sts lastTime.1615+1,r13
 462 0150 C092 0000 		sts lastTime.1615,r12
 463               	.LBB14:
 464               	.LBB15:
 220:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 465               		.stabn	68,0,220,.LM42-.LFBB7
 466               	.LM42:
 467 0154 8091 0000 		lds r24,heartModulator+3
 222:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 468               		.stabn	68,0,222,.LM43-.LFBB7
 469               	.LM43:
 470 0158 6091 0000 		lds r22,direction.1599
 471 015c 7727      		clr r23
 472 015e 67FD      		sbrc r22,7
 473 0160 7095      		com r23
 474 0162 680F      		add r22,r24
 475 0164 711D      		adc r23,__zero_reg__
 226:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 476               		.stabn	68,0,226,.LM44-.LFBB7
 477               	.LM44:
 478 0166 6F3F      		cpi r22,-1
 479 0168 7105      		cpc r23,__zero_reg__
 480 016a 04F0      		brlt .L30
 229:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}	
 481               		.stabn	68,0,229,.LM45-.LFBB7
 482               	.LM45:
 483 016c 8FEF      		ldi r24,lo8(-1)
 484 016e 8093 0000 		sts direction.1599,r24
 228:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		direction = -1;
 485               		.stabn	68,0,228,.LM46-.LFBB7
 486               	.LM46:
 487 0172 6FEF      		ldi r22,lo8(-1)
 488 0174 70E0      		ldi r23,0
 489 0176 00C0      		rjmp .L31
 490               	.L30:
 232:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 491               		.stabn	68,0,232,.LM47-.LFBB7
 492               	.LM47:
 493 0178 1616      		cp __zero_reg__,r22
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 18


 494 017a 1706      		cpc __zero_reg__,r23
 495 017c 04F0      		brlt .L31
 235:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
 496               		.stabn	68,0,235,.LM48-.LFBB7
 497               	.LM48:
 498 017e 81E0      		ldi r24,lo8(1)
 499 0180 8093 0000 		sts direction.1599,r24
 234:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		direction = +1;
 500               		.stabn	68,0,234,.LM49-.LFBB7
 501               	.LM49:
 502 0184 60E0      		ldi r22,0
 503 0186 70E0      		ldi r23,0
 504               	.L31:
 505               	.LBE15:
 506               	.LBE14:
 359:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 360:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		hfm_setPower(&heartModulator, getNextDesired());
 507               		.stabn	68,0,360,.LM50-.LFBB7
 508               	.LM50:
 509 0188 80E0      		ldi r24,lo8(heartModulator)
 510 018a 90E0      		ldi r25,hi8(heartModulator)
 511 018c 0E94 0000 		call hfm_setPower
 512               	.L29:
 361:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
 362:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 363:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 364:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //		Without inverter, LED tied high:
 365:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //			LED-ON		(DDR = H-out,	PORT = L)
 366:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //			LED-OFF/IN	(DDR = L-in,	PORT = H-pull-up)
 367:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //				(If IN is tied LOW, the LED will be ON)
 368:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //		With inverter, LED tied high, no resistors:
 369:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //			LED-OFF		(DDR = H-out,	PORT = L)
 370:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //			LED-ON/IN	(DDR = L-in,	PORT = H-pull-up)
 371:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //				(If IN is tied LOW, the LED will be OFF)
 372:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//determine whether the LED should be on or off based on the HFM
 373:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	// return TRUE if the pin is available as an input
 374:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	uint8_t ledVal;
 375:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 376:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (!defined(HEART_BLINK_UNUSED) || !HEART_BLINK_UNUSED)
 377:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	if(heartBlink)
 513               		.stabn	68,0,377,.LM51-.LFBB7
 514               	.LM51:
 515 0190 8091 0000 		lds r24,heartBlink
 516 0194 8823      		tst r24
 517 0196 01F0      		breq .L32
 378:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		ledVal = blinkHeart(currentTime);
 518               		.stabn	68,0,378,.LM52-.LFBB7
 519               	.LM52:
 520 0198 C601      		movw r24,r12
 521 019a 0E94 0000 		call blinkHeart
 522 019e 00C0      		rjmp .L33
 523               	.L32:
 379:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		//ledVal = blinkHeart((dms6sec_t)currentTime);
 380:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	else
 381:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
 382:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		ledVal = hfm_nextOutput(&heartModulator);
 524               		.stabn	68,0,382,.LM53-.LFBB7
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 19


 525               	.LM53:
 526 01a0 80E0      		ldi r24,lo8(heartModulator)
 527 01a2 90E0      		ldi r25,hi8(heartModulator)
 528 01a4 0E94 0000 		call hfm_nextOutput
 529               	.L33:
 383:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 384:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	if(ledVal)
 530               		.stabn	68,0,384,.LM54-.LFBB7
 531               	.LM54:
 532 01a8 8823      		tst r24
 533 01aa 01F0      		breq .L34
 385:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 386:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (!defined(HEARTPIN_HARDCODED) || !HEARTPIN_HARDCODED)
 387:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		if(ledConnection == LED_DIRECT_HIGH)
 388:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		{
 389:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			//Set the direction first, so there's not a short short with the input switch
 390:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			//DDR = L,in
 391:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			setinVar(heartBeatPin, heartPIN);
 392:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			//PORT = H,pull-up
 393:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			setpuVar(heartBeatPin, heartPIN);
 394:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		}
 395:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		else if(ledConnection == LED_INVERTED)
 396:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		{
 397:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			//Shouldn't be necessary, but might as well...
 398:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			setoutVar(heartBeatPin, heartPIN);
 399:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 			setpinVar(heartBeatPin, heartPIN);
 400:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		}
 401:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #else
 402:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  #if (HEART_LEDCONNECTION == LED_DIRECT_HIGH)
 403:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		setinPORT(HEART_PINNUM, HEART_PINPORT);
 534               		.stabn	68,0,403,.LM55-.LFBB7
 535               	.LM55:
 536 01ac 2698      		cbi 0x4,6
 404:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		setpuPORT(HEART_PINNUM, HEART_PINPORT);
 537               		.stabn	68,0,404,.LM56-.LFBB7
 538               	.LM56:
 539 01ae 2E9A      		sbi 0x5,6
 405:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  #elif (HEART_LEDCONNECTION == LED_INVERTED)
 406:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		setoutPORT(HEART_PINNUM, HEART_PINPORT);
 407:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		setpinPORT(HEART_PINNUM, HEART_PINPORT);
 408:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  #else
 409:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	#error "Not Handled..."
 410:_commonCode_localized/heartbeat/1.30/heartbeat.c ****  #endif
 411:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
 412:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		return TRUE;
 540               		.stabn	68,0,412,.LM57-.LFBB7
 541               	.LM57:
 542 01b0 81E0      		ldi r24,lo8(1)
 543 01b2 00C0      		rjmp .L35
 544               	.L34:
 413:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
 414:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	else
 415:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 416:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (!defined(HEARTPIN_HARDCODED) || !HEARTPIN_HARDCODED)
 417:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		//This should be the same for either case...
 418:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		
 419:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		//Set the port first, so there's not a short 
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 20


 420:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		//(there may be an instant of floating on the input of an inverter)
 421:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		//PORT = L
 422:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		clrpinVar(heartBeatPin, heartPIN);
 423:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		//DDR = H,out
 424:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		setoutVar(heartBeatPin, heartPIN);
 425:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #else
 426:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		clrpinPORT(HEART_PINNUM, HEART_PINPORT);
 545               		.stabn	68,0,426,.LM58-.LFBB7
 546               	.LM58:
 547 01b4 2E98      		cbi 0x5,6
 427:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		setoutPORT(HEART_PINNUM, HEART_PINPORT);
 548               		.stabn	68,0,427,.LM59-.LFBB7
 549               	.LM59:
 550 01b6 269A      		sbi 0x4,6
 428:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
 429:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		return FALSE;
 551               		.stabn	68,0,429,.LM60-.LFBB7
 552               	.LM60:
 553 01b8 80E0      		ldi r24,0
 554               	.L35:
 555               	/* epilogue start */
 430:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
 431:_commonCode_localized/heartbeat/1.30/heartbeat.c **** }
 556               		.stabn	68,0,431,.LM61-.LFBB7
 557               	.LM61:
 558 01ba FF90      		pop r15
 559 01bc EF90      		pop r14
 560 01be DF90      		pop r13
 561 01c0 CF90      		pop r12
 562 01c2 0895      		ret
 563               		.size	heartUpdate, .-heartUpdate
 564               		.stabs	"lastTime:V(9,1)",38,0,333,lastTime.1615
 565               		.stabs	"ledVal:r(6,2)",64,0,374,24
 566               		.stabn	192,0,0,.LFBB7-.LFBB7
 567               		.stabn	224,0,0,.Lscope7-.LFBB7
 568               	.Lscope7:
 569               		.stabs	"",36,0,0,.Lscope7-.LFBB7
 570               		.stabd	78,0,0
 571               		.stabs	"heartupdate:F(0,47)",36,0,86,heartupdate
 572               	.global	heartupdate
 573               		.type	heartupdate, @function
 574               	heartupdate:
 575               		.stabd	46,0,0
  87:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	heartUpdate();
 576               		.stabn	68,0,87,.LM62-.LFBB8
 577               	.LM62:
 578               	.LFBB8:
 579               	/* prologue: function */
 580               	/* frame size = 0 */
 581               	/* stack size = 0 */
 582               	.L__stack_usage = 0
  88:_commonCode_localized/heartbeat/1.30/heartbeat.c **** }
 583               		.stabn	68,0,88,.LM63-.LFBB8
 584               	.LM63:
 585 01c4 0C94 0000 		jmp heartUpdate
 586               		.size	heartupdate, .-heartupdate
 587               	.Lscope8:
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 21


 588               		.stabs	"",36,0,0,.Lscope8-.LFBB8
 589               		.stabd	78,0,0
 590               		.stabs	"heartPinInputPoll:F(6,2)",36,0,444,heartPinInputPoll
 591               	.global	heartPinInputPoll
 592               		.type	heartPinInputPoll, @function
 593               	heartPinInputPoll:
 594               		.stabd	46,0,0
 432:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 433:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (!defined(HEART_INPUTPOLLING_UNUSED) || !HEART_INPUTPOLLING_UNUSED)
 434:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // This value's arbitrary... works with tabletBluetoother 3...
 435:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // This function takes about 20 bytes
 436:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // HEART_PULLUP_DELAY was originally 3, but doesn't seem to be enough for
 437:_commonCode_localized/heartbeat/1.30/heartbeat.c **** // the pwm161 running with CLKDIV8 disabled.
 438:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #ifndef HEART_PULLUP_DELAY
 439:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #define HEART_PULLUP_DELAY 255
 440:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #warning "HEART_PULLUP_DELAY is unset, defaulting to a large value"
 441:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #warning " You can add CFLAGS += -D'HEART_PULLUP_DELAY=<value>' to your makefile"
 442:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
 443:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 444:_commonCode_localized/heartbeat/1.30/heartbeat.c **** uint8_t heartPinInputPoll(void)
 445:_commonCode_localized/heartbeat/1.30/heartbeat.c **** {
 595               		.stabn	68,0,445,.LM64-.LFBB9
 596               	.LM64:
 597               	.LFBB9:
 598               	/* prologue: function */
 599               	/* frame size = 0 */
 600               	/* stack size = 0 */
 601               	.L__stack_usage = 0
 446:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	uint8_t pinState;
 447:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	
 448:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #if (!defined(HEARTPIN_HARDCODED) || !HEARTPIN_HARDCODED)
 449:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Make the pin an input, pulled-up
 450:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//OLD:Set the pullup first so it doesn't take so long to raise...
 451:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Set input first so we don't short the output (PORT=H,pu) to ground
 452:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	setinVar(heartBeatPin, heartPIN);
 453:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//PORT = H, pull-up
 454:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	setpuVar(heartBeatPin, heartPIN);
 455:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 456:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Insert a delay to allow the pull-up to rise...
 457:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	uint8_t delay; 
 458:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	for(delay = 0; delay < HEART_PULLUP_DELAY; delay++)
 459:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{  
 460:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	   //Necessary or this'll be optimised-out
 461:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	   asm("nop;");
 462:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
 463:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 464:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	pinState = getpinVar(heartBeatPin, heartPIN);
 465:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #else
 466:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	setinPORT(HEART_PINNUM, HEART_PINPORT);
 602               		.stabn	68,0,466,.LM65-.LFBB9
 603               	.LM65:
 604 01c8 2698      		cbi 0x4,6
 467:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	setpuPORT(HEART_PINNUM, HEART_PINPORT);
 605               		.stabn	68,0,467,.LM66-.LFBB9
 606               	.LM66:
 607 01ca 2E9A      		sbi 0x5,6
 608 01cc 8FEF      		ldi r24,lo8(-1)
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 22


 609               	.L39:
 468:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 469:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Insert a delay to allow the pull-up to rise...
 470:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	uint8_t delay;
 471:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	for(delay = 0; delay < HEART_PULLUP_DELAY; delay++)
 472:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 473:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		//Necessary or this'll be optimised-out
 474:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 		asm("nop;");
 610               		.stabn	68,0,474,.LM67-.LFBB9
 611               	.LM67:
 612               	/* #APP */
 613               	 ;  474 "_commonCode_localized/heartbeat/1.30/heartbeat.c" 1
 614 01ce 0000      		nop;
 615               	 ;  0 "" 2
 616               	/* #NOAPP */
 617 01d0 8150      		subi r24,lo8(-(-1))
 471:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	{
 618               		.stabn	68,0,471,.LM68-.LFBB9
 619               	.LM68:
 620 01d2 01F4      		brne .L39
 475:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	}
 476:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 477:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	pinState = getpinPORT(HEART_PINNUM, HEART_PINPORT);
 621               		.stabn	68,0,477,.LM69-.LFBB9
 622               	.LM69:
 623 01d4 83B1      		in r24,0x3
 478:_commonCode_localized/heartbeat/1.30/heartbeat.c **** #endif
 479:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 480:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Leave the pinstate to be updated with next heartUpdate
 481:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	// to assure valid/safe values of PORT and DDR...
 482:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	//Return the pin to the heartbeat
 483:_commonCode_localized/heartbeat/1.30/heartbeat.c **** //	setoutVar(heartBeatPin, heartPIN);
 484:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 
 485:_commonCode_localized/heartbeat/1.30/heartbeat.c **** 	return pinState;
 486:_commonCode_localized/heartbeat/1.30/heartbeat.c **** }
 624               		.stabn	68,0,486,.LM70-.LFBB9
 625               	.LM70:
 626 01d6 86FB      		bst r24,6
 627 01d8 8827      		clr r24
 628 01da 80F9      		bld r24,0
 629 01dc 0895      		ret
 630               		.size	heartPinInputPoll, .-heartPinInputPoll
 631               	.Lscope9:
 632               		.stabs	"",36,0,0,.Lscope9-.LFBB9
 633               		.stabd	78,0,0
 634               		.data
 635               		.type	direction.1599, @object
 636               		.size	direction.1599, 1
 637               	direction.1599:
 638 0000 01        		.byte	1
 639               		.local	lastTime.1615
 640               		.comm	lastTime.1615,2,1
 641               		.local	lastToggleTime.1608
 642               		.comm	lastToggleTime.1608,2,1
 643               		.local	toggleCount.1609
 644               		.comm	toggleCount.1609,1,1
 645               		.local	highNibble.1610
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 23


 646               		.comm	highNibble.1610,1,1
 647               	.global	heartBlink
 648               		.section .bss
 649               		.type	heartBlink, @object
 650               		.size	heartBlink, 1
 651               	heartBlink:
 652 0000 00        		.zero	1
 653               		.comm	heartModulator,4,1
 654               	.global	heartStepTime
 655               		.data
 656               		.type	heartStepTime, @object
 657               		.size	heartStepTime, 2
 658               	heartStepTime:
 659 0001 9C00      		.word	156
 660               		.stabs	"heartStepTime:G(6,4)",32,0,19,0
 661               		.stabs	"heartModulator:G(8,1)",32,0,38,0
 662               		.stabs	"heartBlink:G(6,2)",32,0,249,0
 663               		.text
 664               		.stabs	"",100,0,0,.Letext0
 665               	.Letext0:
 666               		.ident	"GCC: (GNU) 4.8.2"
 667               	.global __do_copy_data
 668               	.global __do_clear_bss
GAS LISTING /var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s 			page 24


DEFINED SYMBOLS
                            *ABS*:00000000 heartbeat.c
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:2      *ABS*:0000003e __SP_H__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:3      *ABS*:0000003d __SP_L__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:4      *ABS*:0000003f __SREG__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:5      *ABS*:00000000 __tmp_reg__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:6      *ABS*:00000001 __zero_reg__
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:124    .text:00000000 setHeartRate
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:658    .data:00000001 heartStepTime
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:158    .text:0000001c getHeartRate
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:185    .text:00000030 heartClear
                            *COM*:00000004 heartModulator
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:207    .text:0000003a init_heartBeat
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:248    .text:00000058 set_heartBlink
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:651    .bss:00000000 heartBlink
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:269    .text:0000005e blinkHeart
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:644    .bss:00000006 highNibble.1610
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:642    .bss:00000005 toggleCount.1609
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:640    .bss:00000003 lastToggleTime.1608
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:420    .text:00000118 heartUpdate
                             .bss:00000001 lastTime.1615
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:637    .data:00000000 direction.1599
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:574    .text:000001c4 heartupdate
/var/folders/yG/yGnXnnFGGj4hKA71DL26EU+++TI/-Tmp-//ccTVmHzp.s:593    .text:000001c8 heartPinInputPoll

UNDEFINED SYMBOLS
__divmodhi4
__udivmodhi4
hfm_setPower
hfm_setup
dmsCount
hfm_nextOutput
__do_copy_data
__do_clear_bss
